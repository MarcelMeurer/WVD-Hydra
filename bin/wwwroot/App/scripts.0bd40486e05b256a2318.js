(function(){function t(t,e){return function(){return t.apply(e,arguments)}}var e,n,r,i,o,a,s,l,u,c,d,f,h,p,g,m,v,y,x,b,_,w,S,C,M,T,k,A,I,D,O,P,E,R,L,N,B,z,V,F,H,W,j,G,U,q,X=[].slice,Y={}.hasOwnProperty,$=function(t,e){for(var n in e)Y.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},Z=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};function K(){}for(y={className:"",catchupTime:100,initialRate:.03,minTime:250,ghostTime:100,maxProgressPerFrame:20,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:500,target:"body",elements:{checkInterval:100,selectors:["body"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:["GET"],trackWebSockets:!0,ignoreURLs:[]}},T=function(){var t;return null!=(t="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?t:+new Date},A=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,v=window.cancelAnimationFrame||window.mozCancelAnimationFrame,f=function(t,e,n){if("function"==typeof t.addEventListener)return t.addEventListener(e,n,!1);var r;"function"!=typeof t["on"+e]||"object"!=typeof t["on"+e].eventListeners?(r=new i,"function"==typeof t["on"+e]&&r.on(e,t["on"+e]),t["on"+e]=function(t){return r.trigger(e,t)},t["on"+e].eventListeners=r):r=t["on"+e].eventListeners,r.on(e,n)},null==A&&(A=function(t){return setTimeout(t,50)},v=function(t){return clearTimeout(t)}),D=function(t){var e=T(),n=function(){var r=T()-e;return 33<=r?(e=T(),t(r,function(){return A(n)})):setTimeout(n,33-r)};return n()},I=function(){var t=arguments[0],e=arguments[1],n=3<=arguments.length?X.call(arguments,2):[];return"function"==typeof t[e]?t[e].apply(t,n):t[e]},x=function(){for(var t,e,n,r=arguments[0],i=2<=arguments.length?X.call(arguments,1):[],o=0,a=i.length;o<a;o++)if(e=i[o])for(t in e)Y.call(e,t)&&(n=e[t],null!=r[t]&&"object"==typeof r[t]&&null!=n&&"object"==typeof n?x(r[t],n):r[t]=n);return r},p=function(t){for(var e,n=e=0,r=0,i=t.length;r<i;r++)n+=Math.abs(t[r]),e++;return n/e},_=function(t,e){var n,r;if(null==t&&(t="options"),null==e&&(e=!0),r=document.querySelector("[data-pace-"+t+"]")){if(n=r.getAttribute("data-pace-"+t),!e)return n;try{return JSON.parse(n)}catch(t){return"undefined"!=typeof console&&null!==console?console.error("Error parsing inline pace options",t):void 0}}},K.prototype.on=function(t,e,n,r){var i;return null==r&&(r=!1),null==this.bindings&&(this.bindings={}),null==(i=this.bindings)[t]&&(i[t]=[]),this.bindings[t].push({handler:e,ctx:n,once:r})},K.prototype.once=function(t,e,n){return this.on(t,e,n,!0)},K.prototype.off=function(t,e){var n,r,i;if(null!=(null!=(r=this.bindings)?r[t]:void 0)){if(null==e)return delete this.bindings[t];for(n=0,i=[];n<this.bindings[t].length;)i.push(this.bindings[t][n].handler===e?this.bindings[t].splice(n,1):n++);return i}},K.prototype.trigger=function(){var t,e,n,r,i,o,a=arguments[0],s=2<=arguments.length?X.call(arguments,1):[];if(null!=(r=this.bindings)&&r[a]){for(n=0,o=[];n<this.bindings[a].length;)e=(i=this.bindings[a][n]).handler,t=i.ctx,i=i.once,e.apply(null!=t?t:this,s),o.push(i?this.bindings[a].splice(n,1):n++);return o}},q=K,a=window.Pace||{},window.Pace=a,x(a,q.prototype),k=a.options=x({},y,window.paceOptions,_()),F=0,W=(G=["ajax","document","eventLag","elements"]).length;F<W;F++)!0===k[R=G[F]]&&(k[R]=y[R]);function J(){return J.__super__.constructor.apply(this,arguments)}function Q(){this.progress=0}function tt(){this.bindings={}}function et(){var t,e=this;et.__super__.constructor.apply(this,arguments),t=function(t){var n=t.open;return t.open=function(r,i,o){return E(r)&&e.trigger("request",{type:r,url:i,request:t}),n.apply(t,arguments)}},window.XMLHttpRequest=function(e){return e=new V(e),t(e),e};try{b(window.XMLHttpRequest,V)}catch(s){}if(null!=z){window.XDomainRequest=function(){var e=new z;return t(e),e};try{b(window.XDomainRequest,z)}catch(s){}}if(null!=B&&k.ajax.trackWebSockets){window.WebSocket=function(t,n){var r=null!=n?new B(t,n):new B(t);return E("socket")&&e.trigger("request",{type:"socket",url:t,protocols:n,request:r}),r};try{b(window.WebSocket,B)}catch(s){}}}function nt(){this.complete=t(this.complete,this);var e=this;this.elements=[],w().on("request",function(){return e.watch.apply(e,arguments)})}function rt(e){var n,i,o;for(null==e&&(e={}),this.complete=t(this.complete,this),this.elements=[],null==e.selectors&&(e.selectors=[]),n=0,i=(o=e.selectors).length;n<i;n++)this.elements.push(new r(o[n],this.complete))}function it(t,e){this.selector=t,this.completeCallback=e,this.progress=0,this.check()}function ot(){var t,e,n=this;this.progress=null!=(e=this.states[document.readyState])?e:100,t=document.onreadystatechange,document.onreadystatechange=function(){return null!=n.states[document.readyState]&&(n.progress=n.states[document.readyState]),"function"==typeof t?t.apply(null,arguments):void 0}}function at(t){this.source=t,this.last=this.sinceLastUpdate=0,this.rate=k.initialRate,this.catchup=0,this.progress=this.lastProgress=0,null!=this.source&&(this.progress=I(this.source,"progress"))}$(J,q=Error),o=J,Q.prototype.getElement=function(){var t;if(null==this.el){if(!(t=document.querySelector(k.target)))throw new o;this.el=document.createElement("div"),this.el.className="pace pace-active",document.body.className=document.body.className.replace(/(pace-done )|/,"pace-running "),this.el.innerHTML='<div class="pace-progress'+(""!==k.className?" "+k.className:"")+'">\n  <div class="pace-progress-inner"></div>\n</div>\n<div class="pace-activity"></div>',null!=t.firstChild?t.insertBefore(this.el,t.firstChild):t.appendChild(this.el)}return this.el},Q.prototype.finish=function(){var t=this.getElement();return t.className=t.className.replace("pace-active","pace-inactive"),document.body.className=document.body.className.replace("pace-running ","pace-done ")},Q.prototype.update=function(t){return this.progress=t,a.trigger("progress",t),this.render()},Q.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(s){o=s}return this.el=void 0},Q.prototype.render=function(){var t,e,n,r,i,o;if(null==document.querySelector(k.target))return!1;for(t=this.getElement(),n="translate3d("+this.progress+"%, 0, 0)",r=0,i=(o=["webkitTransform","msTransform","transform"]).length;r<i;r++)t.children[0].style[o[r]]=n;return(!this.lastRenderedProgress||this.lastRenderedProgress|0!==this.progress|0)&&(t.children[0].setAttribute("data-progress-text",(0|this.progress)+"%"),100<=this.progress?e="99":(e=this.progress<10?"0":"",e+=0|this.progress),t.children[0].setAttribute("data-progress",""+e)),a.trigger("change",this.progress),this.lastRenderedProgress=this.progress},Q.prototype.done=function(){return 100<=this.progress},n=Q,tt.prototype.trigger=function(t,e){var n,r,i,o;if(null!=this.bindings[t]){for(o=[],n=0,r=(i=this.bindings[t]).length;n<r;n++)o.push(i[n].call(this,e));return o}},tt.prototype.on=function(t,e){var n;return null==(n=this.bindings)[t]&&(n[t]=[]),this.bindings[t].push(e)},i=tt,V=window.XMLHttpRequest,z=window.XDomainRequest,B=window.WebSocket,b=function(t,e){var n,r=[];for(n in e.prototype)try{r.push(null==t[n]&&"function"!=typeof e[n]?"function"==typeof Object.defineProperty?Object.defineProperty(t,n,{get:function(t){return function(){return e.prototype[t]}}(n),configurable:!0,enumerable:!0}):t[n]=e.prototype[n]:void 0)}catch(t){}return r},C=[],a.ignore=function(){var t=arguments[0],e=2<=arguments.length?X.call(arguments,1):[];return C.unshift("ignore"),e=t.apply(null,e),C.shift(),e},a.track=function(){var t=arguments[0],e=2<=arguments.length?X.call(arguments,1):[];return C.unshift("track"),e=t.apply(null,e),C.shift(),e},E=function(t){if(null==t&&(t="GET"),"track"===C[0])return"force";if(!C.length&&k.ajax){if("socket"===t&&k.ajax.trackWebSockets)return!0;if(t=t.toUpperCase(),0<=Z.call(k.ajax.trackMethods,t))return!0}return!1},$(et,i),s=et,H=null,P=function(t){for(var e,n=k.ajax.ignoreURLs,r=0,i=n.length;r<i;r++)if("string"==typeof(e=n[r])){if(-1!==t.indexOf(e))return!0}else if(e.test(t))return!0;return!1},(w=function(){return H=null==H?new s:H})().on("request",function(t){var n,r=t.type,i=t.request,o=t.url;if(!P(o))return a.running||!1===k.restartOnRequestAfter&&"force"!==E(r)?void 0:(n=arguments,"boolean"==typeof(o=k.restartOnRequestAfter||0)&&(o=0),setTimeout(function(){var t,o,s,l,u="socket"===r?i.readyState<1:0<(u=i.readyState)&&u<4;if(u){for(a.restart(),l=[],t=0,o=(s=a.sources).length;t<o;t++){if((R=s[t])instanceof e){R.watch.apply(R,n);break}l.push(void 0)}return l}},o))}),nt.prototype.watch=function(t){var e=t.type,n=t.request;if(!P(t=t.url))return n=new("socket"===e?c:d)(n,this.complete),this.elements.push(n)},nt.prototype.complete=function(t){return this.elements=this.elements.filter(function(e){return e!==t})},e=nt,d=function(t,e){var n,r,i,o,a=this;if(this.progress=0,null!=window.ProgressEvent)for(f(t,"progress",function(t){return a.progress=t.lengthComputable?100*t.loaded/t.total:a.progress+(100-a.progress)/2}),n=0,r=(o=["load","abort","timeout","error"]).length;n<r;n++)f(t,o[n],function(){return e(a),a.progress=100});else i=t.onreadystatechange,t.onreadystatechange=function(){var n;return 0===(n=t.readyState)||4===n?(e(a),a.progress=100):3===t.readyState&&(a.progress=50),"function"==typeof i?i.apply(null,arguments):void 0}},c=function(t,e){for(var n,r=this,i=this.progress=0,o=(n=["error","open"]).length;i<o;i++)f(t,n[i],function(){return e(r),r.progress=100})},rt.prototype.complete=function(t){return this.elements=this.elements.filter(function(e){return e!==t})},_=rt,it.prototype.check=function(){var t=this;return document.querySelector(this.selector)?this.done():setTimeout(function(){return t.check()},k.elements.checkInterval)},it.prototype.done=function(){return this.completeCallback(this),this.completeCallback=null,this.progress=100},r=it,ot.prototype.states={loading:0,interactive:50,complete:100},q=ot,$=function(){var t,e,n,r,i,o=this;this.progress=0,i=[],r=0,n=T(),e=setInterval(function(){var a=T()-n-50;return n=T(),i.push(a),i.length>k.eventLag.sampleCount&&i.shift(),t=p(i),++r>=k.eventLag.minSamples&&t<k.eventLag.lagThreshold?(o.progress=100,clearInterval(e)):o.progress=3/(t+3)*100},50)},at.prototype.tick=function(t,e){return 100<=(e=null==e?I(this.source,"progress"):e)&&(this.done=!0),e===this.last?this.sinceLastUpdate+=t:(this.sinceLastUpdate&&(this.rate=(e-this.last)/this.sinceLastUpdate),this.catchup=(e-this.progress)/k.catchupTime,this.sinceLastUpdate=0,this.last=e),e>this.progress&&(this.progress+=this.catchup*t),e=1-Math.pow(this.progress/100,k.easeFactor),this.progress+=e*this.rate*t,this.progress=Math.min(this.lastProgress+k.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},u=at,m=h=N=g=O=L=null,a.running=!1,S=function(){if(k.restartOnPushState)return a.restart()},null!=window.history.pushState&&(j=window.history.pushState,window.history.pushState=function(){return S(),j.apply(window.history,arguments)}),null!=window.history.replaceState&&(U=window.history.replaceState,window.history.replaceState=function(){return S(),U.apply(window.history,arguments)}),l={ajax:e,elements:_,document:q,eventLag:$},(M=function(){var t,e,r,i,o,s,c,d;for(a.sources=L=[],e=0,i=(s=["ajax","elements","document","eventLag"]).length;e<i;e++)!1!==k[t=s[e]]&&L.push(new l[t](k[t]));for(r=0,o=(d=null!=(c=k.extraSources)?c:[]).length;r<o;r++)L.push(new(R=d[r])(k));return a.bar=g=new n,O=[],N=new u})(),a.stop=function(){return a.trigger("stop"),a.running=!1,g.destroy(),m=!0,null!=h&&("function"==typeof v&&v(h),h=null),M()},a.restart=function(){return a.trigger("restart"),a.stop(),a.start()},a.go=function(){var t;return a.running=!0,g.render(),t=T(),m=!1,h=D(function(e,n){for(var r,i,o,s,l,c,d,f,h,p=l=0,v=!0,y=c=0,x=L.length;c<x;y=++c)for(R=L[y],s=null!=O[y]?O[y]:O[y]=[],i=d=0,f=(r=null!=(h=R.elements)?h:[R]).length;d<f;i=++d)o=r[i],v&=(o=null!=s[i]?s[i]:s[i]=new u(o)).done,o.done||(p++,l+=o.tick(e));return g.update(N.tick(e,l/p)),g.done()||v||m?(g.update(100),a.trigger("done"),setTimeout(function(){return g.finish(),a.running=!1,a.trigger("hide")},Math.max(k.ghostTime,Math.max(k.minTime-(T()-t),0)))):n()})},a.start=function(t){x(k,t),a.running=!0;try{g.render()}catch(t){o=t}return document.querySelector(".pace")?(a.trigger("start"),a.go()):setTimeout(a.start,50)},"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof exports?module.exports=a:k.startOnPageLoad&&a.start()}).call(this),function(){"use strict";var t=function(t){if(null===t)return"null";if(void 0===t)return"undefined";var e=typeof t;return"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e},e=function(t){return{eq:t}},n=e(function(t,e){return t===e}),r=function(t){return e(function(e,n){if(e.length!==n.length)return!1;for(var r=e.length,i=0;i<r;i++)if(!t.eq(e[i],n[i]))return!1;return!0})},i=function(t,n){return i=r(t),o=function(t){return e=n,Array.prototype.slice.call(t).sort(e);var e},e(function(t,e){return i.eq(o(t),o(e))});var i,o},o=function(t){return e(function(e,r){var o=Object.keys(e),a=Object.keys(r);if(!i(n).eq(o,a))return!1;for(var s=o.length,l=0;l<s;l++){var u=o[l];if(!t.eq(e[u],r[u]))return!1}return!0})},a=e(function(e,n){if(e===n)return!0;var i=t(e);return i===t(n)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(i)?e===n:"array"===i?r(a).eq(e,n):"object"===i&&o(a).eq(e,n))}),s=function(t){return function(e){return r=typeof(n=e),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===t;var n,r}},l=function(t){return function(e){return typeof e===t}},u=function(t){return function(e){return t===e}},c=s("string"),d=s("object"),f=s("array"),h=u(null),p=l("boolean"),g=u(void 0),m=function(t){return null==t},v=function(t){return!m(t)},y=l("function"),x=l("number"),b=function(){},_=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))}},w=function(t){return function(){return t}},S=function(t){return t};function C(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=e.concat(n);return t.apply(null,i)}}var M,T,k,A=function(t){return function(e){return!t(e)}},I=function(t){return function(){throw new Error(t)}},D=function(t){return t()},O=function(t){t()},P=w(!1),E=w(!0),R=function(){return L},L=(M=function(t){return t.isNone()},{fold:function(t,e){return t()},is:P,isSome:P,isNone:E,getOr:k=function(t){return t},getOrThunk:T=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:w(null),getOrUndefined:w(void 0),or:k,orThunk:T,map:R,each:b,bind:R,exists:P,forall:E,filter:R,equals:M,equals_:M,toArray:function(){return[]},toString:w("none()")}),N=function(t){var e=w(t),n=function(){return i},r=function(e){return e(t)},i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:E,isNone:P,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return N(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?i:L},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(P,function(e){return n(t,e)})}};return i},B={some:N,none:R,from:function(t){return null==t?L:N(t)}},z=Array.prototype.slice,V=Array.prototype.indexOf,F=Array.prototype.push,H=function(t,e){return V.call(t,e)},W=function(t,e){return-1<H(t,e)},j=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return!0;return!1},G=function(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;i++)r[i]=e(t[i],i);return r},U=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)},q=function(t,e){for(var n=t.length-1;0<=n;n--)e(t[n],n)},X=function(t,e){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];e(o,r)&&n.push(o)}return n},Y=function(t,e,n){return q(t,function(t){n=e(n,t)}),n},$=function(t,e,n){return U(t,function(t){n=e(n,t)}),n},Z=function(t,e){return function(t,e,n){for(var r=0,i=t.length;r<i;r++){var o=t[r];if(e(o,r))return B.some(o);if(n(o,r))break}return B.none()}(t,e,P)},K=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return B.some(n);return B.none()},J=function(t,e){return function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!f(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);F.apply(e,t[n])}return e}(G(t,e))},Q=function(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n))return!1;return!0},tt=function(t){var e=z.call(t,0);return e.reverse(),e},et=function(t,e){return X(t,function(t){return!W(e,t)})},nt=function(t,e){return 0<=e&&e<t.length?B.some(t[e]):B.none()},rt=function(t){return nt(t,0)},it=function(t){return nt(t,t.length-1)},ot=y(Array.from)?Array.from:function(t){return z.call(t)},at=Object.keys,st=Object.hasOwnProperty,lt=function(t,e){for(var n=at(t),r=0,i=n.length;r<i;r++){var o=n[r];e(t[o],o)}},ut=function(t,e){return ct(t,function(t,n){return{k:n,v:e(t,n)}})},ct=function(t,e){var n={};return lt(t,function(t,r){var i=e(t,r);n[i.k]=i.v}),n},dt=function(t){return function(e,n){t[n]=e}},ft=function(t,e,n,r){return lt(t,function(t,i){(e(t,i)?n:r)(t,i)}),{}},ht=function(t,e){var n={},r={};return ft(t,e,dt(n),dt(r)),{t:n,f:r}},pt=function(t,e){var n={};return ft(t,e,dt(n),b),n},gt=function(t,e){return mt(t,e)?B.from(t[e]):B.none()},mt=function(t,e){return st.call(t,e)},vt=function(t,e){return mt(t,e)&&null!=t[e]},yt=Array.isArray,xt=function(t,e,n){var r,i;if(!t)return!1;if(n=n||t,void 0!==t.length){for(r=0,i=t.length;r<i;r++)if(!1===e.call(n,t[r],r,t))return!1}else for(r in t)if(t.hasOwnProperty(r)&&!1===e.call(n,t[r],r,t))return!1;return!0},bt=function(t,e){var n=[];return xt(t,function(r,i){n.push(e(r,i,t))}),n},_t=function(t,e){var n=[];return xt(t,function(r,i){e&&!e(r,i,t)||n.push(r)}),n},wt=function(t,e){if(t)for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},St=function(t,e,n,r){for(var i=g(n)?t[0]:n,o=0;o<t.length;o++)i=e.call(r,i,t[o],o);return i},Ct=function(t,e,n){for(var r=0,i=t.length;r<i;r++)if(e.call(n,t[r],r,t))return r;return-1},Mt=function(t){return t[t.length-1]},Tt=function(){return(Tt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function kt(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var At,It,Dt,Ot,Pt,Et=function(){return Rt(0,0)},Rt=function(t,e){return{major:t,minor:e}},Lt=function(t,e){var n=String(e).toLowerCase();return 0===t.length?Et():function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return Rt(r(1),r(2))}(t,n)},Nt=Et,Bt=function(t,e){var n=String(e).toLowerCase();return Z(t,function(t){return t.search(n)})},zt=function(t,e){return-1!==t.indexOf(e)},Vt=function(t,e){return n=t,""===(r=e)||n.length>=r.length&&n.substr(0,0+r.length)===r;var n,r},Ft=function(t){return function(e){return e.replace(t,"")}},Ht=Ft(/^\s+|\s+$/g),Wt=Ft(/^\s+/g),jt=Ft(/\s+$/g),Gt=function(t){return 0<t.length},Ut=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,qt=function(t){return function(e){return zt(e,t)}},Xt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return zt(t,"edge/")&&zt(t,"chrome")&&zt(t,"safari")&&zt(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ut],search:function(t){return zt(t,"chrome")&&!zt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return zt(t,"msie")||zt(t,"trident")}},{name:"Opera",versionRegexes:[Ut,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:qt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:qt("firefox")},{name:"Safari",versionRegexes:[Ut,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(zt(t,"safari")||zt(t,"mobile/"))&&zt(t,"applewebkit")}}],Yt=[{name:"Windows",search:qt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return zt(t,"iphone")||zt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:qt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:qt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:qt("linux"),versionRegexes:[]},{name:"Solaris",search:qt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:qt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:qt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],$t={browsers:w(Xt),oses:w(Yt)},Zt="Firefox",Kt=function(t){var e=t.current,n=function(t){return function(){return e===t}};return{current:e,version:t.version,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(Zt),isSafari:n("Safari")}},Jt=function(){return Kt({current:void 0,version:Nt()})},Qt=Kt,te=(w("Edge"),w("Chrome"),w("IE"),w("Opera"),w(Zt),w("Safari"),"Windows"),ee="Android",ne="Solaris",re="FreeBSD",ie="ChromeOS",oe=function(t){var e=t.current,n=function(t){return function(){return e===t}};return{current:e,version:t.version,isWindows:n(te),isiOS:n("iOS"),isAndroid:n(ee),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(ne),isFreeBSD:n(re),isChromeOS:n(ie)}},ae=function(){return oe({current:void 0,version:Nt()})},se=oe,le=(w(te),w("iOS"),w(ee),w("Linux"),w("OSX"),w(ne),w(re),w(ie),function(t,e){var n,r,i,o,a,s,l,u,c,d,f,h,p=$t.browsers(),g=$t.oses(),m=function(t,e){return Bt(t,e).map(function(t){var n=Lt(t.versionRegexes,e);return{current:t.name,version:n}})}(p,t).fold(Jt,Qt),v=function(t,e){return Bt(t,e).map(function(t){var n=Lt(t.versionRegexes,e);return{current:t.name,version:n}})}(g,t).fold(ae,se);return{browser:m,os:v,deviceType:(r=m,i=t,o=e,a=(n=v).isiOS()&&!0===/ipad/i.test(i),s=n.isiOS()&&!a,l=n.isiOS()||n.isAndroid(),u=l||o("(pointer:coarse)"),c=a||!s&&l&&o("(min-device-width:768px)"),d=s||l&&!c,f=r.isSafari()&&n.isiOS()&&!1===/safari/i.test(i),h=!d&&!c&&!f,{isiPad:w(a),isiPhone:w(s),isTablet:w(c),isPhone:w(d),isTouch:w(u),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:w(f),isDesktop:w(h)})}}),ue=function(t){return window.matchMedia(t).matches},ce=(Dt=!(At=function(){return le(navigator.userAgent,ue)}),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dt||(Dt=!0,It=At.apply(null,t)),It}),de=function(){return ce()},fe=navigator.userAgent,he=de(),pe=he.browser,ge=he.os,me=he.deviceType,ve=/WebKit/.test(fe)&&!pe.isEdge(),ye="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL,xe=-1!==fe.indexOf("Windows Phone"),be={opera:pe.isOpera(),webkit:ve,ie:!(!pe.isIE()&&!pe.isEdge())&&pe.version.major,gecko:pe.isFirefox(),mac:ge.isOSX()||ge.isiOS(),iOS:me.isiPad()||me.isiPhone(),android:ge.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:window.getSelection&&"Range"in window,documentMode:pe.isIE()?document.documentMode||7:10,fileApi:ye,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!pe.isIE(),desktop:me.isDesktop(),windowsPhone:xe,browser:{current:pe.current,version:pe.version,isChrome:pe.isChrome,isEdge:pe.isEdge,isFirefox:pe.isFirefox,isIE:pe.isIE,isOpera:pe.isOpera,isSafari:pe.isSafari},os:{current:ge.current,version:ge.version,isAndroid:ge.isAndroid,isChromeOS:ge.isChromeOS,isFreeBSD:ge.isFreeBSD,isiOS:ge.isiOS,isLinux:ge.isLinux,isOSX:ge.isOSX,isSolaris:ge.isSolaris,isWindows:ge.isWindows},deviceType:{isDesktop:me.isDesktop,isiPad:me.isiPad,isiPhone:me.isiPhone,isPhone:me.isPhone,isTablet:me.isTablet,isTouch:me.isTouch,isWebView:me.isWebView}},_e=/^\s*|\s*$/g,we=function(t){return null==t?"":(""+t).replace(_e,"")},Se=function(t,e){return e?!("array"!==e||!yt(t))||typeof t===e:void 0!==t},Ce=function(t,e,n,r){r=r||this,t&&(n&&(t=t[n]),xt(t,function(t,i){return!1!==e.call(r,t,i,n)&&void Ce(t,e,n,r)}))},Me={trim:we,isArray:yt,is:Se,toArray:function(t){if(yt(t))return t;for(var e=[],n=0,r=t.length;n<r;n++)e[n]=t[n];return e},makeMap:function(t,e,n){var r;for(e=e||",","string"==typeof(t=t||[])&&(t=t.split(e)),n=n||{},r=t.length;r--;)n[t[r]]={};return n},each:xt,map:bt,grep:_t,inArray:wt,hasOwn:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},extend:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++){var i,o=e[r];for(var a in o)!o.hasOwnProperty(a)||void 0!==(i=o[a])&&(t[a]=i)}return t},create:function(t,e,n){var r,i,o,a=this,s=0,l=(t=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(t))[3].match(/(^|\.)(\w+)$/i)[2],u=a.createNS(t[3].replace(/\.\w+$/,""),n);if(!u[l]){if("static"===t[2])return u[l]=e,void(this.onCreate&&this.onCreate(t[2],t[3],u[l]));e[l]||(e[l]=function(){},s=1),u[l]=e[l],a.extend(u[l].prototype,e),t[5]&&(r=a.resolve(t[5]).prototype,i=t[5].match(/\.(\w+)$/i)[1],o=u[l],u[l]=s?function(){return r[i].apply(this,arguments)}:function(){return this.parent=r[i],o.apply(this,arguments)},u[l].prototype[l]=u[l],a.each(r,function(t,e){u[l].prototype[e]=r[e]}),a.each(e,function(t,e){r[e]?u[l].prototype[e]=function(){return this.parent=r[e],t.apply(this,arguments)}:e!==l&&(u[l].prototype[e]=t)})),a.each(e.static,function(t,e){u[l][e]=t})}},walk:Ce,createNS:function(t,e){var n,r;for(e=e||window,t=t.split("."),n=0;n<t.length;n++)e[r=t[n]]||(e[r]={}),e=e[r];return e},resolve:function(t,e){var n,r;for(e=e||window,n=0,r=(t=t.split(".")).length;n<r&&(e=e[t[n]]);n++);return e},explode:function(t,e){return!t||Se(t,"array")?t:bt(t.split(e||","),we)},_addCacheSuffix:function(t){var e=be.cacheSuffix;return e&&(t+=(-1===t.indexOf("?")?"?":"&")+e),t}},Te=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},ke=function(t,e){var n=(e||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Te(n.childNodes[0])},Ae=function(t,e){var n=(e||document).createElement(t);return Te(n)},Ie=function(t,e){var n=(e||document).createTextNode(t);return Te(n)},De=Te,Oe=function(t,e){for(var n=[],r=function(t){return n.push(t),e(t)},i=e(t);(i=i.bind(r)).isSome(););return n},Pe=function(t,e){var n=t.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},Ee=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Re=function(t,e){return t.dom===e.dom},Le=function(t,e){return de().browser.isIE()?function(t,e){return n=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(t.dom.compareDocumentPosition(e.dom)&n);var n}(t,e):(n=t.dom)!==(r=e.dom)&&n.contains(r);var n,r},Ne=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),Be=function(t){return t.dom.nodeType},ze=function(t){return function(e){return Be(e)===t}},Ve=ze(1),Fe=ze(3),He=ze(9),We=ze(11),je=function(t){return De(t.dom.ownerDocument)},Ge=function(t){return He(t)?t:je(t)},Ue=function(t){return B.from(t.dom.parentNode).map(De)},qe=function(t){return B.from(t.dom.previousSibling).map(De)},Xe=function(t){return B.from(t.dom.nextSibling).map(De)},Ye=function(t){return tt(Oe(t,qe))},$e=function(t){return Oe(t,Xe)},Ze=function(t){return G(t.dom.childNodes,De)},Ke=function(t,e){return B.from(t.dom.childNodes[e]).map(De)},Je=function(t){return Ke(t,0)},Qe=function(t){return Ke(t,t.dom.childNodes.length-1)},tn=function(t){return We(t)&&v(t.dom.host)},en=y(Element.prototype.attachShadow)&&y(Node.prototype.getRootNode),nn=w(en),rn=en?function(t){return De(t.dom.getRootNode())}:Ge,on=function(t){return tn(t)?t:function(t){var e=t.dom.head;if(null==e)throw new Error("Head is not available yet");return De(e)}(Ge(t))},an=function(t){return De(t.dom.host)},sn=function(t,e){Ue(t).each(function(n){n.dom.insertBefore(e.dom,t.dom)})},ln=function(t,e){Xe(t).fold(function(){Ue(t).each(function(t){cn(t,e)})},function(t){sn(t,e)})},un=function(t,e){Je(t).fold(function(){cn(t,e)},function(n){t.dom.insertBefore(e.dom,n.dom)})},cn=function(t,e){t.dom.appendChild(e.dom)},dn=function(t,e){U(e,function(e){cn(t,e)})},fn=function(t){t.dom.textContent="",U(Ze(t),function(t){hn(t)})},hn=function(t){var e=t.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},pn=function(t){var e,n=Ze(t);0<n.length&&(e=t,U(n,function(t){sn(e,t)})),hn(t)},gn=function(t){var e=Fe(t)?t.dom.parentNode:t.dom;if(null==e||null===e.ownerDocument)return!1;var n,r,i,o,a=e.ownerDocument;return i=De(e),o=rn(i),(tn(o)?B.some(o):B.none()).fold(function(){return a.body.contains(e)},(n=gn,r=an,function(t){return n(r(t))}))},mn=function(t,e){return{left:t,top:e,translate:function(n,r){return mn(t+n,e+r)}}},vn=mn,yn=function(t,e){return void 0!==t?t:void 0!==e?e:0},xn=function(t){var e,n=t.dom,r=n.ownerDocument.body;return r===n?vn(r.offsetLeft,r.offsetTop):gn(t)?(e=n.getBoundingClientRect(),vn(e.left,e.top)):vn(0,0)},bn=function(t){var e=void 0!==t?t.dom:document;return vn(e.body.scrollLeft||e.documentElement.scrollLeft,e.body.scrollTop||e.documentElement.scrollTop)},_n=function(t,e){de().browser.isSafari()&&y(t.dom.scrollIntoViewIfNeeded)?t.dom.scrollIntoViewIfNeeded(!1):t.dom.scrollIntoView(e)},wn=function(t,e,n,r){return{x:t,y:e,width:n,height:r,right:t+n,bottom:e+r}},Sn=function(t){var e,n,r=void 0===t?window:t,i=bn(De(r.document));return n=void 0===(e=r)?window:e,B.from(n.visualViewport).fold(function(){var t=r.document.documentElement;return wn(i.left,i.top,t.clientWidth,t.clientHeight)},function(t){return wn(Math.max(t.pageLeft,i.left),Math.max(t.pageTop,i.top),t.width,t.height)})},Cn=function(t){return function(e){return!!e&&e.nodeType===t}},Mn=function(t){return!!t&&!Object.getPrototypeOf(t)},Tn=Cn(1),kn=function(t){var e=t.map(function(t){return t.toLowerCase()});return function(t){if(t&&t.nodeName){var n=t.nodeName.toLowerCase();return W(e,n)}return!1}},An=function(t,e){var n=e.toLowerCase().split(" ");return function(e){var r;if(Tn(e))for(r=0;r<n.length;r++){var i=e.ownerDocument.defaultView.getComputedStyle(e,null);if((i?i.getPropertyValue(t):null)===n[r])return!0}return!1}},In=function(t){return function(e){return Tn(e)&&e.hasAttribute(t)}},Dn=function(t){return Tn(t)&&t.hasAttribute("data-mce-bogus")},On=function(t){return Tn(t)&&"TABLE"===t.tagName},Pn=function(t){return function(e){if(Tn(e)){if(e.contentEditable===t)return!0;if(e.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},En=kn(["textarea","input"]),Rn=Cn(3),Ln=Cn(8),Nn=Cn(9),Bn=Cn(11),zn=kn(["br"]),Vn=kn(["img"]),Fn=Pn("true"),Hn=Pn("false"),Wn=kn(["td","th"]),jn=kn(["video","audio","object","embed"]),Gn=function(t){return void 0!==t.style&&y(t.style.getPropertyValue)},Un=function(t,e,n){if(!(c(n)||p(n)||x(n)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},qn=function(t,e,n){Un(t.dom,e,n)},Xn=function(t,e){var n=t.dom;lt(e,function(t,e){Un(n,e,t)})},Yn=function(t,e){var n=t.dom.getAttribute(e);return null===n?void 0:n},$n=function(t,e){return B.from(Yn(t,e))},Zn=function(t,e){t.dom.removeAttribute(e)},Kn=function(t,e){var n=t.dom,r=window.getComputedStyle(n).getPropertyValue(e);return""!==r||gn(t)?r:Jn(n,e)},Jn=function(t,e){return Gn(t)?t.style.getPropertyValue(e):""},Qn=function(t,e){var n=Jn(t.dom,e);return B.from(n).filter(function(t){return 0<t.length})},tr=function(t){var e={},n=t.dom;if(Gn(n))for(var r=0;r<n.style.length;r++){var i=n.style.item(r);e[i]=n.style[i]}return e},er=de().browser,nr=function(t){return Z(t,Ve)},rr=function(t,e){return t.children&&W(t.children,e)},ir={},or={exports:ir};Ot=ir,Pt=or,function(t){"object"==typeof Ot&&void 0!==Pt?Pt.exports=t():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}(function(){return function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){return i(e[a][1][t]||t)},u,u.exports,t,e,n,r)}return n[a].exports}for(var o=!1,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){var r,i,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(t){r=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var u,c=[],d=!1,f=-1;function h(){d&&u&&(d=!1,u.length?c=u.concat(c):f=-1,c.length&&p())}function p(){if(!d){var t=l(h);d=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,d=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new g(t,e)),1!==c.length||d||l(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],2:[function(t,e,n){(function(t){function n(){}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(t,this)}function i(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn(function(){var n,r=1===t._state?e.onFulfilled:e.onRejected;if(null!==r){try{n=r(t._value)}catch(c){return void a(e.promise,c)}o(e.promise,n)}else(1===t._state?o:a)(e.promise,t._value)})):t._deferreds.push(e)}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof r)return t._state=3,t._value=e,void s(t);if("function"==typeof n)return void u((i=n,l=e,function(){i.apply(l,arguments)}),t)}t._state=1,t._value=e,s(t)}catch(o){a(t,o)}var i,l}function a(t,e){t._state=2,t._value=e,s(t)}function s(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function l(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function u(t,e){var r=!1;try{t(function(t){r||(r=!0,o(e,t))},function(t){r||(r=!0,a(e,t))})}catch(n){if(r)return;r=!0,a(e,n)}}var c;c=setTimeout,r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var r=new this.constructor(n);return i(this,new l(t,e,r)),r},r.all=function(t){var e=Array.prototype.slice.call(t);return new r(function(t,r){if(0===e.length)return t([]);for(var i=e.length,o=0;o<e.length;o++)!function o(a,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var l=s.then;if("function"==typeof l)return void l.call(s,function(t){o(a,t)},r)}e[a]=s,0==--i&&t(e)}catch(n){r(n)}}(o,e[o])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},r._immediateFn="function"==typeof t?function(e){t(e)}:function(t){c(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},void 0!==e&&e.exports?e.exports=r:this.Promise||(this.Promise=r)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,e,n){(function(e,r){var i=t("process/browser.js").nextTick,o=Function.prototype.apply,a=Array.prototype.slice,s={},l=0;function u(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new u(o.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new u(o.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n.setImmediate="function"==typeof e?e:function(t){var e=l++,r=!(arguments.length<2)&&a.call(arguments,1);return s[e]=!0,i(function(){s[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))}),e},n.clearImmediate="function"==typeof r?r:function(t){delete s[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,e,n){var r=t("promise-polyfill"),i="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:i.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var ar=or.exports.boltExport,sr=function(t){var e=B.none(),n=[],r=function(t){i()?o(t):n.push(t)},i=function(){return e.isSome()},o=function(t){e.each(function(e){setTimeout(function(){t(e)},0)})};return t(function(t){i()||(e=B.some(t),function(t){U(t,o)}(n),n=[])}),{get:r,map:function(t){return sr(function(e){r(function(n){e(t(n))})})},isReady:i}},lr={nu:sr,pure:function(t){return sr(function(e){e(t)})}},ur=function(t){setTimeout(function(){throw t},0)},cr=function(t){var e=function(e){t().then(e,ur)};return{map:function(e){return cr(function(){return t().then(e)})},bind:function(e){return cr(function(){return t().then(function(t){return e(t).toPromise()})})},anonBind:function(e){return cr(function(){return t().then(function(){return e.toPromise()})})},toLazy:function(){return lr.nu(e)},toCached:function(){var e=null;return cr(function(){return null===e&&(e=t()),e})},toPromise:t,get:e}},dr=function(t){return cr(function(){return new ar(t)})},fr=function(t){return{is:function(e){return t===e},isValue:E,isError:P,getOr:w(t),getOrThunk:w(t),getOrDie:w(t),or:function(e){return fr(t)},orThunk:function(e){return fr(t)},fold:function(e,n){return n(t)},map:function(e){return fr(e(t))},mapError:function(e){return fr(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOptional:function(){return B.some(t)}}},hr=function(t){return{is:P,isValue:P,isError:E,getOr:S,getOrThunk:function(t){return t()},getOrDie:function(){return I(String(t))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return hr(t)},mapError:function(e){return hr(e(t))},each:b,bind:function(e){return hr(t)},exists:P,forall:E,toOptional:B.none}},pr={value:fr,error:hr,fromOption:function(t,e){return t.fold(function(){return hr(e)},fr)}},gr=function(t){if(!f(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],n={};return U(t,function(r,i){var o=at(r);if(1!==o.length)throw new Error("one and only one name per case");var a=o[0],s=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!f(s))throw new Error("case arguments must be an array");e.push(a),n[a]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=n.length;if(o!==s.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+s.length+" ("+s+"), got "+o);return{fold:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+e.length);return e[i].apply(null,n)},match:function(t){var r=at(t);if(e.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+r.join(","));if(!Q(e,function(t){return W(r,t)}))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+e.join(", "));return t[a].apply(null,n)},log:function(t){console.log(t,{constructors:e,constructor:a,params:n})}}}}),n},mr=(gr([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t){return t.fold(S,S)});function vr(t,e,n,r,i){return t(n,r)?B.some(n):y(i)&&i(n)?B.none():e(n,r,i)}var yr,xr,br,_r,wr,Sr,Cr=function(t,e,n){for(var r=t.dom,i=y(n)?n:P;r.parentNode;){var o=De(r=r.parentNode);if(e(o))return B.some(o);if(i(o))break}return B.none()},Mr=function(t,e,n){return vr(function(t,e){return e(t)},Cr,t,e,n)},Tr=function(t,e,n){return Cr(t,function(t){return Pe(t,e)},n)},kr=function(t,e){return n=e,i=void 0===(r=t)?document:r.dom,Ee(i)?B.none():B.from(i.querySelector(n)).map(De);var n,r,i},Ar=function(t,e,n){return vr(Pe,Tr,t,e,n)},Ir=window.Promise?window.Promise:(yr=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t.apply(e,n)}},xr=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},_r=(br=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],wr(t,yr(Or,this),yr(Pr,this))}).immediateFn||"function"==typeof setImmediate&&setImmediate||function(t){return setTimeout(t,1)},wr=function(t,e,n){var r=!1;try{t(function(t){r||(r=!0,e(t))},function(t){r||(r=!0,n(t))})}catch(u){if(r)return;r=!0,n(u)}},br.prototype.catch=function(t){return this.then(null,t)},br.prototype.then=function(t,e){var n=this;return new br(function(r,i){Dr.call(n,new Rr(t,e,r,i))})},br.all=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Array.prototype.slice.call(1===e.length&&xr(e[0])?e[0]:e);return new br(function(e,n){if(0===r.length)return e([]);for(var i=r.length,o=function(a,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var l=s.then;if("function"==typeof l)return void l.call(s,function(t){o(a,t)},n)}r[a]=s,0==--i&&e(r)}catch(t){n(t)}},a=0;a<r.length;a++)o(a,r[a])})},br.resolve=function(t){return t&&"object"==typeof t&&t.constructor===br?t:new br(function(e){e(t)})},br.reject=function(t){return new br(function(e,n){n(t)})},br.race=function(t){return new br(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},br);function Dr(t){var e=this;null!==this._state?_r(function(){var n,r=e._state?t.onFulfilled:t.onRejected;if(null!==r){try{n=r(e._value)}catch(l){return void t.reject(l)}t.resolve(n)}else(e._state?t.resolve:t.reject)(e._value)}):this._deferreds.push(t)}function Or(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void wr(yr(e,t),yr(Or,this),yr(Pr,this))}this._state=!0,this._value=t,Er.call(this)}catch(l){Pr.call(this,l)}}function Pr(t){this._state=!1,this._value=t,Er.call(this)}function Er(){for(var t=0,e=this._deferreds.length;t<e;t++)Dr.call(this,this._deferreds[t]);this._deferreds=null}function Rr(t,e,n,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=r}var Lr,Nr=function(t,e){return"number"!=typeof e&&(e=0),setTimeout(t,e)},Br=function(t,e){return"number"!=typeof e&&(e=1),setInterval(t,e)},zr=function(t,e){var n,r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];clearTimeout(n),n=Nr(function(){t.apply(this,r)},e)};return r.stop=function(){clearTimeout(n)},r},Vr={requestAnimationFrame:function(t,e){Sr?Sr.then(t):Sr=new Ir(function(t){!function(t,e){for(var n=window.requestAnimationFrame,r=["ms","moz","webkit"],i=0;i<r.length&&!n;i++)n=window[r[i]+"RequestAnimationFrame"];(n=n||function(t){window.setTimeout(t,0)})(t,e)}(t,e=e||document.body)}).then(t)},setTimeout:Nr,setInterval:Br,setEditorTimeout:function(t,e,n){return Nr(function(){t.removed||e()},n)},setEditorInterval:function(t,e,n){var r=Br(function(){t.removed?clearInterval(r):e()},n);return r},debounce:zr,throttle:zr,clearInterval:function(t){return clearInterval(t)},clearTimeout:function(t){return clearTimeout(t)}},Fr=function(t,e){void 0===e&&(e={});var n=0,r={},i=De(t),o=Ge(i),a=e.maxLoadTime||5e3,s=function(s,l,u){var c,d=Me._addCacheSuffix(s),f=gt(r,d).getOrThunk(function(){return{id:"mce-u"+n++,passed:[],failed:[],count:0}});(r[d]=f).count++;var h,p,g,m=function(t,e){for(var n=t.length;n--;)t[n]();f.status=e,f.passed=[],f.failed=[],c&&(c.onload=null,c.onerror=null,c=null)},v=function(){return m(f.passed,2)},y=function(){return m(f.failed,3)},x=function(){var e;e=x,function(){for(var e=t.styleSheets,n=e.length;n--;){var r=e[n].ownerNode;if(r&&r.id===c.id)return v(),1}}()||(Date.now()-p<a?Vr.setTimeout(e):y())};l&&f.passed.push(l),u&&f.failed.push(u),1!==f.status&&(2!==f.status?3!==f.status?(f.status=1,h=Ae("link",o.dom),Xn(h,{rel:"stylesheet",type:"text/css",id:f.id}),p=Date.now(),e.contentCssCors&&qn(h,"crossOrigin","anonymous"),e.referrerPolicy&&qn(h,"referrerpolicy",e.referrerPolicy),(c=h.dom).onload=x,c.onerror=y,g=h,cn(on(i),g),qn(h,"href",d)):y():v())},l=function(t){return dr(function(e){s(t,_(e,w(pr.value(t))),_(e,w(pr.error(t))))})},u=function(t){var e=Me._addCacheSuffix(t);gt(r,e).each(function(t){var n,o;0==--t.count&&(delete r[e],n=t.id,o=on(i),kr(o,"#"+n).each(hn))})};return{load:s,loadAll:function(t,e,n){(function(t,e){return e(function(e){var n=[],r=0;0===t.length?e([]):U(t,function(i,o){var a;i.get((a=o,function(i){n[a]=i,++r>=t.length&&e(n)}))})})})(G(t,l),dr).get(function(t){var r=function(t,e){for(var n=[],r=[],i=0,o=t.length;i<o;i++){var a=t[i];(e(a)?n:r).push(a)}return{pass:n,fail:r}}(t,function(t){return t.isValue()});0<r.fail.length?n(r.fail.map(mr)):e(r.pass.map(mr))})},unload:u,unloadAll:function(t){U(t,function(t){u(t)})},_setReferrerPolicy:function(t){e.referrerPolicy=t}}},Hr=(Lr=new WeakMap,{forElement:function(t,e){var n=rn(t).dom;return B.from(Lr.get(n)).getOrThunk(function(){var t=Fr(n,e);return Lr.set(n,t),t})}}),Wr=(jr.prototype.current=function(){return this.node},jr.prototype.next=function(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node},jr.prototype.prev=function(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node},jr.prototype.prev2=function(t){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",t),this.node},jr.prototype.findSibling=function(t,e,n,r){var i,o;if(t){if(!r&&t[e])return t[e];if(t!==this.rootNode){if(i=t[n])return i;for(o=t.parentNode;o&&o!==this.rootNode;o=o.parentNode)if(i=o[n])return i}}},jr.prototype.findPreviousNode=function(t,e,n,r){var i,o,a;if(t){if(i=t[n],this.rootNode&&i===this.rootNode)return;if(i){if(!r)for(a=i[e];a;a=a[e])if(!a[e])return a;return i}if((o=t.parentNode)&&o!==this.rootNode)return o}},jr);function jr(t,e){this.node=t,this.rootNode=e,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}var Gr=function(t){var e;return function(n){return(e=e||function(t,e){for(var n={},r=0,i=t.length;r<i;r++){var o=t[r];n[String(o)]=e(o,r)}return n}(t,E)).hasOwnProperty(Ne(n))}},Ur=Gr(["h1","h2","h3","h4","h5","h6"]),qr=Gr(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),Xr=function(t){return Ve(t)&&!qr(t)},Yr=function(t){return Ve(t)&&"br"===Ne(t)},$r=Gr(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),Zr=Gr(["ul","ol","dl"]),Kr=Gr(["li","dd","dt"]),Jr=Gr(["thead","tbody","tfoot"]),Qr=Gr(["td","th"]),ti=Gr(["pre","script","textarea","style"]),ei=" ",ni="\ufeff",ri=function(t){return"\ufeff"===t},ii=function(t){return t.replace(/\uFEFF/g,"")},oi=Tn,ai=Rn,si=function(t){return ai(t)&&(t=t.parentNode),oi(t)&&t.hasAttribute("data-mce-caret")},li=function(t){return ai(t)&&ri(t.data)},ui=function(t){return si(t)||li(t)},ci=function(t){return t.firstChild!==t.lastChild||!zn(t.firstChild)},di=function(t){var e=t.container();return!!Rn(e)&&(e.data.charAt(t.offset())===ni||t.isAtStart()&&li(e.previousSibling))},fi=function(t){var e=t.container();return!!Rn(e)&&(e.data.charAt(t.offset()-1)===ni||t.isAtEnd()&&li(e.nextSibling))},hi=function(t){return ai(t)&&t.data[0]===ni},pi=function(t){return ai(t)&&t.data[t.data.length-1]===ni},gi=function(t){return t&&t.hasAttribute("data-mce-caret")?(e=t.getElementsByTagName("br"),Dn(n=e[e.length-1])&&n.parentNode.removeChild(n),t.removeAttribute("data-mce-caret"),t.removeAttribute("data-mce-bogus"),t.removeAttribute("style"),t.removeAttribute("_moz_abspos"),t):null;var e,n},mi=Fn,vi=Hn,yi=zn,xi=Rn,bi=kn(["script","style","textarea"]),_i=kn(["img","input","textarea","hr","iframe","video","audio","object","embed"]),wi=kn(["table"]),Si=ui,Ci=function(t){return!Si(t)&&(xi(t)?!bi(t.parentNode):_i(t)||yi(t)||wi(t)||Mi(t))},Mi=function(t){return!1===(Tn(e=t)&&"true"===e.getAttribute("unselectable"))&&vi(t);var e},Ti=function(t,e){return Ci(t)&&function(t,e){for(t=t.parentNode;t&&t!==e;t=t.parentNode){if(Mi(t))return!1;if(mi(t))return!0}return!0}(t,e)},ki=/^[ \t\r\n]*$/,Ai=function(t){return ki.test(t)},Ii=function(t,e){return Ci(t)&&!1===(i=e,Rn(r=t)&&Ai(r.data)&&!1===function(t,e){var n,r,i=De(e);return n=De(t),r=C(Re,i),Tr(n,"pre,code",r).isSome()}(r,i))||Tn(n=t)&&"A"===n.nodeName&&!n.hasAttribute("href")&&(n.hasAttribute("name")||n.hasAttribute("id"))||Di(t);var n,r,i},Di=In("data-mce-bookmark"),Oi=In("data-mce-bogus"),Pi=function(t){return Tn(t)&&"all"===t.getAttribute("data-mce-bogus")},Ei=function(t,e){return void 0===e&&(e=!0),function(t,e){var n,r=0;if(Ii(t,t))return!1;if(!(n=t.firstChild))return!0;var i=new Wr(n,t);do{if(e){if(Pi(n)){n=i.next(!0);continue}if(Oi(n)){n=i.next();continue}}if(zn(n))r++,n=i.next();else{if(Ii(n,t))return!1;n=i.next()}}while(n);return r<=1}(t.dom,e)},Ri=function(t,e){return v(t)&&(Ii(t,e)||Xr(De(t)))},Li=function(t){return"span"===t.nodeName.toLowerCase()&&"bookmark"===t.getAttribute("data-mce-type")},Ni=function(t,e,n){var r=n||e;if(Tn(e)&&Li(e))return e;for(var i,o,a,s=e.childNodes,l=s.length-1;0<=l;l--)Ni(t,s[l],r);return!Tn(e)||1===(i=e.childNodes).length&&Li(i[0])&&e.parentNode.insertBefore(i[0],e),Bn(a=e)||Nn(a)||Ii(e,r)||Tn(o=e)&&0<o.childNodes.length||function(t,e){return Rn(t)&&0<t.data.length&&(i=new Wr(n=t,r=e).prev(!1),o=new Wr(n,r).next(!1),a=g(i)||Ri(i,r),s=g(o)||Ri(o,r),a&&s);var n,r,i,o,a,s}(e,r)||t.remove(e),e},Bi=Me.makeMap,zi=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Vi=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Fi=/[<>&\"\']/g,Hi=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,Wi={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},ji={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},Gi={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},Ui=function(t,e){var n,r,i,o={};if(t){for(t=t.split(","),e=e||10,n=0;n<t.length;n+=2)r=String.fromCharCode(parseInt(t[n],e)),ji[r]||(o[r]=i="&"+t[n+1]+";",o[i]=r);return o}},qi=Ui("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Xi=function(t,e){return t.replace(e?zi:Vi,function(t){return ji[t]||t})},Yi=function(t,e){return t.replace(e?zi:Vi,function(t){return 1<t.length?"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";":ji[t]||"&#"+t.charCodeAt(0)+";"})},$i=function(t,e,n){return n=n||qi,t.replace(e?zi:Vi,function(t){return ji[t]||n[t]||t})},Zi={encodeRaw:Xi,encodeAllRaw:function(t){return(""+t).replace(Fi,function(t){return ji[t]||t})},encodeNumeric:Yi,encodeNamed:$i,getEncodeFunc:function(t,e){var n=Ui(e)||qi,r=Bi(t.replace(/\+/g,","));return r.named&&r.numeric?function(t,e){return t.replace(e?zi:Vi,function(t){return void 0!==ji[t]?ji[t]:void 0!==n[t]?n[t]:1<t.length?"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";":"&#"+t.charCodeAt(0)+";"})}:r.named?e?function(t,e){return $i(t,e,n)}:$i:r.numeric?Yi:Xi},decode:function(t){return t.replace(Hi,function(t,e){return e?65535<(e="x"===e.charAt(0).toLowerCase()?parseInt(e.substr(1),16):parseInt(e,10))?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):Wi[e]||String.fromCharCode(e):Gi[t]||qi[t]||(n=t,(r=Ae("div").dom).innerHTML=n,r.textContent||r.innerText||n);var n,r})}},Ki={},Ji={},Qi=Me.makeMap,to=Me.each,eo=Me.extend,no=Me.explode,ro=Me.inArray,io=function(t,e){return(t=Me.trim(t))?t.split(e||" "):[]},oo=function(t,e){var n;return t&&(n={},"string"==typeof t&&(t={"*":t}),to(t,function(t,r){n[r]=n[r.toUpperCase()]=("map"===e?Qi:no)(t,/[, ]/)})),n},ao=function(t){var e,n,r,i,o,a,s,l,u,c,d={},f={},h=[],p={},g={},m=function(e,n,r){var i=t[e];return i?i=Qi(i,/[, ]/,Qi(i.toUpperCase(),/[, ]/)):(i=Ki[e])||(i=Qi(n," ",Qi(n.toUpperCase()," ")),i=eo(i,r),Ki[e]=i),i},v=(e=(t=t||{}).schema,l={},u=function(t,e,r){var i,o,a=function(t,e){for(var n={},r=0,i=t.length;r<i;r++)n[t[r]]=e||{};return n};e=e||"","string"==typeof(r=r||[])&&(r=io(r));for(var s=io(t),u=s.length;u--;)o={attributes:a(i=io([n,e].join(" "))),attributesOrder:i,children:a(r,Ji)},l[s[u]]=o},c=function(t,e){for(var n,r,i,o=io(t),a=o.length,s=io(e);a--;)for(n=l[o[a]],r=0,i=s.length;r<i;r++)n.attributes[s[r]]={},n.attributesOrder.push(s[r])},Ki[e]?Ki[e]:(n="id accesskey class dir lang style tabindex title role",r="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",i="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(n+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",r+=" article aside details dialog figure main header footer hgroup section nav",i+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(n+=" xml:lang",i=[i,s="acronym applet basefont big font strike tt"].join(" "),to(io(s),function(t){u(t,"",i)}),r=[r,a="center dir isindex noframes"].join(" "),o=[r,i].join(" "),to(io(a),function(t){u(t,"",o)})),o=o||[r,i].join(" "),u("html","manifest","head body"),u("head","","base command link meta noscript script style title"),u("title hr noscript br"),u("base","href target"),u("link","href rel media hreflang type sizes hreflang"),u("meta","name http-equiv content charset"),u("style","media type scoped"),u("script","src async defer type charset"),u("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",o),u("address dt dd div caption","",o),u("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",i),u("blockquote","cite",o),u("ol","reversed start type","li"),u("ul","","li"),u("li","value",o),u("dl","","dt dd"),u("a","href target rel media hreflang type",i),u("q","cite",i),u("ins del","cite datetime",o),u("img","src sizes srcset alt usemap ismap width height"),u("iframe","src name width height",o),u("embed","src type width height"),u("object","data type typemustmatch name usemap form width height",[o,"param"].join(" ")),u("param","name value"),u("map","name",[o,"area"].join(" ")),u("area","alt coords shape href target rel media hreflang type"),u("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),u("colgroup","span","col"),u("col","span"),u("tbody thead tfoot","","tr"),u("tr","","td th"),u("td","colspan rowspan headers",o),u("th","colspan rowspan headers scope abbr",o),u("form","accept-charset action autocomplete enctype method name novalidate target",o),u("fieldset","disabled form name",[o,"legend"].join(" ")),u("label","form for",i),u("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),u("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?o:i),u("select","disabled form multiple name required size","option optgroup"),u("optgroup","disabled label","option"),u("option","disabled label selected value"),u("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),u("menu","type label",[o,"li"].join(" ")),u("noscript","",o),"html4"!==e&&(u("wbr"),u("ruby","",[i,"rt rp"].join(" ")),u("figcaption","",o),u("mark rt rp summary bdi","",i),u("canvas","width height",o),u("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[o,"track source"].join(" ")),u("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[o,"track source"].join(" ")),u("picture","","img source"),u("source","src srcset type media sizes"),u("track","kind src srclang label default"),u("datalist","",[i,"option"].join(" ")),u("article section nav aside main header footer","",o),u("hgroup","","h1 h2 h3 h4 h5 h6"),u("figure","",[o,"figcaption"].join(" ")),u("time","datetime",i),u("dialog","open",o),u("command","type label icon disabled checked radiogroup command"),u("output","for form name",i),u("progress","value max",i),u("meter","value min max low high optimum",i),u("details","open",[o,"summary"].join(" ")),u("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(c("script","language xml:space"),c("style","xml:space"),c("object","declare classid code codebase codetype archive standby align border hspace vspace"),c("embed","align name hspace vspace"),c("param","valuetype type"),c("a","charset name rev shape coords"),c("br","clear"),c("applet","codebase archive code object alt name width height align hspace vspace"),c("img","name longdesc align border hspace vspace"),c("iframe","longdesc frameborder marginwidth marginheight scrolling align"),c("font basefont","size color face"),c("input","usemap align"),c("select"),c("textarea"),c("h1 h2 h3 h4 h5 h6 div p legend caption","align"),c("ul","type compact"),c("li","type"),c("ol dl menu dir","compact"),c("pre","width xml:space"),c("hr","align noshade size width"),c("isindex","prompt"),c("table","summary width frame rules cellspacing cellpadding align bgcolor"),c("col","width align char charoff valign"),c("colgroup","width align char charoff valign"),c("thead","align char charoff valign"),c("tr","align char charoff valign bgcolor"),c("th","axis align char charoff valign nowrap bgcolor width height"),c("form","accept"),c("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),c("tfoot","align char charoff valign"),c("tbody","align char charoff valign"),c("area","nohref"),c("body","background bgcolor text link vlink alink")),"html4"!==e&&(c("input button select textarea","autofocus"),c("input textarea","placeholder"),c("a","download"),c("link script img","crossorigin"),c("img","loading"),c("iframe","sandbox seamless allowfullscreen loading")),to(io("a form meter progress dfn"),function(t){l[t]&&delete l[t].children[t]}),delete l.caption.children.table,delete l.script,Ki[e]=l));!1===t.verify_html&&(t.valid_elements="*[*]");var y=oo(t.valid_styles),x=oo(t.invalid_styles,"map"),b=oo(t.valid_classes,"map"),_=m("whitespace_elements","pre script noscript style textarea video audio iframe object code"),w=m("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),S=m("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),C=m("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),M="td th iframe video audio object script code",T=m("non_empty_elements",M+" pre",S),k=m("move_caret_before_on_enter_elements",M+" table",S),A=m("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),I=m("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",A),D=m("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp");to((t.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),function(t){g[t]=new RegExp("</"+t+"[^>]*>","gi")});var O=function(t){return new RegExp("^"+t.replace(/([?+*])/g,".$1")+"$")},P=function(t){var e,n,r,i,o,a,s,l,u,c,f,p,g,m,v,y,x,b,_=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,w=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,S=/[*?+]/;if(t){var C=io(t,",");for(d["@"]&&(y=d["@"].attributes,x=d["@"].attributesOrder),e=0,n=C.length;e<n;e++)if(o=_.exec(C[e])){if(u=o[2],v=o[3],l=o[5],a={attributes:p={},attributesOrder:g=[]},"#"===(m=o[1])&&(a.paddEmpty=!0),"-"===m&&(a.removeEmpty=!0),"!"===o[4]&&(a.removeEmptyAttrs=!0),y&&(lt(y,function(t,e){p[e]=t}),g.push.apply(g,x)),l)for(r=0,i=(l=io(l,"|")).length;r<i;r++)if(o=w.exec(l[r])){if(s={},f=o[1],c=o[2].replace(/[\\:]:/g,":"),m=o[3],b=o[4],"!"===f&&(a.attributesRequired=a.attributesRequired||[],a.attributesRequired.push(c),s.required=!0),"-"===f){delete p[c],g.splice(ro(g,c),1);continue}m&&("="===m&&(a.attributesDefault=a.attributesDefault||[],a.attributesDefault.push({name:c,value:b}),s.defaultValue=b),":"===m&&(a.attributesForced=a.attributesForced||[],a.attributesForced.push({name:c,value:b}),s.forcedValue=b),"<"===m&&(s.validValues=Qi(b,"?"))),S.test(c)?(a.attributePatterns=a.attributePatterns||[],s.pattern=O(c),a.attributePatterns.push(s)):(p[c]||g.push(c),p[c]=s)}y||"@"!==u||(y=p,x=g),v&&(a.outputName=u,d[v]=a),S.test(u)?(a.pattern=O(u),h.push(a)):d[u]=a}}},E=function(t){d={},h=[],P(t),to(v,function(t,e){f[e]=t.children})},R=function(t){var e=/^(~)?(.+)$/;t&&(Ki.text_block_elements=Ki.block_elements=null,to(io(t,","),function(t){var n,r=e.exec(t),i="~"===r[1],o=i?"span":"div",a=r[2];f[a]=f[o],p[a]=o,i||(I[a.toUpperCase()]={},I[a]={}),d[a]||(delete(n=eo({},n=d[o])).removeEmptyAttrs,delete n.removeEmpty,d[a]=n),to(f,function(t,e){t[o]&&(f[e]=t=eo({},f[e]),t[a]=t[o])})}))},L=function(e){var n=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;Ki[t.schema]=null,e&&to(io(e,","),function(t){var e,r,i=n.exec(t);i&&(e=(r=i[1])?f[i[2]]:f[i[2]]={"#comment":{}},e=f[i[2]],to(io(i[3],"|"),function(t){"-"===r?delete e[t]:e[t]={}}))})},N=function(t){var e,n=d[t];if(n)return n;for(e=h.length;e--;)if((n=h[e]).pattern.test(t))return n};return t.valid_elements?E(t.valid_elements):(to(v,function(t,e){d[e]={attributes:t.attributes,attributesOrder:t.attributesOrder},f[e]=t.children}),"html5"!==t.schema&&to(io("strong/b em/i"),function(t){var e=io(t,"/");d[e[1]].outputName=e[0]}),to(io("ol ul sub sup blockquote span font a table tbody strong em b i"),function(t){d[t]&&(d[t].removeEmpty=!0)}),to(io("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),function(t){d[t].paddEmpty=!0}),to(io("span"),function(t){d[t].removeEmptyAttrs=!0})),R(t.custom_elements),L(t.valid_children),P(t.extended_valid_elements),L("+ol[ul|ol],+ul[ul|ol]"),to({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},function(t,e){d[e]&&(d[e].parentsRequired=io(t))}),t.invalid_elements&&to(no(t.invalid_elements),function(t){d[t]&&delete d[t]}),N("span")||P("span[!data-mce-type|*]"),{children:f,elements:d,getValidStyles:function(){return y},getValidClasses:function(){return b},getBlockElements:function(){return I},getInvalidStyles:function(){return x},getShortEndedElements:function(){return S},getTextBlockElements:function(){return A},getTextInlineElements:function(){return D},getBoolAttrs:function(){return C},getElementRule:N,getSelfClosingElements:function(){return w},getNonEmptyElements:function(){return T},getMoveCaretBeforeOnEnterElements:function(){return k},getWhiteSpaceElements:function(){return _},getSpecialElements:function(){return g},isValidChild:function(t,e){var n=f[t.toLowerCase()];return!(!n||!n[e.toLowerCase()])},isValid:function(t,e){var n,r,i=N(t);if(i){if(!e)return!0;if(i.attributes[e])return!0;if(n=i.attributePatterns)for(r=n.length;r--;)if(n[r].pattern.test(t))return!0}return!1},getCustomElements:function(){return p},addValidElements:P,setValidElements:E,addCustomElements:R,addValidChildren:L}},so=function(t,e,n,r){var i=function(t){return 1<(t=parseInt(t,10).toString(16)).length?t:"0"+t};return"#"+i(e)+i(n)+i(r)},lo=function(t,e){var n,r,i=this,o=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,a=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,l=/\s+$/,u={};t=t||{},e&&(n=e.getValidStyles(),r=e.getInvalidStyles());for(var c="\\\" \\' \\; \\: ; : \ufeff".split(" "),d=0;d<c.length;d++)u[c[d]]="\ufeff"+d,u["\ufeff"+d]=c[d];return{toHex:function(t){return t.replace(o,so)},parse:function(e){var n,r,c,f,h,p,g,m={},v=t.url_converter,y=t.url_converter_scope||i,x=function(t,e,n){var r=m[t+"-top"+e];if(r){var i=m[t+"-right"+e];if(i){var o=m[t+"-bottom"+e];if(o){var a=m[t+"-left"+e];if(a){var s=[r,i,o,a];for(d=s.length-1;d--&&s[d]===s[d+1];);-1<d&&n||(m[t+e]=-1===d?s[0]:s.join(" "),delete m[t+"-top"+e],delete m[t+"-right"+e],delete m[t+"-bottom"+e],delete m[t+"-left"+e])}}}}},b=function(t){var e,n=m[t];if(n){for(e=(n=n.split(" ")).length;e--;)if(n[e]!==n[0])return!1;return m[t]=n[0],!0}},_=function(t){return f=!0,u[t]},w=function(t,e){return f&&(t=t.replace(/\uFEFF[0-9]/g,function(t){return u[t]})),e||(t=t.replace(/\\([\'\";:])/g,"$1")),t},S=function(t){return String.fromCharCode(parseInt(t.slice(1),16))},C=function(t){return t.replace(/\\[0-9a-f]+/gi,S)},M=function(e,n,r,i,o,a){if(o=o||a)return"'"+(o=w(o)).replace(/\'/g,"\\'")+"'";if(n=w(n||r||i),!t.allow_script_urls){var s=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(s))return"";if(!t.allow_svg_data_urls&&/^data:image\/svg/i.test(s))return""}return v&&(n=v.call(y,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(e){for(e=(e=e.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,_).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(t){return t.replace(/[;:]/g,_)});n=s.exec(e);)if(s.lastIndex=n.index+n[0].length,r=n[1].replace(l,"").toLowerCase(),c=n[2].replace(l,""),r&&c){if(r=C(r),c=C(c),-1!==r.indexOf("\ufeff")||-1!==r.indexOf('"'))continue;if(!t.allow_script_urls&&("behavior"===r||/expression\s*\(|\/\*|\*\//.test(c)))continue;"font-weight"===r&&"700"===c?c="bold":"color"!==r&&"background-color"!==r||(c=c.toLowerCase()),c=(c=c.replace(o,so)).replace(a,M),m[r]=f?w(c,!0):c}x("border","",!0),x("border","-width"),x("border","-color"),x("border","-style"),x("padding",""),x("margin",""),p="border-style",g="border-color",b(h="border-width")&&b(p)&&b(g)&&(m.border=m[h]+" "+m[p]+" "+m[g],delete m[h],delete m[p],delete m[g]),"medium none"===m.border&&delete m.border,"none"===m["border-image"]&&delete m["border-image"]}return m},serialize:function(t,e){var i="",o=function(e){var r,o=n[e];if(o)for(var a=0,s=o.length;a<s;a++)(r=t[e=o[a]])&&(i+=(0<i.length?" ":"")+e+": "+r+";")};return e&&n?(o("*"),o(e)):lt(t,function(t,n){var o,a;!t||r&&(o=n,(a=r["*"])&&a[o]||(a=r[e])&&a[o])||(i+=(0<i.length?" ":"")+n+": "+t+";")}),i}}},uo=/^(?:mouse|contextmenu)|click/,co={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1,mozPressure:1},fo=P,ho=E,po=function(t,e,n,r){t.addEventListener?t.addEventListener(e,n,r||!1):t.attachEvent&&t.attachEvent("on"+e,n)},go=function(t,e,n,r){t.removeEventListener?t.removeEventListener(e,n,r||!1):t.detachEvent&&t.detachEvent("on"+e,n)},mo=function(t,e){var n,r,i,o,a,s=e||{};for(n in t)co[n]||(s[n]=t[n]);return s.target||(s.target=s.srcElement||document),s.composedPath&&(s.composedPath=function(){return t.composedPath()}),t&&uo.test(t.type)&&void 0===t.pageX&&void 0!==t.clientX&&(i=(r=s.target.ownerDocument||document).documentElement,o=r.body,s.pageX=t.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),s.pageY=t.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),s.preventDefault=function(){s.defaultPrevented=!0,s.isDefaultPrevented=ho,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},s.stopPropagation=function(){s.cancelBubble=!0,s.isPropagationStopped=ho,t&&(t.stopPropagation?t.stopPropagation():t.cancelBubble=!0)},!(s.stopImmediatePropagation=function(){s.isImmediatePropagationStopped=ho,s.stopPropagation()})==((a=s).isDefaultPrevented===ho||a.isDefaultPrevented===fo)&&(s.isDefaultPrevented=!0===s.defaultPrevented?ho:fo,s.isPropagationStopped=!0===s.cancelBubble?ho:fo,s.isImmediatePropagationStopped=fo),void 0===s.metaKey&&(s.metaKey=!1),s},vo=(yo.prototype.bind=function(t,e,n,r){var i,o,a,s,l,u,c=this,d=window,f=function(t){c.executeHandlers(mo(t||d.event),i)};if(t&&3!==t.nodeType&&8!==t.nodeType){t[c.expando]?i=t[c.expando]:(i=c.count++,t[c.expando]=i,c.events[i]={}),r=r||t;for(var h=e.split(" "),p=h.length;p--;)l=f,s=u=!1,"DOMContentLoaded"===(a=h[p])&&(a="ready"),c.domLoaded&&"ready"===a&&"complete"===t.readyState?n.call(r,mo({type:a})):(c.hasMouseEnterLeave||(s=c.mouseEnterLeave[a])&&(l=function(t){var e=t.currentTarget,n=t.relatedTarget;if(n&&e.contains)n=e.contains(n);else for(;n&&n!==e;)n=n.parentNode;n||((t=mo(t||d.event)).type="mouseout"===t.type?"mouseleave":"mouseenter",t.target=e,c.executeHandlers(t,i))}),c.hasFocusIn||"focusin"!==a&&"focusout"!==a||(u=!0,s="focusin"===a?"focus":"blur",l=function(t){(t=mo(t||d.event)).type="focus"===t.type?"focusin":"focusout",c.executeHandlers(t,i)}),(o=c.events[i][a])?"ready"===a&&c.domLoaded?n(mo({type:a})):o.push({func:n,scope:r}):(c.events[i][a]=o=[{func:n,scope:r}],o.fakeName=s,o.capture=u,o.nativeHandler=l,"ready"===a?function(t,e,n){var r,i=t.document,o={type:"ready"};n.domLoaded?e(o):(r=function(){go(t,"DOMContentLoaded",r),go(t,"load",r),n.domLoaded||(n.domLoaded=!0,e(o)),t=null},"complete"===i.readyState||"interactive"===i.readyState&&i.body?r():po(t,"DOMContentLoaded",r),n.domLoaded||po(t,"load",r))}(t,l,c):po(t,s||a,l,u)));return t=o=null,n}},yo.prototype.unbind=function(t,e,n){var r,i,o;if(!t||3===t.nodeType||8===t.nodeType)return this;var a=t[this.expando];if(a){if(o=this.events[a],e){for(var s,l,u,c,d=e.split(" "),f=d.length;f--;)if(c=o[i=d[f]]){if(n)for(r=c.length;r--;)c[r].func===n&&(s=c.nativeHandler,l=c.fakeName,u=c.capture,(c=c.slice(0,r).concat(c.slice(r+1))).nativeHandler=s,c.fakeName=l,c.capture=u,o[i]=c);n&&0!==c.length||(delete o[i],go(t,c.fakeName||i,c.nativeHandler,c.capture))}}else lt(o,function(e,n){go(t,e.fakeName||n,e.nativeHandler,e.capture)}),o={};for(i in o)if(mt(o,i))return this;delete this.events[a];try{delete t[this.expando]}catch(y){t[this.expando]=null}}return this},yo.prototype.fire=function(t,e,n){var r;if(!t||3===t.nodeType||8===t.nodeType)return this;var i=mo(null,n);for(i.type=e,i.target=t;(r=t[this.expando])&&this.executeHandlers(i,r),(t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow)&&!i.isPropagationStopped(););return this},yo.prototype.clean=function(t){var e,n;if(!t||3===t.nodeType||8===t.nodeType)return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName)for(this.unbind(t),e=(n=t.getElementsByTagName("*")).length;e--;)(t=n[e])[this.expando]&&this.unbind(t);return this},yo.prototype.destroy=function(){this.events={}},yo.prototype.cancel=function(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1},yo.prototype.executeHandlers=function(t,e){var n=this.events[e],r=n&&n[t.type];if(r)for(var i=0,o=r.length;i<o;i++){var a=r[i];if(a&&!1===a.func.call(a.scope,t)&&t.preventDefault(),t.isImmediatePropagationStopped())return}},yo.Event=new yo,yo);function yo(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}var xo,bo,_o,wo,So,Co,Mo,To,ko,Ao,Io,Do,Oo,Po,Eo,Ro,Lo,No="sizzle"+-new Date,Bo=window.document,zo=0,Vo=0,Fo=ya(),Ho=ya(),Wo=ya(),jo=function(t,e){return t===e&&(Ao=!0),0},Go="undefined",Uo={}.hasOwnProperty,qo=[],Xo=qo.pop,Yo=qo.push,$o=qo.push,Zo=qo.slice,Ko=qo.indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(this[e]===t)return e;return-1},Jo="[\\x20\\t\\r\\n\\f]",Qo="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ta="\\["+Jo+"*("+Qo+")(?:"+Jo+"*([*^$|!~]?=)"+Jo+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Qo+"))|)"+Jo+"*\\]",ea=":("+Qo+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ta+")*)|.*)\\)|)",na=new RegExp("^"+Jo+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Jo+"+$","g"),ra=new RegExp("^"+Jo+"*,"+Jo+"*"),ia=new RegExp("^"+Jo+"*([>+~]|"+Jo+")"+Jo+"*"),oa=new RegExp("="+Jo+"*([^\\]'\"]*?)"+Jo+"*\\]","g"),aa=new RegExp(ea),sa=new RegExp("^"+Qo+"$"),la={ID:new RegExp("^#("+Qo+")"),CLASS:new RegExp("^\\.("+Qo+")"),TAG:new RegExp("^("+Qo+"|[*])"),ATTR:new RegExp("^"+ta),PSEUDO:new RegExp("^"+ea),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Jo+"*(even|odd|(([+-]|)(\\d*)n|)"+Jo+"*(?:([+-]|)"+Jo+"*(\\d+)|))"+Jo+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+Jo+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Jo+"*((?:-\\d)?\\d*)"+Jo+"*\\)|)(?=[^-]|$)","i")},ua=/^(?:input|select|textarea|button)$/i,ca=/^h\d$/i,da=/^[^{]+\{\s*\[native \w/,fa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ha=/[+~]/,pa=/'|\\/g,ga=new RegExp("\\\\([\\da-f]{1,6}"+Jo+"?|("+Jo+")|.)","ig"),ma=function(t,e,n){var r="0x"+e-65536;return r!=r||n?e:r<0?String.fromCharCode(65536+r):String.fromCharCode(r>>10|55296,1023&r|56320)};try{$o.apply(qo=Zo.call(Bo.childNodes),Bo.childNodes)}catch(mS){$o={apply:qo.length?function(t,e){Yo.apply(t,Zo.call(e))}:function(t,e){for(var n=t.length,r=0;t[n++]=e[r++];);t.length=n-1}}}var va=function(t,e,n,r){var i,o,a,s,l,u,c,d,f,h;if((e?e.ownerDocument||e:Bo)!==Do&&Io(e),n=n||[],!t||"string"!=typeof t)return n;if(1!==(s=(e=e||Do).nodeType)&&9!==s)return[];if(Po&&!r){if(i=fa.exec(t))if(a=i[1]){if(9===s){if(!(o=e.getElementById(a))||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&Lo(e,o)&&o.id===a)return n.push(o),n}else{if(i[2])return $o.apply(n,e.getElementsByTagName(t)),n;if((a=i[3])&&xo.getElementsByClassName)return $o.apply(n,e.getElementsByClassName(a)),n}if(xo.qsa&&(!Eo||!Eo.test(t))){if(d=c=No,f=e,h=9===s&&t,1===s&&"object"!==e.nodeName.toLowerCase()){for(u=So(t),(c=e.getAttribute("id"))?d=c.replace(pa,"\\$&"):e.setAttribute("id",d),d="[id='"+d+"'] ",l=u.length;l--;)u[l]=d+Ca(u[l]);f=ha.test(t)&&wa(e.parentNode)||e,h=u.join(",")}if(h)try{return $o.apply(n,f.querySelectorAll(h)),n}catch(S){}finally{c||e.removeAttribute("id")}}}return Mo(t.replace(na,"$1"),e,n,r)};function ya(){var t=[];return function e(n,r){return t.push(n+" ")>bo.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function xa(t){return t[No]=!0,t}function ba(t,e){var n=e&&t,r=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||1<<31)-(~t.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function _a(t){return xa(function(e){return e=+e,xa(function(n,r){for(var i,o=t([],n.length,e),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function wa(t){return t&&typeof t.getElementsByTagName!=Go&&t}function Sa(){}function Ca(t){for(var e=0,n=t.length,r="";e<n;e++)r+=t[e].value;return r}function Ma(t,e,n){var r=e.dir,i=n&&"parentNode"===r,o=Vo++;return e.first?function(e,n,o){for(;e=e[r];)if(1===e.nodeType||i)return t(e,n,o)}:function(e,n,a){var s,l,u=[zo,o];if(a){for(;e=e[r];)if((1===e.nodeType||i)&&t(e,n,a))return!0}else for(;e=e[r];)if(1===e.nodeType||i){if((s=(l=e[No]||(e[No]={}))[r])&&s[0]===zo&&s[1]===o)return u[2]=s[2];if((l[r]=u)[2]=t(e,n,a))return!0}}}function Ta(t){return 1<t.length?function(e,n,r){for(var i=t.length;i--;)if(!t[i](e,n,r))return!1;return!0}:t[0]}function ka(t,e,n,r,i){for(var o,a=[],s=0,l=t.length,u=null!=e;s<l;s++)(o=t[s])&&(n&&!n(o,r,i)||(a.push(o),u&&e.push(s)));return a}function Aa(t,e,n,r,i,o){return r&&!r[No]&&(r=Aa(r)),i&&!i[No]&&(i=Aa(i,o)),xa(function(o,a,s,l){var u,c,d,f=[],h=[],p=a.length,g=o||function(t,e,n){for(var r=0,i=e.length;r<i;r++)va(t,e[r],n);return n}(e||"*",s.nodeType?[s]:s,[]),m=!t||!o&&e?g:ka(g,f,t,s,l),v=n?i||(o?t:p||r)?[]:a:m;if(n&&n(m,v,s,l),r)for(u=ka(v,h),r(u,[],s,l),c=u.length;c--;)(d=u[c])&&(v[h[c]]=!(m[h[c]]=d));if(o){if(i||t){if(i){for(u=[],c=v.length;c--;)(d=v[c])&&u.push(m[c]=d);i(null,v=[],u,l)}for(c=v.length;c--;)(d=v[c])&&-1<(u=i?Ko.call(o,d):f[c])&&(o[u]=!(a[u]=d))}}else v=ka(v===a?v.splice(p,v.length):v),i?i(null,a,v,l):$o.apply(a,v)})}xo=va.support={},wo=va.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},Io=va.setDocument=function(t){var e,n=t?t.ownerDocument||t:Bo,r=n.defaultView;return n!==Do&&9===n.nodeType&&n.documentElement?(Oo=(Do=n).documentElement,Po=!wo(n),r&&r!==function(t){try{return t.top}catch(e){}return null}(r)&&(r.addEventListener?r.addEventListener("unload",function(){Io()},!1):r.attachEvent&&r.attachEvent("onunload",function(){Io()})),xo.attributes=!0,xo.getElementsByTagName=!0,xo.getElementsByClassName=da.test(n.getElementsByClassName),xo.getById=!0,bo.find.ID=function(t,e){if(typeof e.getElementById!=Go&&Po){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},bo.filter.ID=function(t){var e=t.replace(ga,ma);return function(t){return t.getAttribute("id")===e}},bo.find.TAG=xo.getElementsByTagName?function(t,e){if(typeof e.getElementsByTagName!=Go)return e.getElementsByTagName(t)}:function(t,e){var n,r=[],i=0,o=e.getElementsByTagName(t);if("*"!==t)return o;for(;n=o[i++];)1===n.nodeType&&r.push(n);return r},bo.find.CLASS=xo.getElementsByClassName&&function(t,e){if(Po)return e.getElementsByClassName(t)},Ro=[],Eo=[],xo.disconnectedMatch=!0,Eo=Eo.length&&new RegExp(Eo.join("|")),Ro=Ro.length&&new RegExp(Ro.join("|")),e=da.test(Oo.compareDocumentPosition),Lo=e||da.test(Oo.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},jo=e?function(t,e){if(t===e)return Ao=!0,0;var r=!t.compareDocumentPosition-!e.compareDocumentPosition;return r||(1&(r=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!xo.sortDetached&&e.compareDocumentPosition(t)===r?t===n||t.ownerDocument===Bo&&Lo(Bo,t)?-1:e===n||e.ownerDocument===Bo&&Lo(Bo,e)?1:ko?Ko.call(ko,t)-Ko.call(ko,e):0:4&r?-1:1)}:function(t,e){if(t===e)return Ao=!0,0;var r,i=0,o=t.parentNode,a=e.parentNode,s=[t],l=[e];if(!o||!a)return t===n?-1:e===n?1:o?-1:a?1:ko?Ko.call(ko,t)-Ko.call(ko,e):0;if(o===a)return ba(t,e);for(r=t;r=r.parentNode;)s.unshift(r);for(r=e;r=r.parentNode;)l.unshift(r);for(;s[i]===l[i];)i++;return i?ba(s[i],l[i]):s[i]===Bo?-1:l[i]===Bo?1:0},n):Do},va.matches=function(t,e){return va(t,null,null,e)},va.matchesSelector=function(t,e){if((t.ownerDocument||t)!==Do&&Io(t),e=e.replace(oa,"='$1']"),xo.matchesSelector&&Po&&(!Ro||!Ro.test(e))&&(!Eo||!Eo.test(e)))try{var n=(void 0).call(t,e);if(n||xo.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(mS){}return 0<va(e,Do,null,[t]).length},va.contains=function(t,e){return(t.ownerDocument||t)!==Do&&Io(t),Lo(t,e)},va.attr=function(t,e){(t.ownerDocument||t)!==Do&&Io(t);var n=bo.attrHandle[e.toLowerCase()],r=n&&Uo.call(bo.attrHandle,e.toLowerCase())?n(t,e,!Po):void 0;return void 0!==r?r:xo.attributes||!Po?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},va.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},va.uniqueSort=function(t){var e,n=[],r=0,i=0;if(Ao=!xo.detectDuplicates,ko=!xo.sortStable&&t.slice(0),t.sort(jo),Ao){for(;e=t[i++];)e===t[i]&&(r=n.push(i));for(;r--;)t.splice(n[r],1)}return ko=null,t},_o=va.getText=function(t){var e,n="",r=0,i=t.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=_o(t)}else if(3===i||4===i)return t.nodeValue}else for(;e=t[r++];)n+=_o(e);return n},(bo=va.selectors={cacheLength:50,createPseudo:xa,match:la,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(ga,ma),t[3]=(t[3]||t[4]||t[5]||"").replace(ga,ma),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||va.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&va.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return la.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&aa.test(n)&&(e=So(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(ga,ma).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=Fo[t+" "];return e||(e=new RegExp("(^|"+Jo+")"+t+"("+Jo+"|$)"))&&Fo(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!=Go&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(r){var i=va.attr(r,t);return null==i?"!="===e:!e||(i+="","="===e?i===n:"!="===e?i!==n:"^="===e?n&&0===i.indexOf(n):"*="===e?n&&-1<i.indexOf(n):"$="===e?n&&i.slice(-n.length)===n:"~="===e?-1<(" "+i+" ").indexOf(n):"|="===e&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,r,i){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===r&&0===i?function(t){return!!t.parentNode}:function(e,n,l){var u,c,d,f,h,p,g=o!=a?"nextSibling":"previousSibling",m=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!l&&!s;if(m){if(o){for(;g;){for(d=e;d=d[g];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;p=g="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?m.firstChild:m.lastChild],a&&y){for(h=(u=(c=m[No]||(m[No]={}))[t]||[])[0]===zo&&u[1],f=u[0]===zo&&u[2],d=h&&m.childNodes[h];d=++h&&d&&d[g]||(f=h=0)||p.pop();)if(1===d.nodeType&&++f&&d===e){c[t]=[zo,h,f];break}}else if(y&&(u=(e[No]||(e[No]={}))[t])&&u[0]===zo)f=u[1];else for(;(d=++h&&d&&d[g]||(f=h=0)||p.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++f||(y&&((d[No]||(d[No]={}))[t]=[zo,f]),d!==e)););return(f-=i)===r||f%r==0&&0<=f/r}}},PSEUDO:function(t,e){var n,r=bo.pseudos[t]||bo.setFilters[t.toLowerCase()]||va.error("unsupported pseudo: "+t);return r[No]?r(e):1<r.length?(n=[t,t,"",e],bo.setFilters.hasOwnProperty(t.toLowerCase())?xa(function(t,n){for(var i,o=r(t,e),a=o.length;a--;)t[i=Ko.call(t,o[a])]=!(n[i]=o[a])}):function(t){return r(t,0,n)}):r}},pseudos:{not:xa(function(t){var e=[],n=[],r=Co(t.replace(na,"$1"));return r[No]?xa(function(t,e,n,i){for(var o,a=r(t,null,i,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,i,o){return e[0]=t,r(e,null,o,n),e[0]=null,!n.pop()}}),has:xa(function(t){return function(e){return 0<va(t,e).length}}),contains:xa(function(t){return t=t.replace(ga,ma),function(e){return-1<(e.textContent||e.innerText||_o(e)).indexOf(t)}}),lang:xa(function(t){return sa.test(t||"")||va.error("unsupported lang: "+t),t=t.replace(ga,ma).toLowerCase(),function(e){var n;do{if(n=Po?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(t){var e=window.location&&window.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===Oo},focus:function(t){return t===Do.activeElement&&(!Do.hasFocus||Do.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!bo.pseudos.empty(t)},header:function(t){return ca.test(t.nodeName)},input:function(t){return ua.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:_a(function(){return[0]}),last:_a(function(t,e){return[e-1]}),eq:_a(function(t,e,n){return[n<0?n+e:n]}),even:_a(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:_a(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:_a(function(t,e,n){for(var r=n<0?n+e:n;0<=--r;)t.push(r);return t}),gt:_a(function(t,e,n){for(var r=n<0?n+e:n;++r<e;)t.push(r);return t})}}).pseudos.nth=bo.pseudos.eq,U(["radio","checkbox","file","password","image"],function(t){var e;bo.pseudos[t]=(e=t,function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e})}),U(["submit","reset"],function(t){var e;bo.pseudos[t]=(e=t,function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e})}),Sa.prototype=bo.filters=bo.pseudos,bo.setFilters=new Sa,So=va.tokenize=function(t,e){var n,r,i,o,a,s,l,u=Ho[t+" "];if(u)return e?0:u.slice(0);for(a=t,s=[],l=bo.preFilter;a;){for(o in n&&!(r=ra.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=ia.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(na," ")}),a=a.slice(n.length)),bo.filter)bo.filter.hasOwnProperty(o)&&(!(r=la[o].exec(a))||l[o]&&!(r=l[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length)));if(!n)break}return e?a.length:a?va.error(t):Ho(t,s).slice(0)},Co=va.compile=function(t,e){var n,r,i,o,a,s,l=[],u=[],c=Wo[t+" "];if(!c){for(n=(e=e||So(t)).length;n--;)(c=function t(e){for(var n,r,i,o=e.length,a=bo.relative[e[0].type],s=a||bo.relative[" "],l=a?1:0,u=Ma(function(t){return t===n},s,!0),c=Ma(function(t){return-1<Ko.call(n,t)},s,!0),d=[function(t,e,r){var i=!a&&(r||e!==To)||((n=e).nodeType?u:c)(t,e,r);return n=null,i}];l<o;l++)if(r=bo.relative[e[l].type])d=[Ma(Ta(d),r)];else{if((r=bo.filter[e[l].type].apply(null,e[l].matches))[No]){for(i=++l;i<o&&!bo.relative[e[i].type];i++);return Aa(1<l&&Ta(d),1<l&&Ca(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(na,"$1"),r,l<i&&t(e.slice(l,i)),i<o&&t(e=e.slice(i)),i<o&&Ca(e))}d.push(r)}return Ta(d)}(e[n]))[No]?l.push(c):u.push(c);(c=Wo(t,(r=u,o=0<(i=l).length,a=0<r.length,s=function(t,e,n,s,l){var u,c,d,f=0,h="0",p=t&&[],g=[],m=To,v=t||a&&bo.find.TAG("*",l),y=zo+=null==m?1:Math.random()||.1,x=v.length;for(l&&(To=e!==Do&&e);h!==x&&null!=(u=v[h]);h++){if(a&&u){for(c=0;d=r[c++];)if(d(u,e,n)){s.push(u);break}l&&(zo=y)}o&&((u=!d&&u)&&f--,t&&p.push(u))}if(f+=h,o&&h!==f){for(c=0;d=i[c++];)d(p,g,e,n);if(t){if(0<f)for(;h--;)p[h]||g[h]||(g[h]=Xo.call(s));g=ka(g)}$o.apply(s,g),l&&!t&&0<g.length&&1<f+i.length&&va.uniqueSort(s)}return l&&(zo=y,To=m),p},o?xa(s):s))).selector=t}return c},Mo=va.select=function(t,e,n,r){var i,o,a,s,l,u="function"==typeof t&&t,c=!r&&So(t=u.selector||t);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&xo.getById&&9===e.nodeType&&Po&&bo.relative[o[1].type]){if(!(e=(bo.find.ID(a.matches[0].replace(ga,ma),e)||[])[0]))return n;u&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(i=la.needsContext.test(t)?0:o.length;i--&&!bo.relative[s=(a=o[i]).type];)if((l=bo.find[s])&&(r=l(a.matches[0].replace(ga,ma),ha.test(o[0].type)&&wa(e.parentNode)||e))){if(o.splice(i,1),!(t=r.length&&Ca(o)))return $o.apply(n,r),n;break}}return(u||Co(t,c))(r,e,!Po,n,ha.test(t)&&wa(e.parentNode)||e),n},xo.sortStable=No.split("").sort(jo).join("")===No,xo.detectDuplicates=!!Ao,Io(),xo.sortDetached=!0;var Ia=document,Da=Array.prototype.push,Oa=Array.prototype.slice,Pa=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Ea=vo.Event,Ra=Me.makeMap("children,contents,next,prev"),La=function(t){return void 0!==t},Na=function(t){return"string"==typeof t},Ba=function(t,e){var n,r=(e=e||Ia).createElement("div"),i=e.createDocumentFragment();for(r.innerHTML=t;n=r.firstChild;)i.appendChild(n);return i},za=function(t,e,n,r){var i;if(Na(e))e=Ba(e,Ja(t[0]));else if(e.length&&!e.nodeType){if(e=ns.makeArray(e),r)for(i=e.length-1;0<=i;i--)za(t,e[i],n,r);else for(i=0;i<e.length;i++)za(t,e[i],n,r);return t}if(e.nodeType)for(i=t.length;i--;)n.call(t[i],e);return t},Va=function(t,e){return t&&e&&-1!==(" "+t.className+" ").indexOf(" "+e+" ")},Fa=function(t,e,n){var r,i;return e=ns(e)[0],t.each(function(){n&&r===this.parentNode||(r=this.parentNode,i=e.cloneNode(!1),this.parentNode.insertBefore(i,this)),i.appendChild(this)}),t},Ha=Me.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),Wa=Me.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),ja={for:"htmlFor",class:"className",readonly:"readOnly"},Ga={float:"cssFloat"},Ua={},qa={},Xa=function(t,e){return new ns.fn.init(t,e)},Ya=/^\s*|\s*$/g,$a=function(t){return null==t?"":(""+t).replace(Ya,"")},Za=function(t,e){var n,r,i,o;if(t)if(void 0===(n=t.length)){for(r in t)if(t.hasOwnProperty(r)&&!1===e.call(o=t[r],r,o))break}else for(i=0;i<n&&!1!==e.call(o=t[i],i,o);i++);return t},Ka=function(t,e){var n=[];return Za(t,function(t,r){e(r,t)&&n.push(r)}),n},Ja=function(t){return t?9===t.nodeType?t:t.ownerDocument:Ia};Xa.fn=Xa.prototype={constructor:Xa,selector:"",context:null,length:0,init:function(t,e){var n,r,i=this;if(!t)return i;if(t.nodeType)return i.context=i[0]=t,i.length=1,i;if(e&&e.nodeType)i.context=e;else{if(e)return ns(t).attr(e);i.context=e=document}if(Na(t)){if(!(n="<"===(i.selector=t).charAt(0)&&">"===t.charAt(t.length-1)&&3<=t.length?[null,t,null]:Pa.exec(t)))return ns(e).find(t);if(n[1])for(r=Ba(t,Ja(e)).firstChild;r;)Da.call(i,r),r=r.nextSibling;else{if(!(r=Ja(e).getElementById(n[2])))return i;if(r.id!==n[2])return i.find(t);i.length=1,i[0]=r}}else this.add(t,!1);return i},toArray:function(){return Me.toArray(this)},add:function(t,e){var n,r;if(Na(t))return this.add(ns(t));if(!1!==e)for(n=ns.unique(this.toArray().concat(ns.makeArray(t))),this.length=n.length,r=0;r<n.length;r++)this[r]=n[r];else Da.apply(this,ns.makeArray(t));return this},attr:function(t,e){var n,r=this;if("object"==typeof t)Za(t,function(t,e){r.attr(t,e)});else{if(!La(e)){if(r[0]&&1===r[0].nodeType){if((n=Ua[t])&&n.get)return n.get(r[0],t);if(Wa[t])return r.prop(t)?t:void 0;null===(e=r[0].getAttribute(t,2))&&(e=void 0)}return e}this.each(function(){var n;if(1===this.nodeType){if((n=Ua[t])&&n.set)return void n.set(this,e);null===e?this.removeAttribute(t,2):this.setAttribute(t,e,2)}})}return r},removeAttr:function(t){return this.attr(t,null)},prop:function(t,e){var n=this;if("object"==typeof(t=ja[t]||t))Za(t,function(t,e){n.prop(t,e)});else{if(!La(e))return n[0]&&n[0].nodeType&&t in n[0]?n[0][t]:e;this.each(function(){1===this.nodeType&&(this[t]=e)})}return n},css:function(t,e){var n,r,i=this,a=function(t){return t.replace(/-(\D)/g,function(t,e){return e.toUpperCase()})},s=function(t){return t.replace(/[A-Z]/g,function(t){return"-"+t})};if("object"==typeof t)Za(t,function(t,e){i.css(t,e)});else if(La(e))t=a(t),"number"!=typeof e||Ha[t]||(e=e.toString()+"px"),i.each(function(){var n=this.style;if((r=qa[t])&&r.set)r.set(this,e);else{try{this.style[Ga[t]||t]=e}catch(a){}null!==e&&""!==e||(n.removeProperty?n.removeProperty(s(t)):n.removeAttribute(t))}});else{if(n=i[0],(r=qa[t])&&r.get)return r.get(n);if(!n.ownerDocument.defaultView)return n.currentStyle?n.currentStyle[a(t)]:"";try{return n.ownerDocument.defaultView.getComputedStyle(n,null).getPropertyValue(s(t))}catch(o){return}}return i},remove:function(){for(var t,e=this.length;e--;)Ea.clean(t=this[e]),t.parentNode&&t.parentNode.removeChild(t);return this},empty:function(){for(var t,e=this.length;e--;)for(t=this[e];t.firstChild;)t.removeChild(t.firstChild);return this},html:function(t){var e;if(La(t)){e=this.length;try{for(;e--;)this[e].innerHTML=t}catch(l){ns(this[e]).empty().append(t)}return this}return this[0]?this[0].innerHTML:""},text:function(t){var e;if(La(t)){for(e=this.length;e--;)"innerText"in this[e]?this[e].innerText=t:this[0].textContent=t;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return za(this,arguments,function(t){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(t)})},prepend:function(){return za(this,arguments,function(t){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(t,this.firstChild)},!0)},before:function(){return this[0]&&this[0].parentNode?za(this,arguments,function(t){this.parentNode.insertBefore(t,this)}):this},after:function(){return this[0]&&this[0].parentNode?za(this,arguments,function(t){this.parentNode.insertBefore(t,this.nextSibling)},!0):this},appendTo:function(t){return ns(t).append(this),this},prependTo:function(t){return ns(t).prepend(this),this},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){return Fa(this,t)},wrapAll:function(t){return Fa(this,t,!0)},wrapInner:function(t){return this.each(function(){ns(this).contents().wrapAll(t)}),this},unwrap:function(){return this.parent().each(function(){ns(this).replaceWith(this.childNodes)})},clone:function(){var t=[];return this.each(function(){t.push(this.cloneNode(!0))}),ns(t)},addClass:function(t){return this.toggleClass(t,!0)},removeClass:function(t){return this.toggleClass(t,!1)},toggleClass:function(t,e){var n=this;return"string"!=typeof t||(-1!==t.indexOf(" ")?Za(t.split(" "),function(){n.toggleClass(this,e)}):n.each(function(n,r){var i,o=Va(r,t);o!==e&&(i=r.className,o?r.className=$a((" "+i+" ").replace(" "+t+" "," ")):r.className+=i?" "+t:t)})),n},hasClass:function(t){return Va(this[0],t)},each:function(t){return Za(this,t)},on:function(t,e){return this.each(function(){Ea.bind(this,t,e)})},off:function(t,e){return this.each(function(){Ea.unbind(this,t,e)})},trigger:function(t){return this.each(function(){"object"==typeof t?Ea.fire(this,t.type,t):Ea.fire(this,t)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return ns(Oa.apply(this,arguments))},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(t){for(var e=[],n=0,r=this.length;n<r;n++)ns.find(t,this[n],e);return ns(e)},filter:function(t){return ns("function"==typeof t?Ka(this.toArray(),function(e,n){return t(n,e)}):ns.filter(t,this.toArray()))},closest:function(t){var e=[];return t instanceof ns&&(t=t[0]),this.each(function(n,r){for(;r;){if("string"==typeof t&&ns(r).is(t)){e.push(r);break}if(r===t){e.push(r);break}r=r.parentNode}}),ns(e)},offset:function(t){var e,n,r,i,o=0,a=0;return t?this.css(t):((e=this[0])&&(r=(n=e.ownerDocument).documentElement,e.getBoundingClientRect&&(o=(i=e.getBoundingClientRect()).left+(r.scrollLeft||n.body.scrollLeft)-r.clientLeft,a=i.top+(r.scrollTop||n.body.scrollTop)-r.clientTop)),{left:o,top:a})},push:Da,sort:Array.prototype.sort,splice:Array.prototype.splice},Me.extend(Xa,{extend:Me.extend,makeArray:function(t){return(e=t)&&e===e.window||t.nodeType?[t]:Me.toArray(t);var e},inArray:function(t,e){var n;if(e.indexOf)return e.indexOf(t);for(n=e.length;n--;)if(e[n]===t)return n;return-1},isArray:Me.isArray,each:Za,trim:$a,grep:Ka,find:va,expr:va.selectors,unique:va.uniqueSort,text:va.getText,contains:va.contains,filter:function(t,e,n){var r=e.length;for(n&&(t=":not("+t+")");r--;)1!==e[r].nodeType&&e.splice(r,1);return 1===e.length?ns.find.matchesSelector(e[0],t)?[e[0]]:[]:ns.find.matches(t,e)}});var Qa=function(t,e,n){var r=[],i=t[e];for("string"!=typeof n&&n instanceof ns&&(n=n[0]);i&&9!==i.nodeType;){if(void 0!==n){if(i===n)break;if("string"==typeof n&&ns(i).is(n))break}1===i.nodeType&&r.push(i),i=i[e]}return r},ts=function(t,e,n,r){var i=[];for(r instanceof ns&&(r=r[0]);t;t=t[e])if(!n||t.nodeType===n){if(void 0!==r){if(t===r)break;if("string"==typeof r&&ns(t).is(r))break}i.push(t)}return i},es=function(t,e,n){for(t=t[e];t;t=t[e])if(t.nodeType===n)return t;return null};Za({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return Qa(t,"parentNode")},next:function(t){return es(t,"nextSibling",1)},prev:function(t){return es(t,"previousSibling",1)},children:function(t){return ts(t.firstChild,"nextSibling",1)},contents:function(t){return Me.toArray(("iframe"===t.nodeName?t.contentDocument||t.contentWindow.document:t).childNodes)}},function(t,e){Xa.fn[t]=function(n){var r=[];this.each(function(){var t=e.call(r,this,n,r);t&&(ns.isArray(t)?r.push.apply(r,t):r.push(t))}),1<this.length&&(Ra[t]||(r=ns.unique(r)),0===t.indexOf("parents")&&(r=r.reverse()));var i=ns(r);return n?i.filter(n):i}}),Za({parentsUntil:function(t,e){return Qa(t,"parentNode",e)},nextUntil:function(t,e){return ts(t,"nextSibling",1,e).slice(1)},prevUntil:function(t,e){return ts(t,"previousSibling",1,e).slice(1)}},function(t,e){Xa.fn[t]=function(n,r){var i=[];this.each(function(){var t=e.call(i,this,n,i);t&&(ns.isArray(t)?i.push.apply(i,t):i.push(t))}),1<this.length&&(i=ns.unique(i),0!==t.indexOf("parents")&&"prevUntil"!==t||(i=i.reverse()));var o=ns(i);return r?o.filter(r):o}}),Xa.fn.is=function(t){return!!t&&0<this.filter(t).length},Xa.fn.init.prototype=Xa.fn,Xa.overrideDefaults=function(t){var e,n=function(r,i){return e=e||t(),0===arguments.length&&(r=e.element),new n.fn.init(r,i=i||e.context)};return ns.extend(n,this),n},Xa.attrHooks=Ua,Xa.cssHooks=qa;var ns=Xa,rs=Me.each,is=Me.grep,os=be.ie,as=/^([a-z0-9],?)+$/i,ss=function(t,e){var n=e.attr("style"),r=(r=t.serialize(t.parse(n),e[0].nodeName))||null;e.attr("data-mce-style",r)},ls=function(t,e){var n,r,i=0;if(t)for(n=t.nodeType,t=t.previousSibling;t;t=t.previousSibling)r=t.nodeType,(!e||3!==r||r!==n&&t.nodeValue.length)&&(i++,n=r);return i},us=function(t,e){void 0===e&&(e={});var n,r,i,o,a,s,l={},u=window,d={},f=0,h=Hr.forElement(De(t),{contentCssCors:e.contentCssCors,referrerPolicy:e.referrerPolicy}),p=[],g=e.schema?e.schema:ao({}),v=lo({url_converter:e.url_converter,url_converter_scope:e.url_converter_scope},e.schema),y=e.ownEvents?new vo:vo.Event,x=g.getBlockElements(),_=ns.overrideDefaults(function(){return{context:t,element:$.getRoot()}}),w=function(e){return e&&t&&c(e)?t.getElementById(e):e},S=function(t){return _("string"==typeof t?w(t):t)},C=function(t,e,n){var r,i,o=S(t);return o.length&&(i=(r=Z[e])&&r.get?r.get(o,e):o.attr(e)),void 0===i&&(i=n||""),i},M=function(t){var e=w(t);return e?e.attributes:[]},T=function(t,n,r){""===r&&(r=null);var i,o=S(t),a=o.attr(n);o.length&&((i=Z[n])&&i.set?i.set(o,r,n):o.attr(n,r),a!==r&&e.onSetAttrib&&e.onSetAttrib({attrElm:o,attrName:n,attrValue:r}))},k=function(){return e.root_element||t.body},A=function(e,n){return function(t,e,n){var r,i,o,a=0,s=0,l=t.ownerDocument;if(n=n||t,e){if(n===t&&e.getBoundingClientRect&&"static"===Kn(De(t),"position"))return{x:a=(i=e.getBoundingClientRect()).left+(l.documentElement.scrollLeft||t.scrollLeft)-l.documentElement.clientLeft,y:s=i.top+(l.documentElement.scrollTop||t.scrollTop)-l.documentElement.clientTop};for(r=e;r&&r!==n&&r.nodeType&&!rr(r,n);)a+=r.offsetLeft||0,s+=r.offsetTop||0,r=r.offsetParent;for(r=e.parentNode;r&&r!==n&&r.nodeType&&!rr(r,n);)a-=r.scrollLeft||0,s-=r.scrollTop||0,r=r.parentNode;s+=(o=De(e),er.isFirefox()&&"table"===Ne(o)?nr(Ze(o)).filter(function(t){return"caption"===Ne(t)}).bind(function(t){return nr($e(t)).map(function(e){return e.dom.offsetTop<=t.dom.offsetTop?-t.dom.offsetHeight:0})}).getOr(0):0)}return{x:a,y:s}}(t.body,w(e),n)},I=function(t,e,n){var r=S(t);return n?r.css(e):("float"===(e=e.replace(/-(\D)/g,function(t,e){return e.toUpperCase()}))&&(e=be.browser.isIE()?"styleFloat":"cssFloat"),r[0]&&r[0].style?r[0].style[e]:void 0)},D=function(t){var e,n;return t=w(t),e=I(t,"width"),n=I(t,"height"),-1===e.indexOf("px")&&(e=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(e,10)||t.offsetWidth||t.clientWidth,h:parseInt(n,10)||t.offsetHeight||t.clientHeight}},O=function(t,e){if(!t)return!1;if(!Array.isArray(t)){if("*"===e)return 1===t.nodeType;if(as.test(e)){for(var n=e.toLowerCase().split(/,/),r=t.nodeName.toLowerCase(),i=n.length-1;0<=i;i--)if(n[i]===r)return!0;return!1}if(t.nodeType&&1!==t.nodeType)return!1}var o=Array.isArray(t)?t:[t];return 0<va(e,o[0].ownerDocument||o[0],null,o).length},P=function(t,e,n,r){var i,o=[],a=w(t);for(r=void 0===r,n=n||("BODY"!==k().nodeName?k().parentNode:null),Me.is(e,"string")&&(e="*"===(i=e)?function(t){return 1===t.nodeType}:function(t){return O(t,i)});a&&!(a===n||m(a.nodeType)||Nn(a)||Bn(a));){if(!e||"function"==typeof e&&e(a)){if(!r)return[a];o.push(a)}a=a.parentNode}return r?o:null},E=function(t,e,n){var r=e;if(t)for("string"==typeof e&&(r=function(t){return O(t,e)}),t=t[n];t;t=t[n])if("function"==typeof r&&r(t))return t;return null},R=function(t,e,n){var r,i="string"==typeof t?w(t):t;return!!i&&(Me.isArray(i)&&(i.length||0===i.length)?(r=[],rs(i,function(t,i){t&&r.push(e.call(n,"string"==typeof t?w(t):t,i))}),r):e.call(n||this,i))},L=function(t,e){S(t).each(function(t,n){rs(e,function(t,e){T(n,e,t)})})},N=function(t,e){var r=S(t);os?r.each(function(t,r){if(!1!==r.canHaveHTML){for(;r.firstChild;)r.removeChild(r.firstChild);try{r.innerHTML="<br>"+e,r.removeChild(r.firstChild)}catch(n){ns("<div></div>").html("<br>"+e).contents().slice(1).appendTo(r)}return e}}):r.html(e)},B=function(e,n,r,i,o){return R(e,function(e){var a="string"==typeof n?t.createElement(n):n;return L(a,r),i&&("string"!=typeof i&&i.nodeType?a.appendChild(i):"string"==typeof i&&N(a,i)),o?a:e.appendChild(a)})},z=function(e,n,r){return B(t.createElement(e),e,n,r,!0)},V=Zi.encodeAllRaw,F=function(t,e){var n=S(t);return e?n.each(function(){for(var t;t=this.firstChild;)3===t.nodeType&&0===t.data.length?this.removeChild(t):this.parentNode.insertBefore(t,this)}).remove():n.remove(),1<n.length?n.toArray():n[0]},H=function(t,e,n){S(t).toggleClass(e,n).each(function(){""===this.className&&ns(this).attr("class",null)})},W=function(t,e,n){return R(e,function(e){return Me.is(e,"array")&&(t=t.cloneNode(!0)),n&&rs(is(e.childNodes),function(e){t.appendChild(e)}),e.parentNode.replaceChild(t,e)})},j=function(t){if(Tn(t)){var e="a"===t.nodeName.toLowerCase()&&!C(t,"href")&&C(t,"id");if(C(t,"name")||C(t,"data-mce-bookmark")||e)return!0}return!1},G=function(){return t.createRange()},q=function(n,r,i,o){if(Me.isArray(n)){for(var a=n.length,s=[];a--;)s[a]=q(n[a],r,i,o);return s}return!e.collect||n!==t&&n!==u||p.push([n,r,i,o]),y.bind(n,r,i,o||$)},X=function(e,n,r){if(Me.isArray(e)){for(var i=e.length,o=[];i--;)o[i]=X(e[i],n,r);return o}if(0<p.length&&(e===t||e===u))for(i=p.length;i--;){var a=p[i];e!==a[0]||n&&n!==a[1]||r&&r!==a[2]||y.unbind(a[0],a[1],a[2])}return y.unbind(e,n,r)},Y=function(t){if(t&&Tn(t)){var e=t.getAttribute("data-mce-contenteditable");return e&&"inherit"!==e?e:"inherit"!==t.contentEditable?t.contentEditable:null}return null},$={doc:t,settings:e,win:u,files:d,stdMode:!0,boxModel:!0,styleSheetLoader:h,boundEvents:p,styles:v,schema:g,events:y,isBlock:function(t){if("string"==typeof t)return!!x[t];if(t){var e=t.nodeType;if(e)return!(1!==e||!x[t.nodeName])}return!1},$:_,$$:S,root:null,clone:function(e,n){if(!os||1!==e.nodeType||n)return e.cloneNode(n);var r=t.createElement(e.nodeName);return rs(M(e),function(t){T(r,t.nodeName,C(e,t.nodeName))}),r},getRoot:k,getViewPort:function(t){var e=Sn(t);return{x:e.x,y:e.y,w:e.width,h:e.height}},getRect:function(t){t=w(t);var e=A(t),n=D(t);return{x:e.x,y:e.y,w:n.w,h:n.h}},getSize:D,getParent:function(t,e,n){var r=P(t,e,n,!1);return r&&0<r.length?r[0]:null},getParents:P,get:w,getNext:function(t,e){return E(t,e,"nextSibling")},getPrev:function(t,e){return E(t,e,"previousSibling")},select:function(n,r){return va(n,w(r)||e.root_element||t,[])},is:O,add:B,create:z,createHTML:function(t,e,n){var r,i="";for(r in i+="<"+t,e)e.hasOwnProperty(r)&&null!=e[r]&&(i+=" "+r+'="'+V(e[r])+'"');return void 0!==n?i+">"+n+"</"+t+">":i+" />"},createFragment:function(e){var n,r=t.createElement("div"),i=t.createDocumentFragment();for(i.appendChild(r),e&&(r.innerHTML=e);n=r.firstChild;)i.appendChild(n);return i.removeChild(r),i},remove:F,setStyle:function(t,n,r){var i=c(n)?S(t).css(n,r):S(t).css(n);e.update_styles&&ss(v,i)},getStyle:I,setStyles:function(t,n){var r=S(t).css(n);e.update_styles&&ss(v,r)},removeAllAttribs:function(t){return R(t,function(t){for(var e=t.attributes,n=e.length-1;0<=n;n--)t.removeAttributeNode(e.item(n))})},setAttrib:T,setAttribs:L,getAttrib:C,getPos:A,parseStyle:function(t){return v.parse(t)},serializeStyle:function(t,e){return v.serialize(t,e)},addStyle:function(e){var n,r;if($!==us.DOM&&t===document){if(l[e])return;l[e]=!0}(r=t.getElementById("mceDefaultStyles"))||((r=t.createElement("style")).id="mceDefaultStyles",r.type="text/css",(n=t.getElementsByTagName("head")[0]).firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(t.createTextNode(e))},loadCSS:function(t){U((t=t||"").split(","),function(t){d[t]=!0,h.load(t,b)})},addClass:function(t,e){S(t).addClass(e)},removeClass:function(t,e){H(t,e,!1)},hasClass:function(t,e){return S(t).hasClass(e)},toggleClass:H,show:function(t){S(t).show()},hide:function(t){S(t).hide()},isHidden:function(t){return"none"===S(t).css("display")},uniqueId:function(t){return(t||"mce_")+f++},setHTML:N,getOuterHTML:function(t){var e="string"==typeof t?w(t):t;return Tn(e)?e.outerHTML:ns("<div></div>").append(ns(e).clone()).html()},setOuterHTML:function(t,e){S(t).each(function(){try{if("outerHTML"in this)return void(this.outerHTML=e)}catch(t){}F(ns(this).html(e),!0)})},decode:Zi.decode,encode:V,insertAfter:function(t,e){var n=w(e);return R(t,function(t){var e=n.parentNode,r=n.nextSibling;return r?e.insertBefore(t,r):e.appendChild(t),t})},replace:W,rename:function(t,e){var n;return t.nodeName!==e.toUpperCase()&&(n=z(e),rs(M(t),function(e){T(n,e.nodeName,C(t,e.nodeName))}),W(n,t,!0)),n||t},findCommonAncestor:function(t,e){for(var n,r=t;r;){for(n=e;n&&r!==n;)n=n.parentNode;if(r===n)break;r=r.parentNode}return!r&&t.ownerDocument?t.ownerDocument.documentElement:r},toHex:function(t){return v.toHex(Me.trim(t))},run:R,getAttribs:M,isEmpty:function(t,e){var n,r,i=0;if(j(t))return!1;if(t=t.firstChild){var o=new Wr(t,t.parentNode),a=g?g.getWhiteSpaceElements():{};e=e||(g?g.getNonEmptyElements():null);do{if(n=t.nodeType,Tn(t)){var s=t.getAttribute("data-mce-bogus");if(s){t=o.next("all"===s);continue}if(r=t.nodeName.toLowerCase(),e&&e[r]){if("br"!==r)return!1;i++,t=o.next();continue}if(j(t))return!1}if(8===n)return!1;if(3===n&&!Ai(t.nodeValue))return!1;if(3===n&&t.parentNode&&a[t.parentNode.nodeName]&&Ai(t.nodeValue))return!1;t=o.next()}while(t)}return i<=1},createRng:G,nodeIndex:ls,split:function(t,e,n){var r,i,o,a=G();if(t&&e)return a.setStart(t.parentNode,ls(t)),a.setEnd(e.parentNode,ls(e)),r=a.extractContents(),(a=G()).setStart(e.parentNode,ls(e)+1),a.setEnd(t.parentNode,ls(t)+1),i=a.extractContents(),(o=t.parentNode).insertBefore(Ni($,r),t),o.insertBefore(n||e,t),o.insertBefore(Ni($,i),t),F(t),n||e},bind:q,unbind:X,fire:function(t,e,n){return y.fire(t,e,n)},getContentEditable:Y,getContentEditableParent:function(t){for(var e=k(),n=null;t&&t!==e&&null===(n=Y(t));t=t.parentNode);return n},destroy:function(){if(0<p.length)for(var t=p.length;t--;){var e=p[t];y.unbind(e[0],e[1],e[2])}lt(d,function(t,e){h.unload(e),delete d[e]}),va.setDocument&&va.setDocument()},isChildOf:function(t,e){for(;t;){if(e===t)return!0;t=t.parentNode}return!1},dumpRng:function(t){return"startContainer: "+t.startContainer.nodeName+", startOffset: "+t.startOffset+", endContainer: "+t.endContainer.nodeName+", endOffset: "+t.endOffset}},Z=(n=v,i=function(){return $},a={set:function(t,e,n){r.url_converter&&(e=r.url_converter.call(r.url_converter_scope||i(),e,n,t[0])),t.attr("data-mce-"+n,e).attr(n,e)},get:function(t,e){return t.attr("data-mce-"+e)||t.attr(e)}},s={style:{set:function(t,e){null===e||"object"!=typeof e?(o&&t.attr("data-mce-style",e),null!==e&&"string"==typeof e?(t.removeAttr("style"),t.css(n.parse(e))):t.attr("style",e)):t.css(e)},get:function(t){var e=t.attr("data-mce-style")||t.attr("style");return n.serialize(n.parse(e),t[0].nodeName)}}},(o=(r=e).keep_values)&&(s.href=s.src=a),s);return $};us.DOM=us(document),us.nodeIndex=ls;var cs=us.DOM,ds=Me.each,fs=Me.grep,hs=(ps.prototype._setReferrerPolicy=function(t){this.settings.referrerPolicy=t},ps.prototype.loadScript=function(t,e,n){var r=cs,i=function(){r.remove(o),a&&(a.onerror=a.onload=a=null)},o=r.uniqueId(),a=document.createElement("script");a.id=o,a.type="text/javascript",a.src=Me._addCacheSuffix(t),this.settings.referrerPolicy&&r.setAttrib(a,"referrerpolicy",this.settings.referrerPolicy),a.onload=function(){i(),e()},a.onerror=function(){i(),y(n)?n():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+t)},(document.getElementsByTagName("head")[0]||document.body).appendChild(a)},ps.prototype.isDone=function(t){return 2===this.states[t]},ps.prototype.markDone=function(t){this.states[t]=2},ps.prototype.add=function(t,e,n,r){var i=this.states[t];this.queue.push(t),void 0===i&&(this.states[t]=0),e&&(this.scriptLoadedCallbacks[t]||(this.scriptLoadedCallbacks[t]=[]),this.scriptLoadedCallbacks[t].push({success:e,failure:r,scope:n||this}))},ps.prototype.load=function(t,e,n,r){return this.add(t,e,n,r)},ps.prototype.remove=function(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]},ps.prototype.loadQueue=function(t,e,n){this.loadScripts(this.queue,t,e,n)},ps.prototype.loadScripts=function(t,e,n,r){var i=this,o=[],a=function(t,e){ds(i.scriptLoadedCallbacks[e],function(e){y(e[t])&&e[t].call(e.scope)}),i.scriptLoadedCallbacks[e]=void 0};i.queueLoadedCallbacks.push({success:e,failure:r,scope:n||this});var s=function(){var e,n=fs(t);t.length=0,ds(n,function(t){2!==i.states[t]?3!==i.states[t]?1!==i.states[t]&&(i.states[t]=1,i.loading++,i.loadScript(t,function(){i.states[t]=2,i.loading--,a("success",t),s()},function(){i.states[t]=3,i.loading--,o.push(t),a("failure",t),s()})):a("failure",t):a("success",t)}),i.loading||(e=i.queueLoadedCallbacks.slice(0),i.queueLoadedCallbacks.length=0,ds(e,function(t){0===o.length?y(t.success)&&t.success.call(t.scope):y(t.failure)&&t.failure.call(t.scope,o)}))};s()},ps.ScriptLoader=new ps,ps);function ps(t){void 0===t&&(t={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=t}var gs=function(t){var e=t;return{get:function(){return e},set:function(t){e=t}}},ms={},vs=gs("en"),ys=function(){return gt(ms,vs.get())},xs={getData:function(){return ut(ms,function(t){return Tt({},t)})},setCode:function(t){t&&vs.set(t)},getCode:function(){return vs.get()},add:function(t,e){var n=ms[t];n||(ms[t]=n={}),lt(e,function(t,e){n[e.toLowerCase()]=t})},translate:function(t){var e,n,r=ys().getOr({}),i=function(t){return y(t)?Object.prototype.toString.call(t):o(t)?"":""+t},o=function(t){return""===t||null==t},a=function(t){var e=i(t);return gt(r,e.toLowerCase()).map(i).getOr(e)},s=function(t){return t.replace(/{context:\w+}$/,"")};if(o(t))return"";if(d(e=t)&&mt(e,"raw"))return i(t.raw);if(f(n=t)&&1<n.length){var l=t.slice(1);return s(a(t[0]).replace(/\{([0-9]+)\}/g,function(t,e){return mt(l,e)?i(l[e]):t}))}return s(a(t))},isRtl:function(){return ys().bind(function(t){return gt(t,"_dir")}).exists(function(t){return"rtl"===t})},hasCode:function(t){return mt(ms,t)}},bs=function(){var t=[],e={},n={},r=[],i=function(t,e){var n=X(r,function(n){return n.name===t&&n.state===e});U(n,function(t){return t.callback()})},o=function(t){var e;return n[t]&&(e=n[t].dependencies),e||[]},a=function(t,e){return"object"==typeof e?e:"string"==typeof t?{prefix:"",resource:e,suffix:""}:{prefix:t.prefix,resource:e,suffix:t.suffix}},s=function(t,r,l,u,c){var d,f;e[t]||(0!==(d="string"==typeof r?r:r.prefix+r.resource+r.suffix).indexOf("/")&&-1===d.indexOf("://")&&(d=bs.baseURL+"/"+d),e[t]=d.substring(0,d.lastIndexOf("/")),f=function(){var e,n,c,d;i(t,"loaded"),e=r,n=l,c=u,d=o(t),U(d,function(t){var n=a(e,t);s(n.resource,n,void 0,void 0)}),n&&n.call(c||hs)},n[t]?f():hs.ScriptLoader.add(d,f,u,c))},l=function(t,i,o){void 0===o&&(o="added"),mt(n,t)&&"added"===o||mt(e,t)&&"loaded"===o?i():r.push({name:t,state:o,callback:i})};return{items:t,urls:e,lookup:n,_listeners:r,get:function(t){return n[t]?n[t].instance:void 0},dependencies:o,requireLangPack:function(t,n){!1!==bs.languageLoad&&l(t,function(){var r=xs.getCode();!r||n&&-1===(","+(n||"")+",").indexOf(","+r+",")||hs.ScriptLoader.add(e[t]+"/langs/"+r+".js")},"loaded")},add:function(e,r,o){var a=r;return t.push(a),n[e]={instance:a,dependencies:o},i(e,"added"),a},remove:function(t){delete e[t],delete n[t]},createUrl:a,addComponents:function(t,n){var r=e[t];U(n,function(t){hs.ScriptLoader.add(r+"/"+t)})},load:s,waitFor:l}};bs.languageLoad=!0,bs.baseURL="",bs.PluginManager=bs(),bs.ThemeManager=bs();var _s=function(t,e){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];null===n&&(n=setTimeout(function(){t.apply(null,r),n=null},e))}}},ws=function(t,e){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];null!==n&&clearTimeout(n),n=setTimeout(function(){t.apply(null,r),n=null},e)}}},Ss=function(t,e){var n=Yn(t,e);return void 0===n||""===n?[]:n.split(" ")},Cs=function(t){return void 0!==t.dom.classList},Ms=function(t,e){Cs(t)?t.dom.classList.add(e):function(t,e){return r=e,i=Ss(n=t,"class").concat([r]),qn(n,"class",i.join(" ")),!0;var n,r,i}(t,e)},Ts=function(t,e){return Cs(t)&&t.dom.classList.contains(e)},ks=function(t,e){var n=[];return U(Ze(t),function(t){e(t)&&(n=n.concat([t])),n=n.concat(ks(t,e))}),n},As=function(t,e){return n=e,i=void 0===(r=t)?document:r.dom,Ee(i)?[]:G(i.querySelectorAll(n),De);var n,r,i},Is=w("mce-annotation"),Ds=w("data-mce-annotation"),Os=w("data-mce-annotation-uid"),Ps=function(t,e){var n=t.selection.getRng(),r=De(n.startContainer),i=De(t.getBody()),o=e.fold(function(){return"."+Is()},function(t){return"["+Ds()+'="'+t+'"]'}),a=Ke(r,n.startOffset).getOr(r),s=Ar(a,o,function(t){return Re(t,i)}),l=function(t,e){return(n=t.dom)&&n.hasAttribute&&n.hasAttribute(e)?B.some(Yn(t,e)):B.none();var n};return s.bind(function(e){return l(e,""+Os()).bind(function(n){return l(e,""+Ds()).map(function(e){var r=Es(t,n);return{uid:n,name:e,elements:r}})})})},Es=function(t,e){var n=De(t.getBody());return As(n,"["+Os()+'="'+e+'"]')},Rs=0,Ls=function(t){var e=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++Rs+String(e)},Ns=function(t,e){var n,r,i=je(t).dom,o=De(i.createDocumentFragment()),a=(n=e,(r=(i||document).createElement("div")).innerHTML=n,Ze(De(r)));dn(o,a),fn(t),cn(t,o)},Bs=function(t,e){return De(t.dom.cloneNode(e))},zs=function(t){return Bs(t,!1)},Vs=function(t){return Bs(t,!0)},Fs=function(t,e,n){void 0===n&&(n=P);var r=new Wr(t,e),i=function(t){for(var e;(e=r[t]())&&!Rn(e)&&!n(e););return B.from(e).filter(Rn)};return{current:function(){return B.from(r.current()).filter(Rn)},next:function(){return i("next")},prev:function(){return i("prev")},prev2:function(){return i("prev2")}}},Hs=function(t,e){var n=e||function(e){return t.isBlock(e)||zn(e)||Hn(e)},r=function(t,e,n,i){if(Rn(t)){var o=i(t,e,t.data);if(-1!==o)return B.some({container:t,offset:o})}return n().bind(function(t){return r(t.container,t.offset,n,i)})};return{backwards:function(t,e,i,o){var a=Fs(t,o,n);return r(t,e,function(){return a.prev().map(function(t){return{container:t,offset:t.length}})},i).getOrNull()},forwards:function(t,e,i,o){var a=Fs(t,o,n);return r(t,e,function(){return a.next().map(function(t){return{container:t,offset:0}})},i).getOrNull()}}},Ws=function(t,e,n){return t.isSome()&&e.isSome()?B.some(n(t.getOrDie(),e.getOrDie())):B.none()},js=Math.round,Gs=function(t){return t?{left:js(t.left),top:js(t.top),bottom:js(t.bottom),right:js(t.right),width:js(t.width),height:js(t.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},Us=function(t,e){return t=Gs(t),e||(t.left=t.left+t.width),t.right=t.left,t.width=0,t},qs=function(t,e,n){return 0<=t&&t<=Math.min(e.height,n.height)/2},Xs=function(t,e){var n=Math.min(e.height/2,t.height/2);return t.bottom-n<e.top||!(t.top>e.bottom)&&qs(e.top-t.bottom,t,e)},Ys=function(t,e){return t.top>e.bottom||!(t.bottom<e.top)&&qs(e.bottom-t.top,t,e)},$s=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom},Zs=function(t){var e=t.startContainer,n=t.startOffset;return e.hasChildNodes()&&t.endOffset===n+1?e.childNodes[n]:null},Ks=function(t,e){return 1===t.nodeType&&t.hasChildNodes()&&(e>=t.childNodes.length&&(e=t.childNodes.length-1),t=t.childNodes[e]),t},Js=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),Qs=function(t){return"string"==typeof t&&768<=t.charCodeAt(0)&&Js.test(t)},tl=Tn,el=Ci,nl=An("display","block table"),rl=An("float","left right"),il=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){for(var n=0;n<t.length;n++)if(!t[n](e))return!1;return!0}}(tl,el,A(rl)),ol=A(An("white-space","pre pre-line pre-wrap")),al=Rn,sl=zn,ll=us.nodeIndex,ul=Ks,cl=function(t){return"createRange"in t?t.createRange():us.DOM.createRng()},dl=function(t){return t&&/[\r\n\t ]/.test(t)},fl=function(t){return!!t.setStart&&!!t.setEnd},hl=function(t){var e,n=t.startContainer,r=t.startOffset;return!!(dl(t.toString())&&ol(n.parentNode)&&Rn(n)&&(e=n.data,dl(e[r-1])||dl(e[r+1])))},pl=function(t){return 0===t.left&&0===t.right&&0===t.top&&0===t.bottom},gl=function(t){var e=t.getClientRects(),n=Gs(0<e.length?e[0]:t.getBoundingClientRect());return!fl(t)&&sl(t)&&pl(n)?function(t){var e=t.ownerDocument,n=cl(e),r=e.createTextNode(ei),i=t.parentNode;i.insertBefore(r,t),n.setStart(r,0),n.setEnd(r,1);var o=Gs(n.getBoundingClientRect());return i.removeChild(r),o}(t):pl(n)&&fl(t)?function(t){var e=t.endContainer,n=t.startOffset,r=t.endOffset;if(t.startContainer===e&&Rn(e)&&0===n&&1===r){var i=t.cloneRange();return i.setEndAfter(e),gl(i)}return null}(t):n},ml=function(t,e){var n=Us(t,e);return n.width=1,n.right=n.left+1,n},vl=function(t,e,n){var r=function(){return n=n||function(t){var e,n,r=[],i=function(t){var e,n;0!==t.height&&(0<r.length&&(e=t).left===(n=r[r.length-1]).left&&e.top===n.top&&e.bottom===n.bottom&&e.right===n.right||r.push(t))},o=function(t,e){var n=cl(t.ownerDocument);if(e<t.data.length){if(Qs(t.data[e]))return r;if(Qs(t.data[e-1])&&(n.setStart(t,e),n.setEnd(t,e+1),!hl(n)))return i(ml(gl(n),!1)),r}0<e&&(n.setStart(t,e-1),n.setEnd(t,e),hl(n)||i(ml(gl(n),!1))),e<t.data.length&&(n.setStart(t,e),n.setEnd(t,e+1),hl(n)||i(ml(gl(n),!0)))};if(al(t.container()))return o(t.container(),t.offset()),r;if(tl(t.container()))if(t.isAtEnd())n=ul(t.container(),t.offset()),al(n)&&o(n,n.data.length),il(n)&&!sl(n)&&i(ml(gl(n),!1));else{if(n=ul(t.container(),t.offset()),al(n)&&o(n,0),il(n)&&t.isAtEnd())return i(ml(gl(n),!1)),r;e=ul(t.container(),t.offset()-1),il(e)&&!sl(e)&&(!nl(e)&&!nl(n)&&il(n)||i(ml(gl(e),!1))),il(n)&&i(ml(gl(n),!0))}return r}(vl(t,e))};return{container:w(t),offset:w(e),toRange:function(){var n=cl(t.ownerDocument);return n.setStart(t,e),n.setEnd(t,e),n},getClientRects:r,isVisible:function(){return 0<r().length},isAtStart:function(){return al(t),0===e},isAtEnd:function(){return al(t)?e>=t.data.length:e>=t.childNodes.length},isEqual:function(n){return n&&t===n.container()&&e===n.offset()},getNode:function(n){return ul(t,n?e-1:e)}}};vl.fromRangeStart=function(t){return vl(t.startContainer,t.startOffset)},vl.fromRangeEnd=function(t){return vl(t.endContainer,t.endOffset)},vl.after=function(t){return vl(t.parentNode,ll(t)+1)},vl.before=function(t){return vl(t.parentNode,ll(t))},vl.isAbove=function(t,e){return Ws(rt(e.getClientRects()),it(t.getClientRects()),Xs).getOr(!1)},vl.isBelow=function(t,e){return Ws(it(e.getClientRects()),rt(t.getClientRects()),Ys).getOr(!1)},vl.isAtStart=function(t){return!!t&&t.isAtStart()},vl.isAtEnd=function(t){return!!t&&t.isAtEnd()},vl.isTextPosition=function(t){return!!t&&Rn(t.container())},vl.isElementPosition=function(t){return!1===vl.isTextPosition(t)};var yl,xl,bl=function(t,e){Rn(e)&&0===e.data.length&&t.remove(e)},_l=function(t,e,n){var r,i,o,a,s,l,u;Bn(n)?(o=t,a=e,l=B.from((s=n).firstChild),u=B.from(s.lastChild),a.insertNode(s),l.each(function(t){return bl(o,t.previousSibling)}),u.each(function(t){return bl(o,t.nextSibling)})):(r=t,e.insertNode(i=n),bl(r,i.previousSibling),bl(r,i.nextSibling))},wl=Rn,Sl=Dn,Cl=us.nodeIndex,Ml=function(t){var e=t.parentNode;return Sl(e)?Ml(e):e},Tl=function(t){return t?St(t.childNodes,function(t,e){return Sl(e)&&"BR"!==e.nodeName?t=t.concat(Tl(e)):t.push(e),t},[]):[]},kl=function(t){return function(e){return t===e}},Al=function(t){return(wl(t)?"text()":t.nodeName.toLowerCase())+"["+function(t){var e=Tl(Ml(t)),n=Ct(e,kl(t),t);e=e.slice(0,n+1);var r=St(e,function(t,n,r){return wl(n)&&wl(e[r-1])&&t++,t},0);return e=_t(e,kn([t.nodeName])),(n=Ct(e,kl(t),t))-r}(t)+"]"},Il=function(t,e){var n,r,i,o=[],a=e.container(),s=e.offset();return wl(a)?n=function(t,e){for(;(t=t.previousSibling)&&wl(t);)e+=t.data.length;return e}(a,s):(s>=(r=a.childNodes).length?(n="after",s=r.length-1):n="before",a=r[s]),o.push(Al(a)),i=function(t,e,n){var r=[];for(e=e.parentNode;e!==t;e=e.parentNode)r.push(e);return r}(t,a),i=_t(i,A(Dn)),(o=o.concat(bt(i,Al))).reverse().join("/")+","+n},Dl=function(t,e){if(!e)return null;var n=e.split(","),r=n[0].split("/"),i=1<n.length?n[1]:"before",o=St(r,function(t,e){var n,r,i,o,a=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(e);return a?("text()"===a[1]&&(a[1]="#text"),n=t,r=a[1],i=parseInt(a[2],10),o=Tl(n),o=_t(o,function(t,e){return!wl(t)||!wl(o[e-1])}),(o=_t(o,kn([r])))[i]):null},t);return o?wl(o)?function(t,e){for(var n,r=t,i=0;wl(r);){if(n=r.data.length,i<=e&&e<=i+n){t=r,e-=i;break}if(!wl(r.nextSibling)){t=r,e=n;break}i+=n,r=r.nextSibling}return wl(t)&&e>t.data.length&&(e=t.data.length),vl(t,e)}(o,parseInt(i,10)):(i="after"===i?Cl(o)+1:Cl(o),vl(o.parentNode,i)):null},Ol=Hn,Pl=function(t,e,n,r,i){var o,a=r[i?"startContainer":"endContainer"],s=r[i?"startOffset":"endOffset"],l=[],u=0,c=t.getRoot();for(Rn(a)?l.push(n?function(t,e,n){for(var r=t(e.data.slice(0,n)).length,i=e.previousSibling;i&&Rn(i);i=i.previousSibling)r+=t(i.data).length;return r}(e,a,s):s):(s>=(o=a.childNodes).length&&o.length&&(u=1,s=Math.max(0,o.length-1)),l.push(t.nodeIndex(o[s],n)+u));a&&a!==c;a=a.parentNode)l.push(t.nodeIndex(a,n));return l},El=function(t,e,n){var r=0;return Me.each(t.select(e),function(t){if("all"!==t.getAttribute("data-mce-bogus"))return t!==n&&void r++}),r},Rl=function(t,e){var n,r=e?"start":"end",i=t[r+"Container"],o=t[r+"Offset"];Tn(i)&&"TR"===i.nodeName&&(i=(n=i.childNodes)[Math.min(e?o:o-1,n.length-1)])&&t["set"+(e?"Start":"End")](i,o=e?0:i.childNodes.length)},Ll=function(t){return Rl(t,!0),Rl(t,!1),t},Nl=function(t,e){var n;if(Tn(t)&&(t=Ks(t,e),Ol(t)))return t;if(ui(t)){if(Rn(t)&&si(t)&&(t=t.parentNode),Ol(n=t.previousSibling))return n;if(Ol(n=t.nextSibling))return n}},Bl=function(t,e,n){var r=n.getNode(),i=r?r.nodeName:null,o=n.getRng();if(Ol(r)||"IMG"===i)return{name:i,index:El(n.dom,i,r)};var a,s,l,u,c,d,f,h=Nl((a=o).startContainer,a.startOffset)||Nl(a.endContainer,a.endOffset);return h?{name:i=h.tagName,index:El(n.dom,i,h)}:(d=(l=n).dom,(f={}).start=Pl(d,s=t,u=e,c=o,!0),l.isCollapsed()||(f.end=Pl(d,s,u,c,!1)),f)},zl=function(t,e,n){var r={"data-mce-type":"bookmark",id:e,style:"overflow:hidden;line-height:0px"};return n?t.create("span",r,"&#xFEFF;"):t.create("span",r)},Vl=function(t,e){var n=t.dom,r=t.getRng(),i=n.uniqueId(),o=t.isCollapsed(),a=t.getNode(),s=a.nodeName;if("IMG"===s)return{name:s,index:El(n,s,a)};var l,u=Ll(r.cloneRange());o||(u.collapse(!1),l=zl(n,i+"_end",e),_l(n,u,l)),(r=Ll(r)).collapse(!0);var c=zl(n,i+"_start",e);return _l(n,r,c),t.moveToBookmark({id:i,keep:!0}),{id:i}},Fl=C(Bl,S,!0),Hl=us.DOM,Wl=function(t,e,n){var r=t.getParam(e,n);if(-1===r.indexOf("="))return r;var i=t.getParam(e,"","hash");return i.hasOwnProperty(t.id)?i[t.id]:n},jl=function(t){return t.getParam("content_security_policy","")},Gl=function(t){if(t.getParam("force_p_newlines",!1))return"p";var e=t.getParam("forced_root_block","p");return!1===e?"":!0===e?"p":e},Ul=function(t){return t.getParam("forced_root_block_attrs",{})},ql=function(t){return t.getParam("automatic_uploads",!0,"boolean")},Xl=function(t){return t.getParam("icons","","string")},Yl=function(t){return t.getParam("referrer_policy","","string")},$l=function(t){return t.getParam("language","en","string")},Zl=function(t){return t.getParam("indent_use_margin",!1)},Kl=function(t){var e=t.getParam("font_css",[]);return f(e)?e:G(e.split(","),Ht)},Jl=function(t){var e=t.getParam("object_resizing");return!1!==e&&!be.iOS&&(c(e)?e:"table,img,figure.image,div,video,iframe")},Ql=function(t){return t.getParam("event_root")},tu=function(t){return t.getParam("theme")},eu=function(t){return!1!==t.getParam("inline_boundaries")},nu=function(t){return t.getParam("plugins","","string")},ru=Tn,iu=Rn,ou=function(t){var e=t.parentNode;e&&e.removeChild(t)},au=function(t){var e=ii(t);return{count:t.length-e.length,text:e}},su=function(t){for(var e;-1!==(e=t.data.lastIndexOf(ni));)t.deleteData(e,1)},lu=function(t,e){return du(t),e},uu=function(t,e){var n,r,i=e.container(),o=(n=ot(i.childNodes),(-1===(r=H(n,t))?B.none():B.some(r)).map(function(t){return t<e.offset()?vl(i,e.offset()-1):e}).getOr(e));return du(t),o},cu=function(t,e){return vl.isTextPosition(e)?function(t,e){return iu(t)&&e.container()===t?(i=au((n=t).data.substr(0,(r=e).offset())),o=au(n.data.substr(r.offset())),0<(i.text+o.text).length?(su(n),vl(n,r.offset()-i.count)):r):lu(t,e);var n,r,i,o}(t,e):(n=t,((r=e).container()===n.parentNode?uu:lu)(n,r));var n,r},du=function(t){ru(t)&&ui(t)&&(ci(t)?t.removeAttribute("data-mce-caret"):ou(t)),iu(t)&&(su(t),0===t.data.length&&ou(t))},fu=de().browser,hu=Hn,pu=jn,gu=Wn,mu=function(t,e,n){var r,i,o,a,s=Us(e.getBoundingClientRect(),n),l="BODY"===t.tagName?(r=t.ownerDocument.documentElement,i=t.scrollLeft||r.scrollLeft,t.scrollTop||r.scrollTop):(a=t.getBoundingClientRect(),i=t.scrollLeft-a.left,t.scrollTop-a.top);return s.left+=i,s.right+=i,s.top+=l,s.bottom+=l,s.width=1,0<(o=e.offsetWidth-e.clientWidth)&&(n&&(o*=-1),s.left+=o,s.right+=o),s},vu=function(){return fu.isIE()||fu.isEdge()||fu.isFirefox()},yu=function(t){return hu(t)||pu(t)},xu=function(t){return yu(t)||On(t)&&vu()},bu=Hn,_u=jn,wu=An("display","block table table-cell table-caption list-item"),Su=ui,Cu=si,Mu=Tn,Tu=Ci,ku=function(t,e){for(var n;n=t(e);)if(!Cu(n))return n;return null},Au=function(t,e,n,r,i){var o=new Wr(t,r),a=bu(t)||Cu(t);if(e<0){if(a&&n(t=ku(o.prev.bind(o),!0)))return t;for(;t=ku(o.prev.bind(o),i);)if(n(t))return t}if(0<e){if(a&&n(t=ku(o.next.bind(o),!0)))return t;for(;t=ku(o.next.bind(o),i);)if(n(t))return t}return null},Iu=function(t,e){for(;t&&t!==e;){if(wu(t))return t;t=t.parentNode}return null},Du=function(t,e,n){return Iu(t.container(),n)===Iu(e.container(),n)},Ou=function(t,e){if(!e)return null;var n=e.container(),r=e.offset();return Mu(n)?n.childNodes[r+t]:null},Pu=function(t,e){var n=e.ownerDocument.createRange();return t?(n.setStartBefore(e),n.setEndBefore(e)):(n.setStartAfter(e),n.setEndAfter(e)),n},Eu=function(t,e,n){for(var r,i,o,a=t?"previousSibling":"nextSibling";n&&n!==e;){if(Su(r=n[a])&&(r=r[a]),bu(r)||_u(r)){if(o=n,Iu(r,i=e)===Iu(o,i))return r;break}if(Tu(r))break;n=n.parentNode}return null},Ru=C(Pu,!0),Lu=C(Pu,!1),Nu=function(t,e,n){var r,i,o=C(Eu,!0,e),a=C(Eu,!1,e),s=n.startContainer,l=n.startOffset;if(si(s)){if(Mu(s)||(s=s.parentNode),"before"===(i=s.getAttribute("data-mce-caret"))&&xu(r=s.nextSibling))return Ru(r);if("after"===i&&xu(r=s.previousSibling))return Lu(r)}if(!n.collapsed)return n;if(Rn(s)){if(Su(s)){if(1===t){if(r=a(s))return Ru(r);if(r=o(s))return Lu(r)}if(-1===t){if(r=o(s))return Lu(r);if(r=a(s))return Ru(r)}return n}if(pi(s)&&l>=s.data.length-1)return 1===t&&(r=a(s))?Ru(r):n;if(hi(s)&&l<=1)return-1===t&&(r=o(s))?Lu(r):n;if(l===s.data.length)return(r=a(s))?Ru(r):n;if(0===l)return(r=o(s))?Lu(r):n}return n},Bu=function(t,e){return B.from(Ou(t?0:-1,e)).filter(bu)},zu=function(t,e,n){var r=Nu(t,e,n);return-1===t?vl.fromRangeStart(r):vl.fromRangeEnd(r)},Vu=function(t){return B.from(t.getNode()).map(De)},Fu=function(t,e){for(;e=t(e);)if(e.isVisible())return e;return e},Hu=function(t,e){var n=Du(t,e);return!(n||!zn(t.getNode()))||n};(xl=yl=yl||{})[xl.Backwards=-1]="Backwards",xl[xl.Forwards=1]="Forwards";var Wu,ju,Gu=Hn,Uu=Rn,qu=Tn,Xu=zn,Yu=Ci,$u=function(t){return _i(t)||!!Mi(e=t)&&!0!==$(ot(e.getElementsByTagName("*")),function(t,e){return t||mi(e)},!1);var e},Zu=Ti,Ku=function(t,e){return t.hasChildNodes()&&e<t.childNodes.length?t.childNodes[e]:null},Ju=function(t,e){if(0<t){if(Yu(e.previousSibling)&&!Uu(e.previousSibling))return vl.before(e);if(Uu(e))return vl(e,0)}if(t<0){if(Yu(e.nextSibling)&&!Uu(e.nextSibling))return vl.after(e);if(Uu(e))return vl(e,e.data.length)}return t<0&&!Xu(e)?vl.after(e):vl.before(e)},Qu=function(t,e,n){var r,i,o,a;if(!qu(n)||!e)return null;if(e.isEqual(vl.after(n))&&n.lastChild){if(a=vl.after(n.lastChild),t<0&&Yu(n.lastChild)&&qu(n.lastChild))return Xu(n.lastChild)?vl.before(n.lastChild):a}else a=e;var s,l,u,c=a.container(),d=a.offset();if(Uu(c)){if(t<0&&0<d)return vl(c,--d);if(0<t&&d<c.length)return vl(c,++d);r=c}else{if(t<0&&0<d&&(i=Ku(c,d-1),Yu(i)))return!$u(i)&&(o=Au(i,t,Zu,i))?Uu(o)?vl(o,o.data.length):vl.after(o):Uu(i)?vl(i,i.data.length):vl.before(i);if(0<t&&d<c.childNodes.length&&(i=Ku(c,d),Yu(i)))return Xu(i)?(s=n,(u=(l=i).nextSibling)&&Yu(u)?Uu(u)?vl(u,0):vl.before(u):Qu(yl.Forwards,vl.after(l),s)):!$u(i)&&(o=Au(i,t,Zu,i))?Uu(o)?vl(o,0):vl.before(o):Uu(i)?vl(i,0):vl.after(i);r=i||a.getNode()}if((0<t&&a.isAtEnd()||t<0&&a.isAtStart())&&(r=Au(r,t,E,n,!0),Zu(r,n)))return Ju(t,r);i=Au(r,t,Zu,n);var f=Mt(X(function(t,e){for(var n=[];t&&t!==e;)n.push(t),t=t.parentNode;return n}(c,n),Gu));return!f||i&&f.contains(i)?i?Ju(t,i):null:a=0<t?vl.after(f):vl.before(f)},tc=function(t){return{next:function(e){return Qu(yl.Forwards,e,t)},prev:function(e){return Qu(yl.Backwards,e,t)}}},ec=function(t){return vl.isTextPosition(t)?0===t.offset():Ci(t.getNode())},nc=function(t){if(vl.isTextPosition(t)){var e=t.container();return t.offset()===e.data.length}return Ci(t.getNode(!0))},rc=function(t,e){return!vl.isTextPosition(t)&&!vl.isTextPosition(e)&&t.getNode()===e.getNode(!0)},ic=function(t,e,n){var r=tc(e);return B.from(t?r.next(n):r.prev(n))},oc=function(t,e,n){return ic(t,e,n).bind(function(r){return Du(n,r,e)&&function(t,e,n){return t?!rc(e,n)&&!(!vl.isTextPosition(r=e)&&zn(r.getNode()))&&nc(e)&&ec(n):!rc(n,e)&&ec(e)&&nc(n);var r}(t,n,r)?ic(t,e,r):B.some(r)})},ac=function(t,e,n,r){return oc(t,e,n).bind(function(n){return r(n)?ac(t,e,n,r):B.some(n)})},sc=function(t,e){var n,r,i,o,a,s=t?e.firstChild:e.lastChild;return Rn(s)?B.some(vl(s,t?0:s.data.length)):s?Ci(s)?B.some(t?vl.before(s):zn(a=s)?vl.before(a):vl.after(a)):(r=e,i=s,o=(n=t)?vl.before(i):vl.after(i),ic(n,r,o)):B.none()},lc=C(ic,!0),uc=C(ic,!1),cc=C(sc,!0),dc=C(sc,!1),fc="_mce_caret",hc=function(t){return Tn(t)&&t.id===fc},pc=function(t,e){for(;e&&e!==t;){if(e.id===fc)return e;e=e.parentNode}return null},gc=function(t,e){return Tn(e)&&t.isBlock(e)&&!e.innerHTML&&!be.ie&&(e.innerHTML='<br data-mce-bogus="1" />'),e},mc=function(t,e,n){return!(!1!==e.hasChildNodes()||!pc(t,e)||(i=n,o=(r=e).ownerDocument.createTextNode(ni),r.appendChild(o),i.setStart(o,0),i.setEnd(o,0),0));var r,i,o},vc=function(t,e,n,r){var i,o,a,s,l=n[e?"start":"end"],u=t.getRoot();if(l){for(a=l[0],o=u,i=l.length-1;1<=i;i--){if(s=o.childNodes,mc(u,o,r))return!0;if(l[i]>s.length-1)return!!mc(u,o,r)||function(t,e){return dc(t).fold(P,function(t){return e.setStart(t.container(),t.offset()),e.setEnd(t.container(),t.offset()),!0})}(o,r);o=s[l[i]]}3===o.nodeType&&(a=Math.min(l[0],o.nodeValue.length)),1===o.nodeType&&(a=Math.min(l[0],o.childNodes.length)),e?r.setStart(o,a):r.setEnd(o,a)}return!0},yc=function(t){return Rn(t)&&0<t.data.length},xc=function(t,e,n){var r,i,o,a,s,l,u=t.get(n.id+"_"+e),c=n.keep;if(u){if(r=u.parentNode,i="start"===e?c?u.hasChildNodes()?(r=u.firstChild,1):yc(u.nextSibling)?(r=u.nextSibling,0):yc(u.previousSibling)?(r=u.previousSibling,u.previousSibling.data.length):(r=u.parentNode,t.nodeIndex(u)+1):t.nodeIndex(u):c?u.hasChildNodes()?(r=u.firstChild,1):yc(u.previousSibling)?(r=u.previousSibling,u.previousSibling.data.length):(r=u.parentNode,t.nodeIndex(u)):t.nodeIndex(u),s=r,l=i,!c){for(a=u.previousSibling,o=u.nextSibling,Me.each(Me.grep(u.childNodes),function(t){Rn(t)&&(t.nodeValue=t.nodeValue.replace(/\uFEFF/g,""))});u=t.get(n.id+"_"+e);)t.remove(u,!0);a&&o&&a.nodeType===o.nodeType&&Rn(a)&&!be.opera&&(i=a.nodeValue.length,a.appendData(o.nodeValue),t.remove(o),s=a,l=i)}return B.some(vl(s,l))}return B.none()},bc=function(t,e,n){return 2===e?Bl(ii,n,t):3===e?(i=(r=t).getRng(),{start:Il(r.dom.getRoot(),vl.fromRangeStart(i)),end:Il(r.dom.getRoot(),vl.fromRangeEnd(i))}):e?{rng:t.getRng()}:Vl(t,!1);var r,i},_c=function(t,e){(function(t,e){var n,r,i,o,a,s,l,u,d,f,h,p,g,m=t.dom;if(e){if(Me.isArray(e.start))return p=e,g=(h=m).createRng(),vc(h,!0,p,g)&&vc(h,!1,p,g)?B.some(g):B.none();if(c(e.start))return B.some((u=e,d=(l=m).createRng(),f=Dl(l.getRoot(),u.start),d.setStart(f.container(),f.offset()),f=Dl(l.getRoot(),u.end),d.setEnd(f.container(),f.offset()),d));if(e.hasOwnProperty("id"))return a=xc(i=m,"start",o=e),s=xc(i,"end",o),Ws(a,s.or(a),function(t,e){var n=i.createRng();return n.setStart(gc(i,t.container()),t.offset()),n.setEnd(gc(i,e.container()),e.offset()),n});if(e.hasOwnProperty("name"))return B.from((n=m).select((r=e).name)[r.index]).map(function(t){var e=n.createRng();return e.selectNode(t),e});if(e.hasOwnProperty("rng"))return B.some(e.rng)}return B.none()})(t,e).each(function(e){t.setRng(e)})},wc=function(t){return Tn(t)&&"SPAN"===t.tagName&&"bookmark"===t.getAttribute("data-mce-type")},Sc=function(t){return" "===t},Cc=function(t){return""!==t&&-1!==" \f\n\r\t\v".indexOf(t)},Mc=function(t){return!Cc(t)&&!Sc(t)},Tc=function(t){return!!t.nodeType},kc=function(t,e,n){var r,i,o,a,s=n.startOffset,l=n.startContainer;if(!(n.startContainer===n.endContainer&&(a=n.startContainer.childNodes[n.startOffset])&&/^(IMG)$/.test(a.nodeName)||1!==l.nodeType))for(s<(o=l.childNodes).length?r=new Wr(l=o[s],t.getParent(l,t.isBlock)):(r=new Wr(l=o[o.length-1],t.getParent(l,t.isBlock))).next(!0),i=r.current();i;i=r.next())if(3===i.nodeType&&!Oc(i))return n.setStart(i,0),void e.setRng(n)},Ac=function(t,e,n){if(t){var r=e?"nextSibling":"previousSibling";for(t=n?t:t[r];t;t=t[r])if(1===t.nodeType||!Oc(t))return t}},Ic=function(t,e){return Tc(e)&&(e=e.nodeName),!!t.schema.getTextBlockElements()[e.toLowerCase()]},Dc=function(t,e,n){return t.schema.isValidChild(e,n)},Oc=function(t,e){if(void 0===e&&(e=!1),v(t)&&Rn(t)){var n=e?t.data.replace(/ /g," "):t.data;return Ai(n)}return!1},Pc=function(t,e){return"string"!=typeof t?t=t(e):e&&(t=t.replace(/%(\w+)/g,function(t,n){return e[n]||t})),t},Ec=function(t,e){return t=""+((t=t||"").nodeName||t),e=""+((e=e||"").nodeName||e),t.toLowerCase()===e.toLowerCase()},Rc=function(t,e,n){return"color"!==n&&"backgroundColor"!==n||(e=t.toHex(e)),"fontWeight"===n&&700===e&&(e="bold"),"fontFamily"===n&&(e=e.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+e},Lc=function(t,e,n){return Rc(t,t.getStyle(e,n),n)},Nc=function(t,e){var n;return t.getParent(e,function(e){return(n=t.getStyle(e,"text-decoration"))&&"none"!==n}),n},Bc=function(t,e,n){return t.getParents(e,n,t.getRoot())},zc=function(t,e,n){var r=["inline","block","selector","attributes","styles","classes"],i=function(t){return pt(t,function(t,e){return j(r,function(t){return t===e})})};return j(t.formatter.get(e),function(e){var r=i(e);return j(t.formatter.get(n),function(t){var e,n,s,l=i(t);return e=r,n=l,void 0===s&&(s=a),o(s).eq(e,n)})})},Vc=function(t){return vt(t,"block")},Fc=function(t){return vt(t,"selector")},Hc=function(t){return vt(t,"inline")},Wc=function(t,e){return j(e.childNodes,t.isBlock)},jc=wc,Gc=Bc,Uc=Oc,qc=Ic,Xc=function(t,e){for(var n=e;n;){if(Tn(n)&&t.getContentEditable(n))return"false"===t.getContentEditable(n)?n:e;n=n.parentNode}return e},Yc=function(t,e,n,r){for(var i=e.data,o=n;t?0<=o:o<i.length;t?o--:o++)if(r(i.charAt(o)))return t?o+1:o;return-1},$c=function(t,e,n){return Yc(t,e,n,function(t){return Sc(t)||Cc(t)})},Zc=function(t,e,n){return Yc(t,e,n,Mc)},Kc=function(t,e,n,r,i,o){var a,s=t.getParent(n,t.isBlock)||e,l=function(e,n,r){var o=Hs(t);return B.from((i?o.backwards:o.forwards)(e,n,function(t,e){return jc(t.parentNode)?-1:r(i,a=t,e)},s))};return l(n,r,$c).bind(function(t){return o?l(t.container,t.offset+(i?-1:0),Zc):B.some(t)}).orThunk(function(){return a?B.some({container:a,offset:i?0:a.length}):B.none()})},Jc=function(t,e,n,r,i){Rn(r)&&0===r.nodeValue.length&&r[i]&&(r=r[i]);for(var o=Gc(t,r),a=0;a<o.length;a++)for(var s=0;s<e.length;s++){var l=e[s];if((!("collapsed"in l)||l.collapsed===n.collapsed)&&t.is(o[a],l.selector))return o[a]}return r},Qc=function(t,e,n,r){var i,o,a=t.dom,s=a.getRoot();if(e[0].wrapper||(o=a.getParent(n,e[0].block,s)),o||(i=a.getParent(n,"LI,TD,TH"),o=a.getParent(Rn(n)?n.parentNode:n,function(e){return e!==s&&qc(t,e)},i)),o&&e[0].wrapper&&(o=Gc(a,o,"ul,ol").reverse()[0]||o),!o)for(o=n;o[r]&&!a.isBlock(o[r])&&!Ec(o=o[r],"br"););return o||n},td=function(t,e,n,r){var i=n.parentNode;return!v(n[r])&&(!(i!==e&&!m(i)&&!t.isBlock(i))||td(t,e,i,r))},ed=function(t,e,n,r,i){var o,a,s=n,l=i?"previousSibling":"nextSibling",u=t.getRoot();if(Rn(n)&&!Uc(n)&&(i?0<r:r<n.data.length))return n;for(;;){if(!e[0].block_expand&&t.isBlock(s))return s;for(o=s[l];o;o=o[l]){var c=Rn(o)&&!td(t,u,o,l);if(!jc(o)&&(!zn(a=o)||!a.getAttribute("data-mce-bogus")||a.nextSibling)&&!Uc(o,c))return s}if(s===u||s.parentNode===u){n=s;break}s=s.parentNode}return n},nd=function(t){return jc(t.parentNode)||jc(t)},rd=function(t,e,n,r){void 0===r&&(r=!1);var i=e.startContainer,o=e.startOffset,a=e.endContainer,s=e.endOffset,l=t.dom;return Tn(i)&&i.hasChildNodes()&&(i=Ks(i,o),Rn(i)&&(o=0)),Tn(a)&&a.hasChildNodes()&&(a=Ks(a,e.collapsed?s:s-1),Rn(a)&&(s=a.nodeValue.length)),i=Xc(l,i),a=Xc(l,a),nd(i)&&(i=jc(i)?i:i.parentNode,Rn(i=e.collapsed?i.previousSibling||i:i.nextSibling||i)&&(o=e.collapsed?i.length:0)),nd(a)&&(a=jc(a)?a:a.parentNode,Rn(a=e.collapsed?a.nextSibling||a:a.previousSibling||a)&&(s=e.collapsed?0:a.length)),e.collapsed&&(Kc(l,t.getBody(),i,o,!0,r).each(function(t){i=t.container,o=t.offset}),Kc(l,t.getBody(),a,s,!1,r).each(function(t){a=t.container,s=t.offset})),(n[0].inline||n[0].block_expand)&&(n[0].inline&&Rn(i)&&0!==o||(i=ed(l,n,i,o,!0)),n[0].inline&&Rn(a)&&s!==a.nodeValue.length||(a=ed(l,n,a,s,!1))),n[0].selector&&!1!==n[0].expand&&!n[0].inline&&(i=Jc(l,n,e,i,"previousSibling"),a=Jc(l,n,e,a,"nextSibling")),(n[0].block||n[0].selector)&&(i=Qc(t,n,i,"previousSibling"),a=Qc(t,n,a,"nextSibling"),n[0].block&&(l.isBlock(i)||(i=ed(l,n,i,o,!0)),l.isBlock(a)||(a=ed(l,n,a,s,!1)))),Tn(i)&&(o=l.nodeIndex(i),i=i.parentNode),Tn(a)&&(s=l.nodeIndex(a)+1,a=a.parentNode),{startContainer:i,startOffset:o,endContainer:a,endOffset:s}},id=function(t,e){var n=t.childNodes;return e>=n.length?e=n.length-1:e<0&&(e=0),n[e]||t},od=function(t,e,n){var r=e.startContainer,i=e.startOffset,o=e.endContainer,a=e.endOffset,s=function(t){var e=t[0];return 3===e.nodeType&&e===r&&i>=e.nodeValue.length&&t.splice(0,1),e=t[t.length-1],0===a&&0<t.length&&e===o&&3===e.nodeType&&t.splice(t.length-1,1),t},l=function(t,e,n){for(var r=[];t&&t!==n;t=t[e])r.push(t);return r},u=function(t,e){do{if(t.parentNode===e)return t;t=t.parentNode}while(t)},c=function(t,e,r){for(var i=r?"nextSibling":"previousSibling",o=t,a=o.parentNode;o&&o!==e;o=a){a=o.parentNode;var u=l(o===t?o:o[i],i);u.length&&(r||u.reverse(),n(s(u)))}};if(1===r.nodeType&&r.hasChildNodes()&&(r=id(r,i)),1===o.nodeType&&o.hasChildNodes()&&(o=id(o,a-1)),r===o)return n(s([r]));for(var d=t.findCommonAncestor(r,o),f=r;f;f=f.parentNode){if(f===o)return c(r,d,!0);if(f===d)break}for(f=o;f;f=f.parentNode){if(f===r)return c(o,d);if(f===d)break}var h=u(r,d)||r,p=u(o,d)||o;c(r,h,!0);var g=l(h===r?h:h.nextSibling,"nextSibling",p===o?p.nextSibling:p);g.length&&n(s(g)),c(o,p)},ad=function(t){var e=[];if(t)for(var n=0;n<t.rangeCount;n++)e.push(t.getRangeAt(n));return e},sd=function(t,e){var n=As(e,"td[data-mce-selected],th[data-mce-selected]");return 0<n.length?n:function(t){return X(J(t,function(t){var e=Zs(t);return e?[De(e)]:[]}),Qr)}(t)},ld=function(t){return sd(ad(t.selection.getSel()),De(t.getBody()))},ud=function(t){return Je(t).fold(w([t]),function(e){return[t].concat(ud(e))})},cd=function(t){return Qe(t).fold(w([t]),function(e){return"br"===Ne(e)?qe(e).map(function(e){return[t].concat(cd(e))}).getOr([]):[t].concat(cd(e))})},dd=function(t,e){return Ws((a=(o=e).startContainer,s=o.startOffset,Rn(a)?0===s?B.some(De(a)):B.none():B.from(a.childNodes[s]).map(De)),(r=(n=e).endContainer,i=n.endOffset,Rn(r)?i===r.data.length?B.some(De(r)):B.none():B.from(r.childNodes[i-1]).map(De)),function(e,n){var r=Z(ud(t),C(Re,e)),i=Z(cd(t),C(Re,n));return r.isSome()&&i.isSome()}).getOr(!1);var n,r,i,o,a,s},fd=function(t,e,n,r){var i=n,o=new Wr(n,i),a=pt(t.schema.getMoveCaretBeforeOnEnterElements(),function(t,e){return!W(["td","th","table"],e.toLowerCase())});do{if(Rn(n)&&0!==Me.trim(n.nodeValue).length)return void(r?e.setStart(n,0):e.setEnd(n,n.nodeValue.length));if(a[n.nodeName])return void(r?e.setStartBefore(n):"BR"===n.nodeName?e.setEndBefore(n):e.setEndAfter(n))}while(n=r?o.next():o.prev());"BODY"===i.nodeName&&(r?e.setStart(i,0):e.setEnd(i,i.childNodes.length))},hd=function(t){var e=t.selection.getSel();return e&&0<e.rangeCount},pd=function(t,e){var n=ld(t);0<n.length?U(n,function(n){var r=n.dom,i=t.dom.createRng();i.setStartBefore(r),i.setEndAfter(r),e(i,!0)}):e(t.selection.getRng(),!1)},gd=function(t,e,n){var r=Vl(t,e);n(r),t.moveToBookmark(r)},md=(Wu=Fe,{get:function(t){if(!Wu(t))throw new Error("Can only get text value of a text node");return ju(t).getOr("")},getOption:ju=function(t){return Wu(t)?B.from(t.dom.nodeValue):B.none()},set:function(t,e){if(!Wu(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=e}}),vd=function(t){return md.get(t)},yd=function(t,e,n,r){var i=e.uid,o=void 0===i?Ls("mce-annotation"):i,a=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(e,["uid"]),s=Ae("span",t);Ms(s,Is()),qn(s,""+Os(),o),qn(s,""+Ds(),n);var l,u=r(o,a),c=u.attributes,d=u.classes,f=void 0===d?[]:d;return Xn(s,void 0===c?{}:c),l=s,U(f,function(t){Ms(l,t)}),s},xd=function(t){var e,n=(e={},{register:function(t,n){e[t]={name:t,settings:n}},lookup:function(t){return e.hasOwnProperty(t)?B.from(e[t]).map(function(t){return t.settings}):B.none()}});!function(t,e){t.on("init",function(){t.serializer.addNodeFilter("span",function(t){U(t,function(t){B.from(t.attr(Ds())).bind(e.lookup).each(function(e){!1===e.persistent&&t.unwrap()})})})})}(t,n);var r=function(t,e){var n=gs({}),r=function(t,e){i(t,function(t){return e(t),t})},i=function(t,e){var r=n.get(),i=e(r.hasOwnProperty(t)?r[t]:{listeners:[],previous:gs(B.none())});r[t]=i,n.set(r)},o=ws(function(){var e,o,a=n.get(),s=(e=at(a),(o=z.call(e,0)).sort(void 0),o);U(s,function(e){i(e,function(n){var i=n.previous.get();return Ps(t,B.some(e)).fold(function(){var t;i.isSome()&&(r(t=e,function(e){U(e.listeners,function(e){return e(!1,t)})}),n.previous.set(B.none()))},function(t){var e,o,a,s=t.uid,l=t.name,u=t.elements;i.is(s)||(o=s,a=u,r(e=l,function(t){U(t.listeners,function(t){return t(!0,e,{uid:o,nodes:G(a,function(t){return t.dom})})})}),n.previous.set(B.some(s)))}),{previous:n.previous,listeners:n.listeners}})})},30);return t.on("remove",function(){o.cancel()}),t.on("NodeChange",function(){o.throttle()}),{addListener:function(t,e){i(t,function(t){return{previous:t.previous,listeners:t.listeners.concat([e])}})}}}(t);return{register:function(t,e){n.register(t,e)},annotate:function(e,r){n.lookup(e).each(function(n){!function(t,e,n,r){t.undoManager.transact(function(){var i,o,a,s,l=t.selection,u=l.getRng(),c=0<ld(t).length;u.collapsed&&!c&&(a=rd(i=t,o=u,[{inline:!0}]),o.setStart(a.startContainer,a.startOffset),o.setEnd(a.endContainer,a.endOffset),i.selection.setRng(o)),l.getRng().collapsed&&!c?(s=yd(t.getDoc(),r,e,n.decorate),Ns(s,ei),l.getRng().insertNode(s.dom),l.select(s.dom)):gd(l,!1,function(){pd(t,function(i){!function(t,e,n,r,i){var o=[],a=yd(t.getDoc(),i,n,r),s=gs(B.none()),l=function(){s.set(B.none())},u=function(t){U(t,c)},c=function(e){var n,r;switch(function(t,e,n,r){return Ue(e).fold(function(){return"skipping"},function(i){return"br"===r||Fe(a=e)&&vd(a)===ni?"valid":Ve(o=e)&&Ts(o,Is())?"existing":hc(e.dom)?"caret":Dc(t,n,r)&&Dc(t,Ne(i),n)?"valid":"invalid-child";var o,a})}(t,e,"span",Ne(e))){case"invalid-child":l();var i=Ze(e);u(i),l();break;case"valid":var c=s.get().getOrThunk(function(){var t=zs(a);return o.push(t),s.set(B.some(t)),t});sn(n=e,r=c),cn(r,n)}};od(t.dom,e,function(t){var e;l(),e=G(t,De),u(e)})}(t,i,e,n.decorate,r)})})})}(t,e,n,r)})},annotationChanged:function(t,e){r.addListener(t,e)},remove:function(e){Ps(t,B.some(e)).each(function(t){U(t.elements,pn)})},getAll:function(e){var n,r,i,o,a=(n=e,r=De(t.getBody()),i=As(r,"["+Ds()+'="'+n+'"]'),o={},U(i,function(t){var e=Yn(t,Os()),n=o.hasOwnProperty(e)?o[e]:[];o[e]=n.concat([t])}),o);return ut(a,function(t){return G(t,function(t){return t.dom})})}}},bd=function(t){return{getBookmark:C(bc,t),moveToBookmark:C(_c,t)}};bd.isBookmarkNode=wc;var _d=function(t,e){for(;e&&e!==t;){if(Fn(e)||Hn(e))return e;e=e.parentNode}return null},wd=function(t,e,n){if(n.collapsed)return!1;if(be.browser.isIE()&&n.startOffset===n.endOffset-1&&n.startContainer===n.endContainer){var r=n.startContainer.childNodes[n.startOffset];if(Tn(r))return j(r.getClientRects(),function(n){return $s(n,t,e)})}return j(n.getClientRects(),function(n){return $s(n,t,e)})},Sd=function(t,e,n){return t.fire(e,n)},Cd={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:function(t){return t.shiftKey||t.ctrlKey||t.altKey||Cd.metaKeyPressed(t)},metaKeyPressed:function(t){return be.mac?t.metaKey:t.ctrlKey&&!t.altKey}},Md=Hn,Td=function(t,e){var n,r,i,o,a,l,u,c,d,f,h,p,g,m,y,x="data-mce-selected",b=e.dom,_=Me.each,w=e.getDoc(),S=document,C=Math.abs,M=Math.round,T=e.getBody(),k={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},A=function(t){return t&&("IMG"===t.nodeName||e.dom.is(t,"figure.image"))},I=function(t){return jn(t)||b.hasClass(t,"mce-preview-object")},D=function(t){var n=t.target;!function(t,e){if("longpress"!==t.type&&0!==t.type.indexOf("touch"))return A(t.target)&&!wd(t.clientX,t.clientY,e);var n=t.touches[0];return A(t.target)&&!wd(n.clientX,n.clientY,e)}(t,e.selection.getRng())||t.isDefaultPrevented()||e.selection.select(n)},O=function(t){return b.is(t,"figure.image")?[t.querySelector("img")]:b.hasClass(t,"mce-preview-object")&&v(t.firstElementChild)?[t,t.firstElementChild]:[t]},P=function(t){var n=Jl(e);return!!n&&"false"!==t.getAttribute("data-mce-resize")&&t!==e.getBody()&&(b.hasClass(t,"mce-preview-object")?Pe(De(t.firstElementChild),n):Pe(De(t),n))},E=function(t,n,r){var i;v(r)&&(i=O(t),U(i,function(t){t.style[n]||!e.schema.isValid(t.nodeName.toLowerCase(),n)?b.setStyle(t,n,r):b.setAttrib(t,n,""+r)}))},R=function(t,e,n){E(t,"width",e),E(t,"height",n)},L=function(t){var a,s,v=t.screenX-l,x=t.screenY-u;p=(p=v*o[2]+c)<5?5:p,g=(g=x*o[3]+d)<5?5:g,((A(n)||I(n))&&!1!==e.getParam("resize_img_proportional",!0,"boolean")?!Cd.modifierPressed(t):Cd.modifierPressed(t))&&(C(v)>C(x)?(g=M(p*f),p=M(g/f)):(p=M(g/f),g=M(p*f))),R(r,p,g),a=0<(a=o.startPos.x+v)?a:0,s=0<(s=o.startPos.y+x)?s:0,b.setStyles(i,{left:a,top:s,display:"block"}),i.innerHTML=p+" &times; "+g,o[2]<0&&r.clientWidth<=p&&b.setStyle(r,"left",void 0+(c-p)),o[3]<0&&r.clientHeight<=g&&b.setStyle(r,"top",void 0+(d-g)),(v=T.scrollWidth-m)+(x=T.scrollHeight-y)!=0&&b.setStyles(i,{left:a-v,top:s-x}),h||(e.fire("ObjectResizeStart",{target:n,width:c,height:d,origin:"corner-"+o.name}),h=!0)},N=function(){var t=h;h=!1,t&&(E(n,"width",p),E(n,"height",g)),b.unbind(w,"mousemove",L),b.unbind(w,"mouseup",N),S!==w&&(b.unbind(S,"mousemove",L),b.unbind(S,"mouseup",N)),b.remove(r),b.remove(i),b.remove(a),B(n),t&&(e.fire("ObjectResized",{target:n,width:p,height:g,origin:"corner-"+o.name}),b.setAttrib(n,"style",b.getAttrib(n,"style"))),e.nodeChanged()},B=function(t){H();var s=b.getPos(t,T),h=s.x,v=s.y,C=t.getBoundingClientRect(),M=C.width||C.right-C.left,A=C.height||C.bottom-C.top;n!==t&&(z(),n=t,p=g=0);var D=e.fire("ObjectSelected",{target:t}),E=b.getAttrib(n,x,"1");P(t)&&!D.isDefaultPrevented()?_(k,function(t,e){var s=b.get("mceResizeHandle"+e);s&&b.remove(s),s=b.add(T,"div",{id:"mceResizeHandle"+e,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+e+"-resize; margin:0; padding:0"}),11===be.ie&&(s.contentEditable=!1),b.bind(s,"mousedown",function(s){s.stopImmediatePropagation(),s.preventDefault(),function(s){var p,g=O(n)[0];l=s.screenX,u=s.screenY,f=(d=g.clientHeight)/(c=g.clientWidth),(o=t).name=e,o.startPos={x:M*t[0]+h,y:A*t[1]+v},m=T.scrollWidth,y=T.scrollHeight,a=b.add(T,"div",{class:"mce-resize-backdrop"}),b.setStyles(a,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),r=I(p=n)?b.create("img",{src:be.transparentSrc}):p.cloneNode(!0),b.addClass(r,"mce-clonedresizable"),b.setAttrib(r,"data-mce-bogus","all"),r.contentEditable="false",b.setStyles(r,{left:h,top:v,margin:0}),R(r,M,A),r.removeAttribute(x),T.appendChild(r),b.bind(w,"mousemove",L),b.bind(w,"mouseup",N),S!==w&&(b.bind(S,"mousemove",L),b.bind(S,"mouseup",N)),i=b.add(T,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},c+" &times; "+d)}(s)}),t.elm=s,b.setStyles(s,{left:M*t[0]+h-s.offsetWidth/2,top:A*t[1]+v-s.offsetHeight/2})}):z(),b.getAttrib(n,x)||n.setAttribute(x,E)},z=function(){H(),n&&n.removeAttribute(x),lt(k,function(t,e){var n=b.get("mceResizeHandle"+e);n&&(b.unbind(n),b.remove(n))})},V=function(n){var r,i=function(t,e){if(t)do{if(t===e)return!0}while(t=t.parentNode)};h||e.removed||(_(b.select("img[data-mce-selected],hr[data-mce-selected]"),function(t){t.removeAttribute(x)}),r="mousedown"===n.type?n.target:t.getNode(),i(r=b.$(r).closest("table,img,figure.image,hr,video,span.mce-preview-object")[0],T)&&(W(),i(t.getStart(!0),r)&&i(t.getEnd(!0),r))?B(r):z())},F=function(t){return Md(_d(e.getBody(),t))},H=function(){lt(k,function(t){t.elm&&(b.unbind(t.elm),delete t.elm)})},W=function(){try{e.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(s){}};return e.on("init",function(){var t;W(),(be.browser.isIE()||be.browser.isEdge())&&(e.on("mousedown click",function(t){var n=t.target,r=n.nodeName;h||!/^(TABLE|IMG|HR)$/.test(r)||F(n)||(2!==t.button&&e.selection.select(n,"TABLE"===r),"mousedown"===t.type&&e.nodeChanged())}),b.bind(T,"mscontrolselect",t=function(t){var n=function(t){Vr.setEditorTimeout(e,function(){return e.selection.select(t)})};if(F(t.target)||jn(t.target))return t.preventDefault(),void n(t.target);/^(TABLE|IMG|HR)$/.test(t.target.nodeName)&&(t.preventDefault(),"IMG"===t.target.tagName&&n(t.target))}),e.on("remove",function(){return b.unbind(T,"mscontrolselect",t)}));var r=Vr.throttle(function(t){e.composing||V(t)});e.on("nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged",r),e.on("keyup compositionend",function(t){n&&"TABLE"===n.nodeName&&r(t)}),e.on("hide blur",z),e.on("contextmenu longpress",D,!0)}),e.on("remove",H),{isResizable:P,showResizeRect:B,hideResizeRect:z,updateResizeRect:V,destroy:function(){n=r=a=null}}},kd=function(t){return Fn(t)||Hn(t)},Ad=function(t,e,n){var r,o,a,s,l,u=n;if(u.caretPositionFromPoint)(o=u.caretPositionFromPoint(t,e))&&((r=n.createRange()).setStart(o.offsetNode,o.offset),r.collapse(!0));else if(n.caretRangeFromPoint)r=n.caretRangeFromPoint(t,e);else if(u.body.createTextRange){r=u.body.createTextRange();try{r.moveToPoint(t,e),r.collapse(!0)}catch(i){r=function(t,e,n){var r,i=n.elementFromPoint(t,e),o=n.body.createTextRange();if(i&&"HTML"!==i.tagName||(i=n.body),o.moveToElementText(i),0<(r=(r=Me.toArray(o.getClientRects())).sort(function(t,n){return(t=Math.abs(Math.max(t.top-e,t.bottom-e)))-Math.abs(Math.max(n.top-e,n.bottom-e))})).length){e=(r[0].bottom+r[0].top)/2;try{return o.moveToPoint(t,e),o.collapse(!0),o}catch(s){}}return null}(t,e,n)}return s=n.body,l=(a=r)&&a.parentElement?a.parentElement():null,Hn(function(t,e,n){for(;t&&t!==e;){if(n(t))return t;t=t.parentNode}return null}(l,s,kd))?null:a}return r},Id=function(t,e){return t&&e&&t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset},Dd=function(t,e,n){return null!==function(t,e,n){for(;t&&t!==e;){if(n(t))return t;t=t.parentNode}return null}(t,e,n)},Od=function(t){return t&&"TABLE"===t.nodeName},Pd=function(t,e,n){for(var r=new Wr(e,t.getParent(e.parentNode,t.isBlock)||t.getRoot());e=r[n?"prev":"next"]();)if(zn(e))return!0},Ed=function(t,e,n,r,i){var o,a,s=t.getRoot(),l=t.schema.getNonEmptyElements(),u=t.getParent(i.parentNode,t.isBlock)||s;if(r&&zn(i)&&e&&t.isEmpty(u))return B.some(vl(i.parentNode,t.nodeIndex(i)));for(var c,d,f=new Wr(i,u);a=f[r?"prev":"next"]();){if("false"===t.getContentEditableParent(a)||(d=s,ui(c=a)&&!1===Dd(c,d,hc)))return B.none();if(Rn(a)&&0<a.nodeValue.length)return!1===function(t,e,n){return Dd(t,e,function(t){return"A"===t.nodeName})}(a,s)?B.some(vl(a,r?a.nodeValue.length:0)):B.none();if(t.isBlock(a)||l[a.nodeName.toLowerCase()])return B.none();o=a}return n&&o?B.some(vl(o,0)):B.none()},Rd=function(t,e,n,r){var i,o,a,s=t.getRoot(),l=!1,u=r[(n?"start":"end")+"Container"],c=r[(n?"start":"end")+"Offset"],d=Tn(u)&&c===u.childNodes.length,f=t.schema.getNonEmptyElements(),h=n;if(ui(u))return B.none();if(Tn(u)&&c>u.childNodes.length-1&&(h=!1),Nn(u)&&(u=s,c=0),u===s){if(h&&(i=u.childNodes[0<c?c-1:0])){if(ui(i))return B.none();if(f[i.nodeName]||Od(i))return B.none()}if(u.hasChildNodes()){if(c=Math.min(!h&&0<c?c-1:c,u.childNodes.length-1),c=Rn(u=u.childNodes[c])&&d?u.data.length:0,!e&&u===s.lastChild&&Od(u))return B.none();if(function(t,e){for(;e&&e!==t;){if(Hn(e))return!0;e=e.parentNode}return!1}(s,u)||ui(u))return B.none();if(u.hasChildNodes()&&!1===Od(u)){var p=new Wr(i=u,s);do{if(Hn(i)||ui(i)){l=!1;break}if(Rn(i)&&0<i.nodeValue.length){c=h?0:i.nodeValue.length,u=i,l=!0;break}if(f[i.nodeName.toLowerCase()]&&(!(o=i)||!/^(TD|TH|CAPTION)$/.test(o.nodeName))){c=t.nodeIndex(i),u=i.parentNode,h||c++,l=!0;break}}while(i=h?p.next():p.prev())}}}return e&&(Rn(u)&&0===c&&Ed(t,d,e,!0,u).each(function(t){u=t.container(),c=t.offset(),l=!0}),Tn(u)&&(!(i=(i=u.childNodes[c])||u.childNodes[c-1])||!zn(i)||(a=i).previousSibling&&"A"===a.previousSibling.nodeName||Pd(t,i,!1)||Pd(t,i,!0)||Ed(t,d,e,!0,i).each(function(t){u=t.container(),c=t.offset(),l=!0}))),h&&!e&&Rn(u)&&c===u.nodeValue.length&&Ed(t,d,e,!1,u).each(function(t){u=t.container(),c=t.offset(),l=!0}),l?B.some(vl(u,c)):B.none()},Ld=function(t,e){var n=e.collapsed,r=e.cloneRange(),i=vl.fromRangeStart(e);return Rd(t,n,!0,r).each(function(t){n&&vl.isAbove(i,t)||r.setStart(t.container(),t.offset())}),n||Rd(t,n,!1,r).each(function(t){r.setEnd(t.container(),t.offset())}),n&&r.collapse(!0),Id(e,r)?B.none():B.some(r)},Nd=function(t,e){return t.splitText(e)},Bd=function(t){var e=t.startContainer,n=t.startOffset,r=t.endContainer,i=t.endOffset;return e===r&&Rn(e)?0<n&&n<e.nodeValue.length&&(e=(r=Nd(e,n)).previousSibling,n<i?(e=r=Nd(r,i-=n).previousSibling,i=r.nodeValue.length,n=0):i=0):(Rn(e)&&0<n&&n<e.nodeValue.length&&(e=Nd(e,n),n=0),Rn(r)&&0<i&&i<r.nodeValue.length&&(i=(r=Nd(r,i).previousSibling).nodeValue.length)),{startContainer:e,startOffset:n,endContainer:r,endOffset:i}},zd=function(t){return{walk:function(e,n){return od(t,e,n)},split:Bd,normalize:function(e){return Ld(t,e).fold(P,function(t){return e.setStart(t.startContainer,t.startOffset),e.setEnd(t.endContainer,t.endOffset),!0})}}};zd.compareRanges=Id,zd.getCaretRangeFromPoint=Ad,zd.getSelectedNode=Zs,zd.getNode=Ks;var Vd,Fd,Hd,Wd,jd,Gd=(Vd="height",Fd=function(t){var e=t.dom;return gn(t)?e.getBoundingClientRect().height:e.offsetHeight},{set:function(t,e){if(!x(e)&&!e.match(/^[0-9]+$/))throw new Error(Vd+".set accepts only positive integer values. Value was "+e);var n=t.dom;Gn(n)&&(n.style[Vd]=e+"px")},get:Hd=function(t){var e=Fd(t);if(e<=0||null===e){var n=Kn(t,Vd);return parseFloat(n)||0}return e},getOuter:Hd,aggregate:Wd=function(t,e){return $(e,function(e,n){var r=Kn(t,n),i=void 0===r?0:parseInt(r,10);return isNaN(i)?e:e+i},0)},max:function(t,e,n){var r=Wd(t,n);return r<e?e-r:0}}),Ud=function(t,e){return t.view(e).fold(w([]),function(e){var n=t.owner(e),r=Ud(t,n);return[e].concat(r)})},qd=Object.freeze({__proto__:null,view:function(t){var e;return(t.dom===document?B.none():B.from(null===(e=t.dom.defaultView)||void 0===e?void 0:e.frameElement)).map(De)},owner:Ge}),Xd=function(t){return"textarea"===Ne(t)},Yd=function(t,e){var n=function(t){var e=t.dom.ownerDocument,n=e.body,r=e.defaultView,i=e.documentElement;if(n===t.dom)return vn(n.offsetLeft,n.offsetTop);var o=yn(null==r?void 0:r.pageYOffset,i.scrollTop),a=yn(null==r?void 0:r.pageXOffset,i.scrollLeft),s=yn(i.clientTop,n.clientTop),l=yn(i.clientLeft,n.clientLeft);return xn(t).translate(a-l,o-s)}(t),r=Gd.get(t);return{element:t,bottom:n.top+r,height:r,pos:n,cleanup:e}},$d=function(t,e,n,r){Qd(t,function(i,o){return Kd(t,e,n,r)},n)},Zd=function(t,e,n,r,i){var o={elm:r.element.dom,alignToTop:i};t.fire("ScrollIntoView",o).isDefaultPrevented()||(n(e,bn(e).top,r,i),t.fire("AfterScrollIntoView",o))},Kd=function(t,e,n,r){De(t.getBody());var i=De(t.getDoc()),o=function(t,e){var n=function(t,e){var n=Ze(t);if(0===n.length||Xd(t))return{element:t,offset:e};if(e<n.length&&!Xd(n[e]))return{element:n[e],offset:0};var r=n[n.length-1];return Xd(r)?{element:t,offset:e}:"img"===Ne(r)?{element:r,offset:1}:Fe(r)?{element:r,offset:vd(r).length}:{element:r,offset:Ze(r).length}}(t,e),r=ke('<span data-mce-bogus="all">\ufeff</span>');return sn(n.element,r),Yd(r,function(){return hn(r)})}(De(n.startContainer),n.startOffset);Zd(t,i,e,o,r),o.cleanup()},Jd=function(t,e,n,r){var i=De(t.getDoc());Zd(t,i,n,Yd(De(e),b),r)},Qd=function(t,e,n){var r=n.startContainer,i=n.startOffset,o=n.endContainer,a=n.endOffset;e(De(r),De(o));var s=t.dom.createRng();s.setStart(r,i),s.setEnd(o,a),t.selection.setRng(n)},tf=function(t,e,n,r){var i=t.pos;!function(t,e,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollTo(t,e)}(i.left,n?i.top:i.top-e+t.height,r)},ef=function(t,e,n,r,i){var o=n+e,a=r.pos.top,s=r.bottom,l=n<=s-a;a<e?tf(r,n,!1!==i,t):o<a?tf(r,n,l?!1!==i:!0===i,t):o<s&&!l&&tf(r,n,!0===i,t)},nf=function(t,e,n,r){ef(t,e,t.dom.defaultView.innerHeight,n,r)},rf=function(t,e,n,r){ef(t,e,t.dom.defaultView.innerHeight,n,r);var i=function(t){var e,n,r=De(document),i=bn(r),o=(n=(e=qd).owner(t),Ud(e,n)),a=xn(t),s=Y(o,function(t,e){var n=xn(e);return{left:t.left+n.left,top:t.top+n.top}},{left:0,top:0});return vn(s.left+a.left+i.left,s.top+a.top+i.top)}(n.element),o=Sn(window);i.top<o.y?_n(n.element,!1!==r):i.top>o.bottom&&_n(n.element,!0===r)},of=function(t,e,n){return $d(t,nf,e,n)},af=function(t,e,n){return Jd(t,e,nf,n)},sf=function(t,e,n){return $d(t,rf,e,n)},lf=function(t,e,n){return Jd(t,e,rf,n)},uf=function(t,e,n){(t.inline?of:sf)(t,e,n)},cf=function(t){var e=rn(t).dom;return t.dom===e.activeElement},df=function(t){return void 0===t&&(t=De(document)),B.from(t.dom.activeElement).map(De)},ff=(gr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),gr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),function(t,e,n,r){return{start:t,soffset:e,finish:n,foffset:r}}),hf=de().browser,pf=function(t,e){var n=Fe(e)?vd(e).length:Ze(e).length+1;return n<t?n:t<0?0:t},gf=function(t){return ff(t.start,pf(t.soffset,t.start),t.finish,pf(t.foffset,t.finish))},mf=function(t,e){return!Mn(e.dom)&&(Le(t,e)||Re(t,e))},vf=function(t){return function(e){return mf(t,e.start)&&mf(t,e.finish)}},yf=function(t){return!0===t.inline||hf.isIE()},xf=function(t){return ff(De(t.startContainer),t.startOffset,De(t.endContainer),t.endOffset)},bf=function(t){var e=document.createRange();try{return e.setStart(t.start.dom,t.soffset),e.setEnd(t.finish.dom,t.foffset),B.some(e)}catch(l){return B.none()}},_f=function(t){var e=yf(t)?function(t){var e;return((e=function(t){return De(Ge(t).dom.defaultView)}(t).dom.getSelection())&&0!==e.rangeCount?B.from(e.getRangeAt(0)):B.none()).map(xf).filter(vf(t))}(De(t.getBody())):B.none();t.bookmark=e.isSome()?e:t.bookmark},wf=function(t){return(t.bookmark?t.bookmark:B.none()).bind(function(e){return n=De(t.getBody()),B.from(e).filter(vf(n)).map(gf);var n}).bind(bf)},Sf={isEditorUIElement:function(t){var e=t.className.toString();return-1!==e.indexOf("tox-")||-1!==e.indexOf("mce-")}},Cf=us.DOM,Mf=function(t,e){var n=t.getParam("custom_ui_selector","","string");return null!==Cf.getParent(e,function(e){return Sf.isEditorUIElement(e)||!!n&&t.dom.is(e,n)})},Tf=function(t,e){var n=e.editor;(function(t){var e=_s(function(){_f(t)},0);t.on("init",function(){var n,r,i;t.inline&&(n=t,r=e,i=function(){r.throttle()},us.DOM.bind(document,"mouseup",i),n.on("remove",function(){us.DOM.unbind(document,"mouseup",i)})),function(t,e){var n,r;de().browser.isIE()?(r=t).on("focusout",function(){_f(r)}):(n=e,t.on("mouseup touchend",function(t){n.throttle()})),t.on("keyup NodeChange",function(e){var n;"nodechange"===(n=e).type&&n.selectionChange||_f(t)})}(t,e)}),t.on("remove",function(){e.cancel()})})(n),n.on("focusin",function(){var e=t.focusedEditor;e!==n&&(e&&e.fire("blur",{focusedEditor:n}),t.setActive(n),(t.focusedEditor=n).fire("focus",{blurredEditor:e}),n.focus(!0))}),n.on("focusout",function(){Vr.setEditorTimeout(n,function(){var e=t.focusedEditor;Mf(n,function(e){try{var n=rn(De(e.getElement()));return df(n).fold(function(){return document.body},function(t){return t.dom})}catch(t){return document.body}}(n))||e!==n||(n.fire("blur",{focusedEditor:null}),t.focusedEditor=null)})}),jd||(jd=function(e){var n=t.activeEditor;n&&function(t){if(nn()&&v(t.target)){var e=De(t.target);if(Ve(e)&&function(t){return v(t.dom.shadowRoot)}(e)&&t.composed&&t.composedPath){var n=t.composedPath();if(n)return rt(n)}}return B.from(t.target)}(e).each(function(e){e.ownerDocument===document&&(e===document.body||Mf(n,e)||t.focusedEditor!==n||(n.fire("blur",{focusedEditor:null}),t.focusedEditor=null))})},Cf.bind(document,"focusin",jd))},kf=function(t,e){t.focusedEditor===e.editor&&(t.focusedEditor=null),t.activeEditor||(Cf.unbind(document,"focusin",jd),jd=null)},Af=function(t,e){(function(t,e){return((n=e).collapsed?B.from(Ks(n.startContainer,n.startOffset)).map(De):B.none()).bind(function(e){return Jr(e)?B.some(e):!1===Le(t,e)?B.some(t):B.none()});var n})(De(t.getBody()),e).bind(function(t){return cc(t.dom)}).fold(function(){t.selection.normalize()},function(e){return t.selection.setRng(e.toRange())})},If=function(t){if(t.setActive)try{t.setActive()}catch(e){t.focus()}else t.focus()},Df=function(t){return t.inline?(n=t.getBody())&&function(t){return cf(t)||df(rn(e=t)).filter(function(t){return e.dom.contains(t.dom)}).isSome();var e}(De(n)):(e=t).iframeElement&&cf(De(e.iframeElement));var e,n},Of=function(t){var e=t.selection,n=t.getBody(),r=e.getRng();t.quirks.refreshContentEditable(),void 0!==t.bookmark&&!1===Df(t)&&wf(t).each(function(e){t.selection.setRng(e),r=e});var i,o,a=(i=t,o=e.getNode(),i.dom.getParent(o,function(t){return"true"===i.dom.getContentEditable(t)}));if(t.$.contains(n,a))return If(a),Af(t,r),void Pf(t);t.inline||(be.opera||If(n),t.getWin().focus()),(be.gecko||t.inline)&&(If(n),Af(t,r)),Pf(t)},Pf=function(t){return t.editorManager.setActive(t)},Ef=function(t,e,n,r,i){var o=n?e.startOffset:e.endOffset;return B.from(n?e.startContainer:e.endContainer).map(De).map(function(t){return r&&e.collapsed?t:Ke(t,i(t,o)).getOr(t)}).bind(function(t){return Ve(t)?B.some(t):Ue(t).filter(Ve)}).map(function(t){return t.dom}).getOr(t)},Rf=function(t,e,n){return Ef(t,e,!0,n,function(t,e){return Math.min(t.dom.childNodes.length,e)})},Lf=function(t,e,n){return Ef(t,e,!1,n,function(t,e){return 0<e?e-1:e})},Nf=function(t,e){for(var n=t;t&&Rn(t)&&0===t.length;)t=e?t.nextSibling:t.previousSibling;return t||n},Bf=function(t,e){return G(e,function(e){var n=t.fire("GetSelectionRange",{range:e});return n.range!==e?n.range:e})},zf={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},Vf=function(t,e,n){var r=n?"lastChild":"firstChild",i=n?"prev":"next";if(t[r])return t[r];if(t!==e){var o=t[i];if(o)return o;for(var a=t.parent;a&&a!==e;a=a.parent)if(o=a[i])return o}},Ff=function(t){var e="a"===t.name&&!t.attr("href")&&t.attr("id");return t.attr("name")||t.attr("id")&&!t.firstChild||t.attr("data-mce-bookmark")||e},Hf=(Wf.create=function(t,e){var n=new Wf(t,zf[t]||1);return e&&lt(e,function(t,e){n.attr(e,t)}),n},Wf.prototype.replace=function(t){return t.parent&&t.remove(),this.insert(t,this),this.remove(),this},Wf.prototype.attr=function(t,e){var n,r=this;if("string"!=typeof t)return null!=t&&lt(t,function(t,e){r.attr(e,t)}),r;if(n=r.attributes){if(void 0===e)return n.map[t];if(null===e){if(t in n.map){delete n.map[t];for(var i=n.length;i--;)if(n[i].name===t)return n.splice(i,1),r}return r}if(t in n.map){for(i=n.length;i--;)if(n[i].name===t){n[i].value=e;break}}else n.push({name:t,value:e});return n.map[t]=e,r}},Wf.prototype.clone=function(){var t,e=new Wf(this.name,this.type);if(t=this.attributes){var n=[];n.map={};for(var r=0,i=t.length;r<i;r++){var o=t[r];"id"!==o.name&&(n[n.length]={name:o.name,value:o.value},n.map[o.name]=o.value)}e.attributes=n}return e.value=this.value,e.shortEnded=this.shortEnded,e},Wf.prototype.wrap=function(t){return this.parent.insert(t,this),t.append(this),this},Wf.prototype.unwrap=function(){for(var t=this.firstChild;t;){var e=t.next;this.insert(t,this,!0),t=e}this.remove()},Wf.prototype.remove=function(){var t=this.parent,e=this.next,n=this.prev;return t&&(t.firstChild===this?(t.firstChild=e)&&(e.prev=null):n.next=e,t.lastChild===this?(t.lastChild=n)&&(n.next=null):e.prev=n,this.parent=this.next=this.prev=null),this},Wf.prototype.append=function(t){t.parent&&t.remove();var e=this.lastChild;return e?((e.next=t).prev=e,this.lastChild=t):this.lastChild=this.firstChild=t,t.parent=this,t},Wf.prototype.insert=function(t,e,n){t.parent&&t.remove();var r=e.parent||this;return n?(e===r.firstChild?r.firstChild=t:e.prev.next=t,t.prev=e.prev,(t.next=e).prev=t):(e===r.lastChild?r.lastChild=t:e.next.prev=t,t.next=e.next,(t.prev=e).next=t),t.parent=r,t},Wf.prototype.getAll=function(t){for(var e=[],n=this.firstChild;n;n=Vf(n,this))n.name===t&&e.push(n);return e},Wf.prototype.empty=function(){if(this.firstChild){for(var t=[],e=this.firstChild;e;e=Vf(e,this))t.push(e);for(var n=t.length;n--;)(e=t[n]).parent=e.firstChild=e.lastChild=e.next=e.prev=null}return this.firstChild=this.lastChild=null,this},Wf.prototype.isEmpty=function(t,e,n){void 0===e&&(e={});var r=this.firstChild;if(Ff(this))return!1;if(r)do{if(1===r.type){if(r.attr("data-mce-bogus"))continue;if(t[r.name])return!1;if(Ff(r))return!1}if(8===r.type)return!1;if(3===r.type&&!function(t){if(Ai(t.value)){var e=t.parent;return!e||"span"===e.name&&!e.attr("style")||!/^[ ]+$/.test(t.value)}}(r))return!1;if(3===r.type&&r.parent&&e[r.parent.name]&&Ai(r.value))return!1;if(n&&n(r))return!1}while(r=Vf(r,this));return!0},Wf.prototype.walk=function(t){return Vf(this,null,t)},Wf);function Wf(t,e){this.name=t,1===(this.type=e)&&(this.attributes=[],this.attributes.map={})}var jf=function(t,e){return t.replace(e.re,function(t){return gt(e.uris,t).getOr(t)})},Gf=["img","video"],Uf=function(t,e,n){return!t.allow_html_data_urls&&(/^data:image\//i.test(e)?(i=n,!(m(r=t.allow_svg_data_urls)?W(Gf,i):r)&&/^data:image\/svg\+xml/i.test(e)):/^data:/i.test(e));var r,i},qf=function(t,e,n){var r,i,o=1,a=t.getShortEndedElements(),s=/<([!?\/])?([A-Za-z0-9\-_:.]+)(\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g;for(s.lastIndex=r=n;i=s.exec(e);){if(r=s.lastIndex,"/"===i[1])o--;else if(!i[1]){if(i[2]in a)continue;o++}if(0===o)break}return r},Xf=function(t,e){void 0===e&&(e=ao()),!1!==(t=t||{}).fix_self_closing&&(t.fix_self_closing=!0);var n=t.comment?t.comment:b,r=t.cdata?t.cdata:b,i=t.text?t.text:b,o=t.start?t.start:b,a=t.end?t.end:b,s=t.pi?t.pi:b,l=t.doctype?t.doctype:b;return{parse:function(u,c){void 0===c&&(c="html"),function(u,c){void 0===c&&(c="html");for(var d,f,h,p,g,m,v,y,x,b,_,w,S,C,M,T,k,A,I,D=u.html,O=0,P=[],E=0,R=Zi.decode,L=Me.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),N=/((java|vb)script|mhtml):/i,B="html"===c?0:1,z=function(t){for(var e,n=P.length;n--&&P[n].name!==t;);if(0<=n){for(e=P.length-1;n<=e;e--)(t=P[e]).valid&&a(t.name);P.length=n}},V=function(t,e){return i(jf(t,u),e)},F=function(e){""!==e&&(">"===e.charAt(0)&&(e=" "+e),t.allow_conditional_comments||"[if"!==e.substr(0,3).toLowerCase()||(e=" "+e),n(jf(e,u)))},H=function(t,e){var n=t||"",r=!Vt(n,"--"),i=function(t,e,n){void 0===n&&(n=0);var r=t.toLowerCase();if(-1!==r.indexOf("[if ",n)&&/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(r.substr(n))){var i=r.indexOf("[endif]",n);return r.indexOf(">",i)}if(e){var o=r.indexOf(">",n);return-1!==o?o:r.length}var a=/--!?>/g;a.lastIndex=n;var s=a.exec(t);return s?s.index+s[0].length:r.length}(D,r,e);return t=D.substr(e,i-e),F(r?n+t:t),i+1},W=function(e,n,r,i,o){var a,s,l,c;if(l=(n=n.toLowerCase())in X?n:R(r||i||o||""),r=jf(l,u),Y&&!y&&0==(0===(c=n).indexOf("data-")||0===c.indexOf("aria-"))){if(!(a=C[n])&&M){for(s=M.length;s--&&!(a=M[s]).pattern.test(n););-1===s&&(a=null)}if(!a)return;if(a.validValues&&!(r in a.validValues))return}if(L[n]&&!t.allow_script_urls){var d=r.replace(/[\s\u0000-\u001F]+/g,"");try{d=decodeURIComponent(d)}catch(w){d=unescape(d)}if(N.test(d))return;if(Uf(t,d,e))return}y&&(n in L||0===n.indexOf("on"))||(p.map[n]=r,p.push({name:n,value:r}))},j=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_:.]*)(\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>))","g"),G=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,U=e.getShortEndedElements(),q=t.self_closing_elements||e.getSelfClosingElements(),X=e.getBoolAttrs(),Y=t.validate,$=t.remove_internals,Z=t.fix_self_closing,K=e.getSpecialElements(),J=D+">";d=j.exec(J);){var Q=d[0];if(O<d.index&&V(R(D.substr(O,d.index-O))),f=d[7])":"===(f=f.toLowerCase()).charAt(0)&&(f=f.substr(1)),z(f);else if(f=d[8]){if(d.index+Q.length>D.length){V(R(D.substr(d.index))),O=d.index+Q.length;continue}":"===(f=f.toLowerCase()).charAt(0)&&(f=f.substr(1)),x=f in U,Z&&q[f]&&0<P.length&&P[P.length-1].name===f&&z(f);var tt=function(t,e){var n=t.exec(e);if(n){var r=n[1],i=n[2];return"string"==typeof r&&"data-mce-bogus"===r.toLowerCase()?i:null}return null}(G,d[9]);if(null!==tt){if("all"===tt){O=qf(e,D,j.lastIndex),j.lastIndex=O;continue}_=!1}if(!Y||(b=e.getElementRule(f))){if(_=!0,Y&&(C=b.attributes,M=b.attributePatterns),(S=d[9])?((y=-1!==S.indexOf("data-mce-type"))&&$&&(_=!1),(p=[]).map={},S.replace(G,function(t,e,n,r,i){return W(f,e,n,r,i),""})):(p=[]).map={},Y&&!y){if(T=b.attributesRequired,k=b.attributesDefault,b.removeEmptyAttrs&&!p.length&&(_=!1),A=b.attributesForced)for(g=A.length;g--;)v=(w=A[g]).name,"{$uid}"===(I=w.value)&&(I="mce_"+E++),p.map[v]=I,p.push({name:v,value:I});if(k)for(g=k.length;g--;)(v=(w=k[g]).name)in p.map||("{$uid}"===(I=w.value)&&(I="mce_"+E++),p.map[v]=I,p.push({name:v,value:I}));if(T){for(g=T.length;g--&&!(T[g]in p.map););-1===g&&(_=!1)}if(w=p.map["data-mce-bogus"]){if("all"===w){O=qf(e,D,j.lastIndex),j.lastIndex=O;continue}_=!1}}_&&o(f,p,x)}else _=!1;if(h=K[f]){h.lastIndex=O=d.index+Q.length,O=(d=h.exec(D))?(_&&(m=D.substr(O,d.index-O)),d.index+d[0].length):(m=D.substr(O),D.length),_&&(0<m.length&&V(m,!0),a(f)),j.lastIndex=O;continue}x||(S&&S.indexOf("/")===S.length-1?_&&a(f):P.push({name:f,valid:_}))}else if(f=d[1])F(f);else if(f=d[2]){if(!(1==B||t.preserve_cdata||0<P.length&&e.isValidChild(P[P.length-1].name,"#cdata"))){O=H("",d.index+2),j.lastIndex=O;continue}r(f)}else if(f=d[3])l(f);else{if((f=d[4])||"<!"===Q){O=H(f,d.index+Q.length),j.lastIndex=O;continue}if(f=d[5]){if(1!=B){O=H("?",d.index+2),j.lastIndex=O;continue}s(f,d[6])}}O=d.index+Q.length}for(O<D.length&&V(R(D.substr(O))),g=P.length-1;0<=g;g--)(f=P[g]).valid&&a(f.name)}(function(t){for(var e,n=/data:[^;]+;base64,([a-z0-9\+\/=]+)/gi,r=[],i={},o=Ls("img"),a=0,s=0;e=n.exec(t);){var l=e[0],u=o+"_"+s++;i[u]=l,a<e.index&&r.push(t.substr(a,e.index-a)),r.push(u),a=e.index+l.length}var c=new RegExp(o+"_[0-9]+","g");return 0===a?{prefix:o,uris:i,html:t,re:c}:(a<t.length&&r.push(t.substr(a)),{prefix:o,uris:i,html:r.join(""),re:c})}(u),c)}}};Xf.findEndTag=qf;var Yf=function(t,e){var n,r,i,o,a,s,l,u=e,c=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,d=t.schema;a=t.getTempAttrs(),s=u,l=new RegExp(["\\s?("+a.join("|")+')="[^"]+"'].join("|"),"gi"),u=s.replace(l,"");for(var f=d.getShortEndedElements();o=c.exec(u);)r=c.lastIndex,i=o[0].length,n=f[o[1]]?r:Xf.findEndTag(d,u,r),u=u.substring(0,r-i)+u.substring(n),c.lastIndex=r-i;return ii(u)},$f=Yf,Zf=Me.each,Kf=function(t){return{compare:function(e,n){if(e.nodeName!==n.nodeName)return!1;var r=function(e){var n={};return Zf(t.getAttribs(e),function(r){var i=r.nodeName.toLowerCase();0!==i.indexOf("_")&&"style"!==i&&0!==i.indexOf("data-")&&(n[i]=t.getAttrib(e,i))}),n},i=function(t,e){var n,r;for(r in t)if(t.hasOwnProperty(r)){if(void 0===(n=e[r]))return!1;if(t[r]!==n)return!1;delete e[r]}for(r in e)if(e.hasOwnProperty(r))return!1;return!0};return!(!i(r(e),r(n))||!i(t.parseStyle(t.getAttrib(e,"style")),t.parseStyle(t.getAttrib(n,"style")))||wc(e)||wc(n))}}},Jf=Me.makeMap,Qf=function(t){var e=[],n=(t=t||{}).indent,r=Jf(t.indent_before||""),i=Jf(t.indent_after||""),o=Zi.getEncodeFunc(t.entity_encoding||"raw",t.entities),a="html"===t.element_format;return{start:function(t,s,l){var u,c,d,f;if(n&&r[t]&&0<e.length&&0<(f=e[e.length-1]).length&&"\n"!==f&&e.push("\n"),e.push("<",t),s)for(u=0,c=s.length;u<c;u++)e.push(" ",(d=s[u]).name,'="',o(d.value,!0),'"');e[e.length]=!l||a?">":" />",l&&n&&i[t]&&0<e.length&&0<(f=e[e.length-1]).length&&"\n"!==f&&e.push("\n")},end:function(t){var r;e.push("</",t,">"),n&&i[t]&&0<e.length&&0<(r=e[e.length-1]).length&&"\n"!==r&&e.push("\n")},text:function(t,n){0<t.length&&(e[e.length]=n?t:o(t))},cdata:function(t){e.push("<![CDATA[",t,"]]>")},comment:function(t){e.push("\x3c!--",t,"--\x3e")},pi:function(t,r){r?e.push("<?",t," ",o(r),"?>"):e.push("<?",t,"?>"),n&&e.push("\n")},doctype:function(t){e.push("<!DOCTYPE",t,">",n?"\n":"")},reset:function(){e.length=0},getContent:function(){return e.join("").replace(/\n$/,"")}}},th=function(t,e){void 0===e&&(e=ao());var n=Qf(t);return(t=t||{}).validate=!("validate"in t)||t.validate,{serialize:function(r){var i=t.validate,o={3:function(t){n.text(t.value,t.raw)},8:function(t){n.comment(t.value)},7:function(t){n.pi(t.name,t.value)},10:function(t){n.doctype(t.value)},4:function(t){n.cdata(t.value)},11:function(t){if(t=t.firstChild)for(;a(t),t=t.next;);}};n.reset();var a=function(t){var r,s,l,u,c,d,f,h,p,g=o[t.type];if(g)g(t);else{if(r=t.name,s=t.shortEnded,l=t.attributes,i&&l&&1<l.length&&((d=[]).map={},p=e.getElementRule(t.name))){for(f=0,h=p.attributesOrder.length;f<h;f++)(u=p.attributesOrder[f])in l.map&&(d.map[u]=c=l.map[u],d.push({name:u,value:c}));for(f=0,h=l.length;f<h;f++)(u=l[f].name)in d.map||(d.map[u]=c=l.map[u],d.push({name:u,value:c}));l=d}if(n.start(t.name,l,s),!s){if(t=t.firstChild)for(;a(t),t=t.next;);n.end(r)}}};return 1!==r.type||t.inner?o[11](r):a(r),n.getContent()}}},eh=new Set;U(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],function(t){eh.add(t)});var nh,rh=["font","text-decoration","text-emphasis"],ih=function(t,e){return at(t.parseStyle(t.getAttrib(e,"style")))},oh=function(t,e,n){var r=ih(t,e),i=ih(t,n),o=function(r){var i=t.getStyle(e,r),o=t.getStyle(n,r);return Gt(i)&&Gt(o)&&i!==o};return j(r,function(t){var e=function(e){return j(e,function(e){return e===t})};if(e(i)||!e(rh))return o(t);var n=X(i,function(t){return j(rh,function(e){return Vt(t,e)})});return j(n,o)})},ah=function(t,e,n){return B.from(n.container()).filter(Rn).exists(function(r){var i=t?0:-1;return e(r.data.charAt(n.offset()+i))})},sh=C(ah,!0,Cc),lh=C(ah,!1,Cc),uh=function(t){var e=t.container();return Rn(e)&&(0===e.data.length||ri(e.data)&&bd.isBookmarkNode(e.parentNode))},ch=function(t,e){return function(n){return B.from(Ou(t?0:-1,n)).filter(e).isSome()}},dh=function(t){return Vn(t)&&"block"===Kn(De(t),"display")},fh=function(t){return Hn(t)&&!(Tn(e=t)&&"all"===e.getAttribute("data-mce-bogus"));var e},hh=ch(!0,dh),ph=ch(!1,dh),gh=ch(!0,jn),mh=ch(!1,jn),vh=ch(!0,On),yh=ch(!1,On),xh=ch(!0,fh),bh=ch(!1,fh),_h=function(t){fn(t),cn(t,ke('<br data-mce-bogus="1">'))},wh=function(t){Qe(t).each(function(e){qe(e).each(function(n){qr(t)&&Yr(e)&&qr(n)&&hn(e)})})},Sh=function(t,e){return function(t,e,n){return Le(e,t)?function(t,e){for(var n=y(e)?e:P,r=t.dom,i=[];null!=r.parentNode;){var o=r.parentNode,a=De(o);if(i.push(a),!0===n(a))break;r=o}return i}(t,function(t){return n(t)||Re(t,e)}).slice(0,-1):[]}(t,e,P)},Ch=function(t,e){return[t].concat(Sh(t,e))},Mh=function(t,e,n){return ac(t,e,n,uh)},Th=function(t,e){return Z(Ch(De(e.container()),t),qr)},kh=function(t,e,n){return Mh(t,e.dom,n).forall(function(t){return Th(e,n).fold(function(){return!1===Du(t,n,e.dom)},function(r){return!1===Du(t,n,e.dom)&&Le(r,De(t.container()))})})},Ah=function(t,e,n){return Th(e,n).fold(function(){return Mh(t,e.dom,n).forall(function(t){return!1===Du(t,n,e.dom)})},function(e){return Mh(t,e.dom,n).isNone()})},Ih=C(Ah,!1),Dh=C(Ah,!0),Oh=C(kh,!1),Ph=C(kh,!0),Eh=function(t){return Vu(t).exists(Yr)},Rh=function(t,e,n){var r=X(Ch(De(n.container()),e),qr),i=rt(r).getOr(e);return ic(t,i.dom,n).filter(Eh)},Lh=function(t,e){return Vu(e).exists(Yr)||Rh(!0,t,e).isSome()},Nh=function(t,e){return B.from(e.getNode(!0)).map(De).exists(Yr)||Rh(!1,t,e).isSome()},Bh=C(Rh,!1),zh=C(Rh,!0),Vh=function(t){return vl.isTextPosition(t)&&!t.isAtStart()&&!t.isAtEnd()},Fh=function(t,e){var n=X(Ch(De(e.container()),t),qr);return rt(n).getOr(t)},Hh=function(t,e){return Vh(e)?lh(e):lh(e)||uc(Fh(t,e).dom,e).exists(lh)},Wh=function(t,e){return Vh(e)?sh(e):sh(e)||lc(Fh(t,e).dom,e).exists(sh)},jh=function(t){return Vu(t).bind(function(t){return Mr(t,Ve)}).exists(function(t){return e=Kn(t,"white-space"),W(["pre","pre-wrap"],e);var e})},Gh=function(t,e){return!jh(e)&&(Ih(t,e)||Oh(t,e)||Nh(t,e)||Hh(t,e))},Uh=function(t,e){return!jh(e)&&(Dh(t,e)||Ph(t,e)||Lh(t,e)||Wh(t,e))},qh=function(t,e){return Gh(t,e)||Uh(t,(r=(n=e).container(),i=n.offset(),Rn(r)&&i<r.data.length?vl(r,i+1):n));var n,r,i},Xh=function(t,e){return Sc(t.charAt(e))},Yh=function(t){var e=t.container();return Rn(e)&&zt(e.data,ei)},$h=function(t){var e=De(t.getBody());t.selection.isCollapsed()&&function(t,e){return B.some(e).filter(Yh).bind(function(e){var n,r,i,o,a,s,l,u,c=e.container();return a=t,l=(s=c).data,u=vl(s,0),Xh(l,0)&&!qh(a,u)&&(s.data=" "+l.slice(1),1)||function(t){var e,n=t.data,r=(e=n.split(""),G(e,function(t,n){return Sc(t)&&0<n&&n<e.length-1&&Mc(e[n-1])&&Mc(e[n+1])?" ":t}).join(""));return r!==n&&(t.data=r,!0)}(c)||(n=t,i=(r=c).data,o=vl(r,i.length-1),Xh(i,i.length-1)&&!qh(n,o)&&(r.data=i.slice(0,-1)+" ",1))?B.some(e):B.none()})}(e,vl.fromRangeStart(t.selection.getRng())).each(function(e){t.selection.setRng(e.toRange())})},Zh=function(t,e,n){var r,i,o,a,s,l,u,c;0!==n&&(r=De(t),i=Cr(r,qr).getOr(r),o=t.data.slice(e,e+n),a=e+n>=t.data.length&&Uh(i,vl(t,t.data.length)),s=0===e&&Gh(i,vl(t,0)),t.replaceData(e,n,(u=s,c=a,$(l=o,function(t,e){return Cc(e)||Sc(e)?t.previousCharIsSpace||""===t.str&&u||t.str.length===l.length-1&&c?{previousCharIsSpace:!1,str:t.str+ei}:{previousCharIsSpace:!0,str:t.str+" "}:{previousCharIsSpace:!1,str:t.str+e}},{previousCharIsSpace:!1,str:""}).str)))},Kh=function(t,e){var n=t.data.slice(e),r=n.length-Wt(n).length;return Zh(t,e,r)},Jh=function(t,e){var n=t.data.slice(0,e),r=n.length-jt(n).length;return Zh(t,e-r,r)},Qh=function(t,e,n,r){void 0===r&&(r=!0);var i=jt(t.data).length,o=r?t:e,a=r?e:t;return r?o.appendData(a.data):o.insertData(0,a.data),hn(De(a)),n&&Kh(o,i),o},tp=function(t,e){return r=t,i=(n=e).container(),o=n.offset(),!1===vl.isTextPosition(n)&&i===r.parentNode&&o>vl.before(r).offset()?vl(e.container(),e.offset()-1):e;var n,r,i,o},ep=function(t){return Ci(t.previousSibling)?B.some(Rn(e=t.previousSibling)?vl(e,e.data.length):vl.after(e)):t.previousSibling?dc(t.previousSibling):B.none();var e},np=function(t){return Ci(t.nextSibling)?B.some(Rn(e=t.nextSibling)?vl(e,0):vl.before(e)):t.nextSibling?cc(t.nextSibling):B.none();var e},rp=function(t,e){return ep(e).orThunk(function(){return np(e)}).orThunk(function(){return n=t,i=vl.before((r=e).previousSibling?r.previousSibling:r.parentNode),uc(n,i).fold(function(){return lc(n,vl.after(r))},B.some);var n,r,i})},ip=function(t,e){return np(e).orThunk(function(){return ep(e)}).orThunk(function(){return lc(n=t,vl.after(r=e)).fold(function(){return uc(n,vl.before(r))},B.some);var n,r})},op=function(t,e,n){return(t?ip:rp)(e,n).map(C(tp,n))},ap=function(t,e,n){n.fold(function(){t.focus()},function(n){t.selection.setRng(n.toRange(),e)})},sp=function(t,e){return e&&mt(t.schema.getBlockElements(),Ne(e))},lp=function(t){if(Ei(t)){var e=ke('<br data-mce-bogus="1">');return fn(t),cn(t,e),B.some(vl.before(e.dom))}return B.none()},up=function(t,e,n,r){void 0===r&&(r=!0);var i,o,a=op(e,t.getBody(),n.dom),s=Cr(n,C(sp,t),(i=t.getBody(),function(t){return t.dom===i})),l=function(t,e,n){var r,i,o,a,s=qe(t).filter(Fe),l=Xe(t).filter(Fe);return hn(t),i=l,o=e,a=function(t,e,r){var i=t.dom,o=e.dom,a=i.data.length;return Qh(i,o,n),r.container()===o?vl(i,a):r},((r=s).isSome()&&i.isSome()&&o.isSome()?B.some(a(r.getOrDie(),i.getOrDie(),o.getOrDie())):B.none()).orThunk(function(){return n&&(s.each(function(t){return Jh(t.dom,t.dom.length)}),l.each(function(t){return Kh(t.dom,0)})),e})}(n,a,(o=n,mt(t.schema.getTextInlineElements(),Ne(o))));t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):s.bind(lp).fold(function(){r&&ap(t,e,l)},function(n){r&&ap(t,e,B.some(n))})},cp=function(t,e){return{start:t,end:e}},dp=gr([{removeTable:["element"]},{emptyCells:["cells"]},{deleteCellSelection:["rng","cell"]}]),fp=function(t,e){return Ar(De(t),"td,th",e)},hp=function(t,e){return Tr(t,"table",e)},pp=function(t){return!Re(t.start,t.end)},gp=function(t,e){return hp(t.start,e).bind(function(n){return hp(t.end,e).bind(function(t){return Re(n,t)?B.some(n):B.none()})})},mp=function(t){return As(t,"td,th")},vp=function(t,e){return gp(e,t).isSome()},yp=function(t,e){return K(t,function(t){return Re(t,e)})},xp=function(t){return Ws(yp((e=t).cells,e.rng.start),yp(e.cells,e.rng.end),function(t,n){return e.cells.slice(t,n+1)}).map(function(e){return e.length===t.cells.length?dp.removeTable(t.table):dp.emptyCells(e)});var e},bp=function(t){var e;return(8===Be(e=t)||"#comment"===Ne(e)?qe:Qe)(t).bind(bp).orThunk(function(){return B.some(t)})},_p=function(t,e){return U(e,_h),t.selection.setCursorLocation(e[0].dom,0),!0},wp=function(t,e,n){e.deleteContents();var r,i,o=bp(n).getOr(n),a=De(t.dom.getParent(o.dom,t.dom.isBlock));return Ei(a)&&(_h(a),t.selection.setCursorLocation(a.dom,0)),Re(n,a)||(r=Ue(a).is(n)?[]:Ue(i=a).map(Ze).map(function(t){return X(t,function(t){return!Re(i,t)})}).getOr([]),U(r.concat(Ze(n)),function(t){Re(t,a)||Le(t,a)||hn(t)})),!0},Sp=function(t,e){return up(t,!1,e),!0},Cp=function(t,e){return Z(Ch(e,t),Qr)},Mp=function(t,e){return Z(Ch(e,t),function(t){return"caption"===Ne(t)})},Tp=function(t,e){return _h(e),t.selection.setCursorLocation(e.dom,0),B.some(!0)},kp=function(t,e){return(t?vh:yh)(e)},Ap=function(t,e){var n,r,i,o,a,s=De(t.selection.getStart(!0)),l=ld(t);return t.selection.isCollapsed()&&0===l.length?function(t,e,n){var r=De(t.getBody());return Mp(r,n).fold(function(){return function(t,e,n,r){var i=vl.fromRangeStart(t.selection.getRng());return Cp(n,r).bind(function(r){return Ei(r)?Tp(t,r):(o=n,a=r,s=i,oc(e,t.getBody(),s).bind(function(t){return Cp(o,De(t.getNode())).map(function(t){return!1===Re(t,a)})}));var o,a,s}).getOr(!1)}(t,e,r,n)||(o=e,a=vl.fromRangeStart((i=t).selection.getRng()),kp(o,a)||ic(o,i.getBody(),a).exists(function(t){return kp(o,t)}));var i,o,a},function(n){return o=e,a=r,s=n,l=vl.fromRangeStart((i=t).selection.getRng()),(Ei(s)?Tp(i,s):function(t,e,n,r,i){return oc(n,t.getBody(),i).bind(function(o){return l=n,u=i,c=o,cc((s=r).dom).bind(function(t){return dc(s.dom).map(function(e){return l?u.isEqual(t)&&c.isEqual(e):u.isEqual(e)&&c.isEqual(t)})}).getOr(!0)?Tp(t,r):(a=r,Mp(e,De(o.getNode())).map(function(t){return!1===Re(t,a)}));var a,s,l,u,c}).or(B.some(!0))}(i,a,o,s,l)).getOr(!1);var i,o,a,s,l})}(t,e,s):(r=s,i=De((n=t).getBody()),o=n.selection.getRng(),0!==(a=ld(n)).length?_p(n,a):function(t,e,n,r){return Mp(e,r).fold(function(){return r=t,function(t,e){var n,r,i,o,a,s=(n=t,function(t){return Re(n,t)}),l=(o=fp((r=e).startContainer,i=s),a=fp(r.endContainer,i),Ws(o,a,cp));return function(t,e,n){return t.filter(function(t){return i=n,!pp(r=t)&&gp(r,i).exists(function(t){var e=t.dom.rows;return 1===e.length&&1===e[0].cells.length})&&dd(t.start,e);var r,i}).map(function(t){return t.start})}(l,e,s).map(function(t){return dp.deleteCellSelection(e,t)}).orThunk(function(){return function(t,e,n){return t.filter(function(t){return pp(t)&&vp(n,t)}).orThunk(function(){return function(t,e){var n=fp(e.startContainer,t),r=fp(e.endContainer,t);return e.collapsed?B.none():Ws(n,r,cp).fold(function(){return n.fold(function(){return r.bind(function(e){return hp(e,t).bind(function(t){return rt(mp(t)).map(function(t){return cp(t,e)})})})},function(e){return hp(e,t).bind(function(t){return it(mp(t)).map(function(t){return cp(e,t)})})})},function(e){return vp(t,e)?B.none():hp((n=e).start,t).bind(function(t){return it(mp(t)).map(function(t){return cp(n.start,t)})});var n})}(n,e)}).bind(function(t){return gp(e=t,n).map(function(t){return{rng:e,table:t,cells:mp(t)}});var e})}(l,e,s).bind(xp)})}(e,n).map(function(t){return t.fold(C(Sp,r),C(_p,r),C(wp,r))});var r},function(e){return Tp(t,e)}).getOr(!1)}(n,i,o,r))},Ip=function(t){return t.collapsed?t:function(t){var e=vl.fromRangeStart(t),n=vl.fromRangeEnd(t),r=t.commonAncestorContainer;return ic(!1,r,n).map(function(i){return!Du(e,n,r)&&Du(e,i,r)?(o=e.container(),a=e.offset(),s=i.container(),l=i.offset(),(u=document.createRange()).setStart(o,a),u.setEnd(s,l),u):t;var o,a,s,l,u}).getOr(t)}(t)},Dp=function(t,e){var n=t.getParent(e,t.isBlock);return n&&"LI"===n.nodeName?n:null},Op=function(t,e){var n=vl.after(t),r=tc(e).prev(n);return r?r.toRange():null},Pp=Wn,Ep=function(t,e,n){var r,i,o,a,s,l,u,c,d,f=t.selection,h=t.dom;/^ | $/.test(e)&&(l=h,u=f.getRng(),c=e,d=De(l.getRoot()),c=Gh(d,vl.fromRangeStart(u))?c.replace(/^ /,"&nbsp;"):c.replace(/^&nbsp;/," "),e=c=Uh(d,vl.fromRangeEnd(u))?c.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):c.replace(/&nbsp;(<br( \/)?>)?$/," "));var p=t.parser,g=n.merge,m=th({validate:t.getParam("validate")},t.schema),y='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>',x={content:e,format:"html",selection:!0,paste:n.paste};if((x=t.fire("BeforeSetContent",x)).isDefaultPrevented())t.fire("SetContent",{content:x.content,format:"html",selection:!0,paste:n.paste});else{-1===(e=x.content).indexOf("{$caret}")&&(e+="{$caret}"),e=e.replace(/\{\$caret\}/,y);var b,_=(a=f.getRng()).startContainer||(a.parentElement?a.parentElement():null),w=t.getBody();_===w&&f.isCollapsed()&&h.isBlock(w.firstChild)&&(b=w.firstChild)&&!t.schema.getShortEndedElements()[b.nodeName]&&h.isEmpty(w.firstChild)&&((a=h.createRng()).setStart(w.firstChild,0),a.setEnd(w.firstChild,0),f.setRng(a)),f.isCollapsed()||function(t){var e=t.dom,n=Ip(t.selection.getRng());t.selection.setRng(n);var r,i,o=e.getParent(n.startContainer,Pp);r=n,null!==(i=o)&&i===e.getParent(r.endContainer,Pp)&&dd(De(i),r)?wp(t,n,De(o)):t.getDoc().execCommand("Delete",!1,null)}(t);var S,C,M,T,k,A,I,D,O,P,E,R,L,N={context:(r=f.getNode()).nodeName.toLowerCase(),data:n.data,insert:!0},z=p.parse(e,N);if(!0===n.paste&&function(t,e){var n,r,i,o=e.firstChild,a=e.lastChild;return o&&"meta"===o.name&&(o=o.next),a&&"mce_marker"===a.attr("id")&&(a=a.prev),r=a,i=(n=t).getNonEmptyElements(),r&&(r.isEmpty(i)||function(t,e){var n,r;return t.getBlockElements()[e.name]&&(r=e).firstChild&&r.firstChild===r.lastChild&&("br"===(n=e.firstChild).name||n.value===ei)}(n,r))&&(a=a.prev),!(!o||o!==a||"ul"!==o.name&&"ol"!==o.name)}(t.schema,z)&&Dp(h,r))return a=function(t,e,n,r){var i,o,a,s,l,u,c,d,f,h,p,g,m,v,y,x,b,_=(i=e,l=t.serialize(r),a=(o=i.createFragment(l)).firstChild,s=o.lastChild,a&&"META"===a.nodeName&&a.parentNode.removeChild(a),s&&"mce_marker"===s.id&&s.parentNode.removeChild(s),o),w=Dp(e,n.startContainer),S=function(t){return 0<t.length&&(!(e=t[t.length-1]).firstChild||function(t){return t&&t.firstChild&&t.firstChild===t.lastChild&&((e=t.firstChild).data===ei||zn(e));var e}(e))?t.slice(0,-1):t;var e}(Me.grep(_.firstChild.childNodes,function(t){return"LI"===t.nodeName})),C=e.getRoot(),M=function(t){var r=vl.fromRangeStart(n),i=tc(e.getRoot()),o=1===t?i.prev(r):i.next(r);return!o||Dp(e,o.getNode())!==w};return M(1)?function(t,e,n){var r,i,o,a=t.parentNode;return Me.each(e,function(e){a.insertBefore(e,t)}),r=n,i=vl.before(t),(o=tc(r).next(i))?o.toRange():null}(w,S,C):M(2)?(u=w,d=C,e.insertAfter((c=S).reverse(),u),Op(c[0],d)):(h=S,p=C,g=f=w,v=(m=n).cloneRange(),y=m.cloneRange(),v.setStartBefore(g),y.setEndAfter(g),x=[v.cloneContents(),y.cloneContents()],(b=f.parentNode).insertBefore(x[0],f),Me.each(h,function(t){b.insertBefore(t,f)}),b.insertBefore(x[1],f),b.removeChild(f),Op(h[h.length-1],p))}(m,h,f.getRng(),z),f.setRng(a),void t.fire("SetContent",x);if(function(t){for(var e=t;e=e.walk();)1===e.type&&e.attr("data-mce-fragment","1")}(z),"mce_marker"===(s=z.lastChild).attr("id"))for(s=(o=s).prev;s;s=s.walk(!0))if(3===s.type||!h.isBlock(s.name)){t.schema.isValidChild(s.parent.name,"span")&&s.parent.insert(o,s,"br"===s.name);break}if(t._selectionOverrides.showBlockCaretContainer(r),N.invalid){for(t.selection.setContent(y),r=f.getNode(),i=t.getBody(),9===r.nodeType?r=s=i:s=r;s!==i;)s=(r=s).parentNode;e=r===i?i.innerHTML:h.getOuterHTML(r),e=m.serialize(p.parse(e.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return m.serialize(z)}))),r===i?h.setHTML(i,e):h.setOuterHTML(r,e)}else S=t,C=e=m.serialize(z),"all"===(M=r).getAttribute("data-mce-bogus")?M.parentNode.insertBefore(S.dom.createFragment(C),M):!(T=M.firstChild)||T===M.lastChild&&"BR"===T.nodeName?S.dom.setHTML(M,C):S.selection.setContent(C);A=g,O=(k=t).schema.getTextInlineElements(),P=k.dom,A&&(I=k.getBody(),D=Kf(P),Me.each(P.select("*[data-mce-fragment]"),function(t){if(v(O[t.nodeName.toLowerCase()])&&function(t,e){return Q(ih(t,e),function(t){return!eh.has(t)})}(P,t))for(var e=t.parentNode;v(e)&&e!==I&&!oh(P,t,e);e=e.parentNode)if(D.compare(e,t)){P.remove(t,!0);break}})),function(t,e){var n,r,i=t.dom,o=t.selection;if(e){o.scrollIntoView(e);var a=function(e){for(var n=t.getBody();e&&e!==n;e=e.parentNode)if("false"===i.getContentEditable(e))return e;return null}(e);if(a)return i.remove(e),o.select(a);var s=i.createRng(),l=e.previousSibling;l&&3===l.nodeType?(s.setStart(l,l.nodeValue.length),be.ie||(r=e.nextSibling)&&3===r.nodeType&&(l.appendData(r.data),r.parentNode.removeChild(r))):(s.setStartBefore(e),s.setEndBefore(e));var u=i.getParent(e,i.isBlock);i.remove(e),u&&i.isEmpty(u)&&(t.$(u).empty(),s.setStart(u,0),s.setEnd(u,0),Pp(u)||u.getAttribute("data-mce-fragment")||!(n=function(e){var n=vl.fromRangeStart(e);if(n=tc(t.getBody()).next(n))return n.toRange()}(s))?i.add(u,i.create("br",{"data-mce-bogus":"1"})):(s=n,i.remove(u))),o.setRng(s)}}(t,h.get("mce_marker")),E=t.getBody(),Me.each(E.getElementsByTagName("*"),function(t){t.removeAttribute("data-mce-fragment")}),R=h,L=f.getStart(),B.from(R.getParent(L,"td,th")).map(De).each(wh),t.fire("SetContent",x),t.addVisual()}},Rp=function(t,e){e(t),t.firstChild&&Rp(t.firstChild,e),t.next&&Rp(t.next,e)},Lp=function(t){return t instanceof Hf},Np=function(t,e){var n;t.dom.setHTML(t.getBody(),e),Df(n=t)&&cc(n.getBody()).each(function(t){var e=t.getNode(),r=On(e)?cc(e).getOr(t):t;n.selection.setRng(r.toRange())})},Bp=function(t){return y(t)?t:P},zp=function(t,e,n){var r=e(t),i=Bp(n);return r.orThunk(function(){return i(t)?B.none():function(t,e,n){for(var r=t.dom,i=Bp(n);r.parentNode;){var o=De(r=r.parentNode),a=e(o);if(a.isSome())return a;if(i(o))break}return B.none()}(t,e,i)})},Vp=Ec,Fp=function(t,e,n){var r=t.formatter.get(n);if(r)for(var i=0;i<r.length;i++)if(!1===r[i].inherit&&t.dom.is(e,r[i].selector))return!0;return!1},Hp=function(t,e,n,r){var i=t.dom.getRoot();return e!==i&&(e=t.dom.getParent(e,function(e){return!!Fp(t,e,n)||e.parentNode===i||!!Gp(t,e,n,r,!0)}),Gp(t,e,n,r))},Wp=function(t,e,n){return!!Vp(e,n.inline)||!!Vp(e,n.block)||(n.selector?1===e.nodeType&&t.is(e,n.selector):void 0)},jp=function(t,e,n,r,i,o){var a,s,l,u=n[r];if(n.onmatch)return n.onmatch(e,n,r);if(u)if(void 0===u.length){for(a in u)if(u.hasOwnProperty(a)){if(s="attributes"===r?t.getAttrib(e,a):Lc(t,e,a),i&&!s&&!n.exact)return;if((!i||n.exact)&&!Vp(s,Rc(t,Pc(u[a],o),a)))return}}else for(l=0;l<u.length;l++)if("attributes"===r?t.getAttrib(e,u[l]):Lc(t,e,u[l]))return n;return n},Gp=function(t,e,n,r,i){var o,a,s,l,u=t.formatter.get(n),c=t.dom;if(u&&e)for(a=0;a<u.length;a++)if(Wp(t.dom,e,o=u[a])&&jp(c,e,o,"attributes",i,r)&&jp(c,e,o,"styles",i,r)){if(l=o.classes)for(s=0;s<l.length;s++)if(!t.dom.hasClass(e,Pc(l[s],r)))return;return o}},Up=function(t,e,n,r){if(r)return Hp(t,r,e,n);if(r=t.selection.getNode(),Hp(t,r,e,n))return!0;var i=t.selection.getStart();return!(i===r||!Hp(t,i,e,n))},qp=function(t,e,n){return $(n,function(n,r){var i=j(t.formatter.get(r),function(t){var e=function(t){return 1<t.length&&"%"===t.charAt(0)};return j(["styles","attributes"],function(n){return gt(t,n).exists(function(t){var n=f(t)?t:function(t){return e=[],lt(t,function(t,n){e.push(t)}),e;var e}(t);return j(n,e)})})});return t.formatter.matchNode(e,r,{},i)?n.concat([r]):n},[])},Xp=ni,Yp="_mce_caret",$p=function(t){return 0<function(t){for(var e=[];t;){if(3===t.nodeType&&t.nodeValue!==Xp||1<t.childNodes.length)return[];1===t.nodeType&&e.push(t),t=t.firstChild}return e}(t).length},Zp=function(t){if(t){var e=new Wr(t,t);for(t=e.current();t;t=e.next())if(Rn(t))return t}return null},Kp=function(t){var e=Ae("span");return Xn(e,{id:Yp,"data-mce-bogus":"1","data-mce-type":"format-caret"}),t&&cn(e,Ie(Xp)),e},Jp=function(t,e,n){void 0===n&&(n=!0);var r,i,o,a,s,l,u,c,d=t.dom,f=t.selection;$p(e)?up(t,!1,De(e),n):(r=f.getRng(),i=d.getParent(e,d.isBlock),o=r.startContainer,a=r.startOffset,s=r.endContainer,l=r.endOffset,(c=Zp(e))&&c.nodeValue.charAt(0)===Xp&&c.deleteData(0,1),u=c,d.remove(e,!0),o===u&&0<a&&r.setStart(u,a-1),s===u&&0<l&&r.setEnd(u,l-1),i&&d.isEmpty(i)&&_h(De(i)),f.setRng(r))},Qp=function(t,e,n){void 0===n&&(n=!0);var r=t.dom,i=t.selection;if(e)Jp(t,e,n);else if(!(e=pc(t.getBody(),i.getStart())))for(;e=r.get(Yp);)Jp(t,e,!1)},tg=function(t,e){return t.appendChild(e),e},eg=function(t,e){var n=Y(t,function(t,e){return tg(t,e.cloneNode(!1))},e);return tg(n,n.ownerDocument.createTextNode(Xp))},ng=function(t,e){return t.schema.getTextInlineElements().hasOwnProperty(Ne(e))&&!hc(e.dom)&&!Dn(e.dom)},rg={},ig=_t,og=xt;nh=function(t){var e,n=t.selection.getRng(),r=kn(["pre"]);n.collapsed||(e=t.selection.getSelectedBlocks(),og(ig(ig(e,r),function(t){return r(t.previousSibling)&&-1!==wt(e,t.previousSibling)}),function(t){var e,n;e=t.previousSibling,ns(n=t).remove(),ns(e).append("<br><br>").append(n.childNodes)}))},rg.pre||(rg.pre=[]),rg.pre.push(nh);var ag,sg,lg,ug,cg=Me.each,dg=function(t){return Tn(t)&&!wc(t)&&!hc(t)&&!Dn(t)},fg=function(t,e){for(var n=t;n;n=n[e]){if(Rn(n)&&0!==n.nodeValue.length)return t;if(Tn(n)&&!wc(n))return n}return t},hg=function(t,e,n){var r,i,o=Kf(t);if(e&&n&&(e=fg(e,"previousSibling"),n=fg(n,"nextSibling"),o.compare(e,n))){for(r=e.nextSibling;r&&r!==n;)r=(i=r).nextSibling,e.appendChild(i);return t.remove(n),Me.each(Me.grep(n.childNodes),function(t){e.appendChild(t)}),e}return n},pg=function(t,e,n,r){var i;r&&!1!==e.merge_siblings&&(i=hg(t,Ac(r),r),hg(t,i,Ac(i,!0)))},gg=function(t,e,n){cg(t.childNodes,function(t){dg(t)&&(e(t)&&n(t),t.hasChildNodes()&&gg(t,e,n))})},mg=function(t,e){return function(n){return!(!n||!Lc(t,n,e))}},vg=function(t,e,n){return function(r){var i,o;t.setStyle(r,e,n),""===r.getAttribute("style")&&r.removeAttribute("style"),i=t,"SPAN"===(o=r).nodeName&&0===i.getAttribs(o).length&&i.remove(o,!0)}},yg=gr([{keep:[]},{rename:["name"]},{removed:[]}]),xg=/^(src|href|style)$/,bg=Me.each,_g=Ec,wg=function(t,e,n){return t.isChildOf(e,n)&&e!==n&&!t.isBlock(n)},Sg=function(t,e,n){var r,i=e[n?"startContainer":"endContainer"],o=e[n?"startOffset":"endOffset"];return Tn(i)&&(!n&&o&&o--,i=i.childNodes[(r=i.childNodes.length-1)<o?r:o]),Rn(i)&&n&&o>=i.nodeValue.length&&(i=new Wr(i,t.getBody()).next()||i),Rn(i)&&!n&&0===o&&(i=new Wr(i,t.getBody()).prev()||i),i},Cg=function(t,e){var n=e?"firstChild":"lastChild";if(/^(TR|TH|TD)$/.test(t.nodeName)&&t[n]){var r=t[n];return"TR"===t.nodeName&&r[n]||r}return t},Mg=function(t,e,n,r){var i=t.create(n,r);return e.parentNode.insertBefore(i,e),i.appendChild(e),i},Tg=function(t,e,n,r,i){var o=De(e),a=De(t.create(r,i)),s=(n?$e:Ye)(o);return dn(a,s),n?(sn(o,a),un(a,o)):(ln(o,a),cn(a,o)),a.dom},kg=function(t,e,n,r){return!(e=Ac(e,n,r))||"BR"===e.nodeName||t.isBlock(e)},Ag=function(t,e,n,r,i){var o,a,s,l,u,c=t.dom;if(s=c,!(_g(l=r,(u=e).inline)||_g(l,u.block)||u.selector&&Tn(l)&&s.is(l,u.selector)||(a=r,e.links&&"A"===a.nodeName)))return yg.keep();var d,h,p,g,m,v,y,b=r;if(e.inline&&"all"===e.remove&&f(e.preserve_attributes)){var _=X(c.getAttribs(b),function(t){return W(e.preserve_attributes,t.name.toLowerCase())});if(c.removeAllAttribs(b),U(_,function(t){return c.setAttrib(b,t.name,t.value)}),0<_.length)return yg.rename("span")}if("all"!==e.remove){bg(e.styles,function(t,r){t=Rc(c,Pc(t,n),r+""),x(r)&&(r=t,i=null),!e.remove_similar&&i&&!_g(Lc(c,i,r),t)||c.setStyle(b,r,""),o=!0}),o&&""===c.getAttrib(b,"style")&&(b.removeAttribute("style"),b.removeAttribute("data-mce-style")),bg(e.attributes,function(t,r){var o;if(t=Pc(t,n),x(r)&&(r=t,i=null),e.remove_similar||!i||_g(c.getAttrib(i,r),t)){if("class"===r&&(t=c.getAttrib(b,r))&&(o="",U(t.split(/\s+/),function(t){/mce\-\w+/.test(t)&&(o+=(o?" ":"")+t)}),o))return void c.setAttrib(b,r,o);if(xg.test(r)&&b.removeAttribute("data-mce-"+r),"style"===r&&kn(["li"])(b)&&"none"===c.getStyle(b,"list-style-type"))return b.removeAttribute(r),void c.setStyle(b,"list-style-type","none");"class"===r&&b.removeAttribute("className"),b.removeAttribute(r)}}),bg(e.classes,function(t){t=Pc(t,n),i&&!c.hasClass(i,t)||c.removeClass(b,t)});for(var w=c.getAttribs(b),S=0;S<w.length;S++){var C=w[S].nodeName;if(0!==C.indexOf("_")&&0!==C.indexOf("data-"))return yg.keep()}}return"none"!==e.remove?(p=e,m=(h=b).parentNode,v=(d=t).dom,y=Gl(d),p.block&&(y?m===v.getRoot()&&(p.list_block&&_g(h,p.list_block)||U(ot(h.childNodes),function(t){Dc(d,y,t.nodeName.toLowerCase())?g?g.appendChild(t):(g=Mg(v,t,y),v.setAttribs(g,d.settings.forced_root_block_attrs)):g=0})):v.isBlock(h)&&!v.isBlock(m)&&(kg(v,h,!1)||kg(v,h.firstChild,!0,!0)||h.insertBefore(v.create("br"),h.firstChild),kg(v,h,!0)||kg(v,h.lastChild,!1,!0)||h.appendChild(v.create("br")))),p.selector&&p.inline&&!_g(p.inline,h)||v.remove(h,!0),yg.removed()):yg.keep()},Ig=function(t,e,n,r,i){return Ag(t,e,n,r,i).fold(P,function(e){return t.dom.rename(r,e),!0},E)},Dg=function(t,e,n,r,i){var o,a=t.formatter.get(e),s=a[0],l=!0,u=t.dom,c=t.selection,d=function(r){var o,l,u,c,d,f=(l=e,u=n,c=i,U(Bc((o=t).dom,r.parentNode).reverse(),function(t){var e;d||"_start"===t.id||"_end"===t.id||(e=Gp(o,t,l,u,c))&&!1!==e.split&&(d=t)}),d);return function(t,e,n,r,i,o,a,s){var l,u,c,d=t.dom;if(n){for(var f=n.parentNode,h=r.parentNode;h&&h!==f;h=h.parentNode){l=d.clone(h,!1);for(var p=0;p<e.length&&null!==(l=function(t,e,n,r){return Ag(t,e,n,r,r).fold(w(r),function(e){return t.dom.createFragment().appendChild(r),t.dom.rename(r,e)},w(null))}(t,e[p],s,l));p++);l&&(u&&l.appendChild(u),c=c||l,u=l)}a.mixed&&d.isBlock(n)||(r=d.split(n,r)),u&&(i.parentNode.insertBefore(u,i),c.appendChild(i),a.inline&&pg(d,a,0,u))}return r}(t,a,f,r,r,0,s,n)},f=function(e){var r,i,o=e.parentNode;Rn(e)&&Wc(u,o)&&Ig(t,s,n,o,o),Tn(e)&&u.getContentEditable(e)&&(r=l,l="true"===u.getContentEditable(e),i=!0);var c=ot(e.childNodes);if(l&&!i)for(var d=0;d<a.length&&!Ig(t,a[d],n,e,e);d++);if(s.deep&&c.length){for(d=0;d<c.length;d++)f(c[d]);i&&(l=r)}},h=function(t){var e,n=u.get(t?"_start":"_end"),r=n[t?"firstChild":"lastChild"];return wc(e=r)&&Tn(e)&&("_start"===e.id||"_end"===e.id)&&(r=r[t?"firstChild":"lastChild"]),Rn(r)&&0===r.data.length&&(r=t?n.previousSibling||n.nextSibling:n.nextSibling||n.previousSibling),u.remove(n,!0),r},p=function(e){var n,r,i=rd(t,e,a,e.collapsed);if(s.split){if(i=Bd(i),(n=Sg(t,i,!0))!==(r=Sg(t,i))){if(n=Cg(n,!0),r=Cg(r,!1),wg(u,n,r)){var o=B.from(n.firstChild).getOr(n);return d(Tg(u,o,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void h(!0)}if(wg(u,r,n))return o=B.from(r.lastChild).getOr(r),d(Tg(u,o,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void h(!1);n=Mg(u,n,"span",{id:"_start","data-mce-type":"bookmark"}),r=Mg(u,r,"span",{id:"_end","data-mce-type":"bookmark"});var l=u.createRng();l.setStartAfter(n),l.setEndBefore(r),od(u,l,function(t){U(t,function(t){wc(t)||wc(t.parentNode)||d(t)})}),d(n),d(r),n=h(!0),r=h()}else n=r=d(n);i.startContainer=n.parentNode?n.parentNode:n,i.startOffset=u.nodeIndex(n),i.endContainer=r.parentNode?r.parentNode:r,i.endOffset=u.nodeIndex(r)+1}od(u,i,function(e){U(e,function(e){f(e),U(["underline","line-through","overline"],function(n){Tn(e)&&t.dom.getStyle(e,"text-decoration")===n&&e.parentNode&&Nc(u,e.parentNode)===n&&Ig(t,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},null,e)})})})};if(r)Tc(r)?((o=u.createRng()).setStartBefore(r),o.setEndAfter(r),p(o)):p(r);else if("false"!==u.getContentEditable(c.getNode()))c.isCollapsed()&&s.inline&&!ld(t).length?function(t,e,n,r){var i,o,a,s,l,u,c,d,f,h,p,g,m,v=t.dom,y=t.selection,x=[],b=y.getRng(),_=b.startContainer,w=_;for(3===_.nodeType&&(b.startOffset!==_.nodeValue.length&&(i=!0),w=w.parentNode);w;){if(Gp(t,w,e,n,r)){o=w;break}w.nextSibling&&(i=!0),x.push(w),w=w.parentNode}o&&(i?(a=y.getBookmark(),b.collapse(!0),s=rd(t,b,t.formatter.get(e),!0),s=Bd(s),t.formatter.remove(e,n,s,r),y.moveToBookmark(a)):(l=pc(t.getBody(),o),h=u=Kp(!1).dom,(m=(g=(f=t).dom).getParent(p=null!==l?l:o,C(Ic,f)))&&g.isEmpty(m)?p.parentNode.replaceChild(h,p):(function(t){var e=As(t,"br"),n=X(function(t){for(var e=[],n=t.dom;n;)e.push(De(n)),n=n.lastChild;return e}(t).slice(-1),Yr);e.length===n.length&&U(n,hn)}(De(p)),g.isEmpty(p)?p.parentNode.replaceChild(h,p):g.insertAfter(h,p)),c=function(t,e,n,r,i,o){var a=t.formatter,s=t.dom,l=X(at(a.get()),function(t){return t!==r&&!zt(t,"removeformat")}),u=qp(t,n,l);if(0<X(u,function(e){return!zc(t,e,r)}).length){var c=n.cloneNode(!1);return s.add(e,c),a.remove(r,i,c,o),s.remove(c),B.some(c)}return B.none()}(t,u,o,e,n,r),d=eg(x.concat(c.toArray()),u),Jp(t,l,!1),y.setCursorLocation(d,1),v.isEmpty(o)&&v.remove(o)))}(t,e,n,i):(gd(c,!0,function(){pd(t,p)}),s.inline&&Up(t,e,n,c.getStart())&&kc(u,c,c.getRng()),t.nodeChanged());else{r=c.getNode();for(var g=0;g<a.length&&(!a[g].ceFalseOverride||!Ig(t,a[g],n,r,r));g++);}},Og=Me.each,Pg=Me.each,Eg=vt,Rg=function(t,e,n,r){var i,o,a,s,l=t.formatter.get(e),u=l[0],c=!r&&t.selection.isCollapsed(),d=t.dom,f=t.selection,h=function(t,e){var i;e=e||u,t&&(e.onformat&&e.onformat(t,e,n,r),Pg(e.styles,function(e,r){d.setStyle(t,r,Pc(e,n))}),!e.styles||(i=d.getAttrib(t,"style"))&&d.setAttrib(t,"data-mce-style",i),Pg(e.attributes,function(e,r){d.setAttrib(t,r,Pc(e,n))}),Pg(e.classes,function(e){e=Pc(e,n),d.hasClass(t,e)||d.addClass(t,e)}))},p=function(t,e){var n=!1;return!!Fc(u)&&(Pg(t,function(t){if(!("collapsed"in t)||t.collapsed===c)return d.is(e,t.selector)&&!hc(e)?(h(e,t),!(n=!0)):void 0}),n)},g=function(r,i,o,a){var s=[],c=!0,d=u.inline||u.block,f=r.create(d);h(f),od(r,i,function(i){var o,g=function(i){var m=!1,v=c,y=i.nodeName.toLowerCase(),x=i.parentNode.nodeName.toLowerCase();if(Tn(i)&&r.getContentEditable(i)&&(v=c,c="true"===r.getContentEditable(i),m=!0),zn(i)&&!function(t,e,n,r){if(t.getParam("format_empty_lines",!1,"boolean")&&Hc(e)){var i=Tt(Tt({},t.schema.getTextBlockElements()),{td:{},th:{},li:{},dt:{},dd:{},figcaption:{},caption:{},details:{},summary:{}}),o=function(t,e){return r=e,((i=(n=t).dom).parentNode?function(t,e){return Z(t.dom.childNodes,function(t){return function(t){return!Re(n,t)&&r(t)}(De(t))}).map(De)}(De(i.parentNode)):B.none()).isSome();var n,r,i}(De(n),function(t){return hc(t.dom)});return vt(i,r)&&Ei(De(n.parentNode),!1)&&!o}return!1}(t,u,i,x))return o=null,void(Vc(u)&&r.remove(i));if(u.wrapper&&Gp(t,i,e,n))o=null;else{if(c&&!m&&Vc(u)&&!u.wrapper&&Ic(t,y)&&Dc(t,x,d)){var b=r.rename(i,d);return h(b),s.push(b),void(o=null)}if(Fc(u)){var _=p(l,i);if(Rn(i)&&Wc(r,i.parentNode)&&p(l,i.parentNode),!Eg(u,"inline")||_)return void(o=null)}!c||m||!Dc(t,d,y)||!Dc(t,x,d)||!a&&3===i.nodeType&&1===i.nodeValue.length&&65279===i.nodeValue.charCodeAt(0)||hc(i)||Eg(u,"inline")&&r.isBlock(i)?(o=null,Pg(Me.grep(i.childNodes),g),m&&(c=v),o=null):(o||(o=r.clone(f,!1),i.parentNode.insertBefore(o,i),s.push(o)),o.appendChild(i))}};Pg(i,g)}),!0===u.links&&Pg(s,function(t){var e=function(t){"A"===t.nodeName&&h(t,u),Pg(Me.grep(t.childNodes),e)};e(t)}),Pg(s,function(i){var o,a,c,d,f,p,g,m,y,x,b,_,w,S,C,M,T,k,A,I=(o=0,Pg(i.childNodes,function(t){var e;v(e=t)&&Rn(e)&&0===e.length||wc(t)||o++}),o);!(1<s.length)&&r.isBlock(i)||0!==I?(Hc(u)||u.wrapper)&&(u.exact||1!==I||((A=function(t){var e=!1;return Pg(t.childNodes,function(t){if((n=t)&&1===n.nodeType&&!wc(n)&&!hc(n)&&!Dn(n))return e=t,!1;var n}),e}(T=i))&&!wc(A)&&Wp(r,A,u)&&(k=r.clone(A,!1),h(k),r.replace(k,T,!0),r.remove(A,!0)),i=k||T),function(t,e,n,r){Og(e,function(e){var i,o;Og(t.dom.select(e.inline,r),function(r){dg(r)&&Ig(t,e,n,r,e.exact?r:null)}),i=t.dom,(o=e).clear_child_styles&&cg(i.select(o.links?"*:not(a)":"*",r),function(t){dg(t)&&cg(o.styles,function(e,n){i.setStyle(t,n,"")})})})}(t,l,n,i),w=u,Gp(_=t,(M=i).parentNode,S=e,C=n)&&Ig(_,w,C,M)||w.merge_with_parents&&_.dom.getParent(M.parentNode,function(t){if(Gp(_,t,S,C))return Ig(_,w,C,M),!0}),y=r,b=n,(x=u).styles&&x.styles.backgroundColor&&gg(i,mg(y,"fontSize"),vg(y,"backgroundColor",Pc(x.styles.backgroundColor,b))),f=r,g=i,m=function(t){var e;1===t.nodeType&&t.parentNode&&1===t.parentNode.nodeType&&(e=Nc(f,t.parentNode),f.getStyle(t,"color")&&e?f.setStyle(t,"text-decoration",e):f.getStyle(t,"text-decoration")===e&&f.setStyle(t,"text-decoration",null))},(p=u).styles&&(p.styles.color||p.styles.textDecoration)&&(Me.walk(g,m,"childNodes"),m(g)),a=r,d=i,"sub"!==(c=u).inline&&"sup"!==c.inline||(gg(d,mg(a,"fontSize"),vg(a,"fontSize","")),a.remove(a.select("sup"===c.inline?"sub":"sup",d),!0)),pg(r,u,0,i)):r.remove(i,!0)})};if("false"!==d.getContentEditable(f.getNode()))u&&(r?Tc(r)?p(l,r)||((i=d.createRng()).setStartBefore(r),i.setEndAfter(r),g(d,rd(t,i,l),0,!0)):g(d,r,0,!0):c&&Hc(u)&&!ld(t).length?function(t,e,n){var r,i=t.selection,o=i.getRng(),a=o.startOffset,s=o.startContainer.nodeValue,l=pc(t.getBody(),i.getStart());l&&(r=Zp(l));var u,c,d,f,h=/[^\s\u00a0\u00ad\u200b\ufeff]/;s&&0<a&&a<s.length&&h.test(s.charAt(a))&&h.test(s.charAt(a-1))?(u=i.getBookmark(),o.collapse(!0),c=rd(t,o,t.formatter.get(e)),c=Bd(c),t.formatter.apply(e,n,c),i.moveToBookmark(u)):(l&&r.nodeValue===Xp||(d=t.getDoc(),f=Kp(!0).dom,r=(l=d.importNode(f,!0)).firstChild,o.insertNode(l),a=1),t.formatter.apply(e,n,l),i.setCursorLocation(r,a))}(t,e,n):(o=f.getNode(),a=l[0],t.settings.forced_root_block||!a.defaultBlock||d.getParent(o,d.isBlock)||Rg(t,a.defaultBlock),f.setRng(Ip(f.getRng())),gd(f,!0,function(e){pd(t,function(e,n){var r=n?e:rd(t,e,l);g(d,r)})}),kc(d,f,f.getRng()),t.nodeChanged()),s=t,og(rg[e],function(t){t(s)}));else{r=f.getNode();for(var m=0,y=l.length;m<y;m++){var x=l[m];if(x.ceFalseOverride&&Fc(x)&&d.is(r,x.selector))return void h(r,x)}}},Lg=function(t,e){var n=(e||document).createDocumentFragment();return U(t,function(t){n.appendChild(t.dom)}),De(n)},Ng=function(t,e,n){return{element:t,width:e,rows:n}},Bg=function(t,e){return{element:t,cells:e}},zg=function(t,e){var n=parseInt(Yn(t,e),10);return isNaN(n)?1:n},Vg=function(t){return $(t,function(t,e){return e.cells.length>t?e.cells.length:t},0)},Fg=function(t,e){for(var n=t.rows,r=0;r<n.length;r++)for(var i=n[r].cells,o=0;o<i.length;o++)if(Re(i[o],e))return B.some({x:o,y:r});return B.none()},Hg=function(t,e,n,r,i){for(var o=[],a=t.rows,s=n;s<=i;s++){var l=a[s].cells,u=e<r?l.slice(e,r+1):l.slice(r,e+1);o.push(Bg(a[s].element,u))}return o},Wg=function(t){return n=G((e=t).rows,function(t){var e=G(t.cells,function(t){var e=Vs(t);return Zn(e,"colspan"),Zn(e,"rowspan"),e}),n=zs(t.element);return dn(n,e),n}),r=zs(e.element),i=Ae("tbody"),dn(i,n),cn(r,i),r;var e,n,r,i},jg=function(){return Lg([])},Gg=function(t,e){return 0<=e&&e<t.length&&Cc(t.charAt(e))},Ug=function(t,e){var n=ii(t.innerText);return e?n.replace(/^[ \f\n\r\t\v]+/,""):n},qg=function(t,e,n){if(void 0===n&&(n={}),n.get=!0,n.format=e,n.selection=!0,(n=t.fire("BeforeGetContent",n)).isDefaultPrevented())return t.fire("GetContent",n),n.content;if("text"===n.format)return function(t){return B.from(t.selection.getRng()).map(function(e){var n=B.from(t.dom.getParent(e.commonAncestorContainer,t.dom.isBlock)),r=t.getBody(),i=n.map(function(t){return t.nodeName}).getOr("div").toLowerCase(),o=be.browser.isIE()&&"pre"!==i,a=t.dom.add(r,i,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},e.cloneContents()),s=Ug(a,o),l=ii(a.textContent);if(t.dom.remove(a),Gg(l,0)||Gg(l,l.length-1)){var u=n.getOr(r),c=Ug(u,o),d=c.indexOf(s);return-1===d?s:(Gg(c,d-1)?" ":"")+s+(Gg(c,d+s.length)?" ":"")}return s}).getOr("")}(t);n.getInner=!0;var r,i,o,a,s,l,u,d=(i=n,o=(r=t).selection.getRng(),a=r.dom.create("body"),s=r.selection.getSel(),l=Bf(r,ad(s)),(u=i.contextual?function(t,e){var n,r,i=sd(e,t);return 0<i.length?function(t,e){return Tr(e[0],"table",C(Re,t)).bind(function(t){var n=e[0],r=e[e.length-1];return function(t,e,n){return Fg(t,e).bind(function(e){return Fg(t,n).map(function(n){return r=t,a=(i=e).x,l=(o=n).x,c=(s=i.y)<(u=o.y)?Hg(r,a,s,l,u):Hg(r,a,u,l,s),Ng(r.element,Vg(c),c);var r,i,o,a,s,l,u,c})})}(function(t){var e=Ng(zs(t),0,[]);return U(As(t,"tr"),function(t,n){U(As(t,"td,th"),function(r,i){!function(t,e,n,r,i){for(var o=zg(i,"rowspan"),a=zg(i,"colspan"),s=t.rows,l=n;l<n+o;l++){s[l]||(s[l]=Bg(Vs(r),[]));for(var u=e;u<e+a;u++)s[l].cells[u]=l===n&&u===e?i:zs(i)}}(e,function(t,e,n){for(;((i=t.rows)[r=n]?i[r].cells:[])[e];)e++;var r,i;return e}(e,i,n),n,t,r)})}),Ng(e.element,Vg(e.rows),e.rows)}(t),n,r).map(function(t){return Lg([Wg(t)])})}).getOrThunk(jg)}(t,i):(n=t,0<(r=e).length&&r[0].collapsed?jg():function(t,e){return n=De(e.cloneContents()),r=function(t,e){var n,r=De(e.commonAncestorContainer),i=Ch(r,t),o=X(i,function(t){return Xr(t)||Ur(t)}),a=function(t,e){return Z(t,function(t){return"li"===Ne(t)&&dd(t,e)}).fold(w([]),function(e){return Z(t,function(t){return"ul"===Ne(t)||"ol"===Ne(t)}).map(function(t){var e=Ae(Ne(t));return function(t,e){var n=t.dom;lt(e,function(t,e){!function(t,e,n){if(!c(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);Gn(t)&&t.style.setProperty(e,n)}(n,e,t)})}(e,pt(tr(t),function(t,e){return Vt(e,"list-style")})),[Ae("li"),e]}).getOr([])})}(i,e),s=o.concat(a.length?a:Kr(n=r)?Ue(n).filter(Zr).fold(w([]),function(t){return[n,t]}):Zr(n)?[n]:[]);return G(s,zs)}(t,e),i=$(r,function(t,e){return cn(e,t),e},n),0<r.length?Lg([i]):i;var n,r,i}(n,r[0]))}(De(r.getBody()),l).dom:o.cloneContents())&&a.appendChild(u),r.selection.serializer.serialize(a,i));return"tree"===n.format?d:(n.content=t.selection.isCollapsed()?"":d,t.fire("GetContent",n),n.content)},Xg=function(t){return Tn(t)?t.outerHTML:Rn(t)?Zi.encodeRaw(t.data,!1):Ln(t)?"\x3c!--"+t.data+"--\x3e":""},Yg=gs(B.none()),$g=function(t){var e,n=(e=t.getBody(),X(G(ot(e.childNodes),Xg),function(t){return 0<t.length})),r=J(n,function(e){var n=Yf(t.serializer,e);return 0<n.length?[n]:[]}),i=r.join("");return-1!==i.indexOf("</iframe>")?{type:"fragmented",fragments:r,content:"",bookmark:null,beforeBookmark:null}:{type:"complete",fragments:null,content:i,bookmark:null,beforeBookmark:null}},Zg=function(t,e,n){"fragmented"===e.type?function(t,e){var n,r,i,o,a,s,l,u,c,d=G(ot(e.childNodes),Xg);!function(t,e){var n=0;U(t,function(t){var r,i,o;0===t[0]?n++:1===t[0]?(function(t,e,n){var r,i=function(t){var e,n=document.createElement("div"),r=document.createDocumentFragment();for(t&&(n.innerHTML=t);e=n.firstChild;)r.appendChild(e);return r}(e);t.hasChildNodes()&&n<t.childNodes.length?(r=t.childNodes[n]).parentNode.insertBefore(i,r):t.appendChild(i)}(e,t[1],n),n++):2===t[0]&&(i=n,(r=e).hasChildNodes()&&i<r.childNodes.length&&(o=r.childNodes[i]).parentNode.removeChild(o))})}((i=(n=d).length+(r=t).length+2,o=new Array(i),a=new Array(i),s=function(t,e,i,o,a){var l=u(t,e,i,o);if(null===l||l.start===e&&l.diag===e-o||l.end===t&&l.diag===t-i)for(var c=t,d=i;c<e||d<o;)c<e&&d<o&&n[c]===r[d]?(a.push([0,n[c]]),++c,++d):o-i<e-t?(a.push([2,n[c]]),++c):(a.push([1,r[d]]),++d);else{s(t,l.start,i,l.start-l.diag,a);for(var f=l.start;f<l.end;++f)a.push([0,n[f]]);s(l.end,e,l.end-l.diag,o,a)}},l=function(t,e,i,o){for(var a=t;a-e<o&&a<i&&n[a]===r[a-e];)++a;return{start:t,end:a,diag:e}},u=function(t,e,i,s){var u=e-t,c=s-i;if(0==u||0==c)return null;var d,f,h,p,g,m=u-c,v=c+u,y=(v%2==0?v:1+v)/2;for(o[1+y]=t,a[1+y]=e+1,d=0;d<=y;++d){for(f=-d;f<=d;f+=2){for(o[h=f+y]=f===-d||f!==d&&o[h-1]<o[h+1]?o[h+1]:o[h-1]+1,g=(p=o[h])-t+i-f;p<e&&g<s&&n[p]===r[g];)o[h]=++p,++g;if(m%2!=0&&m-d<=f&&f<=m+d&&a[h-m]<=o[h])return l(a[h-m],f+t-i,e,s)}for(f=m-d;f<=m+d;f+=2){for(a[h=f+y-m]=f===m-d||f!==m+d&&a[h+1]<=a[h-1]?a[h+1]-1:a[h-1],g=(p=a[h]-1)-t+i-f;t<=p&&i<=g&&n[p]===r[g];)a[h]=p--,g--;if(m%2==0&&-d<=f&&f<=d&&a[h]<=o[h+m])return l(a[h],f+t-i,e,s)}}},s(0,n.length,0,r.length,c=[]),c),e)}(e.fragments,t.getBody()):t.setContent(e.content,{format:"raw"}),t.selection.moveToBookmark(n?e.beforeBookmark:e.bookmark)},Kg=function(t){return"fragmented"===t.type?t.fragments.join(""):t.content},Jg=function(t){var e=Ae("body",Yg.get().getOrThunk(function(){var t=document.implementation.createHTMLDocument("undo");return Yg.set(B.some(t)),t}));return Ns(e,Kg(t)),U(As(e,"*[data-mce-bogus]"),pn),e.dom.innerHTML},Qg=function(t,e){return!(!t||!e)&&(r=e,Kg(t)===Kg(r)||(n=e,Jg(t)===Jg(n)));var n,r},tm=function(t){return 0===t.get()},em=function(t,e,n){tm(n)&&(t.typing=e)},nm=function(t,e){t.typing&&(em(t,!1,e),t.add())},rm=function(t){return{undoManager:{beforeChange:function(e,n){return r=t,i=n,void(tm(e)&&i.set(B.some(Fl(r.selection))));var r,i},addUndoLevel:function(e,n,r,i,o,a){return function(t,e,n,r,i,o,a){var s=$g(t);if(o=Me.extend(o=o||{},s),!1===tm(r)||t.removed)return null;var l=e.data[n.get()];if(t.fire("BeforeAddUndo",{level:o,lastLevel:l,originalEvent:a}).isDefaultPrevented())return null;if(l&&Qg(l,o))return null;e.data[n.get()]&&i.get().each(function(t){e.data[n.get()].beforeBookmark=t});var u=t.getParam("custom_undo_redo_levels",0,"number");if(u&&e.data.length>u){for(var c=0;c<e.data.length-1;c++)e.data[c]=e.data[c+1];e.data.length--,n.set(e.data.length)}o.bookmark=Fl(t.selection),n.get()<e.data.length-1&&(e.data.length=n.get()+1),e.data.push(o),n.set(e.data.length-1);var d={level:o,lastLevel:l,originalEvent:a};return 0<n.get()?(t.setDirty(!0),t.fire("AddUndo",d),t.fire("change",d)):t.fire("AddUndo",d),o}(t,e,n,r,i,o,a)},undo:function(e,n,r){return i=t,a=n,s=r,(o=e).typing&&(o.add(),o.typing=!1,em(o,!1,a)),0<s.get()&&(s.set(s.get()-1),l=o.data[s.get()],Zg(i,l,!0),i.setDirty(!0),i.fire("Undo",{level:l})),l;var i,o,a,s,l},redo:function(e,n){return r=t,o=n,(i=e).get()<o.length-1&&(i.set(i.get()+1),a=o[i.get()],Zg(r,a,!1),r.setDirty(!0),r.fire("Redo",{level:a})),a;var r,i,o,a},clear:function(e,n){return r=t,o=n,(i=e).data=[],o.set(0),i.typing=!1,void r.fire("ClearUndos");var r,i,o},reset:function(t){return(e=t).clear(),void e.add();var e},hasUndo:function(e,n){return r=t,i=e,0<n.get()||i.typing&&i.data[0]&&!Qg($g(r),i.data[0]);var r,i},hasRedo:function(t,e){return n=t,e.get()<n.data.length-1&&!n.typing;var n},transact:function(t,e,n){return i=n,nm(r=t,e),r.beforeChange(),r.ignore(i),r.add();var r,i},ignore:function(t,e){try{t.set(t.get()+1),e()}finally{t.set(t.get()-1)}},extra:function(e,n,r,i){return o=t,s=n,l=i,void((a=e).transact(r)&&(u=a.data[s.get()].bookmark,c=a.data[s.get()-1],Zg(o,c,!0),a.transact(l)&&(a.data[s.get()-1].beforeBookmark=u)));var o,a,s,l,u,c}},formatter:{match:function(e,n,r){return Up(t,e,n,r)},matchAll:function(e,n){return i=e,o=n,a=[],s={},l=(r=t).selection.getStart(),r.dom.getParent(l,function(t){for(var e=0;e<i.length;e++){var n=i[e];!s[n]&&Gp(r,t,n,o)&&(s[n]=!0,a.push(n))}},r.dom.getRoot()),a;var r,i,o,a,s,l},matchNode:function(e,n,r,i){return Gp(t,e,n,r,i)},canApply:function(e){return function(t,e){var n,r,i,o,a,s=t.formatter.get(e),l=t.dom;if(s)for(n=t.selection.getStart(),r=Bc(l,n),o=s.length-1;0<=o;o--){if(!(a=s[o].selector)||s[o].defaultBlock)return!0;for(i=r.length-1;0<=i;i--)if(l.is(r[i],a))return!0}return!1}(t,e)},closest:function(e){return function(t,e){var n=function(e){return Re(e,De(t.getBody()))};return B.from(t.selection.getStart(!0)).bind(function(r){return zp(De(r),function(n){return function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n]);if(r.isSome())return r}return B.none()}(e,function(e){return Gp(t,n.dom,r=e)?B.some(r):B.none();var r})},n)}).getOrNull()}(t,e)},apply:function(e,n,r){return Rg(t,e,n,r)},remove:function(e,n,r,i){return Dg(t,e,n,r,i)},toggle:function(e,n,r){return a=n,s=r,l=(i=t).formatter.get(o=e),void(!Up(i,o,a,s)||"toggle"in l[0]&&!l[0].toggle?Rg:Dg)(i,o,a,s);var i,o,a,s,l},formatChanged:function(e,n,r,i){return function(t,e,n,r,i){var o,a,s,l,u,c,d,f;return null===e.get()&&(a=t,s=gs({}),(o=e).set({}),a.on("NodeChange",function(t){!function(t,e,n,r){var i=at(n.get()),o={},a={},s=X(Bc(t.dom,e),function(t){return 1===t.nodeType&&!t.getAttribute("data-mce-bogus")});lt(r,function(e,n){Me.each(s,function(r){return t.formatter.matchNode(r,n,{},e.similar)?(-1===i.indexOf(n)&&(U(e.callbacks,function(t){t(!0,{node:r,format:n,parents:s})}),o[n]=e.callbacks),a[n]=e.callbacks,!1):!Fp(t,r,n)&&void 0})});var l=function(t,e,n,r){return ht(t,function(t,i){return!!mt(e,i)||(U(t,function(t){t(!1,{node:n,format:i,parents:r})}),!1)}).t}(n.get(),a,e,s);n.set(Tt(Tt({},o),l))}(a,t.element,s,o.get())})),u=n,c=r,d=i,f=(l=e).get(),U(u.split(","),function(t){f[t]||(f[t]={similar:d,callbacks:[]}),f[t].callbacks.push(c)}),l.set(f),{unbind:function(){return i=n,o=r,a=(t=e).get(),U(i.split(","),function(t){a[t].callbacks=X(a[t].callbacks,function(t){return t!==o}),0===a[t].callbacks.length&&delete a[t]}),void t.set(a);var t,i,o,a}}}(t,e,n,r,i)}},editor:{getContent:function(e,n){return i=e,o=n,B.from((r=t).getBody()).fold(w("tree"===i.format?new Hf("body",11):""),function(t){return function(t,e,n,r){var i,o,a,s,l;return e.format=n,e.get=!0,e.getInner=!0,e.no_events||t.fire("BeforeGetContent",e),i="raw"===e.format?Me.trim($f(t.serializer,r.innerHTML)):"text"===e.format?t.dom.isEmpty(r)?"":ii(r.innerText||r.textContent):"tree"===e.format?t.serializer.serialize(r,e):(a=(o=t).serializer.serialize(r,e),s=Gl(o),l=new RegExp("^(<"+s+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+s+">[\r\n]*|<br \\/>[\r\n]*)$"),a.replace(l,"")),e.content=W(["text","tree"],e.format)||ti(De(r))?i:Me.trim(i),e.no_events||t.fire("GetContent",e),e.content}(r,i,o,t)});var r,i,o},setContent:function(e,n){return function(t,e,n){return n.format=n.format?n.format:"html",n.set=!0,n.content=Lp(e)?"":e,n.no_events||t.fire("BeforeSetContent",n),Lp(e)||(e=n.content),B.from(t.getBody()).fold(w(e),function(r){return Lp(e)?function(t,e,n,r){!function(t,e,n){var r=function(t,e,n){var r={},i={},o=[];for(var a in n.firstChild&&Rp(n.firstChild,function(n){U(t,function(t){t.name===n.name&&(r[t.name]?r[t.name].nodes.push(n):r[t.name]={filter:t,nodes:[n]})}),U(e,function(t){"string"==typeof n.attr(t.name)&&(i[t.name]?i[t.name].nodes.push(n):i[t.name]={filter:t,nodes:[n]})})}),r)r.hasOwnProperty(a)&&o.push(r[a]);for(var s in i)i.hasOwnProperty(s)&&o.push(i[s]);return o}(t,e,n);U(r,function(t){U(t.filter.callbacks,function(e){e(t.nodes,t.filter.name,{})})})}(t.parser.getNodeFilters(),t.parser.getAttributeFilters(),n);var i=th({validate:t.validate},t.schema).serialize(n);return r.content=ti(De(e))?i:Me.trim(i),Np(t,r.content),r.no_events||t.fire("SetContent",r),n}(t,r,e,n):(i=t,o=r,s=n,0===(a=e).length||/^\s+$/.test(a)?(u='<br data-mce-bogus="1">',"TABLE"===o.nodeName?a="<tr><td>"+u+"</td></tr>":/^(UL|OL)$/.test(o.nodeName)&&(a="<li>"+u+"</li>"),a=(l=Gl(i))&&i.schema.isValidChild(o.nodeName.toLowerCase(),l.toLowerCase())?(a=u,i.dom.createHTML(l,Ul(i),a)):a||'<br data-mce-bogus="1">',Np(i,a),i.fire("SetContent",s)):("raw"!==s.format&&(a=th({validate:i.validate},i.schema).serialize(i.parser.parse(a,{isRootContent:!0,insert:!0}))),s.content=ti(De(o))?a:Me.trim(a),Np(i,s.content),s.no_events||i.fire("SetContent",s)),s.content);var i,o,a,s,l,u})}(t,e,n)},insertContent:function(e,n){return Ep(t,e,n)},addVisual:function(e){return i=(n=t).dom,o=v(r=e)?r:n.getBody(),g(n.hasVisual)&&(n.hasVisual=n.getParam("visual",!0,"boolean")),U(i.select("table,a",o),function(t){switch(t.nodeName){case"TABLE":var e=n.getParam("visual_table_class","mce-item-table","string"),r=i.getAttrib(t,"border");r&&"0"!==r||!n.hasVisual?i.removeClass(t,e):i.addClass(t,e);break;case"A":var o,a;i.getAttrib(t,"href")||(o=i.getAttrib(t,"name")||t.id,a=n.getParam("visual_anchor_class","mce-item-anchor","string"),o&&n.hasVisual?i.addClass(t,a):i.removeClass(t,a))}}),void n.fire("VisualAid",{element:r,hasVisual:n.hasVisual});var n,r,i,o}},selection:{getContent:function(e,n){return qg(t,e,n)}},raw:{getModel:function(){return B.none()}}}},im=function(t){return mt(t.plugins,"rtc")},om=function(t){return t.rtcInstance?t.rtcInstance:rm(t)},am=function(t){var e=t.rtcInstance;if(e)return e;throw new Error("Failed to get RTC instance not yet initialized.")},sm=function(t){return 0===t.dom.length?(hn(t),B.none()):B.some(t)},lm=function(t,e,n,r){t.bind(function(t){return(r?Jh:Kh)(t.dom,r?t.dom.length:0),e.filter(Fe).map(function(e){return i=n,a=t.dom,s=e.dom,l=(o=r)?a.length:s.length,void(o?(Qh(a,s,!1,!o),i.setStart(s,l)):(Qh(s,a,!1,!o),i.setEnd(s,l)));var i,o,a,s,l})}).orThunk(function(){var t;return(t=r,e.filter(function(t){return bd.isBookmarkNode(t.dom)}).bind(t?Xe:qe).or(e).filter(Fe)).map(function(t){return n=r,void Ue(e=t).each(function(t){var r=e.dom;n&&Gh(t,vl(r,0))?Kh(r,0):!n&&Uh(t,vl(r,r.length))&&Jh(r,r.length)});var e,n})})},um=function(t,e,n){var r;t&&t.hasOwnProperty(e)&&(0===(r=X(t[e],function(t){return t!==n})).length?delete t[e]:t[e]=r)},cm=function(t){return!!t.select},dm=function(t){return!(!t||!t.ownerDocument)&&Le(De(t.ownerDocument),De(t))},fm=function(t,e,n,r){var i,o,a,s,l,u,c=function(t,e){return l||(l={},u={},s.on("NodeChange",function(t){var e=t.element,n=a.getParents(e,null,a.getRoot()),r={};Me.each(l,function(t,e){Me.each(n,function(i){if(a.is(i,e))return u[e]||(Me.each(t,function(t){t(!0,{node:i,selector:e,parents:n})}),u[e]=t),r[e]=t,!1})}),Me.each(u,function(t,i){r[i]||(delete u[i],Me.each(t,function(t){t(!1,{node:e,selector:i,parents:n})}))})})),l[t]||(l[t]=[]),l[t].push(e),{unbind:function(){um(l,t,e),um(u,t,e)}}},d=function(t,e){return function(t,e,n){void 0===n&&(n={});var r,i,o=(r=e,Tt(Tt({format:"html"},n),{set:!0,selection:!0,content:r}));o.no_events||!(o=t.fire("BeforeSetContent",o)).isDefaultPrevented()?(n.content=function(t,e){if("raw"===e.format)return e.content;var n=t.selection.getRng(),r=t.dom.getParent(n.commonAncestorContainer,t.dom.isBlock),i=r?{context:r.nodeName.toLowerCase()}:{},o=t.parser.parse(e.content,Tt(Tt({isRootContent:!0,forced_root_block:!1},i),e));return th({validate:t.validate},t.schema).serialize(o)}(t,o),function(t,e){var n=B.from(e.firstChild).map(De),r=B.from(e.lastChild).map(De);t.deleteContents(),t.insertNode(e);var i=n.bind(qe).filter(Fe).bind(sm),o=r.bind(Xe).filter(Fe).bind(sm);lm(i,n,t,!0),lm(o,r,t,!1),t.collapse(!1)}(i=t.selection.getRng(),i.createContextualFragment(n.content)),t.selection.setRng(i),uf(t,i),o.no_events||t.fire("SetContent",o)):t.fire("SetContent",o)}(r,t,e)},f=function(t){var e=p();e.collapse(!!t),g(e)},h=function(){return e.getSelection?e.getSelection():e.document.selection},p=function(){var n,a,s,u=function(t,e,n){try{return e.compareBoundaryPoints(t,n)}catch(u){return-1}},c=e.document;if(void 0!==r.bookmark&&!1===Df(r)){var d=wf(r);if(d.isSome())return d.map(function(t){return Bf(r,[t])[0]}).getOr(c.createRange())}try{(n=h())&&!Mn(n.anchorNode)&&(a=0<n.rangeCount?n.getRangeAt(0):n.createRange?n.createRange():c.createRange(),a=Bf(r,[a])[0])}catch(l){}return(a=a||(c.createRange?c.createRange():c.body.createTextRange())).setStart&&9===a.startContainer.nodeType&&a.collapsed&&(s=t.getRoot(),a.setStart(s,0),a.setEnd(s,0)),i&&o&&(0===u(a.START_TO_START,a,i)&&0===u(a.END_TO_END,a,i)?a=o:o=i=null),a},g=function(t,e){var n;if((a=t)&&(cm(a)||dm(a.startContainer)&&dm(a.endContainer))){var a,s=cm(t)?t:null;if(s){o=null;try{s.select()}catch(l){}}else{var u=h();if(t=r.fire("SetSelectionRange",{range:t,forward:e}).range,u){o=t;try{u.removeAllRanges(),u.addRange(t)}catch(l){}!1===e&&u.extend&&(u.collapse(t.endContainer,t.endOffset),u.extend(t.startContainer,t.startOffset)),i=0<u.rangeCount?u.getRangeAt(0):null}t.collapsed||t.startContainer!==t.endContainer||!u.setBaseAndExtent||be.ie||t.endOffset-t.startOffset<2&&t.startContainer.hasChildNodes()&&(n=t.startContainer.childNodes[t.startOffset])&&"IMG"===n.tagName&&(u.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),u.anchorNode===t.startContainer&&u.focusNode===t.endContainer||u.setBaseAndExtent(n,0,n,1)),r.fire("AfterSetSelectionRange",{range:t,forward:e})}}},m=function(){var e=h(),n=null==e?void 0:e.anchorNode,r=null==e?void 0:e.focusNode;if(!e||!n||!r||Mn(n)||Mn(r))return!0;var i=t.createRng();i.setStart(n,e.anchorOffset),i.collapse(!0);var o=t.createRng();return o.setStart(r,e.focusOffset),o.collapse(!0),i.compareBoundaryPoints(i.START_TO_START,o)<=0},y={bookmarkManager:null,controlSelection:null,dom:a=t,win:e,serializer:n,editor:s=r,collapse:f,setCursorLocation:function(e,n){var i=t.createRng();v(e)&&v(n)?(i.setStart(e,n),i.setEnd(e,n),g(i),f(!1)):(fd(t,i,r.getBody(),!0),g(i))},getContent:function(t){return function(t,e){var n,r;return void 0===e&&(e={}),n=e.format?e.format:"html",r=e,am(t).selection.getContent(n,r)}(r,t)},setContent:d,getBookmark:function(t,e){return x.getBookmark(t,e)},moveToBookmark:function(t){return x.moveToBookmark(t)},select:function(e,n){var r,i;return r=t,i=n,B.from(e).map(function(t){var e=r.nodeIndex(t),n=r.createRng();return n.setStart(t.parentNode,e),n.setEnd(t.parentNode,e+1),i&&(fd(r,n,t,!0),fd(r,n,t,!1)),n}).each(g),e},isCollapsed:function(){var t=p(),e=h();return!(!t||t.item)&&(t.compareEndPoints?0===t.compareEndPoints("StartToEnd",t):!e||t.collapsed)},isForward:m,setNode:function(e){return d(t.getOuterHTML(e)),e},getNode:function(){return function(t,e){var n,r;if(!e)return t;n=e.startContainer,r=e.endContainer;var i=e.startOffset,o=e.endOffset,a=e.commonAncestorContainer;return!e.collapsed&&(n===r&&o-i<2&&n.hasChildNodes()&&(a=n.childNodes[i]),3===n.nodeType&&3===r.nodeType&&(n=n.length===i?Nf(n.nextSibling,!0):n.parentNode,r=0===o?Nf(r.previousSibling,!1):r.parentNode,n&&n===r))?n:a&&3===a.nodeType?a.parentNode:a}(r.getBody(),p())},getSel:h,setRng:g,getRng:p,getStart:function(t){return Rf(r.getBody(),p(),t)},getEnd:function(t){return Lf(r.getBody(),p(),t)},getSelectedBlocks:function(e,n){return function(t,e,n,r){var i,o=[],a=t.getRoot();if(n=t.getParent(n||Rf(a,e,e.collapsed),t.isBlock),r=t.getParent(r||Lf(a,e,e.collapsed),t.isBlock),n&&n!==a&&o.push(n),n&&r&&n!==r)for(var s=new Wr(i=n,a);(i=s.next())&&i!==r;)t.isBlock(i)&&o.push(i);return r&&n!==r&&r!==a&&o.push(r),o}(t,p(),e,n)},normalize:function(){var e=p(),n=h();if(1<ad(n).length||!hd(r))return e;var i=Ld(t,e);return i.each(function(t){g(t,m())}),i.getOr(e)},selectorChanged:function(t,e){return c(t,e),y},selectorChangedWithUnbind:c,getScrollContainer:function(){for(var e,n=t.getRoot();n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){e=n;break}n=n.parentNode}return e},scrollIntoView:function(t,e){var n;((n=r).inline?af:lf)(n,t,e)},placeCaretAt:function(t,e){return g(Ad(t,e,r.getDoc()))},getBoundingClientRect:function(){var t=p();return t.collapsed?vl.fromRangeStart(t).getClientRects()[0]:t.getBoundingClientRect()},destroy:function(){e=i=o=null,b.destroy()}},x=bd(y),b=Td(y,r);return y.bookmarkManager=x,y.controlSelection=b,y},hm=function(t){var e,n=decodeURIComponent(t).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(e=r[1]),{type:e,data:n[1]}},pm=function(t,e){var n;try{n=atob(e)}catch(mS){return B.none()}for(var r=new Uint8Array(n.length),i=0;i<r.length;i++)r[i]=n.charCodeAt(i);return B.some(new Blob([r],{type:t}))},gm=function(t){return 0===t.indexOf("blob:")?(e=t,new Ir(function(t,r){var i=function(){r("Cannot convert "+e+" to Blob. Resource might not exist or is inaccessible.")};try{var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){200===o.status?t(o.response):i()},o.onerror=i,o.send()}catch(n){i()}})):0===t.indexOf("data:")?(n=t,new Ir(function(t){var e=hm(n);pm(e.type,e.data).fold(function(){return t(new Blob([]))},t)})):null;var e,n},mm=0,vm=function(t){return(t||"blobid")+mm++},ym=function(t,e,n,r){(t.padd_empty_with_br||e.insert)&&n[r.name]?r.empty().append(new Hf("br",1)).shortEnded=!0:r.empty().append(new Hf("#text",3)).value=ei},xm=function(t,e){return t&&t.firstChild&&t.firstChild===t.lastChild&&t.firstChild.name===e},bm=function(t,e,n,r){return r.isEmpty(e,n,function(e){return(n=t.getElementRule(e.name))&&n.paddEmpty;var n})},_m=Me.makeMap,wm=Me.each,Sm=Me.explode,Cm=Me.extend,Mm=function(t,e){void 0===e&&(e=ao());var n={},r=[],i={},o={};(t=t||{}).validate=!("validate"in t)||t.validate,t.root_name=t.root_name||"body";var a,s=function(t){var e,a,s=t.name;s in n&&((a=i[s])?a.push(t):i[s]=[t]),e=r.length;for(;e--;)(s=r[e].name)in t.attributes.map&&((a=o[s])?a.push(t):o[s]=[t]);return t},l={schema:e,addAttributeFilter:function(t,e){wm(Sm(t),function(t){for(var n=0;n<r.length;n++)if(r[n].name===t)return void r[n].callbacks.push(e);r.push({name:t,callbacks:[e]})})},getAttributeFilters:function(){return[].concat(r)},addNodeFilter:function(t,e){wm(Sm(t),function(t){var r=n[t];r||(n[t]=r=[]),r.push(e)})},getNodeFilters:function(){var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push({name:e,callbacks:n[e]});return t},filterNode:s,parse:function(a,l){var u,c,d,f,h,p,g,m,v=[];l=l||{},i={},o={};var y,x=Cm(_m("script,style,head,html,body,title,meta,param"),e.getBlockElements()),b=e.getNonEmptyElements(),_=e.children,w=t.validate,S=!1===(y="forced_root_block"in l?l.forced_root_block:t.forced_root_block)?"":!0===y?"p":y,C=e.getWhiteSpaceElements(),M=/^[ \t\r\n]+/,T=/[ \t\r\n]+$/,k=/[ \t\r\n]+/g,A=/^[ \t\r\n]+$/,I=C.hasOwnProperty(l.context)||C.hasOwnProperty(t.root_name),D=function(t,e){var r,o=new Hf(t,e);return t in n&&((r=i[t])?r.push(o):i[t]=[o]),o},O=function(t){for(var n,r,i,o=e.getBlockElements(),a=t.prev;a&&3===a.type;){if(0<(r=a.value.replace(T,"")).length)return void(a.value=r);if(n=a.next){if(3===n.type&&n.value.length){a=a.prev;continue}if(!o[n.name]&&"script"!==n.name&&"style"!==n.name){a=a.prev;continue}}i=a.prev,a.remove(),a=i}},P=Xf({validate:w,allow_html_data_urls:t.allow_html_data_urls,allow_svg_data_urls:t.allow_svg_data_urls,allow_script_urls:t.allow_script_urls,allow_conditional_comments:t.allow_conditional_comments,preserve_cdata:t.preserve_cdata,self_closing_elements:function(t){var e,n={};for(e in t)"li"!==e&&"p"!==e&&(n[e]=t[e]);return n}(e.getSelfClosingElements()),cdata:function(t){m.append(D("#cdata",4)).value=t},text:function(t,e){var n,r;I||(t=t.replace(k," "),(r=m.lastChild)&&(x[r.name]||"br"===r.name)&&(t=t.replace(M,""))),0!==t.length&&((n=D("#text",3)).raw=!!e,m.append(n).value=t)},comment:function(t){m.append(D("#comment",8)).value=t},pi:function(t,e){m.append(D(t,7)).value=e,O(m)},doctype:function(t){m.append(D("#doctype",10)).value=t,O(m)},start:function(t,n,i){var a,s,l,u,c=w?e.getElementRule(t):{};if(c){for((a=D(c.outputName||t,1)).attributes=n,a.shortEnded=i,m.append(a),(u=_[m.name])&&_[a.name]&&!u[a.name]&&v.push(a),s=r.length;s--;)(l=r[s].name)in n.map&&((p=o[l])?p.push(a):o[l]=[a]);x[t]&&O(a),i||(m=a),!I&&C[t]&&(I=!0)}},end:function(n){var r,i,o,a,s,u=w?e.getElementRule(n):{};if(u){if(x[n]&&!I){if((r=m.firstChild)&&3===r.type)if(0<(i=r.value.replace(M,"")).length)r.value=i,r=r.next;else for(o=r.next,r.remove(),r=o;r&&3===r.type;)o=r.next,0!==(i=r.value).length&&!A.test(i)||(r.remove(),r=o),r=o;if((r=m.lastChild)&&3===r.type)if(0<(i=r.value.replace(T,"")).length)r.value=i,r=r.prev;else for(o=r.prev,r.remove(),r=o;r&&3===r.type;)o=r.prev,0!==(i=r.value).length&&!A.test(i)||(r.remove(),r=o),r=o}if(I&&C[n]&&(I=!1),u.removeEmpty&&bm(e,b,C,m))return a=m.parent,x[m.name]?m.empty().remove():m.unwrap(),void(m=a);u.paddEmpty&&(xm(s=m,"#text")&&s.firstChild.value===ei||bm(e,b,C,m))&&ym(t,l,x,m),m=m.parent}}},e),E=m=new Hf(l.context||t.root_name,11);if(P.parse(a,l.format),w&&v.length&&(l.context?l.invalid=!0:function(t){for(var n,r,i,o,a,l,u,c,d,f,h=_m("tr,td,th,tbody,thead,tfoot,table"),p=e.getNonEmptyElements(),g=e.getWhiteSpaceElements(),m=e.getTextBlockElements(),v=e.getSpecialElements(),y=0;y<t.length;y++)if((n=t[y]).parent&&!n.fixed)if(m[n.name]&&"li"===n.parent.name){for(d=n.next;d&&m[d.name];)d.name="li",d.fixed=!0,n.parent.insert(d,n.parent),d=d.next;n.unwrap(n)}else{for(i=[n],r=n.parent;r&&!e.isValidChild(r.name,n.name)&&!h[r.name];r=r.parent)i.push(r);if(r&&1<i.length){for(i.reverse(),o=a=s(i[0].clone()),c=0;c<i.length-1;c++){for(e.isValidChild(a.name,i[c].name)?(l=s(i[c].clone()),a.append(l)):l=a,u=i[c].firstChild;u&&u!==i[c+1];)f=u.next,l.append(u),u=f;a=l}bm(e,p,g,o)?r.insert(n,i[0],!0):(r.insert(o,i[0],!0),r.insert(n,o)),(bm(e,p,g,r=i[0])||xm(r,"br"))&&r.empty().remove()}else if(n.parent){if("li"===n.name){if((d=n.prev)&&("ul"===d.name||"ol"===d.name)){d.append(n);continue}if((d=n.next)&&("ul"===d.name||"ol"===d.name)){d.insert(n,d.firstChild,!0);continue}n.wrap(s(new Hf("ul",1)));continue}e.isValidChild(n.parent.name,"div")&&e.isValidChild("div",n.name)?n.wrap(s(new Hf("div",1))):v[n.name]?n.empty().remove():n.unwrap()}}}(v)),S&&("body"===E.name||l.isRootContent)&&function(){var n,r,i=E.firstChild,o=function(t){t&&((i=t.firstChild)&&3===i.type&&(i.value=i.value.replace(M,"")),(i=t.lastChild)&&3===i.type&&(i.value=i.value.replace(T,"")))};if(e.isValidChild(E.name,S.toLowerCase())){for(;i;)n=i.next,3===i.type||1===i.type&&"p"!==i.name&&!x[i.name]&&!i.attr("data-mce-type")?(r||((r=D(S,1)).attr(t.forced_root_block_attrs),E.insert(r,i)),r.append(i)):(o(r),r=null),i=n;o(r)}}(),!l.invalid){for(g in i)if(i.hasOwnProperty(g)){for(p=n[g],f=(u=i[g]).length;f--;)u[f].parent||u.splice(f,1);for(c=0,d=p.length;c<d;c++)p[c](u,g,l)}for(c=0,d=r.length;c<d;c++)if((p=r[c]).name in o){for(f=(u=o[p.name]).length;f--;)u[f].parent||u.splice(f,1);for(f=0,h=p.callbacks.length;f<h;f++)p.callbacks[f](u,p.name,l)}}return E}};return function(t,e){var n=t.schema;e.remove_trailing_brs&&t.addNodeFilter("br",function(t,r,i){var o,a,s,l,u,c,d,f,h=t.length,p=Me.extend({},n.getBlockElements()),g=n.getNonEmptyElements(),m=n.getWhiteSpaceElements();for(p.body=1,o=0;o<h;o++)if(s=(a=t[o]).parent,p[a.parent.name]&&a===s.lastChild){for(u=a.prev;u;){if("span"!==(c=u.name)||"bookmark"!==u.attr("data-mce-type")){"br"===c&&(a=null);break}u=u.prev}a&&(a.remove(),bm(n,g,m,s)&&(d=n.getElementRule(s.name))&&(d.removeEmpty?s.remove():d.paddEmpty&&ym(e,i,p,s)))}else{for(l=a;s&&s.firstChild===l&&s.lastChild===l&&!p[(l=s).name];)s=s.parent;l===s&&!0!==e.padd_empty_with_br&&((f=new Hf("#text",3)).value=ei,a.replace(f))}}),t.addAttributeFilter("href",function(t){var n,r,i=t.length;if(!e.allow_unsafe_link_target)for(;i--;){var o=t[i];"a"===o.name&&"_blank"===o.attr("target")&&o.attr("rel",(r=(n=o.attr("rel"))?Me.trim(n):"",/\b(noopener)\b/g.test(r)?r:r.split(" ").filter(function(t){return 0<t.length}).concat(["noopener"]).sort().join(" ")))}}),e.allow_html_in_named_anchor||t.addAttributeFilter("id,name",function(t){for(var e,n,r,i,o=t.length;o--;)if("a"===(i=t[o]).name&&i.firstChild&&!i.attr("href"))for(r=i.parent,e=i.lastChild;n=e.prev,r.insert(e,i),e=n;);}),e.fix_list_elements&&t.addNodeFilter("ul,ol",function(t){for(var e,n,r,i=t.length;i--;)"ul"!==(r=(n=t[i]).parent).name&&"ol"!==r.name||(n.prev&&"li"===n.prev.name?n.prev.append(n):((e=new Hf("li",1)).attr("style","list-style-type: none"),n.wrap(e)))}),e.validate&&n.getValidClasses()&&t.addAttributeFilter("class",function(t){for(var e,r,i,o,a,s,l,u=t.length,c=n.getValidClasses();u--;){for(r=(e=t[u]).attr("class").split(" "),a="",i=0;i<r.length;i++)o=r[i],l=!1,(s=c["*"])&&s[o]&&(l=!0),s=c[e.name],!l&&s&&s[o]&&(l=!0),l&&(a&&(a+=" "),a+=o);a.length||(a=null),e.attr("class",a)}}),function(t,e){var n=e.blob_cache,r=function(t){var r,i,o=t.attr("src");(r=t).attr("src")===be.transparentSrc||r.attr("data-mce-placeholder")||t.attr("data-mce-bogus")||((i=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(o))?B.some({type:i[1],data:decodeURIComponent(i[2])}):B.none()).filter(function(){return function(t,e){if(e.images_dataimg_filter){var n=new Image;return n.src=t.attr("src"),lt(t.attributes.map,function(t,e){n.setAttribute(e,t)}),e.images_dataimg_filter(n)}return!0}(t,e)}).bind(function(t){var e=t.type,r=t.data;return B.from(n.getByData(r,e)).orThunk(function(){return pm(e,r).map(function(t){var e=n.create(vm(),t,r);return n.add(e),e})})}).each(function(e){t.attr("src",e.blobUri())})};n&&t.addAttributeFilter("src",function(t){return U(t,r)})}(t,e)}(l,t),(a=t).inline_styles&&function(t,e){var n,r=lo();e.convert_fonts_to_spans&&function(t,e,n){t.addNodeFilter("font",function(t){U(t,function(t){var r,i=e.parse(t.attr("style")),o=t.attr("color"),a=t.attr("face"),s=t.attr("size");o&&(i.color=o),a&&(i["font-family"]=a),s&&(i["font-size"]=n[parseInt(t.attr("size"),10)-1]),t.name="span",t.attr("style",e.serialize(i)),r=t,U(["color","face","size"],function(t){r.attr(t,null)})})})}(t,r,Me.explode(e.font_size_legacy_values)),n=r,t.addNodeFilter("strike",function(t){U(t,function(t){var e=n.parse(t.attr("style"));e["text-decoration"]="line-through",t.name="span",t.attr("style",n.serialize(e))})})}(l,a),l},Tm=function(t,e,n){-1===Me.inArray(e,n)&&(t.addAttributeFilter(n,function(t,e){for(var n=t.length;n--;)t[n].attr(e,null)}),e.push(n))},km=function(t,e){var n=function(t,e){var n=["data-mce-selected"],r=e&&e.dom?e.dom:us.DOM,i=e&&e.schema?e.schema:ao(t);t.entity_encoding=t.entity_encoding||"named",t.remove_trailing_brs=!("remove_trailing_brs"in t)||t.remove_trailing_brs;var o,a,s,l=Mm(t,i);return a=t,s=r,(o=l).addAttributeFilter("data-mce-tabindex",function(t,e){for(var n,r=t.length;r--;)(n=t[r]).attr("tabindex",n.attr("data-mce-tabindex")),n.attr(e,null)}),o.addAttributeFilter("src,href,style",function(t,e){for(var n,r,i=t.length,o="data-mce-"+e,l=a.url_converter,u=a.url_converter_scope;i--;)void 0!==(r=(n=t[i]).attr(o))?(n.attr(e,0<r.length?r:null),n.attr(o,null)):(r=n.attr(e),"style"===e?r=s.serializeStyle(s.parseStyle(r),n.name):l&&(r=l.call(u,r,e,n.name)),n.attr(e,0<r.length?r:null))}),o.addAttributeFilter("class",function(t){for(var e,n,r=t.length;r--;)(n=(e=t[r]).attr("class"))&&(n=e.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),e.attr("class",0<n.length?n:null))}),o.addAttributeFilter("data-mce-type",function(t,e,n){for(var r,i=t.length;i--;)"bookmark"!==(r=t[i]).attr("data-mce-type")||n.cleanup||(B.from(r.firstChild).exists(function(t){return!ri(t.value)})?r.unwrap():r.remove())}),o.addNodeFilter("noscript",function(t){for(var e,n=t.length;n--;)(e=t[n].firstChild)&&(e.value=Zi.decode(e.value))}),o.addNodeFilter("script,style",function(t,e){for(var n,r,i,o=t.length,s=function(t){return t.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};o--;)r=(n=t[o]).firstChild?n.firstChild.value:"","script"===e?((i=n.attr("type"))&&n.attr("type","mce-no/type"===i?null:i.replace(/^mce\-/,"")),"xhtml"===a.element_format&&0<r.length&&(n.firstChild.value="// <![CDATA[\n"+s(r)+"\n// ]]>")):"xhtml"===a.element_format&&0<r.length&&(n.firstChild.value="\x3c!--\n"+s(r)+"\n--\x3e")}),o.addNodeFilter("#comment",function(t){for(var e,n=t.length;n--;)e=t[n],a.preserve_cdata&&0===e.value.indexOf("[CDATA[")?(e.name="#cdata",e.type=4,e.value=s.decode(e.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===e.value.indexOf("mce:protected ")&&(e.name="#text",e.type=3,e.raw=!0,e.value=unescape(e.value).substr(14))}),o.addNodeFilter("xml:namespace,input",function(t,e){for(var n,r=t.length;r--;)7===(n=t[r]).type?n.remove():1===n.type&&("input"!==e||n.attr("type")||n.attr("type","text"))}),o.addAttributeFilter("data-mce-type",function(t){U(t,function(t){"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(o.schema.getNonEmptyElements())?t.remove():t.unwrap())})}),o.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",function(t,e){for(var n=t.length;n--;)t[n].attr(e,null)}),{schema:i,addNodeFilter:l.addNodeFilter,addAttributeFilter:l.addAttributeFilter,serialize:function(n,o){void 0===o&&(o={});var a,s,u,c,d,f,h,p,g,m,v,y=Tt({format:"html"},o),x=function(t,e,n){return i=n,(r=t)&&r.hasEventListeners("PreProcess")&&!i.no_events?function(t,e,n){var r,i,o=t.dom;e=e.cloneNode(!0);var a,s,l=document.implementation;return l.createHTMLDocument&&(r=l.createHTMLDocument(""),Me.each("BODY"===e.nodeName?e.childNodes:[e],function(t){r.body.appendChild(r.importNode(t,!0))}),e="BODY"!==e.nodeName?r.body.firstChild:r.body,i=o.doc,o.doc=r),a=t,s=Tt(Tt({},n),{node:e}),a.fire("PreProcess",s),i&&(o.doc=i),e}(t,e,n):e;var r,i}(e,n,y),b=(a=x,u=ii((s=y).getInner?a.innerHTML:r.getOuterHTML(a)),s.selection||ti(De(a))?u:Me.trim(u)),_=(c=l,d=b,m=(f=y).selection?Tt({forced_root_block:!1},f):f,!(p=function(t){return t&&"br"===t.name})(g=(v=c.parse(d,m)).lastChild)||p(h=g.prev)&&(g.remove(),h.remove()),v);return"tree"===y.format?_:function(t,e,n,r,i){var o,a,s,l,u,c;return a=t,o=r,l=th(e,n).serialize(o),(s=i).no_events||!a?l:(u=a,c=Tt(Tt({},s),{content:l}),u.fire("PostProcess",c).content)}(e,t,i,_,y)},addRules:function(t){i.addValidElements(t)},setRules:function(t){i.setValidElements(t)},addTempAttr:C(Tm,l,n),getTempAttrs:w(n),getNodeFilters:l.getNodeFilters,getAttributeFilters:l.getAttributeFilters}}(t,e);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters}},Am=function(t,e,n){return void 0===n&&(n={}),r=e,i=n,om(t).editor.setContent(r,i);var r,i},Im=us.DOM,Dm=function(t){return B.from(t).each(function(t){return t.destroy()})},Om=Object.prototype.hasOwnProperty,Pm=(ag=function(t,e){return d(t)&&d(e)?Pm(t,e):e},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<t.length;r++){var i=t[r];for(var o in i)Om.call(i,o)&&(n[o]=ag(n[o],i[o]))}return n}),Em=de().deviceType,Rm=Em.isTouch(),Lm=Em.isPhone(),Nm=Em.isTablet(),Bm=["lists","autolink","autosave"],zm={table_grid:!1,object_resizing:!1,resize:!1},Vm=function(t){var e=f(t)?t.join(" "):t,n=G(c(e)?e.split(" "):[],Ht);return X(n,function(t){return 0<t.length})},Fm=function(t,e){return t.sections().hasOwnProperty(e)},Hm=function(t,e){return gt(t,"toolbar_mode").orThunk(function(){return gt(t,"toolbar_drawer").map(function(t){return!1===t?"wrap":t})}).getOr(e)},Wm=function(t,e,n){return B.from(e.settings[n]).filter(t)},jm=(sg={},{add:function(t,e){sg[t]=e},get:function(t){return sg[t]?sg[t]:{icons:{}}},has:function(t){return mt(sg,t)}}),Gm=function(t,e){return e.dom[t]},Um=function(t,e){return parseInt(Kn(e,t),10)},qm=C(Gm,"clientWidth"),Xm=C(Gm,"clientHeight"),Ym=C(Um,"margin-top"),$m=C(Um,"margin-left"),Zm=function(t,e,n){var r,i,o,a,s,l,u,c,d,f,h=De(t.getBody()),p=t.inline?h:De(Ge(h).dom.documentElement),g=(r=t.inline,o=e,a=n,s=(i=p).dom.getBoundingClientRect(),{x:o-(r?s.left+i.dom.clientLeft+$m(i):0),y:a-(r?s.top+i.dom.clientTop+Ym(i):0)});return u=g.x,c=g.y,d=qm(l=p),f=Xm(l),0<=u&&0<=c&&u<=d&&c<=f},Km=function(t){var e,n=[],r=function(){var e,n=t.theme;return n&&n.getNotificationManagerImpl?n.getNotificationManagerImpl():{open:e=function(){throw new Error("Theme did not provide a NotificationManager implementation.")},close:e,reposition:e,getArgs:e}},i=function(){return B.from(n[0])},o=function(){0<n.length&&r().reposition(n)},a=function(t){K(n,function(e){return e===t}).each(function(t){n.splice(t,1)})},s=function(e,s){if(void 0===s&&(s=!0),!t.removed&&function(t){var e=t.inline?t.getBody():t.getContentAreaContainer();return B.from(e).map(De).map(gn).getOr(!1)}(t))return s&&t.fire("BeforeOpenNotification",{notification:e}),Z(n,function(t){return!((n=r().getArgs(t)).type!==(i=e).type||n.text!==i.text||n.progressBar||n.timeout||i.progressBar||i.timeout);var n,i}).getOrThunk(function(){t.editorManager.setActive(t);var s=r().open(e,function(){a(s),o(),i().fold(function(){return t.focus()},function(t){return De(t.getEl()).dom.focus()})});return n.push(s),o(),t.fire("OpenNotification",{notification:Tt({},s)}),s})};return(e=t).on("SkinLoaded",function(){var t=e.getParam("service_message");t&&s({text:t,type:"warning",timeout:0},!1)}),e.on("ResizeEditor ResizeWindow NodeChange",function(){Vr.requestAnimationFrame(o)}),e.on("remove",function(){U(n.slice(),function(t){r().close(t)})}),{open:s,close:function(){i().each(function(t){r().close(t),a(t),o()})},getNotifications:function(){return n}}},Jm=bs.PluginManager,Qm=bs.ThemeManager,tv=function(t){var e=[],n=function(){var e,n=t.theme;return n&&n.getWindowManagerImpl?n.getWindowManagerImpl():{open:e=function(){throw new Error("Theme did not provide a WindowManager implementation.")},openUrl:e,alert:e,confirm:e,close:e,getParams:e,setParams:e}},r=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e?e.apply(t,n):void 0}},i=function(n){t.fire("CloseWindow",{dialog:n}),0===(e=X(e,function(t){return t!==n})).length&&t.focus()},o=function(n){t.editorManager.setActive(t),_f(t);var r=n();return function(n){e.push(n),t.fire("OpenWindow",{dialog:n})}(r),r};return t.on("remove",function(){U(e,function(t){n().close(t)})}),{open:function(t,e){return o(function(){return n().open(t,e,i)})},openUrl:function(t){return o(function(){return n().openUrl(t,i)})},alert:function(t,e,i){var o=n();o.alert(t,r(i||o,e))},confirm:function(t,e,i){var o=n();o.confirm(t,r(i||o,e))},close:function(){B.from(e[e.length-1]).each(function(t){n().close(t),i(t)})}}},ev=function(t,e){t.notificationManager.open({type:"error",text:e})},nv=function(t,e){t._skinLoaded?ev(t,e):t.on("SkinLoaded",function(){ev(t,e)})},rv=function(t,e,n){Sd(t,e,{message:n}),console.error(n)},iv=function(t,e,n){return n?"Failed to load "+t+": "+n+" from url "+e:"Failed to load "+t+" url: "+e},ov=function(t,e,n){rv(t,"PluginLoadError",iv("plugin",e,n))},av=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=window.console;r&&(r.error?r.error.apply(r,kt([t],e)):r.log.apply(r,kt([t],e)))},sv=function(t,e){var n=t.editorManager.baseURL+"/skins/content",r="content"+t.editorManager.suffix+".css",i=!0===t.inline;return G(e,function(e){return/^[a-z0-9\-]+$/i.test(e)&&!i?n+"/"+e+"/"+r:t.documentBaseURI.toAbsolute(e)})},lv=function(){var t={},e=function(t,e){return{status:t,resultUri:e}},n=function(e){return e in t};return{hasBlobUri:n,getResultUri:function(e){var n=t[e];return n?n.resultUri:null},isPending:function(e){return!!n(e)&&1===t[e].status},isUploaded:function(e){return!!n(e)&&2===t[e].status},markPending:function(n){t[n]=e(1,null)},markUploaded:function(n,r){t[n]=e(2,r)},removeFailed:function(e){delete t[e]},destroy:function(){t={}}}},uv=0,cv=function(t){return t+uv+++(e=function(){return Math.round(4294967295*Math.random()).toString(36)},"s"+(new Date).getTime().toString(36)+e()+e()+e());var e},dv=function(t){return function(){return t.notificationManager.open({text:t.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})}},fv=function(t,e){return function(t,e){var n={},r=function(t,n,r,i){var o=new XMLHttpRequest;o.open("POST",e.url),o.withCredentials=e.credentials,o.upload.onprogress=function(t){i(t.loaded/t.total*100)},o.onerror=function(){r("Image upload failed due to a XHR Transport error. Code: "+o.status)},o.onload=function(){var t,i,a;o.status<200||300<=o.status?r("HTTP Error: "+o.status):(t=JSON.parse(o.responseText))&&"string"==typeof t.location?n((a=t.location,(i=e.basePath)?i.replace(/\/$/,"")+"/"+a.replace(/^\//,""):a)):r("Invalid JSON: "+o.responseText)};var a=new FormData;a.append("file",t.blob(),t.filename()),o.send(a)},i=function(t,e){return{url:e,blobInfo:t,status:!0}},o=function(t,e,n){return{url:"",blobInfo:t,status:!1,error:{message:e,options:n}}},a=function(t,e){Me.each(n[t],function(t){t(e)}),delete n[t]};return!1===y(e.handler)&&(e.handler=r),{upload:function(s,l){return e.url||e.handler!==r?function(r,s){return r=Me.grep(r,function(e){return!t.isUploaded(e.blobUri())}),Ir.all(Me.map(r,function(r){return t.isPending(r.blobUri())?(d=r.blobUri(),new Ir(function(t){n[d]=n[d]||[],n[d].push(t)})):(u=e.handler,c=s,t.markPending((l=r).blobUri()),new Ir(function(e){var n;try{var s=function(){n&&n.close()};u(l,function(n){s(),t.markUploaded(l.blobUri(),n),a(l.blobUri(),i(l,n)),e(i(l,n))},function(n,r){var i=r||{};s(),t.removeFailed(l.blobUri()),a(l.blobUri(),o(l,n,i)),e(o(l,n,i))},function(t){t<0||100<t||B.from(n).orThunk(function(){return B.from(c).map(D)}).each(function(e){(n=e).progressBar.value(t)})})}catch(r){e(o(l,r.message,{}))}}));var l,u,c,d}))}(s,l):new Ir(function(t){t([])})}}}(e,{url:t.getParam("images_upload_url","","string"),basePath:t.getParam("images_upload_base_path","","string"),credentials:t.getParam("images_upload_credentials",!1,"boolean"),handler:t.getParam("images_upload_handler",null,"function")})},hv=Me.each,pv=us.DOM,gv=function(t,e){var n,r,i,o=e&&e.schema||ao({}),a=function(t){var e,n,i=pv.create((r="string"==typeof t?{name:t,classes:[],attrs:{}}:t).name);return e=i,(n=r).classes.length&&pv.addClass(e,n.classes.join(" ")),pv.setAttribs(e,n.attrs),i},s=function(t,e,n){var r,i,l,u,c,d,f,h=0<e.length&&e[0],p=h&&h.name,g=(u=p,c="string"!=typeof(l=t)?l.nodeName.toLowerCase():l,!(!(f=(d=o.getElementRule(c))&&d.parentsRequired)||!f.length)&&(u&&-1!==Me.inArray(f,u)?u:f[0]));if(g)p===g?(i=e[0],e=e.slice(1)):i=g;else if(h)i=e[0],e=e.slice(1);else if(!n)return t;return i&&(r=a(i)).appendChild(t),n&&(r||(r=pv.create("div")).appendChild(t),Me.each(n,function(e){var n=a(e);r.insertBefore(n,t)})),s(r,e,i&&i.siblings)};return t&&t.length?(n=a(r=t[0]),(i=pv.create("div")).appendChild(s(n,t.slice(1),r.siblings)),i):""},mv=function(t){var e,n={classes:[],attrs:{}};return"*"!==(t=n.selector=Me.trim(t))&&(e=t.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function(t,e,r,i,o){switch(e){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":-1!==Me.inArray("checked disabled enabled read-only required".split(" "),r)&&(n.attrs[r]=r)}var a;return"["!==i||(a=o.match(/([\w\-]+)(?:\=\"([^\"]+))?/))&&(n.attrs[a[1]]=a[2]),""})),n.name=e||"div",n},vv=function(t,e){var n,r,i,o="",a=(i=t.getParam("preview_styles","font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"),c(i)?i:"");if(""===a)return"";var s=function(t){return t.replace(/%(\w+)/g,"")};if("string"==typeof e){if(!(e=t.formatter.get(e)))return;e=e[0]}if("preview"in e){var l=gt(e,"preview");if(l.is(!1))return"";a=l.getOr(a)}n=e.block||e.inline||"span";var u,d=(u=e.selector)&&"string"==typeof u?(u=(u=u.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),Me.map(u.split(/(?:>|\s+(?![^\[\]]+\]))/),function(t){var e=Me.map(t.split(/(?:~\+|~|\+)/),mv),n=e.pop();return e.length&&(n.siblings=e),n}).reverse()):[],f=d.length?(d[0].name||(d[0].name=n),n=e.selector,gv(d,t)):gv([n],t),h=pv.select(n,f)[0]||f.firstChild;return hv(e.styles,function(t,e){var n=s(t);n&&pv.setStyle(h,e,n)}),hv(e.attributes,function(t,e){var n=s(t);n&&pv.setAttrib(h,e,n)}),hv(e.classes,function(t){var e=s(t);pv.hasClass(h,e)||pv.addClass(h,e)}),t.fire("PreviewFormats"),pv.setStyles(f,{position:"absolute",left:-65535}),t.getBody().appendChild(f),r=pv.getStyle(t.getBody(),"fontSize",!0),r=/px$/.test(r)?parseInt(r,10):0,hv(a.split(" "),function(e){var n=pv.getStyle(h,e,!0);if(!("background-color"===e&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)&&(n=pv.getStyle(t.getBody(),e,!0),"#ffffff"===pv.toHex(n).toLowerCase())||"color"===e&&"#000000"===pv.toHex(n).toLowerCase())){if("font-size"===e&&/em|%$/.test(n)){if(0===r)return;n=parseFloat(n)/(/%$/.test(n)?100:1)*r+"px"}"border"===e&&n&&(o+="padding:0 2px;"),o+=e+":"+n+";"}}),t.fire("AfterPreviewFormats"),pv.remove(f),o},yv=function(t){var e=function(t){var e,n,r={},i=function(t,e){t&&("string"!=typeof t?Me.each(t,function(t,e){i(e,t)}):(f(e)||(e=[e]),Me.each(e,function(t){void 0===t.deep&&(t.deep=!t.selector),void 0===t.split&&(t.split=!t.selector||t.inline),void 0===t.remove&&t.selector&&!t.inline&&(t.remove="none"),t.selector&&t.inline&&(t.mixed=!0,t.block_expand=!0),"string"==typeof t.classes&&(t.classes=t.classes.split(/\s+/))}),r[t]=e))};return i((e=t.dom,n={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all",preserve_attributes:["class","style"]},{inline:"s",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",defaultBlock:"p",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(t,e,n){return Tn(t)&&t.hasAttribute("href")},onformat:function(t,n,r){Me.each(r,function(n,r){e.setAttrib(t,r,n)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]},Me.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),function(t){n[t]={block:t,remove:"all"}}),n)),i(t.getParam("formats")),{get:function(t){return t?r[t]:r},has:function(t){return mt(r,t)},register:i,unregister:function(t){return t&&r[t]&&delete r[t],r}}}(t),n=gs(null);return function(t){t.addShortcut("meta+b","","Bold"),t.addShortcut("meta+i","","Italic"),t.addShortcut("meta+u","","Underline");for(var e=1;e<=6;e++)t.addShortcut("access+"+e,"",["FormatBlock",!1,"h"+e]);t.addShortcut("access+7","",["FormatBlock",!1,"p"]),t.addShortcut("access+8","",["FormatBlock",!1,"div"]),t.addShortcut("access+9","",["FormatBlock",!1,"address"])}(t),function(t){t.on("mouseup keydown",function(e){var n,r,i,o;r=e.keyCode,i=(n=t).selection,o=n.getBody(),Qp(n,null,!1),8!==r&&46!==r||!i.isCollapsed()||i.getStart().innerHTML!==Xp||Qp(n,pc(o,i.getStart())),37!==r&&39!==r||Qp(n,pc(o,i.getStart()))})}(t),{get:e.get,has:e.has,register:e.register,unregister:e.unregister,apply:function(e,n,r){var i,o,a;i=e,o=n,a=r,am(t).formatter.apply(i,o,a)},remove:function(e,n,r,i){var o,a,s,l;o=e,a=n,s=r,l=i,am(t).formatter.remove(o,a,s,l)},toggle:function(e,n,r){var i,o,a;i=e,o=n,a=r,am(t).formatter.toggle(i,o,a)},match:function(e,n,r){return i=e,o=n,a=r,am(t).formatter.match(i,o,a);var i,o,a},closest:function(e){return n=e,am(t).formatter.closest(n);var n},matchAll:function(e,n){return r=e,i=n,am(t).formatter.matchAll(r,i);var r,i},matchNode:function(e,n,r,i){return o=e,a=n,s=r,l=i,am(t).formatter.matchNode(o,a,s,l);var o,a,s,l},canApply:function(e){return n=e,am(t).formatter.canApply(n);var n},formatChanged:function(e,r,i){return o=n,a=e,s=r,void 0===(l=i)&&(l=!1),am(t).formatter.formatChanged(o,a,s,l);var o,a,s,l},getCssText:C(vv,t)}},xv=function(t){var e,n=gs(B.none()),r=gs(0),i=gs(0),o={data:[],typing:!1,beforeChange:function(){var e,i;e=r,i=n,am(t).undoManager.beforeChange(e,i)},add:function(e,a){return s=o,l=i,u=r,c=n,d=e,f=a,am(t).undoManager.addUndoLevel(s,l,u,c,d,f);var s,l,u,c,d,f},undo:function(){return e=o,n=r,a=i,am(t).undoManager.undo(e,n,a);var e,n,a},redo:function(){return e=i,n=o.data,am(t).undoManager.redo(e,n);var e,n},clear:function(){var e,n;e=o,n=i,am(t).undoManager.clear(e,n)},reset:function(){var e;e=o,am(t).undoManager.reset(e)},hasUndo:function(){return e=o,n=i,am(t).undoManager.hasUndo(e,n);var e,n},hasRedo:function(){return e=o,n=i,am(t).undoManager.hasRedo(e,n);var e,n},transact:function(e){return n=o,i=r,a=e,am(t).undoManager.transact(n,i,a);var n,i,a},ignore:function(e){var n,i;n=r,i=e,am(t).undoManager.ignore(n,i)},extra:function(e,n){var r,a,s,l;r=o,a=i,s=e,l=n,am(t).undoManager.extra(r,a,s,l)}};return im(t)||function(t,e,n){var r=gs(!1),i=function(t){em(e,!1,n),e.add({},t)};t.on("init",function(){e.add()}),t.on("BeforeExecCommand",function(t){var r=t.command.toLowerCase();"undo"!==r&&"redo"!==r&&"mcerepaint"!==r&&(nm(e,n),e.beforeChange())}),t.on("ExecCommand",function(t){var e=t.command.toLowerCase();"undo"!==e&&"redo"!==e&&"mcerepaint"!==e&&i(t)}),t.on("ObjectResizeStart cut",function(){e.beforeChange()}),t.on("SaveContent ObjectResized blur",i),t.on("dragend",i),t.on("keyup",function(n){var o=n.keyCode;n.isDefaultPrevented()||((33<=o&&o<=36||37<=o&&o<=40||45===o||n.ctrlKey)&&(i(),t.nodeChanged()),46!==o&&8!==o||t.nodeChanged(),r.get()&&e.typing&&!1===Qg($g(t),e.data[0])&&(!1===t.isDirty()&&(t.setDirty(!0),t.fire("change",{level:e.data[0],lastLevel:null})),t.fire("TypingUndo"),r.set(!1),t.nodeChanged()))}),t.on("keydown",function(t){var o=t.keyCode;t.isDefaultPrevented()||(33<=o&&o<=36||37<=o&&o<=40||45===o?e.typing&&i(t):!(o<16||20<o)||224===o||91===o||e.typing||t.ctrlKey&&!t.altKey||t.metaKey||(e.beforeChange(),em(e,!0,n),e.add({},t),r.set(!0)))}),t.on("mousedown",function(t){e.typing&&i(t)}),t.on("input",function(t){var e,n;t.inputType&&("insertReplacementText"===t.inputType||"insertText"===(n=t).inputType&&null===n.data||"insertFromPaste"===(e=t).inputType||"insertFromDrop"===e.inputType)&&i(t)}),t.on("AddUndo Undo Redo ClearUndos",function(e){e.isDefaultPrevented()||t.nodeChanged()})}(t,o,r),(e=t).addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo"),o},bv=[9,27,Cd.HOME,Cd.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,Cd.DOWN,Cd.UP,Cd.LEFT,Cd.RIGHT].concat(be.browser.isFirefox()?[224]:[]),_v="data-mce-placeholder",wv=function(t){return"keydown"===t.type||"keyup"===t.type},Sv=function(t){var e=t.keyCode;return e===Cd.BACKSPACE||e===Cd.DELETE},Cv=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,Mv=function(t,e){return Pe(De(e),t.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string"))},Tv=function(t,e,n){var r,i,o=(r=t,i=e,X(us.DOM.getParents(n.container(),"*",i),r));return B.from(o[o.length-1])},kv=function(t,e){if(!e)return e;var n=e.container(),r=e.offset();return t?li(n)?Rn(n.nextSibling)?vl(n.nextSibling,0):vl.after(n):di(e)?vl(n,r+1):e:li(n)?Rn(n.previousSibling)?vl(n.previousSibling,n.previousSibling.data.length):vl.before(n):fi(e)?vl(n,r-1):e},Av=C(kv,!0),Iv=C(kv,!1),Dv=function(t,e){return Le(t,e)?Mr(e,function(t){return $r(t)||Kr(t)},(n=t,function(t){return Re(n,De(t.dom.parentNode))})):B.none();var n},Ov=function(t){var e,n,r;t.dom.isEmpty(t.getBody())&&(t.setContent(""),r=(n=(e=t).getBody()).firstChild&&e.dom.isBlock(n.firstChild)?n.firstChild:n,e.selection.setCursorLocation(r,0))},Pv=function(t,e){return{from:t,to:e}},Ev=function(t,e){var n=De(t),r=De(e.container());return Dv(n,r).map(function(t){return{block:t,position:e}})},Rv=function(t){var e,n=(e=Ze(t),K(e,qr).fold(function(){return e},function(t){return e.slice(0,t)}));return U(n,hn),n},Lv=function(t,e){var n=Ch(e,t);return Z(n.reverse(),function(t){return Ei(t)}).each(hn)},Nv=function(t,e,n,r){if(Ei(n))return _h(n),cc(n.dom);0===X(Ye(r),function(t){return!Ei(t)}).length&&Ei(e)&&sn(r,Ae("br"));var i=uc(n.dom,vl.before(r.dom));return U(Rv(e),function(t){sn(r,t)}),Lv(t,e),i},Bv=function(t,e,n){if(Ei(n))return hn(n),Ei(e)&&_h(e),cc(e.dom);var r=dc(n.dom);return U(Rv(e),function(t){cn(n,t)}),Lv(t,e),r},zv=function(t,e){sc(t,e.dom).map(function(t){return t.getNode()}).map(De).filter(Yr).each(hn)},Vv=function(t,e,n){return zv(!0,e),zv(!1,n),function(t,e){return Le(e,t)?(n=Ch(t,e),B.from(n[n.length-1])):B.none();var n}(e,n).fold(C(Bv,t,e,n),C(Nv,t,e,n))},Fv=function(t,e,n,r){return e?Vv(t,r,n):Vv(t,n,r)},Hv=function(t,e){var n,r,i,o=De(t.getBody()),a=(n=o.dom,r=e,((i=t.selection.getRng()).collapsed?function(t,e,n){var r=Ev(t,vl.fromRangeStart(n)),i=r.bind(function(n){return ic(e,t,n.position).bind(function(n){return Ev(t,n).map(function(n){return r=t,i=e,zn((o=n).position.getNode())&&!1===Ei(o.block)?sc(!1,o.block.dom).bind(function(t){return t.isEqual(o.position)?ic(i,r,t).bind(function(t){return Ev(r,t)}):B.some(o)}).getOr(o):o;var r,i,o})})});return Ws(r,i,Pv).filter(function(t){return!1===Re((r=t).from.block,r.to.block)&&Ue((n=t).from.block).bind(function(t){return Ue(n.to.block).filter(function(e){return Re(t,e)})}).isSome()&&!1===Hn((e=t).from.block.dom)&&!1===Hn(e.to.block.dom);var e,n,r})}(n,r,i):B.none()).bind(function(t){return Fv(o,e,t.from.block,t.to.block)}));return a.each(function(e){t.selection.setRng(e.toRange())}),a.isSome()},Wv=function(t,e){var n=De(e),r=C(Re,t);return Cr(n,Qr,r).isSome()},jv=function(t,e){return!t.selection.isCollapsed()&&function(t){var e,n,r,i,o=De(t.getBody());return function(t,e){var n,r,i=uc(t.dom,vl.fromRangeStart(e)).isNone(),o=lc(t.dom,vl.fromRangeEnd(e)).isNone();return!(Wv(n=t,(r=e).startContainer)||Wv(n,r.endContainer))&&i&&o}(o,t.selection.getRng())?((i=t).setContent(""),i.selection.setCursorLocation(),!0):(e=o,r=(n=t.selection).getRng(),Ws(Dv(e,De(r.startContainer)),Dv(e,De(r.endContainer)),function(t,i){return!1===Re(t,i)&&(r.deleteContents(),Fv(e,!0,t,i).each(function(t){n.setRng(t.toRange())}),!0)}).getOr(!1))}(t)},Gv=Fn,Uv=Hn,qv=function(t,e,n,r,i){return B.from(e._selectionOverrides.showCaret(t,n,r,i))},Xv=function(t,e){var n,r;return t.fire("BeforeObjectSelected",{target:e}).isDefaultPrevented()?B.none():B.some(((r=(n=e).ownerDocument.createRange()).selectNode(n),r))},Yv=function(t,e,n){var r=Nu(1,t.getBody(),e),i=vl.fromRangeStart(r),o=i.getNode();if(yu(o))return qv(1,t,o,!i.isAtEnd(),!1);var a=i.getNode(!0);if(yu(a))return qv(1,t,a,!1,!1);var s=t.dom.getParent(i.getNode(),function(t){return Uv(t)||Gv(t)});return yu(s)?qv(1,t,s,!1,n):B.none()},$v=function(t,e,n){return e.collapsed?Yv(t,e,n).getOr(e):e},Zv=function(t){return xh(t)||gh(t)},Kv=function(t){return bh(t)||mh(t)},Jv=function(t,e,n,r,i,o){var a,s;return qv(r,t,o.getNode(!i),i,!0).each(function(n){var r;e.collapsed?(r=e.cloneRange(),i?r.setEnd(n.startContainer,n.startOffset):r.setStart(n.endContainer,n.endOffset),r.deleteContents()):e.deleteContents(),t.selection.setRng(n)}),a=t.dom,Rn(s=n)&&0===s.data.length&&a.remove(s),!0},Qv=function(t,e){var n=t.selection.getRng();if(!Rn(n.commonAncestorContainer))return!1;var r=e?yl.Forwards:yl.Backwards,i=tc(t.getBody()),o=C(Fu,e?i.next:i.prev),a=e?Zv:Kv,s=zu(r,t.getBody(),n),l=kv(e,o(s));if(!l||!Hu(s,l))return!1;if(a(l))return Jv(t,n,s.getNode(),r,e,l);var u=o(l);return!!(u&&a(u)&&Hu(l,u))&&Jv(t,n,s.getNode(),r,e,u)},ty=gr([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),ey=function(t,e,n){return ic(e,t,n).bind(function(r){return u=r.getNode(),Qr(De(u))||Kr(De(u))?B.none():(i=t,s=r,l=function(t){return Xr(De(t))&&!Du(a,s,i)},Bu(!(o=e),a=n).fold(function(){return Bu(o,s).fold(P,l)},l)?B.none():e&&Hn(r.getNode())||!1===e&&Hn(r.getNode(!0))?function(t,e,n,r){var i=r.getNode(!1===e);return Dv(De(t),De(n.getNode())).map(function(t){return Ei(t)?ty.remove(t.dom):ty.moveToElement(i)}).orThunk(function(){return B.some(ty.moveToElement(i))})}(t,e,n,r):e&&bh(n)||!1===e&&xh(n)?B.some(ty.moveToPosition(r)):B.none());var i,o,a,s,l,u})},ny=function(t,e){return B.from(_d(t.getBody(),e))},ry=function(t,e){var n=t.selection.getNode();return ny(t,n).filter(Hn).fold(function(){return n=t.getBody(),r=e,i=t.selection.getRng(),o=Nu(r?1:-1,n,i),a=vl.fromRangeStart(o),s=De(n),(!1===r&&bh(a)?B.some(ty.remove(a.getNode(!0))):r&&xh(a)?B.some(ty.remove(a.getNode())):!1===r&&xh(a)&&Nh(s,a)?Bh(s,a).map(function(t){return ty.remove(t.getNode())}):r&&bh(a)&&Lh(s,a)?zh(s,a).map(function(t){return ty.remove(t.getNode())}):function(t,e,n){return a=n.getNode(!1===(o=e)),s=o?"after":"before",Tn(a)&&a.getAttribute("data-mce-caret")===s?(r=e,i=n.getNode(!1===e),(r&&Hn(i.nextSibling)?B.some(ty.moveToElement(i.nextSibling)):!1===r&&Hn(i.previousSibling)?B.some(ty.moveToElement(i.previousSibling)):B.none()).fold(function(){return ey(t,e,n)},B.some)):ey(t,e,n).bind(function(e){return r=t,i=n,e.fold(function(t){return B.some(ty.remove(t))},function(t){return B.some(ty.moveToElement(t))},function(t){return Du(i,t,r)?B.none():B.some(ty.moveToPosition(t))});var r,i});var r,i,o,a,s}(n,r,a)).exists(function(n){return n.fold(function(t){return a._selectionOverrides.hideFakeCaret(),up(a,s,De(t)),!0},(o=s=e,function(t){var e=o?vl.before(t):vl.after(t);return i.selection.setRng(e.toRange()),!0}),(r=i=a=t,function(t){return r.selection.setRng(t.toRange()),!0}));var r,i,o,a,s});var n,r,i,o,a,s},E)},iy=function(t,e){var n=t.selection.getNode();return!!Hn(n)&&ny(t,n.parentNode).filter(Hn).fold(function(){var n;return n=De(t.getBody()),U(As(n,".mce-offscreen-selection"),hn),up(t,e,De(t.selection.getNode())),Ov(t),!0},E)},oy=function(t){var e,n=t.dom,r=t.selection,i=_d(t.getBody(),r.getNode());return Fn(i)&&n.isBlock(i)&&n.isEmpty(i)&&(e=n.create("br",{"data-mce-bogus":"1"}),n.setHTML(i,""),i.appendChild(e),r.setRng(vl.before(e).toRange())),!0},ay=function(t,e){return(t.selection.isCollapsed()?ry:iy)(t,e)},sy=function(t,e){return!!t.selection.isCollapsed()&&(r=e,i=vl.fromRangeStart((n=t).selection.getRng()),ic(r,n.getBody(),i).filter(function(t){return(r?hh:ph)(t)}).bind(function(t){return B.from(Ou(r?0:-1,t))}).exists(function(t){return n.selection.select(t),!0}));var n,r,i},ly=Rn,uy=function(t){return ly(t)&&t.data[0]===ni},cy=function(t){return ly(t)&&t.data[t.data.length-1]===ni},dy=function(t){return t.ownerDocument.createTextNode(ni)},fy=function(t,e){return(t?function(t){if(ly(t.previousSibling))return cy(t.previousSibling)||t.previousSibling.appendData(ni),t.previousSibling;if(ly(t))return uy(t)||t.insertData(0,ni),t;var e=dy(t);return t.parentNode.insertBefore(e,t),e}:function(t){if(ly(t.nextSibling))return uy(t.nextSibling)||t.nextSibling.insertData(0,ni),t.nextSibling;if(ly(t))return cy(t)||t.appendData(ni),t;var e=dy(t);return t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e),e})(e)},hy=C(fy,!0),py=C(fy,!1),gy=function(t,e){return Rn(t.container())?fy(e,t.container()):fy(e,t.getNode())},my=function(t,e){var n=e.get();return n&&t.container()===n&&li(n)},vy=function(t,e){return e.fold(function(e){du(t.get());var n=hy(e);return t.set(n),B.some(vl(n,n.length-1))},function(e){return cc(e).map(function(e){if(my(e,t))return vl(t.get(),1);du(t.get());var n=gy(e,!0);return t.set(n),vl(n,1)})},function(e){return dc(e).map(function(e){if(my(e,t))return vl(t.get(),t.get().length-1);du(t.get());var n=gy(e,!1);return t.set(n),vl(n,n.length-1)})},function(e){du(t.get());var n=py(e);return t.set(n),B.some(vl(n,1))})},yy=function(t,e){for(var n=0;n<t.length;n++){var r=t[n].apply(null,e);if(r.isSome())return r}return B.none()},xy=gr([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),by=function(t,e){return Iu(e,t)||t},_y=function(t,e,n){var r=Av(n),i=by(e,r.container());return Tv(t,i,r).fold(function(){return lc(i,r).bind(C(Tv,t,i)).map(function(t){return xy.before(t)})},B.none)},wy=function(t,e){return null===pc(t,e)},Sy=function(t,e,n){return Tv(t,e,n).filter(C(wy,e))},Cy=function(t,e,n){var r=Iv(n);return Sy(t,e,r).bind(function(t){return uc(t,r).isNone()?B.some(xy.start(t)):B.none()})},My=function(t,e,n){var r=Av(n);return Sy(t,e,r).bind(function(t){return lc(t,r).isNone()?B.some(xy.end(t)):B.none()})},Ty=function(t,e,n){var r=Iv(n),i=by(e,r.container());return Tv(t,i,r).fold(function(){return uc(i,r).bind(C(Tv,t,i)).map(function(t){return xy.after(t)})},B.none)},ky=function(t){return!1===function(t){return"rtl"===us.DOM.getStyle(t,"direction",!0)||Cv.test(t.textContent)}(Iy(t))},Ay=function(t,e,n){return yy([_y,Cy,My,Ty],[t,e,n]).filter(ky)},Iy=function(t){return t.fold(S,S,S,S)},Dy=function(t){return t.fold(w("before"),w("start"),w("end"),w("after"))},Oy=function(t){return t.fold(xy.before,xy.before,xy.after,xy.after)},Py=function(t){return t.fold(xy.start,xy.start,xy.end,xy.end)},Ey=function(t,e,n,r,i,o){return Ws(Tv(e,n,r),Tv(e,n,i),function(e,r){return e!==r&&(a=r,s=Iu(e,i=n),l=Iu(a,i),s&&s===l)?xy.after(t?e:r):o;var i,a,s,l}).getOr(o)},Ry=function(t,e){return t.fold(E,function(t){return r=e,!(Dy(n=t)===Dy(r)&&Iy(n)===Iy(r));var n,r})},Ly=function(t,e){return t?e.fold(_(B.some,xy.start),B.none,_(B.some,xy.after),B.none):e.fold(B.none,_(B.some,xy.before),B.none,_(B.some,xy.end))},Ny=function(t,e,n,r){var i=kv(t,r),o=Ay(e,n,i);return Ay(e,n,i).bind(C(Ly,t)).orThunk(function(){return a=e,s=n,l=o,u=kv(i=t,r),ic(i,s,u).map(C(kv,i)).fold(function(){return l.map(Oy)},function(t){return Ay(a,s,t).map(C(Ey,i,a,s,u,t)).filter(C(Ry,l))}).filter(ky);var i,a,s,l,u})},By=(C(Ny,!1),C(Ny,!0),function(t,e,n){var r=t?1:-1;return e.setRng(vl(n.container(),n.offset()+r).toRange()),e.getSel().modify("move",t?"forward":"backward","word"),!0});(ug=lg=lg||{})[ug.Br=0]="Br",ug[ug.Block=1]="Block",ug[ug.Wrap=2]="Wrap",ug[ug.Eol=3]="Eol";var zy,Vy,Fy=function(t,e){return t===yl.Backwards?tt(e):e},Hy=function(t,e,n,r){for(var i,o,a,s,l,u=tc(n),c=r,d=[];c&&(s=u,l=c,i=e===yl.Forwards?s.next(l):s.prev(l));){if(zn(i.getNode(!1)))return e===yl.Forwards?{positions:Fy(e,d).concat([i]),breakType:lg.Br,breakAt:B.some(i)}:{positions:Fy(e,d),breakType:lg.Br,breakAt:B.some(i)};if(i.isVisible()){if(t(c,i)){var f=(o=c,zn((a=i).getNode(e===yl.Forwards))?lg.Br:!1===Du(o,a)?lg.Block:lg.Wrap);return{positions:Fy(e,d),breakType:f,breakAt:B.some(i)}}d.push(i),c=i}else c=i}return{positions:Fy(e,d),breakType:lg.Eol,breakAt:B.none()}},Wy=function(t,e,n,r){return e(n,r).breakAt.map(function(r){var i=e(n,r).positions;return t===yl.Backwards?i.concat(r):[r].concat(i)}).getOr([])},jy=function(t,e){return $(t,function(t,n){return t.fold(function(){return B.some(n)},function(r){return Ws(rt(r.getClientRects()),rt(n.getClientRects()),function(t,i){var o=Math.abs(e-t.left);return Math.abs(e-i.left)<=o?n:r}).or(t)})},B.none())},Gy=function(t,e){return rt(e.getClientRects()).bind(function(e){return jy(t,e.left)})},Uy=C(Hy,vl.isAbove,-1),qy=C(Hy,vl.isBelow,1),Xy=C(Wy,-1,Uy),Yy=C(Wy,1,qy),$y=function(t){var e=function(e){return G(e,function(e){return(e=Gs(e)).node=t,e})};if(Tn(t))return e(t.getClientRects());if(Rn(t)){var n=t.ownerDocument.createRange();return n.setStart(t,0),n.setEnd(t,t.data.length),e(n.getClientRects())}},Zy=function(t){return J(t,$y)};(Vy=zy=zy||{})[Vy.Up=-1]="Up",Vy[Vy.Down=1]="Down";var Ky=function(t,e,n,r,i,o){var a=0,s=[],l=function(r){var o,l,c=Zy([r]);for(-1===t&&(c=c.reverse()),o=0;o<c.length;o++)if(!n(l=c[o],u)){if(0<s.length&&e(l,Mt(s))&&a++,l.line=a,i(l))return!0;s.push(l)}},u=Mt(o.getClientRects());if(!u)return s;var c=o.getNode();return l(c),function(t,e,n,r){for(;r=Au(r,t,Ti,e);)if(n(r))return}(t,r,l,c),s},Jy=C(Ky,zy.Up,Xs,Ys),Qy=C(Ky,zy.Down,Ys,Xs),tx=function(t){return function(e){return e.line>t}},ex=function(t){return function(e){return e.line===t}},nx=Hn,rx=Au,ix=function(t,e){return Math.abs(t.left-e)},ox=function(t,e){return Math.abs(t.right-e)},ax=function(t,e){return t>=e.left&&t<=e.right},sx=function(t,e){return t>=e.top&&t<=e.bottom},lx=function(t,e){return St(t,function(t,n){var r=Math.min(ix(t,e),ox(t,e)),i=Math.min(ix(n,e),ox(n,e));return ax(e,n)||!ax(e,t)&&(i===r&&nx(n.node)||i<r)?n:t})},ux=function(t,e,n,r,i){var o=rx(r,t,Ti,e,!i);do{if(!o||n(o))return}while(o=rx(o,t,Ti,e))},cx=function(t,e){t.selection.setRng(e),uf(t,t.selection.getRng())},dx=function(t,e,n){return B.some($v(t,e,n))},fx=function(t,e,n,r,i,o){var a=e===yl.Forwards,s=tc(t.getBody()),l=C(Fu,a?s.next:s.prev),u=a?r:i;if(!n.collapsed){var c=Zs(n);if(o(c))return qv(e,t,c,e===yl.Backwards,!1)}var d=zu(e,t.getBody(),n);if(u(d))return Xv(t,d.getNode(!a));var f=kv(a,l(d)),h=si(n.startContainer);if(!f)return h?B.some(n):B.none();if(u(f))return qv(e,t,f.getNode(!a),a,!1);var p=l(f);return p&&u(p)&&Hu(f,p)?qv(e,t,p.getNode(!a),a,!1):h?dx(t,f.toRange(),!1):B.none()},hx=function(t,e,n,r,i,o){var a=zu(e,t.getBody(),n),s=Mt(a.getClientRects()),l=e===zy.Down;if(!s)return B.none();var u,c=(l?Qy:Jy)(t.getBody(),tx(1),a),d=X(c,ex(1)),f=s.left,h=lx(d,f);if(h&&o(h.node)){var p=Math.abs(f-h.left),g=Math.abs(f-h.right);return qv(e,t,h.node,p<g,!1)}if(u=r(a)?a.getNode():i(a)?a.getNode(!0):Zs(n)){var m=function(t,e,n,r){var i,o,a,s,l=tc(e),u=[],c=0,d=function(t){return Mt(t.getClientRects())},f=1===t?(i=l.next,o=Ys,a=Xs,vl.after(r)):(i=l.prev,o=Xs,a=Ys,vl.before(r)),h=d(f);do{if(f.isVisible()&&!a(s=d(f),h)){if(0<u.length&&o(s,Mt(u))&&c++,(s=Gs(s)).position=f,s.line=c,n(s))return u;u.push(s)}}while(f=i(f));return u}(e,t.getBody(),tx(1),u),v=lx(X(m,ex(1)),f);if(v)return dx(t,v.position.toRange(),!1);if(v=Mt(X(m,ex(0))))return dx(t,v.position.toRange(),!1)}return 0===d.length?px(t,l).filter(l?i:r).map(function(e){return $v(t,e.toRange(),!1)}):B.none()},px=function(t,e){var n=t.selection.getRng(),r=t.getBody();if(e){var i=vl.fromRangeEnd(n),o=qy(r,i);return it(o.positions)}return i=vl.fromRangeStart(n),o=Uy(r,i),rt(o.positions)},gx=function(t,e,n){return px(t,e).filter(n).exists(function(e){return t.selection.setRng(e.toRange()),!0})},mx=function(t,e){var n=t.dom.createRng();n.setStart(e.container(),e.offset()),n.setEnd(e.container(),e.offset()),t.selection.setRng(n)},vx=function(t,e){t?e.setAttribute("data-mce-selected","inline-boundary"):e.removeAttribute("data-mce-selected")},yx=function(t,e,n){return vy(e,n).map(function(e){return mx(t,e),n})},xx=function(t,e,n){return!!eu(t)&&(i=e,o=n,a=(r=t).getBody(),s=vl.fromRangeStart(r.selection.getRng()),l=C(Mv,r),Ny(o,l,a,s).bind(function(t){return yx(r,i,t)}).isSome());var r,i,o,a,s,l},bx=function(t,e,n){return!!eu(e)&&function(t,e){var n=e.selection.getRng(),r=t?vl.fromRangeEnd(n):vl.fromRangeStart(n);return!!y(e.selection.getSel().modify)&&(t&&di(r)?By(!0,e.selection,r):!(t||!fi(r))&&By(!1,e.selection,r))}(t,e)},_x=C(bx,!0),wx=C(bx,!1),Sx=function(t,e,n){if(eu(t)){var r=px(t,e).getOrThunk(function(){var n=t.selection.getRng();return e?vl.fromRangeEnd(n):vl.fromRangeStart(n)});return Ay(C(Mv,t),t.getBody(),r).exists(function(e){var r=Oy(e);return vy(n,r).exists(function(e){return mx(t,e),!0})})}return!1},Cx=function(t,e){return function(n){return vy(e,n).exists(function(e){return mx(t,e),!0})}},Mx=function(t,e,n,r){var i=t.getBody(),o=C(Mv,t);t.undoManager.ignore(function(){var a,s,l;t.selection.setRng((a=n,s=r,(l=document.createRange()).setStart(a.container(),a.offset()),l.setEnd(s.container(),s.offset()),l)),t.execCommand("Delete"),Ay(o,i,vl.fromRangeStart(t.selection.getRng())).map(Py).map(Cx(t,e))}),t.nodeChanged()},Tx=function(t,e,n){if(t.selection.isCollapsed()&&eu(t)){var r=vl.fromRangeStart(t.selection.getRng());return function(t,e,n,r){var i,o,a=(i=t.getBody(),o=r.container(),Iu(o,i)||i),s=C(Mv,t),l=Ay(s,a,r);return l.bind(function(t){return n?t.fold(w(B.some(Py(t))),B.none,w(B.some(Oy(t))),B.none):t.fold(B.none,w(B.some(Oy(t))),B.none,w(B.some(Py(t))))}).map(Cx(t,e)).getOrThunk(function(){var i=oc(n,a,r),o=i.bind(function(t){return Ay(s,a,t)});return Ws(l,o,function(){return Tv(s,a,r).exists(function(e){return!!Ws(cc(r=e),dc(r),function(t,e){var n=kv(!0,t),i=kv(!1,e);return lc(r,n).forall(function(t){return t.isEqual(i)})}).getOr(!0)&&(up(t,n,De(e)),!0);var r})}).orThunk(function(){return o.bind(function(o){return i.map(function(i){return n?Mx(t,e,r,i):Mx(t,e,i,r),!0})})}).getOr(!1)})}(t,e,n,r)}return!1},kx=function(t){return 1===Ze(t).length},Ax=function(t,e){return!!t.selection.isCollapsed()&&function(t,e){var n,r=De(t.getBody()),i=De(t.selection.getStart()),o=X((n=Ch(i,r),K(n,qr).fold(w(n),function(t){return n.slice(0,t)})),kx);return it(o).exists(function(n){var r,i,a,s,l=vl.fromRangeStart(t.selection.getRng());return i=e,a=l,!(!Ws(cc(s=n.dom),dc(s),function(t,e){var n=kv(!0,t),r=kv(!1,e),o=kv(!1,a);return i?lc(s,o).exists(function(t){return t.isEqual(r)&&a.isEqual(n)}):uc(s,o).exists(function(t){return t.isEqual(n)&&a.isEqual(r)})}).getOr(!0)||hc((r=n).dom)&&$p(r.dom)||(function(t,e,n,r){var i,o,a,s,l,u=C(ng,e),c=G(X(r,u),function(t){return t.dom});0===c.length?up(e,t,n):(o=n.dom,a=c,s=Kp(!1),l=eg(a,s.dom),sn(De(o),s),hn(De(o)),i=vl(l,0),e.selection.setRng(i.toRange()))}(e,t,n,o),0))})}(t,e)},Ix=function(t,e,n){return t._selectionOverrides.hideFakeCaret(),up(t,e,De(n)),!0},Dx=function(t,e){return t.selection.isCollapsed()?(s=(a=e)?gh:mh,l=zu(a?yl.Forwards:yl.Backwards,(o=t).getBody(),o.selection.getRng()),s(l)?Ix(o,a,l.getNode(!a)):B.from(kv(a,l)).filter(function(t){return s(t)&&Hu(l,t)}).exists(function(t){return Ix(o,a,t.getNode(!a))})):(r=e,i=(n=t).selection.getNode(),!!jn(i)&&Ix(n,r,i));var n,r,i,o,a,s,l},Ox=function(t){var e=parseInt(t,10);return isNaN(e)?0:e},Px=function(t,e){return(t||"table"===Ne(e)?"margin":"padding")+("rtl"===Kn(e,"direction")?"-right":"-left")},Ex=function(t){var e,n=Lx(t);return!t.mode.isReadOnly()&&(1<n.length||(e=t,Q(n,function(t){var n=Px(Zl(e),t),r=Qn(t,n).map(Ox).getOr(0);return"false"!==e.dom.getContentEditable(t.dom)&&0<r})))},Rx=function(t){return Zr(t)||Kr(t)},Lx=function(t){return X(G(t.selection.getSelectedBlocks(),De),function(t){return!Rx(t)&&!Ue(t).map(Rx).getOr(!1)&&Mr(t,function(t){return Fn(t.dom)||Hn(t.dom)}).exists(function(t){return Fn(t.dom)})})},Nx=function(t,e){var n=t.dom,r=t.selection,i=t.formatter,o=t.getParam("indentation","40px","string"),a=/[a-z%]+$/i.exec(o)[0],s=parseInt(o,10),l=Zl(t),u=Gl(t);t.queryCommandState("InsertUnorderedList")||t.queryCommandState("InsertOrderedList")||""!==u||n.getParent(r.getNode(),n.isBlock)||i.apply("div"),U(Lx(t),function(t){var r,i,o,u,c,d,f;r=n,i=e,o=s,u=a,f=Px(l,De(c=t.dom)),"outdent"===i?(d=Math.max(0,Ox(c.style[f])-o),r.setStyle(c,f,d?d+u:"")):(d=Ox(c.style[f])+o+u,r.setStyle(c,f,d))})},Bx=function(t,e){if(t.selection.isCollapsed()&&Ex(t)){var n=t.dom,r=t.selection.getRng(),i=vl.fromRangeStart(r),o=n.getParent(r.startContainer,n.isBlock);if(null!==o&&Ih(De(o),i))return Nx(t,"outdent"),!0}return!1},zx=function(t,e){t.getDoc().execCommand(e,!1,null)},Vx=function(t){return void 0===t.touches||1!==t.touches.length?B.none():B.some(t.touches[0])},Fx=function(t,e){return t.hasOwnProperty(e.nodeName)},Hx=function(t){var e,n,r,i=t.dom,o=t.selection,a=t.schema,s=a.getBlockElements(),l=o.getStart(),u=t.getBody(),c=Gl(t);if(l&&Tn(l)&&c){var d=u.nodeName.toLowerCase();if(a.isValidChild(d,c.toLowerCase())&&(f=s,h=u,!j(Sh(De(l),De(h)),function(t){return Fx(f,t.dom)}))){var f,h,p,g,m=o.getRng(),v=m.startContainer,y=m.startOffset,x=m.endContainer,b=m.endOffset,_=Df(t);for(l=u.firstChild;l;)if(p=s,Rn(g=l)||Tn(g)&&!Fx(p,g)&&!wc(g)){if(function(t,e){if(Rn(e)){if(0===e.nodeValue.length)return!0;if(/^\s+$/.test(e.nodeValue)&&(!e.nextSibling||Fx(t,e.nextSibling)))return!0}return!1}(s,l)){l=(n=l).nextSibling,i.remove(n);continue}e||(e=i.create(c,Ul(t)),l.parentNode.insertBefore(e,l),r=!0),l=(n=l).nextSibling,e.appendChild(n)}else e=null,l=l.nextSibling;r&&_&&(m.setStart(v,y),m.setEnd(x,b),o.setRng(m),t.nodeChanged())}}},Wx=function(t,e){var n;e.hasAttribute("data-mce-caret")&&(gi(e),(n=t).selection.setRng(n.selection.getRng()),t.selection.scrollIntoView(e))},jx=function(t,e){var n=kr(De(t.getBody()),"*[data-mce-caret]").fold(w(null),function(t){return t.dom});if(n)return"compositionstart"===e.type?(e.preventDefault(),e.stopPropagation(),void Wx(t,n)):void(ci(n)&&(Wx(t,n),t.undoManager.add()))},Gx=Hn,Ux=function(t,e,n){var r,i,o=tc(t.getBody()),a=C(Fu,1===e?o.next:o.prev);if(n.collapsed&&""!==Gl(t)){var s,l=t.dom.getParent(n.startContainer,"PRE");if(!l)return;a(vl.fromRangeStart(n))||(i=(r=t).dom.create(Gl(r)),(!be.ie||11<=be.ie)&&(i.innerHTML='<br data-mce-bogus="1">'),s=i,1===e?t.$(l).after(s):t.$(l).before(s),t.selection.select(s,!0),t.selection.collapse())}},qx=function(t,e){return function(t,e){var n=e?yl.Forwards:yl.Backwards,r=t.selection.getRng();return fx(t,n,r,xh,bh,Gx).orThunk(function(){return Ux(t,n,r),B.none()})}(t,e).exists(function(e){return cx(t,e),!0})},Xx=function(t,e){return function(t,e){var n=e?1:-1,r=t.selection.getRng();return hx(t,n,r,function(t){return xh(t)||vh(t)},function(t){return bh(t)||yh(t)},Gx).orThunk(function(){return Ux(t,n,r),B.none()})}(t,e).exists(function(e){return cx(t,e),!0})},Yx=function(t,e){return gx(t,e,e?bh:xh)},$x=function(t){return W(["figcaption"],Ne(t))},Zx=function(t){var e=document.createRange();return e.setStartBefore(t.dom),e.setEndBefore(t.dom),e},Kx=function(t,e,n){(n?cn:un)(t,e)},Jx=function(t,e){return!!t.selection.isCollapsed()&&function(t,e){var n,r,i=De(t.getBody()),o=vl.fromRangeStart(t.selection.getRng()),a=Gl(t),s=Ul(t);return n=o,r=C(Re,i),Mr(De(n.container()),qr,r).filter($x).exists(function(){if(function(t,e,n){return e?qy(t.dom,n).breakAt.isNone():Uy(t.dom,n).breakAt.isNone()}(i,e,o)){var n=function(t,e,n,r){return""===e?(u=t,c=r,d=Ae("br"),Kx(u,d,c),Zx(d)):(i=t,o=r,a=n,s=Ae(e),l=Ae("br"),Xn(s,a),cn(s,l),Kx(i,s,o),Zx(l));var i,o,a,s,l,u,c,d}(i,a,s,e);return t.selection.setRng(n),!0}return!1})}(t,e)},Qx=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){return t.apply(null,e)}},tb=function(t,e){return Z(function(t,e){return J(G(t,function(t){return Tt({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:b},t)}),function(t){return(r=e).keyCode===(n=t).keyCode&&r.shiftKey===n.shiftKey&&r.altKey===n.altKey&&r.ctrlKey===n.ctrlKey&&r.metaKey===n.metaKey?[t]:[];var n,r})}(t,e),function(t){return t.action()})},eb=function(t,e){var n=e?yl.Forwards:yl.Backwards,r=t.selection.getRng();return fx(t,n,r,gh,mh,jn).exists(function(e){return cx(t,e),!0})},nb=function(t,e){var n=e?1:-1,r=t.selection.getRng();return hx(t,n,r,gh,mh,jn).exists(function(e){return cx(t,e),!0})},rb=function(t,e){return gx(t,e,e?mh:gh)},ib=function(t,e,n,r,i){var o,a,s=As(De(n),"td,th,caption").map(function(t){return t.dom}),l=X(function(t,e){return J(e,function(e){var n,r={left:(n=Gs(e.getBoundingClientRect())).left- -1,top:n.top- -1,right:n.right+-2,bottom:n.bottom+-2,width:n.width+-1,height:n.height+-1};return[{x:r.left,y:t(r),cell:e},{x:r.right,y:t(r),cell:e}]})}(t,s),function(t){return e(t,i)});return o=r,a=i,$(l,function(t,e){return t.fold(function(){return B.some(e)},function(t){var n=Math.sqrt(Math.abs(t.x-o)+Math.abs(t.y-a)),r=Math.sqrt(Math.abs(e.x-o)+Math.abs(e.y-a));return B.some(r<n?e:t)})},B.none()).map(function(t){return t.cell})},ob=C(ib,function(t){return t.bottom},function(t,e){return t.y<e}),ab=C(ib,function(t){return t.top},function(t,e){return t.y>e}),sb=function(t,e,n){var r,i,o,a,s=t(e,n);return(a=s).breakType===lg.Wrap&&0===a.positions.length||!zn(n.getNode())&&(o=s).breakType===lg.Br&&1===o.positions.length?(r=t,i=e,!s.breakAt.exists(function(t){return r(i,t).breakAt.isSome()})):s.breakAt.isNone()},lb=C(sb,Uy),ub=C(sb,qy),cb=function(t,e,n,r){var i,o,a,s,l=t.selection.getRng(),u=e?1:-1;return!(!vu()||(i=e,o=l,a=n,s=vl.fromRangeStart(o),!sc(!i,a).exists(function(t){return t.isEqual(s)}))||(qv(u,t,n,!e,!1).each(function(e){cx(t,e)}),0))},db=function(t,e,n){var r=function(t,e){var n=e.getNode(t);return Tn(n)&&"TABLE"===n.nodeName?B.some(n):B.none()}(!!e,n),i=!1===e;r.fold(function(){return cx(t,n.toRange())},function(r){return sc(i,t.getBody()).filter(function(t){return t.isEqual(n)}).fold(function(){return cx(t,n.toRange())},function(i){return o=e,s=r,l=n,void((u=Gl(a=t))?a.undoManager.transact(function(){var t=Ae(u);Xn(t,Ul(a)),cn(t,Ae("br")),(o?ln:sn)(De(s),t);var e=a.dom.createRng();e.setStart(t.dom,0),e.setEnd(t.dom,0),cx(a,e)}):cx(a,l.toRange()));var o,a,s,l,u})})},fb=function(t,e,n,r){var i,o,a,s,l,u,c=t.selection.getRng(),d=vl.fromRangeStart(c),f=t.getBody();if(!e&&lb(r,d)){var h=(s=f,function(t,e){return rt(e.getClientRects()).bind(function(e){return ob(t,e.left,e.top)}).bind(function(t){return Gy(dc(n=t).map(function(t){return Uy(n,t).positions.concat(t)}).getOr([]),e);var n})}(l=n,u=d).orThunk(function(){return rt(u.getClientRects()).bind(function(t){return jy(Xy(s,vl.before(l)),t.left)})}).getOr(vl.before(l)));return db(t,e,h),!0}return!(!e||!ub(r,d)||(i=f,h=function(t,e){return it(e.getClientRects()).bind(function(e){return ab(t,e.left,e.top)}).bind(function(t){return Gy(cc(n=t).map(function(t){return[t].concat(qy(n,t).positions)}).getOr([]),e);var n})}(o=n,a=d).orThunk(function(){return rt(a.getClientRects()).bind(function(t){return jy(Yy(i,vl.after(o)),t.left)})}).getOr(vl.after(o)),db(t,e,h),0))},hb=function(t,e,n){return B.from(t.dom.getParent(t.selection.getNode(),"td,th")).bind(function(r){return B.from(t.dom.getParent(r,"table")).map(function(i){return n(t,e,i,r)})}).getOr(!1)},pb=function(t,e){return hb(t,e,cb)},gb=function(t,e){return hb(t,e,fb)},mb=function(t,e){var n,r,i=e,o=t.dom,a=t.schema.getMoveCaretBeforeOnEnterElements();if(e){!/^(LI|DT|DD)$/.test(e.nodeName)||(r=function(t){for(;t;){if(1===t.nodeType||3===t.nodeType&&t.data&&/[\r\n\s]/.test(t.data))return t;t=t.nextSibling}}(e.firstChild))&&/^(UL|OL|DL)$/.test(r.nodeName)&&e.insertBefore(o.doc.createTextNode(ei),e.firstChild);var s=o.createRng();if(e.normalize(),e.hasChildNodes()){for(var l=new Wr(e,e);n=l.current();){if(Rn(n)){s.setStart(n,0),s.setEnd(n,0);break}if(a[n.nodeName.toLowerCase()]){s.setStartBefore(n),s.setEndBefore(n);break}i=n,n=l.next()}n||(s.setStart(i,0),s.setEnd(i,0))}else zn(e)?e.nextSibling&&o.isBlock(e.nextSibling)?(s.setStartBefore(e),s.setEndBefore(e)):(s.setStartAfter(e),s.setEndAfter(e)):(s.setStart(e,0),s.setEnd(e,0));t.selection.setRng(s),uf(t,s)}},vb=function(t){return B.from(t.dom.getParent(t.selection.getStart(!0),t.dom.isBlock))},yb=function(t,e){return t&&t.parentNode&&t.parentNode.nodeName===e},xb=function(t){return t&&/^(OL|UL|LI)$/.test(t.nodeName)},bb=function(t){var e=t.parentNode;return/^(LI|DT|DD)$/.test(e.nodeName)?e:t},_b=function(t,e,n){for(var r=t[n?"firstChild":"lastChild"];r&&!Tn(r);)r=r[n?"nextSibling":"previousSibling"];return r===e},wb=function(t){t.innerHTML='<br data-mce-bogus="1">'},Sb=function(t,e){return t.nodeName===e||t.previousSibling&&t.previousSibling.nodeName===e},Cb=function(t,e){return e&&t.isBlock(e)&&!/^(TD|TH|CAPTION|FORM)$/.test(e.nodeName)&&!/^(fixed|absolute)/i.test(e.style.position)&&"true"!==t.getContentEditable(e)},Mb=function(t,e,n){return!1===Rn(e)?n:t?1===n&&e.data.charAt(n-1)===ni?0:n:n===e.data.length-1&&e.data.charAt(n)===ni?e.data.length:n},Tb=function(t,e){for(var n,r=t.getRoot(),i=e;i!==r&&"false"!==t.getContentEditable(i);)"true"===t.getContentEditable(i)&&(n=i),i=i.parentNode;return i!==r?n:r},kb=function(t,e){var n=Gl(t);n&&n.toLowerCase()===e.tagName.toLowerCase()&&function(t,e,n){var r=t.dom;B.from(n.style).map(r.parseStyle).each(function(t){var n=tr(De(e)),i=Tt(Tt({},n),t);r.setStyles(e,i)});var i=B.from(n.class).map(function(t){return t.split(/\s+/)}),o=B.from(e.className).map(function(t){return X(t.split(/\s+/),function(t){return""!==t})});Ws(i,o,function(t,n){var i=X(n,function(e){return!W(t,e)}),o=kt(t,i);r.setAttrib(e,"class",o.join(" "))});var a=["style","class"],s=pt(n,function(t,e){return!W(a,e)});r.setAttribs(e,s)}(t,e,Ul(t))},Ab=function(t,e,n){var r=t.dom.createRng();n?(r.setStartBefore(e),r.setEndBefore(e)):(r.setStartAfter(e),r.setEndAfter(e)),t.selection.setRng(r),uf(t,r)},Ib=function(t,e){var n=Ae("br");sn(De(e),n),t.undoManager.add()},Db=function(t,e){Ob(t.getBody(),e)||ln(De(e),Ae("br"));var n=Ae("br");ln(De(e),n),Ab(t,n.dom,!1),t.undoManager.add()},Ob=function(t,e){return n=vl.after(e),!!zn(n.getNode())||lc(t,vl.after(e)).map(function(t){return zn(t.getNode())}).getOr(!1);var n},Pb=function(t){return t&&"A"===t.nodeName&&"href"in t},Eb=function(t){return t.fold(P,Pb,Pb,P)},Rb=function(t,e){e.fold(b,C(Ib,t),C(Db,t),b)},Lb=function(t,e){var n,r,i,o=(r=C(Mv,n=t),i=vl.fromRangeStart(n.selection.getRng()),Ay(r,n.getBody(),i).filter(Eb));o.isSome()?o.each(C(Rb,t)):function(t,e){var n,r,i=t.dom,o=t.selection.getRng();Ld(i,o).each(function(t){o.setStart(t.startContainer,t.startOffset),o.setEnd(t.endContainer,t.endOffset)});var a,s=o.startOffset,l=o.startContainer;1===l.nodeType&&l.hasChildNodes()&&(a=s>l.childNodes.length-1,l=l.childNodes[Math.min(s,l.childNodes.length-1)]||l,s=a&&3===l.nodeType?l.nodeValue.length:0);var u=i.getParent(l,i.isBlock),c=u?i.getParent(u.parentNode,i.isBlock):null;"LI"!==(c?c.nodeName.toUpperCase():"")||!(!e||!e.ctrlKey)||(u=c),l&&3===l.nodeType&&s>=l.nodeValue.length&&!function(t,e,n){for(var r,i=new Wr(e,n),o=t.getNonEmptyElements();r=i.next();)if(o[r.nodeName.toLowerCase()]||0<r.length)return!0}(t.schema,l,u)&&(n=i.create("br"),o.insertNode(n),o.setStartAfter(n),o.setEndAfter(n),r=!0),n=i.create("br"),_l(i,o,n),Ab(t,n,r),t.undoManager.add()}(t,e)},Nb=function(t,e){return vb(t).filter(function(t){return 0<e.length&&Pe(De(t),e)}).isSome()},Bb=gr([{br:[]},{block:[]},{none:[]}]),zb=function(t,e){return Nb(n=t,n.getParam("no_newline_selector",""));var n},Vb=function(t){return function(e,n){return""===Gl(e)===t}},Fb=function(t){return function(e,n){return vb(e).filter(function(t){return Kr(De(t))}).isSome()===t}},Hb=function(t,e){return function(n,r){return vb(n).fold(w(""),function(t){return t.nodeName.toUpperCase()})===t.toUpperCase()===e}},Wb=function(t){return Hb("pre",t)},jb=function(t){return function(e,n){return e.getParam("br_in_pre",!0)===t}},Gb=function(t,e){return Nb(n=t,n.getParam("br_newline_selector",".mce-toc h2,figcaption,caption"));var n},Ub=function(t,e){return e},qb=function(t){var e=Gl(t),n=function(t,e){for(var n,r=t.getRoot(),i=e;i!==r&&"false"!==t.getContentEditable(i);)"true"===t.getContentEditable(i)&&(n=i),i=i.parentNode;return i!==r?n:r}(t.dom,t.selection.getStart());return n&&t.schema.isValidChild(n.nodeName,e||"P")},Xb=function(t,e){return function(n,r){return $(t,function(t,e){return t&&e(n,r)},!0)?B.some(e):B.none()}},Yb=function(t,e){(function(t,e){return yy([Xb([zb],Bb.none()),Xb([Hb("summary",!0)],Bb.br()),Xb([Wb(!0),jb(!1),Ub],Bb.br()),Xb([Wb(!0),jb(!1)],Bb.block()),Xb([Wb(!0),jb(!0),Ub],Bb.block()),Xb([Wb(!0),jb(!0)],Bb.br()),Xb([Fb(!0),Ub],Bb.br()),Xb([Fb(!0)],Bb.block()),Xb([Vb(!0),Ub,qb],Bb.block()),Xb([Vb(!0)],Bb.br()),Xb([Gb],Bb.br()),Xb([Vb(!1),Ub],Bb.br()),Xb([qb],Bb.block())],[t,!(!e||!e.shiftKey)]).getOr(Bb.none())})(t,e).fold(function(){Lb(t,e)},function(){!function(t,e){var n,r,i,o,a,s,l,u,c,d=t.dom,f=t.schema,h=f.getNonEmptyElements(),p=t.selection.getRng(),g=function(e){var n,i=r,a=f.getTextInlineElements(),s=e||"TABLE"===u||"HR"===u?d.create(e||S):o.cloneNode(!1),l=s;if(!1===t.getParam("keep_styles",!0))d.setAttrib(s,"style",null),d.setAttrib(s,"class",null);else do{if(a[i.nodeName]){if(hc(i)||wc(i))continue;n=i.cloneNode(!1),d.setAttrib(n,"id",""),s.hasChildNodes()?n.appendChild(s.firstChild):l=n,s.appendChild(n)}}while((i=i.parentNode)&&i!==C);return kb(t,s),wb(l),s},m=function(t){var e,n,a=Mb(t,r,i);if(Rn(r)&&(t?0<a:a<r.nodeValue.length))return!1;if(r.parentNode===o&&c&&!t)return!0;if(t&&Tn(r)&&r===o.firstChild)return!0;if(Sb(r,"TABLE")||Sb(r,"HR"))return c&&!t||!c&&t;var s=new Wr(r,o);for(Rn(r)&&(t&&0===a?s.prev():t||a!==r.nodeValue.length||s.next());e=s.current();){if(Tn(e)){if(!e.getAttribute("data-mce-bogus")&&(n=e.nodeName.toLowerCase(),h[n]&&"br"!==n))return!1}else if(Rn(e)&&!Ai(e.nodeValue))return!1;t?s.prev():s.next()}return!0},v=function(){a=/^(H[1-6]|PRE|FIGURE)$/.test(u)&&"HGROUP"!==b?g(S):g(),t.getParam("end_container_on_empty_block",!1)&&Cb(d,l)&&d.isEmpty(o)?a=d.split(l,o):d.insertAfter(a,o),mb(t,a)};Ld(d,p).each(function(t){p.setStart(t.startContainer,t.startOffset),p.setEnd(t.endContainer,t.endOffset)}),r=p.startContainer,i=p.startOffset,S=Gl(t);var y=!(!e||!e.shiftKey),x=!(!e||!e.ctrlKey);Tn(r)&&r.hasChildNodes()&&(c=i>r.childNodes.length-1,r=r.childNodes[Math.min(i,r.childNodes.length-1)]||r,i=c&&Rn(r)?r.nodeValue.length:0);var b,_,w,S,C=Tb(d,r);C&&((S&&!y||!S&&y)&&(r=function(t,e,n,r,i){var o,a,s,l,u,c,d=e||"P",f=t.dom,h=Tb(f,r),p=f.getParent(r,f.isBlock);if(!p||!Cb(f,p)){if(u=(p=p||h)===t.getBody()||(c=p)&&/^(TD|TH|CAPTION)$/.test(c.nodeName)?p.nodeName.toLowerCase():p.parentNode.nodeName.toLowerCase(),!p.hasChildNodes())return o=f.create(d),kb(t,o),p.appendChild(o),n.setStart(o,0),n.setEnd(o,0),o;for(s=r;s.parentNode!==p;)s=s.parentNode;for(;s&&!f.isBlock(s);)s=(a=s).previousSibling;if(a&&t.schema.isValidChild(u,d.toLowerCase())){for(o=f.create(d),kb(t,o),a.parentNode.insertBefore(o,a),s=a;s&&!f.isBlock(s);)l=s.nextSibling,o.appendChild(s),s=l;n.setStart(r,i),n.setEnd(r,i)}}return r}(t,S,p,r,i)),o=d.getParent(r,d.isBlock),l=o?d.getParent(o.parentNode,d.isBlock):null,u=o?o.nodeName.toUpperCase():"","LI"!==(b=l?l.nodeName.toUpperCase():"")||x||(l=(o=l).parentNode,u=b),/^(LI|DT|DD)$/.test(u)&&d.isEmpty(o)?function(t,e,n,r,i){var o,a,s,l,u,c,d,f,h=t.dom,p=t.selection.getRng();n!==t.getBody()&&(xb(o=n)&&xb(o.parentNode)&&(i="LI"),a=i?e(i):h.create("BR"),_b(n,r,!0)&&_b(n,r,!1)?yb(n,"LI")?(s=bb(n),h.insertAfter(a,s),(null===(f=(d=n).parentNode)||void 0===f?void 0:f.firstChild)===d?h.remove(s):h.remove(n)):h.replace(a,n):(_b(n,r,!0)?yb(n,"LI")?(h.insertAfter(a,bb(n)),a.appendChild(h.doc.createTextNode(" ")),a.appendChild(n)):n.parentNode.insertBefore(a,n):_b(n,r,!1)?h.insertAfter(a,bb(n)):(n=bb(n),(l=p.cloneRange()).setStartAfter(r),l.setEndAfter(n),u=l.extractContents(),"LI"===i&&(c=u).firstChild&&"LI"===c.firstChild.nodeName?(a=u.firstChild,h.insertAfter(u,n)):(h.insertAfter(u,n),h.insertAfter(a,n))),h.remove(r)),mb(t,a))}(t,g,l,o,S):S&&o===t.getBody()||(S=S||"P",si(o)?(a=gi(o),d.isEmpty(o)&&wb(o),kb(t,a),mb(t,a)):m()?v():m(!0)?(a=o.parentNode.insertBefore(g(),o),mb(t,Sb(o,"HR")?a:o)):((w=(_=p).cloneRange()).setStart(_.startContainer,Mb(!0,_.startContainer,_.startOffset)),w.setEnd(_.endContainer,Mb(!1,_.endContainer,_.endOffset)),(n=w.cloneRange()).setEndAfter(o),s=n.extractContents(),U(ks(De(s),Fe),function(t){var e=t.dom;e.nodeValue=ii(e.nodeValue)}),function(t){for(;Rn(t)&&(t.nodeValue=t.nodeValue.replace(/^[\r\n]+/,"")),t=t.firstChild;);}(s),a=s.firstChild,d.insertAfter(s,o),function(t,e,n){var r,i,o=n,a=[];if(o){for(;o=o.firstChild;){if(t.isBlock(o))return;Tn(o)&&!e[o.nodeName.toLowerCase()]&&a.push(o)}for(r=a.length;r--;)(!(o=a[r]).hasChildNodes()||o.firstChild===o.lastChild&&""===o.firstChild.nodeValue||(i=o)&&"A"===i.nodeName&&t.isEmpty(i))&&t.remove(o)}}(d,h,a),function(t,e){e.normalize();var n=e.lastChild;n&&!/^(left|right)$/gi.test(t.getStyle(n,"float",!0))||t.add(e,"br")}(d,o),d.isEmpty(o)&&wb(o),a.normalize(),d.isEmpty(a)?(d.remove(a),v()):(kb(t,a),mb(t,a))),d.setAttrib(a,"id",""),t.fire("NewBlock",{newBlock:a})))}(t,e)},b)},$b=de().browser,Zb=de(),Kb=function(t){return t.stopImmediatePropagation()},Jb=function(t){return t.keyCode===Cd.PAGE_UP||t.keyCode===Cd.PAGE_DOWN},Qb=function(t,e,n){n&&!t.get()?e.on("NodeChange",Kb,!0):!n&&t.get()&&e.off("NodeChange",Kb),t.set(n)},t_=function(t,e){var n=e.container(),r=e.offset();return Rn(n)?(n.insertData(r,t),B.some(vl(n,r+t.length))):Vu(e).map(function(n){var r=Ie(t);return(e.isAtEnd()?ln:sn)(n,r),vl(r.dom,t.length)})},e_=C(t_,ei),n_=C(t_," "),r_=function(t){var e,n,r=vl.fromRangeStart(t.selection.getRng()),i=De(t.getBody());if(t.selection.isCollapsed()){var o=C(Mv,t),a=vl.fromRangeStart(t.selection.getRng());return Ay(o,t.getBody(),a).bind((n=i,function(t){return t.fold(function(t){return uc(n.dom,vl.before(t))},function(t){return cc(t)},function(t){return dc(t)},function(t){return lc(n.dom,vl.after(t))})})).bind(function(t,e){return function(n){return r=t,(!jh(i=n)&&(function(t,e){return uc(t.dom,e).isNone()||lc(t.dom,e).isNone()||Ih(t,e)||Dh(t,e)||Nh(t,e)||Lh(t,e)}(r,i)||Hh(r,i)||Wh(r,i))?e_:n_)(e);var r,i}}(i,r)).exists((e=t,function(t){return e.selection.setRng(t.toRange()),e.nodeChanged(),!0}))}return!1},i_=(o_.prototype.nodeChanged=function(t){var e,n,r,i=this.editor.selection;this.editor.initialized&&i&&!this.editor.getParam("disable_nodechange")&&!this.editor.mode.isReadOnly()&&(r=this.editor.getBody(),(e=i.getStart(!0)||r).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(e,r)||(e=r),n=[],this.editor.dom.getParent(e,function(t){return t===r||void n.push(t)}),(t=t||{}).element=e,t.parents=n,this.editor.fire("NodeChange",t))},o_.prototype.isSameElementPath=function(t){var e,n=this.editor.$(t).parentsUntil(this.editor.getBody()).add(t);if(n.length===this.lastPath.length){for(e=n.length;0<=e&&n[e]===this.lastPath[e];e--);if(-1===e)return this.lastPath=n,!0}return this.lastPath=n,!1},o_);function o_(t){var e;this.lastPath=[],this.editor=t;var n=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",function(n){var r=t.selection.getRng(),i={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};"nodechange"!==n.type&&Id(i,e)||t.fire("SelectionChange"),e=i}),t.on("contextmenu",function(){t.fire("SelectionChange")}),t.on("SelectionChange",function(){var e=t.selection.getStart(!0);!e||!be.range&&t.selection.isCollapsed()||hd(t)&&!n.isSameElementPath(e)&&t.dom.isChildOf(e,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",function(e){!e.isDefaultPrevented()&&hd(t)&&("IMG"===t.selection.getNode().nodeName?Vr.setEditorTimeout(t,function(){t.nodeChanged()}):t.nodeChanged())})}var a_=function(t){return Tn(t)&&$r(De(t))},s_=function(t){var e=t.getBoundingClientRect(),n=t.ownerDocument,r=n.documentElement,i=n.defaultView;return{top:e.top+i.pageYOffset-r.clientTop,left:e.left+i.pageXOffset-r.clientLeft}},l_=function(t,e){return n=(s=t).inline?s_(s.getBody()):{left:0,top:0},a=(o=t).getBody(),r=o.inline?{left:a.scrollLeft,top:a.scrollTop}:{left:0,top:0},{pageX:(i=function(t,e){if(e.target.ownerDocument===t.getDoc())return{left:e.pageX,top:e.pageY};var n,r,i,o=s_(t.getContentAreaContainer()),a=(r=(n=t).getBody(),i=n.getDoc().documentElement,n.inline?{left:r.scrollLeft,top:r.scrollTop}:{left:r.scrollLeft||i.scrollLeft,top:r.scrollTop||i.scrollTop});return{left:e.pageX-o.left+a.left,top:e.pageY-o.top+a.top}}(t,e)).left-n.left+r.left,pageY:i.top-n.top+r.top};var n,r,i,o,a,s},u_=Hn,c_=Fn,d_=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},f_=function(t){t.on(function(t){d_(t.ghost)}),t.clear()},h_=Fn,p_=Hn,g_=function(t,e){return _d(t.getBody(),e)},m_=us.DOM,v_=function(t){return pt(t,function(t){return!1===g(t)})},y_=function(t){var e,n=t.settings,r=t.editorUpload.blobCache;return v_({allow_conditional_comments:n.allow_conditional_comments,allow_html_data_urls:n.allow_html_data_urls,allow_svg_data_urls:n.allow_svg_data_urls,allow_html_in_named_anchor:n.allow_html_in_named_anchor,allow_script_urls:n.allow_script_urls,allow_unsafe_link_target:n.allow_unsafe_link_target,convert_fonts_to_spans:n.convert_fonts_to_spans,fix_list_elements:n.fix_list_elements,font_size_legacy_values:n.font_size_legacy_values,forced_root_block:n.forced_root_block,forced_root_block_attrs:n.forced_root_block_attrs,padd_empty_with_br:n.padd_empty_with_br,preserve_cdata:n.preserve_cdata,remove_trailing_brs:n.remove_trailing_brs,inline_styles:n.inline_styles,root_name:(e=t).inline?e.getElement().nodeName.toLowerCase():void 0,validate:!0,blob_cache:r,images_dataimg_filter:n.images_dataimg_filter})},x_=function(t){return t.inline?t.ui.styleSheetLoader:t.dom.styleSheetLoader},b_=function(t){var e=t.settings,n=t.getDoc(),r=t.getBody();e.browser_spellcheck||e.gecko_spellcheck||(n.body.spellcheck=!1,m_.setAttrib(r,"spellcheck","false")),t.quirks=function(t){var e,n,r=Me.each,i=Cd.BACKSPACE,o=Cd.DELETE,a=t.dom,s=t.selection,l=t.parser,u=be.gecko,c=be.webkit,d="data:text/mce-internal,",f=be.ie?"Text":"URL",h=function(n,r){try{t.getDoc().execCommand(n,!1,r)}catch(e){}},p=function(t){return t.isDefaultPrevented()},g=function(){t.shortcuts.add("meta+a",null,"SelectAll")},m=function(){Range.prototype.getClientRects||t.on("mousedown",function(e){var n;p(e)||"HTML"!==e.target.nodeName||((n=t.getBody()).blur(),Vr.setEditorTimeout(t,function(){n.focus()}))})},v=function(){t.on("click",function(e){var n=e.target;/^(IMG|HR)$/.test(n.nodeName)&&"false"!==a.getContentEditableParent(n)&&(e.preventDefault(),t.selection.select(n),t.nodeChanged()),"A"===n.nodeName&&a.hasClass(n,"mce-item-anchor")&&(e.preventDefault(),s.select(n))})},y=function(){t.on("keydown",function(t){if(!p(t)&&t.keyCode===i&&s.isCollapsed()&&0===s.getRng().startOffset){var e=s.getNode().previousSibling;if(e&&e.nodeName&&"table"===e.nodeName.toLowerCase())return t.preventDefault(),!1}})},x=function(){t.getParam("readonly")||t.on("BeforeExecCommand mousedown",function(){h("StyleWithCSS",!1),h("enableInlineTableEditing",!1),Jl(t)||h("enableObjectResizing",!1)})},_=function(){t.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},w=function(){t.inline||t.on("keydown",function(){document.activeElement===document.body&&t.getWin().focus()})},S=function(){t.inline||(t.contentStyles.push("body {min-height: 150px}"),t.on("click",function(e){var n;if("HTML"===e.target.nodeName){if(11<be.ie)return void t.getBody().focus();n=t.selection.getRng(),t.getBody().focus(),t.selection.setRng(n),t.selection.normalize(),t.nodeChanged()}}))},C=function(){be.mac&&t.on("keydown",function(e){!Cd.metaKeyPressed(e)||e.shiftKey||37!==e.keyCode&&39!==e.keyCode||(e.preventDefault(),t.selection.getSel().modify("move",37===e.keyCode?"backward":"forward","lineboundary"))})},M=function(){t.on("click",function(t){var e=t.target;do{if("A"===e.tagName)return void t.preventDefault()}while(e=e.parentNode)}),t.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},T=function(){t.on("init",function(){t.dom.bind(t.getBody(),"submit",function(t){t.preventDefault()})})},k=b;return im(t)?(c&&(v(),T(),g(),be.iOS&&(w(),S(),M())),u&&(m(),x(),_(),C())):(t.on("keydown",function(e){var n;if(!p(e)&&e.keyCode===Cd.BACKSPACE){var r=(n=s.getRng()).startContainer,i=n.startOffset,o=a.getRoot(),l=r;if(n.collapsed&&0===i){for(;l&&l.parentNode&&l.parentNode.firstChild===l&&l.parentNode!==o;)l=l.parentNode;"BLOCKQUOTE"===l.tagName&&(t.formatter.toggle("blockquote",null,l),(n=a.createRng()).setStart(r,0),n.setEnd(r,0),s.setRng(n))}}}),function(){var e=function(t){var e=a.create("body"),n=t.cloneContents();return e.appendChild(n),s.serializer.serialize(e,{format:"html"})};t.on("keydown",function(n){var r,s,l,u,c,d=n.keyCode;if(!p(n)&&(d===o||d===i)){if(r=t.selection.isCollapsed(),s=t.getBody(),r&&!a.isEmpty(s))return;if(!r&&(l=t.selection.getRng(),u=e(l),(c=a.createRng()).selectNode(t.getBody()),u!==e(c)))return;n.preventDefault(),t.setContent(""),s.firstChild&&a.isBlock(s.firstChild)?t.selection.setCursorLocation(s.firstChild,0):t.selection.setCursorLocation(s,0),t.nodeChanged()}})}(),be.windowsPhone||t.on("keyup focusin mouseup",function(t){Cd.modifierPressed(t)||s.normalize()},!0),c&&(t.inline||a.bind(t.getDoc(),"mousedown mouseup",function(e){var n;if(e.target===t.getDoc().documentElement)if(n=s.getRng(),t.getBody().focus(),"mousedown"===e.type){if(ui(n.startContainer))return;s.placeCaretAt(e.clientX,e.clientY)}else s.setRng(n)}),v(),Gl(t)&&t.on("init",function(){h("DefaultParagraphSeparator",Gl(t))}),T(),y(),l.addNodeFilter("br",function(t){for(var e=t.length;e--;)"Apple-interchange-newline"===t[e].attr("class")&&t[e].remove()}),be.iOS?(w(),S(),M()):g()),11<=be.ie&&(S(),y()),be.ie&&(g(),h("AutoUrlDetect",!1),t.on("dragstart",function(e){var n,r,i;(n=e).dataTransfer&&(t.selection.isCollapsed()&&"IMG"===n.target.tagName&&s.select(n.target),0<(r=t.selection.getContent()).length&&(i=d+escape(t.id)+","+escape(r),n.dataTransfer.setData(f,i)))}),t.on("drop",function(e){var n,r,i,o,a;p(e)||(n=(o=e).dataTransfer&&(a=o.dataTransfer.getData(f))&&0<=a.indexOf(d)?(a=a.substr(d.length).split(","),{id:unescape(a[0]),html:unescape(a[1])}):null)&&n.id!==t.id&&(e.preventDefault(),r=Ad(e.x,e.y,t.getDoc()),s.setRng(r),i=n.html,t.queryCommandSupported("mceInsertClipboardContent")?t.execCommand("mceInsertClipboardContent",!1,{content:i,internal:!0}):t.execCommand("mceInsertContent",!1,i))})),u&&(t.on("keydown",function(e){if(!p(e)&&e.keyCode===i){if(!t.getBody().getElementsByTagName("hr").length)return;if(s.isCollapsed()&&0===s.getRng().startOffset){var n=s.getNode(),r=n.previousSibling;if("HR"===n.nodeName)return a.remove(n),void e.preventDefault();r&&r.nodeName&&"hr"===r.nodeName.toLowerCase()&&(a.remove(r),e.preventDefault())}}}),m(),e=function(){var e=a.getAttribs(s.getStart().cloneNode(!1));return function(){var n=s.getStart();n!==t.getBody()&&(a.setAttrib(n,"style",null),r(e,function(t){n.setAttributeNode(t.cloneNode(!0))}))}},n=function(){return!s.isCollapsed()&&a.getParent(s.getStart(),a.isBlock)!==a.getParent(s.getEnd(),a.isBlock)},t.on("keypress",function(r){var i;if(!p(r)&&(8===r.keyCode||46===r.keyCode)&&n())return i=e(),t.getDoc().execCommand("delete",!1,null),i(),r.preventDefault(),!1}),a.bind(t.getDoc(),"cut",function(r){var i;!p(r)&&n()&&(i=e(),Vr.setEditorTimeout(t,function(){i()}))}),x(),t.on("SetContent ExecCommand",function(t){"setcontent"!==t.type&&"mceInsertLink"!==t.command||r(a.select("a"),function(t){var e=t.parentNode,n=a.getRoot();if(e.lastChild===t){for(;e&&!a.isBlock(e);){if(e.parentNode.lastChild!==e||e===n)return;e=e.parentNode}a.add(e,"br",{"data-mce-bogus":1})}})}),_(),C(),y())),{refreshContentEditable:k,isHidden:function(){if(!u||t.removed)return!1;var e=t.selection.getSel();return!e||!e.rangeCount||0===e.rangeCount}}}(t),t.fire("PostRender");var i,o,a,s,l,u,c=t.getParam("directionality",xs.isRtl()?"rtl":void 0);void 0!==c&&(r.dir=c),e.protect&&t.on("BeforeSetContent",function(t){Me.each(e.protect,function(e){t.content=t.content.replace(e,function(t){return"\x3c!--mce:protected "+escape(t)+"--\x3e"})})}),t.on("SetContent",function(){t.addVisual(t.getBody())}),im(t)||t.load({initial:!0,format:"html"}),t.startContent=t.getContent({format:"raw"}),t.on("compositionstart compositionend",function(e){t.composing="compositionstart"===e.type}),0<t.contentStyles.length&&(i="",Me.each(t.contentStyles,function(t){i+=t+"\r\n"}),t.dom.addStyle(i)),function(t,e){var n,r,i,o,a=x_(t),s=Kl(t),l=function(){a.unloadAll(e),t.inline||t.ui.styleSheetLoader.unloadAll(s)},u=function(){t.removed?l():(t.on("remove",l),function(t){var e;t.bindPendingEventDelegates(),t.initialized=!0,t.fire("Init"),t.focus(!0),function(t){var e=t.dom.getRoot();t.inline||hd(t)&&t.selection.getStart(!0)!==e||cc(e).each(function(e){var n,r,i,o,a=e.getNode(),s=On(a)?cc(a).getOr(e):e;be.browser.isIE()?(n=t,r=s.toRange(),i=De(n.getBody()),o=(yf(n)?B.from(r):B.none()).map(xf).filter(vf(i)),n.bookmark=o.isSome()?o:n.bookmark):t.selection.setRng(s.toRange())})}(t),t.nodeChanged({initial:!0}),t.execCallback("init_instance_callback",t),(e=t).settings.auto_focus&&Vr.setEditorTimeout(e,function(){var t=!0===e.settings.auto_focus?e:e.editorManager.get(e.settings.auto_focus);t.destroyed||t.focus()},100)}(t))};Ir.all((n=t,r=e,i=s,o=[new Ir(function(t,e){return x_(n).loadAll(r,t,e)})],n.inline?o:o.concat([new Ir(function(t,e){return n.ui.styleSheetLoader.loadAll(i,t,e)})]))).then(u).catch(u)}(t,t.contentCSS),e.content_style&&(a=e.content_style,s=De((o=t).getBody()),l=on(rn(s)),u=Ae("style"),qn(u,"type","text/css"),cn(u,Ie(a)),cn(l,u),o.on("remove",function(){hn(u)}))},__=function(t,e){var n=t.settings,r=t.getElement(),i=t.getDoc();n.inline||(t.getElement().style.visibility=t.orgVisibility),e||t.inline||(i.open(),i.write(t.iframeHTML),i.close()),t.inline&&(m_.addClass(r,"mce-content-body"),t.contentDocument=i=document,t.contentWindow=window,t.bodyElement=r,t.contentAreaContainer=r);var o,a,s,l,u=t.getBody();u.disabled=!0,t.readonly=!!n.readonly,t.readonly||(t.inline&&"static"===m_.getStyle(u,"position",!0)&&(u.style.position="relative"),u.contentEditable=t.getParam("content_editable_state",!0)),u.disabled=!1,t.editorUpload=function(t){var e,n,r,i,o,a,s=(e=[],n=function(t){if(!t.blob||!t.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");var e=t.id||cv("blobid"),n=t.name||e,r=t.blob;return{id:w(e),name:w(n),filename:w(t.filename||n+"."+({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[r.type.toLowerCase()]||"dat")),blob:w(r),base64:w(t.base64),blobUri:w(t.blobUri||URL.createObjectURL(r)),uri:w(t.uri)}},{create:function(t,e,r,i,o){if(c(t))return n({id:t,name:i,filename:o,blob:e,base64:r});if(d(t))return n(t);throw new Error("Unknown input type")},add:function(t){i(t.id())||e.push(t)},get:i=function(t){return r(function(e){return e.id()===t})},getByUri:function(t){return r(function(e){return e.blobUri()===t})},getByData:function(t,e){return r(function(n){return n.base64()===t&&n.blob().type===e})},findFirst:r=function(t){return Z(e,t).getOrUndefined()},removeByUri:function(t){e=X(e,function(e){return e.blobUri()!==t||void URL.revokeObjectURL(e.blobUri())})},destroy:function(){U(e,function(t){URL.revokeObjectURL(t.blobUri())}),e=[]}}),l=lv(),u=[],f=function(t){var e=gs(null);return t.on("change AddUndo",function(t){e.set(Tt({},t.level))}),{fireIfChanged:function(){var n=t.undoManager.data;it(n).filter(function(t){return!Qg(e.get(),t)}).each(function(e){t.setDirty(!0),t.fire("change",{level:e,lastLevel:nt(n,n.length-2).getOrNull()})})}}}(t),h=function(e){return function(n){return t.selection?e(n):[]}},p=function(t,e,n){for(var r=0;-1!==(r=t.indexOf(e,r))&&(t=t.substring(0,r)+n+t.substr(r+e.length),r+=n.length-e.length+1),-1!==r;);return t},g=function(t,e,n){return t=p(t,'src="'+e+'"','src="'+n+'"'+(n===be.transparentSrc?' data-mce-placeholder="1"':"")),p(t,'data-mce-src="'+e+'"','data-mce-src="'+n+'"')},m=function(e,n){U(t.undoManager.data,function(t){"fragmented"===t.type?t.fragments=G(t.fragments,function(t){return g(t,e,n)}):t.content=g(t.content,e,n)})},v=function(e){return o=o||fv(t,l),b().then(h(function(n){var r=G(n,function(t){return t.blobInfo});return o.upload(r,dv(t)).then(h(function(r){var i=[],o=G(r,function(e,r){var o=n[r].blobInfo,a=n[r].image;return e.status&&t.getParam("images_replace_blob_uris",!0,"boolean")?(s.removeByUri(a.src),function(e,n){var r,i=t.convertURL(n,"src");m(e.src,n),t.$(e).attr({src:t.getParam("images_reuse_filename",!1,"boolean")?(r=n)+(-1===r.indexOf("?")?"?":"&")+(new Date).getTime():n,"data-mce-src":i})}(a,e.url)):e.error&&(e.error.options.remove&&(m(a.getAttribute("src"),be.transparentSrc),i.push(a)),nv(t,xs.translate(["Failed to upload image: {0}",e.error.message]))),{element:a,status:e.status,uploadUri:e.url,blobInfo:o}});return 0<o.length&&f.fireIfChanged(),0<i.length&&(im(t)?console.error("Removing images on failed uploads is currently unsupported for RTC"):t.undoManager.transact(function(){U(i,function(e){t.dom.remove(e),s.removeByUri(e.src)})})),e&&e(o),o}))}))},y=function(e){if(ql(t))return v(e)},x=function(e){return!1!==Q(u,function(t){return t(e)})&&(0!==e.getAttribute("src").indexOf("data:")||t.getParam("images_dataimg_filter",E,"function")(e))},b=function(){return(a=a||function(t,e){var n={};return{findAll:function(r,i){i=i||E;var o,a=X((o=r)?ot(o.getElementsByTagName("img")):[],function(e){var n=e.src;return be.fileApi&&!e.hasAttribute("data-mce-bogus")&&!e.hasAttribute("data-mce-placeholder")&&n&&n!==be.transparentSrc&&(0===n.indexOf("blob:")?!t.isUploaded(n)&&i(e):0===n.indexOf("data:")&&i(e))}),s=G(a,function(t){if(void 0!==n[t.src])return new Ir(function(e){n[t.src].then(function(n){return"string"==typeof n?n:void e({image:t,blobInfo:n.blobInfo})})});var r=new Ir(function(n,r){!function(t,e,n,r){var i,o,a,s;0!==e.src.indexOf("blob:")?(o=(i=hm(e.src)).data,(s=t.getByData(a=o,i.type))?n({image:e,blobInfo:s}):gm(e.src).then(function(r){s=t.create(vm(),r,a),t.add(s),n({image:e,blobInfo:s})},function(t){r(t)})):(s=t.getByUri(e.src))?n({image:e,blobInfo:s}):gm(e.src).then(function(r){var i;i=r,new Ir(function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(i)}).then(function(i){a=hm(i).data,s=t.create(vm(),r,a),t.add(s),n({image:e,blobInfo:s})})},function(t){r(t)})}(e,t,n,r)}).then(function(t){return delete n[t.image.src],t}).catch(function(e){return delete n[t.src],e});return n[t.src]=r});return Ir.all(s)}}}(l,s)).findAll(t.getBody(),x).then(h(function(e){return e=X(e,function(e){return"string"!=typeof e||void nv(t,e)}),U(e,function(t){m(t.image.src,t.blobInfo.blobUri()),t.image.src=t.blobInfo.blobUri(),t.image.removeAttribute("data-mce-src")}),e}))},_=function(e){return e.replace(/src="(blob:[^"]+)"/g,function(e,n){var r=l.getResultUri(n);if(r)return'src="'+r+'"';var i=s.getByUri(n);return(i=i||$(t.editorManager.get(),function(t,e){return t||e.editorUpload&&e.editorUpload.blobCache.getByUri(n)},null))?'src="data:'+i.blob().type+";base64,"+i.base64()+'"':e})};return t.on("SetContent",function(){(ql(t)?y:b)()}),t.on("RawSaveContent",function(t){t.content=_(t.content)}),t.on("GetContent",function(t){t.source_view||"raw"===t.format||"tree"===t.format||(t.content=_(t.content))}),t.on("PostRender",function(){t.parser.addNodeFilter("img",function(t){U(t,function(t){var e,n=t.attr("src");s.getByUri(n)||(e=l.getResultUri(n))&&t.attr("src",e)})})}),{blobCache:s,addFilter:function(t){u.push(t)},uploadImages:v,uploadImagesAuto:y,scanForImages:b,destroy:function(){s.destroy(),l.destroy(),a=o=null}}}(t),t.schema=ao(n),t.dom=us(i,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,hex_colors:n.force_hex_style_colors,update_styles:!0,root_element:t.inline?t.getBody():null,collect:function(){return t.inline},schema:t.schema,contentCssCors:t.getParam("content_css_cors",!1,"boolean"),referrerPolicy:Yl(t),onSetAttrib:function(e){t.fire("SetAttrib",e)}}),t.parser=((a=Mm(y_(o=t),o.schema)).addAttributeFilter("src,href,style,tabindex",function(t,e){for(var n,r,i=t.length,a=o.dom,s="data-mce-"+e;i--;)if((r=(n=t[i]).attr(e))&&!n.attr(s)){if(0===r.indexOf("data:")||0===r.indexOf("blob:"))continue;"style"===e?((r=a.serializeStyle(a.parseStyle(r),n.name)).length||(r=null),n.attr(s,r),n.attr(e,r)):"tabindex"===e?(n.attr(s,r),n.attr(e,null)):n.attr(s,o.convertURL(r,e,n.name))}}),a.addNodeFilter("script",function(t){for(var e=t.length;e--;){var n=t[e],r=n.attr("type")||"no/type";0!==r.indexOf("mce-")&&n.attr("type","mce-"+r)}}),o.settings.preserve_cdata&&a.addNodeFilter("#cdata",function(t){for(var e=t.length;e--;){var n=t[e];n.type=8,n.name="#comment",n.value="[CDATA["+o.dom.encode(n.value)+"]]"}}),a.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(t){for(var e=t.length,n=o.schema.getNonEmptyElements();e--;){var r=t[e];r.isEmpty(n)&&0===r.getAll("br").length&&(r.append(new Hf("br",1)).shortEnded=!0)}}),a),t.serializer=km((l=(s=t).settings,Tt(Tt({},y_(s)),v_({url_converter:l.url_converter,url_converter_scope:l.url_converter_scope,element_format:l.element_format,entities:l.entities,entity_encoding:l.entity_encoding,indent:l.indent,indent_after:l.indent_after,indent_before:l.indent_before,block_elements:l.block_elements,boolean_attributes:l.boolean_attributes,custom_elements:l.custom_elements,extended_valid_elements:l.extended_valid_elements,invalid_elements:l.invalid_elements,invalid_styles:l.invalid_styles,move_caret_before_on_enter_elements:l.move_caret_before_on_enter_elements,non_empty_elements:l.non_empty_elements,schema:l.schema,self_closing_elements:l.self_closing_elements,short_ended_elements:l.short_ended_elements,special:l.special,text_block_elements:l.text_block_elements,text_inline_elements:l.text_inline_elements,valid_children:l.valid_children,valid_classes:l.valid_classes,valid_elements:l.valid_elements,valid_styles:l.valid_styles,verify_html:l.verify_html,whitespace_elements:l.whitespace_elements}))),t),t.selection=fm(t.dom,t.getWin(),t.serializer,t),t.annotator=xd(t),t.formatter=yv(t),t.undoManager=xv(t),t._nodeChangeDispatcher=new i_(t),t._selectionOverrides=function(t){var e,n=t.selection,r=t.dom,i=r.isBlock,o=t.getBody(),a=function(t,e,n,r){var i,o,a=gs(B.none()),s=Gl(t),l=0<s.length?s:"p",u=function(){!function(t){for(var e=As(De(t),"*[contentEditable=false],video,audio,embed,object"),n=0;n<e.length;n++){var r,i=e[n].dom,o=i.previousSibling;pi(o)&&(1===(r=o.data).length?o.parentNode.removeChild(o):o.deleteData(r.length-1,1)),hi(o=i.nextSibling)&&(1===(r=o.data).length?o.parentNode.removeChild(o):o.deleteData(0,1))}}(e),o&&(du(o),o=null),a.get().each(function(t){ns(t.caret).remove(),a.set(B.none())}),i&&(Vr.clearInterval(i),i=null)},c=function(){i=Vr.setInterval(function(){r()?ns("div.mce-visual-caret",e).toggleClass("mce-visual-caret-hidden"):ns("div.mce-visual-caret",e).addClass("mce-visual-caret-hidden")},500)};return{show:function(t,r){var i,s;if(u(),gu(r))return null;if(!n(r))return o=function(t,e){var n,r=t.ownerDocument.createTextNode(ni),i=t.parentNode;if(e){if(ai(n=t.previousSibling)){if(ui(n))return n;if(pi(n))return n.splitText(n.data.length-1)}i.insertBefore(r,t)}else{if(ai(n=t.nextSibling)){if(ui(n))return n;if(hi(n))return n.splitText(1),n}t.nextSibling?i.insertBefore(r,t.nextSibling):i.appendChild(r)}return r}(r,t),s=r.ownerDocument.createRange(),yu(o.nextSibling)?(s.setStart(o,0),s.setEnd(o,0)):(s.setStart(o,1),s.setEnd(o,1)),s;o=function(t,e,n){var r,i=e.ownerDocument.createElement(t);i.setAttribute("data-mce-caret",n?"before":"after"),i.setAttribute("data-mce-bogus","all"),i.appendChild(((r=document.createElement("br")).setAttribute("data-mce-bogus","1"),r));var o=e.parentNode;return n?o.insertBefore(i,e):e.nextSibling?o.insertBefore(i,e.nextSibling):o.appendChild(i),i}(l,r,t),i=mu(e,r,t),ns(o).css("top",i.top);var d=ns('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(i).appendTo(e)[0];return a.set(B.some({caret:d,element:r,before:t})),a.get().each(function(e){t&&ns(e.caret).addClass("mce-visual-caret-before")}),c(),(s=r.ownerDocument.createRange()).setStart(o,0),s.setEnd(o,0),s},hide:u,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){a.get().each(function(t){var n=mu(e,t.element,t.before);ns(t.caret).css(Tt({},n))})},destroy:function(){return Vr.clearInterval(i)}}}(t,o,i,function(){return Df(t)}),s="sel-"+r.uniqueId(),l="data-mce-selected",u=function(t){return t!==o&&(p_(t)||jn(t))&&r.isChildOf(t,o)},c=function(t){t&&n.setRng(t)},d=n.getRng,f=function(e,r,i,o){return void 0===o&&(o=!0),t.fire("ShowCaret",{target:r,direction:e,before:i}).isDefaultPrevented()?null:(o&&n.scrollIntoView(r,-1===e),a.show(i,r))},h=function(t){return ui(t)||hi(t)||pi(t)},p=function(t){return h(t.startContainer)||h(t.endContainer)},g=function(i){var o=i.cloneNode(!0),a=t.fire("ObjectSelected",{target:i,targetClone:o});if(a.isDefaultPrevented())return null;var u=function(e,i,o){var a=t.$,l=kr(De(t.getBody()),"#"+s).fold(function(){return a([])},function(t){return a([t.dom])});0===l.length&&(l=a('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",s)).appendTo(t.getBody());var u=r.createRng();i===o&&be.ie?(l.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(i),u.setStartAfter(l[0].firstChild.firstChild),u.setEndAfter(i)):(l.empty().append(ei).append(i).append(ei),u.setStart(l[0].firstChild,1),u.setEnd(l[0].lastChild,0)),l.css({top:r.getPos(e,t.getBody()).y}),l[0].focus();var c=n.getSel();return c.removeAllRanges(),c.addRange(u),u}(i,a.targetClone,o),c=De(i);return U(As(De(t.getBody()),"*[data-mce-selected]"),function(t){Re(c,t)||Zn(t,l)}),r.getAttrib(i,l)||i.setAttribute(l,"1"),e=i,y(),u},m=function(t,e){if(!t)return null;if(t.collapsed){if(!p(t)){var n=e?1:-1,i=zu(n,o,t),a=i.getNode(!e);if(xu(a))return f(n,a,!!e&&!i.isAtEnd(),!1);var s=i.getNode(e);if(xu(s))return f(n,s,!e&&!i.isAtEnd(),!1)}return null}var l=t.startContainer,c=t.startOffset,d=t.endOffset;if(3===l.nodeType&&0===c&&p_(l.parentNode)&&(c=r.nodeIndex(l=l.parentNode),l=l.parentNode),1!==l.nodeType)return null;if(d===c+1&&l===t.endContainer){var h=l.childNodes[c];if(u(h))return g(h)}return null},v=function(){e&&e.removeAttribute(l),kr(De(t.getBody()),"#"+s).each(hn),e=null},y=function(){a.hide()};return be.ceFalse&&!im(t)&&function(){var l,h,g;t.on("mouseup",function(e){var n=d();n.collapsed&&Zm(t,e.clientX,e.clientY)&&Yv(t,n,!1).each(c)}),t.on("click",function(e){var i=g_(t,e.target);i&&(p_(i)&&(e.preventDefault(),t.focus()),h_(i)&&r.isChildOf(i,n.getNode())&&v())}),t.on("blur NewBlock",v),t.on("ResizeWindow FullscreenStateChanged",a.reposition),t.on("tap",function(e){var n=e.target,r=g_(t,n);p_(r)?(e.preventDefault(),Xv(t,r).each(m)):u(n)&&Xv(t,n).each(m)},!0),t.on("mousedown",function(e){var a,s,l,d=e.target;d!==o&&"HTML"!==d.nodeName&&!r.isChildOf(d,o)||!1===Zm(t,e.clientX,e.clientY)||((a=g_(t,d))?p_(a)?(e.preventDefault(),Xv(t,a).each(m)):(v(),h_(a)&&e.shiftKey||wd(e.clientX,e.clientY,n.getRng())||(y(),n.placeCaretAt(e.clientX,e.clientY))):u(d)?Xv(t,d).each(m):!1===xu(d)&&(v(),y(),(s=function(t,e,n){var r,i,o=Zy(X(ot(t.getElementsByTagName("*")),xu)),a=X(o,C(sx,n));if(s=lx(a,e)){var s,l=!On(s.node)&&!jn(s.node);if((s=lx(function(t,e,n){void 0===n&&(n=!0);var r=[],i=function(t,n){var i=X(Zy([n]),function(n){return!t(n,e)});return r=r.concat(i),0===i.length};return r.push(e),ux(zy.Up,t,C(i,Xs),e.node,n),ux(zy.Down,t,C(i,Ys),e.node,n),r}(t,s,l),e))&&xu(s.node))return{node:(r=s).node,before:ix(r,i=e)<ox(r,i)}}return null}(o,e.clientX,e.clientY))&&(function(e,n){var o,a=r.getParent(e,i),s=r.getParent(n,i);return!(!a||e===s||!r.isChildOf(a,s)||!1!==p_(g_(t,a)))||a&&(o=s,!(r.getParent(a,i)===r.getParent(o,i)))&&function(t){var e=tc(t);if(!t.firstChild)return!1;var n,r=vl.before(t.firstChild),i=e.next(r);return i&&!(xh(n=i)||bh(n)||gh(n)||mh(n))}(a)}(d,s.node)||(e.preventDefault(),l=f(1,s.node,s.before,!1),t.getBody().focus(),c(l)))))}),t.on("keypress",function(t){Cd.modifierPressed(t)||p_(n.getNode())&&t.preventDefault()}),t.on("GetSelectionRange",function(t){var n=t.range;if(e){if(!e.parentNode)return void(e=null);(n=n.cloneRange()).selectNode(e),t.range=n}}),t.on("SetSelectionRange",function(e){e.range=function(e){var n=t.schema.getShortEndedElements(),i=r.createRng(),o=e.startContainer,a=e.startOffset,s=e.endContainer,l=e.endOffset;return mt(n,o.nodeName.toLowerCase())?0===a?i.setStartBefore(o):i.setStartAfter(o):i.setStart(o,a),mt(n,s.nodeName.toLowerCase())?0===l?i.setEndBefore(s):i.setEndAfter(s):i.setEnd(s,l),i}(e.range);var n=m(e.range,e.forward);n&&(e.range=n)}),t.on("AfterSetSelectionRange",function(t){var e=t.range,n=e.startContainer.parentNode;p(e)||"mcepastebin"===n.id||y(),r.hasClass(n,"mce-offscreen-selection")||v()}),t.on("copy",function(t){var e,n,i=t.clipboardData;t.isDefaultPrevented()||!t.clipboardData||be.ie||(e=(n=r.get(s))?n.getElementsByTagName("*")[0]:n)&&(t.preventDefault(),i.clearData(),i.setData("text/html",e.outerHTML),i.setData("text/plain",e.outerText||e.innerText))}),function(t){var e,n,r,i,o;(function(t){var e,n,r,i=(e=gs(B.none()),{clear:function(){return e.set(B.none())},set:function(t){return e.set(B.some(t))},isSet:function(){return e.get().isSome()},on:function(t){return e.get().each(t)}}),o=us.DOM,a=document,s=function(t,e){return function(n){var r,i,o,a,s,l;0===n.button&&(r=Z(e.dom.getParents(n.target),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){for(var n=0;n<t.length;n++)if(t[n](e))return!0;return!1}}(u_,c_)).getOr(null),s=e.getBody(),u_(l=r)&&l!==s&&(i=e.dom.getPos(r),o=e.getBody(),a=e.getDoc().documentElement,t.set({element:r,dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(e.inline?o.scrollWidth:a.offsetWidth)-2,maxY:(e.inline?o.scrollHeight:a.offsetHeight)-2,relX:n.pageX-i.x,relY:n.pageY-i.y,width:r.offsetWidth,height:r.offsetHeight,ghost:function(t,e,n,r){var i=t.dom,o=e.cloneNode(!0);i.setStyles(o,{width:n,height:r}),i.setAttrib(o,"data-mce-selected",null);var a=i.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return i.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:r}),i.setStyles(o,{margin:0,boxSizing:"border-box"}),a.appendChild(o),a}(e,r,r.offsetWidth,r.offsetHeight)})))}}(i,t),l=function(t,e){var n=Vr.throttle(function(t,n){e._selectionOverrides.hideFakeCaret(),e.selection.placeCaretAt(t,n)},0);return e.on("remove",n.stop),function(r){return t.on(function(t){var i,o,a,s,l,u,c,d,f,h,p,g,m,v=Math.max(Math.abs(r.screenX-t.screenX),Math.abs(r.screenY-t.screenY));if(!t.dragging&&10<v){if(e.fire("dragstart",{target:t.element}).isDefaultPrevented())return;t.dragging=!0,e.focus()}t.dragging&&(g=t,i={pageX:(m=l_(e,r)).pageX-g.relX,pageY:m.pageY+5},h=t.ghost,p=e.getBody(),h.parentNode!==p&&p.appendChild(h),s=t.width,l=t.height,u=t.maxX,c=t.maxY,f=d=0,(o=t.ghost).style.left=(a=i).pageX+"px",o.style.top=a.pageY+"px",a.pageX+s>u&&(d=a.pageX+s-u),a.pageY+l>c&&(f=a.pageY+l-c),o.style.width=s-d+"px",o.style.height=l-f+"px",n(r.clientX,r.clientY))})}}(i,t),u=function(t,e){return function(n){t.on(function(t){var r,i,o,a,s,l;t.dragging&&((a=3===(l=(o=e).selection.getSel().getRangeAt(0).startContainer).nodeType?l.parentNode:l)===(s=t.element)||o.dom.isChildOf(a,s)||u_(a)||((i=t.element.cloneNode(!0)).removeAttribute("data-mce-selected"),r=i,e.fire("drop",{clientX:n.clientX,clientY:n.clientY}).isDefaultPrevented()||e.undoManager.transact(function(){d_(t.element),e.insertContent(e.dom.getOuterHTML(r)),e._selectionOverrides.hideFakeCaret()})))}),f_(t)}}(i,t),c=(n=i,function(){n.on(function(t){t.dragging&&r.fire("dragend")}),f_(n)});(r=t).on("mousedown",s),t.on("mousemove",l),t.on("mouseup",u),o.bind(a,"mousemove",l),o.bind(a,"mouseup",c),t.on("remove",function(){o.unbind(a,"mousemove",l),o.unbind(a,"mouseup",c)})})(t),(e=t).on("drop",function(t){var n=void 0!==t.clientX?e.getDoc().elementFromPoint(t.clientX,t.clientY):null;!u_(n)&&"false"!==e.dom.getContentEditableParent(n)||t.preventDefault()}),t.getParam("block_unsupported_drop",!0,"boolean")&&(r=function(t){var e;t.isDefaultPrevented()||(e=t.dataTransfer)&&(W(e.types,"Files")||0<e.files.length)&&(t.preventDefault(),"drop"===t.type&&nv(n,"Dropped file type is not supported"))},i=function(t){Mf(n,t.target)&&r(t)},o=function(){var t=us.DOM,e=n.dom,o=document,a=n.inline?n.getBody():n.getDoc(),s=["drop","dragover"];U(s,function(n){t.bind(o,n,i),e.bind(a,n,r)}),n.on("remove",function(){U(s,function(n){t.unbind(o,n,i),e.unbind(a,n,r)})})},(n=t).on("init",function(){Vr.setEditorTimeout(n,o,0)}))}(t),h=_s(function(){var t,e;l.removed||!l.getBody().contains(document.activeElement)||(t=l.selection.getRng()).collapsed&&(e=$v(l,t,!1),l.selection.setRng(e))},0),(l=t).on("focus",function(){h.throttle()}),l.on("blur",function(){h.cancel()}),(g=t).on("init",function(){g.on("focusin",function(t){var e,n,r=t.target;jn(r)&&(e=_d(g.getBody(),r),n=Hn(e)?e:r,g.selection.getNode()!==n&&Xv(g,n).each(function(t){return g.selection.setRng(t)}))})})}(),{showCaret:f,showBlockCaretContainer:function(t){t.hasAttribute("data-mce-caret")&&(gi(t),c(d()),n.scrollIntoView(t))},hideFakeCaret:y,destroy:function(){a.destroy(),e=null}}}(t),function(t){var e=gs(B.none()),n=gs(!1),r=ws(function(e){t.fire("longpress",Tt(Tt({},e),{type:"longpress"})),n.set(!0)},400);t.on("touchstart",function(t){Vx(t).each(function(i){r.cancel();var o={x:i.clientX,y:i.clientY,target:t.target};r.throttle(t),n.set(!1),e.set(B.some(o))})},!0),t.on("touchmove",function(i){r.cancel(),Vx(i).each(function(r){e.get().each(function(i){var o,a,s,l;o=r,a=i,s=Math.abs(o.clientX-a.x),l=Math.abs(o.clientY-a.y),(5<s||5<l)&&(e.set(B.none()),n.set(!1),t.fire("longpresscancel"))})})},!0),t.on("touchend touchcancel",function(i){r.cancel(),"touchcancel"!==i.type&&e.get().filter(function(t){return t.target.isEqualNode(i.target)}).each(function(){n.get()?i.preventDefault():t.fire("tap",Tt(Tt({},i),{type:"tap"}))})},!0)}(t),function(t){var e,n;(e=t).on("click",function(t){e.dom.getParent(t.target,"details")&&t.preventDefault()}),(n=t).parser.addNodeFilter("details",function(t){U(t,function(t){t.attr("data-mce-open",t.attr("open")),t.attr("open","open")})}),n.serializer.addNodeFilter("details",function(t){U(t,function(t){var e=t.attr("data-mce-open");t.attr("open",c(e)?e:null),t.attr("data-mce-open",null)})})}(t),im(t)||function(t){t.on("click",function(e){var n,r,i,o,a;3<=e.detail&&(i=(n=t).selection.getRng(),o=vl.fromRangeStart(i),a=vl.fromRangeEnd(i),vl.isElementPosition(o)&&(r=o.container(),a_(r)&&cc(r).each(function(t){return i.setStart(t.container(),t.offset())})),vl.isElementPosition(a)&&(r=o.container(),a_(r)&&dc(r).each(function(t){return i.setEnd(t.container(),t.offset())})),n.selection.setRng(Ip(i)))})}(t);var f,h,p=im(f=t)?gs(null):function(t){var e,n=function(t){var e=gs(null),n=C(Mv,t);return t.on("NodeChange",function(r){var i,o,a,s,l,u,c,d,f,h;!eu(t)||be.browser.isIE()&&r.initial||(u=n,c=r.parents,d=G(As(De(t.dom.getRoot()),'*[data-mce-selected="inline-boundary"]'),function(t){return t.dom}),f=X(d,u),h=X(c,u),U(et(f,h),C(vx,!1)),U(et(h,f),C(vx,!0)),function(t,e){var n,r;t.selection.isCollapsed()&&!0!==t.composing&&e.get()&&(n=vl.fromRangeStart(t.selection.getRng()),vl.isTextPosition(n)&&!1===(di(r=n)||fi(r))&&(mx(t,cu(e.get(),n)),e.set(null)))}(t,e),i=n,a=e,s=r.parents,(o=t).selection.isCollapsed()&&(l=X(s,i),U(l,function(t){var e=vl.fromRangeStart(o.selection.getRng());Ay(i,o.getBody(),e).bind(function(t){return yx(o,a,t)})})))}),e}(t);return(e=t).on("keyup compositionstart",C(jx,e)),function(t,e){t.on("keydown",function(n){var r,i,o,a;!1===n.isDefaultPrevented()&&(r=t,i=e,o=n,a=de().os,tb([{keyCode:Cd.RIGHT,action:Qx(qx,r,!0)},{keyCode:Cd.LEFT,action:Qx(qx,r,!1)},{keyCode:Cd.UP,action:Qx(Xx,r,!1)},{keyCode:Cd.DOWN,action:Qx(Xx,r,!0)},{keyCode:Cd.RIGHT,action:Qx(pb,r,!0)},{keyCode:Cd.LEFT,action:Qx(pb,r,!1)},{keyCode:Cd.UP,action:Qx(gb,r,!1)},{keyCode:Cd.DOWN,action:Qx(gb,r,!0)},{keyCode:Cd.RIGHT,action:Qx(eb,r,!0)},{keyCode:Cd.LEFT,action:Qx(eb,r,!1)},{keyCode:Cd.UP,action:Qx(nb,r,!1)},{keyCode:Cd.DOWN,action:Qx(nb,r,!0)},{keyCode:Cd.RIGHT,action:Qx(xx,r,i,!0)},{keyCode:Cd.LEFT,action:Qx(xx,r,i,!1)},{keyCode:Cd.RIGHT,ctrlKey:!a.isOSX(),altKey:a.isOSX(),action:Qx(_x,r,i)},{keyCode:Cd.LEFT,ctrlKey:!a.isOSX(),altKey:a.isOSX(),action:Qx(wx,r,i)},{keyCode:Cd.UP,action:Qx(Jx,r,!1)},{keyCode:Cd.DOWN,action:Qx(Jx,r,!0)}],o).each(function(t){o.preventDefault()}))})}(t,n),function(t,e){t.on("keydown",function(n){var r,i,o;!1===n.isDefaultPrevented()&&(i=e,o=n,tb([{keyCode:Cd.BACKSPACE,action:Qx(Bx,r=t,!1)},{keyCode:Cd.BACKSPACE,action:Qx(ay,r,!1)},{keyCode:Cd.DELETE,action:Qx(ay,r,!0)},{keyCode:Cd.BACKSPACE,action:Qx(Qv,r,!1)},{keyCode:Cd.DELETE,action:Qx(Qv,r,!0)},{keyCode:Cd.BACKSPACE,action:Qx(Tx,r,i,!1)},{keyCode:Cd.DELETE,action:Qx(Tx,r,i,!0)},{keyCode:Cd.BACKSPACE,action:Qx(Ap,r,!1)},{keyCode:Cd.DELETE,action:Qx(Ap,r,!0)},{keyCode:Cd.BACKSPACE,action:Qx(sy,r,!1)},{keyCode:Cd.DELETE,action:Qx(sy,r,!0)},{keyCode:Cd.BACKSPACE,action:Qx(Dx,r,!1)},{keyCode:Cd.DELETE,action:Qx(Dx,r,!0)},{keyCode:Cd.BACKSPACE,action:Qx(jv,r,!1)},{keyCode:Cd.DELETE,action:Qx(jv,r,!0)},{keyCode:Cd.BACKSPACE,action:Qx(Hv,r,!1)},{keyCode:Cd.DELETE,action:Qx(Hv,r,!0)},{keyCode:Cd.BACKSPACE,action:Qx(Ax,r,!1)},{keyCode:Cd.DELETE,action:Qx(Ax,r,!0)}],o).each(function(t){o.preventDefault()}))}),t.on("keyup",function(e){var n,r;!1===e.isDefaultPrevented()&&(r=e,tb([{keyCode:Cd.BACKSPACE,action:Qx(oy,n=t)},{keyCode:Cd.DELETE,action:Qx(oy,n)}],r))})}(t,n),function(t){t.on("keydown",function(e){var n,r,i;e.keyCode===Cd.ENTER&&(n=t,(r=e).isDefaultPrevented()||(r.preventDefault(),(i=n.undoManager).typing&&(i.typing=!1,i.add()),n.undoManager.transact(function(){!1===n.selection.isCollapsed()&&n.execCommand("Delete"),Yb(n,r)})))})}(t),function(t){t.on("keydown",function(e){var n;!1===e.isDefaultPrevented()&&(n=e,tb([{keyCode:Cd.SPACEBAR,action:Qx(r_,t)}],n).each(function(t){n.preventDefault()}))})}(t),function(t){var e,n;e=t,n=_s(function(){e.composing||$h(e)},0),$b.isIE()&&(e.on("keypress",function(t){n.throttle()}),e.on("remove",function(t){n.cancel()})),t.on("input",function(e){!1===e.isComposing&&$h(t)})}(t),function(t,e){t.on("keydown",function(n){var r,i,o;!1===n.isDefaultPrevented()&&(i=e,o=n,tb([{keyCode:Cd.END,action:Qx(Yx,r=t,!0)},{keyCode:Cd.HOME,action:Qx(Yx,r,!1)},{keyCode:Cd.END,action:Qx(rb,r,!0)},{keyCode:Cd.HOME,action:Qx(rb,r,!1)},{keyCode:Cd.END,action:Qx(Sx,r,!0,i)},{keyCode:Cd.HOME,action:Qx(Sx,r,!1,i)}],o).each(function(t){o.preventDefault()}))})}(t,n),function(t,e){var n;Zb.os.isOSX()||(n=gs(!1),t.on("keydown",function(e){Jb(e)&&Qb(n,t,!0)}),t.on("keyup",function(r){var i,o,a;!1===r.isDefaultPrevented()&&(a=r,tb([{keyCode:Cd.PAGE_UP,action:Qx(Sx,i=t,!1,o=e)},{keyCode:Cd.PAGE_DOWN,action:Qx(Sx,i,!0,o)}],a)),Jb(r)&&n.get()&&(Qb(n,t,!1),t.nodeChanged())}))}(t,n),n}(f);(function(t,e){t.addCommand("delete",function(){var n,r;r=e,Bx(n=t)||ay(n,!1)||Qv(n,!1)||Tx(n,r,!1)||Hv(n,!1)||Ap(n)||sy(n,!1)||Dx(n,!1)||jv(n)||Ax(n,!1)||(zx(n,"Delete"),Ov(n))}),t.addCommand("forwardDelete",function(){var n,r;r=e,ay(n=t,!0)||Qv(n,!0)||Tx(n,r,!0)||Hv(n,!0)||Ap(n)||sy(n,!0)||Dx(n,!0)||jv(n)||Ax(n,!0)||zx(n,"ForwardDelete")})})(t,p),Gl(h=t)&&h.on("NodeChange",C(Hx,h)),function(t){var e,n=t.dom,r=Gl(t),i=(e=t).getParam("placeholder",Hl.getAttrib(e.getElement(),"placeholder"),"string"),o=function(e,a){var s,l,u;!function(t){if(wv(t)){var e=t.keyCode;return!Sv(t)&&(Cd.metaKeyPressed(t)||t.altKey||112<=e&&e<=123||W(bv,e))}return!1}(e)&&(s=t.getBody(),l=!(wv(u=e)&&!(Sv(u)||"keyup"===u.type&&229===u.keyCode))&&function(t,e,n){if(Ei(De(e),!1)){var r=""===n,i=e.firstElementChild;return!i||!t.getStyle(e.firstElementChild,"padding-left")&&!t.getStyle(e.firstElementChild,"padding-right")&&(r?!t.isBlock(i):n===i.nodeName.toLowerCase())}return!1}(n,s,r),""!==n.getAttrib(s,_v)===l&&!a||(n.setAttrib(s,_v,l?i:null),n.setAttrib(s,"aria-placeholder",l?i:null),t.fire("PlaceholderToggle",{state:l}),t.on(l?"keydown":"keyup",o),t.off(l?"keyup":"keydown",o)))};i&&t.on("init",function(e){o(e,!0),t.on("change SetContent ExecCommand",o),t.on("paste",function(e){return Vr.setEditorTimeout(t,function(){return o(e)})})})}(t),t.fire("PreInit"),function(t){var e=t;return gt(t.plugins,"rtc").bind(function(t){return B.from(t.setup)}).fold(function(){return e.rtcInstance=rm(t),B.none()},function(t){return B.some(t().then(function(t){var n,r,i,o,a,s,l,u;return e.rtcInstance=(r=function(t){return d(t)?t:{}},i=I("Unimplemented feature for rtc"),o=(n=t).undoManager,a=n.formatter,s=n.editor,l=n.selection,u=n.raw,{undoManager:{beforeChange:b,addUndoLevel:i,undo:function(){return o.undo()},redo:function(){return o.redo()},clear:function(){return o.clear()},reset:function(){return o.reset()},hasUndo:function(){return o.hasUndo()},hasRedo:function(){return o.hasRedo()},transact:function(t,e,n){return o.transact(n)},ignore:function(t,e){return o.ignore(e)},extra:function(t,e,n,r){return o.extra(n,r)}},formatter:{match:function(t,e,n){return a.match(t,r(e))},matchAll:i,matchNode:i,canApply:function(t){return a.canApply(t)},closest:function(t){return a.closest(t)},apply:function(t,e,n){return a.apply(t,r(e))},remove:function(t,e,n,i){return a.remove(t,r(e))},toggle:function(t,e,n){return a.toggle(t,r(e))},formatChanged:function(t,e,n,r){return a.formatChanged(e,n,r)}},editor:{getContent:function(t,e){return s.getContent(t)},setContent:function(t,e){return s.setContent(t,e)},insertContent:function(t,e){return s.insertContent(t)},addVisual:b},selection:{getContent:function(t,e){return l.getContent(e)}},raw:{getModel:function(){return B.some(u.getRawModel())}}}),t.rtc.isRemote},function(t){var n,r;return e.rtcInstance=(n=w(null),r=w(""),{undoManager:{beforeChange:b,addUndoLevel:n,undo:n,redo:n,clear:b,reset:b,hasUndo:P,hasRedo:P,transact:n,ignore:b,extra:b},formatter:{match:P,matchAll:w([]),matchNode:P,canApply:P,closest:r,apply:b,remove:b,toggle:b,formatChanged:w({unbind:b})},editor:{getContent:r,setContent:r,insertContent:b,addVisual:b},selection:{getContent:r},raw:{getModel:w(B.none())}}),Ir.reject(t)}))})}(t).fold(function(){b_(t)},function(e){t.setProgressState(!0),e.then(function(e){t.setProgressState(!1),b_(t)},function(e){t.notificationManager.open({type:"error",text:String(e)}),b_(t)})})},w_=us.DOM,S_=us.DOM,C_=function(t,e,n){var r=Jm.get(n),i=Jm.urls[n]||t.documentBaseUrl.replace(/\/$/,"");if(n=Me.trim(n),r&&-1===Me.inArray(e,n)){if(Me.each(Jm.dependencies(n),function(n){C_(t,e,n)}),t.plugins[n])return;try{var o=new r(t,i,t.$);(t.plugins[n]=o).init&&(o.init(t,i),e.push(n))}catch(mS){!function(t,e,n){var r=xs.translate(["Failed to initialize plugin: {0}",e]);Sd(t,"PluginLoadError",{message:r}),av(r,n),nv(t,r)}(t,n,mS)}}},M_=function(t){return t.replace(/^\-/,"")},T_=function(t){return{editorContainer:t,iframeContainer:t,api:{}}},k_=function(t){var e,n,r,i=t.getElement();return t.orgDisplay=i.style.display,c(tu(t))?t.theme.renderUI():y(tu(t))?(n=(e=t).getElement(),(r=tu(e)(e,n)).editorContainer.nodeType&&(r.editorContainer.id=r.editorContainer.id||e.id+"_parent"),r.iframeContainer&&r.iframeContainer.nodeType&&(r.iframeContainer.id=r.iframeContainer.id||e.id+"_iframecontainer"),r.height=r.iframeHeight?r.iframeHeight:n.offsetHeight,r):function(t){var e,n,r=t.getElement();return t.inline?T_(null):(e=r,n=S_.create("div"),S_.insertAfter(n,e),T_(n))}(t)},A_=function(t){var e,n,r,i,o,a,s,l,u;t.fire("ScriptsLoaded"),n=Me.trim(Xl(e=t)),r=e.ui.registry.getAll().icons,i=Tt(Tt({},jm.get("default").icons),jm.get(n).icons),lt(i,function(t,n){mt(r,n)||e.ui.registry.addIcon(n,t)}),s=tu(o=t),c(s)?(o.settings.theme=M_(s),a=Qm.get(s),o.theme=new a(o,Qm.urls[s]),o.theme.init&&o.theme.init(o,Qm.urls[s]||o.documentBaseUrl.replace(/\/$/,""),o.$)):o.theme={},u=[],Me.each(nu(l=t).split(/[ ,]/),function(t){C_(l,u,M_(t))});var d,h,p,g=k_(t);d=t,h=B.from(g.api).getOr({}),p={show:B.from(h.show).getOr(b),hide:B.from(h.hide).getOr(b),disable:B.from(h.disable).getOr(b),isDisabled:B.from(h.isDisabled).getOr(P),enable:function(){d.mode.isReadOnly()||B.from(h.enable).map(O)}},d.ui=Tt(Tt({},d.ui),p);var m,v,y,x={editorContainer:g.editorContainer,iframeContainer:g.iframeContainer};return t.editorContainer=x.editorContainer?x.editorContainer:null,function(t){var e;t.contentCSS=t.contentCSS.concat(function(t){return sv(t,(n=(e=t).getParam("content_css"),c(n)?G(n.split(","),Ht):f(n)?n:!1===n||e.inline?[]:["default"]));var e,n}(t),sv(e=t,Kl(e)))}(t),t.inline?__(t):(y=function(t,e){var n,r,i,o,a=t.editorManager.translate("Rich Text Area. Press ALT-0 for help."),s=(n=t.id,r=a,i=t.getParam("iframe_attrs",{}),o=Ae("iframe"),Xn(o,i),Xn(o,{id:n+"_ifr",frameBorder:"0",allowTransparency:"true",title:r}),Ms(o,"tox-edit-area__iframe"),o.dom);s.onload=function(){s.onload=null,t.fire("load")};var l=function(t,e){if(document.domain!==window.location.hostname&&be.browser.isIE()){var n=cv("mce");t[n]=function(){__(t)};var r='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+t.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";return w_.setAttrib(e,"src",r),!0}return!1}(t,s);return t.contentAreaContainer=e.iframeContainer,t.iframeElement=s,t.iframeHTML=function(t){var e=t.getParam("doctype","<!DOCTYPE html>")+"<html><head>";t.getParam("document_base_url","")!==t.documentBaseUrl&&(e+='<base href="'+t.documentBaseURI.getURI()+'" />'),e+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var n=Wl(t,"body_id","tinymce"),r=Wl(t,"body_class","");return jl(t)&&(e+='<meta http-equiv="Content-Security-Policy" content="'+jl(t)+'" />'),e+'</head><body id="'+n+'" class="mce-content-body '+r+'" data-id="'+t.id+'"><br></body></html>'}(t),w_.add(e.iframeContainer,s),l}(m=t,v=x),v.editorContainer&&(w_.get(v.editorContainer).style.display=m.orgDisplay,m.hidden=w_.isHidden(v.editorContainer)),m.getElement().style.display="none",w_.setAttrib(m.id,"aria-hidden","true"),void(y||__(m)))},I_=us.DOM,D_=function(t){return"-"===t.charAt(0)},O_=function(t,e,n){return B.from(e).filter(function(t){return 0<t.length&&!jm.has(t)}).map(function(e){return{url:t.editorManager.baseURL+"/icons/"+e+"/icons"+n+".js",name:B.some(e)}})},P_={"font-size":"size","font-family":"face"},E_=function(t){return function(e,n){return B.from(n).map(De).filter(Ve).bind(function(n){return function(t,e,n){return zp(De(n),function(e){return Qn(n=e,t).orThunk(function(){return"font"===Ne(n)?gt(P_,t).bind(function(t){return $n(n,t)}):B.none()});var n},function(t){return Re(De(e),t)})}(t,e,n.dom).or(B.from(us.DOM.getStyle(n.dom,t,!0)))}).getOr("")}},R_=E_("font-size"),L_=_(function(t){return t.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")},E_("font-family")),N_=function(t){return cc(t.getBody()).map(function(t){var e=t.container();return Rn(e)?e.parentNode:e})},B_=function(t,e){return B.from((n=t).selection.getRng()).bind(function(t){var e=n.getBody();return t.startContainer===e&&0===t.startOffset?B.none():B.from(n.selection.getStart(!0))}).orThunk(C(N_,t)).map(De).filter(Ve).map(e);var n},z_=function(t,e){if(/^[0-9.]+$/.test(e)){var n=parseInt(e,10);if(1<=n&&n<=7){var r=Me.explode(t.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large")),i=Me.explode(t.getParam("font_size_classes",""));return i?i[n-1]||e:r[n-1]||e}return e}return e},V_=Me.each,F_=Me.map,H_=Me.inArray,W_=(j_.prototype.execCommand=function(t,e,n,r){var o,a,s=!1,l=this;if(!l.editor.removed){if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(t)||r&&r.skip_focus?wf(a=l.editor).each(function(t){return a.selection.setRng(t)}):l.editor.focus(),(r=l.editor.fire("BeforeExecCommand",{command:t,ui:e,value:n})).isDefaultPrevented())return!1;var u=t.toLowerCase();if(o=l.commands.exec[u])return o(u,e,n),l.editor.fire("ExecCommand",{command:t,ui:e,value:n}),!0;if(V_(this.editor.plugins,function(r){if(r.execCommand&&r.execCommand(t,e,n))return l.editor.fire("ExecCommand",{command:t,ui:e,value:n}),!(s=!0)}),s)return s;if(l.editor.theme&&l.editor.theme.execCommand&&l.editor.theme.execCommand(t,e,n))return l.editor.fire("ExecCommand",{command:t,ui:e,value:n}),!0;try{s=l.editor.getDoc().execCommand(t,e,n)}catch(i){}return!!s&&(l.editor.fire("ExecCommand",{command:t,ui:e,value:n}),!0)}},j_.prototype.queryCommandState=function(t){var e;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(t=t.toLowerCase(),e=this.commands.state[t])return e(t);try{return this.editor.getDoc().queryCommandState(t)}catch(l){}return!1}},j_.prototype.queryCommandValue=function(t){var e;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(t=t.toLowerCase(),e=this.commands.value[t])return e(t);try{return this.editor.getDoc().queryCommandValue(t)}catch(l){}}},j_.prototype.addCommands=function(t,e){void 0===e&&(e="exec");var n=this;V_(t,function(t,r){V_(r.toLowerCase().split(","),function(r){n.commands[e][r]=t})})},j_.prototype.addCommand=function(t,e,n){var r=this;t=t.toLowerCase(),this.commands.exec[t]=function(t,i,o,a){return e.call(n||r.editor,i,o,a)}},j_.prototype.queryCommandSupported=function(t){if(t=t.toLowerCase(),this.commands.exec[t])return!0;try{return this.editor.getDoc().queryCommandSupported(t)}catch(e){}return!1},j_.prototype.addQueryStateHandler=function(t,e,n){var r=this;t=t.toLowerCase(),this.commands.state[t]=function(){return e.call(n||r.editor)}},j_.prototype.addQueryValueHandler=function(t,e,n){var r=this;t=t.toLowerCase(),this.commands.value[t]=function(){return e.call(n||r.editor)}},j_.prototype.hasCustomCommand=function(t){return t=t.toLowerCase(),!!this.commands.exec[t]},j_.prototype.execNativeCommand=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=null),this.editor.getDoc().execCommand(t,e,n)},j_.prototype.isFormatMatch=function(t){return this.editor.formatter.match(t)},j_.prototype.toggleFormat=function(t,e){this.editor.formatter.toggle(t,e?{value:e}:void 0),this.editor.nodeChanged()},j_.prototype.storeSelection=function(t){this.selectionBookmark=this.editor.selection.getBookmark(t)},j_.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},j_.prototype.setupCommands=function(t){var e=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":b,"mceEndUndoLevel,mceAddUndoLevel":function(){t.undoManager.add()},"Cut,Copy,Paste":function(n){var r,i,o=t.getDoc();try{e.execNativeCommand(n)}catch(u){r=!0}"paste"!==n||o.queryCommandEnabled(n)||(r=!0),!r&&o.queryCommandSupported(n)||(i=t.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead."),be.mac&&(i=i.replace(/Ctrl\+/g,"⌘+")),t.notificationManager.open({text:i,type:"error"}))},unlink:function(){var e;t.selection.isCollapsed()?(e=t.dom.getParent(t.selection.getStart(),"a"))&&t.dom.remove(e,!0):t.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(n){var r=n.substring(7);"full"===r&&(r="justify"),V_("left,center,right,justify".split(","),function(e){r!==e&&t.formatter.remove("align"+e)}),"none"!==r&&e.toggleFormat("align"+r)},"InsertUnorderedList,InsertOrderedList":function(n){var r;e.execNativeCommand(n);var i=t.dom.getParent(t.selection.getNode(),"ol,ul");i&&/^(H[1-6]|P|ADDRESS|PRE)$/.test((r=i.parentNode).nodeName)&&(e.storeSelection(),t.dom.split(r,i),e.restoreSelection())},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(t){e.toggleFormat(t)},"ForeColor,HiliteColor":function(t,n,r){e.toggleFormat(t,r)},FontName:function(e,n,r){!function(t,e){var n,r=z_(t,e);t.formatter.toggle("fontname",{value:(n=r.split(/\s*,\s*/),G(n,function(t){return-1===t.indexOf(" ")||Vt(t,'"')||Vt(t,"'")?t:"'"+t+"'"}).join(","))}),t.nodeChanged()}(t,r)},FontSize:function(e,n,r){var i;(i=t).formatter.toggle("fontsize",{value:z_(i,r)}),i.nodeChanged()},LineHeight:function(e,n,r){var i;(i=t).formatter.toggle("lineheight",{value:String(r)}),i.nodeChanged()},RemoveFormat:function(e){t.formatter.remove(e)},mceBlockQuote:function(){e.toggleFormat("blockquote")},FormatBlock:function(t,n,r){return e.toggleFormat(r||"p")},mceCleanup:function(){var e=t.selection.getBookmark();t.setContent(t.getContent()),t.selection.moveToBookmark(e)},mceRemoveNode:function(n,r,i){var o=i||t.selection.getNode();o!==t.getBody()&&(e.storeSelection(),t.dom.remove(o,!0),e.restoreSelection())},mceSelectNodeDepth:function(e,n,r){var i=0;t.dom.getParent(t.selection.getNode(),function(e){if(1===e.nodeType&&i++===r)return t.selection.select(e),!1},t.getBody())},mceSelectNode:function(e,n,r){t.selection.select(r)},mceInsertContent:function(e,n,r){!function(t,e){var n,r,i,o,a="string"!=typeof(n=e)?(r=Me.extend({paste:n.paste,data:{paste:n.paste}},n),{content:n.content,details:r}):{content:n,details:{}};i=a.content,o=a.details,om(t).editor.insertContent(i,o)}(t,r)},mceInsertRawHTML:function(e,n,r){t.selection.setContent("tiny_mce_marker");var i=t.getContent();t.setContent(i.replace(/tiny_mce_marker/g,function(){return r}))},mceInsertNewLine:function(e,n,r){Yb(t,r)},mceToggleFormat:function(t,n,r){e.toggleFormat(r)},mceSetContent:function(e,n,r){t.setContent(r)},"Indent,Outdent":function(e){Nx(t,e)},mceRepaint:b,InsertHorizontalRule:function(){t.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){t.hasVisual=!t.hasVisual,t.addVisual()},mceReplaceContent:function(e,n,r){t.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,t.selection.getContent({format:"text"})))},mceInsertLink:function(e,n,r){"string"==typeof r&&(r={href:r});var i=t.dom.getParent(t.selection.getNode(),"a");r.href=r.href.replace(/ /g,"%20"),i&&r.href||t.formatter.remove("link"),r.href&&t.formatter.apply("link",r,i)},selectAll:function(){var e,n=t.dom.getParent(t.selection.getStart(),Fn);n&&((e=t.dom.createRng()).selectNodeContents(n),t.selection.setRng(e))},mceNewDocument:function(){t.setContent("")},InsertLineBreak:function(e,n,r){return Lb(t,r),!0}});var n=function(e){return function(){var n=t.selection,r=n.isCollapsed()?[t.dom.getParent(n.getNode(),t.dom.isBlock)]:n.getSelectedBlocks(),i=F_(r,function(n){return!!t.formatter.matchNode(n,e)});return-1!==H_(i,!0)}};e.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(t){return e.isFormatMatch(t)},mceBlockQuote:function(){return e.isFormatMatch("blockquote")},Outdent:function(){return Ex(t)},"InsertUnorderedList,InsertOrderedList":function(e){var n=t.dom.getParent(t.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===e&&"UL"===n.tagName||"insertorderedlist"===e&&"OL"===n.tagName)}},"state"),e.addCommands({Undo:function(){t.undoManager.undo()},Redo:function(){t.undoManager.redo()}}),e.addQueryValueHandler("FontName",function(){return B_(e=t,function(t){return L_(e.getBody(),t.dom)}).getOr("");var e},this),e.addQueryValueHandler("FontSize",function(){return B_(e=t,function(t){return R_(e.getBody(),t.dom)}).getOr("");var e},this),e.addQueryValueHandler("LineHeight",function(){return B_(e=t,function(t){var n=De(e.getBody());return zp(t,function(t){return Qn(t,"line-height")},C(Re,n)).getOrThunk(function(){var e=parseFloat(Kn(t,"line-height")),n=parseFloat(Kn(t,"font-size"));return String(e/n)})}).getOr("");var e},this)},j_);function j_(t){this.commands={state:{},exec:{},value:{}},this.editor=t,this.setupCommands(t)}var G_="data-mce-contenteditable",U_=function(e,n,r){try{e.getDoc().execCommand(n,!1,String(r))}catch(t){}},q_=function(t,e){t.dom.contentEditable=e?"true":"false"},X_=function(t){return t.readonly},Y_=function(t){t.parser.addAttributeFilter("contenteditable",function(e){X_(t)&&U(e,function(t){t.attr(G_,t.attr("contenteditable")),t.attr("contenteditable","false")})}),t.serializer.addAttributeFilter(G_,function(e){X_(t)&&U(e,function(t){t.attr("contenteditable",t.attr(G_))})}),t.serializer.addTempAttr(G_)},$_=Me.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),Z_=(K_.isNative=function(t){return!!$_[t.toLowerCase()]},K_.prototype.fire=function(t,e){var n=t.toLowerCase(),r=e||{};r.type=n,r.target||(r.target=this.scope),r.preventDefault||(r.preventDefault=function(){r.isDefaultPrevented=E},r.stopPropagation=function(){r.isPropagationStopped=E},r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=E},r.isDefaultPrevented=P,r.isPropagationStopped=P,r.isImmediatePropagationStopped=P),this.settings.beforeFire&&this.settings.beforeFire(r);var i=this.bindings[n];if(i)for(var o=0,a=i.length;o<a;o++){var s=i[o];if(s.once&&this.off(n,s.func),r.isImmediatePropagationStopped())return r.stopPropagation(),r;if(!1===s.func.call(this.scope,r))return r.preventDefault(),r}return r},K_.prototype.on=function(t,e,n,r){if(!1===e&&(e=P),e){var i={func:e};r&&Me.extend(i,r);for(var o=t.toLowerCase().split(" "),a=o.length;a--;){var s=o[a],l=this.bindings[s];l||(l=this.bindings[s]=[],this.toggleEvent(s,!0)),n?l.unshift(i):l.push(i)}}return this},K_.prototype.off=function(t,e){var n=this;if(t)for(var r=t.toLowerCase().split(" "),i=r.length;i--;){var o=r[i],a=this.bindings[o];if(!o)return lt(this.bindings,function(t,e){n.toggleEvent(e,!1),delete n.bindings[e]}),this;if(a){if(e)for(var s=a.length;s--;)a[s].func===e&&(a=a.slice(0,s).concat(a.slice(s+1)),this.bindings[o]=a);else a.length=0;a.length||(this.toggleEvent(t,!1),delete this.bindings[o])}}else lt(this.bindings,function(t,e){n.toggleEvent(e,!1)}),this.bindings={};return this},K_.prototype.once=function(t,e,n){return this.on(t,e,n,{once:!0})},K_.prototype.has=function(t){return t=t.toLowerCase(),!(!this.bindings[t]||0===this.bindings[t].length)},K_);function K_(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||P}var J_,Q_=function(t){return t._eventDispatcher||(t._eventDispatcher=new Z_({scope:t,toggleEvent:function(e,n){Z_.isNative(e)&&t.toggleNativeEvent&&t.toggleNativeEvent(e,n)}})),t._eventDispatcher},tw={fire:function(t,e,n){if(this.removed&&"remove"!==t&&"detach"!==t)return e;var r=Q_(this).fire(t,e);if(!1!==n&&this.parent)for(var i=this.parent();i&&!r.isPropagationStopped();)i.fire(t,r,!1),i=i.parent();return r},on:function(t,e,n){return Q_(this).on(t,e,n)},off:function(t,e){return Q_(this).off(t,e)},once:function(t,e){return Q_(this).once(t,e)},hasEventListeners:function(t){return Q_(this).has(t)}},ew=us.DOM,nw=function(t,e){if("selectionchange"===e)return t.getDoc();if(!t.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(e))return t.getDoc().documentElement;var n=Ql(t);return n?(t.eventRoot||(t.eventRoot=ew.select(n)[0]),t.eventRoot):t.getBody()},rw=function(t,e,n){var r;(r=t).hidden||X_(r)?X_(t)&&function(t,e){var n,r;"click"!==e.type||Cd.metaKeyPressed(e)||(n=De(e.target),r=t,Ar(n,"a",function(t){return Re(t,De(r.getBody()))}).bind(function(t){return $n(t,"href")}).each(function(n){var r,i,o,a;e.preventDefault(),/^#/.test(n)?(r=t.dom.select(n+',[name="'+(Vt(i=n,"#")?(o=i,a="#".length,o.substring(a)):i)+'"]')).length&&t.selection.scrollIntoView(r[0],!0):window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")}))}(t,n):t.fire(e,n)},iw=function(t,e){var n;if(t.delegates||(t.delegates={}),!t.delegates[e]&&!t.removed){var r=nw(t,e);if(Ql(t)){if(J_||(J_={},t.editorManager.on("removeEditor",function(){t.editorManager.activeEditor||J_&&(lt(J_,function(e,n){t.dom.unbind(nw(t,n))}),J_=null)})),J_[e])return;J_[e]=n=function(n){for(var r=n.target,i=t.editorManager.get(),o=i.length;o--;){var a=i[o].getBody();a!==r&&!ew.isChildOf(r,a)||rw(i[o],e,n)}},ew.bind(r,e,n)}else ew.bind(r,e,n=function(n){rw(t,e,n)}),t.delegates[e]=n}},ow=Tt(Tt({},tw),{bindPendingEventDelegates:function(){var t=this;Me.each(t._pendingNativeEvents,function(e){iw(t,e)})},toggleNativeEvent:function(t,e){var n=this;"focus"!==t&&"blur"!==t&&(e?n.initialized?iw(n,t):n._pendingNativeEvents?n._pendingNativeEvents.push(t):n._pendingNativeEvents=[t]:n.initialized&&(n.dom.unbind(nw(n,t),t,n.delegates[t]),delete n.delegates[t]))},unbindAllNativeEvents:function(){var t=this,e=t.getBody(),n=t.dom;t.delegates&&(lt(t.delegates,function(e,n){t.dom.unbind(nw(t,n),n,e)}),delete t.delegates),!t.inline&&e&&n&&(e.onload=null,n.unbind(t.getWin()),n.unbind(t.getDoc())),n&&(n.unbind(e),n.unbind(t.getContainer()))}}),aw=["design","readonly"],sw=function(t,e,n,r){var i=n[e.get()],o=n[r];try{o.activate()}catch(mS){return void console.error("problem while activating editor mode "+r+":",mS)}i.deactivate(),i.editorReadOnly!==o.editorReadOnly&&function(t,e){var n,r,i=De(t.getBody());(function(t,e,n){var r,i;Ts(t,e)&&!1===n?(i=e,Cs(r=t)?r.dom.classList.remove(i):function(t,e){return 0<(i=X(Ss(n=t,r="class"),function(t){return"mce-content-readonly"!==t})).length?qn(n,r,i.join(" ")):Zn(n,r),!1;var n,r,i}(r),function(t){0===(Cs(t)?t.dom.classList:Ss(t,"class")).length&&Zn(t,"class")}(r)):n&&Ms(t,e)})(i,"mce-content-readonly",e),e?(t.selection.controlSelection.hideResizeRect(),t._selectionOverrides.hideFakeCaret(),B.from(t.selection.getNode()).each(function(t){t.removeAttribute("data-mce-selected")}),t.readonly=!0,q_(i,!1),U(As(i,'*[contenteditable="true"]'),function(t){qn(t,G_,"true"),q_(t,!1)})):(t.readonly=!1,q_(i,!0),U(As(i,"*["+G_+'="true"]'),function(t){Zn(t,G_),q_(t,!0)}),U_(t,"StyleWithCSS",!1),U_(t,"enableInlineTableEditing",!1),U_(t,"enableObjectResizing",!1),(Df(r=t)||function(t){var e=rn(De(t.getElement()));return df(e).filter(function(e){return!(void 0!==(n=e.dom.classList)&&(n.contains("tox-edit-area")||n.contains("tox-edit-area__iframe")||n.contains("mce-content-body")))&&Mf(t,e.dom);var n}).isSome()}(r))&&t.focus(),(n=t).selection.setRng(n.selection.getRng()),t.nodeChanged())}(t,o.editorReadOnly),e.set(r),t.fire("SwitchMode",{mode:r})},lw=Me.each,uw=Me.explode,cw={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},dw=Me.makeMap("alt,ctrl,shift,meta,access"),fw=function(t){var e,n={};lw(uw(t.toLowerCase(),"+"),function(t){t in dw?n[t]=!0:/^[0-9]{2,}$/.test(t)?n.keyCode=parseInt(t,10):(n.charCode=t.charCodeAt(0),n.keyCode=cw[t]||t.toUpperCase().charCodeAt(0))});var r=[n.keyCode];for(e in dw)n[e]?r.push(e):n[e]=!1;return n.id=r.join(","),n.access&&(n.alt=!0,be.mac?n.ctrl=!0:n.shift=!0),n.meta&&(be.mac?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n},hw=(pw.prototype.add=function(t,e,n,r){var i=this,o=i.normalizeCommandFunc(n);return lw(uw(Me.trim(t)),function(t){var n=i.createShortcut(t,e,o,r);i.shortcuts[n.id]=n}),!0},pw.prototype.remove=function(t){var e=this.createShortcut(t);return!!this.shortcuts[e.id]&&(delete this.shortcuts[e.id],!0)},pw.prototype.normalizeCommandFunc=function(t){var e=this,n=t;return"string"==typeof n?function(){e.editor.execCommand(n,!1,null)}:Me.isArray(n)?function(){e.editor.execCommand(n[0],n[1],n[2])}:n},pw.prototype.createShortcut=function(t,e,n,r){var i=Me.map(uw(t,">"),fw);return i[i.length-1]=Me.extend(i[i.length-1],{func:n,scope:r||this.editor}),Me.extend(i[0],{desc:this.editor.translate(e),subpatterns:i.slice(1)})},pw.prototype.hasModifier=function(t){return t.altKey||t.ctrlKey||t.metaKey},pw.prototype.isFunctionKey=function(t){return"keydown"===t.type&&112<=t.keyCode&&t.keyCode<=123},pw.prototype.matchShortcut=function(t,e){return!!e&&e.ctrl===t.ctrlKey&&e.meta===t.metaKey&&e.alt===t.altKey&&e.shift===t.shiftKey&&!!(t.keyCode===e.keyCode||t.charCode&&t.charCode===e.charCode)&&(t.preventDefault(),!0)},pw.prototype.executeShortcutAction=function(t){return t.func?t.func.call(t.scope):null},pw);function pw(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;var e=this;t.on("keyup keypress keydown",function(t){!e.hasModifier(t)&&!e.isFunctionKey(t)||t.isDefaultPrevented()||(lw(e.shortcuts,function(n){if(e.matchShortcut(t,n))return e.pendingPatterns=n.subpatterns.slice(0),"keydown"===t.type&&e.executeShortcutAction(n),!0}),e.matchShortcut(t,e.pendingPatterns[0])&&(1===e.pendingPatterns.length&&"keydown"===t.type&&e.executeShortcutAction(e.pendingPatterns[0]),e.pendingPatterns.shift()))})}var gw=function(){var t,e,n,r,i,o,a,s,l=(e={},n={},r={},i={},o={},a={},{addButton:(s=function(t,e){return function(n,r){return t[n.toLowerCase()]=Tt(Tt({},r),{type:e})}})(t={},"button"),addGroupToolbarButton:s(t,"grouptoolbarbutton"),addToggleButton:s(t,"togglebutton"),addMenuButton:s(t,"menubutton"),addSplitButton:s(t,"splitbutton"),addMenuItem:s(e,"menuitem"),addNestedMenuItem:s(e,"nestedmenuitem"),addToggleMenuItem:s(e,"togglemenuitem"),addAutocompleter:s(n,"autocompleter"),addContextMenu:s(i,"contextmenu"),addContextToolbar:s(o,"contexttoolbar"),addContextForm:s(o,"contextform"),addSidebar:s(a,"sidebar"),addIcon:function(t,e){return r[t.toLowerCase()]=e},getAll:function(){return{buttons:t,menuItems:e,icons:r,popups:n,contextMenus:i,contextToolbars:o,sidebars:a}}});return{addAutocompleter:l.addAutocompleter,addButton:l.addButton,addContextForm:l.addContextForm,addContextMenu:l.addContextMenu,addContextToolbar:l.addContextToolbar,addIcon:l.addIcon,addMenuButton:l.addMenuButton,addMenuItem:l.addMenuItem,addNestedMenuItem:l.addNestedMenuItem,addSidebar:l.addSidebar,addSplitButton:l.addSplitButton,addToggleButton:l.addToggleButton,addGroupToolbarButton:l.addGroupToolbarButton,addToggleMenuItem:l.addToggleMenuItem,getAll:l.getAll}},mw=Me.each,vw=Me.trim,yw="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),xw={ftp:21,http:80,https:443,mailto:25},bw=(_w.parseDataUri=function(t){var e,n=decodeURIComponent(t).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(e=r[1]),{type:e,data:n[1]}},_w.getDocumentBaseUrl=function(t){var e=0!==t.protocol.indexOf("http")&&"file:"!==t.protocol?t.href:t.protocol+"//"+t.host+t.pathname;return/^[^:]+:\/\/\/?[^\/]+\//.test(e)&&(e=e.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(e)||(e+="/")),e},_w.prototype.setPath=function(t){var e=/^(.*?)\/?(\w+)?$/.exec(t);this.path=e[0],this.directory=e[1],this.file=e[2],this.source="",this.getURI()},_w.prototype.toRelative=function(t){var e;if("./"===t)return t;var n=new _w(t,{base_uri:this});if("mce_host"!==n.host&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&""!==n.protocol)return n.getURI();var r=this.getURI(),i=n.getURI();return r===i||"/"===r.charAt(r.length-1)&&r.substr(0,r.length-1)===i?r:(e=this.toRelPath(this.path,n.path),n.query&&(e+="?"+n.query),n.anchor&&(e+="#"+n.anchor),e)},_w.prototype.toAbsolute=function(t,e){var n=new _w(t,{base_uri:this});return n.getURI(e&&this.isSameOrigin(n))},_w.prototype.isSameOrigin=function(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;var e=xw[this.protocol];if(e&&(this.port||e)==(t.port||e))return!0}return!1},_w.prototype.toRelPath=function(t,e){var n,r,i=0,o="",a=t.substring(0,t.lastIndexOf("/")).split("/"),s=e.split("/");if(a.length>=s.length)for(n=0,r=a.length;n<r;n++)if(n>=s.length||a[n]!==s[n]){i=n+1;break}if(a.length<s.length)for(n=0,r=s.length;n<r;n++)if(n>=a.length||a[n]!==s[n]){i=n+1;break}if(1===i)return e;for(n=0,r=a.length-(i-1);n<r;n++)o+="../";for(n=i-1,r=s.length;n<r;n++)o+=n!==i-1?"/"+s[n]:s[n];return o},_w.prototype.toAbsPath=function(t,e){var n,r,i=0,o=[],a=/\/$/.test(e)?"/":"",s=t.split("/"),l=e.split("/");for(mw(s,function(t){t&&o.push(t)}),s=o,n=l.length-1,o=[];0<=n;n--)0!==l[n].length&&"."!==l[n]&&(".."!==l[n]?0<i?i--:o.push(l[n]):i++);return 0!==(r=(n=s.length-i)<=0?tt(o).join("/"):s.slice(0,n).join("/")+"/"+tt(o).join("/")).indexOf("/")&&(r="/"+r),a&&r.lastIndexOf("/")!==r.length-1&&(r+=a),r},_w.prototype.getURI=function(t){var e;return void 0===t&&(t=!1),this.source&&!t||(e="",t||(e+=this.protocol?this.protocol+"://":"//",this.userInfo&&(e+=this.userInfo+"@"),this.host&&(e+=this.host),this.port&&(e+=":"+this.port)),this.path&&(e+=this.path),this.query&&(e+="?"+this.query),this.anchor&&(e+="#"+this.anchor),this.source=e),this.source},_w);function _w(t,e){t=vw(t),this.settings=e||{};var n,r,i,o,a=this.settings.base_uri,s=this;/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t)?s.source=t:(n=0===t.indexOf("//"),0!==t.indexOf("/")||n||(t=(a&&a.protocol||"http")+"://mce_host"+t),/^[\w\-]*:?\/\//.test(t)||(r=this.settings.base_uri?this.settings.base_uri.path:new _w(document.location.href).directory,t=this.settings.base_uri&&""==this.settings.base_uri.protocol?"//mce_host"+s.toAbsPath(r,t):(i=/([^#?]*)([#?]?.*)/.exec(t),(a&&a.protocol||"http")+"://mce_host"+s.toAbsPath(r,i[1])+i[2])),t=t.replace(/@@/g,"(mce_at)"),o=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t),mw(yw,function(t,e){var n=(n=o[e])&&n.replace(/\(mce_at\)/g,"@@");s[t]=n}),a&&(s.protocol||(s.protocol=a.protocol),s.userInfo||(s.userInfo=a.userInfo),s.port||"mce_host"!==s.host||(s.port=a.port),s.host&&"mce_host"!==s.host||(s.host=a.host),s.source=""),n&&(s.protocol=""))}var ww=us.DOM,Sw=Me.extend,Cw=Me.each,Mw=Me.resolve,Tw=be.ie,kw=(Aw.prototype.render=function(){!function(t){var e=t.id;xs.setCode($l(t));var n,r,i,o,a=function(){I_.unbind(window,"ready",a),t.render()};vo.Event.domLoaded?t.getElement()&&be.contentEditable&&(n=De(t.getElement()),r=$(n.dom.attributes,function(t,e){return t[e.name]=e.value,t},{}),t.on("remove",function(){q(n.dom.attributes,function(t){return Zn(n,t.name),0}),Xn(n,r)}),t.ui.styleSheetLoader=Hr.forElement(n,{contentCssCors:(i=t).getParam("content_css_cors"),referrerPolicy:Yl(i)}),t.getParam("inline")?t.inline=!0:(t.orgVisibility=t.getElement().style.visibility,t.getElement().style.visibility="hidden"),(o=t.getElement().form||I_.getParent(e,"form"))&&(t.formElement=o,t.getParam("hidden_input")&&!En(t.getElement())&&(I_.insertAfter(I_.create("input",{type:"hidden",name:e}),e),t.hasHiddenInput=!0),t.formEventDelegate=function(e){t.fire(e.type,e)},I_.bind(o,"submit reset",t.formEventDelegate),t.on("reset",function(){t.resetContent()}),!t.getParam("submit_patch")||o.submit.nodeType||o.submit.length||o._mceOldSubmit||(o._mceOldSubmit=o.submit,o.submit=function(){return t.editorManager.triggerSave(),t.setDirty(!1),o._mceOldSubmit(o)})),t.windowManager=tv(t),t.notificationManager=Km(t),"xml"===t.getParam("encoding")&&t.on("GetContent",function(t){t.save&&(t.content=I_.encode(t.content))}),t.getParam("add_form_submit_trigger")&&t.on("submit",function(){t.initialized&&t.save()}),t.getParam("add_unload_trigger")&&(t._beforeUnload=function(){!t.initialized||t.destroyed||t.isHidden()||t.save({format:"raw",no_events:!0,set_dirty:!1})},t.editorManager.on("BeforeUnload",t._beforeUnload)),t.editorManager.add(t),function(t,e){var n,r,i,o,a,s,l=hs.ScriptLoader;n=l,i=e,o=function(){var n,r;(function(t,e){var n,r=$l(e),i=e.getParam("language_url","","string");!1===xs.hasCode(r)&&"en"!==r&&t.add(n=""!==i?i:e.editorManager.baseURL+"/langs/"+r+".js",b,void 0,function(){rv(e,"LanguageLoadError",iv("language",n,r))})})(l,t),function(t,e,n){var r=O_(e,"default",n),i=B.from(e.getParam("icons_url","","string")).filter(function(t){return 0<t.length}).map(function(t){return{url:t,name:B.none()}}).orThunk(function(){return O_(e,Xl(e),"")});U(function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e}([r,i]),function(n){t.add(n.url,b,void 0,function(){var t,r,i;t=e,r=n.url,i=n.name.getOrUndefined(),rv(t,"IconsLoadError",iv("icons",r,i))})})}(l,t,e),r=e,Me.each((n=t).getParam("external_plugins"),function(t,e){Jm.load(e,t,b,void 0,function(){ov(n,t,e)}),n.settings.plugins+=" "+e}),Me.each(nu(n).split(/[ ,]/),function(t){var e,i;(t=Me.trim(t))&&!Jm.urls[t]&&(D_(t)?(t=t.substr(1,t.length),e=Jm.dependencies(t),Me.each(e,function(t){var e=Jm.createUrl({prefix:"plugins/",resource:t,suffix:"/plugin"+r+".js"},t);Jm.load(e.resource,e,b,void 0,function(){ov(n,e.prefix+e.resource+e.suffix,e.resource)})})):Jm.load(t,i={prefix:"plugins/",resource:t,suffix:"/plugin"+r+".js"},b,void 0,function(){ov(n,i.prefix+i.resource+i.suffix,t)}))}),l.loadQueue(function(){t.removed||A_(t)},t,function(){t.removed||A_(t)})},s=tu(r=t),c(s)?(D_(s)||Qm.urls.hasOwnProperty(s)||((a=r.getParam("theme_url"))?Qm.load(s,r.documentBaseURI.toAbsolute(a)):Qm.load(s,"themes/"+s+"/theme"+i+".js")),n.loadQueue(function(){Qm.waitFor(s,o)})):o()}(t,t.suffix)):I_.bind(window,"ready",a)}(this)},Aw.prototype.focus=function(t){this.removed||(t?Pf:Of)(this)},Aw.prototype.hasFocus=function(){return Df(this)},Aw.prototype.execCallback=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=this.settings[t];if(i)return this.callbackLookup&&(r=this.callbackLookup[t])&&(i=r.func,r=r.scope),"string"==typeof i&&(r=(r=i.replace(/\.\w+$/,""))?Mw(r):0,i=Mw(i),this.callbackLookup=this.callbackLookup||{},this.callbackLookup[t]={func:i,scope:r}),i.apply(r||this,e)},Aw.prototype.translate=function(t){return xs.translate(t)},Aw.prototype.getParam=function(t,e,n){return function(t,e,n,r){var i,o,a,s=e in t.settings?t.settings[e]:n;return"hash"===r?(a={},"string"==typeof(o=s)?U(0<o.indexOf("=")?o.split(/[;,](?![^=;,]*(?:[;,]|$))/):o.split(","),function(t){var e=t.split("=");a[Me.trim(e[0])]=Me.trim(1<e.length?e[1]:e[0])}):a=o,a):"string"===r?Wm(c,t,e).getOr(n):"number"===r?Wm(x,t,e).getOr(n):"boolean"===r?Wm(p,t,e).getOr(n):"object"===r?Wm(d,t,e).getOr(n):"array"===r?Wm(f,t,e).getOr(n):"string[]"===r?Wm((i=c,function(t){return f(t)&&Q(t,i)}),t,e).getOr(n):"function"===r?Wm(y,t,e).getOr(n):s}(this,t,e,n)},Aw.prototype.hasPlugin=function(t,e){return!(!W(nu(this).split(/[ ,]/),t)||e&&void 0===Jm.get(t))},Aw.prototype.nodeChanged=function(t){this._nodeChangeDispatcher.nodeChanged(t)},Aw.prototype.addCommand=function(t,e,n){this.editorCommands.addCommand(t,e,n)},Aw.prototype.addQueryStateHandler=function(t,e,n){this.editorCommands.addQueryStateHandler(t,e,n)},Aw.prototype.addQueryValueHandler=function(t,e,n){this.editorCommands.addQueryValueHandler(t,e,n)},Aw.prototype.addShortcut=function(t,e,n,r){this.shortcuts.add(t,e,n,r)},Aw.prototype.execCommand=function(t,e,n,r){return this.editorCommands.execCommand(t,e,n,r)},Aw.prototype.queryCommandState=function(t){return this.editorCommands.queryCommandState(t)},Aw.prototype.queryCommandValue=function(t){return this.editorCommands.queryCommandValue(t)},Aw.prototype.queryCommandSupported=function(t){return this.editorCommands.queryCommandSupported(t)},Aw.prototype.show=function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(ww.show(this.getContainer()),ww.hide(this.id)),this.load(),this.fire("show"))},Aw.prototype.hide=function(){var t=this,e=t.getDoc();t.hidden||(Tw&&e&&!t.inline&&e.execCommand("SelectAll"),t.save(),t.inline?(t.getBody().contentEditable="false",t===t.editorManager.focusedEditor&&(t.editorManager.focusedEditor=null)):(ww.hide(t.getContainer()),ww.setStyle(t.id,"display",t.orgDisplay)),t.hidden=!0,t.fire("hide"))},Aw.prototype.isHidden=function(){return!!this.hidden},Aw.prototype.setProgressState=function(t,e){this.fire("ProgressState",{state:t,time:e})},Aw.prototype.load=function(t){var e=this.getElement();if(this.removed)return"";if(e){(t=t||{}).load=!0;var n=En(e)?e.value:e.innerHTML,r=this.setContent(n,t);return t.element=e,t.no_events||this.fire("LoadContent",t),t.element=e=null,r}},Aw.prototype.save=function(t){var e,n,r=this,i=r.getElement();if(i&&r.initialized&&!r.removed)return(t=t||{}).save=!0,t.element=i,t.content=r.getContent(t),t.no_events||r.fire("SaveContent",t),"raw"===t.format&&r.fire("RawSaveContent",t),e=t.content,En(i)?i.value=e:(!t.is_removing&&r.inline||(i.innerHTML=e),(n=ww.getParent(r.id,"form"))&&Cw(n.elements,function(t){if(t.name===r.id)return t.value=e,!1})),t.element=i=null,!1!==t.set_dirty&&r.setDirty(!1),e},Aw.prototype.setContent=function(t,e){return Am(this,t,e)},Aw.prototype.getContent=function(t){return function(t,e){var n,r;return void 0===e&&(e={}),n=e,r=e.format?e.format:"html",om(t).editor.getContent(n,r)}(this,t)},Aw.prototype.insertContent=function(t,e){e&&(t=Sw({content:t},e)),this.execCommand("mceInsertContent",!1,t)},Aw.prototype.resetContent=function(t){void 0===t?Am(this,this.startContent,{format:"raw"}):Am(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},Aw.prototype.isDirty=function(){return!this.isNotDirty},Aw.prototype.setDirty=function(t){var e=!this.isNotDirty;this.isNotDirty=!t,t&&t!==e&&this.fire("dirty")},Aw.prototype.getContainer=function(){return this.container||(this.container=ww.get(this.editorContainer||this.id+"_parent")),this.container},Aw.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},Aw.prototype.getElement=function(){return this.targetElm||(this.targetElm=ww.get(this.id)),this.targetElm},Aw.prototype.getWin=function(){var t;return this.contentWindow||(t=this.iframeElement)&&(this.contentWindow=t.contentWindow),this.contentWindow},Aw.prototype.getDoc=function(){var t;return this.contentDocument||(t=this.getWin())&&(this.contentDocument=t.document),this.contentDocument},Aw.prototype.getBody=function(){var t=this.getDoc();return this.bodyElement||(t?t.body:null)},Aw.prototype.convertURL=function(t,e,n){var r=this.settings;return r.urlconverter_callback?this.execCallback("urlconverter_callback",t,n,!0,e):!r.convert_urls||n&&"LINK"===n.nodeName||0===t.indexOf("file:")||0===t.length?t:r.relative_urls?this.documentBaseURI.toRelative(t):t=this.documentBaseURI.toAbsolute(t,r.remove_script_host)},Aw.prototype.addVisual=function(t){!function(t,e){return n=e,am(t).editor.addVisual(n);var n}(this,t)},Aw.prototype.remove=function(){!function(t){var e,n,r,i,o;t.removed||(e=t._selectionOverrides,n=t.editorUpload,r=t.getBody(),i=t.getElement(),r&&t.save({is_removing:!0}),t.removed=!0,t.unbindAllNativeEvents(),t.hasHiddenInput&&i&&Im.remove(i.nextSibling),t.fire("remove"),t.editorManager.remove(t),!t.inline&&r&&Im.setStyle((o=t).id,"display",o.orgDisplay),t.fire("detach"),Im.remove(t.getContainer()),Dm(e),Dm(n),t.destroy())}(this)},Aw.prototype.destroy=function(t){!function(t,e){var n,r,i,o=t.selection,a=t.dom;t.destroyed||(e||t.removed?(e||(t.editorManager.off("beforeunload",t._beforeUnload),t.theme&&t.theme.destroy&&t.theme.destroy(),Dm(o),Dm(a)),(r=(n=t).formElement)&&(r._mceOldSubmit&&(r.submit=r._mceOldSubmit,r._mceOldSubmit=null),Im.unbind(r,"submit reset",n.formEventDelegate)),(i=t).contentAreaContainer=i.formElement=i.container=i.editorContainer=null,i.bodyElement=i.contentDocument=i.contentWindow=null,i.iframeElement=i.targetElm=null,i.selection&&(i.selection=i.selection.win=i.selection.dom=i.selection.dom.doc=null),t.destroyed=!0):t.remove())}(this,t)},Aw.prototype.uploadImages=function(t){return this.editorUpload.uploadImages(t)},Aw.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},Aw.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},Aw.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},Aw.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},Aw.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},Aw);function Aw(t,e,n){var r=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,Sw(this,ow),this.settings=function(t,e,n,r,i){var o,a,s,l,u=(o=n,a=Rm,s=t,l={id:e,theme:"silver",toolbar_mode:Hm(i,"floating"),plugins:"",document_base_url:o,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:s.convertURL,url_converter_scope:s},Tt(Tt({},l),a?zm:{}));return function(t,e,n,r,i){var o,a,s,l,u,c,d=t?{mobile:(o=i.mobile||{},a=e,s={resize:!1,toolbar_mode:Hm(o,"scrolling"),toolbar_sticky:!1},Tt(Tt(Tt({},zm),s),a?{menubar:!1}:{}))}:{},f=function(t,e){var n,r=ht(e,function(e,n){return W(t,n)});return n=r.f,{sections:w(r.t),settings:w(n)}}(["mobile"],Pm(d,i)),h=Me.extend(n,r,f.settings(),t&&Fm(f,"mobile")?function(t,e,n){void 0===n&&(n={});var r=t.sections(),i=r.hasOwnProperty(e)?r[e]:{};return Me.extend({},n,i)}(f,"mobile"):{},{validate:!0,external_plugins:(l=r,u=f.settings(),c=u.external_plugins?u.external_plugins:{},l&&l.external_plugins?Me.extend({},l.external_plugins,c):c)});return function(t,e,n,r){var i,o,a=Vm(n.forced_plugins),s=Vm(r.plugins),l=Fm(i=e,"mobile")?i.sections().mobile:{},u=function(t,e,n,r){return t&&(a=o="mobile",s=(i=e).sections(),Fm(i,o)&&s[o].theme===a)?X(r,C(W,Bm)):t&&Fm(e,"mobile")?r:n;var i,o,a,s}(t,e,s,l.plugins?Vm(l.plugins):s),c=(o=u,[].concat(Vm(a)).concat(Vm(o)));if(be.browser.isIE()&&W(c,"rtc"))throw new Error("RTC plugin is not supported on IE 11.");return Me.extend(r,{plugins:c.join(" ")})}(t,f,r,h)}(Lm||Nm,Lm,u,r,i)}(this,t,this.documentBaseUrl,n.defaultSettings,e),this.settings.suffix&&(n.suffix=this.settings.suffix),this.suffix=n.suffix,this.settings.base_url&&n._setBaseUrl(this.settings.base_url),this.baseUri=n.baseURI,this.settings.referrer_policy&&(hs.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),us.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),bs.languageLoad=this.settings.language_load,bs.baseURL=n.baseURL,this.id=t,this.setDirty(!1),this.documentBaseURI=new bw(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new hw(this),this.editorCommands=new W_(this),this.settings.cache_suffix&&(be.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:gw(),styleSheetLoader:void 0,show:b,hide:b,enable:b,disable:b,isDisabled:P};var i=function(t){var e,n,r=gs("design"),i=gs({design:{activate:b,deactivate:b,editorReadOnly:!1},readonly:{activate:b,deactivate:b,editorReadOnly:!0}});return(e=t).serializer?Y_(e):e.on("PreInit",function(){Y_(e)}),(n=t).on("ShowCaret",function(t){X_(n)&&t.preventDefault()}),n.on("ObjectSelected",function(t){X_(n)&&t.preventDefault()}),{isReadOnly:function(){return X_(t)},set:function(e){return function(t,e,n,r){if(r!==n.get()){if(!mt(e,r))throw new Error("Editor mode '"+r+"' is invalid");t.initialized?sw(t,n,e,r):t.on("init",function(){return sw(t,n,e,r)})}}(t,i.get(),r,e)},get:function(){return r.get()},register:function(t,e){i.set(function(t,e,n){var r;if(W(aw,e))throw new Error("Cannot override default mode "+e);return Tt(Tt({},t),((r={})[e]=Tt(Tt({},n),{deactivate:function(){try{n.deactivate()}catch(mS){console.error("problem while deactivating editor mode "+e+":",mS)}}}),r))}(i.get(),t,e))}}}(this);this.mode=i,this.setMode=i.set,n.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=ns.overrideDefaults(function(){return{context:r.inline?r.getBody():r.getDoc(),element:r.getBody()}})}var Iw,Dw=us.DOM,Ow=Me.explode,Pw=Me.each,Ew=Me.extend,Rw=0,Lw=!1,Nw=[],Bw=[],zw=function(t){var e=t.type;Pw(Ww.get(),function(n){switch(e){case"scroll":n.fire("ScrollWindow",t);break;case"resize":n.fire("ResizeWindow",t)}})},Vw=function(t){t!==Lw&&(t?ns(window).on("resize scroll",zw):ns(window).off("resize scroll",zw),Lw=t)},Fw=function(t){var e=Bw;delete Nw[t.id];for(var n=0;n<Nw.length;n++)if(Nw[n]===t){Nw.splice(n,1);break}return Bw=X(Bw,function(e){return t!==e}),Ww.activeEditor===t&&(Ww.activeEditor=0<Bw.length?Bw[0]:null),Ww.focusedEditor===t&&(Ww.focusedEditor=null),e.length!==Bw.length},Hw="CSS1Compat"!==document.compatMode,Ww=Tt(Tt({},tw),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:ns,majorVersion:"5",minorVersion:"8.2",releaseDate:"2021-06-23",editors:Nw,i18n:xs,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var t,e="",n=bw.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));var r,i=window.tinymce||window.tinyMCEPreInit;if(i)t=i.base||i.baseURL,e=i.suffix;else{for(var o,a=document.getElementsByTagName("script"),s=0;s<a.length;s++)if(""!==(o=a[s].src||"")){var l=o.substring(o.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(o)){-1!==l.indexOf(".min")&&(e=".min"),t=o.substring(0,o.lastIndexOf("/"));break}}!t&&document.currentScript&&(-1!==(o=document.currentScript.src).indexOf(".min")&&(e=".min"),t=o.substring(0,o.lastIndexOf("/")))}this.baseURL=new bw(n).toAbsolute(t),this.documentBaseURL=n,this.baseURI=new bw(this.baseURL),this.suffix=e,(r=this).on("AddEditor",C(Tf,r)),r.on("RemoveEditor",C(kf,r))},overrideDefaults:function(t){var e=t.base_url;e&&this._setBaseUrl(e),t.suffix&&(this.suffix=t.suffix);var n=(this.defaultSettings=t).plugin_base_urls;void 0!==n&&lt(n,function(t,e){bs.PluginManager.urls[e]=t})},init:function(t){var e,n=this,r=Me.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),i=function(t){var e=t.id;return e||(e=gt(t,"name").filter(function(t){return!Dw.get(t)}).getOrThunk(Dw.uniqueId),t.setAttribute("id",e)),e},o=function(t,e){return e.constructor===RegExp?e.test(t.className):Dw.hasClass(t,e)},a=function(t){e=t},s=function(){var e,l=0,u=[],c=function(t,r,i){var o=new kw(t,r,n);u.push(o),o.on("init",function(){++l===e.length&&a(u)}),o.targetElm=o.targetElm||i,o.render()};Dw.unbind(window,"ready",s),function(e){var r=t.onpageload;r&&r.apply(n,[])}(),e=ns.unique(function(t){var e=[];if(be.browser.isIE()&&be.browser.version.major<11)return av("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(Hw)return av("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(t.types)return Pw(t.types,function(t){e=e.concat(Dw.select(t.selector))}),e;if(t.selector)return Dw.select(t.selector);if(t.target)return[t.target];switch(t.mode){case"exact":var n=t.elements||"";0<n.length&&Pw(Ow(n),function(t){var n=Dw.get(t);n?e.push(n):Pw(document.forms,function(n){Pw(n.elements,function(n){n.name===t&&(t="mce_editor_"+Rw++,Dw.setAttrib(n,"id",t),e.push(n))})})});break;case"textareas":case"specific_textareas":Pw(Dw.select("textarea"),function(n){t.editor_deselector&&o(n,t.editor_deselector)||t.editor_selector&&!o(n,t.editor_selector)||e.push(n)})}return e}(t)),t.types?Pw(t.types,function(n){Me.each(e,function(e){return!Dw.is(e,n.selector)||(c(i(e),Ew({},t,n),e),!1)})}):(Me.each(e,function(t){var e;(e=n.get(t.id))&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(Fw(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0,e=null)}),0===(e=Me.grep(e,function(t){return!n.get(t.id)})).length?a([]):Pw(e,function(e){t.inline&&e.tagName.toLowerCase()in r?av("Could not initialize inline editor on invalid inline target element",e):c(i(e),t,e)}))};return n.settings=t,Dw.bind(window,"ready",s),new Ir(function(t){e?t(e):a=function(e){t(e)}})},get:function(t){return 0===arguments.length?Bw.slice(0):c(t)?Z(Bw,function(e){return e.id===t}).getOr(null):x(t)&&Bw[t]?Bw[t]:null},add:function(t){var e=this;return Nw[t.id]===t||(null===e.get(t.id)&&("length"!==t.id&&(Nw[t.id]=t),Nw.push(t),Bw.push(t)),Vw(!0),e.activeEditor=t,e.fire("AddEditor",{editor:t}),Iw||(Iw=function(t){var n=e.fire("BeforeUnload");if(n.returnValue)return t.preventDefault(),t.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",Iw))),t},createEditor:function(t,e){return this.add(new kw(t,e,this))},remove:function(t){var e,n,r=this;if(t){if(!c(t))return h(r.get((n=t).id))?null:(Fw(n)&&r.fire("RemoveEditor",{editor:n}),0===Bw.length&&window.removeEventListener("beforeunload",Iw),n.remove(),Vw(0<Bw.length),n);Pw(Dw.select(t),function(t){(n=r.get(t.id))&&r.remove(n)})}else for(e=Bw.length-1;0<=e;e--)r.remove(Bw[e])},execCommand:function(t,e,n){var r=this.get(n);switch(t){case"mceAddEditor":return this.get(n)||new kw(n,this.settings,this).render(),!0;case"mceRemoveEditor":return r&&r.remove(),!0;case"mceToggleEditor":return r?(r.isHidden()?r.show():r.hide(),!0):(this.execCommand("mceAddEditor",!1,n),!0)}return!!this.activeEditor&&this.activeEditor.execCommand(t,e,n)},triggerSave:function(){Pw(Bw,function(t){t.save()})},addI18n:function(t,e){xs.add(t,e)},translate:function(t){return xs.translate(t)},setActive:function(t){var e=this.activeEditor;this.activeEditor!==t&&(e&&e.fire("deactivate",{relatedTarget:t}),t.fire("activate",{relatedTarget:e})),this.activeEditor=t},_setBaseUrl:function(t){this.baseURL=new bw(this.documentBaseURL).toAbsolute(t.replace(/\/+$/,"")),this.baseURI=new bw(this.baseURL)}});Ww.setup();var jw,Gw,Uw,qw,Xw=Math.min,Yw=Math.max,$w=Math.round,Zw=function(t,e,n){var r=e.x,i=e.y,o=t.w,a=t.h,s=e.w,l=e.h,u=(n||"").split("");return"b"===u[0]&&(i+=l),"r"===u[1]&&(r+=s),"c"===u[0]&&(i+=$w(l/2)),"c"===u[1]&&(r+=$w(s/2)),"b"===u[3]&&(i-=a),"r"===u[4]&&(r-=o),"c"===u[3]&&(i-=$w(a/2)),"c"===u[4]&&(r-=$w(o/2)),Kw(r,i,o,a)},Kw=function(t,e,n,r){return{x:t,y:e,w:n,h:r}},Jw={inflate:function(t,e,n){return Kw(t.x-e,t.y-n,t.w+2*e,t.h+2*n)},relativePosition:Zw,findBestRelativePosition:function(t,e,n,r){for(var i,o=0;o<r.length;o++)if((i=Zw(t,e,r[o])).x>=n.x&&i.x+i.w<=n.w+n.x&&i.y>=n.y&&i.y+i.h<=n.h+n.y)return r[o];return null},intersect:function(t,e){var n=Yw(t.x,e.x),r=Yw(t.y,e.y),i=Xw(t.x+t.w,e.x+e.w),o=Xw(t.y+t.h,e.y+e.h);return i-n<0||o-r<0?null:Kw(n,r,i-n,o-r)},clamp:function(t,e,n){var r=t.x,i=t.y,o=t.x+t.w,a=t.y+t.h,s=e.x+e.w,l=e.y+e.h,u=Yw(0,e.x-r),c=Yw(0,e.y-i),d=Yw(0,o-s),f=Yw(0,a-l);return r+=u,i+=c,n&&(o+=u,a+=c,r-=d,i-=f),Kw(r,i,(o-=d)-r,(a-=f)-i)},create:Kw,fromClientRect:function(t){return Kw(t.left,t.top,t.width,t.height)}},Qw=(jw={},Gw={},{load:function(t,e){var n='Script at URL "'+e+'" failed to load',r='Script at URL "'+e+"\" did not call `tinymce.Resource.add('"+t+"', data)` within 1 second";if(void 0!==jw[t])return jw[t];var i=new Ir(function(i,o){var a=function(t,e,n){void 0===n&&(n=1e3);var r=!1,i=null,o=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];r||(r=!0,null!==i&&(clearTimeout(i),i=null),t.apply(null,e))}},a=o(t),s=o(e);return{start:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r||null!==i||(i=setTimeout(function(){return s.apply(null,t)},n))},resolve:a,reject:s}}(i,o);Gw[t]=a.resolve,hs.ScriptLoader.loadScript(e,function(){return a.start(r)},function(){return a.reject(n)})});return jw[t]=i},add:function(t,e){void 0!==Gw[t]&&(Gw[t](e),delete Gw[t]),jw[t]=Ir.resolve(e)}}),tS=Me.each,eS=Me.extend,nS=function(){};nS.extend=Uw=function(t){var e=this.prototype,n=function(){var t,e,n;if(!qw&&(this.init&&this.init.apply(this,arguments),e=this.Mixins))for(t=e.length;t--;)(n=e[t]).init&&n.init.apply(this,arguments)},r=function(){return this};qw=!0;var i=new this;return qw=!1,t.Mixins&&(tS(t.Mixins,function(e){for(var n in e)"init"!==n&&(t[n]=e[n])}),e.Mixins&&(t.Mixins=e.Mixins.concat(t.Mixins))),t.Methods&&tS(t.Methods.split(","),function(e){t[e]=r}),t.Properties&&tS(t.Properties.split(","),function(e){var n="_"+e;t[e]=function(t){return void 0!==t?(this[n]=t,this):this[n]}}),t.Statics&&tS(t.Statics,function(t,e){n[e]=t}),t.Defaults&&e.Defaults&&(t.Defaults=eS({},e.Defaults,t.Defaults)),lt(t,function(t,n){var r,o;i[n]="function"==typeof t&&e[n]?(r=n,o=t,function(){var t=this._super;this._super=e[r];var n=o.apply(this,arguments);return this._super=t,n}):t}),n.prototype=i,(n.constructor=n).extend=Uw,n};var rS=Math.min,iS=Math.max,oS=Math.round,aS={serialize:function(t){var e=JSON.stringify(t);return c(e)?e.replace(/[\u0080-\uFFFF]/g,function(t){var e=t.charCodeAt(0).toString(16);return"\\u"+"0000".substring(e.length)+e}):e},parse:function(t){try{return JSON.parse(t)}catch(e){}}},sS={callbacks:{},count:0,send:function(t){var e=this,n=us.DOM,r=void 0!==t.count?t.count:e.count,i="tinymce_jsonp_"+r;e.callbacks[r]=function(o){n.remove(i),delete e.callbacks[r],t.callback(o)},n.add(n.doc.body,"script",{id:i,src:t.url,type:"text/javascript"}),e.count++}},lS=Tt(Tt({},tw),{send:function(t){var e,n=0,r=function(){!t.async||4===e.readyState||1e4<n++?(t.success&&n<1e4&&200===e.status?t.success.call(t.success_scope,""+e.responseText,e,t):t.error&&t.error.call(t.error_scope,1e4<n?"TIMED_OUT":"GENERAL",e,t),e=null):Vr.setTimeout(r,10)};if(t.scope=t.scope||this,t.success_scope=t.success_scope||t.scope,t.error_scope=t.error_scope||t.scope,t.async=!1!==t.async,t.data=t.data||"",lS.fire("beforeInitialize",{settings:t}),(e=new XMLHttpRequest).overrideMimeType&&e.overrideMimeType(t.content_type),e.open(t.type||(t.data?"POST":"GET"),t.url,t.async),t.crossDomain&&(e.withCredentials=!0),t.content_type&&e.setRequestHeader("Content-Type",t.content_type),t.requestheaders&&Me.each(t.requestheaders,function(t){e.setRequestHeader(t.key,t.value)}),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),(e=lS.fire("beforeSend",{xhr:e,settings:t}).xhr).send(t.data),!t.async)return r();Vr.setTimeout(r,10)}}),uS=Me.extend,cS=(dS.sendRPC=function(t){return(new dS).send(t)},dS.prototype.send=function(t){var e=t.error,n=t.success,r=uS(this.settings,t);r.success=function(t,i){void 0===(t=aS.parse(t))&&(t={error:"JSON Parse error."}),t.error?e.call(r.error_scope||r.scope,t.error,i):n.call(r.success_scope||r.scope,t.result)},r.error=function(t,n){e&&e.call(r.error_scope||r.scope,t,n)},r.data=aS.serialize({id:t.id||"c"+this.count++,method:t.method,params:t.params}),r.content_type="application/json",lS.send(r)},dS);function dS(t){this.settings=uS({},t),this.count=0}try{var fS,hS="__storage_test__";(fS=window.localStorage).setItem(hS,hS),fS.removeItem(hS)}catch(mS){fS=function(){return t={},e=[],n={getItem:function(e){return t[e]||null},setItem:function(n,r){e.push(n),t[n]=String(r)},key:function(t){return e[t]},removeItem:function(n){e=e.filter(function(t){return t===n}),delete t[n]},clear:function(){e=[],t={}},length:0},Object.defineProperty(n,"length",{get:function(){return e.length},configurable:!1,enumerable:!1}),n;var t,e,n}()}var pS,gS=Me.extend(Ww,{geom:{Rect:Jw},util:{Promise:Ir,Delay:Vr,Tools:Me,VK:Cd,URI:bw,Class:nS,EventDispatcher:Z_,Observable:tw,I18n:xs,XHR:lS,JSON:aS,JSONRequest:cS,JSONP:sS,LocalStorage:fS,Color:function(t){var e={},n=0,r=0,i=0,o=function(t){var o;return"object"==typeof t?"r"in t?(n=t.r,r=t.g,i=t.b):"v"in t&&function(t,e,o){if(t=(parseInt(t,10)||0)%360,e=parseInt(e,10)/100,o=parseInt(o,10)/100,e=iS(0,rS(e,1)),o=iS(0,rS(o,1)),0!==e){var a=t/60,s=o*e,l=s*(1-Math.abs(a%2-1)),u=o-s;switch(Math.floor(a)){case 0:n=s,r=l,i=0;break;case 1:n=l,r=s,i=0;break;case 2:n=0,r=s,i=l;break;case 3:n=0,r=l,i=s;break;case 4:n=l,r=0,i=s;break;case 5:n=s,r=0,i=l;break;default:n=r=i=0}n=oS(255*(n+u)),r=oS(255*(r+u)),i=oS(255*(i+u))}else n=r=i=oS(255*o)}(t.h,t.s,t.v):(o=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(t))?(n=parseInt(o[1],10),r=parseInt(o[2],10),i=parseInt(o[3],10)):(o=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(t))?(n=parseInt(o[1],16),r=parseInt(o[2],16),i=parseInt(o[3],16)):(o=/#([0-F])([0-F])([0-F])/gi.exec(t))&&(n=parseInt(o[1]+o[1],16),r=parseInt(o[2]+o[2],16),i=parseInt(o[3]+o[3],16)),n=n<0?0:255<n?255:n,r=r<0?0:255<r?255:r,i=i<0?0:255<i?255:i,e};return t&&o(t),e.toRgb=function(){return{r:n,g:r,b:i}},e.toHsv=function(){return t=n,e=r,o=i,s=0,(l=rS(t/=255,rS(e/=255,o/=255)))===(u=iS(t,iS(e,o)))?{h:0,s:0,v:100*(s=l)}:(a=(u-l)/u,{h:oS(60*((t===l?3:o===l?1:5)-(t===l?e-o:o===l?t-e:o-t)/((s=u)-l))),s:oS(100*a),v:oS(100*s)});var t,e,o,a,s,l,u},e.toHex=function(){var t=function(t){return 1<(t=parseInt(t,10).toString(16)).length?t:"0"+t};return"#"+t(n)+t(r)+t(i)},e.parse=o,e},ImageUploader:function(t){var e=lv(),n=fv(t,e);return{upload:function(e,r){return void 0===r&&(r=!0),n.upload(e,r?dv(t):void 0)}}}},dom:{EventUtils:vo,Sizzle:va,DomQuery:ns,TreeWalker:Wr,TextSeeker:Hs,DOMUtils:us,ScriptLoader:hs,RangeUtils:zd,Serializer:km,StyleSheetLoader:Fr,ControlSelection:Td,BookmarkManager:bd,Selection:fm,Event:vo.Event},html:{Styles:lo,Entities:Zi,Node:Hf,Schema:ao,SaxParser:Xf,DomParser:Mm,Writer:Qf,Serializer:th},Env:be,AddOnManager:bs,Annotator:xd,Formatter:yv,UndoManager:xv,EditorCommands:W_,WindowManager:tv,NotificationManager:Km,EditorObservable:ow,Shortcuts:hw,Editor:kw,FocusManager:Sf,EditorManager:Ww,DOM:us.DOM,ScriptLoader:hs.ScriptLoader,PluginManager:Jm,ThemeManager:Qm,IconManager:jm,Resource:Qw,trim:Me.trim,isArray:Me.isArray,is:Me.is,toArray:Me.toArray,makeMap:Me.makeMap,each:Me.each,map:Me.map,grep:Me.grep,inArray:Me.inArray,extend:Me.extend,create:Me.create,walk:Me.walk,createNS:Me.createNS,resolve:Me.resolve,explode:Me.explode,_addCacheSuffix:Me._addCacheSuffix,isOpera:be.opera,isWebKit:be.webkit,isIE:be.ie,isGecko:be.gecko,isMac:be.mac});pS=gS,window.tinymce=pS,window.tinyMCE=pS,function(t){if("object"==typeof module)try{module.exports=t}catch(e){}}(gS)}(),function(){"use strict";var t=function(){return(t=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function e(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function n(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var r=function(t){return function(e){return r=typeof(n=e),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===t;var n,r}},i=function(t){return function(e){return typeof e===t}},o=r("string"),a=r("object"),s=r("array"),l=i("boolean"),u=function(t){return!(null===(e=t)||void 0===e);var e},c=i("function"),d=i("number"),f=function(){},h=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))}},p=function(t){return function(){return t}},g=function(t){return t};function m(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=e.concat(n);return t.apply(null,i)}}var v,y,x,b,_,w,S=function(t){return function(e){return!t(e)}},C=function(t){return function(){throw new Error(t)}},M=function(t){return t()},T=p(!1),k=p(!0),A=function(t){var e,n=!1;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return n||(n=!0,e=t.apply(null,r)),e}},I=function(){return D},D=(v=function(t){return t.isNone()},{fold:function(t,e){return t()},is:T,isSome:T,isNone:k,getOr:x=function(t){return t},getOrThunk:y=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:p(null),getOrUndefined:p(void 0),or:x,orThunk:y,map:I,each:f,bind:I,exists:T,forall:k,filter:I,equals:v,equals_:v,toArray:function(){return[]},toString:p("none()")}),O=function(t){var e=p(t),n=function(){return i},r=function(e){return e(t)},i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:k,isNone:T,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return O(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?i:D},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(T,function(e){return n(t,e)})}};return i},P={some:O,none:I,from:function(t){return null==t?D:O(t)}},E=Array.prototype.slice,R=Array.prototype.indexOf,L=Array.prototype.push,N=function(t,e){return-1<R.call(t,e)},B=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return!0;return!1},z=function(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;i++)r[i]=e(t[i],i);return r},V=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)},F=function(t,e){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];e(o,r)&&n.push(o)}return n},H=function(t,e,n){return function(t,e){for(var n=t.length-1;0<=n;n--)e(t[n])}(t,function(t){n=e(n,t)}),n},W=function(t,e,n){return V(t,function(t){n=e(n,t)}),n},j=function(t,e){return function(t,e,n){for(var r=0,i=t.length;r<i;r++){var o=t[r];if(e(o,r))return P.some(o);if(n(o,r))break}return P.none()}(t,e,T)},G=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return P.some(n);return P.none()},U=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!s(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);L.apply(e,t[n])}return e},q=function(t,e){return U(z(t,e))},X=function(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n))return!1;return!0},Y=function(t){var e=E.call(t,0);return e.reverse(),e},$=function(t,e){return F(t,function(t){return!N(e,t)})},Z=function(t){return[t]},K=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return P.none()},J=function(){return Q(0,0)},Q=function(t,e){return{major:t,minor:e}},tt=function(t,e){var n=String(e).toLowerCase();return 0===t.length?J():function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return Q(r(1),r(2))}(t,n)},et=J,nt=function(t,e){var n=String(e).toLowerCase();return j(t,function(t){return t.search(n)})},rt=function(t,e){return-1!==t.indexOf(e)},it=(b=/^\s+|\s+$/g,function(t){return t.replace(b,"")}),ot=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,at=function(t){return function(e){return rt(e,t)}},st=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return rt(t,"edge/")&&rt(t,"chrome")&&rt(t,"safari")&&rt(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ot],search:function(t){return rt(t,"chrome")&&!rt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return rt(t,"msie")||rt(t,"trident")}},{name:"Opera",versionRegexes:[ot,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:at("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:at("firefox")},{name:"Safari",versionRegexes:[ot,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(rt(t,"safari")||rt(t,"mobile/"))&&rt(t,"applewebkit")}}],lt=[{name:"Windows",search:at("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return rt(t,"iphone")||rt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:at("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:at("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:at("linux"),versionRegexes:[]},{name:"Solaris",search:at("sunos"),versionRegexes:[]},{name:"FreeBSD",search:at("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:at("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ut={browsers:p(st),oses:p(lt)},ct="Firefox",dt=function(t){var e=t.current,n=function(t){return function(){return e===t}};return{current:e,version:t.version,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(ct),isSafari:n("Safari")}},ft=function(){return dt({current:void 0,version:et()})},ht=dt,pt=(p("Edge"),p("Chrome"),p("IE"),p("Opera"),p(ct),p("Safari"),"Windows"),gt="Android",mt="Solaris",vt="FreeBSD",yt="ChromeOS",xt=function(t){var e=t.current,n=function(t){return function(){return e===t}};return{current:e,version:t.version,isWindows:n(pt),isiOS:n("iOS"),isAndroid:n(gt),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(mt),isFreeBSD:n(vt),isChromeOS:n(yt)}},bt=function(){return xt({current:void 0,version:et()})},_t=xt,wt=(p(pt),p("iOS"),p(gt),p("Linux"),p("OSX"),p(mt),p(vt),p(yt),function(t,e){var n,r,i,o,a,s,l,u,c,d,f,h,g=ut.browsers(),m=ut.oses(),v=function(t,e){return nt(t,e).map(function(t){var n=tt(t.versionRegexes,e);return{current:t.name,version:n}})}(g,t).fold(ft,ht),y=function(t,e){return nt(t,e).map(function(t){var n=tt(t.versionRegexes,e);return{current:t.name,version:n}})}(m,t).fold(bt,_t);return{browser:v,os:y,deviceType:(r=v,i=t,o=e,a=(n=y).isiOS()&&!0===/ipad/i.test(i),s=n.isiOS()&&!a,l=n.isiOS()||n.isAndroid(),u=l||o("(pointer:coarse)"),c=a||!s&&l&&o("(min-device-width:768px)"),d=s||l&&!c,f=r.isSafari()&&n.isiOS()&&!1===/safari/i.test(i),h=!d&&!c&&!f,{isiPad:p(a),isiPhone:p(s),isTablet:p(c),isPhone:p(d),isTouch:p(u),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:p(f),isDesktop:p(h)})}}),St=function(t){return window.matchMedia(t).matches},Ct=A(function(){return wt(navigator.userAgent,St)}),Mt=function(){return Ct()},Tt=p,kt=Tt("touchstart"),At=Tt("touchmove"),It=Tt("touchend"),Dt=Tt("mousedown"),Ot=Tt("mousemove"),Pt=Tt("mouseup"),Et=Tt("mouseover"),Rt=Tt("keydown"),Lt=Tt("keyup"),Nt=Tt("input"),Bt=Tt("change"),zt=Tt("click"),Vt=Tt("transitionend"),Ft=Tt("selectstart"),Ht=function(t){return p("alloy."+t)},Wt={tap:Ht("tap")},jt=Ht("focus"),Gt=Ht("blur.post"),Ut=Ht("paste.post"),qt=Ht("receive"),Xt=Ht("execute"),Yt=Ht("focus.item"),$t=Wt.tap,Zt=Ht("longpress"),Kt=Ht("system.init"),Jt=Ht("system.attached"),Qt=Ht("system.detached"),te=Ht("focusmanager.shifted"),ee=Ht("highlight"),ne=Ht("dehighlight"),re=function(t,e){se(t,t.element,e,{})},ie=function(t,e,n){se(t,t.element,e,n)},oe=function(t){re(t,Xt())},ae=function(t,e,n){se(t,e,n,{})},se=function(e,n,r,i){var o=t({target:n},i);e.getSystem().triggerEvent(r,n,o)},le=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},ue=function(t,e){var n=(e||document).createElement(t);return le(n)},ce=le,de=function(t,e){var n=t.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},fe=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},he=function(t,e){var n=void 0===e?document:e.dom;return fe(n)?[]:z(n.querySelectorAll(t),ce)},pe=function(t,e){var n=void 0===e?document:e.dom;return fe(n)?P.none():P.from(n.querySelector(t)).map(ce)},ge=function(t,e){return t.dom===e.dom},me=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),ve=function(t){return function(e){return e.dom.nodeType===t}},ye=ve(1),xe=ve(3),be=ve(9),_e=ve(11),we=function(t){return ce(t.dom.ownerDocument)},Se=function(t){return be(t)?t:we(t)},Ce=function(t){return P.from(t.dom.parentNode).map(ce)},Me=function(t){return z(t.dom.childNodes,ce)},Te=function(t,e){return P.from(t.dom.childNodes[e]).map(ce)},ke=function(t,e){Ce(t).each(function(n){n.dom.insertBefore(e.dom,t.dom)})},Ae=function(t,e){var n;(n=t,P.from(n.dom.nextSibling).map(ce)).fold(function(){Ce(t).each(function(t){De(t,e)})},function(t){ke(t,e)})},Ie=function(t,e){Te(t,0).fold(function(){De(t,e)},function(n){t.dom.insertBefore(e.dom,n.dom)})},De=function(t,e){t.dom.appendChild(e.dom)},Oe=function(t,e){V(e,function(e){De(t,e)})},Pe=function(t){t.dom.textContent="",V(Me(t),function(t){Ee(t)})},Ee=function(t){var e=t.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Re=function(t){return _e(t)&&u(t.dom.host)},Le=c(Element.prototype.attachShadow)&&c(Node.prototype.getRootNode),Ne=p(Le),Be=Le?function(t){return ce(t.dom.getRootNode())}:Se,ze=function(t){return ce(t.dom.host)},Ve=function(t){var e=xe(t)?t.dom.parentNode:t.dom;if(null==e||null===e.ownerDocument)return!1;var n,r,i,o,a=e.ownerDocument;return i=ce(e),o=Be(i),(Re(o)?P.some(o):P.none()).fold(function(){return a.body.contains(e)},(n=Ve,r=ze,function(t){return n(r(t))}))},Fe=function(){return He(ce(document))},He=function(t){var e=t.dom.body;if(null==e)throw new Error("Body is not available yet");return ce(e)},We=function(t){re(t,Qt());var e=t.components();V(e,We)},je=function(t){var e=t.components();V(e,je),re(t,Jt())},Ge=function(t,e){De(t.element,e.element)},Ue=function(t,e,n){t.getSystem().addToWorld(e),n(t.element,e.element),Ve(t.element)&&je(e),t.syncComponents()},qe=function(t){var e,n=Ce(t.element).bind(function(e){return t.getSystem().getByDom(e).toOptional()});We(e=t),Ee(e.element),e.getSystem().removeFromWorld(e),n.each(function(t){t.syncComponents()})},Xe=Object.keys,Ye=Object.hasOwnProperty,$e=function(t,e){for(var n=Xe(t),r=0,i=n.length;r<i;r++){var o=n[r];e(t[o],o)}},Ze=function(t,e){return Ke(t,function(t,n){return{k:n,v:e(t,n)}})},Ke=function(t,e){var n={};return $e(t,function(t,r){var i=e(t,r);n[i.k]=i.v}),n},Je=function(t,e){var n=[];return $e(t,function(t,r){n.push(e(t,r))}),n},Qe=function(t,e){return tn(t,e)?P.from(t[e]):P.none()},tn=function(t,e){return Ye.call(t,e)},en=function(t,e){return tn(t,e)&&null!=t[e]},nn=function(t,e,n){if(!(o(n)||l(n)||d(n)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},rn=function(t,e,n){nn(t.dom,e,n)},on=function(t,e){var n=t.dom;$e(e,function(t,e){nn(n,e,t)})},an=function(t,e){var n=t.dom.getAttribute(e);return null===n?void 0:n},sn=function(t,e){return P.from(an(t,e))},ln=function(t,e){var n=t.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},un=function(t,e){t.dom.removeAttribute(e)},cn=function(t,e){var n=an(t,e);return void 0===n||""===n?[]:n.split(" ")},dn=function(t){return void 0!==t.dom.classList},fn=function(t,e){dn(t)?t.dom.classList.add(e):function(t,e){return r=e,i=cn(n=t,"class").concat([r]),rn(n,"class",i.join(" ")),!0;var n,r,i}(t,e)},hn=function(t,e){dn(t)?t.dom.classList.remove(e):function(t,e){return i=e,0<(o=F(cn(n=t,r="class"),function(t){return t!==i})).length?rn(n,r,o.join(" ")):un(n,r),!1;var n,r,i,o}(t,e),function(t){0===(dn(t)?t.dom.classList:cn(t,"class")).length&&un(t,"class")}(t)},pn=function(t,e){return dn(t)&&t.dom.classList.contains(e)},gn=function(t,e,n){hn(t,n),fn(t,e)},mn=Object.freeze({__proto__:null,toAlpha:function(t,e,n){gn(t.element,e.alpha,e.omega)},toOmega:function(t,e,n){gn(t.element,e.omega,e.alpha)},isAlpha:function(t,e,n){return pn(t.element,e.alpha)},isOmega:function(t,e,n){return pn(t.element,e.omega)},clear:function(t,e,n){hn(t.element,e.alpha),hn(t.element,e.omega)}}),vn=function(t){return{is:function(e){return t===e},isValue:k,isError:T,getOr:p(t),getOrThunk:p(t),getOrDie:p(t),or:function(e){return vn(t)},orThunk:function(e){return vn(t)},fold:function(e,n){return n(t)},map:function(e){return vn(e(t))},mapError:function(e){return vn(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOptional:function(){return P.some(t)}}},yn=function(t){return{is:T,isValue:T,isError:k,getOr:g,getOrThunk:function(t){return t()},getOrDie:function(){return C(String(t))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return yn(t)},mapError:function(e){return yn(e(t))},each:f,bind:function(e){return yn(t)},exists:T,forall:k,toOptional:P.none}},xn={value:vn,error:yn,fromOption:function(t,e){return t.fold(function(){return yn(e)},vn)}};(w=_=_||{})[w.Error=0]="Error",w[w.Value=1]="Value";var bn,_n,wn,Sn,Cn=function(t,e,n){return t.stype===_.Error?e(t.serror):n(t.svalue)},Mn=function(t){return{stype:_.Value,svalue:t}},Tn=function(t){return{stype:_.Error,serror:t}},kn=Mn,An=function(t){var e=[],n=[];return V(t,function(t){Cn(t,function(t){return n.push(t)},function(t){return e.push(t)})}),{values:e,errors:n}},In=Tn,Dn=function(t,e){return t.stype===_.Value?e(t.svalue):t},On=function(t,e){return t.stype===_.Value?{stype:_.Value,svalue:e(t.svalue)}:t},Pn=function(t){if(!s(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],n={};return V(t,function(r,i){var o=Xe(r);if(1!==o.length)throw new Error("one and only one name per case");var a=o[0],l=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!s(l))throw new Error("case arguments must be an array");e.push(a),n[a]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=n.length;if(o!==l.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+l.length+" ("+l+"), got "+o);return{fold:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+e.length);return e[i].apply(null,n)},match:function(t){var r=Xe(t);if(e.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+r.join(","));if(!X(e,function(t){return N(r,t)}))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+e.join(", "));return t[a].apply(null,n)},log:function(t){console.log(t,{constructors:e,constructor:a,params:n})}}}}),n},En=Object.prototype.hasOwnProperty,Rn=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},i=0;i<e.length;i++){var o=e[i];for(var a in o)En.call(o,a)&&(r[a]=t(r[a],o[a]))}return r}},Ln=Rn(function(t,e){return a(t)&&a(e)?Ln(t,e):e}),Nn=Rn(function(t,e){return e}),Bn=Pn([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),zn=function(t){return Bn.defaultedThunk(p(t))},Vn=Bn.strict,Fn=Bn.asOption,Hn=Bn.defaultedThunk,Wn=Bn.mergeWithThunk,jn=(Pn([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,e){var n={};return n[t]=e,n}),Gn=jn,Un=function(t){return e={},V(t,function(t){e[t.key]=t.value}),e;var e},qn=function(t){return h(In,U)(t)},Xn=function(t){return a(t)&&100<Xe(t).length?" removed due to size":JSON.stringify(t,null,2)},Yn=function(t,e){return In([{path:t,getErrorInfo:e}])},$n=Pn([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Zn=function(t,e,n){var r=Qe(t,e).fold(function(){return n(t)},g);return kn(r)},Kn=function(t){return{extract:function(e,n,r){return function(t,n){return t.stype===_.Error?function(t){return n=t,Yn(e,function(){return n});var n}(t.serror):t}(t(r,n))},toString:function(){return"val"}}},Jn=function(t){var e=Qn(t),n=H(t,function(t,e){return e.fold(function(e){return Ln(t,Gn(e,!0))},p(t))},{});return{extract:function(t,r,i){var o,a=l(i)?[]:Xe(function(t,e){var n,r,i,o,a={};return n=function(t){return null!=t},o=a,r=function(t,e){o[e]=t},i=f,$e(t,function(t,e){(n(t)?r:i)(t,e)}),a}(i)),s=F(a,function(t){return!en(n,t)});return 0===s.length?e.extract(t,r,i):(o=s,Yn(t,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"}))},toString:e.toString}},Qn=function(t){return{extract:function(e,n,r){return i=e,o=r,a=n,function(t,e){var n,r,i=An(t);return 0<i.errors.length?qn(i.errors):(r={},kn(0<(n=i.values).length?Ln(r,Nn.apply(void 0,n)):r))}(z(t,function(t){return function(t,e,n,r){return n.fold(function(n,i,o,a){var s=function(e){var o=a.extract(t.concat([n]),r,e);return On(o,function(t){return jn(i,r(t))})},l=function(e){return e.fold(function(){var t=jn(i,r(P.none()));return kn(t)},function(e){var o=a.extract(t.concat([n]),r,e);return On(o,function(t){return jn(i,r(P.some(t)))})})};return o.fold(function(){return Dn(function(t,e,n){return Qe(e,n).fold(function(){return r=n,i=e,Yn(t,function(){return'Could not find valid *strict* value for "'+r+'" in '+Xn(i)});var r,i},kn)}(t,e,n),s)},function(t){return Dn(Zn(e,n,t),s)},function(){return Dn(kn(Qe(e,n)),l)},function(t){return Dn((i=t,o=Qe(r=e,n).map(function(t){return!0===t?i(r):t}),kn(o)),l);var r,i,o},function(t){var r=t(e),i=On(Zn(e,n,p({})),function(t){return Ln(r,t)});return Dn(i,s)})},function(t,n){var i=n(e);return kn(jn(t,r(i)))})}(i,o,t,a)}));var i,o,a},toString:function(){return"obj{\n"+z(t,function(t){return t.fold(function(t,e,n,r){return t+" -> "+r.toString()},function(t,e){return"state("+t+")"})}).join("\n")+"}"}}},tr=p(Kn(kn)),er=$n.state,nr=$n.field,rr=Kn(kn),ir=function(t){return Kn(function(e){return t(e).fold(In,kn)})},or=function(t,e){return function(t,e){var n=function(e,n){return r=Kn(t),function(t,e,n){return function(t){var e=An(t);return 0<e.errors.length?qn(e.errors):kn(e.values)}(z(n,function(n,i){return r.extract(t.concat(["["+i+"]"]),e,n)}))}(e,g,n);var r};return{extract:function(t,r,i){var o=Xe(i),a=n(t,o);return Dn(a,function(n){var o=z(n,function(t){return $n.field(t,t,Vn(),e)});return Qn(o).extract(t,r,i)})},toString:function(){return"setOf("+e.toString()+")"}}}(function(e){return function(t){return t.fold(Tn,Mn)}(t(e))},e)},ar=function(t,e,n){return function(t){return Cn(t,xn.error,xn.value)}(function(t,e){return t.stype===_.Error?{stype:_.Error,serror:function(t){return{input:r,errors:t}}(t.serror)}:t}(e.extract([t],g,r=n)));var r},sr=function(t){return t.fold(function(t){throw new Error(ur(t))},g)},lr=function(t,e,n){return sr(ar(t,e,n))},ur=function(t){return"Errors: \n"+(n=10<(e=t.errors).length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,z(n,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}).join("\n")+"\n\nInput object: ")+Xn(t.input);var e,n},cr=function(t,e){return function(t,e){return{extract:function(n,r,i){return Qe(i,t).fold(function(){return e=t,Yn(n,function(){return'Choice schema did not contain choice key: "'+e+'"'});var e},function(t){return function(t,e,n,r,i){return Qe(r,i).fold(function(){return e=r,n=i,Yn(t,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+Xn(e)});var e,n},function(r){return r.extract(t.concat(["branch: "+i]),e,n)})}(n,r,i,e,t)})},toString:function(){return"chooseOn("+t+"). Possible values: "+Xe(e)}}}(t,Ze(e,Qn))},dr=p(rr),fr=(bn=c,Kn(function(t){var e=typeof t;return bn(t)?kn(t):In("Expected type: function but got: "+e)})),hr=function(t){return nr(t,t,Vn(),tr())},pr=function(t,e){return nr(t,t,Vn(),e)},gr=function(t,e){return nr(t,t,Vn(),Qn(e))},mr=function(t){return nr(t,t,Fn(),tr())},vr=function(t,e){return nr(t,t,Fn(),e)},yr=function(t,e){return vr(t,Qn(e))},xr=function(t,e){return vr(t,Jn(e))},br=function(t,e){return nr(t,t,zn(e),tr())},_r=function(t,e,n){return nr(t,t,zn(e),n)},wr=function(t,e){return er(t,e)},Sr=[hr("alpha"),hr("omega")],Cr=function(t){return c(t)?t:T},Mr=function(t,e){return ge(t.element,e.event.target)},Tr=function(t){if(!en(t,"can")&&!en(t,"abort")&&!en(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return lr("Extracting event.handler",Jn([br("can",k),br("abort",T),br("run",f)]),t)},kr=Un,Ar=function(t,e){return{key:t,value:Tr({abort:e})}},Ir=function(t,e){return{key:t,value:Tr({run:e})}},Dr=function(t,e,n){return{key:t,value:Tr({run:function(t,r){e.apply(void 0,[t,r].concat(n))}})}},Or=function(t){return function(e){return{key:t,value:Tr({run:function(t,n){Mr(t,n)&&e(t,n)}})}}},Pr=function(t,e,n){return function(t,e){return Ir(t,function(n,r){n.getSystem().getByUid(e).each(function(e){var n,i,o,a;i=(n=e).element,o=t,a=r,n.getSystem().triggerEvent(o,i,a.event)})})}(t,e.partUids[n])},Er=function(t){return Ir(t,function(t,e){e.cut()})},Rr=Or(Jt()),Lr=Or(Qt()),Nr=Or(Kt()),Br=(_n=Xt(),function(t){return Ir(_n,t)}),zr=function(t){return z(t,function(t){return n=(e=t).length-"/*".length,e.length>="/*".length&&"/*"===e.substr(n,n+"/*".length)?t.substring(0,t.length-"/*".length):t;var e,n})},Vr=function(t,e){var n=t.toString(),r=n.indexOf(")")+1,i=n.indexOf("("),o=n.substring(i+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:e,parameters:zr(o)}},t},Fr=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},Hr=function(t,e,n){return Nr(function(r,i){n(r,t,e)})},Wr=function(t){return{key:t,value:void 0}},jr=function(e,n,r,i,o,a,s){var l=function(t){return en(t,r)?t[r]():P.none()},u=Ze(o,function(t,e){return function(t,e,n){var r,i,o,a,s,l;return r=function(r){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var a=[r].concat(i);return r.config({name:p(t)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+n)},function(t){var n=Array.prototype.slice.call(a,1);return e.apply(void 0,[r,t.config,t.state].concat(n))})},i=n,a=(o=e.toString()).indexOf(")")+1,s=o.indexOf("("),l=o.substring(s+1,a-1).split(/,\s*/),r.toFunctionAnnotation=function(){return{name:i,parameters:zr(l.slice(0,1).concat(l.slice(3)))}},r}(r,t,e)}),c=Ze(a,Vr),d=t(t(t({},c),u),{revoke:m(Wr,r),config:function(t){var n=lr(r+"-config",e,t);return{key:r,value:{config:n,me:d,configAsRaw:A(function(){return lr(r+"-config",e,t)}),initialConfig:t,state:s}}},schema:p(n),exhibit:function(t,e){return l(t).bind(function(t){return Qe(i,"exhibit").map(function(n){return n(e,t.config,t.state)})}).getOr(Fr({}))},name:p(r),handlers:function(t){return l(t).map(function(t){return Qe(i,"events").getOr(function(){return{}})(t.config,t.state)}).getOr({})}});return d},Gr={init:function(){return Ur({readState:function(){return"No State required"}})}},Ur=function(t){return t},qr=Un,Xr=Jn([hr("fields"),hr("name"),br("active",{}),br("apis",{}),br("state",Gr),br("extra",{})]),Yr=function(t){var e,n,r,i,o,a,s,l,u=lr("Creating behaviour: "+t.name,Xr,t);return n=u.name,r=u.active,i=u.apis,o=u.extra,a=u.state,s=Jn(e=u.fields),l=yr(n,[xr("config",e)]),jr(s,l,n,r,i,o,a)},$r=Jn([hr("branchKey"),hr("branches"),hr("name"),br("active",{}),br("apis",{}),br("state",Gr),br("extra",{})]),Zr=p(void 0),Kr=Yr({fields:Sr,name:"swapping",apis:mn}),Jr=function(t){var e=t;return{get:function(){return e},set:function(t){e=t}}},Qr=function(t){return t.dom.focus()},ti=function(t){return t.dom.blur()},ei=function(t){return void 0===t&&(t=ce(document)),P.from(t.dom.activeElement).map(ce)},ni=function(t){return ei(Be(t)).filter(function(e){return t.dom.contains(e.dom)})},ri=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ii=tinymce.util.Tools.resolve("tinymce.ThemeManager"),oi=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],ai=["undo","bold","italic","link","image","bullist","styleselect"],si="formatChanged",li="orientationChanged",ui="dropupDismissed",ci=function(t){return t.dom.innerHTML},di=function(t){return Re(t)?"#shadow-root":(e=function(t){return ce(t.dom.cloneNode(!1))}(t),n=ue("div"),r=ce(e.dom.cloneNode(!0)),De(n,r),ci(n));var e,n,r},fi=Object.freeze({__proto__:null,events:function(t){return kr([Ir(qt(),function(e,n){var r,i,o=t.channels,a=Xe(o),s=n,l=(r=a,(i=s).universal?r:F(r,function(t){return N(i.channels,t)}));V(l,function(t){var n=o[t],r=n.schema,i=lr("channel["+t+"] data\nReceiver: "+di(e.element),r,s.data);n.onReceive(e,i)})})])}});(Sn=wn=wn||{})[Sn.STOP=0]="STOP",Sn[Sn.NORMAL=1]="NORMAL",Sn[Sn.LOGGING=2]="LOGGING";var hi=Jr({}),pi=["alloy/data/Fields","alloy/debugging/Debugging"],gi=function(t,e,n){var r,i,o,a;switch(Qe(hi.get(),t).orThunk(function(){var e=Xe(hi.get());return K(e,function(e){return-1<t.indexOf(e)?P.some(hi.get()[e]):P.none()})}).getOr(wn.NORMAL)){case wn.NORMAL:return n(mi());case wn.LOGGING:var s=(r=t,i=e,o=[],a=(new Date).getTime(),{logEventCut:function(t,e,n){o.push({outcome:"cut",target:e,purpose:n})},logEventStopped:function(t,e,n){o.push({outcome:"stopped",target:e,purpose:n})},logNoParent:function(t,e,n){o.push({outcome:"no-parent",target:e,purpose:n})},logEventNoHandlers:function(t,e){o.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(t,e,n){o.push({outcome:"response",purpose:n,target:e})},write:function(){var t=(new Date).getTime();N(["mousemove","mouseover","mouseout",Kt()],r)||console.log(r,{event:r,time:t-a,target:i.dom,sequence:z(o,function(t){return N(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+di(t.target)+")":t.outcome})})}}),l=n(s);return s.write(),l;case wn.STOP:return!0}},mi=p({logEventCut:f,logEventStopped:f,logNoParent:f,logEventNoHandlers:f,logEventResponse:f,write:f}),vi=p([hr("menu"),hr("selectedMenu")]),yi=p([hr("item"),hr("selectedItem")]),xi=(p(Qn(yi().concat(vi()))),p(Qn(yi()))),bi=gr("initSize",[hr("numColumns"),hr("numRows")]),_i=function(t,e,n){return function(){var t=new Error;if(void 0!==t.stack){var e=t.stack.split("\n");j(e,function(t){return 0<t.indexOf("alloy")&&!B(pi,function(e){return-1<t.indexOf(e)})}).getOr("unknown")}}(),nr(e,e,n,ir(function(t){return xn.value(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(void 0,e)})}))},wi=function(t){return _i(0,t,zn(f))},Si=function(t){return _i(0,t,zn(P.none))},Ci=function(t){return _i(0,t,Vn())},Mi=function(t){return _i(0,t,Vn())},Ti=function(t,e){return wr(t,p(e))},ki=function(t){return wr(t,g)},Ai=p(bi),Ii=[pr("channels",or(xn.value,Jn([Ci("onReceive"),br("schema",dr())])))],Di=Yr({fields:Ii,name:"receiving",active:fi}),Oi=function(t,e,n){var r=e.aria;r.update(t,r,n.get())},Pi=function(t,e,n){e.toggleClass.each(function(e){(n.get()?fn:hn)(t.element,e)})},Ei=function(t,e,n){Ni(t,e,n,!n.get())},Ri=function(t,e,n){n.set(!0),Pi(t,e,n),Oi(t,e,n)},Li=function(t,e,n){n.set(!1),Pi(t,e,n),Oi(t,e,n)},Ni=function(t,e,n,r){(r?Ri:Li)(t,e,n)},Bi=function(t,e,n){Ni(t,e,n,e.selected)},zi=Object.freeze({__proto__:null,onLoad:Bi,toggle:Ei,isOn:function(t,e,n){return n.get()},on:Ri,off:Li,set:Ni}),Vi=Object.freeze({__proto__:null,exhibit:function(){return Fr({})},events:function(t,e){var n,r,i,o=(n=t,r=e,i=Ei,Br(function(t){i(t,n,r)})),a=Hr(t,e,Bi);return kr(U([t.toggleOnExecute?[o]:[],[a]]))}}),Fi=function(t,e,n){rn(t.element,"aria-expanded",n)},Hi=[br("selected",!1),mr("toggleClass"),br("toggleOnExecute",!0),_r("aria",{mode:"none"},cr("mode",{pressed:[br("syncWithExpanded",!1),Ti("update",function(t,e,n){rn(t.element,"aria-pressed",n),e.syncWithExpanded&&Fi(t,0,n)})],checked:[Ti("update",function(t,e,n){rn(t.element,"aria-checked",n)})],expanded:[Ti("update",Fi)],selected:[Ti("update",function(t,e,n){rn(t.element,"aria-selected",n)})],none:[Ti("update",f)]}))],Wi=Yr({fields:Hi,name:"toggling",active:Vi,apis:zi,state:{init:function(){var t=Jr(!1);return{get:function(){return t.get()},set:function(e){return t.set(e)},clear:function(){return t.set(!1)},readState:function(){return t.get()}}}}}),ji=function(t,e){return Di.config({channels:Gn(si,{onReceive:function(n,r){r.command===t&&e(n,r.state)}})})},Gi=function(t){return Di.config({channels:Gn(li,{onReceive:t})})},Ui=function(t,e){return{key:t,value:{onReceive:e}}},qi="tinymce-mobile",Xi=function(t){return qi+"-"+t},Yi=function(){var t=function(t,e){e.stop(),oe(t)};return[Ir(zt(),t),Ir($t(),t),Er(kt()),Er(Dt())]},$i=function(t,e){e.ignore||(Qr(t.element),e.onFocus(t))},Zi=Object.freeze({__proto__:null,focus:$i,blur:function(t,e){e.ignore||ti(t.element)},isFocused:function(t){return n=Be(e=t.element).dom,e.dom===n.activeElement;var e,n}}),Ki=Object.freeze({__proto__:null,exhibit:function(t,e){return Fr(e.ignore?{}:{attributes:{tabindex:"-1"}})},events:function(t){return kr([Ir(jt(),function(e,n){$i(e,t),n.stop()})].concat(t.stopMousedown?[Ir(Dt(),function(t,e){e.event.prevent()})]:[]))}}),Ji=[wi("onFocus"),br("stopMousedown",!1),br("ignore",!1)],Qi=Yr({fields:Ji,name:"focusing",active:Ki,apis:Zi}),to=function(t){return void 0!==t.style&&c(t.style.getPropertyValue)},eo=function(t,e,n){if(!o(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);to(t)&&t.style.setProperty(e,n)},no=function(t,e,n){eo(t.dom,e,n)},ro=function(t,e){var n=t.dom;$e(e,function(t,e){eo(n,e,t)})},io=function(t,e){var n=t.dom,r=window.getComputedStyle(n).getPropertyValue(e);return""!==r||Ve(t)?r:oo(n,e)},oo=function(t,e){return to(t)?t.style.getPropertyValue(e):""},ao=function(t,e){var n=oo(t.dom,e);return P.from(n).filter(function(t){return 0<t.length})},so=function(t,e){var n,r;r=e,to(n=t.dom)&&n.style.removeProperty(r),sn(t,"style").map(it).is("")&&un(t,"style")},lo=function(t){return t.dom.offsetWidth},uo=function(t,e){var n=function(n){var r=e(n);if(r<=0||null===r){var i=io(n,t);return parseFloat(i)||0}return r},r=function(t,e){return W(e,function(e,n){var r=io(t,n),i=void 0===r?0:parseInt(r,10);return isNaN(i)?e:e+i},0)};return{set:function(e,n){if(!d(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);var r=e.dom;to(r)&&(r.style[t]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(t,e,n){var i=r(t,n);return i<e?e-i:0}}},co=uo("height",function(t){var e=t.dom;return Ve(t)?e.getBoundingClientRect().height:e.offsetHeight}),fo=function(t){return co.get(t)},ho=function(t,e){return he(e,t)};function po(t,e,n,r,i){return t(n,r)?P.some(n):c(i)&&i(n)?P.none():e(n,r,i)}var go,mo,vo=function(t,e,n){for(var r=t.dom,i=c(n)?n:T;r.parentNode;){var o=ce(r=r.parentNode);if(e(o))return P.some(o);if(i(o))break}return P.none()},yo=function(t){return pe(t)},xo=function(t,e,n){return vo(t,function(t){return de(t,e)},n)},bo=function(t,e){return pe(e,t)},_o=function(t,e,n){return po(de,xo,t,e,n)},wo=[8],So=[9],Co=[13],Mo=[27],To=[32],ko=[37],Ao=[38],Io=[39],Do=[40],Oo=function(t,e,n){var r=Y(t.slice(0,e)),i=Y(t.slice(e+1));return j(r.concat(i),n)},Po=function(t,e,n){var r=Y(t.slice(0,e));return j(r,n)},Eo=function(t,e,n){var r=t.slice(0,e),i=t.slice(e+1);return j(i.concat(r),n)},Ro=function(t,e,n){var r=t.slice(e+1);return j(r,n)},Lo=function(t){return function(e){return N(t,e.raw.which)}},No=function(t){return function(e){return X(t,function(t){return t(e)})}},Bo=function(t){return!0===t.raw.shiftKey},zo=function(t){return!0===t.raw.ctrlKey},Vo=S(Bo),Fo=function(t,e){return{matches:t,classification:e}},Ho=function(t,e,n,r){var i=t+e;return r<i?n:i<n?r:i},Wo=function(t,e,n){return Math.min(Math.max(t,e),n)},jo=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},Go=function(t,e,n,r){var i=ho(t.element,"."+e.highlightClass);V(i,function(n){B(r,function(t){return t.element===n})||(hn(n,e.highlightClass),t.getSystem().getByDom(n).each(function(n){e.onDehighlight(t,n),re(n,ne())}))})},Uo=function(t,e,n,r){Go(t,e,0,[r]),qo(t,e,n,r)||(fn(r.element,e.highlightClass),e.onHighlight(t,r),re(r,ee()))},qo=function(t,e,n,r){return pn(r.element,e.highlightClass)},Xo=function(t,e,n){return bo(t.element,"."+e.itemClass).bind(function(e){return t.getSystem().getByDom(e).toOptional()})},Yo=function(t,e,n){var r=ho(t.element,"."+e.itemClass);return(0<r.length?P.some(r[r.length-1]):P.none()).bind(function(e){return t.getSystem().getByDom(e).toOptional()})},$o=function(t,e,n,r){var i=ho(t.element,"."+e.itemClass);return G(i,function(t){return pn(t,e.highlightClass)}).bind(function(e){var n=Ho(e,r,0,i.length-1);return t.getSystem().getByDom(i[n]).toOptional()})},Zo=function(t,e,n){var r=ho(t.element,"."+e.itemClass);return jo(z(r,function(e){return t.getSystem().getByDom(e).toOptional()}))},Ko=Object.freeze({__proto__:null,dehighlightAll:function(t,e,n){return Go(t,e,0,[])},dehighlight:function(t,e,n,r){qo(t,e,n,r)&&(hn(r.element,e.highlightClass),e.onDehighlight(t,r),re(r,ne()))},highlight:Uo,highlightFirst:function(t,e,n){Xo(t,e).each(function(r){Uo(t,e,n,r)})},highlightLast:function(t,e,n){Yo(t,e).each(function(r){Uo(t,e,n,r)})},highlightAt:function(t,e,n,r){(function(t,e,n,r){var i=ho(t.element,"."+e.itemClass);return P.from(i[r]).fold(function(){return xn.error(new Error("No element found with index "+r))},t.getSystem().getByDom)})(t,e,0,r).fold(function(t){throw t},function(r){Uo(t,e,n,r)})},highlightBy:function(t,e,n,r){var i=Zo(t,e);j(i,r).each(function(r){Uo(t,e,n,r)})},isHighlighted:qo,getHighlighted:function(t,e,n){return bo(t.element,"."+e.highlightClass).bind(function(e){return t.getSystem().getByDom(e).toOptional()})},getFirst:Xo,getLast:Yo,getPrevious:function(t,e,n){return $o(t,e,0,-1)},getNext:function(t,e,n){return $o(t,e,0,1)},getCandidates:Zo}),Jo=[hr("highlightClass"),hr("itemClass"),wi("onHighlight"),wi("onDehighlight")],Qo=Yr({fields:Jo,name:"highlighting",apis:Ko}),ta=function(t,e,n){e.exists(function(t){return n.exists(function(e){return ge(e,t)})})||ie(t,te(),{prevFocus:e,newFocus:n})},ea=function(){var t=function(t){return ni(t.element)};return{get:t,set:function(e,n){var r=t(e);e.getSystem().triggerFocus(n,e.element);var i=t(e);ta(e,r,i)}}};(mo=go=go||{}).OnFocusMode="onFocus",mo.OnEnterOrSpaceMode="onEnterOrSpace",mo.OnApiMode="onApi";var na,ra,ia,oa,aa,sa,la,ua,ca,da,fa,ha,pa,ga,ma,va,ya=function(t,e,n,r,i){var o=function(t,e,n,r,i){var o,a=n(t,e,r,i);return o=e.event,j(a,function(t){return t.matches(o)}).map(function(t){return t.classification}).bind(function(n){return n(t,e,r,i)})},a={schema:function(){return t.concat([br("focusManager",ea()),_r("focusInside","onFocus",ir(function(t){return N(["onFocus","onEnterOrSpace","onApi"],t)?xn.value(t):xn.error("Invalid value for focusInside")})),Ti("handler",a),Ti("state",e),Ti("sendFocusIn",i)])},processKey:o,toEvents:function(t,e){var a=t.focusInside!==go.OnFocusMode?P.none():i(t).map(function(n){return Ir(jt(),function(r,i){n(r,t,e),i.stop()})}),s=[Ir(Rt(),function(r,a){o(r,a,n,t,e).fold(function(){var n,o,s;n=r,o=a,s=Lo(To.concat(Co))(o.event),t.focusInside===go.OnEnterOrSpaceMode&&s&&Mr(n,o)&&i(t).each(function(r){r(n,t,e),o.stop()})},function(t){a.stop()})}),Ir(Lt(),function(n,i){o(n,i,r,t,e).each(function(t){i.stop()})})];return kr(a.toArray().concat(s))}};return a},xa=function(t){var e=[mr("onEscape"),mr("onEnter"),br("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),br("firstTabstop",0),br("useTabstopAt",k),mr("visibilitySelector")].concat([t]),n=function(t,e){var n=t.visibilitySelector.bind(function(t){return _o(e,t)}).getOr(e);return 0<fo(n)},r=function(t,e,r){var i,o,a;o=ho(t.element,(i=e).selector),a=F(o,function(t){return n(i,t)}),P.from(a[i.firstTabstop]).each(function(n){e.focusManager.set(t,n)})},i=function(t,e,r,i,o){return o(e,r,function(t){return n(e=i,r=t)&&e.useTabstopAt(r);var e,r}).fold(function(){return i.cyclic?P.some(!0):P.none()},function(e){return i.focusManager.set(t,e),P.some(!0)})},o=function(t,e,n,r){var o,a=ho(t.element,n.selector);return(o=n).focusManager.get(t).bind(function(t){return _o(t,o.selector)}).bind(function(e){return G(a,m(ge,e)).bind(function(e){return i(t,a,e,n,r)})})},a=p([Fo(No([Bo,Lo(So)]),function(t,e,n){return o(t,0,n,n.cyclic?Oo:Po)}),Fo(Lo(So),function(t,e,n){return o(t,0,n,n.cyclic?Eo:Ro)}),Fo(Lo(Mo),function(t,e,n){return n.onEscape.bind(function(n){return n(t,e)})}),Fo(No([Vo,Lo(Co)]),function(t,e,n){return n.onEnter.bind(function(n){return n(t,e)})})]),s=p([]);return ya(e,Gr.init,a,s,function(){return P.some(r)})},ba=xa(wr("cyclic",T)),_a=xa(wr("cyclic",k)),wa=function(t){return"input"===me(t)&&"radio"!==an(t,"type")||"textarea"===me(t)},Sa=function(t,e,n){return wa(n)&&Lo(To)(e.event)?P.none():(ae(t,n,Xt()),P.some(!0))},Ca=function(t,e){return P.some(!0)},Ma=[br("execute",Sa),br("useSpace",!1),br("useEnter",!0),br("useControlEnter",!1),br("useDown",!1)],Ta=function(t,e,n){return n.execute(t,e,t.element)},ka=ya(Ma,Gr.init,function(t,e,n,r){var i=n.useSpace&&!wa(t.element)?To:[],o=n.useDown?Do:[],a=i.concat(n.useEnter?Co:[]).concat(o);return[Fo(Lo(a),Ta)].concat(n.useControlEnter?[Fo(No([zo,Lo(Co)]),Ta)]:[])},function(t,e,n,r){return n.useSpace&&!wa(t.element)?[Fo(Lo(To),Ca)]:[]},function(){return P.none()}),Aa=function(){var t=Jr(P.none());return Ur({readState:function(){return t.get().map(function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(e,n){t.set(P.some({numRows:e,numColumns:n}))},getNumRows:function(){return t.get().map(function(t){return t.numRows})},getNumColumns:function(){return t.get().map(function(t){return t.numColumns})}})},Ia=Object.freeze({__proto__:null,flatgrid:Aa,init:function(t){return t.state(t)}}),Da=function(t,e){return function(n){return"rtl"===Oa(n)?e:t}},Oa=function(t){return"rtl"===io(t,"direction")?"rtl":"ltr"},Pa=function(t){return function(e,n,r,i){var o=t(e.element);return Na(o,e,n,r,i)}},Ea=function(t,e){var n=Da(t,e);return Pa(n)},Ra=function(t,e){var n=Da(e,t);return Pa(n)},La=function(t){return function(e,n,r,i){return Na(t,e,n,r,i)}},Na=function(t,e,n,r,i){return r.focusManager.get(e).bind(function(n){return t(e.element,n,r,i)}).map(function(t){return r.focusManager.set(e,t),!0})},Ba=La,za=La,Va=La,Fa=function(t){return!((e=t.dom).offsetWidth<=0&&e.offsetHeight<=0);var e},Ha=function(t,e,n){var r,i=ho(t,n),o=F(i,Fa);return G(r=o,function(t){return ge(t,e)}).map(function(t){return{index:t,candidates:r}})},Wa=function(t,e){return G(t,function(t){return ge(e,t)})},ja=function(t,e,n,r){return r(Math.floor(e/n),e%n).bind(function(e){var r=e.row*n+e.column;return 0<=r&&r<t.length?P.some(t[r]):P.none()})},Ga=function(t,e,n,r,i){return ja(t,e,r,function(e,o){var a=Ho(o,i,0,(e===n-1?t.length-e*r:r)-1);return P.some({row:e,column:a})})},Ua=function(t,e,n,r,i){return ja(t,e,r,function(e,o){var a=Ho(e,i,0,n-1),s=Wo(o,0,(a===n-1?t.length-a*r:r)-1);return P.some({row:a,column:s})})},qa=[hr("selector"),br("execute",Sa),Si("onEscape"),br("captureTab",!1),Ai()],Xa=function(t,e,n){bo(t.element,e.selector).each(function(n){e.focusManager.set(t,n)})},Ya=function(t){return function(e,n,r,i){return Ha(e,n,r.selector).bind(function(e){return t(e.candidates,e.index,i.getNumRows().getOr(r.initSize.numRows),i.getNumColumns().getOr(r.initSize.numColumns))})}},$a=function(t,e,n){return n.captureTab?P.some(!0):P.none()},Za=Ya(function(t,e,n,r){return Ga(t,e,n,r,-1)}),Ka=Ya(function(t,e,n,r){return Ga(t,e,n,r,1)}),Ja=Ya(function(t,e,n,r){return Ua(t,e,n,r,-1)}),Qa=Ya(function(t,e,n,r){return Ua(t,e,n,r,1)}),ts=p([Fo(Lo(ko),Ea(Za,Ka)),Fo(Lo(Io),Ra(Za,Ka)),Fo(Lo(Ao),Ba(Ja)),Fo(Lo(Do),za(Qa)),Fo(No([Bo,Lo(So)]),$a),Fo(No([Vo,Lo(So)]),$a),Fo(Lo(Mo),function(t,e,n){return n.onEscape(t,e)}),Fo(Lo(To.concat(Co)),function(t,e,n,r){return(i=n).focusManager.get(t).bind(function(t){return _o(t,i.selector)}).bind(function(r){return n.execute(t,e,r)});var i})]),es=p([Fo(Lo(To),Ca)]),ns=ya(qa,Aa,ts,es,function(){return P.some(Xa)}),rs=function(t,e,n,r){var i=function(t,e,n){var o,a=Ho(e,r,0,n.length-1);return a===t?P.none():"button"===me(o=n[a])&&"disabled"===an(o,"disabled")?i(t,a,n):P.from(n[a])};return Ha(t,n,e).bind(function(t){var e=t.index;return i(e,e,t.candidates)})},is=[hr("selector"),br("getInitial",P.none),br("execute",Sa),Si("onEscape"),br("executeOnMove",!1),br("allowVertical",!0)],os=function(t,e,n){return(r=n).focusManager.get(t).bind(function(t){return _o(t,r.selector)}).bind(function(r){return n.execute(t,e,r)});var r},as=function(t,e,n){e.getInitial(t).orThunk(function(){return bo(t.element,e.selector)}).each(function(n){e.focusManager.set(t,n)})},ss=function(t,e,n){return rs(t,n.selector,e,-1)},ls=function(t,e,n){return rs(t,n.selector,e,1)},us=function(t){return function(e,n,r,i){return t(e,n,r,i).bind(function(){return r.executeOnMove?os(e,n,r):P.some(!0)})}},cs=function(t,e,n){return n.onEscape(t,e)},ds=p([Fo(Lo(To),Ca)]),fs=ya(is,Gr.init,function(t,e,n,r){var i=ko.concat(n.allowVertical?Ao:[]),o=Io.concat(n.allowVertical?Do:[]);return[Fo(Lo(i),us(Ea(ss,ls))),Fo(Lo(o),us(Ra(ss,ls))),Fo(Lo(Co),os),Fo(Lo(To),os),Fo(Lo(Mo),cs)]},ds,function(){return P.some(as)}),hs=function(t,e,n){return P.from(t[e]).bind(function(t){return P.from(t[n]).map(function(t){return{rowIndex:e,columnIndex:n,cell:t}})})},ps=function(t,e,n,r){var i=Ho(n,r,0,t[e].length-1);return hs(t,e,i)},gs=function(t,e,n,r){var i=Ho(n,r,0,t.length-1),o=Wo(e,0,t[i].length-1);return hs(t,i,o)},ms=function(t,e,n,r){var i=Wo(n+r,0,t[e].length-1);return hs(t,e,i)},vs=function(t,e,n,r){var i=Wo(n+r,0,t.length-1),o=Wo(e,0,t[i].length-1);return hs(t,i,o)},ys=[gr("selectors",[hr("row"),hr("cell")]),br("cycles",!0),br("previousSelector",P.none),br("execute",Sa)],xs=function(t,e,n){e.previousSelector(t).orThunk(function(){return bo(t.element,e.selectors.cell)}).each(function(n){e.focusManager.set(t,n)})},bs=function(t,e){return function(n,r,i){var o=i.cycles?t:e;return _o(r,i.selectors.row).bind(function(t){var e=ho(t,i.selectors.cell);return Wa(e,r).bind(function(e){var r=ho(n,i.selectors.row);return Wa(r,t).bind(function(t){var n,a=(n=i,z(r,function(t){return ho(t,n.selectors.cell)}));return o(a,t,e).map(function(t){return t.cell})})})})}},_s=bs(function(t,e,n){return ps(t,e,n,-1)},function(t,e,n){return ms(t,e,n,-1)}),ws=bs(function(t,e,n){return ps(t,e,n,1)},function(t,e,n){return ms(t,e,n,1)}),Ss=bs(function(t,e,n){return gs(t,n,e,-1)},function(t,e,n){return vs(t,n,e,-1)}),Cs=bs(function(t,e,n){return gs(t,n,e,1)},function(t,e,n){return vs(t,n,e,1)}),Ms=p([Fo(Lo(ko),Ea(_s,ws)),Fo(Lo(Io),Ra(_s,ws)),Fo(Lo(Ao),Ba(Ss)),Fo(Lo(Do),za(Cs)),Fo(Lo(To.concat(Co)),function(t,e,n){return ni(t.element).bind(function(r){return n.execute(t,e,r)})})]),Ts=p([Fo(Lo(To),Ca)]),ks=ya(ys,Gr.init,Ms,Ts,function(){return P.some(xs)}),As=[hr("selector"),br("execute",Sa),br("moveOnTab",!1)],Is=function(t,e,n){return n.focusManager.get(t).bind(function(r){return n.execute(t,e,r)})},Ds=function(t,e,n){bo(t.element,e.selector).each(function(n){e.focusManager.set(t,n)})},Os=function(t,e,n){return rs(t,n.selector,e,-1)},Ps=function(t,e,n){return rs(t,n.selector,e,1)},Es=p([Fo(Lo(Ao),Va(Os)),Fo(Lo(Do),Va(Ps)),Fo(No([Bo,Lo(So)]),function(t,e,n,r){return n.moveOnTab?Va(Os)(t,e,n,r):P.none()}),Fo(No([Vo,Lo(So)]),function(t,e,n,r){return n.moveOnTab?Va(Ps)(t,e,n,r):P.none()}),Fo(Lo(Co),Is),Fo(Lo(To),Is)]),Rs=p([Fo(Lo(To),Ca)]),Ls=ya(As,Gr.init,Es,Rs,function(){return P.some(Ds)}),Ns=[Si("onSpace"),Si("onEnter"),Si("onShiftEnter"),Si("onLeft"),Si("onRight"),Si("onTab"),Si("onShiftTab"),Si("onUp"),Si("onDown"),Si("onEscape"),br("stopSpaceKeyup",!1),mr("focusIn")],Bs=ya(Ns,Gr.init,function(t,e,n){return[Fo(Lo(To),n.onSpace),Fo(No([Vo,Lo(Co)]),n.onEnter),Fo(No([Bo,Lo(Co)]),n.onShiftEnter),Fo(No([Bo,Lo(So)]),n.onShiftTab),Fo(No([Vo,Lo(So)]),n.onTab),Fo(Lo(Ao),n.onUp),Fo(Lo(Do),n.onDown),Fo(Lo(ko),n.onLeft),Fo(Lo(Io),n.onRight),Fo(Lo(To),n.onSpace),Fo(Lo(Mo),n.onEscape)]},function(t,e,n){return n.stopSpaceKeyup?[Fo(Lo(To),Ca)]:[]},function(t){return t.focusIn}),zs=ba.schema(),Vs=_a.schema(),Fs=fs.schema(),Hs=ns.schema(),Ws=ks.schema(),js=ka.schema(),Gs=Ls.schema(),Us=Bs.schema(),qs=(ra=cr((da=lr("Creating behaviour: "+(na={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:zs,cyclic:Vs,flow:Fs,flatgrid:Hs,matrix:Ws,execution:js,menu:Gs,special:Us}),name:"keying",active:{events:function(t,e){return t.handler.toEvents(t,e)}},apis:{focusIn:function(t,e,n){e.sendFocusIn(e).fold(function(){t.getSystem().triggerFocus(t.element,t.element)},function(r){r(t,e,n)})},setGridSize:function(t,e,n,r,i){en(n,"setGridSize")?n.setGridSize(r,i):console.error("Layout does not support setGridSize")}},state:Ia}).name,$r,na)).branchKey,da.branches),oa=da.active,aa=da.apis,sa=da.extra,la=da.state,ca=yr(ia=da.name,[vr("config",ua=ra)]),jr(ua,ca,ia,oa,aa,sa,la)),Xs=function(t,e){return n=t,r={},i=z(e,function(e){return n=e.name(),r="Cannot configure "+e.name()+" for "+t,nr(n,n,Fn(),Kn(function(t){return In("The field: "+n+" is forbidden. "+r)}));var n,r}).concat([wr("dump",g)]),_r(n,r,Qn(i));var n,r,i},Ys=function(t){return t.dump},$s=function(e,n){return t(t({},e.dump),qr(n))},Zs=Xs,Ks=$s,Js="placeholder",Qs=Pn([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),tl=function(t){return tn(t,"uiType")},el=function(e,n,r,i){return function(t,e,n,r){return tl(n)&&n.uiType===Js?(o=n,a=r,(i=t).exists(function(t){return t!==o.owner})?Qs.single(!0,p(o)):Qe(a,o.name).fold(function(){throw new Error("Unknown placeholder component: "+o.name+"\nKnown: ["+Xe(a)+"]\nNamespace: "+i.getOr("none")+"\nSpec: "+JSON.stringify(o,null,2))},function(t){return t.replace()})):Qs.single(!1,p(n));var i,o,a}(e,0,r,i).fold(function(o,a){var s=tl(r)?a(n,r.config,r.validated):a(n),l=Qe(s,"components").getOr([]),u=q(l,function(t){return el(e,n,t,i)});return[t(t({},s),{components:u})]},function(t,e){if(tl(r)){var i=e(n,r.config,r.validated);return r.validated.preprocess.getOr(g)(i)}return e(n)})},nl=Qs.single,rl=Qs.multiple,il=p(Js),ol=0,al=function(t){var e=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++ol+String(e)},sl=Pn([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ll=br("factory",{sketch:g}),ul=br("schema",[]),cl=hr("name"),dl=nr("pname","pname",Hn(function(t){return"<alloy."+al(t.name)+">"}),dr()),fl=wr("schema",function(){return[mr("preprocess")]}),hl=br("defaults",p({})),pl=br("overrides",p({})),gl=Qn([ll,ul,cl,dl,hl,pl]),ml=Qn([ll,ul,cl,hl,pl]),vl=Qn([ll,ul,cl,dl,hl,pl]),yl=Qn([ll,fl,cl,hr("unit"),dl,hl,pl]),xl=function(t){var e=function(t){return t.name};return t.fold(e,e,e,e)},bl=function(t,e){return function(n){var r=lr("Converting part type",e,n);return t(r)}},_l=bl(sl.required,gl),wl=(bl(sl.external,ml),bl(sl.optional,vl)),Sl=bl(sl.group,yl),Cl=p("entirety"),Ml=function(t,e,n,r){return Ln(e.defaults(t,n,r),n,{uid:t.partUids[e.name]},e.overrides(t,n,r))},Tl=function(t,e,n){return r=e,i={},o={},V(n,function(t){t.fold(function(t){i[t.pname]=nl(!0,function(e,n,r){return t.factory.sketch(Ml(e,t,n,r))})},function(t){var e=r.parts[t.name];o[t.name]=p(t.factory.sketch(Ml(r,t,e[Cl()]),e))},function(t){i[t.pname]=nl(!1,function(e,n,r){return t.factory.sketch(Ml(e,t,n,r))})},function(t){i[t.pname]=rl(!0,function(e,n,r){return z(e[t.name],function(n){return t.factory.sketch(Ln(t.defaults(e,n,r),n,t.overrides(e,n)))})})})}),{internals:p(i),externals:p(o)};var r,i,o},kl=function(t,e,n){return function(t,e,n,r){var i,o,a,s=Ze(r,function(t,e){return r=t,i=!1,{name:p(n=e),required:function(){return r.fold(function(t,e){return t},function(t,e){return t})},used:function(){return i},replace:function(){if(i)throw new Error("Trying to use the same placeholder more than once: "+n);return i=!0,r}};var n,r,i}),l=(i=t,o=e,a=s,q(n,function(t){return el(i,o,t,a)}));return $e(s,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))}),l}(P.some(t),e,e.components,n)},Al=function(t,e,n){var r=e.partUids[n];return t.getSystem().getByUid(r).toOptional()},Il=function(t,e,n){return Al(t,e,n).getOrDie("Could not find part: "+n)},Dl=function(t){return nr("partUids","partUids",Wn(function(e){return function(t,e){var n=z(e,xl);return Un(z(n,function(e){return{key:e,value:t+"-"+e}}))}(e.uid,t)}),dr())},Ol=al("alloy-premade"),Pl=function(t){return Gn(Ol,t)},El=function(t){return e=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return t.apply(void 0,n([e.getApis(),e],r))},i=(r=t.toString()).indexOf(")")+1,o=r.indexOf("("),a=r.substring(o+1,i-1).split(/,\s*/),e.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:zr(a.slice(1))}},e;var e,r,i,o,a},Rl=p("alloy-id-"),Ll=p("data-alloy-id"),Nl=Rl(),Bl=Ll(),zl=function(t,e){Object.defineProperty(t.dom,Bl,{value:e,writable:!0})},Vl=function(t){var e=ye(t)?t.dom[Bl]:null;return P.from(e)},Fl=al,Hl=function(t,e,n,r,i){var o,a,s=(a=i,(0<(o=r).length?[gr("parts",o)]:[]).concat([hr("uid"),br("dom",{}),br("components",[]),ki("originalSpec"),br("debug.sketcher",{})]).concat(a));return lr(t+" [SpecSchema]",Jn(s.concat(e)),n)},Wl=function(t,e,n,r,i){var o=jl(i),a=q(n,function(t){return t.fold(P.none,P.some,P.none,P.none).map(function(t){return gr(t.name,t.schema.concat([ki(Cl())]))}).toArray()}),s=Dl(n),l=Hl(t,e,o,a,[s]),u=Tl(0,l,n);return r(l,kl(t,l,u.internals()),o,u.externals())},jl=function(e){return tn(e,"uid")?e:t(t({},e),{uid:Fl("uid")})},Gl=Jn([hr("name"),hr("factory"),hr("configFields"),br("apis",{}),br("extraApis",{})]),Ul=Jn([hr("name"),hr("factory"),hr("configFields"),hr("partFields"),br("apis",{}),br("extraApis",{})]),ql=function(e){var n=lr("Sketcher for "+e.name,Gl,e),r=Ze(n.apis,El),i=Ze(n.extraApis,Vr);return t(t({name:n.name,configFields:n.configFields,sketch:function(t){return e=n.name,r=n.configFields,i=n.factory,o=jl(t),i(Hl(e,r,o,[],[]),o);var e,r,i,o}},r),i)},Xl=function(e){var n=lr("Sketcher for "+e.name,Ul,e),r=function(e,n){var r={};return V(n,function(n){n.fold(P.some,P.none,P.some,P.some).each(function(n){var i=function(t,e){return{uiType:il(),owner:t,name:e}}(e,n.pname);r[n.name]=function(r){var o=lr("Part: "+n.name+" in "+e,Qn(n.schema),r);return t(t({},i),{config:r,validated:o})}})}),r}(n.name,n.partFields),i=Ze(n.apis,El),o=Ze(n.extraApis,Vr);return t(t({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return Wl(n.name,n.configFields,n.partFields,n.factory,t)},parts:r},i),o)},Yl=ql({name:"Button",factory:function(e){var n=kr(U([e.action.map(function(t){return Br(function(e,n){t(e),n.stop()})}).toArray(),Yi()])),r=e.dom.tag,i=function(t){return Qe(e.dom,"attributes").bind(function(e){return Qe(e,t)})};return{uid:e.uid,dom:e.dom,components:e.components,events:n,behaviours:Ks(e.buttonBehaviours,[Qi.config({}),qs.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==r)return{role:i("role").getOr("button")};var e=i("type").getOr("button"),n=i("role").map(function(t){return{role:t}}).getOr({});return t({type:e},n)}()},eventOrder:e.eventOrder}},configFields:[br("uid",void 0),hr("dom"),br("components",[]),Zs("buttonBehaviours",[Qi,qs]),mr("action"),mr("role"),br("eventOrder",{})]}),$l=Yr({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return kr([Ar(Ft(),k)])},exhibit:function(){return Fr({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Zl=function(e){return function(e){var n,r,i=function(t,e){var n=document.createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return le(n.childNodes[0])}(e),o=Me(i),a=(r=void 0!==(n=i).dom.attributes?n.dom.attributes:[],W(r,function(e,n){var r;return"class"===n.name?e:t(t({},e),((r={})[n.name]=n.value,r))},{})),s=Array.prototype.slice.call(i.dom.classList,0),l=0===o.length?{}:{innerHtml:ci(i)};return t({tag:me(i),classes:s,attributes:a},l)}(function(t,e){return t.replace(/\$\{([^{}]*)\}/g,function(t,n){var r,i=e[n];return"string"==(r=typeof i)||"number"==r?i.toString():t})}(e,{prefix:qi}))},Kl=function(t){return{dom:Zl(t)}},Jl=function(t){return qr([Wi.config({toggleClass:Xi("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),ji(t,function(t,e){(e?Wi.on:Wi.off)(t)})])},Ql=function(t,e,n,r){var i=Jl(n);return eu(e,r,i,t)},tu=function(t,e){var n=e.ui.registry.getAll().icons;return P.from(n[t]).fold(function(){return Zl('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+t+' ${prefix}-icon"></span>')},function(t){return Zl('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+t+"</span>")})},eu=function(t,e,n,r){return Yl.sketch({dom:tu(t,r),action:e,buttonBehaviours:Ln(qr([$l.config({})]),n)})},nu=wl({schema:[hr("dom")],name:"label"}),ru=function(t){return wl({name:t+"-edge",overrides:function(e){return e.model.manager.edgeActions[t].fold(function(){return{}},function(t){return{events:kr([Dr(kt(),function(e,n,r){return t(e,r)},[e]),Dr(Dt(),function(e,n,r){return t(e,r)},[e]),Dr(Ot(),function(e,n,r){r.mouseIsDown.get()&&t(e,r)},[e])])}})}})},iu=ru("top-left"),ou=ru("top"),au=ru("top-right"),su=ru("right"),lu=ru("bottom-right"),uu=ru("bottom"),cu=ru("bottom-left"),du=[nu,ru("left"),su,ou,uu,iu,au,cu,lu,_l({name:"thumb",defaults:p({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:kr([Pr(kt(),t,"spectrum"),Pr(At(),t,"spectrum"),Pr(It(),t,"spectrum"),Pr(Dt(),t,"spectrum"),Pr(Ot(),t,"spectrum"),Pr(Pt(),t,"spectrum")])}}}),_l({schema:[wr("mouseIsDown",function(){return Jr(!1)})],name:"spectrum",overrides:function(t){var e=t.model.manager,n=function(n,r){return e.getValueFromEvent(r).map(function(r){return e.setValueFrom(n,t,r)})};return{behaviours:qr([qs.config({mode:"special",onLeft:function(n){return e.onLeft(n,t)},onRight:function(n){return e.onRight(n,t)},onUp:function(n){return e.onUp(n,t)},onDown:function(n){return e.onDown(n,t)}}),Qi.config({})]),events:kr([Ir(kt(),n),Ir(At(),n),Ir(Dt(),n),Ir(Ot(),function(e,r){t.mouseIsDown.get()&&n(e,r)})])}}})],fu=function(t,e,n){e.store.manager.onLoad(t,e,n)},hu=function(t,e,n){e.store.manager.onUnload(t,e,n)},pu=Object.freeze({__proto__:null,onLoad:fu,onUnload:hu,setValue:function(t,e,n,r){e.store.manager.setValue(t,e,n,r)},getValue:function(t,e,n){return e.store.manager.getValue(t,e,n)},getState:function(t,e,n){return n}}),gu=Object.freeze({__proto__:null,events:function(t,e){var n=t.resetOnDom?[Rr(function(n,r){fu(n,t,e)}),Lr(function(n,r){hu(n,t,e)})]:[Hr(t,e,fu)];return kr(n)}}),mu=function(){var t=Jr(null);return Ur({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},vu=function(){var e=Jr({}),n=Jr({});return Ur({readState:function(){return{mode:"dataset",dataByValue:e.get(),dataByText:n.get()}},lookup:function(t){return Qe(e.get(),t).orThunk(function(){return Qe(n.get(),t)})},update:function(r){var i=e.get(),o=n.get(),a={},s={};V(r,function(t){a[t.value]=t,Qe(t,"meta").each(function(e){Qe(e,"text").each(function(e){s[e]=t})})}),e.set(t(t({},i),a)),n.set(t(t({},o),s))},clear:function(){e.set({}),n.set({})}})},yu=Object.freeze({__proto__:null,memory:mu,dataset:vu,manual:function(){return Ur({readState:f})},init:function(t){return t.store.manager.state(t)}}),xu=function(t,e,n,r){var i=e.store;n.update([r]),i.setValue(t,r),e.onSetValue(t,r)},bu=[mr("initialValue"),hr("getFallbackEntry"),hr("getDataKey"),hr("setValue"),Ti("manager",{setValue:xu,getValue:function(t,e,n){var r=e.store,i=r.getDataKey(t);return n.lookup(i).fold(function(){return r.getFallbackEntry(i)},function(t){return t})},onLoad:function(t,e,n){e.store.initialValue.each(function(r){xu(t,e,n,r)})},onUnload:function(t,e,n){n.clear()},state:vu})],_u=[hr("getValue"),br("setValue",f),mr("initialValue"),Ti("manager",{setValue:function(t,e,n,r){e.store.setValue(t,r),e.onSetValue(t,r)},getValue:function(t,e,n){return e.store.getValue(t)},onLoad:function(t,e,n){e.store.initialValue.each(function(n){e.store.setValue(t,n)})},onUnload:f,state:Gr.init})],wu=[mr("initialValue"),Ti("manager",{setValue:function(t,e,n,r){n.set(r),e.onSetValue(t,r)},getValue:function(t,e,n){return n.get()},onLoad:function(t,e,n){e.store.initialValue.each(function(t){n.isNotSet()&&n.set(t)})},onUnload:function(t,e,n){n.clear()},state:mu})],Su=[_r("store",{mode:"memory"},cr("mode",{memory:wu,manual:_u,dataset:bu})),wi("onSetValue"),br("resetOnDom",!1)],Cu=Yr({fields:Su,name:"representing",active:gu,apis:pu,extra:{setValueFrom:function(t,e){var n=Cu.getValue(e);Cu.setValue(t,n)}},state:yu}),Mu=uo("width",function(t){return t.dom.offsetWidth}),Tu=function(t,e){return Mu.set(t,e)},ku=function(t){return Mu.get(t)},Au=function(t,e){return{left:t,top:e,translate:function(n,r){return Au(t+n,e+r)}}},Iu=Au,Du=p("slider.change.value"),Ou=function(t){var e=t.event.raw;return-1===e.type.indexOf("touch")?void 0!==e.clientX?P.some(e).map(function(t){return Iu(t.clientX,t.clientY)}):P.none():void 0!==e.touches&&1===e.touches.length?P.some(e.touches[0]).map(function(t){return Iu(t.clientX,t.clientY)}):P.none()},Pu=function(t){return t.model.minX},Eu=function(t){return t.model.minY},Ru=function(t){return t.model.minX-1},Lu=function(t){return t.model.minY-1},Nu=function(t){return t.model.maxX},Bu=function(t){return t.model.maxY},zu=function(t){return t.model.maxX+1},Vu=function(t){return t.model.maxY+1},Fu=function(t,e,n){return e(t)-n(t)},Hu=function(t){return Fu(t,Nu,Pu)},Wu=function(t){return Fu(t,Bu,Eu)},ju=function(t){return Hu(t)/2},Gu=function(t){return Wu(t)/2},Uu=function(t){return t.stepSize},qu=function(t){return t.snapToGrid},Xu=function(t){return t.snapStart},Yu=function(t){return t.rounded},$u=function(t,e){return void 0!==t[e+"-edge"]},Zu=function(t){return $u(t,"left")},Ku=function(t){return $u(t,"right")},Ju=function(t){return $u(t,"top")},Qu=function(t){return $u(t,"bottom")},tc=function(t){return t.model.value.get()},ec=function(t){return{x:t}},nc=function(t){return{y:t}},rc=function(t,e){return{x:t,y:e}},ic=function(t,e){ie(t,Du(),{value:e})},oc=function(t,e,n,r){return t<e?t:n<t?n:t===e?e-1:Math.max(e,t-r)},ac=function(t,e,n,r){return n<t?t:t<e?e:t===n?n+1:Math.min(n,t+r)},sc=function(t,e,n){return Math.max(e,Math.min(n,t))},lc=function(t){var e=t.min,n=t.max,r=t.range,i=t.value,o=t.step,a=t.snap,s=t.snapStart,l=t.rounded,u=t.minBound,c=t.maxBound,d=t.screenRange,f=t.hasMinEdge?e-1:e,h=t.hasMaxEdge?n+1:n;if(i<u)return f;if(c<i)return h;var p,g,m,v,y,x=(y=u,Math.min(c,Math.max(i,y))-y),b=sc(x/d*r+e,f,h);return a&&e<=b&&b<=n?(p=b,g=e,m=n,v=o,s.fold(function(){var t=Math.round((p-g)/v)*v;return sc(g+t,g-1,m+1)},function(t){var e=Math.round((p-t)%v/v),n=Math.floor((p-t)/v),r=Math.floor((m-t)/v),i=t+Math.min(r,n+e)*v;return Math.max(t,i)})):l?Math.round(b):b},uc=function(t){var e=t.min,n=t.value;return n<e?t.hasMinEdge?0:t.centerMinEdge:t.max<n?t.hasMaxEdge?t.maxBound:t.centerMaxEdge:(n-e)/t.range*t.maxOffset},cc="left",dc=function(t){return t.element.dom.getBoundingClientRect()},fc=function(t,e){return t[e]},hc=function(t){var e=dc(t);return fc(e,cc)},pc=function(t){var e=dc(t);return fc(e,"right")},gc=function(t){var e=dc(t);return fc(e,"top")},mc=function(t){var e=dc(t);return fc(e,"bottom")},vc=function(t){var e=dc(t);return fc(e,"width")},yc=function(t){var e=dc(t);return fc(e,"height")},xc=function(t,e,n){return(t+e)/2-n},bc=function(t,e){var n=dc(t),r=dc(e),i=fc(n,cc),o=fc(n,"right"),a=fc(r,cc);return xc(i,o,a)},_c=function(t,e){var n=dc(t),r=dc(e),i=fc(n,"top"),o=fc(n,"bottom"),a=fc(r,"top");return xc(i,o,a)},wc=function(t,e){ie(t,Du(),{value:e})},Sc=function(t){return{x:t}},Cc=function(t,e,n){var r={min:Pu(e),max:Nu(e),range:Hu(e),value:n,step:Uu(e),snap:qu(e),snapStart:Xu(e),rounded:Yu(e),hasMinEdge:Zu(e),hasMaxEdge:Ku(e),minBound:hc(t),maxBound:pc(t),screenRange:vc(t)};return lc(r)},Mc=function(t){return function(e,n){return r=e,o=(0<t?ac:oc)(tc(i=n).x,Pu(i),Nu(i),Uu(i)),wc(r,Sc(o)),P.some(o).map(k);var r,i,o}},Tc=function(t,e,n,r,i,o){var a,s,l,u,c,d,f,h,p,g=(s=o,l=n,u=r,c=i,d=vc(a=e),f=u.bind(function(t){return P.some(bc(t,a))}).getOr(0),h=c.bind(function(t){return P.some(bc(t,a))}).getOr(d),p={min:Pu(s),max:Nu(s),range:Hu(s),value:l,hasMinEdge:Zu(s),hasMaxEdge:Ku(s),minBound:hc(a),minOffset:0,maxBound:pc(a),maxOffset:d,centerMinEdge:f,centerMaxEdge:h},uc(p));return hc(e)-hc(t)+g},kc=Mc(-1),Ac=Mc(1),Ic=P.none,Dc=P.none,Oc={"top-left":P.none(),top:P.none(),"top-right":P.none(),right:P.some(function(t,e){ic(t,ec(zu(e)))}),"bottom-right":P.none(),bottom:P.none(),"bottom-left":P.none(),left:P.some(function(t,e){ic(t,ec(Ru(e)))})},Pc=Object.freeze({__proto__:null,setValueFrom:function(t,e,n){var r=Cc(t,e,n),i=Sc(r);return wc(t,i),r},setToMin:function(t,e){var n=Pu(e);wc(t,Sc(n))},setToMax:function(t,e){var n=Nu(e);wc(t,Sc(n))},findValueOfOffset:Cc,getValueFromEvent:function(t){return Ou(t).map(function(t){return t.left})},findPositionOfValue:Tc,setPositionFromValue:function(t,e,n,r){var i=tc(n),o=Tc(t,r.getSpectrum(t),i.x,r.getLeftEdge(t),r.getRightEdge(t),n),a=ku(e.element)/2;no(e.element,"left",o-a+"px")},onLeft:kc,onRight:Ac,onUp:Ic,onDown:Dc,edgeActions:Oc}),Ec=function(t,e){ie(t,Du(),{value:e})},Rc=function(t){return{y:t}},Lc=function(t,e,n){var r={min:Eu(e),max:Bu(e),range:Wu(e),value:n,step:Uu(e),snap:qu(e),snapStart:Xu(e),rounded:Yu(e),hasMinEdge:Ju(e),hasMaxEdge:Qu(e),minBound:gc(t),maxBound:mc(t),screenRange:yc(t)};return lc(r)},Nc=function(t){return function(e,n){return r=e,o=(0<t?ac:oc)(tc(i=n).y,Eu(i),Bu(i),Uu(i)),Ec(r,Rc(o)),P.some(o).map(k);var r,i,o}},Bc=function(t,e,n,r,i,o){var a,s,l,u,c,d,f,h,p,g=(s=o,l=n,u=r,c=i,d=yc(a=e),f=u.bind(function(t){return P.some(_c(t,a))}).getOr(0),h=c.bind(function(t){return P.some(_c(t,a))}).getOr(d),p={min:Eu(s),max:Bu(s),range:Wu(s),value:l,hasMinEdge:Ju(s),hasMaxEdge:Qu(s),minBound:gc(a),minOffset:0,maxBound:mc(a),maxOffset:d,centerMinEdge:f,centerMaxEdge:h},uc(p));return gc(e)-gc(t)+g},zc=P.none,Vc=P.none,Fc=Nc(-1),Hc=Nc(1),Wc={"top-left":P.none(),top:P.some(function(t,e){ic(t,nc(Lu(e)))}),"top-right":P.none(),right:P.none(),"bottom-right":P.none(),bottom:P.some(function(t,e){ic(t,nc(Vu(e)))}),"bottom-left":P.none(),left:P.none()},jc=Object.freeze({__proto__:null,setValueFrom:function(t,e,n){var r=Lc(t,e,n),i=Rc(r);return Ec(t,i),r},setToMin:function(t,e){var n=Eu(e);Ec(t,Rc(n))},setToMax:function(t,e){var n=Bu(e);Ec(t,Rc(n))},findValueOfOffset:Lc,getValueFromEvent:function(t){return Ou(t).map(function(t){return t.top})},findPositionOfValue:Bc,setPositionFromValue:function(t,e,n,r){var i=tc(n),o=Bc(t,r.getSpectrum(t),i.y,r.getTopEdge(t),r.getBottomEdge(t),n),a=fo(e.element)/2;no(e.element,"top",o-a+"px")},onLeft:zc,onRight:Vc,onUp:Fc,onDown:Hc,edgeActions:Wc}),Gc=function(t,e){ie(t,Du(),{value:e})},Uc=function(t,e){return{x:t,y:e}},qc=function(t,e){return function(n,r){return o=n,a=r,s=0<t?ac:oc,l=(i=e)?tc(a).x:s(tc(a).x,Pu(a),Nu(a),Uu(a)),u=i?s(tc(a).y,Eu(a),Bu(a),Uu(a)):tc(a).y,Gc(o,Uc(l,u)),P.some(l).map(k);var i,o,a,s,l,u}},Xc=Ou,Yc=qc(-1,!1),$c=qc(1,!1),Zc=qc(-1,!0),Kc=qc(1,!0),Jc={"top-left":P.some(function(t,e){ic(t,rc(Ru(e),Lu(e)))}),top:P.some(function(t,e){ic(t,rc(ju(e),Lu(e)))}),"top-right":P.some(function(t,e){ic(t,rc(zu(e),Lu(e)))}),right:P.some(function(t,e){ic(t,rc(zu(e),Gu(e)))}),"bottom-right":P.some(function(t,e){ic(t,rc(zu(e),Vu(e)))}),bottom:P.some(function(t,e){ic(t,rc(ju(e),Vu(e)))}),"bottom-left":P.some(function(t,e){ic(t,rc(Ru(e),Vu(e)))}),left:P.some(function(t,e){ic(t,rc(Ru(e),Gu(e)))})},Qc=Object.freeze({__proto__:null,setValueFrom:function(t,e,n){var r=Cc(t,e,n.left),i=Lc(t,e,n.top),o=Uc(r,i);return Gc(t,o),o},setToMin:function(t,e){var n=Pu(e),r=Eu(e);Gc(t,Uc(n,r))},setToMax:function(t,e){var n=Nu(e),r=Bu(e);Gc(t,Uc(n,r))},getValueFromEvent:Xc,setPositionFromValue:function(t,e,n,r){var i=tc(n),o=Tc(t,r.getSpectrum(t),i.x,r.getLeftEdge(t),r.getRightEdge(t),n),a=Bc(t,r.getSpectrum(t),i.y,r.getTopEdge(t),r.getBottomEdge(t),n),s=ku(e.element)/2,l=fo(e.element)/2;no(e.element,"left",o-s+"px"),no(e.element,"top",a-l+"px")},onLeft:Yc,onRight:$c,onUp:Zc,onDown:Kc,edgeActions:Jc}),td=[br("stepSize",1),br("onChange",f),br("onChoose",f),br("onInit",f),br("onDragStart",f),br("onDragEnd",f),br("snapToGrid",!1),br("rounded",!0),mr("snapStart"),pr("model",cr("mode",{x:[br("minX",0),br("maxX",100),wr("value",function(t){return Jr(t.mode.minX)}),hr("getInitialValue"),Ti("manager",Pc)],y:[br("minY",0),br("maxY",100),wr("value",function(t){return Jr(t.mode.minY)}),hr("getInitialValue"),Ti("manager",jc)],xy:[br("minX",0),br("maxX",100),br("minY",0),br("maxY",100),wr("value",function(t){return Jr({x:t.mode.minX,y:t.mode.minY})}),hr("getInitialValue"),Ti("manager",Qc)]})),Xs("sliderBehaviours",[qs,Cu]),wr("mouseIsDown",function(){return Jr(!1)})],ed=p("mouse.released"),nd=Xl({name:"Slider",configFields:td,partFields:du,factory:function(t,e,n,r){var i,o=function(e){return Il(e,t,"thumb")},a=function(e){return Il(e,t,"spectrum")},s=function(e){return Al(e,t,"left-edge")},l=function(e){return Al(e,t,"right-edge")},u=function(e){return Al(e,t,"top-edge")},c=function(e){return Al(e,t,"bottom-edge")},d=t.model,f=d.manager,h=function(e,n){f.setPositionFromValue(e,n,t,{getLeftEdge:s,getRightEdge:l,getTopEdge:u,getBottomEdge:c,getSpectrum:a})},p=function(t,e){d.value.set(e);var n=o(t);h(t,n)},g=function(e){var n=t.mouseIsDown.get();t.mouseIsDown.set(!1),n&&Al(e,t,"thumb").each(function(n){var r=d.value.get();t.onChoose(e,n,r)})},m=function(e,n){n.stop(),t.mouseIsDown.set(!0),t.onDragStart(e,o(e))},v=function(e,n){n.stop(),t.onDragEnd(e,o(e)),g(e)};return{uid:t.uid,dom:t.dom,components:e,behaviours:$s(t.sliderBehaviours,[qs.config({mode:"special",focusIn:function(e){return Al(e,t,"spectrum").map(qs.focusIn).map(k)}}),Cu.config({store:{mode:"manual",getValue:function(t){return d.value.get()}}}),Di.config({channels:((i={})[ed()]={onReceive:g},i)})]),events:kr([Ir(Du(),function(e,n){!function(e,n){p(e,n);var r=o(e);t.onChange(e,r,n),P.some(!0)}(e,n.event.value)}),Rr(function(e,n){var r=d.getInitialValue();d.value.set(r);var i=o(e);h(e,i);var s=a(e);t.onInit(e,i,s,d.value.get())}),Ir(kt(),m),Ir(It(),v),Ir(Dt(),m),Ir(Pt(),v)]),apis:{resetToMin:function(e){f.setToMin(e,t)},resetToMax:function(e){f.setToMax(e,t)},setValue:p,refresh:h},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,e,n){t.setValue(e,n)},resetToMin:function(t,e){t.resetToMin(e)},resetToMax:function(t,e){t.resetToMax(e)},refresh:function(t,e){t.refresh(e)}}}),rd=function(t,e,n,r){return eu(e,function(){var r=n();t.setContextToolbar([{label:e+" group",items:r}])},{},r)},id=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],od=function(t){var e=t.selection.getStart(),n=ce(e),r=ce(t.getBody()),i=function(t,e){return(ye(e)?P.some(e):Ce(e).filter(ye)).map(function(e){return po(function(t,e){return e(t)},vo,e,function(t){return ao(t,"font-size").isSome()},t).bind(function(t){return ao(t,"font-size")}).getOrThunk(function(){return io(e,"font-size")})}).getOr("")}(function(t){return ge(r,t)},n);return j(id,function(t){return i===t}).getOr("medium")},ad=p(id),sd=Jn([hr("getInitialValue"),hr("onChange"),hr("category"),hr("sizes")]),ld=function(t){var e=lr("SizeSlider",sd,t);return nd.sketch({dom:{tag:"div",classes:[Xi("slider-"+e.category+"-size-container"),Xi("slider"),Xi("slider-size-container")]},onChange:function(t,n,r){var i,o=r.x();0<=(i=o)&&i<e.sizes.length&&e.onChange(o)},onDragStart:function(t,e){Wi.on(e)},onDragEnd:function(t,e){Wi.off(e)},model:{mode:"x",minX:0,maxX:e.sizes.length-1,getInitialValue:function(){return{x:e.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:qr([Gi(nd.refresh)]),components:[nd.parts.spectrum({dom:Zl('<div class="${prefix}-slider-size-container"></div>'),components:[Kl('<div class="${prefix}-slider-size-line"></div>')]}),nd.parts.thumb({dom:Zl('<div class="${prefix}-slider-thumb"></div>'),behaviours:qr([Wi.config({toggleClass:Xi("thumb-active")})])})]})},ud=ad(),cd=function(e){var n=void 0!==e.uid&&en(e,"uid")?e.uid:Fl("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return t(t({},e),{uid:n})}}},dd=window.Promise?window.Promise:(fa=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],va(t,ga(hd,this),ga(pd,this))},ha=window,pa=fa.immediateFn||"function"==typeof ha.setImmediate&&ha.setImmediate||function(t){return setTimeout(t,1)},ga=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.apply(e,n)}},ma=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},va=function(t,e,n){var r=!1;try{t(function(t){r||(r=!0,e(t))},function(t){r||(r=!0,n(t))})}catch(v){if(r)return;r=!0,n(v)}},fa.prototype.catch=function(t){return this.then(null,t)},fa.prototype.then=function(t,e){var n=this;return new fa(function(r,i){fd.call(n,new md(t,e,r,i))})},fa.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Array.prototype.slice.call(1===t.length&&ma(t[0])?t[0]:t);return new fa(function(t,e){if(0===n.length)return t([]);for(var r=n.length,i=function(a,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var l=s.then;if("function"==typeof l)return void l.call(s,function(t){i(a,t)},e)}n[a]=s,0==--r&&t(n)}catch(o){e(o)}},a=0;a<n.length;a++)i(a,n[a])})},fa.resolve=function(t){return t&&"object"==typeof t&&t.constructor===fa?t:new fa(function(e){e(t)})},fa.reject=function(t){return new fa(function(e,n){n(t)})},fa.race=function(t){return new fa(function(e,n){for(var r=0,i=t;r<i.length;r++)i[r].then(e,n)})},fa);function fd(t){var e=this;null!==this._state?pa(function(){var n,r=e._state?t.onFulfilled:t.onRejected;if(null!==r){try{n=r(e._value)}catch(a){return void t.reject(a)}t.resolve(n)}else(e._state?t.resolve:t.reject)(e._value)}):this._deferreds.push(t)}function hd(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void va(ga(e,t),ga(hd,this),ga(pd,this))}this._state=!0,this._value=t,gd.call(this)}catch(a){pd.call(this,a)}}function pd(t){this._state=!1,this._value=t,gd.call(this)}function gd(){for(var t=0,e=this._deferreds;t<e.length;t++)fd.call(this,e[t]);this._deferreds=[]}function md(t,e,n,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=r}var vd,yd,xd,bd=function(t){return t.dom.textContent},_d=function(t){return 0<t.length},wd=function(t){return null==t?"":t},Sd=function(t){var e=ce(t.selection.getStart());return _o(e,"a")},Cd=Mt(),Md=function(t,e){var n=e.selection.getRng();t(),e.selection.setRng(n)},Td=function(t,e){var n,r;return{key:t,value:{config:{},me:(n=t,r=kr(e),Yr({fields:[hr("enabled")],name:n,active:{events:p(r)}})),configAsRaw:p({}),initialConfig:{},state:Gr}}},kd=Object.freeze({__proto__:null,getCurrent:function(t,e,n){return e.find(t)}}),Ad=[hr("find")],Id=Yr({fields:Ad,name:"composing",apis:kd}),Dd=ql({name:"Container",factory:function(n){var r=n.dom,i=r.attributes,o=e(r,["attributes"]);return{uid:n.uid,dom:t({tag:"div",attributes:t({role:"presentation"},i)},o),components:n.components,behaviours:Ys(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[br("components",[]),Xs("containerBehaviours",[]),br("events",{}),br("domModification",{}),br("eventOrder",{})]}),Od=ql({name:"DataField",factory:function(t){return{uid:t.uid,dom:t.dom,behaviours:Ks(t.dataBehaviours,[Cu.config({store:{mode:"memory",initialValue:t.getInitialValue()}}),Id.config({find:P.some})]),events:kr([Rr(function(e,n){Cu.setValue(e,t.getInitialValue())})])}},configFields:[hr("uid"),hr("dom"),hr("getInitialValue"),Zs("dataBehaviours",[Cu,Id])]}),Pd=function(t){return t.dom.value},Ed=function(t,e){if(void 0===e)throw new Error("Value.set was undefined");t.dom.value=e},Rd=p([mr("data"),br("inputAttributes",{}),br("inputStyles",{}),br("tag","input"),br("inputClasses",[]),wi("onSetValue"),br("styles",{}),br("eventOrder",{}),Xs("inputBehaviours",[Cu,Qi]),br("selectOnFocus",!0)]),Ld=function(e){return t(t({},qr([Qi.config({onFocus:e.selectOnFocus?function(t){var e=t.element,n=Pd(e);e.dom.setSelectionRange(0,n.length)}:f})])),$s(e.inputBehaviours,[Cu.config({store:t(t({mode:"manual"},e.data.map(function(t){return{initialValue:t}}).getOr({})),{getValue:function(t){return Pd(t.element)},setValue:function(t,e){Pd(t.element)!==e&&Ed(t.element,e)}}),onSetValue:e.onSetValue})]))},Nd=ql({name:"Input",configFields:Rd(),factory:function(e,n){return{uid:e.uid,dom:{tag:(r=e).tag,attributes:t({type:"text"},r.inputAttributes),styles:r.inputStyles,classes:r.inputClasses},components:[],behaviours:Ld(e),eventOrder:e.eventOrder};var r}}),Bd=Object.freeze({__proto__:null,exhibit:function(t,e){return Fr({attributes:Un([{key:e.tabAttr,value:"true"}])})}}),zd=[br("tabAttr","data-alloy-tabstop")],Vd=Yr({fields:zd,name:"tabstopping",active:Bd}),Fd=tinymce.util.Tools.resolve("tinymce.util.I18n"),Hd=function(t,e){var n=cd(Nd.sketch({inputAttributes:{placeholder:Fd.translate(e)},onSetValue:function(t,e){re(t,Nt())},inputBehaviours:qr([Id.config({find:P.some}),Vd.config({}),qs.config({mode:"execution"})]),selectOnFocus:!1})),r=cd(Yl.sketch({dom:Zl('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(t){var e=n.get(t);Cu.setValue(e,"")}}));return{name:t,spec:Dd.sketch({dom:Zl('<div class="${prefix}-input-container"></div>'),components:[n.asSpec(),r.asSpec()],containerBehaviours:qr([Wi.config({toggleClass:Xi("input-container-empty")}),Id.config({find:function(t){return P.some(n.get(t))}}),Td("input-clearing",[Ir(Nt(),function(t){var e=n.get(t);(0<Cu.getValue(e).length?Wi.off:Wi.on)(t)})])])})}},Wd=["input","button","textarea","select"],jd=function(t,e,n){(e.disabled()?$d:Zd)(t,e)},Gd=function(t,e){return!0===e.useNative&&N(Wd,me(t.element))},Ud=function(t){rn(t.element,"disabled","disabled")},qd=function(t){un(t.element,"disabled")},Xd=function(t){rn(t.element,"aria-disabled","true")},Yd=function(t){rn(t.element,"aria-disabled","false")},$d=function(t,e,n){e.disableClass.each(function(e){fn(t.element,e)}),(Gd(t,e)?Ud:Xd)(t),e.onDisabled(t)},Zd=function(t,e,n){e.disableClass.each(function(e){hn(t.element,e)}),(Gd(t,e)?qd:Yd)(t),e.onEnabled(t)},Kd=function(t,e){return Gd(t,e)?ln(t.element,"disabled"):"true"===an(t.element,"aria-disabled")},Jd=Object.freeze({__proto__:null,enable:Zd,disable:$d,isDisabled:Kd,onLoad:jd,set:function(t,e,n,r){(r?$d:Zd)(t,e)}}),Qd=Object.freeze({__proto__:null,exhibit:function(t,e){return Fr({classes:e.disabled()?e.disableClass.toArray():[]})},events:function(t,e){return kr([Ar(Xt(),function(e,n){return Kd(e,t)}),Hr(t,e,jd)])}}),tf=[_r("disabled",T,fr),br("useNative",!0),mr("disableClass"),wi("onDisabled"),wi("onEnabled")],ef=Yr({fields:tf,name:"disabling",active:Qd,apis:Jd}),nf=[Xs("formBehaviours",[Cu])],rf=function(t){return"<alloy.field."+t+">"},of=function(t,e){return{uid:t.uid,dom:t.dom,components:e,behaviours:$s(t.formBehaviours,[Cu.config({store:{mode:"manual",getValue:function(e){var n,r,i=(n=t,r=e.getSystem(),Ze(n.partUids,function(t,e){return p(r.getByUid(t))}));return Ze(i,function(t,e){return t().bind(function(t){var n,r;return n=Id.getCurrent(t),r=new Error("Cannot find a current component to extract the value from for form part '"+e+"': "+di(t.element)),n.fold(function(){return xn.error(r)},xn.value)}).map(Cu.getValue)})},setValue:function(e,n){$e(n,function(n,r){Al(e,t,r).each(function(t){Id.getCurrent(t).each(function(t){Cu.setValue(t,n)})})})}}})]),apis:{getField:function(e,n){return Al(e,t,n).bind(Id.getCurrent)}}}},af=(El(function(t,e,n){return t.getField(e,n)}),function(t){var e,n=(e=[],{field:function(t,n){return e.push(t),r=rf(t),i=n,{uiType:il(),owner:"form",name:r,config:i,validated:{}};var r,i},record:function(){return e}}),r=t(n),i=n.record(),o=z(i,function(t){return _l({name:t,pname:rf(t)})});return Wl("form",nf,o,of,r)}),sf=function(){var t=Jr(P.none()),e=function(){return t.get().each(function(t){return t.destroy()})};return{clear:function(){e(),t.set(P.none())},isSet:function(){return t.get().isSome()},set:function(n){e(),t.set(P.some(n))},run:function(e){return t.get().each(e)}}},lf=function(){var t=Jr(P.none());return{clear:function(){return t.set(P.none())},set:function(e){return t.set(P.some(e))},isSet:function(){return t.get().isSome()},on:function(e){return t.get().each(e)}}},uf=function(t){var e="navigateEvent",n=Qn([hr("fields"),br("maxFieldIndex",t.fields.length-1),hr("onExecute"),hr("getInitialValue"),wr("state",function(){return{dialogSwipeState:lf(),currentScreen:Jr(0)}})]),r=lr("SerialisedDialog",n,t),i=function(t,n,r){return Yl.sketch({dom:Zl('<span class="${prefix}-icon-'+n+' ${prefix}-icon"></span>'),action:function(n){ie(n,e,{direction:t})},buttonBehaviours:qr([ef.config({disableClass:Xi("toolbar-navigation-disabled"),disabled:function(){return!r}})])})},o=function(t,e){var n=ho(t.element,"."+Xi("serialised-dialog-screen"));bo(t.element,"."+Xi("serialised-dialog-chain")).each(function(t){0<=r.state.currentScreen.get()+e&&r.state.currentScreen.get()+e<n.length&&(ao(t,"left").each(function(r){var i=parseInt(r,10),o=ku(n[0]);no(t,"left",i-e*o+"px")}),r.state.currentScreen.set(r.state.currentScreen.get()+e))})},a=function(t){var e=ho(t.element,"input");P.from(e[r.state.currentScreen.get()]).each(function(e){t.getSystem().getByDom(e).each(function(e){var n,r;r=e.element,(n=t).getSystem().triggerFocus(r,n.element)})});var n=l.get(t);Qo.highlightAt(n,r.state.currentScreen.get())},s=cd(af(function(t){return{dom:Zl('<div class="${prefix}-serialised-dialog"></div>'),components:[Dd.sketch({dom:Zl('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:z(r.fields,function(e,n){return n<=r.maxFieldIndex?Dd.sketch({dom:Zl('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[i(-1,"previous",0<n),t.field(e.name,e.spec),i(1,"next",n<r.maxFieldIndex)]}):t.field(e.name,e.spec)})})],formBehaviours:qr([Gi(function(t,e){var n;n=e,bo(t.element,"."+Xi("serialised-dialog-chain")).each(function(t){no(t,"left",-r.state.currentScreen.get()*n.width+"px")})}),qs.config({mode:"special",focusIn:function(t,e){a(t)},onTab:function(t,e){return o(t,1),P.some(!0)},onShiftTab:function(t,e){return o(t,-1),P.some(!0)}}),Td("form-events",[Rr(function(t,e){r.state.currentScreen.set(0),r.state.dialogSwipeState.clear();var n=l.get(t);Qo.highlightFirst(n),r.getInitialValue(t).each(function(e){Cu.setValue(t,e)})}),Br(r.onExecute),Ir(Vt(),function(t,e){"left"===e.event.raw.propertyName&&a(t)}),Ir(e,function(t,e){o(t,e.event.direction)})])])}})),l=cd({dom:Zl('<div class="${prefix}-dot-container"></div>'),behaviours:qr([Qo.config({highlightClass:Xi("dot-active"),itemClass:Xi("dot-item")})]),components:q(r.fields,function(t,e){return e<=r.maxFieldIndex?[Kl('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})});return{dom:Zl('<div class="${prefix}-serializer-wrapper"></div>'),components:[s.asSpec(),l.asSpec()],behaviours:qr([qs.config({mode:"special",focusIn:function(t){var e=s.get(t);qs.focusIn(e)}}),Td("serializer-wrapper-events",[Ir(kt(),function(t,e){r.state.dialogSwipeState.set({xValue:e.event.raw.touches[0].clientX,points:[]})}),Ir(At(),function(t,e){var n=e.event;r.state.dialogSwipeState.on(function(t){e.event.prevent(),r.state.dialogSwipeState.set(function(t,e){if(e===t.xValue)return t;var n=0<e-t.xValue?1:-1,r={direction:n,xValue:e};return{xValue:e,points:(0===t.points.length?[]:t.points[t.points.length-1].direction===n?t.points.slice(0,t.points.length-1):t.points).concat([r])}}(t,n.raw.touches[0].clientX))})}),Ir(It(),function(t,e){r.state.dialogSwipeState.on(function(e){var n=s.get(t),r=-1*function(t){if(0===t.points.length)return 0;var e=t.points[0].direction,n=t.points[t.points.length-1].direction;return-1===e&&-1===n?-1:1===e&&1===n?1:0}(e);o(n,r)})})])])}},cf=A(function(t,e){return[{label:"the link group",items:[uf({fields:[Hd("url","Type or paste URL"),Hd("text","Link text"),Hd("title","Link title"),Hd("target","Link target"),{name:"link",spec:Od.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return P.none()}})}],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return P.some(function(t){return Sd(t).fold(function(){return{url:"",text:t.selection.getContent({format:"text"}),title:"",target:"",link:P.none()}},function(t){return n=bd(e=t),r=an(e,"href"),i=an(e,"title"),o=an(e,"target"),{url:wd(r),text:n!==r?wd(n):"",title:wd(i),target:wd(o),link:P.some(e)};var e,n,r,i,o})}(e))},onExecute:function(n,r){var i=Cu.getValue(n);(function(t,e){e.url.toOptional().filter(_d).fold(function(){var n;n=t,e.link.bind(g).each(function(t){n.execCommand("unlink")})},function(n){var r,i,o=(r=e,(i={}).href=n,r.title.toOptional().filter(_d).each(function(t){i.title=t}),r.target.toOptional().filter(_d).each(function(t){i.target=t}),i);e.link.bind(g).fold(function(){var r=e.text.toOptional().filter(_d).getOr(n);t.insertContent(t.dom.createHTML("a",o,t.dom.encode(r)))},function(t){var r=function(t,e,n){return n.text.toOptional().filter(_d).fold(function(){return an(n=t,"href")===bd(n)?P.some(e):P.none();var n},P.some)}(t,n,e);on(t,o),r.each(function(e){t.dom.textContent=e})})})})(e,i),t.restoreToolbar(),e.focus()}})]}]}),df=kr([{key:jt(),value:Tr({can:function(t,e){var n,r,i=e.event,o=i.originator,a=i.target;return r=a,!(ge(n=o,t.element)&&!ge(n,r)&&(console.warn(jt()+" did not get interpreted by the desired target. \nOriginator: "+di(o)+"\nTarget: "+di(a)+"\nCheck the "+jt()+" event handlers"),1))}})}]),ff=Object.freeze({__proto__:null,events:df}),hf=g,pf=function(t){var e=function(e){return function(){throw new Error("The component must be in a context to send: "+e+(t?"\n"+di(t().element)+" is not in context.":""))}};return{debugInfo:p("fake"),triggerEvent:e("triggerEvent"),triggerFocus:e("triggerFocus"),triggerEscape:e("triggerEscape"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),broadcast:e("broadcast"),broadcastOn:e("broadcastOn"),broadcastEvent:e("broadcastEvent"),isConnected:T}},gf=pf(),mf=function(t,e){var n={};return $e(t,function(t,r){$e(t,function(t,i){var o=Qe(n,i).getOr([]);n[i]=o.concat([e(r,t)])})}),n},vf=function(t){return t.cHandler},yf=function(t,e){return{name:t,handler:e}},xf="alloy.base.behaviour",bf=function(t,e){V(e,function(e){fn(t,e)})},_f=function(t,e){V(e,function(e){hn(t,e)})},wf=function(e){var n=function(){return f},r=Jr(gf),i=sr(function(t){var e,n;return ar("custom.definition",Qn([nr("dom","dom",Vn(),Qn([hr("tag"),br("styles",{}),br("classes",[]),br("attributes",{}),mr("value"),mr("innerHtml")])),hr("components"),hr("uid"),br("events",{}),br("apis",{}),nr("eventOrder","eventOrder",((e={})[Xt()]=["disabling",xf,"toggling","typeaheadevents"],e[jt()]=[xf,"focusing","keying"],e[Kt()]=[xf,"disabling","toggling","representing"],e[Nt()]=[xf,"representing","streaming","invalidating"],e[Qt()]=[xf,"representing","item-events","tooltipping"],e[Dt()]=["focusing",xf,"item-type-events"],e[kt()]=["focusing",xf,"item-type-events"],e[Et()]=["item-type-events","tooltipping"],e[qt()]=["receiving","reflecting","tooltipping"],n=e,Bn.mergeWithThunk(p(n))),dr()),mr("domModification")]),t)}(e)),o=function(t){var e,n;return function(t,e){return n=t,i=z(r=e,function(t){return yr(t.name(),[hr("config"),br("state",Gr)])}),o=ar("component.behaviours",Qn(i),n.behaviours).fold(function(t){throw new Error(ur(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))},function(t){return t}),{list:r,data:Ze(o,function(t){var e=t.map(function(t){return{config:t.config,state:t.state.init(t.config)}});return function(){return e}})};var n,r,i,o}(t,(e=Qe(t,"behaviours").getOr({}),n=F(Xe(e),function(t){return void 0!==e[t]}),z(n,function(t){return e[t].me})))}(e),a=o.list,s=o.data,l=function(t){var e=ue(t.tag);return on(e,t.attributes),bf(e,t.classes),ro(e,t.styles),t.innerHtml.each(function(t){return function(t,e){var n,r,i=we(t).dom,o=ce(i.createDocumentFragment()),a=(n=e,(r=(i||document).createElement("div")).innerHTML=n,Me(ce(r)));Oe(o,a),Pe(t),De(t,o)}(e,t)}),Oe(e,t.domChildren),t.value.each(function(t){Ed(e,t)}),zl(e,t.uid),e}(function(e,n,r){var i,o,a,s=t(t({},(i=e).dom),{uid:i.uid,domChildren:z(i.components,function(t){return t.element})}),l=e.domModification.fold(function(){return Fr({})},Fr);return a=0<n.length?function(e,n,r,i){var o=t({},n);V(r,function(t){o[t.name()]=t.exhibit(e,i)});var a=mf(o,function(t,e){return{name:t,modification:e}}),s=function(e){return H(e,function(e,n){return t(t({},n.modification),e)},{})},l=H(a.classes,function(t,e){return e.modification.concat(t)},[]),u=s(a.attributes),c=s(a.styles);return Fr({classes:l,attributes:u,styles:c})}(r,{"alloy.base.modification":l},n,s):l,t(t({},o=s),{attributes:t(t({},o.attributes),a.attributes),styles:t(t({},o.styles),a.styles),classes:o.classes.concat(a.classes)})}(i,a,s)),u=function(e,n,r){var i;return i=e.eventOrder,function(t,e){return function(t,e){var n,r,i,o,a=(n=[],r=[],V(t,function(t){t.fold(function(t){n.push(t)},function(t){r.push(t)})}),{errors:n,values:r});return 0<a.errors.length?xn.error(U(a.errors)):(o={},0===(i=a.values).length?xn.value(o):xn.value(Ln(o,Nn.apply(void 0,i))))}(Je(t,function(t,n){return(1===t.length?xn.value(t[0].handler):function(t,e,n){var r=e[n];return r?function(t,e,n,i){try{var o=(a=function(n,r){var o=n[e],a=r[e],s=i.indexOf(o),l=i.indexOf(a);if(-1===s)throw new Error("The ordering for "+t+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(i,null,2));if(-1===l)throw new Error("The ordering for "+t+" does not have an entry for "+a+".\nOrder specified: "+JSON.stringify(i,null,2));return s<l?-1:l<s?1:0},(s=E.call(n,0)).sort(a),s);return xn.value(o)}catch(r){return xn.error([r])}var a,s}("Event: "+n,"name",t,r).map(function(t){return function(t){var e,n,r,i,o=(n=function(t){return t.can},function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return W(e,function(e,r){return e&&n(r).apply(void 0,t)},!0)}),a=(r=e=t,i=function(t){return t.abort},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return W(r,function(e,n){return e||i(n).apply(void 0,t)},!1)});return Tr({can:o,abort:a,run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];V(t,function(t){t.run.apply(void 0,e)})}})}(z(t,function(t){return t.handler}))}):xn.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(z(t,function(t){return t.name}),null,2)])}(t,e,n)).map(function(r){var i=function(t){var e,n=c(e=t)?{can:k,abort:T,run:e}:e;return function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=[t,e].concat(r);n.abort.apply(void 0,o)?e.stop():n.can.apply(void 0,o)&&n.run.apply(void 0,o)}}(r),o=1<t.length?F(e[n],function(e){return B(t,function(t){return t.name===e})}).join(" > "):t[0].name;return Gn(n,{handler:i,purpose:o})})}))}(function(e,n,r){var i,o,a=t(t({},r),(i=e,o={},V(n,function(t){o[t.name()]=t.handlers(i)}),o));return mf(a,yf)}(r,n,{"alloy.base.behaviour":e.events}),i).getOrDie()}(i,a,s),d=Jr(i.components),f={getSystem:r.get,config:function(t){var n=s;return(c(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(t){return c(s[t.name()])},spec:e,readState:function(t){return s[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return i.apis},connect:function(t){r.set(t)},disconnect:function(){r.set(pf(n))},element:l,syncComponents:function(){var t=Me(l),e=q(t,function(t){return r.get().getByDom(t).fold(function(){return[]},function(t){return[t]})});d.set(e)},components:d.get,events:u};return f},Sf=function(t){var e=function(t,e){var n=document.createTextNode(t);return le(n)}(t);return Cf({element:e})},Cf=function(t){var e=lr("external.component",Jn([hr("element"),mr("uid")]),t),n=Jr(pf());e.uid.each(function(t){zl(e.element,t)});var r={getSystem:n.get,config:P.none,hasConfigured:T,connect:function(t){n.set(t)},disconnect:function(){n.set(pf(function(){return r}))},getApis:function(){return{}},element:e.element,spec:t,readState:p("No state"),syncComponents:f,components:p([]),events:{}};return Pl(r)},Mf=Fl,Tf=function(n){return Qe(n,Ol).fold(function(){return function(n){var r,i=hf(n),o=i.events,a=e(i,["events"]),s=(r=Qe(a,"components").getOr([]),z(r,Tf)),l=t(t({},a),{events:t(t({},ff),o),components:s});return xn.value(wf(l))}(n.hasOwnProperty("uid")?n:t({uid:Mf("")},n)).getOrDie()},function(t){return t})},kf=Pl,Af="alloy.item-hover",If="alloy.item-focus",Df=function(t){(ni(t.element).isNone()||Qi.isFocused(t))&&(Qi.isFocused(t)||Qi.focus(t),ie(t,Af,{item:t}))},Of=function(t){ie(t,If,{item:t})},Pf=p(Af),Ef=p(If),Rf=[hr("data"),hr("components"),hr("dom"),br("hasSubmenu",!1),mr("toggling"),Zs("itemBehaviours",[Wi,Qi,qs,Cu]),br("ignoreFocus",!1),br("domModification",{}),Ti("builder",function(e){return{dom:e.dom,domModification:t(t({},e.domModification),{attributes:t(t(t({role:e.toggling.isSome()?"menuitemcheckbox":"menuitem"},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Ks(e.itemBehaviours,[e.toggling.fold(Wi.revoke,function(e){return Wi.config(t({aria:{mode:"checked"}},e))}),Qi.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:function(t){Of(t)}}),qs.config({mode:"execution"}),Cu.config({store:{mode:"memory",initialValue:e.data}}),Td("item-type-events",n(Yi(),[Ir(Et(),Df),Ir(Yt(),Qi.focus)]))]),components:e.components,eventOrder:e.eventOrder}}),br("eventOrder",{})],Lf=[hr("dom"),hr("components"),Ti("builder",function(t){return{dom:t.dom,components:t.components,events:kr([(e=Yt(),Ir(e,function(t,e){e.stop()}))])};var e})],Nf=p("item-widget"),Bf=p([_l({name:"widget",overrides:function(t){return{behaviours:qr([Cu.config({store:{mode:"manual",getValue:function(e){return t.data},setValue:f}})])}}})]),zf=cr("type",{widget:[hr("uid"),hr("data"),hr("components"),hr("dom"),br("autofocus",!1),br("ignoreFocus",!1),Zs("widgetBehaviours",[Cu,Qi,qs]),br("domModification",{}),Dl(Bf()),Ti("builder",function(t){var e=Tl(Nf(),t,Bf()),n=kl(Nf(),t,e.internals()),r=function(e){return Al(e,t,"widget").map(function(t){return qs.focusIn(t),t})},i=function(e,n){return wa(n.event.target)||t.autofocus&&n.setSource(e.element),P.none()};return{dom:t.dom,components:n,domModification:t.domModification,events:kr([Br(function(t,e){r(t).each(function(t){e.stop()})}),Ir(Et(),Df),Ir(Yt(),function(e,n){t.autofocus?r(e):Qi.focus(e)})]),behaviours:Ks(t.widgetBehaviours,[Cu.config({store:{mode:"memory",initialValue:t.data}}),Qi.config({ignore:t.ignoreFocus,onFocus:function(t){Of(t)}}),qs.config({mode:"special",focusIn:t.autofocus?function(t){r(t)}:Zr(),onLeft:i,onRight:i,onEscape:function(e,n){return Qi.isFocused(e)||t.autofocus?(t.autofocus&&n.setSource(e.element),P.none()):(Qi.focus(e),P.some(!0))}})])}})],item:Rf,separator:Lf}),Vf=p([Sl({factory:{sketch:function(t){var e=lr("menu.spec item",zf,t);return e.builder(e)}},name:"items",unit:"item",defaults:function(e,n){return n.hasOwnProperty("uid")?n:t(t({},n),{uid:Fl("item")})},overrides:function(t,e){return{type:e.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Ff=p([hr("value"),hr("items"),hr("dom"),hr("components"),br("eventOrder",{}),Xs("menuBehaviours",[Qo,Cu,Id,qs]),_r("movement",{mode:"menu",moveOnTab:!0},cr("mode",{grid:[Ai(),Ti("config",function(t,e){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:t.focusManager}})],matrix:[Ti("config",function(t,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),hr("rowSelector")],menu:[br("moveOnTab",!0),Ti("config",function(t,e){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:e.moveOnTab,focusManager:t.focusManager}})]})),pr("markers",xi()),br("fakeFocus",!1),br("focusManager",ea()),wi("onHighlight")]),Hf=p("alloy.menu-focus"),Wf=Xl({name:"Menu",configFields:Ff(),partFields:Vf(),factory:function(t,e,n,r){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:$s(t.menuBehaviours,[Qo.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),Cu.config({store:{mode:"memory",initialValue:t.value}}),Id.config({find:P.some}),qs.config(t.movement.config(t,t.movement))]),events:kr([Ir(Ef(),function(t,e){var n=e.event;t.getSystem().getByDom(n.target).each(function(n){Qo.highlight(t,n),e.stop(),ie(t,Hf(),{menu:t,item:n})})}),Ir(Pf(),function(t,e){Qo.highlight(t,e.event.item)})]),components:e,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),jf=function(t,e,n,r){var i=t.getSystem().build(r);Ue(t,i,n)},Gf=function(t,e,n,r){var i=Uf(t);j(i,function(t){return ge(r.element,t.element)}).each(qe)},Uf=function(t,e){return t.components()},qf=function(t,e,n,r,i){var o=Uf(t);return P.from(o[r]).map(function(e){return Gf(t,0,0,e),i.each(function(e){jf(t,0,function(t,e){var n,i;i=e,Te(n=t,r).fold(function(){De(n,i)},function(t){ke(t,i)})},e)}),e})},Xf=Yr({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,e,n,r){jf(t,0,De,r)},prepend:function(t,e,n,r){jf(t,0,Ie,r)},remove:Gf,replaceAt:qf,replaceBy:function(t,e,n,r,i){var o=Uf(t);return G(o,r).bind(function(e){return qf(t,0,0,e,i)})},set:function(t,e,n,r){!function(t,e){var n=Be(e),r=ei(n).bind(function(t){var n,r,i=function(e){return ge(t,e)};return i(e)?P.some(e):(n=i,(r=function(t){for(var e=0;e<t.childNodes.length;e++){var i=ce(t.childNodes[e]);if(n(i))return P.some(i);var o=r(t.childNodes[e]);if(o.isSome())return o}return P.none()})(e.dom))});t(),r.each(function(t){ei(n).filter(function(e){return ge(e,t)}).fold(function(){Qr(t)},f)})}(function(){var e=z(r,t.getSystem().build);!function(t,e){var n,r=t.components();V((n=t).components(),function(t){return Ee(t.element)}),Pe(n.element),n.syncComponents();var i=$(r,e);V(i,function(e){We(e),t.getSystem().removeFromWorld(e)}),V(e,function(e){e.getSystem().isConnected()?Ge(t,e):(t.getSystem().addToWorld(e),Ge(t,e),Ve(t.element)&&je(e)),t.syncComponents()})}(t,e)},t.element)},contents:Uf})}),Yf=function(t,e,n,r){return Qe(n,r).bind(function(r){return Qe(t,r).bind(function(r){var i=Yf(t,e,n,r);return P.some([r].concat(i))})}).getOr([])},$f=function(t){return"prepared"===t.type?P.some(t.menu):P.none()},Zf=$f,Kf=p("collapse-item"),Jf=ql({name:"TieredMenu",configFields:[Mi("onExecute"),Mi("onEscape"),Ci("onOpenMenu"),Ci("onOpenSubmenu"),wi("onRepositionMenu"),wi("onCollapseMenu"),br("highlightImmediately",!0),gr("data",[hr("primary"),hr("menus"),hr("expansions")]),br("fakeFocus",!1),wi("onHighlight"),wi("onHover"),gr("markers",[hr("backgroundMenu")].concat(vi()).concat(yi())),hr("dom"),br("navigateOnHover",!0),br("stayInDom",!1),Xs("tmenuBehaviours",[qs,Qo,Id,Xf]),br("eventOrder",{})],apis:{collapseMenu:function(t,e){t.collapseMenu(e)},highlightPrimary:function(t,e){t.highlightPrimary(e)},repositionMenus:function(t,e){t.repositionMenus(e)}},factory:function(e,n){var r,i,o=Jr(P.none()),a=function(){var e=Jr({}),n=Jr({}),r=Jr({}),i=Jr(P.none()),o=Jr({}),a=function(t){return function(t,e){for(var n=Xe(t),r=0,i=n.length;r<i;r++){var o=t[n[r]];if(e(o))return P.some(o)}return P.none()}(e.get(),function(e,n){return e===t})},s=function(t){return l(t).bind($f)},l=function(t){return Qe(n.get(),t)},u=function(t){return Qe(e.get(),t)};return{setMenuBuilt:function(e,r){var i;n.set(t(t({},n.get()),((i={})[e]={type:"prepared",menu:r},i)))},setContents:function(t,a,s,l){i.set(P.some(t)),e.set(s),n.set(a),o.set(l);var u=function(t,e){var n={};$e(t,function(t,e){V(t,function(t){n[t]=e})});var r=e,i=Ke(e,function(t,e){return{k:t,v:e}}),o=Ze(i,function(t,e){return[e].concat(Yf(n,r,i,e))});return Ze(n,function(t){return Qe(o,t).getOr([t])})}(l,s);r.set(u)},expand:function(t){return Qe(e.get(),t).map(function(e){var n=Qe(r.get(),t).getOr([]);return[e].concat(n)})},refresh:function(t){return Qe(r.get(),t)},collapse:function(t){return Qe(r.get(),t).bind(function(t){return 1<t.length?P.some(t.slice(1)):P.none()})},lookupMenu:l,lookupItem:u,otherMenus:function(t){var e=o.get();return $(Xe(e),t)},getPrimary:function(){return i.get().bind(s)},getMenus:function(){return n.get()},clear:function(){e.set({}),n.set({}),r.set({}),i.set(P.none())},isClear:function(){return i.get().isNone()},getTriggeringPath:function(t,e){var n=F(u(t).toArray(),function(t){return s(t).isSome()});return Qe(r.get(),t).bind(function(t){var r=Y(n.concat(t));return function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];if(!r.isSome())return P.none();e.push(r.getOrDie())}return P.some(e)}(q(r,function(t,n){return o=t,l=e,u=r.slice(0,n+1),s(o).bind(function(t){return a(o).bind(function(e){return l(e).map(function(e){return{triggeredMenu:t,triggeringItem:e,triggeringPath:u}})})}).fold(function(){return i.get().is(t)?[]:[P.none()]},function(t){return[P.some(t)]});var o,l,u}))})}}}(),s=function(t){return Cu.getValue(t).value},l=function(t,e){Qo.highlight(t,e),Qo.getHighlighted(e).orThunk(function(){return Qo.getFirst(e)}).each(function(e){ae(t,e.element,Yt())})},u=function(t,e){return jo(z(e,function(e){return t.lookupMenu(e).bind(function(t){return"prepared"===t.type?P.some(t.menu):P.none()})}))},c=function(t,n,r){var i=u(n,n.otherMenus(r));V(i,function(n){_f(n.element,[e.markers.backgroundMenu]),e.stayInDom||Xf.remove(t,n)})},d=function(t,n){var r,i=(r=t,o.get().getOrThunk(function(){var t={},n=ho(r.element,"."+e.markers.item),i=F(n,function(t){return"true"===an(t,"aria-haspopup")});return V(i,function(e){r.getSystem().getByDom(e).each(function(e){var n=s(e);t[n]=e})}),o.set(P.some(t)),t}));$e(i,function(t,e){var r=N(n,e);rn(t.element,"aria-expanded",r)})},h=function(t,n,r){return P.from(r[0]).bind(function(i){return n.lookupMenu(i).bind(function(i){if("notbuilt"===i.type)return P.none();var o=i.menu,a=u(n,r.slice(1));return V(a,function(t){fn(t.element,e.markers.backgroundMenu)}),Ve(o.element)||Xf.append(t,kf(o)),_f(o.element,[e.markers.backgroundMenu]),l(t,o),c(t,n,r),P.some(o)})})};(i=r=r||{})[i.HighlightSubmenu=0]="HighlightSubmenu",i[i.HighlightParent=1]="HighlightParent";var p=function(t,n,i){void 0===i&&(i=r.HighlightSubmenu);var o=s(n);return a.expand(o).bind(function(o){return d(t,o),P.from(o[0]).bind(function(s){return a.lookupMenu(s).bind(function(l){var u=function(t,e,n){if("notbuilt"!==n.type)return n.menu;var r=t.getSystem().build(n.nbMenu());return a.setMenuBuilt(e,r),r}(t,s,l);return Ve(u.element)||Xf.append(t,kf(u)),e.onOpenSubmenu(t,n,u,Y(o)),i===r.HighlightSubmenu?(Qo.highlightFirst(u),h(t,a,o)):(Qo.dehighlightAll(u),P.some(n))})})})},g=function(t,n){var r=s(n);return a.collapse(r).bind(function(r){return d(t,r),h(t,a,r).map(function(r){return e.onCollapseMenu(t,n,r),r})})},m=function(t){return function(n,r){return _o(r.getSource(),"."+e.markers.item).bind(function(e){return n.getSystem().getByDom(e).toOptional().bind(function(e){return t(n,e).map(k)})})}},v=kr([Ir(Hf(),function(t,e){a.lookupItem(s(e.event.item)).each(function(){Qo.highlight(t,e.event.menu);var n=s(e.event.item);a.refresh(n).each(function(e){return c(t,a,e)})})}),Br(function(t,n){var i=n.event.target;t.getSystem().getByDom(i).each(function(n){0===s(n).indexOf("collapse-item")&&g(t,n),p(t,n,r.HighlightSubmenu).fold(function(){e.onExecute(t,n)},f)})}),Rr(function(n,r){var i,o;i=function(n,r,i){return Ze(i,function(i,o){var a=function(){return Wf.sketch(t(t({},i),{value:o,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:e.onHighlight,focusManager:e.fakeFocus?{get:n=function(t){return Qo.getHighlighted(t).map(function(t){return t.element})},set:function(t,e){var r=n(t);t.getSystem().getByDom(e).fold(f,function(e){Qo.highlight(t,e)});var i=n(t);ta(t,r,i)}}:ea()}));var n};return o===r?{type:"prepared",menu:n.getSystem().build(a())}:{type:"notbuilt",nbMenu:a}})}(n,e.data.primary,e.data.menus),o=Ze(e.data.menus,function(t,e){return q(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})}),a.setContents(e.data.primary,i,e.data.expansions,o),a.getPrimary().each(function(t){Xf.append(n,kf(t)),e.onOpenMenu(n,t),e.highlightImmediately&&l(n,t)})})].concat(e.navigateOnHover?[Ir(Pf(),function(t,n){var i,o,l=n.event.item;i=t,o=s(l),a.refresh(o).bind(function(t){return d(i,t),h(i,a,t)}),p(t,l,r.HighlightParent),e.onHover(t,l)})]:[])),y=function(t){return Qo.getHighlighted(t).bind(Qo.getHighlighted)},x={collapseMenu:function(t){y(t).each(function(e){g(t,e)})},highlightPrimary:function(t){a.getPrimary().each(function(e){l(t,e)})},repositionMenus:function(t){a.getPrimary().bind(function(e){return y(t).bind(function(t){var e,n=s(t),r=(e=a.getMenus(),Je(e,function(t){return t})),i=jo(z(r,Zf));return a.getTriggeringPath(n,function(t){return e=t,K(i,function(t){if(!t.getSystem().isConnected())return P.none();var n=Qo.getCandidates(t);return j(n,function(t){return s(t)===e})});var e})}).map(function(t){return{primary:e,triggeringPath:t}})}).fold(function(){P.from(t.components()[0]).filter(function(t){return"menu"===an(t.element,"role")}).each(function(n){e.onRepositionMenu(t,n,[])})},function(n){e.onRepositionMenu(t,n.primary,n.triggeringPath)})}};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:$s(e.tmenuBehaviours,[qs.config({mode:"special",onRight:m(function(t,e){return wa(e.element)?P.none():p(t,e,r.HighlightSubmenu)}),onLeft:m(function(t,e){return wa(e.element)?P.none():g(t,e)}),onEscape:m(function(t,n){return g(t,n).orThunk(function(){return e.onEscape(t,n).map(function(){return t})})}),focusIn:function(t,e){a.getPrimary().each(function(e){ae(t,e.element,Yt())})}}),Qo.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),Id.config({find:function(t){return Qo.getHighlighted(t)}}),Xf.config({})]),eventOrder:e.eventOrder,apis:x,events:v}},extraApis:{tieredData:function(t,e,n){return{primary:t,menus:e,expansions:n}},singleData:function(t,e){return{primary:t,menus:Gn(t,e),expansions:{}}},collapseItem:function(t){return{value:al(Kf()),meta:{text:t}}}}}),Qf=function(t,e,n,r){return Qe(e.routes,r.start).bind(function(t){return Qe(t,r.destination)})},th=function(t,e,n,r){return Qf(0,e,0,r).bind(function(t){return t.transition.map(function(e){return{transition:e,route:t}})})},eh=function(t,e,n){var r;nh(t,r=e).bind(function(t){return th(0,r,0,t)}).each(function(n){hn(t.element,n.transition.transitionClass),un(t.element,e.destinationAttr)})},nh=function(t,e,n){return sn(t.element,e.destinationAttr).map(function(n){return{start:an(t.element,e.stateAttr),destination:n}})},rh=function(t,e,n,r){eh(t,e),ln(t.element,e.stateAttr)&&an(t.element,e.stateAttr)!==r&&e.onFinish(t,r),rn(t.element,e.stateAttr,r)},ih=Object.freeze({__proto__:null,findRoute:Qf,disableTransition:eh,getCurrentRoute:nh,jumpTo:rh,progressTo:function(t,e,n,r){var i,o;ln((i=t).element,(o=e).destinationAttr)&&(sn(i.element,o.destinationAttr).each(function(t){rn(i.element,o.stateAttr,t)}),un(i.element,o.destinationAttr));var a,s=(a=r,{start:an(t.element,e.stateAttr),destination:a});th(0,e,0,s).fold(function(){rh(t,e,0,r)},function(n){eh(t,e),fn(t.element,n.transition.transitionClass),rn(t.element,e.destinationAttr,r)})},getState:function(t,e,n){return sn(t.element,e.stateAttr)}}),oh=Object.freeze({__proto__:null,events:function(t,e){return kr([Ir(Vt(),function(e,n){var r=n.event.raw;nh(e,t).each(function(n){Qf(0,t,0,n).each(function(i){i.transition.each(function(i){r.propertyName===i.property&&(rh(e,t,0,n.destination),t.onTransition(e,n))})})})}),Rr(function(e,n){rh(e,t,0,t.initialState)})])}}),ah=[br("destinationAttr","data-transitioning-destination"),br("stateAttr","data-transitioning-state"),hr("initialState"),wi("onTransition"),wi("onFinish"),pr("routes",or(xn.value,or(xn.value,Jn([xr("transition",[hr("property"),hr("transitionClass")])]))))],sh=Yr({fields:ah,name:"transitioning",active:oh,apis:ih,extra:{createRoutes:function(t){var e={};return $e(t,function(t,n){var r=n.split("<->");e[r[0]]=Gn(r[1],t),e[r[1]]=Gn(r[0],t)}),e},createBistate:function(t,e,n){return Un([{key:t,value:Gn(e,n)},{key:e,value:Gn(t,n)}])},createTristate:function(t,e,n,r){return Un([{key:t,value:Un([{key:e,value:r},{key:n,value:r}])},{key:e,value:Un([{key:t,value:r},{key:n,value:r}])},{key:n,value:Un([{key:t,value:r},{key:e,value:r}])}])}}}),lh=Xi("scrollable"),uh=function(t){fn(t,lh)},ch=function(t){hn(t,lh)},dh=lh,fh=function(t){return Qe(t,"format").getOr(t.title)},hh=function(t,e,n,r,i){return{data:{value:t,text:e},type:"item",dom:{tag:"div",classes:i?[Xi("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:Xi("format-matches"),selected:n},itemBehaviours:qr(i?[]:[ji(t,function(t,e){(e?Wi.on:Wi.off)(t)})]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:e}}]}},ph=function(t,e,n,r){return{value:t,dom:{tag:"div"},components:[Yl.sketch({dom:{tag:"div",classes:[Xi("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[Xi("styles-collapse-icon")]}},Sf(t)]:[Sf(t)],action:function(t){var e;r&&(e=n().get(t),Jf.collapseMenu(e))}}),{dom:{tag:"div",classes:[Xi("styles-menu-items-container")]},components:[Wf.parts.items({})],behaviours:qr([Td("adhoc-scrollable-menu",[Rr(function(t,e){no(t.element,"overflow-y","auto"),no(t.element,"-webkit-overflow-scrolling","touch"),uh(t.element)}),Lr(function(t){so(t.element,"overflow-y"),so(t.element,"-webkit-overflow-scrolling"),ch(t.element)})])])}],items:e,menuBehaviours:qr([sh.config({initialState:"after",routes:sh.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},gh=function(t){return H(t,function(t,e){var n=function(t){return en(t,"items")?(n=Ln(function(t,e){return n=["items"],r={},$e(t,function(t,e){N(n,e)||(r[e]=t)}),r;var n,r}(e=t),{menu:!0}),r=gh(e.items),{item:n,menus:Ln(r.menus,Gn(e.title,r.items)),expansions:Ln(r.expansions,Gn(e.title,e.title))}):{item:t,menus:{},expansions:{}};var e,n,r}(e);return{menus:Ln(t.menus,n.menus),items:[n.item].concat(t.items),expansions:Ln(t.expansions,n.expansions)}},{menus:{},expansions:{},items:[]})},mh=function(t){var e=t.replace(/\|/g," ").trim();return 0<e.length?e.split(/\s+/):[]},vh=function(t){return q(t,function(t){return(s(t)?vh:mh)(t)})},yh=function(t){var e=t.getParam("toolbar",ai,"array");return(s(e)?vh:mh)(e)},xh=function(t,e){var n=function(t){return function(){return eu(r=t,function(){n.execCommand(r)},{},n=e);var n,r}},r=function(t){return function(){return n=e,i=Jl(r=t),eu(r,function(){n.execCommand(r)},i,n);var n,r,i}},i=function(t,n,r){return function(){return Ql(e,t,n,r)}},o=n("undo"),a=n("redo"),s=r("bold"),l=r("italic"),u=r("underline"),c=n("removeformat"),d=i("unlink","link",function(){e.execCommand("unlink",null,!1)}),f=i("unordered-list","ul",function(){e.execCommand("InsertUnorderedList",null,!1)}),h=i("ordered-list","ol",function(){e.execCommand("InsertOrderedList",null,!1)}),g=function(t){var e=function(e){return function(){return t.formatter.match(e)}},n=function(e){return function(){return t.formatter.getCssText(e)}},r=function(i){return z(i,function(i){if(en(i,"items")){var o=r(i.items);return Ln(Ln(i,{isSelected:T,getPreview:p("")}),{items:o})}return en(i,"format")?Ln(u=i,{isSelected:e(u.format),getPreview:n(u.format)}):(s=al((a=i).title),l=Ln(a,{format:s,isSelected:e(s),getPreview:n(s)}),t.formatter.register(s,l),l);var a,s,l,u})};return r(t.getParam("style_formats",oi,"array"))}(e),m=function(){return function(t,e,n){var r,i,o;return function(t){var e,n,r,i,o,a=(n=function(){return s},r=ph("Styles",[].concat(z((e=t.formats).items,function(t){return hh(fh(t),t.title,t.isSelected(),t.getPreview(),en(e.expansions,fh(t)))})),n,!1),i=Ze(e.menus,function(t,r){var i=z(t,function(t){return hh(fh(t),t.title,void 0!==t.isSelected&&t.isSelected(),void 0!==t.getPreview?t.getPreview():"",en(e.expansions,fh(t)))});return ph(r,i,n,!0)}),o=Ln(i,Gn("styles",r)),{tmenu:Jf.tieredData("styles",o,e.expansions)}),s=cd(Jf.sketch({dom:{tag:"div",classes:[Xi("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(e,n){var r=Cu.getValue(n);return t.handle(n,r.value),P.none()},onEscape:function(){return P.none()},onOpenMenu:function(t,e){var n=ku(t.element);Tu(e.element,n),sh.jumpTo(e,"current")},onOpenSubmenu:function(t,e,n){var r=ku(t.element),i=xo(e.element,'[role="menu"]').getOrDie("hacky"),o=t.getSystem().getByDom(i).getOrDie();Tu(n.element,r),sh.progressTo(o,"before"),sh.jumpTo(n,"after"),sh.progressTo(n,"current")},onCollapseMenu:function(t,e,n){var r=xo(e.element,'[role="menu"]').getOrDie("hacky"),i=t.getSystem().getByDom(r).getOrDie();sh.progressTo(i,"after"),sh.progressTo(n,"current")},navigateOnHover:!1,highlightImmediately:!0,data:a.tmenu,markers:{backgroundMenu:Xi("styles-background-menu"),menu:Xi("styles-menu"),selectedMenu:Xi("styles-selected-menu"),item:Xi("styles-item"),selectedItem:Xi("styles-selected-item")}}));return s.asSpec()}({formats:(r=t,o=(i=function(t){return q(t,function(t){return void 0===t.items?!en(t,"format")||r.formatter.canApply(t.format)?[t]:[]:0<i(t.items).length?[t]:[]})})(e),gh(o)),handle:function(e,r){t.undoManager.transact(function(){Wi.isOn(e)?t.formatter.remove(r):t.formatter.apply(r)}),n()}})}(e,g,function(){e.fire("scrollIntoView")})},v=function(t,n){return{isSupported:function(){var n=e.ui.registry.getAll().buttons;return t.forall(function(t){return en(n,t)})},sketch:n}};return{undo:v(P.none(),o),redo:v(P.none(),a),bold:v(P.none(),s),italic:v(P.none(),l),underline:v(P.none(),u),removeformat:v(P.none(),c),link:v(P.none(),function(){return function(t,e){return Ql(e,"link","link",function(){var n,r,i=cf(t,e);t.setContextToolbar(i),n=e,r=function(){t.focusToolbar()},(Cd.os.isAndroid()?Md:M)(r,n),Sd(e).each(function(t){e.selection.select(t.dom)})})}(t,e)}),unlink:v(P.none(),d),image:v(P.none(),function(){return function(t){var e=cd({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:kr([Er(zt()),Ir(Bt(),function(e,n){var r;P.from(((r=n.event.raw).target.files||r.dataTransfer.files)[0]).each(function(e){var n,r;n=t,function(t){return e=t,new dd(function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}).then(function(t){return t.split(",")[1]});var e}(r=e).then(function(t){n.undoManager.transact(function(){var e=n.editorUpload.blobCache,i=e.create(al("mceu"),r,t);e.add(i);var o=n.dom.createHTML("img",{src:i.blobUri()});n.insertContent(o)})})})})])});return Yl.sketch({dom:tu("image",t),components:[e.asSpec()],action:function(t){e.get(t).element.dom.click()}})}(e)}),bullist:v(P.some("bullist"),f),numlist:v(P.some("numlist"),h),fontsizeselect:v(P.none(),function(){return r={onChange:function(t){!function(t,e){P.from(id[e]).each(function(e){var n,r;r=e,od(n=t)!==r&&n.execCommand("fontSize",!1,r)})}(n,t)},getInitialValue:function(){return function(t){var e,n=od(t);return e=n,G(id,function(t){return t===e}).getOr(2)}(n)}},rd(t,"font-size",function(){return function(t){return[Kl('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),ld({onChange:(e=t).onChange,sizes:ud,category:"font",getInitialValue:e.getInitialValue}),Kl('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')];var e}(r)},n=e);var n,r}),forecolor:v(P.none(),function(){return r={onChange:function(t,e,r){n.undoManager.transact(function(){n.formatter.apply("forecolor",{value:r}),n.nodeChanged()})},getInitialValue:function(){return-1}},rd(t,"color-levels",function(){return function(t){return[(e=t,n=function(t){return t<0?"black":360<t?"white":"hsl("+t+", 100%, 50%)"},nd.sketch({dom:Zl('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[nd.parts["left-edge"](Kl('<div class="${prefix}-hue-slider-black"></div>')),nd.parts.spectrum({dom:Zl('<div class="${prefix}-slider-gradient-container"></div>'),components:[Kl('<div class="${prefix}-slider-gradient"></div>')],behaviours:qr([Wi.config({toggleClass:Xi("thumb-active")})])}),nd.parts["right-edge"](Kl('<div class="${prefix}-hue-slider-white"></div>')),nd.parts.thumb({dom:Zl('<div class="${prefix}-slider-thumb"></div>'),behaviours:qr([Wi.config({toggleClass:Xi("thumb-active")})])})],onChange:function(t,r,i){var o=n(i.x());no(r.element,"background-color",o),e.onChange(t,r,o)},onDragStart:function(t,e){Wi.on(e)},onDragEnd:function(t,e){Wi.off(e)},onInit:function(t,e,r,i){var o=n(i.x());no(e.element,"background-color",o)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:e.getInitialValue()}}},sliderBehaviours:qr([Gi(nd.refresh)])}))];var e,n}(r)},n=e);var n,r}),styleselect:v(P.none(),function(){return eu("style-formats",function(n){e.fire("toReading"),t.dropup.appear(m,Wi.on,n)},qr([Wi.config({toggleClass:Xi("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Di.config({channels:Un([Ui(li,Wi.off),Ui(ui,Wi.off)])})]),e)})}},bh=function(t){var e=ce(function(t){if(Ne()&&u(t.target)){var e=ce(t.target);if(ye(e)&&function(t){return u(t.dom.shadowRoot)}(e)&&t.composed&&t.composedPath){var n=t.composedPath();if(n)return function(t){return 0<(e=t).length?P.some(e[0]):P.none();var e}(n)}}return P.from(t.target)}(t).getOr(t.target)),n=function(){return t.stopPropagation()},r=function(){return t.preventDefault()},i=h(r,n);return{target:e,x:t.clientX,y:t.clientY,stop:n,prevent:r,kill:i,raw:t}},_h=function(t,e,n,r,i){var o,a,s=(o=n,a=r,function(t){o(t)&&a(bh(t))});return t.dom.addEventListener(e,s,i),{unbind:m(wh,t,e,s,i)}},wh=function(t,e,n,r){t.dom.removeEventListener(e,n,r)},Sh=k,Ch=function(t,e,n){return _h(t,e,Sh,n,!1)},Mh=function(t,e,n){return _h(t,e,Sh,n,!0)},Th=tinymce.util.Tools.resolve("tinymce.util.Delay"),kh=function(t){var e=t.matchMedia("(orientation: portrait)").matches;return{isPortrait:p(e)}},Ah=function(t,e){var n=ce(t),r=null,i=Ch(n,"orientationchange",function(){Th.clearInterval(r);var n=kh(t);e.onChange(n),o(function(){e.onReady(n)})}),o=function(e){Th.clearInterval(r);var n=t.innerHeight,i=0;r=Th.setInterval(function(){n!==t.innerHeight?(Th.clearInterval(r),e(P.some(t.innerHeight))):20<i&&(Th.clearInterval(r),e(P.none())),i++},50)};return{onAdjustment:o,destroy:function(){i.unbind()}}},Ih=function(t,e,n){var r,i,o=t.document.createRange();return r=o,e.fold(function(t){r.setStartBefore(t.dom)},function(t,e){r.setStart(t.dom,e)},function(t){r.setStartAfter(t.dom)}),i=o,n.fold(function(t){i.setEndBefore(t.dom)},function(t,e){i.setEnd(t.dom,e)},function(t){i.setEndAfter(t.dom)}),o},Dh=function(t,e,n,r,i){var o=t.document.createRange();return o.setStart(e.dom,n),o.setEnd(r.dom,i),o},Oh=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},Ph=Pn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Eh=function(t,e,n){return e(ce(n.startContainer),n.startOffset,ce(n.endContainer),n.endOffset)},Rh=function(t,e){var n,r,i,o=(n=t,e.match({domRange:function(t){return{ltr:p(t),rtl:P.none}},relative:function(t,e){return{ltr:A(function(){return Ih(n,t,e)}),rtl:A(function(){return P.some(Ih(n,e,t))})}},exact:function(t,e,r,i){return{ltr:A(function(){return Dh(n,t,e,r,i)}),rtl:A(function(){return P.some(Dh(n,r,i,t,e))})}}}));return(i=(r=o).ltr()).collapsed?r.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Ph.rtl(ce(t.endContainer),t.endOffset,ce(t.startContainer),t.startOffset)}).getOrThunk(function(){return Eh(0,Ph.ltr,i)}):Eh(0,Ph.ltr,i)},Lh=function(t,e,n,r){return{start:t,soffset:e,finish:n,foffset:r}},Nh=(vd=xe,{get:function(t){if(!vd(t))throw new Error("Can only get text value of a text node");return yd(t).getOr("")},getOption:yd=function(t){return vd(t)?P.from(t.dom.nodeValue):P.none()},set:function(t,e){if(!vd(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=e}}),Bh=Pn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),zh={before:Bh.before,on:Bh.on,after:Bh.after,cata:function(t,e,n,r){return t.fold(e,n,r)},getStart:function(t){return t.fold(g,g,g)}},Vh=Pn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Fh={domRange:Vh.domRange,relative:Vh.relative,exact:Vh.exact,exactFromRange:function(t){return Vh.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var e=t.match({domRange:function(t){return ce(t.startContainer)},relative:function(t,e){return zh.getStart(t)},exact:function(t,e,n,r){return t}});return ce(Se(e).dom.defaultView)},range:Lh},Hh=function(t,e){var n=me(t);return"input"===n?zh.after(t):N(["br","img"],n)?0===e?zh.before(t):zh.after(t):zh.on(t,e)},Wh=function(t){return P.from(t.getSelection())},jh=function(t,e,n,r,i){var o,a=Dh(t,e,n,r,i);o=a,Wh(t).each(function(t){t.removeAllRanges(),t.addRange(o)})},Gh=function(t){if(0<t.rangeCount){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return P.some(Lh(ce(e.startContainer),e.startOffset,ce(n.endContainer),n.endOffset))}return P.none()},Uh=function(t){if(null===t.anchorNode||null===t.focusNode)return Gh(t);var e=ce(t.anchorNode),n=ce(t.focusNode);return function(t,e,n,r){var i,o,a,s,l,u=(o=e,a=n,s=r,(l=we(i=t).dom.createRange()).setStart(i.dom,o),l.setEnd(a.dom,s),l),c=ge(t,n)&&e===r;return u.collapsed&&!c}(e,t.anchorOffset,n,t.focusOffset)?P.some(Lh(e,t.anchorOffset,n,t.focusOffset)):Gh(t)},qh=function(t){return Wh(t).filter(function(t){return 0<t.rangeCount}).bind(Uh)},Xh=function(t,e){var n,r,i,o,a=Rh(n=t,e).match({ltr:function(t,e,r,i){var o=n.document.createRange();return o.setStart(t.dom,e),o.setEnd(r.dom,i),o},rtl:function(t,e,r,i){var o=n.document.createRange();return o.setStart(r.dom,i),o.setEnd(t.dom,e),o}});return 0<(o=0<(i=(r=a).getClientRects()).length?i[0]:r.getBoundingClientRect()).width||0<o.height?P.some(o).map(Oh):P.none()},Yh=function(t){return P.from(t.dom.contentWindow)},$h=function(t){return Yh(t).bind(qh)},Zh=function(t){return t.getFrame()},Kh=function(t,e,n,r){return t[n].getOrThunk(function(){return function(t){return Ch(e,r,t)}})},Jh=function(t){var e=Zh(t);return P.some(ce(e.dom.contentWindow.document.body)).bind(function(n){return P.some(ce(e.dom.contentWindow.document)).bind(function(r){return Yh(e).map(function(i){var o=ce(r.dom.documentElement),a=t.getCursorBox.getOrThunk(function(){return function(){return qh(i).map(function(t){return Fh.exact(t.start,t.soffset,t.finish,t.foffset)}).bind(function(t){return Xh(i,t).orThunk(function(){return qh(i).filter(function(t){return ge(t.start,t.finish)&&t.soffset===t.foffset}).bind(function(t){var e=t.start.dom.getBoundingClientRect();return 0<e.width||0<e.height?P.some(e):P.none()})})})}}),s=t.setSelection.getOrThunk(function(){return function(t,e,n,r){!function(t,e,n,r,i){var o,a,s,l;!function(t,e){Rh(t,e).match({ltr:function(e,n,r,i){jh(t,e,n,r,i)},rtl:function(e,n,r,i){Wh(t).each(function(o){if(o.setBaseAndExtent)o.setBaseAndExtent(e.dom,n,r.dom,i);else if(o.extend)try{l=r,u=i,(s=o).collapse(e.dom,n),s.extend(l.dom,u)}catch(a){jh(t,r,i,e,n)}else jh(t,r,i,e,n);var s,l,u})}})}(t,(o=r,a=i,s=Hh(e,n),l=Hh(o,a),Fh.relative(s,l)))}(i,t,e,n,r)}}),l=t.clearSelection.getOrThunk(function(){return function(){Wh(i).each(function(t){return t.removeAllRanges()})}});return{body:n,doc:r,win:i,html:o,getSelection:m($h,e),setSelection:s,clearSelection:l,frame:e,onKeyup:Kh(t,r,"onKeyup","keyup"),onNodeChanged:Kh(t,r,"onNodeChanged","SelectionChange"),onDomChanged:t.onDomChanged,onScrollToCursor:t.onScrollToCursor,onScrollToElement:t.onScrollToElement,onToReading:t.onToReading,onToEditing:t.onToEditing,onToolbarScrollStart:t.onToolbarScrollStart,onTouchContent:t.onTouchContent,onTapContent:t.onTapContent,onTouchToolstrip:t.onTouchToolstrip,getCursorBox:a}})})})},Qh=(xd=Yh,function(t){return t.getWin.getOrThunk(function(){var e=Zh(t);return function(){return xd(e)}})()}),tp=function(){var t=yo("head").getOrDie(),e=yo('meta[name="viewport"]').getOrThunk(function(){var e=ue("meta");return rn(e,"name","viewport"),De(t,e),e}),n=an(e,"content");return{maximize:function(){rn(e,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){rn(e,"content",null!=n&&0<n.length?n:"user-scalable=yes")}}},ep="data-ephox-mobile-fullscreen-style",np="position:absolute!important;",rp="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",ip=Mt().os.isAndroid(),op=function(t,e){var n,r=function(t){return function(e){var n=an(e,"style"),r=void 0===n?"no-styles":n.trim();r!==t&&(rn(e,ep,r),rn(e,"style",t))}},i=function(t,e,n){return F(function(t,e){for(var n=c(e)?e:T,r=t.dom,i=[];null!=r.parentNode;){var o=r.parentNode,a=ce(o);if(i.push(a),!0===n(a))break;r=o}return i}(t,void 0),function(t){return de(t,"*")})}(t),o=q(i,function(t){return function(t,e){return F(Ce(n=t).map(Me).map(function(t){return F(t,function(t){return!ge(n,t)})}).getOr([]),function(t){return de(t,"*")});var n}(t)}),a=void 0!==(n=io(e,"background-color"))&&""!==n?"background-color:"+n+"!important":"background-color:rgb(255,255,255)!important;";V(o,r("display:none!important;")),V(i,r(np+rp+a)),r((!0===ip?"":np)+rp+a)(t)},ap=function(){var t=he("["+ep+"]");V(t,function(t){var e=an(t,ep);"no-styles"!==e?rn(t,"style",e):un(t,"style"),un(t,ep)})},sp=function(t){var e=t.raw;return void 0===e.touches||1!==e.touches.length?P.none():P.some(e.touches[0])},lp=function(t){var e,n,r=Jr(P.none()),i=Jr(!1),o=(e=function(e){t.triggerEvent(Zt(),e),i.set(!0)},n=null,{cancel:function(){null!==n&&(clearTimeout(n),n=null)},schedule:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];n=setTimeout(function(){e.apply(null,t),n=null},400)}}),a=Un([{key:kt(),value:function(t){return sp(t).each(function(e){o.cancel();var n={x:e.clientX,y:e.clientY,target:t.target};o.schedule(t),i.set(!1),r.set(P.some(n))}),P.none()}},{key:At(),value:function(t){return o.cancel(),sp(t).each(function(t){r.get().each(function(e){var n,i,o,a;n=t,i=e,o=Math.abs(n.clientX-i.x),a=Math.abs(n.clientY-i.y),(5<o||5<a)&&r.set(P.none())})}),P.none()}},{key:It(),value:function(e){return o.cancel(),r.get().filter(function(t){return ge(t.target,e.target)}).map(function(n){return i.get()?(e.prevent(),!1):t.triggerEvent($t(),e)})}}]);return{fireIfReady:function(t,e){return Qe(a,e).bind(function(e){return e(t)})}}},up=function(t){var e=lp({triggerEvent:function(e,n){t.onTapContent(n)}});return{fireTouchstart:function(t){e.fireIfReady(t,"touchstart")},onTouchend:function(){return Ch(t.body,"touchend",function(t){e.fireIfReady(t,"touchend")})},onTouchmove:function(){return Ch(t.body,"touchmove",function(t){e.fireIfReady(t,"touchmove")})}}},cp=6<=Mt().os.version.major,dp=function(t,e){var n=parseInt(an(t,e),10);return isNaN(n)?0:n},fp=function(e){return t(t({},e),{width:2})},hp=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},pp=function(t){var e=t.getSelection();return void 0!==e&&0<e.rangeCount?function(t){if(t.collapsed){var e=ce(t.startContainer);return Ce(e).bind(function(n){var r=Fh.exact(e,t.startOffset,n,function(t){return"img"===me(t)?1:Nh.getOption(t).fold(function(){return Me(t).length},function(t){return t.length})}(n));return Xh(t.startContainer.ownerDocument.defaultView,r).map(fp).map(Z)}).getOr([])}return z(t.getClientRects(),hp)}(e.getRangeAt(0)):[]},gp="data-"+Xi("last-outer-height"),mp=function(t,e){rn(t,gp,e)},vp=function(t){return{top:t.top,bottom:t.top+t.height}},yp=function(t,e){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];null!==n&&clearTimeout(n),n=setTimeout(function(){t.apply(null,r),n=null},e)}}},xp=function(t,e){var n,r,i=cd(Dd.sketch({dom:Zl('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:qr([Wi.config({toggleClass:Xi("mask-tap-icon-selected"),toggleOnExecute:!1})])})),o=(n=t,r=null,{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];null===r&&(r=setTimeout(function(){n.apply(null,t),r=null},200))}});return Dd.sketch({dom:Zl('<div class="${prefix}-disabled-mask"></div>'),components:[Dd.sketch({dom:Zl('<div class="${prefix}-content-container"></div>'),components:[Yl.sketch({dom:Zl('<div class="${prefix}-content-tap-section"></div>'),components:[i.asSpec()],action:function(t){o.throttle()},buttonBehaviours:qr([Wi.config({toggleClass:Xi("mask-tap-icon-selected")})])})]})]})},bp=p({unbind:f}),_p=Qn([gr("editor",[hr("getFrame"),mr("getBody"),mr("getDoc"),mr("getWin"),mr("getSelection"),mr("setSelection"),mr("clearSelection"),mr("cursorSaver"),mr("onKeyup"),mr("onNodeChanged"),mr("getCursorBox"),hr("onDomChanged"),br("onTouchContent",f),br("onTapContent",f),br("onTouchToolstrip",f),br("onScrollToCursor",bp),br("onScrollToElement",bp),br("onToEditing",bp),br("onToReading",bp),br("onToolbarScrollStart",g)]),hr("socket"),hr("toolstrip"),hr("dropup"),hr("toolbar"),hr("container"),hr("alloy"),wr("win",function(t){return we(t.socket).dom.defaultView}),wr("body",function(t){return ce(t.socket.dom.ownerDocument.body)}),br("translate",g),br("setReadOnly",f),br("readOnlyOnInit",k)]),wp=p([hr("dom"),br("shell",!0),Xs("toolbarBehaviours",[Xf])]),Sp=p([wl({name:"groups",overrides:function(){return{behaviours:qr([Xf.config({})])}}})]),Cp=Xl({name:"Toolbar",configFields:wp(),partFields:Sp(),factory:function(t,e,n,r){var i=function(e){return t.shell?P.some(e):Al(e,t,"groups")},o=t.shell?{behaviours:[Xf.config({})],components:[]}:{behaviours:[],components:e};return{uid:t.uid,dom:t.dom,components:o.components,behaviours:$s(t.toolbarBehaviours,o.behaviours),apis:{setGroups:function(t,e){i(t).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){Xf.set(t,e)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,e,n){t.setGroups(e,n)}}}),Mp=p([hr("items"),gr("markers",z(["itemSelector"],hr)),Xs("tgroupBehaviours",[qs])]),Tp=p([Sl({name:"items",unit:"item"})]),kp=Xl({name:"ToolbarGroup",configFields:Mp(),partFields:Tp(),factory:function(t,e,n,r){return{uid:t.uid,dom:t.dom,components:e,behaviours:$s(t.tgroupBehaviours,[qs.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),Ap="data-"+Xi("horizontal-scroll"),Ip=function(t){return"true"===an(t,Ap)?0<(n=t).dom.scrollLeft||function(t){t.dom.scrollLeft=1;var e=0!==t.dom.scrollLeft;return t.dom.scrollLeft=0,e}(n):0<(e=t).dom.scrollTop||function(t){t.dom.scrollTop=1;var e=0!==t.dom.scrollTop;return t.dom.scrollTop=0,e}(e);var e,n},Dp=function(){var t=function(t){return{dom:Zl('<div aria-label="'+t.label+'" class="${prefix}-toolbar-group '+(!0===t.scrollable?"${prefix}-toolbar-scrollable-group":"")+'"></div>'),tgroupBehaviours:qr([Td("adhoc-scrollable-toolbar",!0===t.scrollable?[Nr(function(t,e){no(t.element,"overflow-x","auto"),rn(t.element,Ap,"true"),uh(t.element)})]:[])]),components:[Dd.sketch({components:[kp.parts.items({})]})],markers:{itemSelector:"."+Xi("toolbar-group-item")},items:t.items}},e=Tf(Cp.sketch({dom:Zl('<div class="${prefix}-toolbar"></div>'),components:[Cp.parts.groups({})],toolbarBehaviours:qr([Wi.config({toggleClass:Xi("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),qs.config({mode:"cyclic"})]),shell:!0})),n=Tf(Dd.sketch({dom:{classes:[Xi("toolstrip")]},components:[kf(e)],containerBehaviours:qr([Wi.config({toggleClass:Xi("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=function(){Cp.setGroups(e,i.get()),Wi.off(e)},i=Jr([]);return{wrapper:n,toolbar:e,createGroups:function(e){return z(e,h(kp.sketch,t))},setGroups:function(t){i.set(t),r()},setContextToolbar:function(t){Wi.on(e),Cp.setGroups(e,t)},restoreToolbar:function(){Wi.isOn(e)&&r()},refresh:function(){},focus:function(){qs.focusIn(e)}}},Op=function(t){return Tf(Yl.sketch({dom:Zl('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){t.run(function(t){t.setReadOnly(!1)})}}))},Pp=function(){return Tf(Dd.sketch({dom:Zl('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:qr([Xf.config({})])}))},Ep=function(t,e){Xf.append(t,kf(e))},Rp=function(t,e){Xf.remove(t,e)},Lp=function(t,e,n,r){(!0===n?Kr.toAlpha:Kr.toOmega)(r),(n?Ep:Rp)(t,e)},Np=function(t,e){return e.getAnimationRoot.fold(function(){return t.element},function(e){return e(t)})},Bp=function(t){return t.dimension.property},zp=function(t,e){return t.dimension.getDimension(e)},Vp=function(t,e){var n=Np(t,e);_f(n,[e.shrinkingClass,e.growingClass])},Fp=function(t,e){hn(t.element,e.openClass),fn(t.element,e.closedClass),no(t.element,Bp(e),"0px"),lo(t.element)},Hp=function(t,e){hn(t.element,e.closedClass),fn(t.element,e.openClass),so(t.element,Bp(e))},Wp=function(t,e,n,r){n.setCollapsed(),no(t.element,Bp(e),zp(e,t.element)),lo(t.element),Vp(t,e),Fp(t,e),e.onStartShrink(t),e.onShrunk(t)},jp=function(t,e,n,r){var i=r.getOrThunk(function(){return zp(e,t.element)});n.setCollapsed(),no(t.element,Bp(e),i),lo(t.element);var o=Np(t,e);hn(o,e.growingClass),fn(o,e.shrinkingClass),Fp(t,e),e.onStartShrink(t)},Gp=function(t,e,n){var r=zp(e,t.element);("0px"===r?Wp:jp)(t,e,n,P.some(r))},Up=function(t,e,n){var r=Np(t,e),i=pn(r,e.shrinkingClass),o=zp(e,t.element);Hp(t,e);var a=zp(e,t.element);(i?function(){no(t.element,Bp(e),o),lo(t.element)}:function(){Fp(t,e)})(),hn(r,e.shrinkingClass),fn(r,e.growingClass),Hp(t,e),no(t.element,Bp(e),a),n.setExpanded(),e.onStartGrow(t)},qp=function(t,e,n){var r=Np(t,e);return!0===pn(r,e.growingClass)},Xp=function(t,e,n){var r=Np(t,e);return!0===pn(r,e.shrinkingClass)},Yp=Object.freeze({__proto__:null,refresh:function(t,e,n){var r;n.isExpanded()&&(so(t.element,Bp(e)),r=zp(e,t.element),no(t.element,Bp(e),r))},grow:function(t,e,n){n.isExpanded()||Up(t,e,n)},shrink:function(t,e,n){n.isExpanded()&&Gp(t,e,n)},immediateShrink:function(t,e,n){n.isExpanded()&&Wp(t,e,n,P.none())},hasGrown:function(t,e,n){return n.isExpanded()},hasShrunk:function(t,e,n){return n.isCollapsed()},isGrowing:qp,isShrinking:Xp,isTransitioning:function(t,e,n){return qp(t,e)||Xp(t,e)},toggleGrow:function(t,e,n){(n.isExpanded()?Gp:Up)(t,e,n)},disableTransitions:Vp}),$p=Object.freeze({__proto__:null,exhibit:function(t,e,n){return Fr(e.expanded?{classes:[e.openClass],styles:{}}:{classes:[e.closedClass],styles:Gn(e.dimension.property,"0px")})},events:function(t,e){return kr([(n=Vt(),Or(n)(function(n,r){r.event.raw.propertyName===t.dimension.property&&(Vp(n,t),e.isExpanded()&&so(n.element,t.dimension.property),(e.isExpanded()?t.onGrown:t.onShrunk)(n))}))]);var n}}),Zp=[hr("closedClass"),hr("openClass"),hr("shrinkingClass"),hr("growingClass"),mr("getAnimationRoot"),wi("onShrunk"),wi("onStartShrink"),wi("onGrown"),wi("onStartGrow"),br("expanded",!1),pr("dimension",cr("property",{width:[Ti("property","width"),Ti("getDimension",function(t){return ku(t)+"px"})],height:[Ti("property","height"),Ti("getDimension",function(t){return fo(t)+"px"})]}))],Kp=Yr({fields:Zp,name:"sliding",active:$p,apis:Yp,state:Object.freeze({__proto__:null,init:function(t){var e=Jr(t.expanded);return Ur({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:m(e.set,!1),setExpanded:m(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),Jp=function(t,e){var n=Tf(Dd.sketch({dom:{tag:"div",classes:[Xi("dropup")]},components:[],containerBehaviours:qr([Xf.config({}),Kp.config({closedClass:Xi("dropup-closed"),openClass:Xi("dropup-open"),shrinkingClass:Xi("dropup-shrinking"),growingClass:Xi("dropup-growing"),dimension:{property:"height"},onShrunk:function(n){t(),e(),Xf.set(n,[])},onGrown:function(n){t(),e()}}),Gi(function(t,e){r(f)})])})),r=function(t){window.requestAnimationFrame(function(){t(),Kp.shrink(n)})};return{appear:function(t,e,r){!0===Kp.hasShrunk(n)&&!1===Kp.isTransitioning(n)&&window.requestAnimationFrame(function(){e(r),Xf.set(n,[t()]),Kp.grow(n)})},disappear:r,component:n,element:n.element}},Qp=function(){return Mt().browser.isFirefox()},tg=Jn([pr("triggerEvent",fr),br("stopBackspace",!0)]),eg=function(t,e){var n=Qe(t,"target").getOr(e);return Jr(n)},ng=Pn([{stopped:[]},{resume:["element"]},{complete:[]}]),rg=function(t,e,n,r,i,o){var a,s,l,u,c=t(e,r),d=(a=n,s=i,l=Jr(!1),u=Jr(!1),{stop:function(){l.set(!0)},cut:function(){u.set(!0)},isStopped:l.get,isCut:u.get,event:a,setSource:s.set,getSource:s.get});return c.fold(function(){return o.logEventNoHandlers(e,r),ng.complete()},function(t){var n=t.descHandler;return vf(n)(d),d.isStopped()?(o.logEventStopped(e,t.element,n.purpose),ng.stopped()):d.isCut()?(o.logEventCut(e,t.element,n.purpose),ng.complete()):Ce(t.element).fold(function(){return o.logNoParent(e,t.element,n.purpose),ng.complete()},function(r){return o.logEventResponse(e,t.element,n.purpose),ng.resume(r)})})},ig=function(t,e,n,r,i,o){return rg(t,e,n,r,i,o).fold(k,function(r){return ig(t,e,n,r,i,o)},T)},og=function(t,e,n,r,i){var o=eg(n,r);return ig(t,e,n,r,o,i)},ag=function(t){var e=function(e){return Ce(t.element).fold(k,function(t){return ge(e,t)})},n=function(){var t=function(){var t={};return{registerId:function(e,n,r){$e(r,function(r,i){var o,a=void 0!==t[i]?t[i]:{};a[n]={cHandler:m.apply(void 0,[(o=r).handler].concat(e)),purpose:o.purpose},t[i]=a})},unregisterId:function(e){$e(t,function(t,n){t.hasOwnProperty(e)&&delete t[e]})},filterByType:function(e){return Qe(t,e).map(function(t){return Je(t,function(t,e){return{id:e,descHandler:t}})}).getOr([])},find:function(e,n,r){var i=Qe(t,n);return function(t,e,n){var r=e(t),i=Cr(n);return r.orThunk(function(){return i(t)?P.none():function(t,e,n){for(var r=t.dom,i=Cr(n);r.parentNode;){var o=ce(r=r.parentNode),a=e(o);if(a.isSome())return a;if(i(o))break}return P.none()}(t,e,i)})}(r,function(t){return e=i,Vl(n=t).fold(function(){return P.none()},function(t){return e.bind(function(e){return Qe(e,t)}).map(function(t){return{element:n,descHandler:t}})});var e,n},e)}}}(),e={},n=function(n){Vl(n.element).each(function(n){delete e[n],t.unregisterId(n)})};return{find:function(e,n,r){return t.find(e,n,r)},filter:function(e){return t.filterByType(e)},register:function(r){var i=function(t){return Vl(t.element).fold(function(){return e=t.element,n=al(Nl+"uid-"),zl(e,n),n;var e,n},function(t){return t})}(r);en(e,i)&&function(t,r){var i=e[r];if(i!==t)throw new Error('The tagId "'+r+'" is already used by: '+di(i.element)+"\nCannot use it for: "+di(t.element)+"\nThe conflicting element is"+(Ve(i.element)?" ":" not ")+"already in the DOM");n(t)}(r,i),t.registerId([r],i,r.events),e[i]=r},unregister:n,getById:function(t){return Qe(e,t)}}}(),r=function(t,r){return n.find(e,t,r)},i=function(t,e){var n,r,i,o,a=lr("Getting GUI events settings",tg,e),s=lp(a),l=z(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(e){return Ch(t,e,function(t){s.fireIfReady(t,e).each(function(e){e&&t.kill()}),a.triggerEvent(e,t)&&t.kill()})}),u=Jr(P.none()),c=Ch(t,"paste",function(t){s.fireIfReady(t,"paste").each(function(e){e&&t.kill()}),a.triggerEvent("paste",t)&&t.kill(),u.set(P.some(setTimeout(function(){a.triggerEvent(Ut(),t)},0)))}),d=Ch(t,"keydown",function(t){a.triggerEvent("keydown",t)?t.kill():!0===a.stopBackspace&&function(t){return t.raw.which===wo[0]&&!N(["input","textarea"],me(t.target))&&!_o(t.target,'[contenteditable="true"]',void 0).isSome()}(t)&&t.prevent()}),f=(n=t,r=function(t){a.triggerEvent("focusin",t)&&t.kill()},Qp()?Mh(n,"focus",r):Ch(n,"focusin",r)),h=Jr(P.none()),p=(i=t,o=function(t){a.triggerEvent("focusout",t)&&t.kill(),h.set(P.some(setTimeout(function(){a.triggerEvent(Gt(),t)},0)))},Qp()?Mh(i,"blur",o):Ch(i,"focusout",o));return{unbind:function(){V(l,function(t){t.unbind()}),d.unbind(),f.unbind(),p.unbind(),c.unbind(),u.get().each(clearTimeout),h.get().each(clearTimeout)}}}(t.element,{triggerEvent:function(t,e){return gi(t,e.target,function(n){return og(r,t,i=e,i.target,n);var i})}}),o={debugInfo:p("real"),triggerEvent:function(t,e,n){gi(t,e,function(i){return og(r,t,n,e,i)})},triggerFocus:function(t,e){Vl(t).fold(function(){Qr(t)},function(n){gi(jt(),t,function(n){var i,o,a,s,l,u;return i=r,o=jt(),l=n,u=eg(a={originator:e,kill:f,prevent:f,target:t},s=t),rg(i,o,a,s,u,l),!1})})},triggerEscape:function(t,e){o.triggerEvent("keydown",t.element,e.event)},getByUid:function(t){return v(t)},getByDom:function(t){return y(t)},build:Tf,addToGui:function(t){l(t)},removeFromGui:function(t){u(t)},addToWorld:function(t){a(t)},removeFromWorld:function(t){s(t)},broadcast:function(t){d(t)},broadcastOn:function(t,e){h(t,e)},broadcastEvent:function(t,e){g(t,e)},isConnected:k},a=function(t){t.connect(o),xe(t.element)||(n.register(t),V(t.components(),a),o.triggerEvent(Kt(),t.element,{target:t.element}))},s=function(t){xe(t.element)||(V(t.components(),s),n.unregister(t)),t.disconnect()},l=function(e){Ue(t,e,De)},u=function(t){qe(t)},c=function(t){var e=n.filter(qt());V(e,function(e){vf(e.descHandler)(t)})},d=function(t){c({universal:!0,data:t})},h=function(t,e){c({universal:!1,channels:t,data:e})},g=function(t,e){return function(t,e,n){var r,i,o=(r=e,i=Jr(!1),{stop:function(){i.set(!0)},cut:f,isStopped:i.get,isCut:T,event:r,setSource:C("Cannot set source of a broadcasted event"),getSource:C("Cannot get source of a broadcasted event")});return V(t,function(t){vf(t.descHandler)(o)}),o.isStopped()}(n.filter(t),e)},v=function(t){return n.getById(t).fold(function(){return xn.error(new Error('Could not find component with uid: "'+t+'" in system.'))},xn.value)},y=function(t){var e=Vl(t).getOr("not found");return v(e)};return a(t),{root:t,element:t.element,destroy:function(){i.unbind(),Ee(t.element)},add:l,remove:u,getByUid:v,getByDom:y,addToWorld:a,removeFromWorld:s,broadcast:d,broadcastOn:h,broadcastEvent:g}},sg=Xi("readonly-mode"),lg=Xi("edit-mode");function ug(t){var e=Tf(Dd.sketch({dom:{classes:[Xi("outer-container")].concat(t.classes)},containerBehaviours:qr([Kr.config({alpha:sg,omega:lg})])}));return ag(e)}var cg,dg,fg=function(t,e){var n=ue("input");ro(n,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),De(t,n),Qr(n),e(n),Ee(n)},hg=function(t){var e,n,r=t.getSelection();0<r.rangeCount&&(e=r.getRangeAt(0),(n=t.document.createRange()).setStart(e.startContainer,e.startOffset),n.setEnd(e.endContainer,e.endOffset),r.removeAllRanges(),r.addRange(n))},pg=function(t,e){ei().each(function(t){ge(t,e)||ti(t)}),t.focus(),Qr(ce(t.document.body)),hg(t)},gg=function(t,e,n,r){var i=function(){pg(e,r)},o=Ch(n,"keydown",function(t){N(["input","textarea"],me(t.target))||i()});return{toReading:function(){fg(t,ti)},toEditing:i,onToolbarTouch:f,destroy:function(){o.unbind()}}},mg={},vg={exports:mg};cg=mg,dg=vg,function(t){"object"==typeof cg&&void 0!==dg?dg.exports=t():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}(function(){return function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){return i(e[a][1][t]||t)},u,u.exports,t,e,n,r)}return n[a].exports}for(var o=!1,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){var r,i,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(t){r=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var u,c=[],d=!1,f=-1;function h(){d&&u&&(d=!1,u.length?c=u.concat(c):f=-1,c.length&&p())}function p(){if(!d){var t=l(h);d=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,d=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new g(t,e)),1!==c.length||d||l(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],2:[function(t,e,n){(function(t){function n(){}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(t,this)}function i(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn(function(){var n,r=1===t._state?e.onFulfilled:e.onRejected;if(null!==r){try{n=r(t._value)}catch(c){return void a(e.promise,c)}o(e.promise,n)}else(1===t._state?o:a)(e.promise,t._value)})):t._deferreds.push(e)}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof r)return t._state=3,t._value=e,void s(t);if("function"==typeof n)return void u((i=n,l=e,function(){i.apply(l,arguments)}),t)}t._state=1,t._value=e,s(t)}catch(o){a(t,o)}var i,l}function a(t,e){t._state=2,t._value=e,s(t)}function s(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function l(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function u(t,e){var r=!1;try{t(function(t){r||(r=!0,o(e,t))},function(t){r||(r=!0,a(e,t))})}catch(n){if(r)return;r=!0,a(e,n)}}var c;c=setTimeout,r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var r=new this.constructor(n);return i(this,new l(t,e,r)),r},r.all=function(t){var e=Array.prototype.slice.call(t);return new r(function(t,r){if(0===e.length)return t([]);for(var i=e.length,o=0;o<e.length;o++)!function o(a,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var l=s.then;if("function"==typeof l)return void l.call(s,function(t){o(a,t)},r)}e[a]=s,0==--i&&t(e)}catch(n){r(n)}}(o,e[o])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},r._immediateFn="function"==typeof t?function(e){t(e)}:function(t){c(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},void 0!==e&&e.exports?e.exports=r:this.Promise||(this.Promise=r)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,e,n){(function(e,r){var i=t("process/browser.js").nextTick,o=Function.prototype.apply,a=Array.prototype.slice,s={},l=0;function u(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new u(o.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new u(o.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n.setImmediate="function"==typeof e?e:function(t){var e=l++,r=!(arguments.length<2)&&a.call(arguments,1);return s[e]=!0,i(function(){s[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))}),e},n.clearImmediate="function"==typeof r?r:function(t){delete s[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,e,n){var r=t("promise-polyfill"),i="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:i.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var yg,xg=vg.exports.boltExport,bg=function(t){var e=P.none(),n=[],r=function(t){i()?o(t):n.push(t)},i=function(){return e.isSome()},o=function(t){e.each(function(e){setTimeout(function(){t(e)},0)})};return t(function(t){i()||(e=P.some(t),function(t){V(t,o)}(n),n=[])}),{get:r,map:function(t){return bg(function(e){r(function(n){e(t(n))})})},isReady:i}},_g={nu:bg,pure:function(t){return bg(function(e){e(t)})}},wg=function(t){setTimeout(function(){throw t},0)},Sg=function(t){var e=function(e){t().then(e,wg)};return{map:function(e){return Sg(function(){return t().then(e)})},bind:function(e){return Sg(function(){return t().then(function(t){return e(t).toPromise()})})},anonBind:function(e){return Sg(function(){return t().then(function(){return e.toPromise()})})},toLazy:function(){return _g.nu(e)},toCached:function(){var e=null;return Sg(function(){return null===e&&(e=t()),e})},toPromise:t,get:e}},Cg=function(t){return Sg(function(){return new xg(t)})},Mg=function(t,e){var n=we(t).dom.defaultView;return fo(t)+fo(e)-function(t){var e,n=kh(t).isPortrait(),r=function(t,e){return K([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(n){return t<=n.width&&e<=n.height?P.some(n.keyboard):P.none()}).getOr({portrait:e/5,landscape:t/4})}((e=t).screen.width,e.screen.height),i=n?r.portrait:r.landscape;return(n?t.screen.height:t.screen.width)-t.innerHeight>i?0:i}(n)},Tg=function(t,e,n){var r=Mg(e,n),i=fo(e)+fo(n)-r;no(t,"padding-bottom",i+"px")},kg=Pn([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),Ag="data-"+Xi("position-y-fixed"),Ig="data-"+Xi("y-property"),Dg="data-"+Xi("scrolling"),Og="data-"+Xi("last-window-height"),Pg=function(t){return dp(t,Ag)},Eg=function(t,e){var n=an(t,Ig);return kg.fixed(t,n,e)},Rg=function(t,e){return kg.scroller(t,e)},Lg=function(t){var e=Pg(t);return("true"===an(t,Dg)?Rg:Eg)(t,e)},Ng=function(t,e,n){var r=we(t).dom.defaultView.innerHeight;return rn(t,Og,r+"px"),r-e-n},Bg=(yg=null,{animate:function(t,e,n,r,i,o){var a=!1,s=function(t){a=!0,i(t)};Th.clearInterval(yg);var l=function(t){Th.clearInterval(yg),s(t)};yg=Th.setInterval(function(){var i,o,u,c=t();i=c,o=e,u=n,(Math.abs(i-o)<=u?P.none():P.some(i<o?i+u:i-u)).fold(function(){Th.clearInterval(yg),s(e)},function(n){var i;r(n,l),a||((i=t())!==n||Math.abs(i-e)>Math.abs(c-e))&&(Th.clearInterval(yg),s(e))})},o)}}),zg="data-"+Xi("last-scroll-top"),Vg=function(t){var e=ao(t,"top").getOr("0");return parseInt(e,10)},Fg=function(t){return parseInt(t.dom.scrollTop,10)},Hg=function(t,e){return Cg(function(n){var r=m(Fg,t);rn(t,zg,r());var i=Math.abs(e-r()),o=Math.ceil(i/10);Bg.animate(r,e,o,function(e,n){dp(t,zg)!==t.dom.scrollTop?n(t.dom.scrollTop):(t.dom.scrollTop=e,rn(t,zg,e))},function(){t.dom.scrollTop=e,rn(t,zg,e),n(e)},10)})},Wg=function(t,e){var n=e+Pg(t)+"px";no(t,"top",n)},jg=function(t,e){var n,r=(n=ho(t,"["+Ag+"]"),z(n,Lg));return function(t,e){return e(function(e){var n=[],r=0;0===t.length?e([]):V(t,function(i,o){var a;i.get((a=o,function(i){n[a]=i,++r>=t.length&&e(n)}))})})}(z(r,function(t){return function(t,e){return t.fold(function(t,n,r){return no(t,n,e+(i=r)+"px"),function(t){return Sg(function(){return xg.resolve(t)})}(i);var i},function(t,n){return function(t,e,n){var r,i,o,a=e+n,s=ao(t,"top").getOr(n),l=a-parseInt(s,10);return r=t,i=t.dom.scrollTop+l,o=a,Cg(function(t){var e=m(Fg,r);Bg.animate(e,i,15,function(t){r.dom.scrollTop=t,no(r,"top",Vg(r)+15+"px")},function(){r.dom.scrollTop=i,no(r,"top",o+"px"),t(i)},10)})}(t,e,n)})}(t,e)}),Cg)},Gg=function(t,e){var n=tp(),r=lf(),i=lf(),o=sf(),a=sf();return{enter:function(){e.hide();var s=ce(document);Jh(t.editor).each(function(e){var l;r.set({socketHeight:ao(t.socket,"height"),iframeHeight:ao(e.frame,"height"),outerScroll:document.body.scrollTop}),i.set({exclusives:(l="."+dh,Ch(s,"touchmove",function(t){_o(t.target,l).filter(Ip).fold(function(){t.prevent()},f)}))}),fn(t.container,Xi("fullscreen-maximized")),op(t.container,e.body),n.maximize(),no(t.socket,"overflow","scroll"),no(t.socket,"-webkit-overflow-scrolling","touch"),Qr(e.body),o.set(function(t){var e=t.cWin,n=t.socket,r=t.toolstrip,i=t.contentElement,o=t.keyboardType,a=t.outerWindow,s=t.dropup,l=t.outerBody,u=function(t,e,n,r){var i=we(t).dom.defaultView,o=function(t){var e=an(t,"style");return ro(t,{position:"absolute",top:"0px"}),rn(t,Ag,"0px"),rn(t,Ig,"top"),{restore:function(){rn(t,"style",e||""),un(t,Ag),un(t,Ig)}}}(n),a=fo(n),s=fo(r),l=function(t,e,n){var r=an(n,"style");return uh(n),ro(n,{position:"absolute",height:e+"px",width:"100%",top:t+"px"}),rn(n,Ag,t+"px"),rn(n,Dg,"true"),rn(n,Ig,"top"),{restore:function(){ch(n),rn(n,"style",r||""),un(n,Ag),un(n,Dg),un(n,Ig)}}}(a,Ng(t,a,s),t),u=function(t){var e=an(t,"style");return ro(t,{position:"absolute",bottom:"0px"}),rn(t,Ag,"0px"),rn(t,Ig,"bottom"),{restore:function(){rn(t,"style",e||""),un(t,Ag),un(t,Ig)}}}(r),c=!0,d=function(){var e=i.innerHeight;return dp(t,Og)<e},f=function(){var i,o,a;c&&(i=fo(n),o=fo(r),a=Ng(t,i,o),rn(t,Ag,i+"px"),no(t,"height",a+"px"),Tg(e,t,r))};return Tg(e,t,r),{setViewportOffset:function(e){rn(t,Ag,e+"px"),f()},isExpanding:d,isShrinking:S(d),refresh:f,restore:function(){c=!1,o.restore(),l.restore(),u.restore()}}}(n,t.ceBody,r,s),c=o(l,e,Fe(),i),d=Ah(a,{onChange:f,onReady:u.refresh});d.onAdjustment(function(){u.refresh()});var h=Ch(ce(a),"resize",function(){u.isExpanding()&&u.refresh()}),p=function(t,e,n,r,i,o){var a,s,l=(a=function(n){return i=e,o=n,a=we(r=t).dom.defaultView,Cg(function(t){Wg(r,o),Wg(i,o),a.scrollTo(0,o),t(o)});var r,i,o,a},s=Jr(_g.pure({})),{start:function(t){var e=_g.nu(function(e){return a(t).get(e)});s.set(e)},idle:function(t){s.get().get(function(){t()})}}),u=yp(function(){l.idle(function(){jg(n,r.pageYOffset).get(function(){var t;(t=pp(o),P.from(t[0]).bind(function(t){var n=t.top-e.dom.scrollTop;return n>r.innerHeight+5||n<-5?P.some({top:n,bottom:n+t.height}):P.none()})).each(function(t){e.dom.scrollTop=e.dom.scrollTop+t.top}),l.start(0),i.refresh()})})},1e3),c=Ch(ce(r),"scroll",function(){r.pageYOffset<0||u.throttle()});return jg(n,r.pageYOffset).get(g),{unbind:c.unbind}}(r,n,l,a,u,e),v=function(t,e){var n=t.document,r=ue("div");fn(r,Xi("unfocused-selections")),De(ce(n.documentElement),r);var i=Ch(r,"touchstart",function(n){n.prevent(),pg(t,e),a()}),o=function(t){var e=ue("span");return bf(e,[Xi("layer-editor"),Xi("unfocused-selection")]),ro(e,{left:t.left+"px",top:t.top+"px",width:t.width+"px",height:t.height+"px"}),e},a=function(){Pe(r)};return{update:function(){a();var e=pp(t),n=z(e,o);Oe(r,n)},isActive:function(){return 0<Me(r).length},destroy:function(){i.unbind(),Ee(r)},clear:a}}(e,i),y=function(){v.clear()};return{toEditing:function(){c.toEditing(),y()},toReading:function(){c.toReading()},onToolbarTouch:function(t){c.onToolbarTouch()},refreshSelection:function(){v.isActive()&&v.update()},clearSelection:y,highlightSelection:function(){v.update()},scrollIntoView:function(t,r){var i,o,a,l,u,c;i=e,a=t,l=r,u=Mg(o=n,s),c=m(hg,i),u<a||u<l?Hg(o,o.dom.scrollTop-u+l).get(c):a<0&&Hg(o,o.dom.scrollTop+a).get(c)},updateToolbarPadding:f,setViewportOffset:function(t){var e,r;u.setViewportOffset(t),e=n,r=t,Cg(function(t){var n=m(Vg,e),i=function(t){no(e,"top",t+"px")},o=Math.abs(r-n()),a=Math.ceil(o/10);Bg.animate(n,r,a,i,function(){i(r),t(r)},10)}).get(g)},syncHeight:function(){no(i,"height",i.dom.contentWindow.document.body.scrollHeight+"px")},refreshStructure:u.refresh,destroy:function(){u.restore(),d.destroy(),p.unbind(),h.unbind(),c.destroy(),v.destroy(),fg(Fe(),ti)}}}({cWin:e.win,ceBody:e.body,socket:t.socket,toolstrip:t.toolstrip,dropup:t.dropup.element,contentElement:e.frame,outerBody:t.body,outerWindow:t.win,keyboardType:gg})),o.run(function(t){t.syncHeight()}),a.set(function(t,e,n,r,i){var o=function(){e.run(function(t){t.refreshSelection()})},a=function(t,n){var i=t-r.dom.scrollTop;e.run(function(t){t.scrollIntoView(i,i+n)})},s=function(){e.run(function(t){t.clearSelection()})},l=function(){t.getCursorBox().each(function(t){a(t.top,t.height)}),e.run(function(t){t.syncHeight()})},u=up(t),c=yp(l,300),d=[t.onKeyup(function(){s(),c.throttle()}),t.onNodeChanged(o),t.onDomChanged(c.throttle),t.onDomChanged(o),t.onScrollToCursor(function(t){t.preventDefault(),c.throttle()}),t.onScrollToElement(function(t){a(e,r)}),t.onToEditing(function(){e.run(function(t){t.toEditing()})}),t.onToReading(function(){e.run(function(t){t.toReading()})}),Ch(t.doc,"touchend",function(e){ge(t.html,e.target)||ge(t.body,e.target)}),Ch(n,"transitionend",function(t){var r;"height"===t.raw.propertyName&&(r=fo(n),e.run(function(t){t.setViewportOffset(r)}),o(),l())}),Mh(n,"touchstart",function(n){var r;e.run(function(t){t.highlightSelection()}),r=n,e.run(function(t){t.onToolbarTouch(r)}),t.onTouchToolstrip()}),Ch(t.body,"touchstart",function(e){s(),t.onTouchContent(),u.fireTouchstart(e)}),u.onTouchmove(),u.onTouchend(),Ch(t.body,"click",function(t){t.kill()}),Ch(n,"touchmove",function(){t.onToolbarScrollStart()})];return{destroy:function(){V(d,function(t){t.unbind()})}}}(e,o,t.toolstrip,t.socket))})},refreshStructure:function(){o.run(function(t){t.refreshStructure()})},exit:function(){n.restore(),a.clear(),o.clear(),e.show(),r.on(function(e){e.socketHeight.each(function(e){no(t.socket,"height",e)}),e.iframeHeight.each(function(e){no(t.editor.getFrame(),"height",e)}),document.body.scrollTop=e.scrollTop}),r.clear(),i.on(function(t){t.exclusives.unbind()}),i.clear(),hn(t.container,Xi("fullscreen-maximized")),ap(),ch(t.toolbar),so(t.socket,"overflow"),so(t.socket,"-webkit-overflow-scrolling"),ti(t.editor.getFrame()),Jh(t.editor).each(function(t){t.clearSelection()})}}},Ug=tinymce.util.Tools.resolve("tinymce.EditorManager"),qg=function(t,e,n){t.system.broadcastOn([si],{command:e,state:n})},Xg=function(t){return function(){var e=function(){t._skinLoaded=!0,t.fire("SkinLoaded")};t.initialized?e():t.on("init",e)}},Yg="toReading",$g="toEditing";ii.add("mobile",function(t){return{getNotificationManagerImpl:function(){return{open:p({progressBar:{value:f},close:f,text:f,getEl:p(null),moveTo:f,moveRel:f,settings:{}}),close:f,reposition:f,getArgs:p({})}},renderUI:function(){var e,n,r=t.getElement(),i={content:(e=P.from(t.getParam("skin_url")).fold(function(){return Ug.baseURL+"/skins/ui/oxide"},function(t){return t}))+"/content.mobile.min.css",ui:e+"/skin.mobile.min.css"};0==(!1===t.getParam("skin"))?(n=ri.DOM.styleSheetLoader,t.contentCSS.push(i.content),n.load(i.ui,Xg(t)),t.on("remove",function(){return n.unload(i.ui)})):Xg(t)();var o,a,s,l,u,c,d,h=function(){t.fire("ScrollIntoView")},p=Mt().os.isAndroid()?(o=h,a=ug({classes:[Xi("android-container")]}),s=Dp(),l=sf(),u=Op(l),c=Pp(),d=Jp(f,o),a.add(s.wrapper),a.add(c),a.add(d.component),{system:a,element:a.element,init:function(t){l.set(function(t){var e=lr("Getting AndroidWebapp schema",_p,t);no(e.toolstrip,"width","100%");var n=Tf(xp(function(){e.setReadOnly(e.readOnlyOnInit()),u.enter()}));e.alloy.add(n);var r={show:function(){e.alloy.add(n)},hide:function(){e.alloy.remove(n)}};De(e.container,n.element);var i,o,a,s,l,u=(i=e,o=r,a=tp(),s=sf(),l=sf(),{enter:function(){o.hide(),fn(i.container,Xi("fullscreen-maximized")),fn(i.container,Xi("android-maximized")),a.maximize(),fn(i.body,Xi("android-scroll-reload")),s.set(function(t,e){var n=ce(e.document.body),r=Ch(ce(t),"resize",function(){(function(t,e){var n=dp(e,gp),r=t.innerHeight;return r<n?P.some(n-r):P.none()})(t,n).each(function(t){var n;(0<(n=pp(e)).length?P.some(n[0]).map(vp):P.none()).each(function(n){var r,i,o=(i=n).top>(r=e).innerHeight||i.bottom>r.innerHeight?Math.min(t,i.bottom-r.innerHeight+50):0;0!==o&&e.scrollTo(e.pageXOffset,e.pageYOffset+o)})}),mp(n,t.innerHeight)});return mp(n,t.innerHeight),{toEditing:function(){!function(t){t.focus();var e=ce(t.document.body);(ei().exists(function(t){return N(["input","textarea"],me(t))})?function(t){Th.setTimeout(function(){t()},0)}:M)(function(){ei().each(ti),Qr(e)})}(e)},destroy:function(){r.unbind()}}}(i.win,Qh(i.editor).getOrDie("no"))),Jh(i.editor).each(function(t){op(i.container,t.body),l.set(function(t,e,n){var r=up(t),i=we(e),o=function(t){return!ge(t.start,t.finish)||t.soffset!==t.foffset},a=function(){var r=t.doc.dom.hasFocus()&&t.getSelection().exists(o);n.getByDom(e).each(!0===(r||ei(i).filter(function(t){return"input"===me(t)}).exists(function(t){return t.dom.selectionStart!==t.dom.selectionEnd}))?Wi.on:Wi.off)},s=[Ch(t.body,"touchstart",function(e){t.onTouchContent(),r.fireTouchstart(e)}),r.onTouchmove(),r.onTouchend(),Ch(e,"touchstart",function(e){t.onTouchToolstrip()}),t.onToReading(function(){ti(t.body)}),t.onToEditing(f),t.onScrollToCursor(function(e){e.preventDefault(),t.getCursorBox().each(function(e){var n=t.win,r=e.top>n.innerHeight||e.bottom>n.innerHeight?e.bottom-n.innerHeight+50:0;0!=r&&n.scrollTo(n.pageXOffset,n.pageYOffset+r)})})].concat(1==cp?[]:[Ch(ce(t.win),"blur",function(){n.getByDom(e).each(Wi.off)}),Ch(i,"select",a),Ch(t.doc,"selectionchange",a)]);return{destroy:function(){V(s,function(t){t.unbind()})}}}(t,i.toolstrip,i.alloy))})},exit:function(){a.restore(),o.show(),hn(i.container,Xi("fullscreen-maximized")),hn(i.container,Xi("android-maximized")),ap(),hn(i.body,Xi("android-scroll-reload")),l.clear(),s.clear()}});return{setReadOnly:e.setReadOnly,refreshStructure:f,enter:u.enter,exit:u.exit,destroy:f}}(t))},exit:function(){l.run(function(t){t.exit(),Xf.remove(c,u)})},setToolbarGroups:function(t){var e=s.createGroups(t);s.setGroups(e)},setContextToolbar:function(t){var e=s.createGroups(t);s.setContextToolbar(e)},focusToolbar:function(){s.focus()},restoreToolbar:function(){s.restoreToolbar()},updateMode:function(t){Lp(c,u,t,a.root)},socket:c,dropup:d}):function(t){var e=ug({classes:[Xi("ios-container")]}),n=Dp(),r=sf(),i=Op(r),o=Pp(),a=Jp(function(){r.run(function(t){t.refreshStructure()})},t);return e.add(n.wrapper),e.add(o),e.add(a.component),{system:e,element:e.element,init:function(t){r.set(function(t){var e=lr("Getting IosWebapp schema",_p,t);no(e.toolstrip,"width","100%"),no(e.container,"position","relative");var n=Tf(xp(function(){e.setReadOnly(e.readOnlyOnInit()),i.enter()}));e.alloy.add(n);var r={show:function(){e.alloy.add(n)},hide:function(){e.alloy.remove(n)}},i=Gg(e,r);return{setReadOnly:e.setReadOnly,refreshStructure:i.refreshStructure,enter:i.enter,exit:i.exit,destroy:f}}(t))},exit:function(){r.run(function(t){Xf.remove(o,i),t.exit()})},setToolbarGroups:function(t){var e=n.createGroups(t);n.setGroups(e)},setContextToolbar:function(t){var e=n.createGroups(t);n.setContextToolbar(e)},focusToolbar:function(){n.focus()},restoreToolbar:function(){n.restoreToolbar()},updateMode:function(t){Lp(o,i,t,e.root)},socket:o,dropup:a}}(h);!function(t,e,n){n(t,e.element);var r=Me(e.element);V(r,function(t){e.getByDom(t).each(je)})}(ce(r),p.system,Ae);var g=r.ownerDocument.defaultView,m=Ah(g,{onChange:function(){var t,e,n;p.system.broadcastOn([li],{width:(t=g,e=Mt().os.isiOS(),n=kh(t).isPortrait(),e&&!n?t.screen.height:t.screen.width)})},onReady:f}),v=function(e,n,r,i){!1===i&&t.selection.collapse();var o=y(e,n,r);p.setToolbarGroups(!0===i?o.readOnly:o.main),t.setMode(!0===i?"readonly":"design"),t.fire(!0===i?Yg:$g),p.updateMode(i)},y=function(t,e,n){var r=t.get();return{readOnly:r.backToMask.concat(e.get()),main:r.backToMask.concat(n.get())}},x=function(e,n){return t.on(e,n),{unbind:function(){t.off(e)}}};return t.on("init",function(){p.init({editor:{getFrame:function(){return ce(t.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:f}},onToReading:function(t){return x(Yg,t)},onToEditing:function(t){return x($g,t)},onScrollToCursor:function(e){return t.on("ScrollIntoView",function(t){e(t)}),{unbind:function(){t.off("ScrollIntoView"),m.destroy()}}},onTouchToolstrip:function(){s()},onTouchContent:function(){var e=ce(t.editorContainer.querySelector("."+Xi("toolbar")));ni(e).bind(function(t){return p.system.getByDom(t).toOptional()}).each(oe),p.restoreToolbar(),s()},onTapContent:function(e){var n=e.target;"img"===me(n)?(t.selection.select(n.dom),e.kill()):"a"===me(n)&&p.system.getByDom(ce(t.editorContainer)).each(function(t){Kr.isAlpha(t)&&function(t){var e=document.createElement("a");e.target="_blank",e.href=t.href,e.rel="noreferrer noopener";var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(e),e.dispatchEvent(n),document.body.removeChild(e)}(n.dom)})}},container:ce(t.editorContainer),socket:ce(t.contentAreaContainer),toolstrip:ce(t.editorContainer.querySelector("."+Xi("toolstrip"))),toolbar:ce(t.editorContainer.querySelector("."+Xi("toolbar"))),dropup:p.dropup,alloy:p.system,translate:f,setReadOnly:function(t){v(b,y,g,t)},readOnlyOnInit:function(){return!1}});var e,n,r,i,o,a,s=function(){p.dropup.disappear(function(){p.system.broadcastOn([ui],{})})},l={label:"The first group",scrollable:!1,items:[eu("back",function(){t.selection.collapse(),p.exit()},{},t)]},u={label:"Back to read only",scrollable:!1,items:[eu("readonly-back",function(){v(b,y,g,!0)},{},t)]},c=xh(p,t),d=(e=c,n=yh(t),r={},q(n,function(t){var n=!en(r,t)&&en(e,t)&&e[t].isSupported()?[e[t].sketch()]:[];return r[t]=!0,n})),h={label:"The extra group",scrollable:!1,items:[]},g=Jr([{label:"the action group",scrollable:!0,items:d},h]),y=Jr([{label:"The read only mode group",scrollable:!0,items:[]},h]),b=Jr({backToMask:[l],backToReadOnly:[u]});i=p,a=Xe((o=t).formatter.get()),V(a,function(t){o.formatter.formatChanged(t,function(e){qg(i,t,e)})}),V(["ul","ol"],function(t){o.selection.selectorChanged(t,function(e,n){qg(i,t,e)})})}),t.on("remove",function(){p.exit()}),t.on("detach",function(){var t,e;e=Me((t=p.system).element),V(e,function(e){t.getByDom(e).each(We)}),Ee(t.element),p.system.destroy()}),{iframeContainer:p.socket.element.dom,editorContainer:p.element.dom}}}})}(),function(){"use strict";var t,e,n,r,i=tinymce.util.Tools.resolve("tinymce.PluginManager"),o=tinymce.util.Tools.resolve("tinymce.util.VK"),a=function(t){return function(e){return r=typeof(n=e),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===t;var n,r}},s=function(t){return function(e){return typeof e===t}},l=a("string"),u=a("array"),c=function(e){return t===e},d=s("boolean"),f=s("function"),h=function(t){var e=t.getParam("link_assume_external_targets",!1);return d(e)&&e?1:!l(e)||"http"!==e&&"https"!==e?0:e},p=function(t){return t.getParam("default_link_target")},g=function(t){return t.getParam("target_list",!0)},m=function(t){return t.getParam("rel_list",[],"array")},v=function(t){return t.getParam("allow_unsafe_link_target",!1,"boolean")},y=function(){},x=function(t){return function(){return t}},b=x(!1),_=x(!(t=null)),w=function(){return S},S=(e=function(t){return t.isNone()},{fold:function(t,e){return t()},is:b,isSome:b,isNone:_,getOr:r=function(t){return t},getOrThunk:n=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:x(null),getOrUndefined:x(void 0),or:r,orThunk:n,map:w,each:y,bind:w,exists:b,forall:_,filter:w,equals:e,equals_:e,toArray:function(){return[]},toString:x("none()")}),C=function(t){var e=x(t),n=function(){return i},r=function(e){return e(t)},i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:_,isNone:b,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return C(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?i:S},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(b,function(e){return n(t,e)})}};return i},M={some:C,none:w,from:function(t){return null==t?S:C(t)}},T=Array.prototype.indexOf,k=Array.prototype.push,A=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!u(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);k.apply(e,t[n])}return e},I=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return M.none()},D=function(t,e){return t?M.some(e):M.none()},O=tinymce.util.Tools.resolve("tinymce.util.Tools"),P=function(t){return l(t.value)?t.value:""},E=function(t,e){var n=[];return O.each(t,function(t){var r,i,o,a=l((r=t).text)?r.text:l(r.title)?r.title:"";void 0!==t.menu?(i=E(t.menu,e),n.push({text:a,items:i})):(o=e(t),n.push({text:a,value:o}))}),n},R=function(t){return void 0===t&&(t=P),function(e){return M.from(e).map(function(e){return E(e,t)})}},L=function(t){return R(P)(t)},N=R,B=function(t,e){return function(n){return{name:t,type:"listbox",label:e,items:n}}},z=P,V=function(){return(V=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},F=Object.keys,H=Object.hasOwnProperty,W=function(t,e){return H.call(t,e)},j=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),G=function(t){return t&&"a"===t.nodeName.toLowerCase()},U=function(t){return G(t)&&!!Y(t)},q=function(t,e){if(t.collapsed)return[];for(var n=t.cloneContents(),r=new j(n.firstChild,n),i=[],o=n.firstChild;e(o)&&i.push(o),o=r.next(););return i},X=function(t){return/^\w+:/i.test(t)},Y=function(t){return t.getAttribute("data-mce-href")||t.getAttribute("href")},$=function(t,e){var n,r=["noopener"],i=t?t.split(/\s+/):[],o=function(t){return t.filter(function(t){return-1===O.inArray(r,t)})},a=e?0<(n=o(n=i)).length?n.concat(r):r:o(i);return 0<a.length?O.trim(a.sort().join(" ")):""},Z=function(t,e){return e=e||t.selection.getNode(),tt(e)?t.dom.select("a[href]",e)[0]:t.dom.getParent(e,"a[href]")},K=function(t,e){return(e?e.innerText||e.textContent:t.getContent({format:"text"})).replace(/\uFEFF/g,"")},J=function(t){return 0<O.grep(t,U).length},Q=function(t){var e=t.schema.getTextInlineElements();return 0===q(t.selection.getRng(),function(t){return 1===t.nodeType&&!G(t)&&!W(e,t.nodeName.toLowerCase())}).length},tt=function(t){return t&&"FIGURE"===t.nodeName&&/\bimage\b/i.test(t.className)},et=function(t,e){var n,r,i,o=V({},e);return 0<m(t).length||!1!==v(t)||(n=$(o.rel,"_blank"===o.target),o.rel=n||null),M.from(o.target).isNone()&&!1===g(t)&&(o.target=p(t)),o.href=(r=o.href,"http"!==(i=h(t))&&"https"!==i||X(r)?r:i+"://"+r),o},nt=function(t,e,n){var r,i,o,a,s,l,u;t.hasPlugin("rtc",!0)?t.execCommand("createlink",!1,(i=(r=n).class,o=r.href,a=r.rel,s=r.target,l=r.text,u=r.title,function(t,e){var n,r={};return function(t,e,n,r){!function(t,e){for(var n=F(t),r=0,i=n.length;r<i;r++){var o=n[r];e(t[o],o)}}(t,function(t,i){(e(t,i)?n:r)(t,i)})}(t,function(t,e){return!1===c(t)},(n=r,function(t,e){n[e]=t}),y),r}({class:i.getOrNull(),href:o,rel:a.getOrNull(),target:s.getOrNull(),text:l.getOrNull(),title:u.getOrNull()}))):function(t,e,n){var r=t.selection.getNode(),i=Z(t,r),o=et(t,function(t){return e=function(e,n){return t[n].each(function(t){e[n]=0<t.length?t:null}),e},n={href:t.href},function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n])}(["title","rel","class","target"],function(t){n=e(n,t)}),n;var e,n}(n));t.undoManager.transact(function(){var a,s,l,u,c,d,f;n.href===e.href&&e.attach(),i?(t.focus(),c=t,d=i,f=o,n.text.each(function(t){d.hasOwnProperty("innerText")?d.innerText=t:d.textContent=t}),c.dom.setAttribs(d,f),c.selection.select(d)):(a=t,l=n.text,u=o,tt(s=r)?ot(a,s,u):l.fold(function(){a.execCommand("mceInsertLink",!1,u)},function(t){a.insertContent(a.dom.createHTML("a",u,a.dom.encode(t)))}))})}(t,e,n)},rt=function(t){t.hasPlugin("rtc",!0)?t.execCommand("unlink"):function(t){t.undoManager.transact(function(){var e,n,r,i,o,a,s,l=t.selection.getNode();tt(l)?it(t,l):(n=(e=t).dom,i=(r=e.selection).getBookmark(),o=r.getRng().cloneRange(),a=n.getParent(o.startContainer,"a[href]",e.getBody()),s=n.getParent(o.endContainer,"a[href]",e.getBody()),a&&o.setStartBefore(a),s&&o.setEndAfter(s),r.setRng(o),e.execCommand("unlink"),r.moveToBookmark(i)),t.focus()})}(t)},it=function(t,e){var n,r=t.dom.select("img",e)[0];!r||(n=t.dom.getParents(r,"a[href]",e)[0])&&(n.parentNode.insertBefore(r,n),t.dom.remove(n))},ot=function(t,e,n){var r,i=t.dom.select("img",e)[0];i&&(r=t.dom.create("a",n),i.parentNode.insertBefore(r,i),r.appendChild(i))},at=function(t,e){return I(e,function(e){return function(t){return W(e=t,"items")&&null!=e.items;var e}(e)?at(t,e.items):D(e.value===t,e)})},st=tinymce.util.Tools.resolve("tinymce.util.Delay"),lt=tinymce.util.Tools.resolve("tinymce.util.Promise"),ut=function(t){var e=t.href;return 0<e.indexOf("@")&&-1===e.indexOf("/")&&-1===e.indexOf("mailto:")?M.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(t){return V(V({},t),{href:"mailto:"+e})}}):M.none()},ct=function(t,e){return I([ut,(n=h(t),r=t.getParam("link_default_protocol","http","string"),function(t){var e=t.href;return 1===n&&!X(e)||0===n&&/^\s*www(\.|\d\.)/i.test(e)?M.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+r+":// prefix?",preprocess:function(t){return V(V({},t),{href:r+"://"+e})}}):M.none()})],function(t){return t(e)}).fold(function(){return lt.resolve(e)},function(n){return new lt(function(r){var i,o,a,s;o=n.message,a=function(t){r(t?n.preprocess(e):e)},s=(i=t).selection.getRng(),st.setEditorTimeout(i,function(){i.windowManager.confirm(o,function(t){i.selection.setRng(s),a(t)})})})});var n,r},dt=function(t){var e=function(t,e){return A(function(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;i++)r[i]=e(t[i]);return r}(t,function(t){var e=t.name||t.id;return e?[{text:e,value:"#"+e}]:[]}))}(t.dom.select("a:not([href])"));return 0<e.length?M.some([{text:"None",value:""}].concat(e)):M.none()},ft=function(t){var e=t.getParam("link_class_list",[],"array");return 0<e.length?L(e):M.none()},ht=tinymce.util.Tools.resolve("tinymce.util.XHR"),pt=function(t,e){var n=m(t);if(0<n.length){var r=e.is("_blank");return(!1===v(t)?N(function(t){return $(z(t),r)}):L)(n)}return M.none()},gt=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],mt=function(t){var e=g(t);return u(e)?L(e).orThunk(function(){return M.some(gt)}):!1===e?M.none():M.some(gt)},vt=function(t,e,n){var r=t.getAttrib(e,n);return null!==r&&0<r.length?M.some(r):M.none()},yt=function(t,e){return t.dom.getParent(e,"a[href]")},xt=function(t){return yt(t,t.selection.getStart())},bt=function(t,e){var n,r;e&&(n=Y(e),/^#/.test(n)?(r=t.$(n)).length&&t.selection.scrollIntoView(r[0],!0):function(t){var e=document.createElement("a");e.target="_blank",e.href=t,e.rel="noreferrer noopener";var n,r,i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n=e,r=i,document.body.appendChild(n),n.dispatchEvent(r),document.body.removeChild(n)}(e.href))},_t=function(t){return function(){!function(t){var e,n;(n=Z(e=t),function(t,e){return function(t){var e=function(e){return t.convertURL(e.value||e.url,"href")},n=t.getParam("link_list");return new lt(function(t){l(n)?ht.send({url:n,success:function(e){return t(function(e){try{return M.some(JSON.parse(e))}catch(t){return M.none()}}(e))},error:function(e){return t(M.none())}}):f(n)?n(function(e){return t(M.some(e))}):t(M.from(n))}).then(function(t){return t.bind(N(e)).map(function(t){return 0<t.length?[{text:"None",value:""}].concat(t):t})})}(t).then(function(n){var r,i,o,a,s,l,u,c,d=(i=e,o=(r=t).dom,a=Q(r)?M.some(K(r.selection,i)):M.none(),s=i?M.some(o.getAttrib(i,"href")):M.none(),l=i?M.from(o.getAttrib(i,"target")):M.none(),u=vt(o,i,"rel"),c=vt(o,i,"class"),{url:s,text:a,title:vt(o,i,"title"),target:l,rel:u,linkClass:c});return{anchor:d,catalogs:{targets:mt(t),rels:pt(t,d.target),classes:ft(t),anchor:dt(t),link:n},optNode:M.from(e),flags:{titleEnabled:t.getParam("link_title",!0,"boolean")}}})}(e,n)).then(function(e){var n,r,i,o,a,s,l,u,c,d,f,h,g;return o=function(t){var e=t.getData();if(!e.url.value)return rt(n),void t.close();var i=function(t){return M.from(e[t]).filter(function(e){return!r.anchor[t].is(e)})},o={href:e.url.value,text:i("text"),target:i("target"),rel:i("rel"),class:i("linkClass"),title:i("title")},a={href:e.url.value,attach:void 0!==e.url.meta&&e.url.meta.attach?e.url.meta.attach:y};ct(n,o).then(function(t){nt(n,a,t)}),t.close()},a=n=t,c=(i=r=e).anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),d=i.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],s=M.from(p(a)),f={url:{value:u=(l=i.anchor).url.getOr(""),meta:{original:{value:u}}},text:l.text.getOr(""),title:l.title.getOr(""),anchor:u,link:u,rel:l.rel.getOr(""),target:l.target.or(s).getOr(""),linkClass:l.linkClass.getOr("")},g=function(t,e){var n={text:t.text,title:t.title};return{onChange:function(t,r){var i=r.name;return"url"===i?function(t){var e,r=D(n.text.length<=0,M.from((e=t.url).meta.text).getOr(e.value)),i=D(n.title.length<=0,M.from(t.url.meta.title).getOr(""));return r.isSome()||i.isSome()?M.some(V(V({},r.map(function(t){return{text:t}}).getOr({})),i.map(function(t){return{title:t}}).getOr({}))):M.none()}(t()):function(t,e){return-1<T.call(["anchor","link"],e)}(0,i)?function(t,r){var i,o,a=(i=e,("link"===(o=r.name)?i.link:"anchor"===o?i.anchor:M.none()).getOr([]));return function(t,e,n,r){var i=r[e],o=0<t.length;return void 0!==i?at(i,n).map(function(e){return{url:{value:e.value,meta:{text:o?t:e.text,attach:y}},text:o?t:e.text}}):M.none()}(n.text,r.name,a,t)}(t(),r):(("text"===i||"title"===i)&&(n[i]=t()[i]),M.none())}}}(f,h=i.catalogs),{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:A([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],c,d,function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e}([h.anchor.map(B("anchor","Anchors")),h.rels.map(B("rel","Rel")),h.targets.map(B("target","Open link in...")),h.link.map(B("link","Link list")),h.classes.map(B("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:f,onChange:function(t,e){g.onChange(t.getData,{name:e.name}).each(function(e){t.setData(e)})},onSubmit:o}}).then(function(e){t.windowManager.open(e)})}(t)}},wt=function(t){return function(){bt(t,xt(t))}},St=function(t){t.on("click",function(e){var n=yt(t,e.target);n&&o.metaKeyPressed(e)&&(e.preventDefault(),bt(t,n))}),t.on("keydown",function(e){var n,r=xt(t);r&&13===e.keyCode&&!0===(n=e).altKey&&!1===n.shiftKey&&!1===n.ctrlKey&&!1===n.metaKey&&(e.preventDefault(),bt(t,r))})},Ct=function(t,e){return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}},Mt=function(t){return function(e){return Ct(t,function(){e.setActive(!t.mode.isReadOnly()&&null!==Z(t,t.selection.getNode()))})}},Tt=function(t){return function(e){var n=function(){return e.setDisabled(null===Z(t,t.selection.getNode()))};return n(),Ct(t,n)}},kt=function(t){return function(e){var n=function(e){return J(e)||(n=t.selection.getRng(),0<q(n,U).length);var n},r=t.dom.getParents(t.selection.getStart());return e.setDisabled(!n(r)),Ct(t,function(t){return e.setDisabled(!n(t.parents))})}};i.add("link",function(t){var e,n,r,i,o,a,s;(e=t).ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:_t(e),onSetup:Mt(e)}),e.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:wt(e),onSetup:Tt(e)}),e.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return rt(e)},onSetup:kt(e)}),(n=t).ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:wt(n),onSetup:Tt(n)}),n.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:_t(n)}),n.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return rt(n)},onSetup:kt(n)}),(r=t).ui.registry.addContextMenu("link",{update:function(t){return J(r.dom.getParents(t,"a"))?"link unlink openlink":"link"}}),o=function(t){var e=i.selection.getNode();return t.setDisabled(!Z(i,e)),y},(i=t).ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Mt(i)},label:"Link",predicate:function(t){return!!Z(i,t)&&i.getParam("link_context_toolbar",!1,"boolean")},initValue:function(){var t=Z(i);return t?Y(t):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(t){var e=i.selection.getNode();return t.setActive(!!Z(i,e)),Mt(i)(t)},onAction:function(t){var e,n,r=Z(i),o=t.getValue();r?i.undoManager.transact(function(){i.dom.setAttrib(r,"href",o),i.selection.collapse(!1),t.hide()}):(e={href:o,attach:y},n=Q(i)?M.some(K(i.selection,r)).filter(function(t){return 0<t.length}).or(M.from(o)):M.none(),nt(i,e,{href:o,text:n,title:M.none(),rel:M.none(),target:M.none(),class:M.none()}),t.hide())}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:o,onAction:function(t){rt(i),t.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:o,onAction:function(t){wt(i)(),t.hide()}}]}),St(t),(a=t).addCommand("mceLink",function(){a.getParam("link_quicklink",!1,"boolean")?a.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):_t(a)()}),(s=t).addShortcut("Meta+K","",function(){s.execCommand("mceLink")})})}(),function(){"use strict";var t,e,n,r,i=function(t){var e=t;return{get:function(){return e},set:function(t){e=t}}},o=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=function(t){return!(null===(e=t)||void 0===e);var e},s=function(){},l=function(t){return function(){return t}},u=l(!1),c=l(!0),d=function(){return f},f=(t=function(t){return t.isNone()},{fold:function(t,e){return t()},is:u,isSome:u,isNone:c,getOr:n=function(t){return t},getOrThunk:e=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:l(null),getOrUndefined:l(void 0),or:n,orThunk:e,map:d,each:s,bind:d,exists:u,forall:c,filter:d,equals:t,equals_:t,toArray:function(){return[]},toString:l("none()")}),h=function(t){var e=l(t),n=function(){return i},r=function(e){return e(t)},i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:c,isNone:u,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return h(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?i:f},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(u,function(e){return n(t,e)})}};return i},p={some:h,none:d,from:function(t){return null==t?f:h(t)}},g=Array.prototype.slice,m=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return!0;return!1},v=function(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;i++)r[i]=e(t[i],i);return r},y=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)},x="function"==typeof Array.from?Array.from:function(t){return g.call(t)},b=function(){var t=i(p.none());return{clear:function(){return t.set(p.none())},set:function(e){return t.set(p.some(e))},isSet:function(){return t.get().isSome()},on:function(e){return t.get().each(e)}}},_=function(t,e,n){return""===e||t.length>=e.length&&t.substr(n,n+e.length)===e},w=tinymce.util.Tools.resolve("tinymce.Env"),S=tinymce.util.Tools.resolve("tinymce.util.Delay"),C=tinymce.util.Tools.resolve("tinymce.util.Promise"),M=tinymce.util.Tools.resolve("tinymce.util.VK"),T=function(t,e){return t.fire("PastePlainTextToggle",{state:e})},k=tinymce.util.Tools.resolve("tinymce.util.Tools"),A=function(t){return t.getParam("paste_data_images",!1)},I=function(t){return t.getParam("paste_retain_style_properties")},D=function(t){return t.getParam("validate")},O=function(t){return t.getParam("paste_data_images",!1,"boolean")},P=function(t){return k.explode(t.getParam("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"))},E="x-tinymce/html",R="\x3c!-- "+E+" --\x3e",L=function(t){return-1!==t.indexOf(R)},N=tinymce.util.Tools.resolve("tinymce.html.Entities"),B=tinymce.util.Tools.resolve("tinymce.html.DomParser"),z=tinymce.util.Tools.resolve("tinymce.html.Serializer"),V=tinymce.util.Tools.resolve("tinymce.html.Node"),F=tinymce.util.Tools.resolve("tinymce.html.Schema"),H=function(t,e){return k.each(e,function(e){t=e.constructor===RegExp?t.replace(e,""):t.replace(e[0],e[1])}),t},W=function(t){return H(t,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(t,e,n){return e||n?" ":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])},j=function(t){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(t)||/class="OutlineElement/.test(t)||/id="?docs\-internal\-guid\-/.test(t)},G=function(t,e){return{content:t,cancelled:e}},U=function(t,e){return t.insertContent(e,{merge:t.getParam("paste_merge_formats",!0),paste:!0}),!0},q=function(t){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(t)},X=function(t,e,n){return!(!1!==t.selection.isCollapsed()||!q(e)||(i=e,o=n,(r=t).undoManager.extra(function(){o(r,i)},function(){r.execCommand("mceInsertLink",!1,i)}),0));var r,i,o},Y=function(t,e,n){return!!function(t,e){return q(e)&&m(P(t),function(t){return n=e.toLowerCase(),r="."+t.toLowerCase(),_(n,r,n.length-r.length);var n,r})}(t,e)&&(i=e,o=n,(r=t).undoManager.extra(function(){o(r,i)},function(){r.insertContent('<img src="'+i+'">')}),!0);var r,i,o},$=function(t){return"\n"===t||"\r"===t},Z=function(t,e,n,r){var i=function(t,e,n){var r,i,o=j(e);return function(t,e,n,r){var i,o,a,s,l,u=t.fire("PastePreProcess",{content:e,internal:n,wordContent:r}),c=function(t,e){var n=B({},t.schema);n.addNodeFilter("meta",function(t){k.each(t,function(t){t.remove()})});var r=n.parse(e,{forced_root_block:!1,isRootContent:!0});return z({validate:D(t)},t.schema).serialize(r)}(t,u.content);return t.hasEventListeners("PastePostProcess")&&!u.isDefaultPrevented()?(o=n,a=r,s=(i=t).dom.create("div",{style:"display:none"},c),l=i.fire("PastePostProcess",{node:s,internal:o,wordContent:a}),G(l.node.innerHTML,l.isDefaultPrevented())):G(c,u.isDefaultPrevented())}(t,o?(i=e,(r=t).getParam("paste_enable_default_filters",!0)?function(t,e){var n,r=I(t);r&&(n=k.makeMap(r.split(/[, ]/))),e=H(e,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(t,e){return 0<e.length?e.replace(/./," ").slice(Math.floor(e.length/2)).split("").join(" "):""}]]);var i=t.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody"),o=F({valid_elements:i,valid_children:"-li[p]"});k.each(o.elements,function(t){t.attributes.class||(t.attributes.class={},t.attributesOrder.push("class")),t.attributes.style||(t.attributes.style={},t.attributesOrder.push("style"))});var a=B({},o);a.addAttributeFilter("style",function(e){for(var r,i=e.length;i--;)(r=e[i]).attr("style",function(t,e,n,r){var i,o={},a=t.dom.parseStyle(r);return k.each(a,function(a,s){switch(s){case"mso-list":(i=/\w+ \w+([0-9]+)/i.exec(r))&&(n._listLevel=parseInt(i[1],10)),/Ignore/i.test(a)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":s="text-align";break;case"vert-align":s="vertical-align";break;case"font-color":case"mso-foreground":s="color";break;case"mso-background":case"mso-highlight":s="background";break;case"font-weight":case"font-style":return void("normal"!==a&&(o[s]=a));case"mso-element":if(/^(comment|comment-list)$/i.test(a))return void n.remove()}0!==s.indexOf("mso-comment")?0!==s.indexOf("mso-")&&("all"===I(t)||e&&e[s])&&(o[s]=a):n.remove()}),/(bold)/i.test(o["font-weight"])&&(delete o["font-weight"],n.wrap(new V("b",1))),/(italic)/i.test(o["font-style"])&&(delete o["font-style"],n.wrap(new V("i",1))),(o=t.dom.serializeStyle(o,n.name))||null}(t,n,r,r.attr("style"))),"span"===r.name&&r.parent&&!r.attributes.length&&r.unwrap()}),a.addAttributeFilter("class",function(t){for(var e,n,r=t.length;r--;)n=(e=t[r]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&e.remove(),e.attr("class",null)}),a.addNodeFilter("del",function(t){for(var e=t.length;e--;)t[e].remove()}),a.addNodeFilter("a",function(t){for(var e,n,r,i=t.length;i--;)if(n=(e=t[i]).attr("href"),r=e.attr("name"),n&&-1!==n.indexOf("#_msocom_"))e.remove();else if(n&&0===n.indexOf("file://")&&(n=(n=n.split("#")[1])&&"#"+n),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){e.unwrap();continue}e.attr({href:n,name:r})}else e.unwrap()});var s=a.parse(e);return t.getParam("paste_convert_word_fake_lists",!0)&&function(t){for(var e,n,r=1,i=function(t){var e="";if(3===t.type)return t.value;if(t=t.firstChild)for(;e+=i(t),t=t.next;);return e},o=function(t,e){if(3===t.type&&e.test(t.value))return t.value=t.value.replace(e,""),!1;if(t=t.firstChild)do{if(!o(t,e))return!1}while(t=t.next);return!0},a=function(t){if(t._listIgnore)t.remove();else if(t=t.firstChild)for(;a(t),t=t.next;);},s=function(t,i,s){var l=t._listLevel||r;l!==r&&(e=l<r?e&&e.parent.parent:(n=e,null)),e&&e.name===i?e.append(t):(n=n||e,e=new V(i,1),1<s&&e.attr("start",""+s),t.wrap(e)),t.name="li",r<l&&n&&n.lastChild.append(e),r=l,a(t),o(t,/^\u00a0+/),o(t,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),o(t,/^\u00a0+/)},l=[],u=t.firstChild;null!=u;)if(l.push(u),null!==(u=u.walk()))for(;void 0!==u&&u.parent!==t;)u=u.walk();for(var c=0;c<l.length;c++)if("p"===(t=l[c]).name&&t.firstChild){var d=i(t);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(d)){s(t,"ul");continue}if(function(t){var e;return t=t.replace(/^[\u00a0 ]+/,""),k.each([/^[IVXLMCD]+\.[ \u00a0]/,/^[ivxlmcd]+\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],function(n){if(n.test(t))return!(e=!0)}),e}(d)){var f=/([0-9]+)\./.exec(d),h=1;f&&(h=parseInt(f[1],10)),s(t,"ol",h);continue}if(t._listLevel){s(t,"ul",1);continue}e=null}else n=e,e=null}(s),z({validate:D(t)},o).serialize(s)}(r,i):i):e,n,o)}(t,e,n);!1===i.cancelled&&function(t,e,n){var r,i;n||!1===t.getParam("smart_paste",!0)?U(t,e):(r=t,i=e,k.each([X,Y,U],function(t){return!0!==t(r,i,U)}))}(t,i.content,r)},K=function(t,e,n){var r=n||L(e);Z(t,e.replace(R,""),r,!1)},J=function(t,e){var n,r,i,o=t.dom.encode(e).replace(/\r\n/g,"\n"),a=function(t,e){var n,r,i,o=(n=t.getParam("paste_tab_spaces",4,"number"))<=0?"":new Array(n+1).join(" "),a=e.replace(/\t/g,o);return(i={pcIsSpace:!(r=function(t,e){return-1!==" \f\t\v".indexOf(e)||" "===e?t.pcIsSpace||""===t.str||t.str.length===a.length-1||(r=t.str.length+1)<(n=a).length&&0<=r&&$(n[r])?{pcIsSpace:!1,str:t.str+" "}:{pcIsSpace:!0,str:t.str+" "}:{pcIsSpace:$(e),str:t.str+e};var n,r}),str:""},y(a,function(t){i=r(i,t)}),i).str}(t,o),s=(n=a,r=t.getParam("forced_root_block"),i=t.getParam("forced_root_block_attrs"),r?function(t,e,n){var r=t.split(/\n\n/),i=function(t,e){var n,r=[],i="<"+t;if("object"==typeof e){for(n in e)e.hasOwnProperty(n)&&r.push(n+'="'+N.encodeAllRaw(e[n])+'"');r.length&&(i+=" "+r.join(" "))}return i+">"}(e,n),o="</"+e+">",a=k.map(r,function(t){return t.split(/\n/).join("<br />")});return 1===a.length?a[0]:k.map(a,function(t){return i+t+o}).join("")}(n,!0===r?"p":r,i):n.replace(/\r?\n/g,"<br>"));Z(t,s,!1,!0)},Q=function(t){var e,n={};if(t&&(!t.getData||(e=t.getData("Text"))&&0<e.length&&-1===e.indexOf("data:text/mce-internal,")&&(n["text/plain"]=e),t.types))for(var i=0;i<t.types.length;i++){var o=t.types[i];try{n[o]=t.getData(o)}catch(r){n[o]=""}}return n},tt=function(t,e){return e in t&&0<t[e].length},et=function(t){return tt(t,"text/html")||tt(t,"text/plain")},nt=(r=0,function(){return"mceclip"+r++}),rt=function(t,e,n){var r,i,o,s,l="paste"===e.type?e.clipboardData:e.dataTransfer;if(O(t)&&l){var u=(r=t,o=(i=l).items?v(x(i.items),function(t){return t.getAsFile()}):[],s=i.files?x(i.files):[],function(t,e){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];e(o,r)&&n.push(o)}return n}(0<o.length?o:s,function(t){var e=P(t);return function(t){return _(t.type,"image/",0)&&m(e,function(e){return n=e.toLowerCase(),(k.hasOwn(r={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"},n)?"image/"+r[n]:"image/"+n)===t.type;var n,r})}}(r)));if(0<u.length)return e.preventDefault(),function(t){return C.all(v(t,function(t){return new C(function(e){var n=a(t.getAsFile)?t.getAsFile():t,r=new window.FileReader;r.onload=function(){e({blob:n,uri:r.result})},r.readAsDataURL(n)})}))}(u).then(function(e){n&&t.selection.setRng(n),y(e,function(e){!function(t,e){var n,r,i,o,s,l,u,c,d,f,h=(n=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(e.uri))?{type:n[1],data:decodeURIComponent(n[2])}:{type:null,data:null},p=h.data,g=h.type,m=nt(),v=e.blob,y=new Image;y.src=e.uri,d=y,!(f=t.getParam("images_dataimg_filter"))||f(d)?(l=void 0,(i=(r=t.editorUpload.blobCache).getByData(p,g))?l=i:(s=(o=t.getParam("images_reuse_filename")&&a(v.name))?(u=t,c=v.name.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i),a(c)?u.dom.encode(c[1]):null):m,l=r.create(m,v,p,s,o?v.name:void 0),r.add(l)),K(t,'<img src="'+l.blobUri()+'">',!1)):K(t,'<img src="'+e.uri+'">',!1)}(t,e)})}),!0}return!1},it=function(t){return M.metaKeyPressed(t)&&86===t.keyCode||t.shiftKey&&45===t.keyCode},ot=function(t){return w.ie&&t.inline?document.body:t.getBody()},at=function(t){return t.dom.get("mcepastebin")},st=function(t,e){var n,r=at(t);return(n=r)&&"mcepastebin"===n.id&&function(t,e){return e===t}(e,r.innerHTML)},lt=function(t,e,n,r){!function(t,e,n){if(r=t,!1!==w.iOS||"function"!=typeof(null==r?void 0:r.setData))return!1;try{return t.clearData(),t.setData("text/html",e),t.setData("text/plain",n),t.setData(E,e),!0}catch(i){return!1}var r}(t.clipboardData,e.html,e.text)?n(e.html,r):(t.preventDefault(),r())},ut=function(t){return function(e,n){var r=R+e,i=t.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),o=t.dom.create("div",{contenteditable:"true"},r);t.dom.setStyles(i,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),i.appendChild(o),t.dom.add(t.getBody(),i);var a=t.selection.getRng();o.focus();var s=t.dom.createRng();s.selectNodeContents(o),t.selection.setRng(s),S.setTimeout(function(){t.selection.setRng(a),i.parentNode.removeChild(i),n()},0)}},ct=function(t){return{html:t.selection.getContent({contextual:!0}),text:t.selection.getContent({format:"text"})}},dt=function(t){return!t.selection.isCollapsed()||!!(e=t).dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody());var e},ft=function(t){var e,n;t.on("cut",(e=t,function(t){dt(e)&&lt(t,ct(e),ut(e),function(){var t;w.browser.isChrome()||w.browser.isFirefox()?(t=e.selection.getRng(),S.setEditorTimeout(e,function(){e.selection.setRng(t),e.execCommand("Delete")},0)):e.execCommand("Delete")})})),t.on("copy",(n=t,function(t){dt(n)&&lt(t,ct(n),ut(n),s)}))},ht=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),pt=function(t,e){return ht.getCaretRangeFromPoint(e.clientX,e.clientY,t.getDoc())},gt=function(t,e){t.focus(),t.selection.setRng(e)},mt=function(t,e){t.on("PastePreProcess",function(n){n.content=e(t,n.content,n.internal,n.wordContent)})},vt=function(t,e){if(!j(e))return e;var n=[];k.each(t.schema.getBlockElements(),function(t,e){n.push(e)});var r=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return e=H(e,[[r,"$1"]]),H(e,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])},yt=function(t,e,n,r){if(r||n)return e;var i,o,a,s=t.getParam("paste_webkit_styles");return!1===t.getParam("paste_remove_styles_if_webkit",!0)||"all"===s?e:(s&&(i=s.split(/[, ]/)),e=(e=i?(o=t.dom,a=t.selection.getNode(),e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(t,e,n,r){var s=o.parseStyle(o.decode(n)),l={};if("none"===i)return e+r;for(var u=0;u<i.length;u++){var c=s[i[u]],d=o.getStyle(a,i[u],!0);/color/.test(i[u])&&(c=o.toHex(c),d=o.toHex(d)),d!==c&&(l[i[u]]=c)}return(l=o.serializeStyle(l,"span"))?e+' style="'+l+'"'+r:e+r})):e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3")).replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(t,e,n,r){return e+' style="'+n+'"'+r}))},xt=function(t,e){t.$("a",e).find("font,u").each(function(e,n){t.dom.remove(n,!0)})},bt=function(t,e){return function(n){n.setActive("text"===e.pasteFormat.get());var r=function(t){return n.setActive(t.state)};return t.on("PastePlainTextToggle",r),function(){return t.off("PastePlainTextToggle",r)}}};o.add("paste",function(t){if(0==(!!t.hasPlugin("powerpaste",!0)&&(void 0!==window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0))){var e=i(!1),n=i(t.getParam("paste_as_text",!1)?"text":"html"),r=(d=n,f=function(t){var e=i(null),n="%MCEPASTEBIN%";return{create:function(){return function(t,e,n){var r=t.dom,i=t.getBody();e.set(t.selection.getRng());var o=t.dom.add(ot(t),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},"%MCEPASTEBIN%");(w.ie||w.gecko)&&r.setStyle(o,"left","rtl"===r.getStyle(i,"direction",!0)?65535:-65535),r.bind(o,"beforedeactivate focusin focusout",function(t){t.stopPropagation()}),function(t,e,n){var r;ot(r=t)!==r.getBody()&&t.dom.bind(e,"paste keyup",function(e){st(t,"%MCEPASTEBIN%")||t.fire("paste")})}(t,o),o.focus(),t.selection.select(o,!0)}(t,e)},remove:function(){return function(t,e){if(at(t)){for(var n=void 0,r=e.get();n=t.dom.get("mcepastebin");)t.dom.remove(n),t.dom.unbind(n);r&&t.selection.setRng(r)}e.set(null)}(t,e)},getEl:function(){return at(t)},getHtml:function(){return function(t){var e=function(e,n){e.appendChild(n),t.dom.remove(n,!0)},n=k.grep(ot(t).childNodes,function(t){return"mcepastebin"===t.id}),r=n.shift();k.each(n,function(t){e(r,t)});for(var i=t.dom.select("div[id=mcepastebin]",r),o=i.length-1;0<=o;o--){var a=t.dom.create("div");r.insertBefore(a,i[o]),e(a,i[o])}return r?r.innerHTML:""}(t)},getLastRng:function(){return e.get()},isDefault:function(){return st(t,n)},isDefaultContent:function(t){return t===n}}}(c=t),c.on("PreInit",function(){return function(t,e,n){var r;(function(t,e,n){var r,i=b(),o=b();t.on("keyup",o.clear),t.on("keydown",function(n){var a=function(t){it(t)&&!t.isDefaultPrevented()&&e.remove()};if(it(n)&&!n.isDefaultPrevented()){if((r=n.shiftKey&&86===n.keyCode)&&w.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(n.stopImmediatePropagation(),i.set(n),o.set(!0),w.ie&&r)return n.preventDefault(),void t.fire("paste",{ieFake:!0});e.remove(),e.create(),t.once("keyup",a),t.once("paste",function(){t.off("keyup",a)})}});var a=function(t,n,r,i,o){var a;tt(n,"text/html")?a=n["text/html"]:(a=e.getHtml(),o=o||L(a),e.isDefaultContent(a)&&(i=!0)),a=W(a),e.remove();var s,l,u,c,d,f,h,p,g=!1===o&&!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(a),m=q(a);a.length&&(!g||m)||(i=!0),(i||m)&&(a=tt(n,"text/plain")&&g?n["text/plain"]:(s=a,l=F(),u=B({},l),c="",d=l.getShortEndedElements(),f=k.makeMap("script noscript style textarea video audio iframe object"," "),h=l.getBlockElements(),p=function(t){var e=t.name,n=t;if("br"!==e){if("wbr"!==e)if(d[e]&&(c+=" "),f[e])c+=" ";else{if(3===t.type&&(c+=t.value),!t.shortEnded&&(t=t.firstChild))for(;p(t),t=t.next;);h[e]&&n.next&&(c+="\n","p"===e&&(c+="\n"))}}else c+="\n"},s=H(s,[/<!\[[^\]]+\]>/g]),p(u.parse(s)),c)),e.isDefaultContent(a)?r||t.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):i?J(t,a):K(t,a,o)};t.on("paste",function(s){var l=i.isSet()||o.isSet();l&&i.clear();var u,c=Q(s.clipboardData||t.getDoc().dataTransfer),d="text"===n.get()||r,f=tt(c,E);r=!1,s.isDefaultPrevented()||(u=s.clipboardData,-1!==navigator.userAgent.indexOf("Android")&&u&&u.items&&0===u.items.length)||!et(c)&&rt(t,s,e.getLastRng()||t.selection.getRng())?e.remove():(l||s.preventDefault(),!w.ie||l&&!s.ieFake||tt(c,"text/html")||(e.create(),t.dom.bind(e.getEl(),"paste",function(t){t.stopPropagation()}),t.getDoc().execCommand("Paste",!1,null),c["text/html"]=e.getHtml()),tt(c,"text/html")?(s.preventDefault(),f=f||L(c["text/html"]),a(t,c,l,d,f)):S.setEditorTimeout(t,function(){a(t,c,l,d,f)},0))})})(t,e,n),t.parser.addNodeFilter("img",function(e,n,i){var o,a=function(t){t.attr("data-mce-object")||r===w.transparentSrc||t.remove()};if(!O(t)&&(o=i).data&&!0===o.data.paste)for(var s=e.length;s--;)(r=e[s].attr("src"))&&(0!==r.indexOf("webkit-fake-url")&&(t.getParam("allow_html_data_urls",!1,"boolean")||0!==r.indexOf("data:"))||a(e[s]))})}(c,f,d)}),{pasteFormat:d,pasteHtml:function(t,e){return K(c,t,e)},pasteText:function(t){return J(c,t)},pasteImageData:function(t,e){return rt(c,t,e)},getDataTransferItems:Q,hasHtmlOrText:et,hasContentType:tt});return s=t,w.webkit&&mt(s,yt),w.ie&&(mt(s,vt),u=xt,(l=s).on("PastePostProcess",function(t){u(l,t.node)})),(o=t).ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:function(){return o.execCommand("mceTogglePlainTextPaste")},onSetup:bt(o,a=r)}),o.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:function(){return o.execCommand("mceTogglePlainTextPaste")},onSetup:bt(o,a)}),function(t,e){t.addCommand("mceTogglePlainTextPaste",function(){var n,r;n=t,"text"===(r=e).pasteFormat.get()?(r.pasteFormat.set("html"),T(n,!1)):(r.pasteFormat.set("text"),T(n,!0)),n.focus()}),t.addCommand("mceInsertClipboardContent",function(t,n){n.content&&e.pasteHtml(n.content,n.internal),n.text&&e.pasteText(n.text)})}(t,r),function(t){var e=t.plugins.paste,n=t.getParam("paste_preprocess");n&&t.on("PastePreProcess",function(t){n.call(e,e,t)});var r=t.getParam("paste_postprocess");r&&t.on("PastePostProcess",function(t){r.call(e,e,t)})}(t),ft(t),function(t,e,n){t.getParam("paste_block_drop",!1)&&t.on("dragend dragover draggesture dragdrop drop drag",function(t){t.preventDefault(),t.stopPropagation()}),A(t)||t.on("drop",function(t){var e=t.dataTransfer;e&&e.files&&0<e.files.length&&t.preventDefault()}),t.on("drop",function(r){var i,o,a,s,l=pt(t,r);r.isDefaultPrevented()||n.get()||(i=e.getDataTransferItems(r.dataTransfer),o=e.hasContentType(i,E),(!e.hasHtmlOrText(i)||(a=i["text/plain"])&&0===a.indexOf("file://"))&&e.pasteImageData(r,l)||!l||!t.getParam("paste_filter_drop",!0)||(s=i["mce-internal"]||i["text/html"]||i["text/plain"])&&(r.preventDefault(),S.setEditorTimeout(t,function(){t.undoManager.transact(function(){i["mce-internal"]&&t.execCommand("Delete"),gt(t,l),s=W(s),i["text/html"]?e.pasteHtml(s,o):e.pasteText(s)})})))}),t.on("dragstart",function(t){n.set(!0)}),t.on("dragover dragend",function(e){A(t)&&!1===n.get()&&(e.preventDefault(),gt(t,pt(t,e))),"dragend"===e.type&&n.set(!1)})}(t,r,e),{clipboard:r,quirks:void 0}}var o,a,s,l,u,c,d,f})}(),function(){"use strict";var t=function(t){return function(e){return r=typeof(n=e),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===t;var n,r}},e=function(t){return function(e){return typeof e===t}},n=t("string"),r=t("object"),i=t("array"),o=e("boolean"),a=function(t){return!(null===(e=t)||void 0===e);var e},s=e("function"),l=e("number"),u=function(){},c=function(t){return function(){return t}},d=function(t){return t};function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=e.concat(n);return t.apply(null,i)}}var h,p,g,m=function(t){return function(e){return!t(e)}},v=c(!1),y=c(!0),x=function(){return b},b=(h=function(t){return t.isNone()},{fold:function(t,e){return t()},is:v,isSome:v,isNone:y,getOr:g=function(t){return t},getOrThunk:p=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:c(null),getOrUndefined:c(void 0),or:g,orThunk:p,map:x,each:u,bind:x,exists:v,forall:y,filter:x,equals:h,equals_:h,toArray:function(){return[]},toString:c("none()")}),_=function(t){var e=c(t),n=function(){return i},r=function(e){return e(t)},i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:y,isNone:v,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return _(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?i:b},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(v,function(e){return n(t,e)})}};return i},w={some:_,none:x,from:function(t){return null==t?b:_(t)}},S=Array.prototype.slice,C=Array.prototype.indexOf,M=Array.prototype.push,T=function(t,e){return-1<C.call(t,e)},k=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return!0;return!1},A=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},I=function(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;i++)r[i]=e(t[i],i);return r},D=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)},O=function(t,e){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];e(o,r)&&n.push(o)}return n},P=function(t,e,n){return function(t,e){for(var n=t.length-1;0<=n;n--)e(t[n])}(t,function(t){n=e(n,t)}),n},E=function(t,e,n){return D(t,function(t){n=e(n,t)}),n},R=function(t,e){return function(t,e,n){for(var r=0,i=t.length;r<i;r++){var o=t[r];if(e(o,r))return w.some(o);if(n(o,r))break}return w.none()}(t,e,v)},L=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return w.some(n);return w.none()},N=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!i(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);M.apply(e,t[n])}return e},B=function(t,e){return N(I(t,e))},z=function(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n))return!1;return!0},V=function(t,e){for(var n={},r=0,i=t.length;r<i;r++){var o=t[r];n[String(o)]=e(o,r)}return n},F=function(t){return[t]},H=function(t,e){return 0<=e&&e<t.length?w.some(t[e]):w.none()},W=function(t){return H(t,0)},j=function(t){return H(t,t.length-1)},G=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return w.none()},U=function(){return(U=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function q(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var X,Y=function(t){var e,n=!1;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return n||(n=!0,e=t.apply(null,r)),e}},$=function(){return Z(0,0)},Z=function(t,e){return{major:t,minor:e}},K=function(t,e){var n=String(e).toLowerCase();return 0===t.length?$():function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return Z(r(1),r(2))}(t,n)},J=$,Q=function(t,e){var n=String(e).toLowerCase();return R(t,function(t){return t.search(n)})},tt=function(t,e,n){return""===e||t.length>=e.length&&t.substr(n,n+e.length)===e},et=function(t,e){return-1!==t.indexOf(e)},nt=function(t,e){return tt(t,e,0)},rt=function(t,e){return tt(t,e,t.length-e.length)},it=(X=/^\s+|\s+$/g,function(t){return t.replace(X,"")}),ot=function(t){return 0<t.length},at=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,st=function(t){return function(e){return et(e,t)}},lt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return et(t,"edge/")&&et(t,"chrome")&&et(t,"safari")&&et(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,at],search:function(t){return et(t,"chrome")&&!et(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return et(t,"msie")||et(t,"trident")}},{name:"Opera",versionRegexes:[at,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:st("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:st("firefox")},{name:"Safari",versionRegexes:[at,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(et(t,"safari")||et(t,"mobile/"))&&et(t,"applewebkit")}}],ut=[{name:"Windows",search:st("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return et(t,"iphone")||et(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:st("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:st("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:st("linux"),versionRegexes:[]},{name:"Solaris",search:st("sunos"),versionRegexes:[]},{name:"FreeBSD",search:st("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:st("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ct={browsers:c(lt),oses:c(ut)},dt="Firefox",ft=function(t){var e=t.current,n=function(t){return function(){return e===t}};return{current:e,version:t.version,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(dt),isSafari:n("Safari")}},ht=function(){return ft({current:void 0,version:J()})},pt=ft,gt=(c("Edge"),c("Chrome"),c("IE"),c("Opera"),c(dt),c("Safari"),"Windows"),mt="Android",vt="Solaris",yt="FreeBSD",xt="ChromeOS",bt=function(t){var e=t.current,n=function(t){return function(){return e===t}};return{current:e,version:t.version,isWindows:n(gt),isiOS:n("iOS"),isAndroid:n(mt),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(vt),isFreeBSD:n(yt),isChromeOS:n(xt)}},_t=function(){return bt({current:void 0,version:J()})},wt=bt,St=(c(gt),c("iOS"),c(mt),c("Linux"),c("OSX"),c(vt),c(yt),c(xt),function(t,e){var n,r,i,o,a,s,l,u,d,f,h,p,g=ct.browsers(),m=ct.oses(),v=function(t,e){return Q(t,e).map(function(t){var n=K(t.versionRegexes,e);return{current:t.name,version:n}})}(g,t).fold(ht,pt),y=function(t,e){return Q(t,e).map(function(t){var n=K(t.versionRegexes,e);return{current:t.name,version:n}})}(m,t).fold(_t,wt);return{browser:v,os:y,deviceType:(r=v,i=t,o=e,a=(n=y).isiOS()&&!0===/ipad/i.test(i),s=n.isiOS()&&!a,l=n.isiOS()||n.isAndroid(),u=l||o("(pointer:coarse)"),d=a||!s&&l&&o("(min-device-width:768px)"),f=s||l&&!d,h=r.isSafari()&&n.isiOS()&&!1===/safari/i.test(i),p=!f&&!d&&!h,{isiPad:c(a),isiPhone:c(s),isTablet:c(d),isPhone:c(f),isTouch:c(u),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:c(h),isDesktop:c(p)})}}),Ct=function(t){return window.matchMedia(t).matches},Mt=Y(function(){return St(navigator.userAgent,Ct)}),Tt=function(){return Mt()},kt=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},At={fromHtml:function(t,e){var n=(e||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return kt(n.childNodes[0])},fromTag:function(t,e){var n=(e||document).createElement(t);return kt(n)},fromText:function(t,e){var n=(e||document).createTextNode(t);return kt(n)},fromDom:kt,fromPoint:function(t,e,n){return w.from(t.dom.elementFromPoint(e,n)).map(kt)}},It=function(t,e){var n=t.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},Dt=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Ot=function(t,e){return t.dom===e.dom},Pt=function(t,e){return Tt().browser.isIE()?function(t,e){return n=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(t.dom.compareDocumentPosition(e.dom)&n);var n}(t,e):(n=t.dom)!==(r=e.dom)&&n.contains(r);var n,r},Et=It,Rt=Object.keys,Lt=Object.hasOwnProperty,Nt=function(t,e){for(var n=Rt(t),r=0,i=n.length;r<i;r++){var o=n[r];e(t[o],o)}},Bt=function(t,e){return zt(t,function(t,n){return{k:n,v:e(t,n)}})},zt=function(t,e){var n={};return Nt(t,function(t,r){var i=e(t,r);n[i.k]=i.v}),n},Vt=function(t,e){var n,r,i,o,a={};return n=e,o=a,r=function(t,e){o[e]=t},i=u,Nt(t,function(t,e){(n(t,e)?r:i)(t,e)}),a},Ft=function(t,e){var n=[];return Nt(t,function(t,r){n.push(e(t,r))}),n},Ht=function(t){return Rt(t).length},Wt=function(t,e){return jt(t,e)?w.from(t[e]):w.none()},jt=function(t,e){return Lt.call(t,e)},Gt=function(t,e){return jt(t,e)&&null!=t[e]},Ut=["tfoot","thead","tbody","colgroup"],qt=function(t,e,n){return{element:t,rowspan:e,colspan:n}},Xt=function(t,e,n){return{element:t,cells:e,section:n}},Yt=function(t,e,n){return{element:t,isNew:e,isLocked:n}},$t=function(t,e){return{cells:t,section:e}},Zt=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),Kt=function(t){return t.dom.nodeType},Jt=function(t){return function(e){return Kt(e)===t}},Qt=function(t){return 8===Kt(t)||"#comment"===Zt(t)},te=Jt(1),ee=Jt(3),ne=Jt(9),re=Jt(11),ie=function(t){return function(e){return te(e)&&Zt(e)===t}},oe=function(t){return At.fromDom(t.dom.ownerDocument)},ae=function(t){return ne(t)?t:oe(t)},se=function(t){return w.from(t.dom.parentNode).map(At.fromDom)},le=function(t,e){for(var n=s(e)?e:v,r=t.dom,i=[];null!=r.parentNode;){var o=r.parentNode,a=At.fromDom(o);if(i.push(a),!0===n(a))break;r=o}return i},ue=function(t){return w.from(t.dom.previousSibling).map(At.fromDom)},ce=function(t){return w.from(t.dom.nextSibling).map(At.fromDom)},de=function(t){return I(t.dom.childNodes,At.fromDom)},fe=function(t,e){return w.from(t.dom.childNodes[e]).map(At.fromDom)},he=s(Element.prototype.attachShadow)&&s(Node.prototype.getRootNode),pe=c(he),ge=he?function(t){return At.fromDom(t.dom.getRootNode())}:ae,me=function(t){return At.fromDom(t.dom.host)},ve=function(t){var e=ee(t)?t.dom.parentNode:t.dom;if(null==e||null===e.ownerDocument)return!1;var n,r,i=e.ownerDocument;return function(t){var e,n=ge(t);return re(e=n)&&a(e.dom.host)?w.some(n):w.none()}(At.fromDom(e)).fold(function(){return i.body.contains(e)},(n=ve,r=me,function(t){return n(r(t))}))},ye=function(t){var e=t.dom.body;if(null==e)throw new Error("Body is not available yet");return At.fromDom(e)},xe=function(t,e){var n=[];return D(de(t),function(t){e(t)&&(n=n.concat([t])),n=n.concat(xe(t,e))}),n},be=function(t,e,n){return r=function(t){return It(t,e)},O(le(t,n),r);var r},_e=function(t,e){return n=function(t){return It(t,e)},O(de(t),n);var n},we=function(t,e){return n=e,i=void 0===(r=t)?document:r.dom,Dt(i)?[]:I(i.querySelectorAll(n),At.fromDom);var n,r,i};function Se(t,e,n,r,i){return t(n,r)?w.some(n):s(i)&&i(n)?w.none():e(n,r,i)}var Ce,Me,Te=function(t,e,n){for(var r=t.dom,i=s(n)?n:v;r.parentNode;){var o=At.fromDom(r=r.parentNode);if(e(o))return w.some(o);if(i(o))break}return w.none()},ke=function(t,e,n){return Te(t,function(t){return It(t,e)},n)},Ae=function(t,e){return n=function(t){return It(t,e)},R(t.dom.childNodes,function(t){return n(At.fromDom(t))}).map(At.fromDom);var n},Ie=function(t,e){return n=e,i=void 0===(r=t)?document:r.dom,Dt(i)?w.none():w.from(i.querySelector(n)).map(At.fromDom);var n,r,i},De=function(t,e,n){return Se(It,ke,t,e,n)},Oe=function(t,e,r){if(!(n(r)||o(r)||l(r)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,r+"")},Pe=function(t,e,n){Oe(t.dom,e,n)},Ee=function(t,e){var n=t.dom;Nt(e,function(t,e){Oe(n,e,t)})},Re=function(t,e){var n=t.dom.getAttribute(e);return null===n?void 0:n},Le=function(t,e){return w.from(Re(t,e))},Ne=function(t,e){t.dom.removeAttribute(e)},Be=function(t){return E(t.dom.attributes,function(t,e){return t[e.name]=e.value,t},{})},ze=function(t){return void 0!==t.style&&s(t.style.getPropertyValue)},Ve=function(t,e,r){if(!n(r))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",t),new Error("CSS value must be a string: "+r);ze(t)&&t.style.setProperty(e,r)},Fe=function(t,e,n){Ve(t.dom,e,n)},He=function(t,e){var n=t.dom;Nt(e,function(t,e){Ve(n,e,t)})},We=function(t,e){var n=t.dom,r=window.getComputedStyle(n).getPropertyValue(e);return""!==r||ve(t)?r:je(n,e)},je=function(t,e){return ze(t)?t.style.getPropertyValue(e):""},Ge=function(t,e){var n=je(t.dom,e);return w.from(n).filter(function(t){return 0<t.length})},Ue=function(t,e){var n,r;r=e,ze(n=t.dom)&&n.style.removeProperty(r),Le(t,"style").map(it).is("")&&Ne(t,"style")},qe=function(t,e,n){return void 0===n&&(n=0),Le(t,e).map(function(t){return parseInt(t,10)}).getOr(n)},Xe=function(t,e){return qe(t,e,1)},Ye=function(t){return 1<Xe(t,"colspan")},$e=function(t){return 1<Xe(t,"rowspan")},Ze=function(t,e){return parseInt(We(t,e),10)},Ke=c(10),Je=c(10),Qe=function(t,e){return tn(t,e,y)},tn=function(t,e,n){return B(de(t),function(t){return It(t,e)?n(t)?[t]:[]:tn(t,e,n)})},en=function(t,e){return function(t,e,n){return void 0===n&&(n=v),n(e)?w.none():T(t,Zt(e))?w.some(e):ke(e,t.join(","),function(t){return It(t,"table")||n(t)})}(["td","th"],t,e)},nn=function(t){return Qe(t,"th,td")},rn=function(t){return It(t,"colgroup")?_e(t,"col"):B(sn(t),function(t){return _e(t,"col")})},on=function(t,e){return De(t,"table",e)},an=function(t){return Qe(t,"tr")},sn=function(t){return on(t).fold(c([]),function(t){return _e(t,"colgroup")})},ln=function(t,e){return I(t,function(t){if("colgroup"===Zt(t)){var n=I(rn(t),function(t){var e=qe(t,"span",1);return qt(t,1,e)});return Xt(t,n,"colgroup")}return n=I(nn(t),function(t){var e=qe(t,"rowspan",1),n=qe(t,"colspan",1);return qt(t,e,n)}),Xt(t,n,e(t))})},un=function(t){return se(t).map(function(t){var e=Zt(t);return T(Ut,e)?e:"tbody"}).getOr("tbody")},cn=function(t){var e=an(t),n=q(sn(t),e);return ln(n,un)},dn=function(t,e,n){var r=t.cells,i=r.slice(0,e),o=r.slice(e),a=i.concat(n).concat(o);return pn(t,a)},fn=function(t,e,n){return dn(t,e,[n])},hn=function(t,e,n){t.cells[e]=n},pn=function(t,e){return $t(e,t.section)},gn=function(t,e){var n=I(t.cells,e);return $t(n,t.section)},mn=function(t,e){return t.cells[e]},vn=function(t,e){return mn(t,e).element},yn=function(t){return t.cells.length},xn=function(t){var e=function(t,e){for(var n=[],r=[],i=0,o=t.length;i<o;i++){var a=t[i];(e(a)?n:r).push(a)}return{pass:n,fail:r}}(t,function(t){return"colgroup"===t.section});return{rows:e.fail,cols:e.pass}},bn="data-snooker-locked-cols",_n=function(t){return Le(t,bn).bind(function(t){return w.from(t.match(/\d+/g))}).map(function(t){return V(t,y)})},wn=function(t){var e,n=E(xn(t).rows,function(t,e){return D(e.cells,function(e,n){e.isLocked&&(t[n]=!0)}),t},{}),r=Ft(n,function(t,e){return parseInt(e,10)});return(e=S.call(r,0)).sort(void 0),e},Sn=function(t,e){return t+","+e},Cn=function(t,e){var n=B(t.all,function(t){return t.cells});return O(n,e)},Mn=function(t){var e={},n=[],r={},i=W(t).map(function(t){return t.element}).bind(on).bind(_n).getOr({}),o=0,a=0,s=0;return D(t,function(t){var l,u,c;"colgroup"===t.section?(u={},c=0,D(t.cells,function(t){var e=t.colspan;A(e,function(n){var r=c+n;u[r]={element:t.element,colspan:e,column:r}}),c+=e}),r=u):(l=[],D(t.cells,function(t){for(var n=0;void 0!==e[Sn(s,n)];)n++;for(var r=Gt(i,n.toString()),o={element:t.element,rowspan:t.rowspan,colspan:t.colspan,row:s,column:n,isLocked:r},u=0;u<t.colspan;u++)for(var c=0;c<t.rowspan;c++){var d=n+u,f=Sn(s+c,d);e[f]=o,a=Math.max(a,d+1)}l.push(o)}),o++,n.push(Xt(t.element,l,t.section)),s++)}),{grid:{rows:o,columns:a},access:e,all:n,columns:r}},Tn=function(t){var e=cn(t);return Mn(e)},kn=Mn,An=function(t,e,n){var r=t.access[Sn(e,n)];return void 0!==r?w.some(r):w.none()},In=function(t,e,n){var r=Cn(t,function(t){return n(e,t.element)});return 0<r.length?w.some(r[0]):w.none()},Dn=Cn,On=function(t){return B(t.all,function(t){return t.cells})},Pn=function(t){return Ft(t.columns,function(t){return t})},En=function(t){return 0<Rt(t.columns).length},Rn=function(t,e){return w.from(t.columns[e])},Ln=function(t,e){return e.column<=t.finishCol&&e.column+e.colspan-1>=t.startCol&&e.row<=t.finishRow&&e.row+e.rowspan-1>=t.startRow},Nn=function(t,e){return e.column>=t.startCol&&e.column+e.colspan-1<=t.finishCol&&e.row>=t.startRow&&e.row+e.rowspan-1<=t.finishRow},Bn=function(t,e,n){var r=In(t,e,Ot),i=In(t,n,Ot);return r.bind(function(t){return i.map(function(e){return n=t,r=e,{startRow:Math.min(n.row,r.row),startCol:Math.min(n.column,r.column),finishRow:Math.max(n.row+n.rowspan-1,r.row+r.rowspan-1),finishCol:Math.max(n.column+n.colspan-1,r.column+r.colspan-1)};var n,r})})},zn=function(t,e,n){return Bn(t,e,n).map(function(e){var n=Dn(t,f(Ln,e));return I(n,function(t){return t.element})})},Vn=function(t,e){return In(t,e,function(t,e){return Pt(e,t)}).map(function(t){return t.element})},Fn=function(t,e,n,r,i){var o=Hn(t),a=Ot(t,n)?w.some(e):Vn(o,e),s=Ot(t,i)?w.some(r):Vn(o,r);return a.bind(function(t){return s.bind(function(e){return zn(o,t,e)})})},Hn=Tn,Wn=function(t,e){se(t).each(function(n){n.dom.insertBefore(e.dom,t.dom)})},jn=function(t,e){ce(t).fold(function(){se(t).each(function(t){Un(t,e)})},function(t){Wn(t,e)})},Gn=function(t,e){fe(t,0).fold(function(){Un(t,e)},function(n){t.dom.insertBefore(e.dom,n.dom)})},Un=function(t,e){t.dom.appendChild(e.dom)},qn=function(t,e){Wn(t,e),Un(e,t)},Xn=function(t,e){D(e,function(n,r){jn(0===r?t:e[r-1],n)})},Yn=function(t,e){D(e,function(e){Un(t,e)})},$n=function(t){t.dom.textContent="",D(de(t),function(t){Zn(t)})},Zn=function(t){var e=t.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Kn=function(t){var e,n=de(t);0<n.length&&(e=t,D(n,function(t){Wn(e,t)})),Zn(t)},Jn=(Ce=ee,{get:function(t){if(!Ce(t))throw new Error("Can only get text value of a text node");return Me(t).getOr("")},getOption:Me=function(t){return Ce(t)?w.from(t.dom.nodeValue):w.none()},set:function(t,e){if(!Ce(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=e}}),Qn=function(t){return Jn.get(t)},tr=function(t){return Jn.getOption(t)},er=function(t,e){return Jn.set(t,e)},nr=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function rr(){return{up:c({selector:ke,closest:De,predicate:Te,all:le}),down:c({selector:we,predicate:xe}),styles:c({get:We,getRaw:Ge,set:Fe,remove:Ue}),attrs:c({get:Re,set:Pe,remove:Ne,copyTo:function(t,e){var n=Be(t);Ee(e,n)}}),insert:c({before:Wn,after:jn,afterAll:Xn,append:Un,appendAll:Yn,prepend:Gn,wrap:qn}),remove:c({unwrap:Kn,remove:Zn}),create:c({nu:At.fromTag,clone:function(t){return At.fromDom(t.dom.cloneNode(!1))},text:At.fromText}),query:c({comparePosition:function(t,e){return t.dom.compareDocumentPosition(e.dom)},prevSibling:ue,nextSibling:ce}),property:c({children:de,name:Zt,parent:se,document:function(t){return ae(t).dom},isText:ee,isComment:Qt,isElement:te,isSpecial:function(t){var e=Zt(t);return T(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],e)},getText:Qn,setText:er,isBoundary:function(t){return!!te(t)&&("body"===Zt(t)||T(nr,Zt(t)))},isEmptyTag:function(t){return!!te(t)&&T(["br","img","hr","input"],Zt(t))},isNonEditable:function(t){return te(t)&&"false"===Re(t,"contenteditable")}}),eq:Ot,is:Et}}var ir,or,ar,sr,lr=rr(),ur=function(t,e){return function(t,e,n){return 0<n.length?function(t,e,n,r){var i=e(t,n);return P(r,function(n,r){var i=e(t,r);return function(t,e,n){return e.bind(function(e){return n.filter(f(t.eq,e))})}(t,n,i)},i)}(t,e,(r=n)[0],r.slice(1)):w.none();var r}(lr,function(e,n){return t(n)},e)},cr=function(t){return ke(t,"table")},dr=function(t,e,n){var r=function(t){return function(e){return void 0!==n&&n(e)||Ot(e,t)}};return Ot(t,e)?w.some({boxes:w.some([t]),start:t,finish:e}):cr(t).bind(function(i){return cr(e).bind(function(o){if(Ot(i,o))return w.some({boxes:(u=t,c=e,d=Hn(i),zn(d,u,c)),start:t,finish:e});if(Pt(i,o)){var a=0<(s=be(e,"td,th",r(i))).length?s[s.length-1]:e;return w.some({boxes:Fn(i,t,i,e,o),start:t,finish:a})}if(Pt(o,i)){var s,l=0<(s=be(t,"td,th",r(o))).length?s[s.length-1]:t;return w.some({boxes:Fn(o,t,i,e,o),start:t,finish:l})}return function(t,e,n,r){void 0===r&&(r=v);var i=[e].concat(t.up().all(e)),o=[n].concat(t.up().all(n)),a=function(t){return L(t,r).fold(function(){return t},function(e){return t.slice(0,e+1)})},s=a(i),l=a(o),u=R(s,function(e){return k(l,f(t.eq,e))});return{firstpath:s,secondpath:l,shared:u}}(lr,t,e,void 0).shared.bind(function(a){return De(a,"table",n).bind(function(n){var a=be(e,"td,th",r(n)),s=0<a.length?a[a.length-1]:e,l=be(t,"td,th",r(n)),u=0<l.length?l[l.length-1]:t;return w.some({boxes:Fn(n,t,i,e,o),start:u,finish:s})})});var u,c,d})})},fr=function(t,e){var n=we(t,e);return 0<n.length?w.some(n):w.none()},hr=function(t,e,n){return Ie(t,e).bind(function(e){return Ie(t,n).bind(function(t){return ur(cr,[e,t]).map(function(n){return{first:e,last:t,table:n}})})})},pr=fr,gr=function(t){if(!i(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],n={};return D(t,function(r,o){var a=Rt(r);if(1!==a.length)throw new Error("one and only one name per case");var s=a[0],l=r[s];if(void 0!==n[s])throw new Error("duplicate key detected:"+s);if("cata"===s)throw new Error("cannot have a case named cata (sorry)");if(!i(l))throw new Error("case arguments must be an array");e.push(s),n[s]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.length;if(i!==l.length)throw new Error("Wrong number of arguments to case "+s+". Expected "+l.length+" ("+l+"), got "+i);return{fold:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+e.length);return e[o].apply(null,n)},match:function(t){var r=Rt(t);if(e.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+r.join(","));if(!z(e,function(t){return T(r,t)}))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+e.join(", "));return t[s].apply(null,n)},log:function(t){console.log(t,{constructors:e,constructor:s,params:n})}}}}),n},mr=gr([{none:[]},{multiple:["elements"]},{single:["element"]}]),vr=function(t,e,n,r){return t.fold(e,n,r)},yr=mr.none,xr=mr.multiple,br=mr.single,_r=tinymce.util.Tools.resolve("tinymce.PluginManager"),wr=function(t,e){return At.fromDom(t.dom.cloneNode(e))},Sr=function(t){return wr(t,!1)},Cr=function(t){return wr(t,!0)},Mr=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},Tr=function(t,e){return t?w.some(e):w.none()},kr=function(t,e){var n=function(n){var r=e(n);if(r<=0||null===r){var i=We(n,t);return parseFloat(i)||0}return r},r=function(t,e){return E(e,function(e,n){var r=We(t,n),i=void 0===r?0:parseInt(r,10);return isNaN(i)?e:e+i},0)};return{set:function(e,n){if(!l(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);var r=e.dom;ze(r)&&(r.style[t]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(t,e,n){var i=r(t,n);return i<e?e-i:0}}},Ar=kr("width",function(t){return t.dom.offsetWidth}),Ir=function(t){return Ar.get(t)},Dr=function(t){return Ar.getOuter(t)},Or=function(t,e){void 0===e&&(e=y);var n=t.grid,r=A(n.columns,d),i=A(n.rows,d);return I(r,function(n){return Pr(function(){return B(i,function(e){return An(t,e,n).filter(function(t){return t.column===n}).toArray()})},function(t){return 1===t.colspan&&e(t.element)},function(){return An(t,0,n)})})},Pr=function(t,e,n){var r=t();return R(r,e).orThunk(function(){return w.from(r[0]).orThunk(n)}).map(function(t){return t.element})},Er=function(t){var e=t.grid,n=A(e.rows,d),r=A(e.columns,d);return I(n,function(e){return Pr(function(){return B(r,function(n){return An(t,e,n).filter(function(t){return t.row===e}).fold(c([]),function(t){return[t]})})},function(t){return 1===t.rowspan},function(){return An(t,e,0)})})},Rr=function(t,e){return function(n){return"rtl"===Lr(n)?e:t}},Lr=function(t){return"rtl"===We(t,"direction")?"rtl":"ltr"},Nr=kr("height",function(t){var e=t.dom;return ve(t)?e.getBoundingClientRect().height:e.offsetHeight}),Br=function(t){return Nr.get(t)},zr=function(t){return Nr.getOuter(t)},Vr=function(t,e){return{left:t,top:e,translate:function(n,r){return Vr(t+n,e+r)}}},Fr=Vr,Hr=function(t,e){return void 0!==t?t:void 0!==e?e:0},Wr=function(t){var e=t.dom.ownerDocument,n=e.body,r=e.defaultView,i=e.documentElement;if(n===t.dom)return Fr(n.offsetLeft,n.offsetTop);var o=Hr(null==r?void 0:r.pageYOffset,i.scrollTop),a=Hr(null==r?void 0:r.pageXOffset,i.scrollLeft),s=Hr(i.clientTop,n.clientTop),l=Hr(i.clientLeft,n.clientLeft);return jr(t).translate(a-l,o-s)},jr=function(t){var e,n=t.dom,r=n.ownerDocument.body;return r===n?Fr(r.offsetLeft,r.offsetTop):ve(t)?(e=n.getBoundingClientRect(),Fr(e.left,e.top)):Fr(0,0)},Gr=function(t,e){return{row:t,y:e}},Ur=function(t,e){return{col:t,x:e}},qr=function(t){return Wr(t).left+Dr(t)},Xr=function(t){return Wr(t).left},Yr=function(t,e){return Ur(t,Xr(e))},$r=function(t,e){return Ur(t,qr(e))},Zr=function(t){return Wr(t).top},Kr=function(t,e){return Gr(t,Zr(e))},Jr=function(t,e){return Gr(t,Zr(e)+zr(e))},Qr=function(t,e,n){if(0===n.length)return[];var r=I(n.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),i=n[n.length-1].map(function(t){return e(n.length-1,t)});return r.concat([i])},ti={delta:d,positions:function(t){return Qr(Kr,Jr,t)},edge:Zr},ei=Rr({delta:d,edge:Xr,positions:function(t){return Qr(Yr,$r,t)}},{delta:function(t){return-t},edge:qr,positions:function(t){return Qr($r,Yr,t)}}),ni={delta:function(t,e){return ei(e).delta(t,e)},positions:function(t,e){return ei(e).positions(t,e)},edge:function(t){return ei(t).edge(t)}},ri={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},ii=(or="[eE][+-]?[0-9]+",sr=["Infinity",(ir="[0-9]+")+"\\."+(ar=function(t){return"(?:"+t+")?"})(ir)+ar(or),"\\."+ir+ar(or),ir+ar(or)].join("|"),new RegExp("^([+-]?(?:"+sr+"))(.*)$")),oi=function(){var t=Tt().browser;return t.isIE()||t.isEdge()},ai=function(t,e,n){return r=We(t,e),i=n,o=parseFloat(r),isNaN(o)?i:o;var r,i,o},si=function(t){return oi()?(n=(e=t).dom.getBoundingClientRect().width,"border-box"===We(e,"box-sizing")?n:n-ai(e,"padding-left",0)-ai(e,"padding-right",0)-(ai(e,"border-left-width",0)+ai(e,"border-right-width",0))):ai(t,"width",Ir(t));var e,n},li=/(\d+(\.\d+)?)%/,ui=/(\d+(\.\d+)?)px|em/,ci=function(t,e){Fe(t,"width",e+"px")},di=function(t,e){Fe(t,"width",e+"%")},fi=function(t,e){Fe(t,"height",e+"px")},hi=function(t){return Ge(t,"width").fold(function(){return w.from(Re(t,"width"))},function(t){return w.some(t)})},pi=function(t,e){return t/e.pixelWidth()*100},gi=function(t,e){return hi(t).fold(function(){var n=Ir(t);return pi(n,e)},function(n){return function(t,e,n){var r=li.exec(e);if(null!==r)return parseFloat(r[1]);var i=si(t);return pi(i,n)}(t,n,e)})},mi=function(t,e){return hi(t).fold(function(){return si(t)},function(n){return function(t,e,n){var r=ui.exec(e);if(null!==r)return parseInt(r[1],10);var i=li.exec(e);return null===i?si(t):parseFloat(i[1])/100*n.pixelWidth()}(t,n,e)})},vi=function(t){return function(t){var e,n=Ge(e=t,"height").getOrThunk(function(){return function(t){return oi()?(n=(e=t).dom.getBoundingClientRect().height,"border-box"===We(e,"box-sizing")?n:n-ai(e,"padding-top",0)-ai(e,"padding-bottom",0)-(ai(e,"border-top-width",0)+ai(e,"border-bottom-width",0))):ai(t,"height",Br(t));var e,n}(e)+"px"});return n?function(t,e,n,r){var i,o,a,s,l,u=parseInt(t,10);return rt(t,"%")&&"table"!==Zt(e)?(o=u,a=n,s=r,l=on(i=e).map(function(t){var e=a(t);return Math.floor(o/100*e)}).getOr(o),s(i,l),l):u}(n,t,Br,fi):Br(t)}(e=t)/Xe(e,"rowspan");var e},yi=function(t,e,n){Fe(t,"width",e+n)},xi=function(t){return function(t,e){var n=w.from(t.dom.offsetParent).map(At.fromDom).getOr(ye(oe(t)));return e(t)/e(n)*100}(t,Ir)+"%"},bi=c(li),_i=c(ui),wi=ie("col"),Si=function(t,e,n){return Ge(t,e).fold(function(){return n(t)+"px"},function(t){return t})},Ci=function(t,e){return Si(t,"width",function(t){return wi(t)?Ir(t):mi(t,e)})},Mi=function(t){return Si(t,"height",vi)},Ti=function(t,e){return Ge(t,e).isSome()},ki=function(t,e,n,r,i,o){return t.filter(r).fold(function(){return o(function(t,e){if(e<0||e>=t.length-1)return w.none();var n=t[e].fold(function(){var n,r,i=(n=t.slice(0,e),(r=S.call(n,0)).reverse(),r);return G(i,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return w.some({value:t,delta:0})}),r=t[e+1].fold(function(){var n=t.slice(e+1);return G(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return w.some({value:t,delta:1})});return n.bind(function(t){return r.map(function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n})})}(n,e))},function(t){return i(t)})},Ai=function(t,e,n,r,i){var o=Or(t,function(t){return Ti(t,"width")}),a=En(t)?I(Pn(t),function(t){return w.from(t.element)}):o,s=[w.some(ni.edge(e))].concat(I(ni.positions(o,e),function(t){return t.map(function(t){return t.x})})),l=m(Ye);return I(a,function(t,e){return ki(t,e,s,l,function(t){if(!wi(u=t)||Ti(u,"width"))return n(t,i);var a,u,c=null!=(a=o[e])?a:w.none();return ki(c,e,s,l,function(t){return r(w.some(Ir(t)))},r)},r)})},Ii=function(t){return t.map(function(t){return t+"px"}).getOr("")},Di=function(t,e,n){return Ai(t,e,mi,function(t){return t.getOrThunk(n.minCellWidth)},n)},Oi=function(t,e,n,r,i){var o=Er(t),a=[w.some(n.edge(e))].concat(I(n.positions(o,e),function(t){return t.map(function(t){return t.y})}));return I(o,function(t,e){return ki(t,e,a,m($e),r,i)})},Pi=function(t){var e=t;return{get:function(){return e},set:function(t){e=t}}},Ei=function(t,e){var n=Pi(parseFloat(t)),r=Pi(Ir(e));return{width:n.get,pixelWidth:r.get,getWidths:function(t,n){return Ai(t,e,gi,function(t){return t.fold(function(){return r.minCellWidth()},function(t){return t/r.pixelWidth()*100})},r=n);var r},getCellDelta:function(t){return t/r.get()*100},singleColumnWidth:function(t,e){return[100-t]},minCellWidth:function(){return Ke()/r.get()*100},setElementWidth:di,adjustTableWidth:function(t){var i=n.get(),o=i+t/100*i;di(e,o),n.set(o),r.set(Ir(e))},isRelative:!0,label:"percent"}},Ri=function(t,e){var n=Pi(t),r=n.get;return{width:r,pixelWidth:r,getWidths:function(t,n){return Di(t,e,n)},getCellDelta:d,singleColumnWidth:function(t,e){return[Math.max(Ke(),t+e)-t]},minCellWidth:Ke,setElementWidth:ci,adjustTableWidth:function(t){var i=r()+t;ci(e,i),n.set(i)},isRelative:!1,label:"pixel"}},Li=function(t){return hi(t).fold(function(){return function(t){var e=function(){return Ir(t)},n=c(0);return{width:e,pixelWidth:e,getWidths:function(e,n){return Di(e,t,n)},getCellDelta:n,singleColumnWidth:c([0]),minCellWidth:n,setElementWidth:u,adjustTableWidth:u,isRelative:!0,label:"none"}}(t)},function(e){return function(t,e){var n=bi().exec(e);if(null!==n)return Ei(n[1],t);var r=_i().exec(e);if(null!==r){var i=parseInt(r[1],10);return Ri(i,t)}var o=Ir(t);return Ri(o,t)}(t,e)})},Ni=Ri,Bi=Ei,zi=function(t){return"img"===Zt(t)?1:tr(t).fold(function(){return de(t).length},function(t){return t.length})},Vi=["img","br"],Fi=function(t){return tr(t).filter(function(t){return 0!==t.trim().length||-1<t.indexOf(" ")}).isSome()||T(Vi,Zt(t))},Hi=function(t){return e=Fi,(n=function(t){for(var r=0;r<t.childNodes.length;r++){var i=At.fromDom(t.childNodes[r]);if(e(i))return w.some(i);var o=n(t.childNodes[r]);if(o.isSome())return o}return w.none()})(t.dom);var e,n},Wi=function(t){return ji(t,Fi)},ji=function(t,e){var n=function(t){for(var r=de(t),i=r.length-1;0<=i;i--){var o=r[i];if(e(o))return w.some(o);var a=n(o);if(a.isSome())return a}return w.none()};return n(t)},Gi={scope:["row","col"]},Ui=function(){var t=At.fromTag("td");return Un(t,At.fromTag("br")),t},qi=function(){return At.fromTag("col")},Xi=function(){return At.fromTag("colgroup")},Yi=function(t,e,n){var r=function(t,e){var n,r,i,o=(n=t,r=At.fromTag(e),i=Be(n),Ee(r,i),r),a=de(Cr(t));return Yn(o,a),o}(t,e);return Nt(n,function(t,e){null===t?Ne(r,e):Pe(r,e,t)}),r},$i=function(t){return t},Zi=function(t){return function(){return At.fromTag("tr",t.dom)}},Ki=function(t,e,n){var r=function(t,e){var n,r;r=e.dom,ze(n=t.element.dom)&&ze(r)&&(r.style.cssText=n.style.cssText),Ue(e,"height"),1!==t.colspan&&Ue(e,"width")};return{col:function(e){var n=oe(e.element),i=At.fromTag(Zt(e.element),n.dom);return r(e,i),t(e.element,i),i},colgroup:Xi,row:Zi(e),cell:function(e){var i,o,a,s,l,u=oe(e.element),c=At.fromTag(Zt(e.element),u.dom),d=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),f=0<d.length?(o=c,a=d,Hi(i=e.element).map(function(t){var e=a.join(","),n=be(t,e,function(t){return Ot(t,i)});return P(n,function(t,e){var n=Sr(e);return Ne(n,"contenteditable"),Un(t,n),n},o)}).getOr(o)):c;return Un(f,At.fromTag("br")),r(e,c),s=e.element,l=c,Nt(Gi,function(t,e){return Le(s,e).filter(function(e){return T(t,e)}).each(function(t){return Pe(l,e,t)})}),t(e.element,c),c},replace:Yi,gap:Ui}},Ji=function(t){return{col:qi,colgroup:Xi,row:Zi(t),cell:Ui,replace:$i,gap:Ui}},Qi=function(t){return I(t,At.fromDom)},to=function(t){return t.nodeName.toLowerCase()},eo=function(t){return At.fromDom(t.getBody())},no=function(t){return t.getBoundingClientRect().width},ro=function(t){return t.getBoundingClientRect().height},io=function(t){return function(e){return Ot(e,eo(t))}},oo=function(t){return/^\d+(\.\d+)?$/.test(t)?t+"px":t},ao=function(t){Ne(t,"data-mce-style");var e=function(t){return Ne(t,"data-mce-style")};D(nn(t),e),D(rn(t),e)},so=function(t,e){var n=t.dom.getStyle(e,"width")||t.dom.getAttrib(e,"width");return w.from(n).filter(ot)},lo=function(t){return/^(\d+(\.\d+)?)%$/.test(t)},uo=function(t){return At.fromDom(t.selection.getStart())},co=function(t){return vr(t.get(),c([]),d,F)},fo={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},ho=function(t,e,n){return{element:n,mergable:(o=e,a=fo,vr(t.get(),w.none,function(t){return t.length<=1?w.none():function(t,e,n){return hr(t,e,n).bind(function(e){var n=function(e){return Ot(t,e)},r="thead,tfoot,tbody,table",i=ke(e.first,r,n),o=ke(e.last,r,n);return i.bind(function(t){return o.bind(function(n){return Ot(t,n)?(r=e.first,i=e.last,function(t,e,n){return Bn(t,e,n).bind(function(e){return function(t,e){for(var n=!0,r=f(Nn,e),i=e.startRow;i<=e.finishRow;i++)for(var o=e.startCol;o<=e.finishCol;o++)n=n&&An(t,i,o).exists(r);return n?w.some(e):w.none()}(t,e)})}(Hn(e.table),r,i)):w.none();var r,i})})})}(o,a.firstSelectedSelector,a.lastSelectedSelector).map(function(e){return{bounds:e,cells:t}})},w.none)),unmergable:(r=function(t,e){return Le(t,e).exists(function(t){return 1<parseInt(t,10)})},0<(i=co(t)).length&&z(i,function(t){return r(t,"rowspan")||r(t,"colspan")})?w.some(i):w.none()),selection:co(t)};var r,i,o,a},po=gr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),go=U({},po),mo=function(t,e,n){for(var r=0,i=t;i<e;i++)r+=void 0!==n[i]?n[i]:0;return r},vo=function(t,e,n){var r=function(t,e){return En(t)?(i=e,o=Pn(t),I(o,function(t,e){return{element:t.element,width:i[e],colspan:t.colspan}})):(n=e,r=On(t),I(r,function(t){var e=mo(t.column,t.column+t.colspan,n);return{element:t.element,width:e,colspan:t.colspan}}));var n,r,i,o}(t,e);D(r,function(t){n.setElementWidth(t.element,t.width)})},yo=function(t,e,n,r,i){var o=Tn(t),a=i.getCellDelta(e),s=i.getWidths(o,i),l=n===o.grid.columns-1,u=r.clampTableDelta(s,n,a,i.minCellWidth(),l),d=function(t,e,n,r,i){var o,a,s=t.slice(0),l=(a=e,0===(o=t).length?go.none():1===o.length?go.only(0):0===a?go.left(0,1):a===o.length-1?go.right(a-1,a):0<a&&a<o.length-1?go.middle(a-1,a,a+1):go.none()),u=c(I(s,c(0)));return l.fold(u,function(t){return r.singleColumnWidth(s[t],n)},function(t,e){return i.calcLeftEdgeDeltas(s,t,e,n,r.minCellWidth(),r.isRelative)},function(t,e,o){return i.calcMiddleDeltas(s,t,e,o,n,r.minCellWidth(),r.isRelative)},function(t,e){return i.calcRightEdgeDeltas(s,t,e,n,r.minCellWidth(),r.isRelative)})}(s,n,u,i,r),f=I(d,function(t,e){return t+s[e]});vo(o,f,i),r.resizeTable(i.adjustTableWidth,u,l)},xo=function(t){return I(t,c(0))},bo=function(t,e,n,r,i){return i(t.slice(0,e)).concat(r).concat(i(t.slice(n)))},_o=function(t){return function(e,n,r,i){if(t(r)){var o=Math.max(i,e[n]-Math.abs(r)),a=Math.abs(o-e[n]);return 0<=r?a:-a}return r}},wo=_o(function(t){return t<0}),So=_o(y),Co=function(){var t=function(t,e,n,r){var i=(100+n)/100,o=Math.max(r,(t[e]+n)/i);return I(t,function(t,n){return(n===e?o:t/i)-t})},e=function(e,n,r,i,o,a){return a?t(e,n,i,o):(u=r,c=wo(s=e,l=n,i,o),bo(s,l,u+1,[c,0],xo));var s,l,u,c};return{resizeTable:function(t,e){return t(e)},clampTableDelta:wo,calcLeftEdgeDeltas:e,calcMiddleDeltas:function(t,n,r,i,o,a,s){return e(t,r,i,o,a,s)},calcRightEdgeDeltas:function(e,n,r,i,o,a){if(a)return t(e,r,i,o);var s=wo(e,r,i,o);return xo(e.slice(0,r)).concat([s])},calcRedestributedWidths:function(t,e,n,r){if(r){var i=(e+n)/e,o=I(t,function(t){return t/i});return{delta:100*i-100,newSizes:o}}return{delta:n,newSizes:t}}}},Mo=function(){var t=function(t,e,n,r,i){var o=So(t,0<=r?n:e,r,i);return bo(t,e,n+1,[o,-o],xo)};return{resizeTable:function(t,e,n){n&&t(e)},clampTableDelta:function(t,e,n,r,i){if(i){if(0<=n)return n;var o=E(t,function(t,e){return t+e-r},0);return Math.max(-o,n)}return wo(t,e,n,r)},calcLeftEdgeDeltas:t,calcMiddleDeltas:function(e,n,r,i,o,a){return t(e,r,i,o,a)},calcRightEdgeDeltas:function(t,e,n,r,i,o){return o?xo(t):I(t,c(r/t.length))},calcRedestributedWidths:function(t,e,n,r){return{delta:0,newSizes:t}}}},To=function(t,e){var n=w.from(t.dom.documentElement).map(At.fromDom).getOr(t);return{parent:c(n),view:c(t),origin:c(Fr(0,0)),isResizable:e}},ko=gr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Ao=function(t,e,n){var r=n.substring(0,n.length-t.length),i=parseFloat(r);return r===i.toString()?e(i):ko.invalid(n)},Io=U(U({},ko),{from:function(t){return rt(t,"%")?Ao("%",ko.percent,t):rt(t,"px")?Ao("px",ko.pixels,t):ko.invalid(t)}}),Do=function(t,e,n){var r,i,o=Io.from(n),a=z(t,function(t){return"0px"===t})?(r=t.length,i=o.fold(function(){return c("")},function(t){return c(t/r+"px")},function(){return c(100/r+"%")}),A(r,i)):function(t,e,n){return t.fold(function(){return e},function(t){return i=(r=t)/n,I(e,function(t){return Io.from(t).fold(function(){return t},function(t){return t*i+"px"},function(t){return t/100*r+"px"})});var r,i},function(t){return r=n,I(e,function(t){return Io.from(t).fold(function(){return t},function(t){return t/r*100+"%"},function(t){return t+"%"})});var r})}(o,t,e);return Po(a)},Oo=function(t,e){return 0===t.length?e:P(t,function(t,e){return Io.from(e).fold(c(0),d,d)+t},0)},Po=function(t){if(0===t.length)return t;var e,n,r=P(t,function(t,e){var n=Io.from(e).fold(function(){return{value:e,remainder:0}},function(t){return e=t,{value:(n=Math.floor(e))+"px",remainder:e-n};var e,n},function(t){return{value:t+"%",remainder:0}});return{output:[n.value].concat(t.output),remainder:t.remainder+n.remainder}},{output:[],remainder:0}),i=r.output;return i.slice(0,i.length-1).concat([(e=i[i.length-1],n=Math.round(r.remainder),Io.from(e).fold(c(e),function(t){return t+n+"px"},function(t){return t+n+"%"}))])},Eo=Io.from,Ro=function(t){return Eo(t).fold(c("px"),c("px"),c("%"))},Lo=function(t,e,n,r){var i=Tn(t),o=i.all,a=On(i),s=Pn(i);e.each(function(e){var n,o,l,u,c=Ro(e),d=Ir(t),f=Ai(i,t,Ci,Ii,r),h=Do(f,d,e);En(i)?(l=h,u=c,D(s,function(t,e){var n=Oo([l[e]],Ke());Fe(t.element,"width",n+u)})):(n=h,o=c,D(a,function(t){var e=n.slice(t.column,t.colspan+t.column),r=Oo(e,Ke());Fe(t.element,"width",r+o)})),Fe(t,"width",e)}),n.each(function(e){var n,r,s,l=Ro(e),u=Br(t),c=Oi(i,t,ti,Mi,Ii),d=Do(c,u,e);n=d,r=o,s=l,D(a,function(t){var e=n.slice(t.row,t.rowspan+t.row),r=Oo(e,Je());Fe(t.element,"height",r+s)}),D(r,function(t,e){Fe(t.element,"height",n[e])}),Fe(t,"height",e)})},No=function(t){return hi(t).exists(function(t){return li.test(t)})},Bo=function(t){return hi(t).exists(function(t){return ui.test(t)})},zo=function(t){return hi(t).isNone()},Vo=xi,Fo=function(t){return Tn(t).grid},Ho=function(t){var e=[];return{bind:function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");e.push(t)},unbind:function(t){e=O(e,function(e){return e!==t})},trigger:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={};D(t,function(t,e){i[t]=n[e]}),D(e,function(t){t(i)})}}},Wo=function(t){return{registry:Bt(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:Bt(t,function(t){return t.trigger})}},jo=function(t){return t.slice(0).sort()},Go=function(t,e){var n=O(e,function(e){return!T(t,e)});0<n.length&&function(t){throw new Error("Unsupported keys for object: "+jo(t).join(", "))}(n)},Uo=function(t){return function(t,e,r){if(0===e.length)throw new Error("You must specify at least one required field.");var o;return function(t,e){if(!i(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");D(e,function(e){if(!n(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")})}("required",e),o=jo(e),R(o,function(t,e){return e<o.length-1&&t===o[e+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+o.join(", ")+"].")}),function(n){var i=Rt(n);z(e,function(t){return T(i,t)})||function(t,e){throw new Error("All required keys ("+jo(t).join(", ")+") were not specified. Specified keys were: "+jo(e).join(", ")+".")}(e,i),t(e,i);var o=O(e,function(t){return!r.validate(n[t],t)});return 0<o.length&&function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+jo(t).join(", ")+") were not.")}(o,r.label),n}}(Go,t,{validate:s,label:"function"})},qo=Uo(["compare","extract","mutate","sink"]),Xo=Uo(["element","start","stop","destroy"]),Yo=Uo(["forceDrop","drop","move","delayDrop"]),$o=function(t){var e,n,r=At.fromDom(function(t){if(pe()&&a(t.target)){var e=At.fromDom(t.target);if(te(e)&&function(t){return a(t.dom.shadowRoot)}(e)&&t.composed&&t.composedPath){var n=t.composedPath();if(n)return W(n)}}return w.from(t.target)}(t).getOr(t.target)),i=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},s=(e=o,n=i,function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e(n.apply(null,t))});return{target:r,x:t.clientX,y:t.clientY,stop:i,prevent:o,kill:s,raw:t}},Zo=function(t,e,n,r){t.dom.removeEventListener(e,n,r)},Ko=y,Jo=function(t,e,n){return function(t,e,n,r,i){var o,a,s=(o=n,a=r,function(t){o(t)&&a($o(t))});return t.dom.addEventListener(e,s,!1),{unbind:f(Zo,t,e,s,!1)}}(t,e,Ko,n)},Qo=$o,ta=function(t){return void 0!==t.dom.classList},ea=function(t,e){ta(t)?t.dom.classList.add(e):function(t,e){return r=e,i=function(t,e){var n=Re(t,"class");return void 0===n||""===n?[]:n.split(" ")}(n=t).concat([r]),Pe(n,"class",i.join(" ")),!0;var n,r,i}(t,e)},na=function(t,e){return ta(t)&&t.dom.classList.contains(e)},ra=function(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}},ia=ra("ephox-dragster").resolve,oa=qo({compare:function(t,e){return Fr(e.left-t.left,e.top-t.top)},extract:function(t){return w.some(Fr(t.x,t.y))},sink:function(t,e){var n=function(t){var e=U({layerClass:ia("blocker")},t),n=At.fromTag("div");return Pe(n,"role","presentation"),He(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ea(n,ia("blocker")),ea(n,e.layerClass),{element:function(){return n},destroy:function(){Zn(n)}}}(e),r=Jo(n.element(),"mousedown",t.forceDrop),i=Jo(n.element(),"mouseup",t.drop),o=Jo(n.element(),"mousemove",t.move),a=Jo(n.element(),"mouseout",t.delayDrop);return Xo({element:n.element,start:function(t){Un(t,n.element())},stop:function(){Zn(n.element())},destroy:function(){n.destroy(),i.unbind(),o.unbind(),a.unbind(),r.unbind()}})},mutate:function(t,e){t.mutate(e.left,e.top)}}),aa=function(t){return"true"===Re(t,"contenteditable")},sa=ra("ephox-snooker").resolve,la=sa("resizer-bar"),ua=sa("resizer-rows"),ca=sa("resizer-cols"),da=function(t){var e=we(t.parent(),"."+la);D(e,Zn)},fa=function(t,e,n){var r=t.origin();D(e,function(e){e.each(function(e){var i=n(r,e);ea(i,la),Un(t.parent(),i)})})},ha=function(t,e){var n;da(t),t.isResizable(e)&&function(t,e,n,r,i){var o,a=Wr(n),s=e.isResizable,l=0<r.length?ti.positions(r,n):[],u=0<l.length?(o=s,B(t.all,function(t,e){return o(t.element)?[e]:[]})):[];!function(t,e,n,r){fa(t,e,function(t,e){var i,o,a,s,l,u=(i=e.row,o=n.left-t.left,a=e.y-t.top,s=r,l=At.fromTag("div"),He(l,{position:"absolute",left:o+"px",top:a-3.5+"px",height:"7px",width:s+"px"}),Ee(l,{"data-row":i,role:"presentation"}),l);return ea(u,ua),u})}(e,O(l,function(t,e){return k(u,function(t){return e===t})}),a,Dr(n));var c,d,f,h=0<i.length?ni.positions(i,n):[],p=0<h.length?(d=s,f=[],A((c=t).grid.columns,function(t){Rn(c,t).map(function(t){return t.element}).forall(d)&&f.push(t)}),O(f,function(t){var e=Dn(c,function(e){return e.column===t});return z(e,function(t){return d(t.element)})})):[];!function(t,e,n,r){fa(t,e,function(t,e){var i,o,a,s,l,u=(i=e.col,o=e.x-t.left,a=n.top-t.top,s=r,l=At.fromTag("div"),He(l,{position:"absolute",left:o-3.5+"px",top:a+"px",height:s+"px",width:"7px"}),Ee(l,{"data-column":i,role:"presentation"}),l);return ea(u,ca),u})}(e,O(h,function(t,e){return k(p,function(t){return e===t})}),a,zr(n))}(n=Tn(e),t,e,Er(n),Or(n))},pa=function(t,e){var n=we(t.parent(),"."+la);D(n,e)},ga=function(t){pa(t,function(t){Fe(t,"display","none")})},ma=function(t){pa(t,function(t){Fe(t,"display","block")})},va=sa("resizer-bar-dragging"),ya=function(t,e){return t.fire("newrow",{node:e})},xa=function(t,e){return t.fire("newcell",{node:e})},ba=function(t,e,n){t.fire("TableModified",U(U({},n),{table:e}))},_a={structure:!1,style:!0},wa={structure:!0,style:!1},Sa={"border-collapse":"collapse",width:"100%"},Ca={border:"1"},Ma="preservetable",Ta=function(t){return t.getParam("table_sizing_mode","auto")},ka=function(t){return t.getParam("table_responsive_width")},Aa=function(t){return t.getParam("table_default_attributes",Ca,"object")},Ia=function(t){return t.getParam("table_default_styles",function(t){if(La(t)){var e=t.getBody().offsetWidth;return U(U({},Sa),{width:e+"px"})}return Na(t)?Vt(Sa,function(t,e){return"width"!==e}):Sa}(t),"object")},Da=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},Oa=function(t){return t.getParam("table_row_advtab",!0,"boolean")},Pa=function(t){return t.getParam("table_advtab",!0,"boolean")},Ea=function(t){return t.getParam("table_style_by_css",!1,"boolean")},Ra=function(t){return"relative"===Ta(t)||!0===ka(t)},La=function(t){return"fixed"===Ta(t)||!1===ka(t)},Na=function(t){return"responsive"===Ta(t)},Ba=function(t){var e="section",n=t.getParam("table_header_type",e,"string");return T(["section","cells","sectionCells","auto"],n)?n:e},za=function(t){var e=t.getParam("table_column_resizing",Ma,"string");return R(["preservetable","resizetable"],function(t){return t===e}).getOr(Ma)},Va=function(t){return"preservetable"===za(t)},Fa=function(t){return"resizetable"===za(t)},Ha=function(t){var e=t.getParam("table_clone_elements");return n(e)?w.some(e.split(/[ ,]/)):Array.isArray(e)?w.some(e):w.none()},Wa=function(t,e){if(Ra(t)){var n=so(t,e.dom).filter(lo).getOrThunk(function(){return Vo(e)});return Bi(n,e)}return La(t)?Ni(Ir(e),e):Li(e)},ja=function(t){Ne(t,"width")},Ga=function(t,e){var n,r,i;r=Wa(t,e),i=xi(n=e),Lo(n,w.some(i),w.none(),r),ja(n)},Ua=function(t,e){!function(t,e){var n=Ir(t)+"px";Lo(t,w.some(n),w.none(),e),ja(t)}(e,Wa(t,e))},qa=function(t){Ue(t,"width");var e=rn(t),n=0<e.length?e:nn(t);D(n,function(t){Ue(t,"width"),ja(t)}),ja(t)},Xa="bar-",Ya=function(t){return"false"!==Re(t,"data-mce-resize")},$a=function(t){var e,r,i=w.none(),o=w.none(),a=w.none(),s=function(t){return"TABLE"===t.nodeName},l=function(e){return Wa(t,e)},d=function(){return(Va(t)?Mo:Co)()};return t.on("init",function(){var e,r,s,h,p=(r=Ya,(e=t).inline?function(t,e,n){return{parent:c(e),view:c(t),origin:c(Fr(0,0)),isResizable:n}}(eo(e),function(){var t=At.fromTag("div");return He(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Un(ye(At.fromDom(document)),t),t}(),r):To(At.fromDom(e.getDoc()),r));a=w.some(p),h=t.getParam("object_resizing",!0),(n(h)?"table"===h:h)&&t.getParam("table_resize_bars",!0,"boolean")&&((s=function(t,e,n){var r=ti,i=ni,o=function(t){var e=function(){var t,e=Wo({drag:Ho(["xDelta","yDelta","target"])}),n=w.none(),r={mutate:function(e,n){t.trigger.drag(e,n)},events:(t=Wo({drag:Ho(["xDelta","yDelta"])})).registry};return r.events.drag.bind(function(t){n.each(function(n){e.trigger.drag(t.xDelta,t.yDelta,n)})}),{assign:function(t){n=w.some(t)},get:function(){return n},mutate:r.mutate,events:e.registry}}(),n=function(t,e){return void 0===e&&(e={}),function(t,e,n){var r,i,o=!1,a=Wo({start:Ho([]),stop:Ho([])}),s=function(){var t,e=(t=Wo({move:Ho(["info"])}),{onEvent:u,reset:u,events:t.registry}),n=function(){var t=w.none(),e=Wo({move:Ho(["info"])});return{onEvent:function(n,r){r.extract(n).each(function(n){var i,o,a;(i=r,o=n,a=t.map(function(t){return i.compare(t,o)}),t=w.some(o),a).each(function(t){e.trigger.move(t)})})},reset:function(){t=w.none()},events:e.registry}}(),r=e;return{on:function(){r.reset(),r=n},off:function(){r.reset(),r=e},isOn:function(){return r===n},onEvent:function(t,e){r.onEvent(t,e)},events:n.events}}(),l=function(){f.stop(),s.isOn()&&(s.off(),a.trigger.stop())},c=(r=l,i=null,{cancel:function(){null!==i&&(clearTimeout(i),i=null)},throttle:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];null!==i&&clearTimeout(i),i=setTimeout(function(){r.apply(null,t),i=null},200)}});s.events.move.bind(function(n){e.mutate(t,n.info)});var d=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];o&&t.apply(null,e)}},f=e.sink(Yo({forceDrop:l,drop:d(l),move:d(function(t){c.cancel(),s.onEvent(t,e)}),delayDrop:d(c.throttle)}),n);return{element:f.element,go:function(t){f.start(t),s.on(),a.trigger.start()},on:function(){o=!0},off:function(){o=!1},destroy:function(){f.destroy()},events:a.registry}}(t,void 0!==e.mode?e.mode:oa,e)}(e,{}),r=w.none(),i=function(t,e){return w.from(Re(t,e))};e.events.drag.bind(function(t){i(t.target,"data-row").each(function(e){var n=Ze(t.target,"top");Fe(t.target,"top",n+t.yDelta+"px")}),i(t.target,"data-column").each(function(e){var n=Ze(t.target,"left");Fe(t.target,"left",n+t.xDelta+"px")})});var o=function(t,e){return Ze(t,e)-qe(t,"data-initial-"+e,0)};n.events.stop.bind(function(){e.get().each(function(e){r.each(function(n){i(e,"data-row").each(function(t){var r=o(e,"top");Ne(e,"data-initial-top"),d.trigger.adjustHeight(n,r,parseInt(t,10))}),i(e,"data-column").each(function(t){var r=o(e,"left");Ne(e,"data-initial-left"),d.trigger.adjustWidth(n,r,parseInt(t,10))}),ha(t,n)})})});var a=function(r,i){d.trigger.startAdjust(),e.assign(r),Pe(r,"data-initial-"+i,Ze(r,i)),ea(r,va),Fe(r,"opacity","0.2"),n.go(t.parent())},s=Jo(t.parent(),"mousedown",function(t){na(t.target,ua)&&a(t.target,"top"),na(t.target,ca)&&a(t.target,"left")}),l=function(e){return Ot(e,t.view())},c=Jo(t.view(),"mouseover",function(e){(function(t){return De(t,"table",l).filter(function(t){return De(t,"[contenteditable]",l).exists(aa)})})(e.target).fold(function(){ve(e.target)&&da(t)},function(e){r=w.some(e),ha(t,e)})}),d=Wo({adjustHeight:Ho(["table","delta","row"]),adjustWidth:Ho(["table","delta","column"]),startAdjust:Ho([])});return{destroy:function(){s.unbind(),c.unbind(),n.destroy(),da(t)},refresh:function(e){ha(t,e)},on:n.on,off:n.off,hideBars:f(ga,t),showBars:f(ma,t),events:d.registry}}(t),a=Wo({beforeResize:Ho(["table","type"]),afterResize:Ho(["table","type"]),startDrag:Ho([])});return o.events.adjustHeight.bind(function(t){var e=t.table;a.trigger.beforeResize(e,"row"),function(t,e,n,r){var i,o,a,s=Tn(t),l=Oi(s,t,r,vi,function(t){return t.getOrThunk(Je)}),u=I(l,function(t,r){return n===r?Math.max(e+t,Je()):t}),c=(i=u,o=On(s),I(o,function(t){var e=mo(t.row,t.row+t.rowspan,i);return{element:t.element,height:e,rowspan:t.rowspan}})),d=(a=u,I(s.all,function(t,e){return{element:t.element,height:a[e]}}));D(d,function(t){fi(t.element,t.height)}),D(c,function(t){fi(t.element,t.height)});var f=P(u,function(t,e){return t+e},0);fi(t,f)}(e,r.delta(t.delta,e),t.row,r),a.trigger.afterResize(e,"row")}),o.events.startAdjust.bind(function(t){a.trigger.startDrag()}),o.events.adjustWidth.bind(function(t){var r=t.table;a.trigger.beforeResize(r,"col");var o=i.delta(t.delta,r),s=n(r);yo(r,o,t.column,e,s),a.trigger.afterResize(r,"col")}),{on:o.on,off:o.off,hideBars:o.hideBars,showBars:o.showBars,destroy:o.destroy,events:a.registry}}(p,d(),l)).on(),s.events.startDrag.bind(function(e){i=w.some(t.selection.getRng())}),s.events.beforeResize.bind(function(e){var n,r,i,o,a=e.table.dom;n=t,i=no(r=a),o=ro(a),n.fire("ObjectResizeStart",{target:r,width:i,height:o,origin:Xa+e.type})}),s.events.afterResize.bind(function(e){var n,r,o,a,s=e.table,l=s.dom;ao(s),i.each(function(e){t.selection.setRng(e),t.focus()}),n=t,o=no(r=l),a=ro(l),n.fire("ObjectResized",{target:r,width:o,height:a,origin:Xa+e.type}),t.undoManager.add()}),o=w.some(s))}),t.on("ObjectResizeStart",function(n){var i,o=n.target;s(o)&&(i=At.fromDom(o),D(t.dom.select(".mce-clonedresizable"),function(e){t.dom.addClass(e,"mce-"+za(t)+"-columns")}),!Bo(i)&&La(t)?Ua(t,i):!No(i)&&Ra(t)&&Ga(t,i),zo(i)&&nt(n.origin,Xa)&&Ga(t,i),e=n.width,r=Na(t)?"":so(t,o).getOr(""))}),t.on("ObjectResized",function(n){var i,o,a=n.target;s(a)&&(i=At.fromDom(a),nt(o=n.origin,"corner-")&&function(n,i,o){var a,s,u,c,f,h,p=rt(i,"e");""===r&&Ga(t,n),o!==e&&""!==r?(Fe(n,"width",r),a=d(),s=l(n),u=Va(t)||p?Fo(n).columns-1:0,yo(n,o-e,u,a,s)):lo(r)&&(c=parseFloat(r.replace("%","")),Fe(n,"width",o*c/e+"%")),/^(\d+(\.\d+)?)px$/.test(r)&&(h=Tn(f=n),En(h)||D(nn(f),function(t){var e=We(t,"width");Fe(t,"width",e),Ne(t,"width")}))}(i,o,n.width),ao(i),ba(t,i.dom,_a))}),t.on("SwitchMode",function(){o.each(function(e){t.mode.isReadOnly()?e.hideBars():e.showBars()})}),{lazyResize:function(){return o},lazyWire:function(){return a.getOr(To(At.fromDom(t.getBody()),Ya))},destroy:function(){o.each(function(t){t.destroy()}),a.each(function(e){t.inline&&Zn(e.parent())})}}},Za=function(t,e){return{element:t,offset:e}},Ka=function(t,e,n){return t.property().isText(e)&&0===t.property().getText(e).trim().length||t.property().isComment(e)?n(e).bind(function(e){return Ka(t,e,n).orThunk(function(){return w.some(e)})}):w.none()},Ja=function(t,e){return t.property().isText(e)?t.property().getText(e).length:t.property().children(e).length},Qa=function(t,e){var n=Ka(t,e,t.query().prevSibling).getOr(e);if(t.property().isText(n))return Za(n,Ja(t,n));var r=t.property().children(n);return 0<r.length?Qa(t,r[r.length-1]):Za(n,Ja(t,n))},ts=Qa,es=rr(),ns=function(t,e){1===Xe(t,"colspan")&&hi(t).bind(function(t){return function(t,e){return w.from(ii.exec(t)).bind(function(t){var n,r=Number(t[1]),i=t[2];return n=i,k(e,function(t){return k(ri[t],function(t){return n===t})})?w.some({value:r,unit:i}):w.none()})}(t,["fixed","relative","empty"])}).each(function(n){var r=n.value/2;yi(t,r,n.unit),yi(e,r,n.unit)})},rs=function(t,e,n,r){n===r?Ne(t,e):Pe(t,e,n)},is=function(t,e,n){j(_e(t,e)).fold(function(){return Gn(t,n)},function(t){return jn(t,n)})},os=function(t,e){var n=[],r=[],i=function(t){return I(t,function(t){t.isNew&&n.push(t.element);var e=t.element;return $n(e),D(t.cells,function(t){t.isNew&&r.push(t.element),rs(t.element,"colspan",t.colspan,1),rs(t.element,"rowspan",t.rowspan,1),Un(e,t.element)}),e})},o=function(t){return B(t,function(t){return I(t.cells,function(t){return rs(t.element,"span",t.colspan,1),t.element})})},a=function(e,n){var r,a,s,l=(s=Ae(r=t,a=n).getOrThunk(function(){var t=At.fromTag(a,oe(r).dom);return"thead"===a?is(r,"caption,colgroup",t):"colgroup"===a?is(r,"caption",t):Un(r,t),t}),$n(s),s),u=("colgroup"===n?o:i)(e);Yn(l,u)},s=function(e,n){0<e.length?a(e,n):Ae(t,n).each(Zn)},l=[],u=[],c=[],d=[];return D(e,function(t){switch(t.section){case"thead":l.push(t);break;case"tbody":u.push(t);break;case"tfoot":c.push(t);break;case"colgroup":d.push(t)}}),s(d,"colgroup"),s(l,"thead"),s(u,"tbody"),s(c,"tfoot"),{newRows:n,newCells:r}},as=function(t,e){if(0===t.length)return 0;var n=t[0];return L(t,function(t){return!e(n.element,t.element)}).fold(function(){return t.length},function(t){return t})},ss=function(t,e,n){var r,i=[];En(t)&&(r=I(Pn(t),function(t){return Yt(t.element,n,!1)}),i.push($t(r,"colgroup")));for(var o=0;o<t.grid.rows;o++){for(var a=[],s=0;s<t.grid.columns;s++){var l=An(t,o,s).map(function(t){return Yt(t.element,n,t.isLocked)}).getOrThunk(function(){return Yt(e.gap(),!0,!1)});a.push(l)}var u=$t(a,t.all[o].section);i.push(u)}return i},ls=function(t,e){return function(t,e){return I(t,function(t){var n=G(t.details,function(t){return se(t.element).map(function(t){var e=se(t).isNone();return Yt(t,e,!1)})}).getOrThunk(function(){return Yt(e.row(),!0,!1)});return{element:n.element,cells:t.details,section:t.section,isNew:n.isNew}})}(function(t,e){var n=I(t,function(t){return I(t.cells,v)});return I(t,function(r,i){return{details:B(r.cells,function(r,o){if(!1!==n[i][o])return[];var a=function(t,e,n,r){var i,o=t[e].cells.slice(n),a=as(o,r),s=(i=n,I(t,function(t){return mn(t,i)}).slice(e));return{colspan:a,rowspan:as(s,r)}}(t,i,o,e);return function(t,e,r,i){for(var o=t;o<t+r;o++)for(var a=e;a<e+i;a++)n[o][a]=!0}(i,o,a.rowspan,a.colspan),[{element:r.element,rowspan:a.rowspan,colspan:a.colspan,isNew:r.isNew}]}),section:r.section}})}(t,Ot),e)},us=function(t,e){return G(t.all,function(t){return R(t.cells,function(t){return Ot(e,t.element)})})},cs=function(t,e,n){var r=I(e.selection,function(e){return en(e).bind(function(e){return us(t,e)}).filter(n)}),i=Mr(r);return Tr(0<i.length,i)},ds=function(t,e,n,r,i){return function(o,a,s,l,u,c){var d=Tn(a);return e(d,s).map(function(e){var n=ss(d,l,!1),r=t(n,e,Ot,i(l)),o=wn(r.grid);return{info:e,grid:ls(r.grid,l),cursor:r.cursor,lockedColumns:o}}).bind(function(t){var e=os(a,t.grid),i=w.from(u).getOrThunk(function(){return Li(a)}),s=w.from(c).getOrThunk(Mo);return n(a,t.grid,t.info,i,s),r(a),ha(o,a),Ne(a,bn),0<t.lockedColumns.length&&Pe(a,bn,t.lockedColumns.join(",")),w.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})})}},fs=function(t,e){return en(e.element).bind(function(e){return us(t,e)})},hs=function(t,e){return cs(t,e,y).map(function(t){return{cells:t,generators:e.generators,clipboard:e.clipboard}})},ps=function(t,e){return cs(t,e,y)},gs=function(t,e){return fs(t,e).filter(function(t){return!t.isLocked})},ms=function(t,e){return cs(t,e,function(t){return!t.isLocked})},vs=function(t,e){return z(e,function(e){return us(t,e).exists(function(t){return!t.isLocked})})},ys=function(t,e){return e.mergable.filter(function(e){return vs(t,e.cells)})},xs=function(t,e){return e.unmergable.filter(function(e){return vs(t,e)})},bs=function(t,e,n,r){for(var i=xn(t).rows,o=!0,a=0;a<i.length;a++)for(var s=0;s<yn(i[0]);s++){var l=i[a],u=mn(l,s),c=n(u.element,e);!0===c&&!1===o?hn(l,s,Yt(r(),!0,u.isLocked)):!0===c&&(o=!1)}return t},_s=function(t){return{is:function(e){return t===e},isValue:y,isError:v,getOr:c(t),getOrThunk:c(t),getOrDie:c(t),or:function(e){return _s(t)},orThunk:function(e){return _s(t)},fold:function(e,n){return n(t)},map:function(e){return _s(e(t))},mapError:function(e){return _s(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOptional:function(){return w.some(t)}}},ws=function(t){return{is:v,isValue:v,isError:y,getOr:d,getOrThunk:function(t){return t()},getOrDie:function(){return e=String(t),function(){throw new Error(e)}();var e},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return ws(t)},mapError:function(e){return ws(e(t))},each:u,bind:function(e){return ws(t)},exists:v,forall:y,toOptional:w.none}},Ss={value:_s,error:ws,fromOption:function(t,e){return t.fold(function(){return ws(e)},_s)}},Cs=function(t,e){return{rowDelta:0,colDelta:yn(t[0])-yn(e[0])}},Ms=function(t,e){return{rowDelta:t.length-e.length,colDelta:0}},Ts=function(t,e,n,r){var i="colgroup"===e.section?n.col:n.cell;return A(t,function(t){return Yt(i(),!0,r(t))})},ks=function(t,e,n,r){return t.concat(A(e,function(){var e=t[t.length-1],i=Ts(e.cells.length,e,n,function(t){return jt(r,t.toString())});return pn(e,i)}))},As=function(t,e,n,r){return I(t,function(t){var i=Ts(e,t,n,v);return dn(t,r,i)})},Is=function(t,e,n){var r=e.colDelta<0?As:d,i=e.rowDelta<0?ks:d,o=wn(t),a=yn(t[0]),s=k(o,function(t){return t===a-1}),l=r(t,Math.abs(e.colDelta),n,s?a-1:a),u=wn(l);return i(l,Math.abs(e.rowDelta),n,V(u,y))},Ds=function(t,e,n){return O(n,function(n){return n>=t.column&&n<=yn(e[0])+t.column})},Os=function(t,e,n,r,i){var o,a,s,l;o=e,s=i,l=r.cell,0<(a=t)&&a<o[0].cells.length&&D(o,function(t){var e=t.cells[a];s(e.element,t.cells[a-1].element)&&hn(t,a,Yt(l(),!0,e.isLocked))});var u=Ms(n,e),c=Is(n,u,r),d=Ms(e,c),f=Is(e,d,r);return I(f,function(e,n){return dn(e,t,c[n].cells)})},Ps=function(t,e,n,r,i){!function(t,e,n,r){var i,o,a=xn(t).rows;0<e&&e<a.length&&(o=n,i=E(a[e-1].cells,function(t,e){return k(t,function(t){return o(t.element,e.element)})?t:t.concat([e])},[]),D(i,function(t){for(var i=w.none(),o=e;o<a.length;o++)for(var s=0;s<yn(a[0]);s++)!function(e){var s=a[o],l=mn(s,e);n(l.element,t.element)&&(i.isNone()&&(i=w.some(r())),i.each(function(t){hn(s,e,Yt(t,!0,l.isLocked))}))}(s)}))}(e,t,i,r.cell);var o,a,s=wn(e),l=Cs(e,n),u=U(U({},l),{colDelta:l.colDelta-s.length}),c=Is(e,u,r),d=xn(c),f=d.cols,h=d.rows,p=wn(c),g=Cs(n,e),m=U(U({},g),{colDelta:g.colDelta+p.length}),v=(o=r,a=p,I(n,function(t){return E(a,function(e,n){var r=Ts(1,t,o,y)[0];return fn(e,n,r)},t)})),x=Is(v,m,r);return f.concat(h.slice(0,t)).concat(x).concat(h.slice(t,h.length))},Es=function(t,e,n,r,i){var o=xn(t),a=o.rows,s=o.cols,l=a.slice(0,e),u=a.slice(e),c=gn(a[n],function(t,n){return 0<e&&e<a.length&&r(vn(a[e-1],n),vn(a[e],n))?mn(a[e],n):Yt(i(t.element,r),!0,t.isLocked)});return s.concat(l).concat([c]).concat(u)},Rs=function(t,e,n,r,i){return I(t,function(t){var o=0<e&&e<yn(t)&&r(vn(t,e-1),vn(t,e)),a=function(t,e,n,r,i,o,a){if("colgroup"!==n&&r)return mn(t,e);var s=mn(t,i);return Yt(a(s.element,o),!0,!1)}(t,e,t.section,o,n,r,i);return fn(t,e,a)})},Ls=function(t,e,n,r){return I(t,function(t){return gn(t,function(t){return i=t,k(e,function(t){return n(i.element,t.element)})?Yt(r(t.element,n),!0,t.isLocked):t;var i})})},Ns=function(t,e,n,r){return void 0!==vn(t[e],n)&&0<e&&r(vn(t[e-1],n),vn(t[e],n))},Bs=function(t,e,n){return 0<e&&n(vn(t,e-1),vn(t,e))},zs=function(t,e,n,r){var i=xn(t).rows,o=B(i,function(r,i){return Ns(t,i,e,n)||Bs(r,e,n)?[]:[mn(r,e)]});return Ls(t,o,n,r)},Vs=function(t,e,n,r){var i=xn(t).rows,o=i[e],a=B(o.cells,function(t,r){return Ns(i,e,r,n)||Bs(o,r,n)?[]:[t]});return Ls(t,a,n,r)},Fs=function(t){return E(t,function(t,e){return k(t,function(t){return t.column===e.column})?t:t.concat([e])},[]).sort(function(t,e){return t.column-e.column})},Hs=function(t){return{element:t,colspan:qe(t,"colspan",1),rowspan:qe(t,"rowspan",1)}},Ws=function(t){return Le(t,"scope").map(function(t){return t.substr(0,3)})},js=function(t,e){void 0===e&&(e=Hs);var n=Pi(w.none()),r=function(n){return function(e){switch(Zt(e.element)){case"col":return t.col(e);default:return t.cell(e)}}(e(n))},i=function(t){var e=r(t);return n.get().isNone()&&n.set(w.some(e)),o=w.some({item:t,replacement:e}),e},o=w.none();return{getOrInit:function(t,e){return o.fold(function(){return i(t)},function(n){return e(t,n.item)?n.replacement:i(t)})},cursor:n.get}},Gs=function(t,e){return function(n){var r=Pi(w.none()),i=[],o=function(o){var a=n.replace(o,e,{scope:t});return i.push({item:o,sub:a}),r.get().isNone()&&r.set(w.some(a)),a};return{replaceOrInit:function(t,e){return"col"===Zt(t)?t:(n=t,r=e,R(i,function(t){return r(t.item,n)}).fold(function(){return o(t)},function(n){return e(t,n.item)?n.sub:o(t)}));var n,r},cursor:r.get}}},Us=function(t){var e=Pi(w.none());return{unmerge:function(n){e.get().isNone()&&e.set(w.some(n));var r=Ws(n);return r.each(function(t){return Pe(n,"scope",t)}),function(){var e=t.cell({element:n,colspan:1,rowspan:1});return Ue(e,"width"),Ue(n,"width"),r.each(function(t){return Pe(e,"scope",t)}),e}},merge:function(t){return Ue(t[0],"width"),function(){var e=Mr(I(t,Ws));if(0===e.length)return w.none();var n=e[0],r=["row","col"];return k(e,function(t){return t!==n&&T(r,t)})?w.none():w.from(n)}().fold(function(){return Ne(t[0],"scope")},function(e){return Pe(t[0],"scope",e+"group")}),c(t[0])},cursor:e.get}},qs=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Xs=rr(),Ys=function(t){return e=t,n=Xs.property().name(e),T(qs,n);var e,n},$s=function(t){return e=t,n=Xs.property().name(e),T(["ol","ul"],n);var e,n},Zs=function(t){0===nn(t).length&&Zn(t)},Ks=function(t,e){return{grid:t,cursor:e}},Js=function(t,e,n){var r=xn(t).rows;return Qs(r,e,n).orThunk(function(){return Qs(r,0,0)})},Qs=function(t,e,n){return w.from(t[e]).bind(function(t){return w.from(t.cells[n]).bind(function(t){return w.from(t.element)})})},tl=function(t,e,n){var r=xn(t).rows;return Ks(t,Qs(r,e,n))},el=function(t){return E(t,function(t,e){return k(t,function(t){return t.row===e.row})?t:t.concat([e])},[]).sort(function(t,e){return t.row-e.row})},nl=function(t,e,n){var r,i=(r=n.section,ln(t,function(){return r})),o=kn(i);return ss(o,e,!0)},rl=function(t,e){var n=O(t,e);return 0===n.length?w.some("td"):n.length===t.length?w.some("th"):w.none()},il=function(t,e,n,r){var i=kn(e),o=r.getWidths(i,r);vo(i,o,r)},ol=function(t,e,n,r,i){var o=kn(e),a=r.getWidths(o,r),s=r.pixelWidth(),l=i.calcRedestributedWidths(a,s,n.pixelDelta,r.isRelative),u=l.delta;vo(o,l.newSizes,r),r.adjustTableWidth(u)},al=function(t,e){return k(e,function(t){return 0===t.column&&t.isLocked})},sl=function(t,e){return k(e,function(e){return e.column+e.colspan>=t.grid.columns&&e.isLocked})},ll=function(t,e){var n=Or(t),r=Fs(e);return E(r,function(t,e){return t+n[e.column].map(Dr).getOr(0)},0)},ul=function(t){return function(e,n){return ps(e,n).filter(function(n){return!(t?al:sl)(e,n)}).map(function(t){return{details:t,pixelDelta:ll(e,t)}})}},cl=function(t){return function(e,n){return hs(e,n).filter(function(n){return!(t?al:sl)(e,n.cells)})}},dl=ds(function(t,e,n,r){var i=e[0].row,o=el(e),a=P(o,function(t,e){return{grid:Es(t.grid,i,e.row+t.delta,n,r.getOrInit),delta:t.delta+1}},{grid:t,delta:0}).grid;return tl(a,i,e[0].column)},ps,u,u,js),fl=ds(function(t,e,n,r){var i=el(e),o=i[i.length-1],a=o.row+o.rowspan,s=P(i,function(t,e){return Es(t,a,e.row,n,r.getOrInit)},t);return tl(s,a,e[0].column)},ps,u,u,js),hl=ds(function(t,e,n,r){var i=e.details,o=Fs(i),a=o[0].column,s=P(o,function(t,e){return{grid:Rs(t.grid,a,e.column+t.delta,n,r.getOrInit),delta:t.delta+1}},{grid:t,delta:0}).grid;return tl(s,i[0].row,a)},ul(!0),ol,u,js),pl=ds(function(t,e,n,r){var i=e.details,o=i[i.length-1],a=o.column+o.colspan,s=Fs(i),l=P(s,function(t,e){return Rs(t,a,e.column,n,r.getOrInit)},t);return tl(l,i[0].row,a)},ul(!1),ol,u,js),gl=ds(function(t,e,n,r){var i,o,a=Fs(e.details),s=(i=t,o=I(a,function(t){return t.column}),B(i,function(t){var e=P(o,function(t,e){return 0<=e&&e<t.length?t.slice(0,e).concat(t.slice(e+1)):t},t.cells);return 0<e.length?[$t(e,t.section)]:[]})),l=Js(s,a[0].row,a[0].column);return Ks(s,l)},function(t,e){return ms(t,e).map(function(e){return{details:e,pixelDelta:-ll(t,e)}})},ol,Zs,js),ml=ds(function(t,e,n,r){var i,o,a,s,l=el(e),u=(i=l[0].row,o=l[l.length-1].row,(a=xn(t)).cols.concat((s=a.rows).slice(0,i)).concat(s.slice(o+1))),c=Js(u,e[0].row,e[0].column);return Ks(u,c)},ps,u,Zs,js),vl=(ds(function(t,e,n,r){var i=zs(t,e.column,n,r.replaceOrInit);return tl(i,e.row,e.column)},gs,u,u,Gs("row","th")),ds(function(t,e,n,r){var i=Fs(e),o=E(i,function(t,e){return zs(t,e.column,n,r.replaceOrInit)},t);return tl(o,e[0].row,e[0].column)},ms,u,u,Gs("row","th"))),yl=(ds(function(t,e,n,r){var i=zs(t,e.column,n,r.replaceOrInit);return tl(i,e.row,e.column)},gs,u,u,Gs(null,"td")),ds(function(t,e,n,r){var i=Fs(e),o=E(i,function(t,e){return zs(t,e.column,n,r.replaceOrInit)},t);return tl(o,e[0].row,e[0].column)},ms,u,u,Gs(null,"td"))),xl=(ds(function(t,e,n,r){var i=Vs(t,e.row,n,r.replaceOrInit);return tl(i,e.row,e.column)},fs,u,u,Gs("col","th")),ds(function(t,e,n,r){var i=el(e),o=E(i,function(t,e){return Vs(t,e.row,n,r.replaceOrInit)},t);return tl(o,e[0].row,e[0].column)},ps,u,u,Gs("col","th")),ds(function(t,e,n,r){var i=Vs(t,e.row,n,r.replaceOrInit);return tl(i,e.row,e.column)},fs,u,u,Gs(null,"td")),ds(function(t,e,n,r){var i=el(e),o=E(i,function(t,e){return Vs(t,e.row,n,r.replaceOrInit)},t);return tl(o,e[0].row,e[0].column)},ps,u,u,Gs(null,"td")),ds(function(t,e,n,r){var i=e.cells;!function(t){var e,n=function(t){return"br"===Zt(t)},r=0===(e=B(t,function(t){var e=de(t);return z(e,function(t){return n(t)||ee(t)&&0===Qn(t).trim().length})?[]:e.concat(function(t){return Wi(t).bind(function(e){var r=ce(e).map(function(t){return!!Ys(t)||!!function(t){return e=t,T(["br","img","hr","input"],Xs.property().name(e));var e}(t)&&"img"!==Zt(t)}).getOr(!1);return se(e).map(function(i){return!0===r||"li"===Zt(o=i)||Te(o,$s).isSome()||n(e)||Ys(i)&&!Ot(t,i)?[]:[At.fromTag("br")];var o})}).getOr([])}(t))})).length?[At.fromTag("br")]:e;$n(t[0]),Yn(t[0],r)}(i);var o=function(t,e,n){var r=xn(t).rows;if(0===r.length)return t;for(var i=e.startRow;i<=e.finishRow;i++)for(var o=e.startCol;o<=e.finishCol;o++){var a=r[i],s=mn(a,o).isLocked;hn(a,o,Yt(n(),!1,s))}return t}(t,e.bounds,r.merge(i));return Ks(o,w.from(i[0]))},ys,il,u,Us)),bl=ds(function(t,e,n,r){var i=P(e,function(t,e){return bs(t,e,n,r.unmerge(e))},t);return Ks(i,w.from(e[0]))},xs,il,u,Us),_l=ds(function(t,e,n,r){var i,o,a=(i=e.generators,o=Tn(e.clipboard),ss(o,i,!0));return function(t,e,n,r,i){var o,a,s,l,u,c,d=wn(e),h=(o=t,s=d,l=yn((a=e)[0]),u=xn(a).cols.length+o.row,c=A(l-o.column,function(t){return t+o.column}),{row:u,column:R(c,function(t){return z(s,function(e){return e!==t})}).getOr(l-1)}),p=xn(n).rows,g=Ds(h,p,d);return function(t,e,n){if(t.row>=e.length||t.column>yn(e[0]))return Ss.error("invalid start address out of table bounds, row: "+t.row+", column: "+t.column);var r=e.slice(t.row),i=r[0].cells.slice(t.column),o=yn(n[0]);return Ss.value({rowDelta:r.length-n.length,colDelta:i.length-o})}(h,e,p).map(function(t){var n=U(U({},t),{colDelta:t.colDelta-g.length}),o=Is(e,n,r),a=wn(o),s=Ds(h,p,a);return function(t,e,n,r,i,o){for(var a,s,l,u,c,d=t.row,h=t.column,p=d+n.length,g=h+yn(n[0])+o.length,m=V(o,y),v=d;v<p;v++)for(var x,b,_,w=0,S=h;S<g;S++)m[S]?w++:(u=void 0,u=f(i,mn((a=e)[s=v],l=S).element),c=a[s],1<a.length&&1<yn(c)&&(0<l&&u(vn(c,l-1))||l<c.cells.length-1&&u(vn(c,l+1))||0<s&&u(vn(a[s-1],l))||s<a.length-1&&u(vn(a[s+1],l)))&&bs(e,vn(e[v],S),i,r.cell),b=(x=mn(n[v-d],S-h-w)).element,_=r.replace(b),hn(e[v],S,Yt(_,!0,x.isLocked)));return e}(h,o,p,r,i,s)})}({row:e.row,column:e.column},t,a,e.generators,n).fold(function(){return Ks(t,w.some(e.element))},function(t){var n=Js(t,e.row,e.column);return Ks(t,n)})},function(t,e){return en(e.element).bind(function(n){return us(t,n).map(function(t){return U(U({},t),{generators:e.generators,clipboard:e.clipboard})})})},il,u,js),wl=ds(function(t,e,n,r){var i=xn(t).rows,o=e.cells[0].column,a=nl(e.clipboard,e.generators,i[e.cells[0].row]),s=Os(o,t,a,e.generators,n),l=Js(s,e.cells[0].row,e.cells[0].column);return Ks(s,l)},cl(!0),u,u,js),Sl=ds(function(t,e,n,r){var i=xn(t).rows,o=e.cells[e.cells.length-1].column+e.cells[e.cells.length-1].colspan,a=nl(e.clipboard,e.generators,i[e.cells[0].row]),s=Os(o,t,a,e.generators,n),l=Js(s,e.cells[0].row,e.cells[0].column);return Ks(s,l)},cl(!1),u,u,js),Cl=ds(function(t,e,n,r){var i=xn(t).rows,o=e.cells[0].row,a=nl(e.clipboard,e.generators,i[o]),s=Ps(o,t,a,e.generators,n),l=Js(s,e.cells[0].row,e.cells[0].column);return Ks(s,l)},hs,u,u,js),Ml=ds(function(t,e,n,r){var i=xn(t).rows,o=e.cells[e.cells.length-1].row+e.cells[e.cells.length-1].rowspan,a=nl(e.clipboard,e.generators,i[e.cells[0].row]),s=Ps(o,t,a,e.generators,n),l=Js(s,e.cells[0].row,e.cells[0].column);return Ks(s,l)},hs,u,u,js),Tl=function(t,e){var n=Tn(t);return ps(n,e).bind(function(t){var e=t[t.length-1],r=t[0].column,i=e.column+e.colspan,o=N(I(n.all,function(t){return O(t.cells,function(t){return t.column>=r&&t.column<i})}));return rl(o,function(t){return"th"===Zt(t.element)})}).getOr("")},kl=function(t){return to(t.parentNode)},Al=function(t,e){var n="thead"===kl(e),r=!k(e.cells,function(t){return"th"!==to(t)});return n||r?w.some({thead:n,ths:r}):w.none()},Il=function(t,e){return"thead"===(n=Al(0,e).fold(function(){return kl(e)},function(t){return"thead"}))?"header":"tfoot"===n?"footer":"body";var n},Dl=function(t,e,n){var r,i,o=t.getParent(e,"table"),a=e.parentNode,s=to(a);n!==s&&((r=t.select(n,o)[0])||(r=t.create(n),i=o.firstChild,"thead"===n?j(_e(At.fromDom(o),"caption,colgroup")).fold(function(){return o.insertBefore(r,i)},function(e){return t.insertAfter(r,e.dom)}):o.appendChild(r)),"tbody"===n&&"thead"===s&&r.firstChild?r.insertBefore(e,r.firstChild):r.appendChild(e),a.hasChildNodes()||t.remove(a))},Ol=function(t,e,n,r){var i=t.dom,o=function(t,e,n){if(a(n)&&to(e)!==n){var r=t.dom.rename(e,n);return xa(t,r),r}return e}(t,e,n);return function(t){return void 0===t}(r)||i.setAttrib(o,"scope",r),o},Pl=function(t,e,n,r){return D(e,function(e){return Ol(t,e,n,r)})},El=function(t,e,n){var r,i,o,a=t.dom;"header"===n?(i="auto"===(r=Ba(t))?(o=on(At.fromDom(e.cells[0])).map(an).getOr([]),G(o,function(t){return Al(0,t.dom)}).map(function(t){return t.thead&&t.ths?"sectionCells":t.thead?"section":"cells"}).getOr("section")):r,Pl(t,e.cells,"section"===i?"td":"th","col"),Dl(a,e,"cells"===i?"tbody":"thead")):(Pl(t,e.cells,"td",null),Dl(a,e,"footer"===n?"tfoot":"tbody"))},Rl=function(t){return function(e,n){var r,i=Zt(e),o="col"===i||"colgroup"===i?on(r=e).bind(function(t){return pr(t,fo.firstSelectedSelector)}).fold(function(){return r},function(t){return t[0]}):e;return De(o,t,n)}},Ll=Rl("th,td"),Nl=Rl("th,td,caption"),Bl=function(t,e,n){return Ll(t,n).map(function(t){return co(e)}).getOr([])},zl=function(t,e){var n,r,i,o=Ll(t);return r=o.bind(function(t){return on(t)}).map(an),i=function(t,n){return O(n,function(n){return k(Qi(n.dom.cells),function(n){return"1"===Re(n,e)||Ot(n,t)})})},((n=o).isSome()&&r.isSome()?w.some(i(n.getOrDie(),r.getOrDie())):w.none()).getOr([])},Vl={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Fl=function(t,e,n,r){return A(t,function(t){return function(t,e,n,r){for(var i=At.fromTag("tr"),o=0;o<t;o++){var a=At.fromTag(r<e||o<n?"th":"td");o<n&&Pe(a,"scope","row"),r<e&&Pe(a,"scope","col"),Un(a,At.fromTag("br")),Un(i,a)}return i}(e,n,r,t)})},Hl=function(t,e){t.selection.select(e.dom,!0),t.selection.collapse(!0)},Wl=function(t,e,r,i,o){var a=Ia(t),s={styles:a,attributes:Aa(t),colGroups:t.getParam("table_use_colgroups",!1,"boolean")};return t.undoManager.ignore(function(){var n=function(t,e,n,r,i,o){void 0===o&&(o=Vl);var a=At.fromTag("table"),s="cells"!==i;He(a,o.styles),Ee(a,o.attributes),o.colGroups&&Un(a,function(t){var e=At.fromTag("colgroup");return A(t,function(){return Un(e,At.fromTag("col"))}),e}(e));var l,u,c=Math.min(t,n);s&&0<n&&(l=At.fromTag("thead"),Un(a,l),u=Fl(n,e,"sectionCells"===i?c:0,r),Yn(l,u));var d=At.fromTag("tbody");Un(a,d);var f=Fl(s?t-c:t,e,s?0:n,r);return Yn(d,f),a}(r,e,o,i,Ba(t),s);Pe(n,"data-mce-id","__mce");var a,l,u,c=(a=n,l=At.fromTag("div"),u=At.fromDom(a.dom.cloneNode(!0)),Un(l,u),l.dom.innerHTML);t.insertContent(c),t.addVisual()}),Ie(eo(t),'table[data-mce-id="__mce"]').map(function(e){var r,i,o;return La(t)?Ua(t,e):Na(t)?qa(e):(Ra(t)||n(r=a.width)&&-1!==r.indexOf("%"))&&Ga(t,e),ao(e),Ne(e,"data-mce-id"),i=t,D(we(e,"tr"),function(t){ya(i,t.dom),D(we(t,"th,td"),function(t){xa(i,t.dom)})}),o=t,Ie(e,"td,th").each(f(Hl,o)),e.dom}).getOr(null)},jl=function(t,e,n,r,i){void 0===r&&(r={});var o=function(t){return l(t)&&0<t};return o(e)&&o(n)?Wl(t,n,e,r.headerColumns||0,r.headerRows||0):(console.error(i),null)},Gl=function(t){return function(){return t().fold(function(){return[]},function(t){return I(t,function(t){return t.dom})})}},Ul=function(t){return function(e){var n=0<e.length?w.some(Qi(e)):w.none();t(n)}},ql=function(t,e,n){var r=qe(t,e,1);1===n||r<=1?Ne(t,e):Pe(t,e,Math.min(n,r))},Xl=tinymce.util.Tools.resolve("tinymce.util.Tools"),Yl=function(t,e,n){return function(e,r){for(var i=0;i<r.length;i++){var o=t.getStyle(r[i],n);if(void 0===e&&(e=o),e!==o)return""}return e}(void 0,t.select("td,th",e))},$l=function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},Zl=function(t,e){Xl.each("left center right".split(" "),function(n){t.formatter.remove("align"+n,{},e)})},Kl=function(t,e){return(e||[]).concat(I(t,function(t){var e=t.text||t.title;return Gt(t,"menu")?{text:e,items:Kl(t.menu)}:{text:e,value:t.value}}))},Jl=function(t){return function(e){return nt(e,"rgb")?t.toHex(e):e}},Ql=function(t,e){var n=At.fromDom(e);return{borderwidth:Ge(n,"border-width").getOr(""),borderstyle:Ge(n,"border-style").getOr(""),bordercolor:Ge(n,"border-color").map(Jl(t)).getOr(""),backgroundcolor:Ge(n,"background-color").map(Jl(t)).getOr("")}},tu=function(t){var e=t[0],n=t.slice(1);return D(n,function(t){D(Rt(e),function(n){Nt(t,function(t,r){var i=e[n];""!==i&&n===r&&i!==t&&(e[n]="")})})}),e},eu=function(t){var e=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(e):e}},nu=function(t,e,n,r){return R(t,function(t){return n.formatter.matchNode(r,e+t)}).getOr("")},ru=f(nu,["left","center","right"],"align"),iu=f(nu,["top","middle","bottom"],"valign"),ou=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],au=function(t){return ou.concat((0<(e=Kl(t.getParam("table_cell_class_list",[],"array"))).length?w.some({name:"class",type:"listbox",label:"Class",items:e}):w.none()).toArray());var e},su=function(t){return function(e,n){var r=e.dom;return{setAttrib:function(e,i){t&&!i||r.setAttrib(n,e,i)},setStyle:function(e,i){t&&!i||r.setStyle(n,e,i)},setFormat:function(r,i){t&&!i||(""===i?e.formatter.remove(r,{value:null},n,!0):e.formatter.apply(r,{value:i},n))}}}},lu={normal:su(!1),ifTruthy:su(!0)},uu=function(t){return on(t[0]).map(function(e){var n=Tn(e),r=On(n),i=O(r,function(e){return k(t,function(t){return Ot(e.element,t)})});return I(i,function(t){return{element:t.element.dom,column:Rn(n,t.column).map(function(t){return t.element.dom})}})})},cu=function(t,e,n,r){var i=r.getData();r.close(),t.undoManager.transact(function(){(function(t,e,n,r){var i,o,a=1===e.length,s=Vt(r,function(t,e){return n[e]!==t});0<Ht(s)&&1<=e.length&&(i=on(e[0]),uu(e).each(function(e){D(e,function(e){var n,i,o,s,l,u,c,d,f=Ol(t,e.element,r.celltype),h=a?lu.normal(t,f):lu.ifTruthy(t,f);i=e.column.map(function(e){return a?lu.normal(t,e):lu.ifTruthy(t,e)}).getOr(h),(n=h).setAttrib("scope",(o=r).scope),n.setAttrib("class",o.class),n.setStyle("height",oo(o.height)),i.setStyle("width",oo(o.width)),Da(t)&&((s=h).setFormat("tablecellbackgroundcolor",(l=r).backgroundcolor),s.setFormat("tablecellbordercolor",l.bordercolor),s.setFormat("tablecellborderstyle",l.borderstyle),s.setFormat("tablecellborderwidth",oo(l.borderwidth))),a&&(Zl(t,f),u=t,c=f,Xl.each("top middle bottom".split(" "),function(t){u.formatter.remove("valign"+t,{},c)})),r.halign&&$l(t,f,r.halign),r.valign&&(d=r.valign)&&t.formatter.apply("valign"+d,{},f)})}),o=0<Ht(Vt(s,function(t,e){return"scope"!==e&&"celltype"!==e})),i.each(function(e){return ba(t,e.dom,{structure:jt(s,"celltype"),style:o})}))})(t,e,n,i),t.focus()})},du=function(t,e){var n,r,i,o=Bl(uo(t),e);0!==o.length&&(n=function(t,e){var n=uu(e).map(function(e){return I(e,function(e){return n=t,r=e.element,i=Da(t),o=n.dom,a=e.column.getOr(r),U({width:(s=function(t,e){return o.getStyle(t,e)||o.getAttrib(t,e)})(a,"width"),height:s(r,"height"),scope:o.getAttrib(r,"scope"),celltype:to(r),class:o.getAttrib(r,"class",""),halign:ru(n,r),valign:iu(n,r)},i?Ql(o,r):{});var n,r,i,o,a,s})});return tu(n.getOrDie())}(t,o),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:au(t)},eu("cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:au(t)}]},t.windowManager.open({title:"Cell Properties",size:"normal",body:Da(t)?r:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n,onSubmit:f(cu,t,o,n)}))},fu=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],hu=function(t){return fu.concat((0<(e=Kl(t.getParam("table_row_class_list",[],"array"))).length?w.some({name:"class",type:"listbox",label:"Class",items:e}):w.none()).toArray());var e},pu=function(t,e,n,r){var i=r.getData();r.close(),t.undoManager.transact(function(){(function(t,e,n,r){var i,o,a=1===e.length,s=Vt(r,function(t,e){return n[e]!==t});0<Ht(s)&&(D(e,function(e){r.type!==to(e.parentNode)&&El(t,e,r.type);var i,o,s,l,u=a?lu.normal(t,e):lu.ifTruthy(t,e);(i=u).setAttrib("class",(o=r).class),i.setStyle("height",oo(o.height)),Oa(t)&&((s=u).setStyle("background-color",(l=r).backgroundcolor),s.setStyle("border-color",l.bordercolor),s.setStyle("border-style",l.borderstyle)),r.align!==n.align&&(Zl(t,e),$l(t,e,r.align))}),i=jt(s,"type"),o=!i||1<Ht(s),on(At.fromDom(e[0])).each(function(e){return ba(t,e.dom,{structure:i,style:o})}))})(t,e,n,i),t.focus()})},gu=function(t){var e,n,r,i,o=zl(uo(t),fo.selected);0!==o.length&&(e=I(o,function(e){return n=t,r=e.dom,i=Oa(t),U({height:(o=n.dom).getStyle(r,"height")||o.getAttrib(r,"height"),class:o.getAttrib(r,"class",""),type:Il(0,r),align:ru(n,r)},i?Ql(o,r):{});var n,r,i,o}),n=tu(e),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:hu(t)},eu("row")]},i={type:"panel",items:[{type:"grid",columns:2,items:hu(t)}]},t.windowManager.open({title:"Row Properties",size:"normal",body:Oa(t)?r:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n,onSubmit:f(pu,t,I(o,function(t){return t.dom}),n)}))},mu=tinymce.util.Tools.resolve("tinymce.Env"),vu=function(t,e,r,i){if("TD"===e.tagName||"TH"===e.tagName)n(r)?t.setStyle(e,r,i):t.setStyle(e,r);else if(e.children)for(var o=0;o<e.children.length;o++)vu(t,e.children[o],r,i)},yu=function(t,e,n,r){var i,o=t.dom,a=r.getData(),s=Vt(a,function(t,e){return n[e]!==t});r.close(),""===a.class&&delete a.class,t.undoManager.transact(function(){var n,r,l,u;e||(n=parseInt(a.cols,10)||1,r=parseInt(a.rows,10)||1,e=Wl(t,n,r,0,0)),0<Ht(s)&&(function(t,e,n){var r,i=t.dom,o={},a={};if(o.class=n.class,a.height=oo(n.height),i.getAttrib(e,"width")&&!Ea(t)?o.width=(r=n.width)?r.replace(/px$/,""):"":a.width=oo(n.width),Ea(t)?(a["border-width"]=oo(n.border),a["border-spacing"]=oo(n.cellspacing)):(o.border=n.border,o.cellpadding=n.cellpadding,o.cellspacing=n.cellspacing),Ea(t)&&e.children)for(var s=0;s<e.children.length;s++)vu(i,e.children[s],{"border-width":oo(n.border),padding:oo(n.cellpadding)}),Pa(t)&&vu(i,e.children[s],{"border-color":n.bordercolor});Pa(t)&&(a["background-color"]=n.backgroundcolor,a["border-color"]=n.bordercolor,a["border-style"]=n.borderstyle),o.style=i.serializeStyle(U(U({},Ia(t)),a)),i.setAttribs(e,U(U({},Aa(t)),o))}(t,e,a),(i=o.select("caption",e)[0])&&!a.caption&&o.remove(i),!i&&a.caption&&((i=o.create("caption")).innerHTML=mu.ie?" ":'<br data-mce-bogus="1"/>',e.insertBefore(i,e.firstChild)),""===a.align?Zl(t,e):$l(t,e,a.align)),t.focus(),t.addVisual(),0<Ht(s)&&(u=!(l=jt(s,"caption"))||1<Ht(s),ba(t,e,{structure:l,style:u}))})},xu=function(t,e){var n,r,i,o,a,s,l,u,c=t.dom,d=function(t,e){var n,r,i,o,a=Ia(t),s=Aa(t),l=e?(n=t.dom,{borderstyle:Wt(a,"border-style").getOr(""),bordercolor:Jl(n)(Wt(a,"border-color").getOr("")),backgroundcolor:Jl(n)(Wt(a,"background-color").getOr(""))}):{};return U(U(U(U(U(U({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),a),s),l),(o=a["border-width"],Ea(t)&&o?{border:o}:Wt(s,"border").fold(function(){return{}},function(t){return{border:t}}))),(r=Wt(a,"border-spacing").or(Wt(s,"cellspacing")).fold(function(){return{}},function(t){return{cellspacing:t}}),i=Wt(a,"border-padding").or(Wt(s,"cellpadding")).fold(function(){return{}},function(t){return{cellpadding:t}}),U(U({},r),i)))}(t,Pa(t));!1===e?(n=c.getParent(t.selection.getStart(),"table",t.getBody()))?(i=n,o=Pa(r=t),d=U({width:(u=r.dom).getStyle(i,"width")||u.getAttrib(i,"width"),height:u.getStyle(i,"height")||u.getAttrib(i,"height"),cellspacing:u.getStyle(i,"border-spacing")||u.getAttrib(i,"cellspacing"),cellpadding:u.getAttrib(i,"cellpadding")||Yl(r.dom,i,"padding"),border:(a=u,s=i,l=Ge(At.fromDom(s),"border-width"),Ea(r)&&l.isSome()?l.getOr(""):a.getAttrib(s,"border")||Yl(r.dom,s,"border-width")||Yl(r.dom,s,"border")),caption:!!u.select("caption",i)[0],class:u.getAttrib(i,"class",""),align:ru(r,i)},o?Ql(u,i):{})):Pa(t)&&(d.borderstyle="",d.bordercolor="",d.backgroundcolor=""):(d.cols="1",d.rows="1",Pa(t)&&(d.borderstyle="",d.bordercolor="",d.backgroundcolor=""));var h=Kl(t.getParam("table_class_list",[],"array"));0<h.length&&d.class&&(d.class=d.class.replace(/\s*mce\-item\-table\s*/g,""));var p,g,m,v,y={type:"grid",columns:2,items:(p=h,g=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],m=t.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],v=0<p.length?[{type:"listbox",name:"class",label:"Class",items:p}]:[],g.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(m).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(v))},x=Pa(t)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[y]},eu("table")]}:{type:"panel",items:[y]};t.windowManager.open({title:"Table Properties",size:"normal",body:x,onSubmit:f(yu,t,n,d),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:d})},bu=function(t){return Nl(uo(t),io(t))},_u=function(t){return Ll(uo(t),io(t))},wu=function(t,e,i,o,a){var s=io(t),l=function(t){return on(t,s)},c=function(e){return function(n){t.selection.setRng(n.rng),t.focus(),i.clear(e),ao(e),ba(t,e.dom,n.effect)}},d=function(e){return _u(t).each(function(t){l(t).each(function(n){var r=ho(o,n,t);e(n,r).each(c(n))})})},h=function(){return _u(t).map(function(e){return l(e).bind(function(n){return function(t,e,n){var r=Tn(t);return ps(r,e).bind(function(t){var e=ss(r,n,!1),i=xn(e).rows.slice(t[0].row,t[t.length-1].row+t[t.length-1].rowspan),o=B(i,function(t){var e=O(t.cells,function(t){return!t.isLocked});return 0<e.length?[U(U({},t),{cells:e})]:[]}),a=ls(o,n);return Tr(0<a.length,a)}).map(function(t){return I(t,function(t){var e=Sr(t.element);return D(t.cells,function(t){var n=Cr(t.element);rs(n,"colspan",t.colspan,1),rs(n,"rowspan",t.rowspan,1),Un(e,n)}),e})})}(n,ho(o,n,e),Ki(u,At.fromDom(t.getDoc()),w.none()))})})},p=function(){return _u(t).map(function(t){return l(t).bind(function(e){return function(t,e){var n=Tn(t);return ms(n,e).map(function(t){var e,r,i=t[t.length-1],o=t[0].column,a=i.column+i.colspan;return q(function(t,e,n){if(En(t)){var r=O(Pn(t),function(t){return t.column>=e&&t.column<n}),i=I(r,function(t){var r=Cr(t.element);return ql(r,"span",n-e),r}),o=At.fromTag("colgroup");return Yn(o,i),[o]}return[]}(n,o,a),(e=o,r=a,I(n.all,function(t){var n=O(t.cells,function(t){return t.column>=e&&t.column<r}),i=I(n,function(t){var n=Cr(t.element);return ql(n,"colspan",r-e),n}),o=At.fromTag("tr");return Yn(o,i),o})))})}(e,ho(o,e,t))})})},g=function(e,n){return n().each(function(n){var r=I(n,Cr);_u(t).each(function(n){return l(n).each(function(n){var i,a,s=Ji(At.fromDom(t.getDoc())),l=(i=r,a=s,{selection:co(o),clipboard:i,generators:a});e(n,l).each(c(n))})})})};Nt({mceTableSplitCells:function(){return d(e.unmergeCells)},mceTableMergeCells:function(){return d(e.mergeCells)},mceTableInsertRowBefore:function(){return d(e.insertRowsBefore)},mceTableInsertRowAfter:function(){return d(e.insertRowsAfter)},mceTableInsertColBefore:function(){return d(e.insertColumnsBefore)},mceTableInsertColAfter:function(){return d(e.insertColumnsAfter)},mceTableDeleteCol:function(){return d(e.deleteColumn)},mceTableDeleteRow:function(){return d(e.deleteRow)},mceTableCutCol:function(t){return p().each(function(t){a.setColumns(t),d(e.deleteColumn)})},mceTableCutRow:function(t){return h().each(function(t){a.setRows(t),d(e.deleteRow)})},mceTableCopyCol:function(t){return p().each(function(t){return a.setColumns(t)})},mceTableCopyRow:function(t){return h().each(function(t){return a.setRows(t)})},mceTablePasteColBefore:function(t){return g(e.pasteColsBefore,a.getColumns)},mceTablePasteColAfter:function(t){return g(e.pasteColsAfter,a.getColumns)},mceTablePasteRowBefore:function(t){return g(e.pasteRowsBefore,a.getRows)},mceTablePasteRowAfter:function(t){return g(e.pasteRowsAfter,a.getRows)},mceTableDelete:function(){return bu(t).each(function(e){on(e,s).filter(m(s)).each(function(e){var n,r=At.fromText("");jn(e,r),Zn(e),t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):((n=t.dom.createRng()).setStart(r.dom,0),n.setEnd(r.dom,0),t.selection.setRng(n),t.nodeChanged())})})},mceTableSizingMode:function(e,n){return r=n,bu(t).each(function(e){Na(t)||La(t)||Ra(t)||on(e,s).each(function(e){"relative"!==r||No(e)?"fixed"!==r||Bo(e)?"responsive"!==r||zo(e)||qa(e):Ua(t,e):Ga(t,e),ao(e),ba(t,e.dom,wa)})});var r}},function(e,n){return t.addCommand(n,e)});var v=function(t,e){e.each(function(e){ba(t,e.dom,wa)})};Nt({mceTableCellType:function(n,r){var i=on(uo(t),s);e.setTableCellType(t,r),v(t,i)},mceTableRowType:function(n,r){var i=on(uo(t),s);e.setTableRowType(t,r),v(t,i)}},function(e,n){return t.addCommand(n,e)}),t.addCommand("mceTableColType",function(t,n){return Wt(n,"type").each(function(t){return d("th"===t?e.makeColumnsHeader:e.unmakeColumnsHeader)})}),Nt({mceTableProps:f(xu,t,!1),mceTableRowProps:f(gu,t),mceTableCellProps:f(du,t,o)},function(e,n){return t.addCommand(n,function(){return e()})}),t.addCommand("mceInsertTable",function(e,n){r(n)&&0<Rt(n).length?jl(t,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):xu(t,!0)}),t.addCommand("mceTableApplyCellStyle",function(e,i){var a,u,c=function(t){return"tablecell"+t.toLowerCase().replace("-","")};!r(i)||0!==(a=Bl(uo(t),o,s)).length&&(function(t){for(var e in t)if(Lt.call(t,e))return!1;return!0}(u=Vt(i,function(e,r){return t.formatter.has(c(r))&&n(e)}))||(Nt(u,function(e,n){D(a,function(r){lu.normal(t,r.dom).setFormat(c(n),e)})}),l(a[0]).each(function(e){return ba(t,e.dom,_a)})))})},Su={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},Cu=gr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Mu=U(U({},Cu),{none:function(t){return void 0===t&&(t=void 0),Cu.none(t)}}),Tu=function(t,e){return on(t,e).bind(function(e){var n=nn(e);return L(n,function(e){return Ot(t,e)}).map(function(t){return{index:t,all:n}})})},ku=function(t,e,n,r){return{start:t,soffset:e,finish:n,foffset:r}},Au=gr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Iu={before:Au.before,on:Au.on,after:Au.after,cata:function(t,e,n,r){return t.fold(e,n,r)},getStart:function(t){return t.fold(d,d,d)}},Du=gr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ou={domRange:Du.domRange,relative:Du.relative,exact:Du.exact,exactFromRange:function(t){return Du.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var e=t.match({domRange:function(t){return At.fromDom(t.startContainer)},relative:function(t,e){return Iu.getStart(t)},exact:function(t,e,n,r){return t}});return At.fromDom(ae(e).dom.defaultView)},range:ku},Pu=function(t,e,n){var r,i,o=t.document.createRange();return r=o,e.fold(function(t){r.setStartBefore(t.dom)},function(t,e){r.setStart(t.dom,e)},function(t){r.setStartAfter(t.dom)}),i=o,n.fold(function(t){i.setEndBefore(t.dom)},function(t,e){i.setEnd(t.dom,e)},function(t){i.setEndAfter(t.dom)}),o},Eu=function(t,e,n,r,i){var o=t.document.createRange();return o.setStart(e.dom,n),o.setEnd(r.dom,i),o},Ru=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},Lu=gr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Nu=function(t,e,n){return e(At.fromDom(n.startContainer),n.startOffset,At.fromDom(n.endContainer),n.endOffset)},Bu=function(t,e){var n,r,i,o=(n=t,e.match({domRange:function(t){return{ltr:c(t),rtl:w.none}},relative:function(t,e){return{ltr:Y(function(){return Pu(n,t,e)}),rtl:Y(function(){return w.some(Pu(n,e,t))})}},exact:function(t,e,r,i){return{ltr:Y(function(){return Eu(n,t,e,r,i)}),rtl:Y(function(){return w.some(Eu(n,r,i,t,e))})}}}));return(i=(r=o).ltr()).collapsed?r.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Lu.rtl(At.fromDom(t.endContainer),t.endOffset,At.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return Nu(0,Lu.ltr,i)}):Nu(0,Lu.ltr,i)},zu=function(t,e){return Bu(t,e).match({ltr:function(e,n,r,i){var o=t.document.createRange();return o.setStart(e.dom,n),o.setEnd(r.dom,i),o},rtl:function(e,n,r,i){var o=t.document.createRange();return o.setStart(r.dom,i),o.setEnd(e.dom,n),o}})},Vu=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom},Fu=function(t,e,n,r){return ee(e)?function(t,e,n,r){var i=t.dom.createRange();i.selectNode(e.dom);var o=i.getClientRects();return G(o,function(t){return Vu(t,n,r)?w.some(t):w.none()}).map(function(i){return function(t,e,n,r,i){var o=function(n){var r=t.dom.createRange();return r.setStart(e.dom,n),r.collapse(!0),r},a=Qn(e).length,s=function(t,e,n,r,i){if(0===i)return 0;if(e===r)return i-1;for(var o=r,a=1;a<i;a++){var s=t(a),l=Math.abs(e-s.left);if(n<=s.bottom){if(n<s.top||o<l)return a-1;o=l}}return 0}(function(t){return o(t).getBoundingClientRect()},n,r,i.right,a);return o(s)}(t,e,n,r,i)})}(t,e,n,r):(o=e,a=n,s=r,l=(i=t).dom.createRange(),u=de(o),G(u,function(t){return l.selectNode(t.dom),Vu(l.getBoundingClientRect(),a,s)?Fu(i,t,a,s):w.none()}));var i,o,a,s,l,u},Hu=function(t,e){return e-t.left<t.right-e},Wu=function(t,e,n){var r=t.dom.createRange();return r.selectNode(e.dom),r.collapse(n),r},ju=function(t,e,n){var r=t.dom.createRange();r.selectNode(e.dom);var i=r.getBoundingClientRect(),o=Hu(i,n);return(!0===o?Hi:Wi)(e).map(function(e){return Wu(t,e,o)})},Gu=function(t,e,n){var r=e.dom.getBoundingClientRect(),i=Hu(r,n);return w.some(Wu(t,e,i))},Uu=document.caretPositionFromPoint?function(t,e,n){return w.from(t.dom.caretPositionFromPoint(e,n)).bind(function(e){if(null===e.offsetNode)return w.none();var n=t.dom.createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),w.some(n)})}:document.caretRangeFromPoint?function(t,e,n){return w.from(t.dom.caretRangeFromPoint(e,n))}:function(t,e,n){return At.fromPoint(t,e,n).bind(function(r){var i=function(){return n=t,o=e,(0===de(i=r).length?Gu:ju)(n,i,o);var n,i,o};return 0===de(r).length?i():function(t,e,n,r){var i=t.dom.createRange();i.selectNode(e.dom);var o=i.getBoundingClientRect();return function(t,e,n,r){var i=t.dom.createRange();i.selectNode(e.dom);var o=i.getBoundingClientRect(),a=Math.max(o.left,Math.min(o.right,n)),s=Math.max(o.top,Math.min(o.bottom,r));return Fu(t,e,a,s)}(t,e,Math.max(o.left,Math.min(o.right,n)),Math.max(o.top,Math.min(o.bottom,r)))}(t,r,e,n).orThunk(i)})},qu=function(t,e){var n=Zt(t);return"input"===n?Iu.after(t):T(["br","img"],n)?0===e?Iu.before(t):Iu.after(t):Iu.on(t,e)},Xu=function(t,e){var n=t.fold(Iu.before,qu,Iu.after),r=e.fold(Iu.before,qu,Iu.after);return Ou.relative(n,r)},Yu=function(t,e,n,r){var i=qu(t,e),o=qu(n,r);return Ou.relative(i,o)},$u=function(t){return w.from(t.getSelection())},Zu=function(t,e){$u(t).each(function(t){t.removeAllRanges(),t.addRange(e)})},Ku=function(t,e,n,r,i){var o=Eu(t,e,n,r,i);Zu(t,o)},Ju=function(t,e){return Bu(t,e).match({ltr:function(e,n,r,i){Ku(t,e,n,r,i)},rtl:function(e,n,r,i){$u(t).each(function(o){if(o.setBaseAndExtent)o.setBaseAndExtent(e.dom,n,r.dom,i);else if(o.extend)try{s=r,l=i,(a=o).collapse(e.dom,n),a.extend(s.dom,l)}catch(u){Ku(t,r,i,e,n)}else Ku(t,r,i,e,n);var a,s,l})}})},Qu=function(t,e,n,r,i){var o=Yu(e,n,r,i);Ju(t,o)},tc=function(t,e,n){var r=Xu(e,n);Ju(t,r)},ec=function(t){if(0<t.rangeCount){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return w.some(ku(At.fromDom(e.startContainer),e.startOffset,At.fromDom(n.endContainer),n.endOffset))}return w.none()},nc=function(t){if(null===t.anchorNode||null===t.focusNode)return ec(t);var e=At.fromDom(t.anchorNode),n=At.fromDom(t.focusNode);return function(t,e,n,r){var i,o,a,s,l,u=(o=e,a=n,s=r,(l=oe(i=t).dom.createRange()).setStart(i.dom,o),l.setEnd(a.dom,s),l),c=Ot(t,n)&&e===r;return u.collapsed&&!c}(e,t.anchorOffset,n,t.focusOffset)?w.some(ku(e,t.anchorOffset,n,t.focusOffset)):ec(t)},rc=function(t){return $u(t).filter(function(t){return 0<t.rangeCount}).bind(nc).map(function(t){return Ou.exact(t.start,t.soffset,t.finish,t.foffset)})},ic=tinymce.util.Tools.resolve("tinymce.util.VK"),oc=function(t,e,n){return lc(t,e,Tu(r=n,void 0).fold(function(){return Mu.none(r)},function(t){return t.index+1<t.all.length?Mu.middle(r,t.all[t.index+1]):Mu.last(r)}));var r},ac=function(t,e,n){return lc(t,e,Tu(r=n,void 0).fold(function(){return Mu.none()},function(t){return 0<=t.index-1?Mu.middle(r,t.all[t.index-1]):Mu.first(r)}));var r},sc=function(t,e){return function(t){var e=Ou.getWin(t).dom,n=function(t,n,r,i){return Eu(e,t,n,r,i)},r=t.match({domRange:function(t){var e=At.fromDom(t.startContainer),n=At.fromDom(t.endContainer);return Yu(e,t.startOffset,n,t.endOffset)},relative:Xu,exact:Yu});return Bu(e,r).match({ltr:n,rtl:n})}(Ou.exact(e,0,e,0))},lc=function(t,e,n){return n.fold(w.none,w.none,function(t,e){return Hi(e).map(function(t){return sc(0,t)})},function(n){return on(n,e).bind(function(e){return t.execCommand("mceTableInsertRowAfter"),n=we(e,"tr"),j(n).bind(function(t){return Ie(t,"td,th").map(function(t){return sc(0,t)})});var n})})},uc=["table","li","dl"],cc=function(t,e){return{selection:t,kill:e}},dc=function(t,e,n,r){return{start:Iu.on(t,e),finish:Iu.on(n,r)}},fc=function(t,e){var n=zu(t,e);return ku(At.fromDom(n.startContainer),n.startOffset,At.fromDom(n.endContainer),n.endOffset)},hc=dc,pc=function(t,e,n,r,i){return Ot(n,r)?w.none():dr(n,r,e).bind(function(e){var r=e.boxes.getOr([]);return 0<r.length?(i(t,r,e.start,e.finish),w.some(cc(w.some(hc(n,0,n,zi(n))),!0))):w.none()})},gc=function(t,e){return{item:t,mode:e}},mc=function(t,e,n,r){return void 0===r&&(r=vc),t.property().parent(e).map(function(t){return gc(t,r)})},vc=function(t,e,n,r){return void 0===r&&(r=yc),n.sibling(t,e).map(function(t){return gc(t,r)})},yc=function(t,e,n,r){void 0===r&&(r=yc);var i=t.property().children(e);return n.first(i).map(function(t){return gc(t,r)})},xc=[{current:mc,next:vc,fallback:w.none()},{current:vc,next:yc,fallback:w.some(mc)},{current:yc,next:yc,fallback:w.some(vc)}],bc=function(t,e,n,r,i){return void 0===i&&(i=xc),R(i,function(t){return t.current===n}).bind(function(n){return n.current(t,e,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return bc(t,e,n,r)})})})},_c=function(t,e,n,r,i,o){return bc(t,e,r,i).bind(function(e){return o(e.item)?w.none():n(e.item)?w.some(e.item):_c(t,e.item,n,e.mode,i,o)})},wc=function(t){return function(e){return 0===t.property().children(e).length}},Sc=function(t,e,n,r){return _c(t,e,n,vc,{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return 0<t.length?w.some(t[t.length-1]):w.none()}},r)},Cc=function(t,e,n,r){return _c(t,e,n,vc,{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return 0<t.length?w.some(t[0]):w.none()}},r)},Mc=rr(),Tc=function(t,e){return Sc(n=Mc,t,wc(n),e);var n},kc=function(t,e){return Cc(n=Mc,t,wc(n),e);var n},Ac=gr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Ic=function(t){return De(t,"tr")},Dc=U(U({},Ac),{verify:function(t,e,n,r,i,o,a){return De(r,"td,th",a).bind(function(n){return De(e,"td,th",a).map(function(e){return Ot(n,e)?Ot(r,n)&&zi(n)===i?o(e):Ac.none("in same cell"):ur(Ic,[n,e]).fold(function(){return i=n,a=(r=t).getRect(e),(s=r.getRect(i)).right>a.left&&s.left<a.right?Ac.success():o(e);var r,i,a,s},function(t){return o(e)})})}).getOr(Ac.none("default"))},cata:function(t,e,n,r,i){return t.fold(e,n,r,i)}}),Oc=function(t){return"br"===Zt(t)},Pc=function(t,e,n){return e(t,n).bind(function(t){return ee(t)&&0===Qn(t).trim().length?Pc(t,e,n):w.some(t)})},Ec=function(t,e){return{left:t.left,top:t.top+e,right:t.right,bottom:t.bottom+e}},Rc=function(t,e){return{left:t.left,top:t.top-e,right:t.right,bottom:t.bottom-e}},Lc=function(t,e,n){return{left:t.left+e,top:t.top+n,right:t.right+e,bottom:t.bottom+n}},Nc=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}},Bc=function(t,e){return w.some(t.getRect(e))},zc=function(t,e,n){return te(e)?Bc(t,e).map(Nc):ee(e)?(r=t,i=e,(0<=(o=n)&&o<zi(i)?r.getRangedRect(i,o,i,o+1):0<o?r.getRangedRect(i,o-1,i,o):w.none()).map(Nc)):w.none();var r,i,o},Vc=function(t,e){return te(e)?Bc(t,e).map(Nc):ee(e)?t.getRangedRect(e,0,e,zi(e)).map(Nc):w.none()},Fc=gr([{none:[]},{retry:["caret"]}]),Hc=function(t,e,n){return Se(function(t,e){return e(t)},Te,e,Ys,void 0).fold(v,function(e){return Vc(t,e).exists(function(t){return(e=n).left<(r=t).left||Math.abs(r.right-e.left)<1||e.left>r.right;var e,r})})},Wc={point:function(t){return t.bottom},adjuster:function(t,e,n,r,i){var o=Ec(i,5);return Math.abs(n.bottom-r.bottom)<1||n.top>i.bottom?Fc.retry(o):n.top===i.bottom?Fc.retry(Ec(i,1)):Hc(t,e,i)?Fc.retry(Lc(o,5,0)):Fc.none()},move:Ec,gather:kc},jc=function(t,e,n,r,i){return 0===i?w.some(r):(s=t,l=r.left,u=e.point(r),s.elementFromPoint(l,u).filter(function(t){return"table"===Zt(t)}).isSome()?(a=i-1,jc(t,o=e,n,o.move(r,5),a)):t.situsFromPoint(r.left,e.point(r)).bind(function(o){return o.start.fold(w.none,function(o){return Vc(t,o).bind(function(a){return e.adjuster(t,o,a,n,r).fold(w.none,function(r){return jc(t,e,n,r,i-1)})}).orThunk(function(){return w.some(r)})},w.none)}));var o,a,s,l,u},Gc=function(t,e,n){var r,i,o,a=t.move(n,5),s=jc(e,t,n,a,100).getOr(a);return o=e,((r=t).point(i=s)>o.getInnerHeight()?w.some(r.point(i)-o.getInnerHeight()):r.point(i)<0?w.some(-r.point(i)):w.none()).fold(function(){return e.situsFromPoint(s.left,t.point(s))},function(n){return e.scrollBy(0,n),e.situsFromPoint(s.left,t.point(s)-n)})},Uc={tryUp:f(Gc,{point:function(t){return t.top},adjuster:function(t,e,n,r,i){var o=Rc(i,5);return Math.abs(n.top-r.top)<1||n.bottom<i.top?Fc.retry(o):n.bottom===i.top?Fc.retry(Rc(i,1)):Hc(t,e,i)?Fc.retry(Lc(o,5,0)):Fc.none()},move:Rc,gather:Tc}),tryDown:f(Gc,Wc),ieTryUp:function(t,e){return t.situsFromPoint(e.left,e.top-5)},ieTryDown:function(t,e){return t.situsFromPoint(e.left,e.bottom+5)},getJumpSize:c(5)},qc=function(t,e,n,r,i,o){return 0===o?w.none():$c(t,e,n,r,i).bind(function(a){var s=t.fromSitus(a),l=Dc.verify(t,n,r,s.finish,s.foffset,i.failure,e);return Dc.cata(l,function(){return w.none()},function(){return w.some(a)},function(a){return Ot(n,a)&&0===r?Xc(t,n,r,Rc,i):qc(t,e,a,0,i,o-1)},function(a){return Ot(n,a)&&r===zi(a)?Xc(t,n,r,Ec,i):qc(t,e,a,zi(a),i,o-1)})})},Xc=function(t,e,n,r,i){return zc(t,e,n).bind(function(e){return Yc(t,i,r(e,Uc.getJumpSize()))})},Yc=function(t,e,n){var r=Tt().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?e.otherRetry(t,n):r.isIE()?e.ieRetry(t,n):w.none()},$c=function(t,e,n,r,i){return zc(t,n,r).bind(function(e){return Yc(t,i,e)})},Zc=function(t,e,n,r,i){return De(r,"td,th",e).bind(function(r){return De(r,"table",e).bind(function(o){return function(t,e){return Te(t,function(t){return se(t).exists(function(t){return Ot(t,e)})},void 0).isSome()}(i,o)?function(t,e,n){return t.getSelection().bind(function(r){return function(t,e,n,r){var i,o,a;return(Oc(e)?(i=t,o=e,(a=r).traverse(o).orThunk(function(){return Pc(o,a.gather,i)}).map(a.relative)):function(t,e,n,r){return fe(i=e,o=n).filter(Oc).orThunk(function(){return fe(i,o-1).filter(Oc)}).bind(function(e){return r.traverse(e).fold(function(){return Pc(e,r.gather,t).map(r.relative)},function(t){return se(e=t).bind(function(t){var n=de(t);return function(t,e){return L(t,f(Ot,e))}(n,e).map(function(r){return{parent:t,children:n,element:e,index:r}})}).map(function(t){return Iu.on(t.parent,t.index)});var e})});var i,o}(t,e,n,r)).map(function(t){return{start:t,finish:t}})}(e,r.finish,r.foffset,n).fold(function(){return w.some(Za(r.finish,r.foffset))},function(i){var o=t.fromSitus(i),a=Dc.verify(t,r.finish,r.foffset,o.finish,o.foffset,n.failure,e);return Dc.cata(a,function(t){return w.none()},function(){return w.none()},function(t){return w.some(Za(t,0))},function(t){return w.some(Za(t,zi(t)))})})})}(a=t,s=e,l=n).bind(function(t){return qc(a,s,t.element,t.offset,l,20).map(a.fromSitus)}).bind(function(t){return De(t.finish,"td,th",e).map(function(e){return{start:r,finish:e,range:t}})}):w.none();var a,s,l})})},Kc=function(t,e,n,r,i,o){return Tt().browser.isIE()?w.none():o(r,e).orThunk(function(){return Zc(t,e,n,r,i).map(function(t){var e=t.range;return cc(w.some(hc(e.start,e.soffset,e.finish,e.foffset)),!0)})})},Jc=function(t,e){return De(t,"tr",e).bind(function(t){return De(t,"table",e).bind(function(n){var r=we(n,"tr");return Ot(t,r[0])?Sc(Mc,n,function(t){return Wi(t).isSome()},e).map(function(t){var e=zi(t);return cc(w.some(hc(t,e,t,e)),!0)}):w.none()})})},Qc=function(t,e){return De(t,"tr",e).bind(function(t){return De(t,"table",e).bind(function(n){var r=we(n,"tr");return Ot(t,r[r.length-1])?Cc(Mc,n,function(t){return Hi(t).isSome()},e).map(function(t){return cc(w.some(hc(t,0,t,0)),!0)}):w.none()})})},td=function(t,e,n,r,i,o,a){return Zc(t,n,r,i,o).bind(function(t){return pc(e,n,t.start,t.finish,a)})},ed=function(t,e){return De(t,"td,th",e)},nd=function(t,e,n,r){var i,o=(i=Pi(w.none()),{clear:function(){return i.set(w.none())},set:function(t){return i.set(w.some(t))},isSet:function(){return i.get().isSome()},on:function(t){return i.get().each(t)}}),a=o.clear,s=function(i){o.on(function(o){r.clearBeforeUpdate(e),ed(i.target,n).each(function(i){dr(o,i,n).each(function(n){var a=n.boxes.getOr([]);(1<a.length||1===a.length&&!Ot(o,i))&&(r.selectRange(e,a,n.start,n.finish),t.selectContents(i))})})})};return{clearstate:a,mousedown:function(t){r.clear(e),ed(t.target,n).each(o.set)},mouseover:function(t){s(t)},mouseup:function(t){s(t),a()}}},rd={traverse:ce,gather:kc,relative:Iu.before,otherRetry:Uc.tryDown,ieRetry:Uc.ieTryDown,failure:Dc.failedDown},id={traverse:ue,gather:Tc,relative:Iu.before,otherRetry:Uc.tryUp,ieRetry:Uc.ieTryUp,failure:Dc.failedUp},od=function(t){return function(e){return e===t}},ad=od(38),sd=od(40),ld=function(t){return 37<=t&&t<=40},ud={isBackward:od(37),isForward:od(39)},cd={isBackward:od(39),isForward:od(37)},dd=function(t){return{elementFromPoint:function(e,n){return At.fromPoint(At.fromDom(t.document),e,n)},getRect:function(t){return t.dom.getBoundingClientRect()},getRangedRect:function(e,n,r,i){var o=Ou.exact(e,n,r,i);return function(t,e){var n,r,i;return 0<(i=0<(r=(n=zu(t,e)).getClientRects()).length?r[0]:n.getBoundingClientRect()).width||0<i.height?w.some(i).map(Ru):w.none()}(t,o)},getSelection:function(){return rc(t).map(function(e){return fc(t,e)})},fromSitus:function(e){var n=Ou.relative(e.start,e.finish);return fc(t,n)},situsFromPoint:function(e,n){return function(t,e,n){return r=e,i=n,o=At.fromDom(t.document),Uu(o,r,i).map(function(t){return ku(At.fromDom(t.startContainer),t.startOffset,At.fromDom(t.endContainer),t.endOffset)});var r,i,o}(t,e,n).map(function(t){return dc(t.start,t.soffset,t.finish,t.foffset)})},clearSelection:function(){$u(t).each(function(t){return t.removeAllRanges()})},collapseSelection:function(e){void 0===e&&(e=!1),rc(t).each(function(n){return n.fold(function(t){return t.collapse(e)},function(n,r){var i=e?n:r;tc(t,i,i)},function(n,r,i,o){var a=e?n:i,s=e?r:o;Qu(t,a,s,a,s)})})},setSelection:function(e){Qu(t,e.start,e.soffset,e.finish,e.foffset)},setRelativeSelection:function(e,n){tc(t,e,n)},selectContents:function(e){!function(t,e){var n,r,i=(n=e,function(t,e){t.selectNodeContents(e.dom)}(r=t.document.createRange(),n),r);Zu(t,i)}(t,e)},getInnerHeight:function(){return t.innerHeight},getScrollY:function(){var e,n,r,i;return(e=At.fromDom(t.document),n=void 0!==e?e.dom:document,r=n.body.scrollLeft||n.documentElement.scrollLeft,i=n.body.scrollTop||n.documentElement.scrollTop,Fr(r,i)).top},scrollBy:function(e,n){var r,i,o,a;r=e,i=n,(a=(void 0!==(o=At.fromDom(t.document))?o.dom:document).defaultView)&&a.scrollBy(r,i)}}},fd=function(t,e){return{rows:t,cols:e}},hd=function(t){return!1===na(At.fromDom(t.target),"ephox-snooker-resizer-bar")};_r.add("table",function(t){var e,n,r,i,o,a,s,l,c=(e=function(){return eo(t)},n=function(){return Nl(uo(t))},r=fo.selectedSelector,{get:function(){return pr(e(),r).fold(function(){return n().map(br).getOrThunk(yr)},function(t){return xr(t)})}}),d=function(t,e){var n=Pi(w.none()),r=Pi([]),i=w.none(),o=ie("caption"),a=function(t){return i.forall(function(e){return!e[t]})},s=function(){return Nl(uo(t),io(t)).bind(function(t){return on(t).map(function(n){return o(t)?{element:r=t,mergable:w.none(),unmergable:w.none(),selection:[r]}:ho(e,n,t);var r})})},l=function(t){return on(t.element).map(function(e){var n=Tn(e),r=ps(n,t).getOr([]),i=E(r,function(t,e){return e.isLocked&&(t.onAny=!0,0===e.column?t.onFirst=!0:e.column+e.colspan>=n.grid.columns&&(t.onLast=!0)),t},{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:ys(n,t).isSome(),unmergeable:xs(n,t).isSome(),locked:i}})},u=function(){n.set(Y(s)()),i=n.get().bind(l),D(r.get(),function(t){return t()})},c=function(t,e){var i=function(){return n.get().fold(function(){t.setDisabled(!0)},function(n){t.setDisabled(e(n))})};return i(),r.set(r.get().concat([i])),function(){r.set(O(r.get(),function(t){return t!==i}))}},d=function(t){return i.exists(function(e){return e.locked[t]})};return t.on("NodeChange ExecCommand TableSelectorChange",u),{onSetupTable:function(t){return c(t,function(t){return!1})},onSetupCellOrRow:function(t){return c(t,function(t){return o(t.element)})},onSetupColumn:function(t){return function(e){return c(e,function(e){return o(e.element)||d(t)})}},onSetupPasteable:function(t){return function(e){return c(e,function(e){return o(e.element)||t().isNone()})}},onSetupPasteableColumn:function(t,e){return function(n){return c(n,function(n){return o(n.element)||t().isNone()||d(e)})}},onSetupMergeable:function(t){return c(t,function(t){return a("mergeable")})},onSetupUnmergeable:function(t){return c(t,function(t){return a("unmergeable")})},resetTargets:u,targets:function(){return n.get()}}}(t,c),h=$a(t),p=function(t,e,n){var r=function(e,n,r){var i=function(t){Ne(t,e.selected),Ne(t,e.firstSelected),Ne(t,e.lastSelected)},o=function(t){Pe(t,e.selected,"1")},a=function(e){s(e),t.fire("TableSelectionClear")},s=function(t){var n=we(t,e.selectedSelector);D(n,i)};return{clearBeforeUpdate:s,clear:a,selectRange:function(t,r,i,s){a(t),D(r,o),Pe(i,e.firstSelected,"1"),Pe(s,e.lastSelected,"1"),n(r,i,s)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}}(fo,function(e,r,i){n.targets().each(function(n){on(r).each(function(o){var a=Ha(t),s=Ki(u,At.fromDom(t.getDoc()),a),l=function(t,e,n){var r=Tn(t);return ps(r,e).map(function(t){var e,i,o,a,s,l,u,c,d,f=ss(r,n,!1);return{upOrLeftCells:(e=t,i=n,o=f.slice(0,e[e.length-1].row+1),a=ls(o,i),B(a,function(t){var n=t.cells.slice(0,e[e.length-1].column+1);return I(n,function(t){return t.element})})),downOrRightCells:(l=t,u=n,c=(s=f).slice(l[0].row+l[0].rowspan-1,s.length),d=ls(c,u),B(d,function(t){var e=t.cells.slice(l[0].column+l[0].colspan-1,t.cells.length);return I(e,function(t){return t.element})}))}})}(o,n,s);t.fire("TableSelectionChange",{cells:e,start:r,finish:i,otherCells:l})})})});return t.on("init",function(n){var i,o,a,s,l,c,d=t.getWin(),h=eo(t),p=io(t),g=(i=dd(d),{clearstate:(o=nd(i,h,p,r)).clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}),m=function(t,e,n,r){var i=dd(t),o=function(){return r.clear(e),w.none()};return{keydown:function(t,a,s,l,u,c){var d=t.raw,h=d.which,p=!0===d.shiftKey;return fr(e,r.selectedSelector).fold(function(){return sd(h)&&p?f(td,i,e,n,rd,l,a,r.selectRange):ad(h)&&p?f(td,i,e,n,id,l,a,r.selectRange):sd(h)?f(Kc,i,n,rd,l,a,Qc):ad(h)?f(Kc,i,n,id,l,a,Jc):w.none},function(t){var n=function(n){return function(){return G(n,function(n){return i=e,function(t,e,n,r,i){return o=i,R(t,function(t){return It(t,o)}).bind(function(t){return function(t,e,n){return on(t).bind(function(r){var i,o,a,s=Hn(r);return o=e,a=n,In(i=s,t,Ot).bind(function(t){return An(i,(0<o?t.row+t.rowspan-1:t.row)+o,(0<a?t.column+t.colspan-1:t.column)+a).map(function(t){return t.element})})})}(t,e,n).bind(function(t){return n=r,ke(e=t,"table").bind(function(t){return Ie(t,n).bind(function(t){return dr(t,e).bind(function(t){return t.boxes.map(function(e){return{boxes:e,start:t.start,finish:t.finish}})})})});var e,n})});var o}(t,n.rows,n.cols,(o=r).firstSelectedSelector,o.lastSelectedSelector).map(function(t){return o.clearBeforeUpdate(i),o.selectRange(i,t.boxes,t.start,t.finish),t.boxes});var i,o}).fold(function(){return hr(e,r.firstSelectedSelector,r.lastSelectedSelector).map(function(t){var n=sd(h)||c.isForward(h)?Iu.after:Iu.before;return i.setRelativeSelection(Iu.on(t.first,0),n(t.table)),r.clear(e),cc(w.none(),!0)})},function(t){return w.some(cc(w.none(),!0))})}};return sd(h)&&p?n([fd(1,0)]):ad(h)&&p?n([fd(-1,0)]):c.isBackward(h)&&p?n([fd(0,-1),fd(-1,0)]):c.isForward(h)&&p?n([fd(0,1),fd(1,0)]):ld(h)&&0==p?o:w.none})()},keyup:function(t,i,o,a,s){return fr(e,r.selectedSelector).fold(function(){var l,u,c,d,f,h,p,g=t.raw;return 0!=(!0===g.shiftKey)&&ld(g.which)?(l=e,u=n,d=o,h=s,p=r.selectRange,Ot(c=i,f=a)&&d===h?w.none():De(c,"td,th",u).bind(function(t){return De(f,"td,th",u).bind(function(e){return pc(l,u,t,e,p)})})):w.none()},w.none)}}}(d,h,p,r),v=(a=h,s=p,l=r,c=dd(d),function(t,e){l.clearBeforeUpdate(a),dr(t,e,s).each(function(t){var n=t.boxes.getOr([]);l.selectRange(a,n,t.start,t.finish),c.selectContents(e),c.collapseSelection()})});t.on("TableSelectorChange",function(t){return v(t.start,t.finish)});var y,x,b=function(e,n){!0===e.raw.shiftKey&&(n.kill&&e.kill(),n.selection.each(function(e){var n=Ou.relative(e.start,e.finish),r=zu(d,n);t.selection.setRng(r)}))},_=function(t){return 0===t.button},S=(y=Pi(At.fromDom(h)),x=Pi(0),{touchEnd:function(t){var e,n,r=At.fromDom(t.target);"td"!==Zt(r)&&"th"!==Zt(r)||(e=y.get(),n=x.get(),Ot(e,r)&&t.timeStamp-n<300&&(t.preventDefault(),v(r,r))),y.set(r),x.set(t.timeStamp)}});t.on("dragstart",function(t){g.clearstate()}),t.on("mousedown",function(t){_(t)&&hd(t)&&g.mousedown(Qo(t))}),t.on("mouseover",function(t){var e;(void 0===(e=t).buttons||mu.browser.isEdge()&&0===e.buttons||0!=(1&e.buttons))&&hd(t)&&g.mouseover(Qo(t))}),t.on("mouseup",function(t){_(t)&&hd(t)&&g.mouseup(Qo(t))}),t.on("touchend",S.touchEnd),t.on("keyup",function(e){var n,r,i,o=Qo(e);o.raw.shiftKey&&ld(o.raw.which)&&(n=t.selection.getRng(),r=At.fromDom(n.startContainer),i=At.fromDom(n.endContainer),m.keyup(o,r,n.startOffset,i,n.endOffset).each(function(t){b(o,t)}))}),t.on("keydown",function(n){var r=Qo(n);e().each(function(t){return t.hideBars()});var i=t.selection.getRng(),o=At.fromDom(i.startContainer),a=At.fromDom(i.endContainer),s=Rr(ud,cd)(At.fromDom(t.selection.getStart()));m.keydown(r,o,i.startOffset,a,i.endOffset,s).each(function(t){b(r,t)}),e().each(function(t){return t.showBars()})}),t.on("NodeChange",function(){var e=t.selection,n=At.fromDom(e.getStart()),i=At.fromDom(e.getEnd());ur(on,[n,i]).fold(function(){return r.clear(h)},u)})}),{clear:r.clear}}(t,h.lazyResize,d),g=function(t,e,n){var r=function(t){return"table"===Zt(eo(t))},i=Ha(t),o=Fa(t)?u:ns,a=function(e,n,r,o,a){return function(s,l){ao(s);var u=o(),c=At.fromDom(t.getDoc()),d=Ki(r,c,i),f=Wa(t,s),h=(Fa(t)?Co:Mo)();return n(s)?e(u,s,l,d,f,h).bind(function(e){return D(e.newRows,function(e){ya(t,e.dom)}),D(e.newCells,function(e){xa(t,e.dom)}),e.cursor.map(function(e){var n=ts(es,e),r=t.dom.createRng();return r.setStart(n.element.dom,n.offset),r.setEnd(n.element.dom,n.offset),{rng:r,effect:a}})}):w.none()}},s=a(ml,function(e){return!1===r(t)||1<Fo(e).rows},u,e,wa),l=a(gl,function(e){return!1===r(t)||1<Fo(e).columns},u,e,wa),c=a(dl,y,u,e,wa),d=a(fl,y,u,e,wa),f=a(hl,y,o,e,wa),h=a(pl,y,o,e,wa),p=a(xl,y,u,e,wa),g=a(bl,y,u,e,wa),m=a(wl,y,u,e,wa),v=a(Sl,y,u,e,wa),x=a(Cl,y,u,e,wa),b=a(Ml,y,u,e,wa),_=a(_l,y,u,e,wa),S=function(t,e){return Wt(t,"type").filter(function(t){return T(e,t)})};return{deleteRow:s,deleteColumn:l,insertRowsBefore:c,insertRowsAfter:d,insertColumnsBefore:f,insertColumnsAfter:h,mergeCells:p,unmergeCells:g,pasteColsBefore:m,pasteColsAfter:v,pasteRowsBefore:x,pasteRowsAfter:b,pasteCells:_,setTableCellType:function(t,e){return S(e,["td","th"]).each(function(e){var r=I(Bl(uo(t),n),function(t){return t.dom});Pl(t,r,e,null)})},setTableRowType:function(t,e){return S(e,["header","body","footer"]).each(function(e){I(zl(uo(t),fo.selected),function(n){return El(t,n.dom,e)})})},makeColumnsHeader:a(vl,y,u,e,wa),unmakeColumnsHeader:a(yl,y,u,e,wa),getTableRowType:function(t){var e=zl(uo(t),fo.selected);if(0<e.length){var n=I(e,function(t){return Il(0,t.dom)}),r=T(n,"header"),i=T(n,"footer");if(r||i){var o=T(n,"body");return!r||o||i?r||o||!i?"":"footer":"header"}return"body"}},getTableCellType:function(t){return rl(Bl(uo(t),n),function(t){return"th"===Zt(t)}).getOr("")},getTableColType:Tl}}(t,h.lazyWire,c),m=(i=Pi(w.none()),o=Pi(w.none()),a=function(t){t.set(w.none())},{getRows:i.get,setRows:function(t){i.set(t),a(o)},clearRows:function(){return a(i)},getColumns:o.get,setColumns:function(t){o.set(t),a(i)},clearColumns:function(){return a(o)}});return wu(t,g,p,c,m),function(t,e,n){var r=io(t);Nt({mceTableRowType:function(){return e.getTableRowType(t)},mceTableCellType:function(){return e.getTableCellType(t)},mceTableColType:function(){return Ll(uo(t)).bind(function(t){return on(t,r).map(function(r){var i=ho(n,r,t);return e.getTableColType(r,i)})}).getOr("")}},function(e,n){return t.addQueryValueHandler(n,e)})}(t,g,c),function(t,e,n,r){t.on("BeforeGetContent",function(n){!0===n.selection&&vr(e.get(),u,function(e){n.preventDefault(),on(e[0]).map(function(t){var e=function(t,e){var n,r,i,o,a,s,l,u,c,d=function(t){return It(t.element,e)},f=Cr(t),h=cn(f),p=Li(t),g=kn(h),m=(r=d,i=(n=g).grid.columns,o=n.grid.rows,a=i,l=s=0,u=[],c=[],Nt(n.access,function(t){var e,n,i,d;u.push(t),r(t)&&(c.push(t),n=(e=t.row)+t.rowspan-1,d=(i=t.column)+t.colspan-1,e<o?o=e:s<n&&(s=n),i<a?a=i:l<d&&(l=d))}),{minRow:o,minCol:a,maxRow:s,maxCol:l,allCells:u,selectedCells:c}),v=tn(f,"th,td",function(t){return It(t,"th:not([data-mce-selected]),td:not([data-mce-selected])")});return D(v,Zn),function(t,e,n,r){for(var i,o,a,s=e.grid.columns,l=e.grid.rows,u=0;u<l;u++)for(var c=!1,d=0;d<s;d++)u<n.minRow||u>n.maxRow||d<n.minCol||d>n.maxCol||(An(e,u,d).filter(r).isNone()?(i=c,o=t[u].element,a=At.fromTag("td"),Un(a,At.fromTag("br")),(i?Un:Gn)(o,a)):c=!0)}(h,g,m,d),function(t,e,n,r){Nt(n.columns,function(t){(t.column<e.minCol||t.column>e.maxCol)&&Zn(t.element)});var i=O(Qe(t,"tr"),function(t){return 0===t.dom.childElementCount});D(i,Zn),e.minCol!==e.maxCol&&e.minRow!==e.maxRow||D(Qe(t,"th,td"),function(t){Ne(t,"rowspan"),Ne(t,"colspan")}),Ne(t,bn),Ne(t,"data-snooker-col-series"),Li(t).adjustTableWidth(r)}(f,m,g,function(t,e,n,r){if(0===r.minCol&&e.grid.columns===r.maxCol+1)return 0;var i=Di(e,t,n),o=E(i,function(t,e){return t+e},0),a=E(i.slice(r.minCol,r.maxCol+1),function(t,e){return t+e},0)/o*n.pixelWidth()-n.pixelWidth();return n.getCellDelta(a)}(t,Tn(t),p,m)),f}(t,"[data-mce-selected]");return ao(e),[e]}).each(function(e){var r;n.content="text"===n.format?I(e,function(t){return t.dom.innerText}).join(""):(r=t,I(e,function(t){return r.selection.serializer.serialize(t.dom,{})}).join(""))})},u)}),t.on("BeforeSetContent",function(e){!0===e.selection&&!0===e.paste&&w.from(t.dom.getParent(t.selection.getStart(),"th,td")).each(function(i){var o=At.fromDom(i);on(o).each(function(i){var a,s,l,u,c=O((a=e.content,(s=document.createElement("div")).innerHTML=a,de(At.fromDom(s))),function(t){return"meta"!==Zt(t)});1===c.length&&"table"===Zt(c[0])&&(e.preventDefault(),l=At.fromDom(t.getDoc()),u=Ji(l),n.pasteCells(i,{element:o,clipboard:c[0],generators:u}).each(function(e){t.selection.setRng(e.rng),t.focus(),r.clear(i)}))})})})}(t,c,g,p),function(t,e,n){var r=function(e){return function(){return t.execCommand(e)}},i=function(e){t.execCommand("mceInsertTable",!1,{rows:e.numRows,columns:e.numColumns})},o={text:"Table properties",onSetup:e.onSetupTable,onAction:r("mceTableProps")},a={text:"Delete table",icon:"table-delete-table",onSetup:e.onSetupTable,onAction:r("mceTableDelete")};t.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:e.onSetupCellOrRow}),t.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:e.onSetupCellOrRow}),t.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:e.onSetupCellOrRow}),t.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:e.onSetupCellOrRow}),t.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:e.onSetupCellOrRow}),t.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:e.onSetupCellOrRow}),t.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:e.onSetupPasteable(n.getRows)}),t.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:e.onSetupPasteable(n.getRows)}),t.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:e.onSetupColumn("onFirst")}),t.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:e.onSetupColumn("onLast")}),t.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:e.onSetupColumn("onAny")}),t.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:e.onSetupColumn("onAny")}),t.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:e.onSetupColumn("onAny")}),t.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:e.onSetupPasteableColumn(n.getColumns,"onFirst")}),t.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:e.onSetupPasteableColumn(n.getColumns,"onLast")}),t.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:e.onSetupCellOrRow}),t.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:e.onSetupMergeable}),t.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:e.onSetupUnmergeable}),!1===t.getParam("table_grid",!0,"boolean")?t.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):t.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:i}]}}),t.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),t.ui.registry.addMenuItem("tableprops",o),t.ui.registry.addMenuItem("deletetable",a),t.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),t.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),t.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),t.ui.registry.addContextMenu("table",{update:function(){return e.resetTargets(),e.targets().fold(function(){return""},function(t){return"caption"===Zt(t.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}})}(t,d,m),function(t,e,n){t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(t){return t("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(e){return function(){return t.execCommand(e)}};t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:e.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:e.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:e.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:e.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:e.onSetupColumn("onFirst")}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:e.onSetupColumn("onLast")}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:e.onSetupColumn("onAny")}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:e.onSetupPasteable(n.getRows)}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:e.onSetupPasteable(n.getRows)}),t.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:e.onSetupColumn("onAny")}),t.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:e.onSetupColumn("onAny")}),t.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:e.onSetupPasteableColumn(n.getColumns,"onFirst")}),t.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:e.onSetupPasteableColumn(n.getColumns,"onLast")}),t.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}(t,d,m),0<(l=(s=t).getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")).length&&s.ui.registry.addContextToolbar("table",{predicate:function(t){return s.dom.is(t,"table")&&s.getBody().contains(t)},items:l,scope:"node",position:"node"}),t.on("PreInit",function(){t.serializer.addTempAttr(fo.firstSelected),t.serializer.addTempAttr(fo.lastSelected),t.formatter.register(Su)}),t.getParam("table_tab_navigation",!0,"boolean")&&t.on("keydown",function(e){var n,r,i,o,a,s,l;r=t,i=p,(n=e).keyCode===ic.TAB&&(o=eo(r),a=function(t){var e=Zt(t);return Ot(t,o)||T(uc,e)},s=r.selection.getRng(),l=At.fromDom(n.shiftKey?s.startContainer:s.endContainer),en(l,a).each(function(t){n.preventDefault(),on(t,a).each(i.clear),r.selection.collapse(n.shiftKey),(n.shiftKey?ac:oc)(r,a,t).each(function(t){r.selection.setRng(t)})}))}),t.on("remove",function(){h.destroy()}),function(t,e,n,r){return{insertTable:(i=t,function(t,e,n){void 0===n&&(n={});var r=jl(i,e,t,n,"Invalid values for insertTable - rows and columns values are required to insert a table.");return i.undoManager.add(),r}),setClipboardRows:Ul(e.setRows),getClipboardRows:Gl(e.getRows),setClipboardCols:Ul(e.setColumns),getClipboardCols:Gl(e.getColumns),resizeHandler:n,selectionTargets:r};var i}(t,m,h,d)})}(),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.echarts={})}(this,function(t){"use strict";var e,n=2311,r=function(){return n++},i="object"==typeof wx&&"function"==typeof wx.getSystemInfoSync?{browser:{},os:{},node:!1,wxa:!0,canvasSupported:!0,svgSupported:!1,touchEventsSupported:!0,domSupported:!1}:"undefined"==typeof document&&"undefined"!=typeof self?{browser:{},os:{},node:!1,worker:!0,canvasSupported:!0,domSupported:!1}:"undefined"==typeof navigator?{browser:{},os:{},node:!0,worker:!1,canvasSupported:!0,svgSupported:!0,domSupported:!1}:function(t){var e={},n=t.match(/Firefox\/([\d.]+)/),r=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),i=t.match(/Edge\/([\d.]+)/),o=/micromessenger/i.test(t);return n&&(e.firefox=!0,e.version=n[1]),r&&(e.ie=!0,e.version=r[1]),i&&(e.edge=!0,e.version=i[1]),o&&(e.weChat=!0),{browser:e,os:{},node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!=typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!e.ie&&!e.edge,pointerEventsSupported:"onpointerdown"in window&&(e.edge||e.ie&&11<=e.version),domSupported:"undefined"!=typeof document}}(navigator.userAgent),o={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},a={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},s=Object.prototype.toString,l=Array.prototype,u=l.forEach,c=l.filter,d=l.slice,f=l.map,h=l.reduce,p={};function g(t,n){"createCanvas"===t&&(e=null),p[t]=n}function m(t){if(null==t||"object"!=typeof t)return t;var e=t,n=s.call(t);if("[object Array]"===n){if(!K(t)){e=[];for(var r=0,i=t.length;r<i;r++)e[r]=m(t[r])}}else if(a[n]){if(!K(t)){var l=t.constructor;if(t.constructor.from)e=l.from(t);else for(e=new l(t.length),r=0,i=t.length;r<i;r++)e[r]=m(t[r])}}else if(!o[n]&&!K(t)&&!F(t))for(var u in e={},t)t.hasOwnProperty(u)&&(e[u]=m(t[u]));return e}function v(t,e,n){if(!B(e)||!B(t))return n?m(e):t;for(var r in e)if(e.hasOwnProperty(r)){var i=t[r],o=e[r];!B(o)||!B(i)||R(o)||R(i)||F(o)||F(i)||z(o)||z(i)||K(o)||K(i)?!n&&r in t||(t[r]=m(e[r])):v(i,o,n)}return t}function y(t,e){for(var n=t[0],r=1,i=t.length;r<i;r++)n=v(n,t[r],e);return n}function x(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function b(t,e,n){for(var r in e)e.hasOwnProperty(r)&&(n?null!=e[r]:null==t[r])&&(t[r]=e[r]);return t}function _(){return p.createCanvas()}function w(){return e=e||_().getContext("2d")}function S(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n}return-1}function C(t,e){var n=t.prototype;function r(){}for(var i in r.prototype=e.prototype,t.prototype=new r,n)n.hasOwnProperty(i)&&(t.prototype[i]=n[i]);(t.prototype.constructor=t).superClass=e}function M(t,e,n){b(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,n)}function T(t){if(t)return"string"!=typeof t&&"number"==typeof t.length}function k(t,e,n){if(t&&e)if(t.forEach&&t.forEach===u)t.forEach(e,n);else if(t.length===+t.length)for(var r=0,i=t.length;r<i;r++)e.call(n,t[r],r,t);else for(var o in t)t.hasOwnProperty(o)&&e.call(n,t[o],o,t)}function A(t,e,n){if(t&&e){if(t.map&&t.map===f)return t.map(e,n);for(var r=[],i=0,o=t.length;i<o;i++)r.push(e.call(n,t[i],i,t));return r}}function I(t,e,n,r){if(t&&e){if(t.reduce&&t.reduce===h)return t.reduce(e,n,r);for(var i=0,o=t.length;i<o;i++)n=e.call(r,n,t[i],i,t);return n}}function D(t,e,n){if(t&&e){if(t.filter&&t.filter===c)return t.filter(e,n);for(var r=[],i=0,o=t.length;i<o;i++)e.call(n,t[i],i,t)&&r.push(t[i]);return r}}function O(t,e,n){if(t&&e)for(var r=0,i=t.length;r<i;r++)if(e.call(n,t[r],r,t))return t[r]}function P(t,e){var n=d.call(arguments,2);return function(){return t.apply(e,n.concat(d.call(arguments)))}}function E(t){var e=d.call(arguments,1);return function(){return t.apply(this,e.concat(d.call(arguments)))}}function R(t){return"[object Array]"===s.call(t)}function L(t){return"function"==typeof t}function N(t){return"[object String]"===s.call(t)}function B(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function z(t){return!!o[s.call(t)]}function V(t){return!!a[s.call(t)]}function F(t){return"object"==typeof t&&"number"==typeof t.nodeType&&"object"==typeof t.ownerDocument}function H(t){return t!=t}function W(t){for(var e=0,n=arguments.length;e<n;e++)if(null!=arguments[e])return arguments[e]}function j(t,e){return null!=t?t:e}function G(t,e,n){return null!=t?t:null!=e?e:n}function U(){return Function.call.apply(d,arguments)}function q(t){if("number"==typeof t)return[t,t,t,t];var e=t.length;return 2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t}function X(t,e){if(!t)throw new Error(e)}function Y(t){return null==t?null:"function"==typeof t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}p.createCanvas=function(){return document.createElement("canvas")};var $="__ec_primitive__";function Z(t){t[$]=!0}function K(t){return t[$]}function J(t){var e=R(t);this.data={};var n=this;function r(t,r){e?n.set(t,r):n.set(r,t)}t instanceof J?t.each(r):t&&k(t,r)}function Q(t){return new J(t)}function tt(t,e){for(var n=new t.constructor(t.length+e.length),r=0;r<t.length;r++)n[r]=t[r];var i=t.length;for(r=0;r<e.length;r++)n[r+i]=e[r];return n}function et(){}J.prototype={constructor:J,get:function(t){return this.data.hasOwnProperty(t)?this.data[t]:null},set:function(t,e){return this.data[t]=e},each:function(t,e){for(var n in void 0!==e&&(t=P(t,e)),this.data)this.data.hasOwnProperty(n)&&t(this.data[n],n)},removeKey:function(t){delete this.data[t]}};var nt=(Object.freeze||Object)({$override:g,clone:m,merge:v,mergeAll:y,extend:x,defaults:b,createCanvas:_,getContext:w,indexOf:S,inherits:C,mixin:M,isArrayLike:T,each:k,map:A,reduce:I,filter:D,find:O,bind:P,curry:E,isArray:R,isFunction:L,isString:N,isObject:B,isBuiltInObject:z,isTypedArray:V,isDom:F,eqNaN:H,retrieve:W,retrieve2:j,retrieve3:G,slice:U,normalizeCssArray:q,assert:X,trim:Y,setAsPrimitive:Z,isPrimitive:K,createHashMap:Q,concatArray:tt,noop:et}),rt="undefined"==typeof Float32Array?Array:Float32Array;function it(t,e){var n=new rt(2);return null==t&&(t=0),null==e&&(e=0),n[0]=t,n[1]=e,n}function ot(t,e){return t[0]=e[0],t[1]=e[1],t}function at(t){var e=new rt(2);return e[0]=t[0],e[1]=t[1],e}function st(t,e,n){return t[0]=e,t[1]=n,t}function lt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function ut(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function ct(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function dt(t){return Math.sqrt(ft(t))}function ft(t){return t[0]*t[0]+t[1]*t[1]}function ht(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function pt(t,e){var n=dt(e);return 0===n?(t[0]=0,t[1]=0):(t[0]=e[0]/n,t[1]=e[1]/n),t}function gt(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}var mt=gt;function vt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}var yt=vt;function xt(t,e,n,r){return t[0]=e[0]+r*(n[0]-e[0]),t[1]=e[1]+r*(n[1]-e[1]),t}function bt(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function _t(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function wt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}var St=(Object.freeze||Object)({create:it,copy:ot,clone:at,set:st,add:lt,scaleAndAdd:ut,sub:ct,len:dt,length:dt,lenSquare:ft,lengthSquare:ft,mul:function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},div:function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]},scale:ht,normalize:pt,distance:gt,dist:mt,distanceSquare:vt,distSquare:yt,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t},lerp:xt,applyTransform:bt,min:_t,max:wt});function Ct(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this)}function Mt(t,e){return{target:t,topTarget:e&&e.topTarget}}Ct.prototype={constructor:Ct,_dragStart:function(t){for(var e=t.target;e&&!e.draggable;)e=e.parent;e&&((this._draggingTarget=e).dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.dispatchToElement(Mt(e,t),"dragstart",t.event))},_drag:function(t){var e=this._draggingTarget;if(e){var n=t.offsetX,r=t.offsetY,i=n-this._x,o=r-this._y;this._x=n,this._y=r,e.drift(i,o,t),this.dispatchToElement(Mt(e,t),"drag",t.event);var a=this.findHover(n,r,e).target,s=this._dropTarget;e!==(this._dropTarget=a)&&(s&&a!==s&&this.dispatchToElement(Mt(s,t),"dragleave",t.event),a&&a!==s&&this.dispatchToElement(Mt(a,t),"dragenter",t.event))}},_dragEnd:function(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.dispatchToElement(Mt(e,t),"dragend",t.event),this._dropTarget&&this.dispatchToElement(Mt(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null}};var Tt=Array.prototype.slice,kt=function(t){this._$handlers={},this._$eventProcessor=t};function At(t,e,n,r,i,o){var a=t._$handlers;if("function"==typeof n&&(i=r,r=n,n=null),!r||!e)return t;n=function(t,e){var n=t._$eventProcessor;return null!=e&&n&&n.normalizeQuery&&(e=n.normalizeQuery(e)),e}(t,n),a[e]||(a[e]=[]);for(var s=0;s<a[e].length;s++)if(a[e][s].h===r)return t;var l={h:r,one:o,query:n,ctx:i||t,callAtLast:r.zrEventfulCallAtLast},u=a[e].length-1,c=a[e][u];return c&&c.callAtLast?a[e].splice(u,0,l):a[e].push(l),t}kt.prototype={constructor:kt,one:function(t,e,n,r){return At(this,t,e,n,r,!0)},on:function(t,e,n,r){return At(this,t,e,n,r,!1)},isSilent:function(t){var e=this._$handlers;return!e[t]||!e[t].length},off:function(t,e){var n=this._$handlers;if(!t)return this._$handlers={},this;if(e){if(n[t]){for(var r=[],i=0,o=n[t].length;i<o;i++)n[t][i].h!==e&&r.push(n[t][i]);n[t]=r}n[t]&&0===n[t].length&&delete n[t]}else delete n[t];return this},trigger:function(t){var e=this._$handlers[t],n=this._$eventProcessor;if(e){var r=arguments,i=r.length;3<i&&(r=Tt.call(r,1));for(var o=e.length,a=0;a<o;){var s=e[a];if(n&&n.filter&&null!=s.query&&!n.filter(t,s.query))a++;else{switch(i){case 1:s.h.call(s.ctx);break;case 2:s.h.call(s.ctx,r[1]);break;case 3:s.h.call(s.ctx,r[1],r[2]);break;default:s.h.apply(s.ctx,r)}s.one?(e.splice(a,1),o--):a++}}}return n&&n.afterTrigger&&n.afterTrigger(t),this},triggerWithContext:function(t){var e=this._$handlers[t],n=this._$eventProcessor;if(e){var r=arguments,i=r.length;4<i&&(r=Tt.call(r,1,r.length-1));for(var o=r[r.length-1],a=e.length,s=0;s<a;){var l=e[s];if(n&&n.filter&&null!=l.query&&!n.filter(t,l.query))s++;else{switch(i){case 1:l.h.call(o);break;case 2:l.h.call(o,r[1]);break;case 3:l.h.call(o,r[1],r[2]);break;default:l.h.apply(o,r)}l.one?(e.splice(s,1),a--):s++}}}return n&&n.afterTrigger&&n.afterTrigger(t),this}};var It=Math.log(2);function Dt(t,e,n,r,i,o){var a=r+"-"+i,s=t.length;if(o.hasOwnProperty(a))return o[a];if(1===e){var l=Math.round(Math.log((1<<s)-1&~i)/It);return t[n][l]}for(var u=r|1<<n,c=n+1;r&1<<c;)c++;for(var d=0,f=0,h=0;f<s;f++){var p=1<<f;p&i||(d+=(h%2?-1:1)*t[n][f]*Dt(t,e-1,c,u,i|p,o),h++)}return o[a]=d}function Ot(t,e){var n=[[t[0],t[1],1,0,0,0,-e[0]*t[0],-e[0]*t[1]],[0,0,0,t[0],t[1],1,-e[1]*t[0],-e[1]*t[1]],[t[2],t[3],1,0,0,0,-e[2]*t[2],-e[2]*t[3]],[0,0,0,t[2],t[3],1,-e[3]*t[2],-e[3]*t[3]],[t[4],t[5],1,0,0,0,-e[4]*t[4],-e[4]*t[5]],[0,0,0,t[4],t[5],1,-e[5]*t[4],-e[5]*t[5]],[t[6],t[7],1,0,0,0,-e[6]*t[6],-e[6]*t[7]],[0,0,0,t[6],t[7],1,-e[7]*t[6],-e[7]*t[7]]],r={},i=Dt(n,8,0,0,0,r);if(0!==i){for(var o=[],a=0;a<8;a++)for(var s=0;s<8;s++)null==o[s]&&(o[s]=0),o[s]+=((a+s)%2?-1:1)*Dt(n,7,0===a?1:0,1<<a,1<<s,r)/i*e[a];return function(t,e,n){var r=e*o[6]+n*o[7]+1;t[0]=(e*o[0]+n*o[1]+o[2])/r,t[1]=(e*o[3]+n*o[4]+o[5])/r}}}var Pt="___zrEVENTSAVED",Et=[];function Rt(t,e,n,r,o){if(e.getBoundingClientRect&&i.domSupported&&!Lt(e)){var a=e[Pt]||(e[Pt]={}),s=function(t,e,n){for(var r=n?"invTrans":"trans",i=e[r],o=e.srcCoords,a=!0,s=[],l=[],u=0;u<4;u++){var c=t[u].getBoundingClientRect(),d=2*u,f=c.left,h=c.top;s.push(f,h),a=a&&o&&f===o[d]&&h===o[1+d],l.push(t[u].offsetLeft,t[u].offsetTop)}return a&&i?i:(e.srcCoords=s,e[r]=n?Ot(l,s):Ot(s,l))}(function(t,e){var n=e.markers;if(n)return n;n=e.markers=[];for(var r=["left","right"],i=["top","bottom"],o=0;o<4;o++){var a=document.createElement("div"),s=o%2,l=(o>>1)%2;a.style.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",r[s]+":0",i[l]+":0",r[1-s]+":auto",i[1-l]+":auto",""].join("!important;"),t.appendChild(a),n.push(a)}return n}(e,a),a,o);if(s)return s(t,n,r),!0}return!1}function Lt(t){return"CANVAS"===t.nodeName.toUpperCase()}var Nt="undefined"!=typeof window&&!!window.addEventListener,Bt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,zt=[];function Vt(t,e,n,r){return n=n||{},r||!i.canvasSupported?Ft(t,e,n):i.browser.firefox&&null!=e.layerX&&e.layerX!==e.offsetX?(n.zrX=e.layerX,n.zrY=e.layerY):null!=e.offsetX?(n.zrX=e.offsetX,n.zrY=e.offsetY):Ft(t,e,n),n}function Ft(t,e,n){if(i.domSupported&&t.getBoundingClientRect){var r=e.clientX,o=e.clientY;if(Lt(t)){var a=t.getBoundingClientRect();return n.zrX=r-a.left,void(n.zrY=o-a.top)}if(Rt(zt,t,r,o))return n.zrX=zt[0],void(n.zrY=zt[1])}n.zrX=n.zrY=0}function Ht(t){return t||window.event}function Wt(t,e,n){if(null!=(e=Ht(e)).zrX)return e;var r=e.type;if(r&&0<=r.indexOf("touch")){var i="touchend"!==r?e.targetTouches[0]:e.changedTouches[0];i&&Vt(t,i,e,n)}else Vt(t,e,e,n),e.zrDelta=e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3;var o=e.button;return null==e.which&&void 0!==o&&Bt.test(e.type)&&(e.which=1&o?1:2&o?3:4&o?2:0),e}function jt(t,e,n,r){Nt?t.addEventListener(e,n,r):t.attachEvent("on"+e,n)}var Gt=Nt?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0}:function(t){t.returnValue=!1,t.cancelBubble=!0};function Ut(t){return 2===t.which||3===t.which}function qt(){this._track=[]}function Xt(t){var e=t[1][0]-t[0][0],n=t[1][1]-t[0][1];return Math.sqrt(e*e+n*n)}qt.prototype={constructor:qt,recognize:function(t,e,n){return this._doTrack(t,e,n),this._recognize(t)},clear:function(){return this._track.length=0,this},_doTrack:function(t,e,n){var r=t.touches;if(r){for(var i={points:[],touches:[],target:e,event:t},o=0,a=r.length;o<a;o++){var s=r[o],l=Vt(n,s,{});i.points.push([l.zrX,l.zrY]),i.touches.push(s)}this._track.push(i)}},_recognize:function(t){for(var e in Yt)if(Yt.hasOwnProperty(e)){var n=Yt[e](this._track,t);if(n)return n}}};var Yt={pinch:function(t,e){var n=t.length;if(n){var r=(t[n-1]||{}).points,i=(t[n-2]||{}).points||r;if(i&&1<i.length&&r&&1<r.length){var o=Xt(r)/Xt(i);isFinite(o)||(o=1),e.pinchScale=o;var a=function(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]}(r);return e.pinchX=a[0],e.pinchY=a[1],{type:"pinch",target:t[0].target,event:e}}}}},$t="silent";function Zt(){Gt(this.event)}function Kt(){}function Jt(t,e,n,r){kt.call(this),this.storage=t,this.painter=e,this.painterRoot=r,n=n||new Kt,this.proxy=null,this._hovered={},Ct.call(this),this.setHandlerProxy(n)}Kt.prototype.dispose=function(){};var Qt=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"];function te(t,e,n){if(t[t.rectHover?"rectContain":"contain"](e,n)){for(var r,i=t;i;){if(i.clipPath&&!i.clipPath.contain(e,n))return!1;i.silent&&(r=!0),i=i.parent}return!r||$t}return!1}function ee(t,e,n){var r=t.painter;return e<0||e>r.getWidth()||n<0||n>r.getHeight()}Jt.prototype={constructor:Jt,setHandlerProxy:function(t){this.proxy&&this.proxy.dispose(),t&&(k(Qt,function(e){t.on&&t.on(e,this[e],this)},this),t.handler=this),this.proxy=t},mousemove:function(t){var e=t.zrX,n=t.zrY,r=ee(this,e,n),i=this._hovered,o=i.target;o&&!o.__zr&&(o=(i=this.findHover(i.x,i.y)).target);var a=this._hovered=r?{x:e,y:n}:this.findHover(e,n),s=a.target,l=this.proxy;l.setCursor&&l.setCursor(s?s.cursor:"default"),o&&s!==o&&this.dispatchToElement(i,"mouseout",t),this.dispatchToElement(a,"mousemove",t),s&&s!==o&&this.dispatchToElement(a,"mouseover",t)},mouseout:function(t){var e=t.zrEventControl,n=t.zrIsToLocalDOM;"only_globalout"!==e&&this.dispatchToElement(this._hovered,"mouseout",t),"no_globalout"!==e&&(n||this.trigger("globalout",{type:"globalout",event:t}))},resize:function(t){this._hovered={}},dispatch:function(t,e){var n=this[t];n&&n.call(this,e)},dispose:function(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null},setCursorStyle:function(t){var e=this.proxy;e.setCursor&&e.setCursor(t)},dispatchToElement:function(t,e,n){var r=(t=t||{}).target;if(!r||!r.silent){for(var i="on"+e,o=function(t,e,n){return{type:t,event:n,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:n.zrX,offsetY:n.zrY,gestureEvent:n.gestureEvent,pinchX:n.pinchX,pinchY:n.pinchY,pinchScale:n.pinchScale,wheelDelta:n.zrDelta,zrByTouch:n.zrByTouch,which:n.which,stop:Zt}}(e,t,n);r&&(r[i]&&(o.cancelBubble=r[i].call(r,o)),r.trigger(e,o),r=r.parent,!o.cancelBubble););o.cancelBubble||(this.trigger(e,o),this.painter&&this.painter.eachOtherLayer(function(t){"function"==typeof t[i]&&t[i].call(t,o),t.trigger&&t.trigger(e,o)}))}},findHover:function(t,e,n){for(var r=this.storage.getDisplayList(),i={x:t,y:e},o=r.length-1;0<=o;o--){var a;if(r[o]!==n&&!r[o].ignore&&(a=te(r[o],t,e))&&(i.topTarget||(i.topTarget=r[o]),a!==$t)){i.target=r[o];break}}return i},processGesture:function(t,e){this._gestureMgr||(this._gestureMgr=new qt);var n=this._gestureMgr;"start"===e&&n.clear();var r=n.recognize(t,this.findHover(t.zrX,t.zrY,null).target,this.proxy.dom);if("end"===e&&n.clear(),r){var i=r.type;t.gestureEvent=i,this.dispatchToElement({target:r.target},i,r.event)}}},k(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){Jt.prototype[t]=function(e){var n,r,i=e.zrX,o=e.zrY,a=ee(this,i,o);if("mouseup"===t&&a||(r=(n=this.findHover(i,o)).target),"mousedown"===t)this._downEl=r,this._downPoint=[e.zrX,e.zrY],this._upEl=r;else if("mouseup"===t)this._upEl=r;else if("click"===t){if(this._downEl!==this._upEl||!this._downPoint||4<mt(this._downPoint,[e.zrX,e.zrY]))return;this._downPoint=null}this.dispatchToElement(n,t,e)}}),M(Jt,kt),M(Jt,Ct);var ne="undefined"==typeof Float32Array?Array:Float32Array;function re(){var t=new ne(6);return ie(t),t}function ie(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function oe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function ae(t,e,n){var r=e[1]*n[0]+e[3]*n[1],i=e[0]*n[2]+e[2]*n[3],o=e[1]*n[2]+e[3]*n[3],a=e[0]*n[4]+e[2]*n[5]+e[4],s=e[1]*n[4]+e[3]*n[5]+e[5];return t[0]=e[0]*n[0]+e[2]*n[1],t[1]=r,t[2]=i,t[3]=o,t[4]=a,t[5]=s,t}function se(t,e,n){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+n[0],t[5]=e[5]+n[1],t}function le(t,e,n){var r=e[0],i=e[2],o=e[4],a=e[1],s=e[3],l=e[5],u=Math.sin(n),c=Math.cos(n);return t[0]=r*c+a*u,t[1]=-r*u+a*c,t[2]=i*c+s*u,t[3]=-i*u+c*s,t[4]=c*o+u*l,t[5]=c*l-u*o,t}function ue(t,e,n){var r=n[0],i=n[1];return t[0]=e[0]*r,t[1]=e[1]*i,t[2]=e[2]*r,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*i,t}function ce(t,e){var n=e[0],r=e[2],i=e[4],o=e[1],a=e[3],s=e[5],l=n*a-o*r;return l?(t[0]=a*(l=1/l),t[1]=-o*l,t[2]=-r*l,t[3]=n*l,t[4]=(r*s-a*i)*l,t[5]=(o*i-n*s)*l,t):null}function de(t){var e=re();return oe(e,t),e}var fe=(Object.freeze||Object)({create:re,identity:ie,copy:oe,mul:ae,translate:se,rotate:le,scale:ue,invert:ce,clone:de}),he=ie;function pe(t){return 5e-5<t||t<-5e-5}var ge=function(t){(t=t||{}).position||(this.position=[0,0]),null==t.rotation&&(this.rotation=0),t.scale||(this.scale=[1,1]),this.origin=this.origin||null},me=ge.prototype;me.transform=null,me.needLocalTransform=function(){return pe(this.rotation)||pe(this.position[0])||pe(this.position[1])||pe(this.scale[0]-1)||pe(this.scale[1]-1)};var ve=[];me.updateTransform=function(){var t=this.parent,e=t&&t.transform,n=this.needLocalTransform(),r=this.transform;if(n||e){r=r||re(),n?this.getLocalTransform(r):he(r),e&&(n?ae(r,t.transform,r):oe(r,t.transform)),this.transform=r;var i=this.globalScaleRatio;if(null!=i&&1!==i){this.getGlobalScale(ve);var o=ve[0]<0?-1:1,a=ve[1]<0?-1:1,s=((ve[0]-o)*i+o)/ve[0]||0,l=((ve[1]-a)*i+a)/ve[1]||0;r[0]*=s,r[1]*=s,r[2]*=l,r[3]*=l}this.invTransform=this.invTransform||re(),ce(this.invTransform,r)}else r&&he(r)},me.getLocalTransform=function(t){return ge.getLocalTransform(this,t)},me.setTransform=function(t){var e=this.transform,n=t.dpr||1;e?t.setTransform(n*e[0],n*e[1],n*e[2],n*e[3],n*e[4],n*e[5]):t.setTransform(n,0,0,n,0,0)},me.restoreTransform=function(t){var e=t.dpr||1;t.setTransform(e,0,0,e,0,0)};var ye=[],xe=re();me.setLocalTransform=function(t){if(t){var e=t[0]*t[0]+t[1]*t[1],n=t[2]*t[2]+t[3]*t[3],r=this.position,i=this.scale;pe(e-1)&&(e=Math.sqrt(e)),pe(n-1)&&(n=Math.sqrt(n)),t[0]<0&&(e=-e),t[3]<0&&(n=-n),r[0]=t[4],r[1]=t[5],i[0]=e,i[1]=n,this.rotation=Math.atan2(-t[1]/n,t[0]/e)}},me.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&(ae(ye,t.invTransform,e),e=ye);var n=this.origin;n&&(n[0]||n[1])&&(xe[4]=n[0],xe[5]=n[1],ae(ye,e,xe),ye[4]-=n[0],ye[5]-=n[1],e=ye),this.setLocalTransform(e)}},me.getGlobalScale=function(t){var e=this.transform;return t=t||[],e?(t[0]=Math.sqrt(e[0]*e[0]+e[1]*e[1]),t[1]=Math.sqrt(e[2]*e[2]+e[3]*e[3]),e[0]<0&&(t[0]=-t[0]),e[3]<0&&(t[1]=-t[1])):(t[0]=1,t[1]=1),t},me.transformCoordToLocal=function(t,e){var n=[t,e],r=this.invTransform;return r&&bt(n,n,r),n},me.transformCoordToGlobal=function(t,e){var n=[t,e],r=this.transform;return r&&bt(n,n,r),n},ge.getLocalTransform=function(t,e){he(e=e||[]);var n=t.origin,r=t.scale||[1,1],i=t.rotation||0,o=t.position||[0,0];return n&&(e[4]-=n[0],e[5]-=n[1]),ue(e,e,r),i&&le(e,e,i),n&&(e[4]+=n[0],e[5]+=n[1]),e[4]+=o[0],e[5]+=o[1],e};var be={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Math.PI/2)},sinusoidalOut:function(t){return Math.sin(t*Math.PI/2)},sinusoidalInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},exponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},exponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},elasticOut:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},elasticInOut:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),(t*=2)<1?n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)},backIn:function(t){return t*t*(2.70158*t-1.70158)},backOut:function(t){return--t*t*(2.70158*t+1.70158)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)},bounceIn:function(t){return 1-be.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*be.bounceIn(2*t):.5*be.bounceOut(2*t-1)+.5}};function _e(t){this._target=t.target,this._life=t.life||1e3,this._delay=t.delay||0,this._initialized=!1,this.loop=null!=t.loop&&t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart,this._pausedTime=0,this._paused=!1}function we(){this.head=null,this.tail=null,this._len=0}_e.prototype={constructor:_e,step:function(t,e){if(this._initialized||(this._startTime=t+this._delay,this._initialized=!0),this._paused)this._pausedTime+=e;else{var n=(t-this._startTime-this._pausedTime)/this._life;if(!(n<0)){n=Math.min(n,1);var r=this.easing,i="string"==typeof r?be[r]:r,o="function"==typeof i?i(n):n;return this.fire("frame",o),1===n?this.loop?(this.restart(t),"restart"):(this._needsRemove=!0,"destroy"):null}}},restart:function(t){this._startTime=t-(t-this._startTime-this._pausedTime)%this._life+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(t,e){this[t="on"+t]&&this[t](this._target,e)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}};var Se=we.prototype;function Ce(t){this._list=new we,this._map={},this._maxSize=t||10,this._lastRemovedEntry=null}Se.insert=function(t){var e=new Me(t);return this.insertEntry(e),e},Se.insertEntry=function(t){this.head?((this.tail.next=t).prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},Se.remove=function(t){var e=t.prev,n=t.next;e?e.next=n:this.head=n,n?n.prev=e:this.tail=e,t.next=t.prev=null,this._len--},Se.len=function(){return this._len},Se.clear=function(){this.head=this.tail=null,this._len=0};var Me=function(t){this.value=t},Te=Ce.prototype;Te.put=function(t,e){var n=this._list,r=this._map,i=null;if(null==r[t]){var o=n.len(),a=this._lastRemovedEntry;if(o>=this._maxSize&&0<o){var s=n.head;n.remove(s),delete r[s.key],i=s.value,this._lastRemovedEntry=s}a?a.value=e:a=new Me(e),a.key=t,n.insertEntry(a),r[t]=a}return i},Te.get=function(t){var e=this._map[t],n=this._list;if(null!=e)return e!==n.tail&&(n.remove(e),n.insertEntry(e)),e.value},Te.clear=function(){this._list.clear(),this._map={}};var ke={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ae(t){return(t=Math.round(t))<0?0:255<t?255:t}function Ie(t){return t<0?0:1<t?1:t}function De(t){return t.length&&"%"===t.charAt(t.length-1)?Ae(parseFloat(t)/100*255):Ae(parseInt(t,10))}function Oe(t){return t.length&&"%"===t.charAt(t.length-1)?Ie(parseFloat(t)/100):Ie(parseFloat(t))}function Pe(t,e,n){return n<0?n+=1:1<n&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function Ee(t,e,n){return t+(e-t)*n}function Re(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function Le(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}var Ne=new Ce(20),Be=null;function ze(t,e){Be&&Le(Be,e),Be=Ne.put(t,Be||e.slice())}function Ve(t,e){if(t){e=e||[];var n=Ne.get(t);if(n)return Le(e,n);var r,i=(t+="").replace(/ /g,"").toLowerCase();if(i in ke)return Le(e,ke[i]),ze(t,e),e;if("#"===i.charAt(0))return 4===i.length?0<=(r=parseInt(i.substr(1),16))&&r<=4095?(Re(e,(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1),ze(t,e),e):void Re(e,0,0,0,1):7===i.length?0<=(r=parseInt(i.substr(1),16))&&r<=16777215?(Re(e,(16711680&r)>>16,(65280&r)>>8,255&r,1),ze(t,e),e):void Re(e,0,0,0,1):void 0;var o=i.indexOf("("),a=i.indexOf(")");if(-1!==o&&a+1===i.length){var s=i.substr(0,o),l=i.substr(o+1,a-(o+1)).split(","),u=1;switch(s){case"rgba":if(4!==l.length)return void Re(e,0,0,0,1);u=Oe(l.pop());case"rgb":return 3!==l.length?void Re(e,0,0,0,1):(Re(e,De(l[0]),De(l[1]),De(l[2]),u),ze(t,e),e);case"hsla":return 4!==l.length?void Re(e,0,0,0,1):(l[3]=Oe(l[3]),Fe(l,e),ze(t,e),e);case"hsl":return 3!==l.length?void Re(e,0,0,0,1):(Fe(l,e),ze(t,e),e);default:return}}Re(e,0,0,0,1)}}function Fe(t,e){var n=(parseFloat(t[0])%360+360)%360/360,r=Oe(t[1]),i=Oe(t[2]),o=i<=.5?i*(r+1):i+r-i*r,a=2*i-o;return Re(e=e||[],Ae(255*Pe(a,o,n+1/3)),Ae(255*Pe(a,o,n)),Ae(255*Pe(a,o,n-1/3)),1),4===t.length&&(e[3]=t[3]),e}function He(t,e){var n=Ve(t);if(n){for(var r=0;r<3;r++)n[r]=e<0?n[r]*(1-e)|0:(255-n[r])*e+n[r]|0,255<n[r]?n[r]=255:t[r]<0&&(n[r]=0);return Xe(n,4===n.length?"rgba":"rgb")}}function We(t){var e=Ve(t);if(e)return((1<<24)+(e[0]<<16)+(e[1]<<8)+ +e[2]).toString(16).slice(1)}function je(t,e,n){if(e&&e.length&&0<=t&&t<=1){n=n||[];var r=t*(e.length-1),i=Math.floor(r),o=Math.ceil(r),a=e[i],s=e[o],l=r-i;return n[0]=Ae(Ee(a[0],s[0],l)),n[1]=Ae(Ee(a[1],s[1],l)),n[2]=Ae(Ee(a[2],s[2],l)),n[3]=Ie(Ee(a[3],s[3],l)),n}}function Ge(t,e,n){if(e&&e.length&&0<=t&&t<=1){var r=t*(e.length-1),i=Math.floor(r),o=Math.ceil(r),a=Ve(e[i]),s=Ve(e[o]),l=r-i,u=Xe([Ae(Ee(a[0],s[0],l)),Ae(Ee(a[1],s[1],l)),Ae(Ee(a[2],s[2],l)),Ie(Ee(a[3],s[3],l))],"rgba");return n?{color:u,leftIndex:i,rightIndex:o,value:r}:u}}function Ue(t,e,n,r){if(t=Ve(t))return t=function(t){if(t){var e,n,r=t[0]/255,i=t[1]/255,o=t[2]/255,a=Math.min(r,i,o),s=Math.max(r,i,o),l=s-a,u=(s+a)/2;if(0==l)n=e=0;else{n=u<.5?l/(s+a):l/(2-s-a);var c=((s-r)/6+l/2)/l,d=((s-i)/6+l/2)/l,f=((s-o)/6+l/2)/l;r===s?e=f-d:i===s?e=1/3+c-f:o===s&&(e=2/3+d-c),e<0&&(e+=1),1<e&&(e-=1)}var h=[360*e,n,u];return null!=t[3]&&h.push(t[3]),h}}(t),null!=e&&(t[0]=function(t){return(t=Math.round(t))<0?0:360<t?360:t}(e)),null!=n&&(t[1]=Oe(n)),null!=r&&(t[2]=Oe(r)),Xe(Fe(t),"rgba")}function qe(t,e){if((t=Ve(t))&&null!=e)return t[3]=Ie(e),Xe(t,"rgba")}function Xe(t,e){if(t&&t.length){var n=t[0]+","+t[1]+","+t[2];return"rgba"!==e&&"hsva"!==e&&"hsla"!==e||(n+=","+t[3]),e+"("+n+")"}}var Ye=(Object.freeze||Object)({parse:Ve,lift:He,toHex:We,fastLerp:je,fastMapToColor:je,lerp:Ge,mapToColor:Ge,modifyHSL:Ue,modifyAlpha:qe,stringify:Xe}),$e=Array.prototype.slice;function Ze(t,e){return t[e]}function Ke(t,e,n){t[e]=n}function Je(t,e,n){return(e-t)*n+t}function Qe(t,e,n){return.5<n?e:t}function tn(t,e,n,r,i){var o=t.length;if(1===i)for(var a=0;a<o;a++)r[a]=Je(t[a],e[a],n);else{var s=o&&t[0].length;for(a=0;a<o;a++)for(var l=0;l<s;l++)r[a][l]=Je(t[a][l],e[a][l],n)}}function en(t,e,n){var r=t.length,i=e.length;if(r!==i)if(i<r)t.length=i;else for(var o=r;o<i;o++)t.push(1===n?e[o]:$e.call(e[o]));var a=t[0]&&t[0].length;for(o=0;o<t.length;o++)if(1===n)isNaN(t[o])&&(t[o]=e[o]);else for(var s=0;s<a;s++)isNaN(t[o][s])&&(t[o][s]=e[o][s])}function nn(t,e,n){if(t===e)return!0;var r=t.length;if(r!==e.length)return!1;if(1===n){for(var i=0;i<r;i++)if(t[i]!==e[i])return!1}else{var o=t[0].length;for(i=0;i<r;i++)for(var a=0;a<o;a++)if(t[i][a]!==e[i][a])return!1}return!0}function rn(t,e,n,r,i,o,a,s,l){var u=t.length;if(1===l)for(var c=0;c<u;c++)s[c]=on(t[c],e[c],n[c],r[c],i,o,a);else{var d=t[0].length;for(c=0;c<u;c++)for(var f=0;f<d;f++)s[c][f]=on(t[c][f],e[c][f],n[c][f],r[c][f],i,o,a)}}function on(t,e,n,r,i,o,a){var s=.5*(n-t),l=.5*(r-e);return(2*(e-n)+s+l)*a+(-3*(e-n)-2*s-l)*o+s*i+e}function an(t){if(T(t)){var e=t.length;if(T(t[0])){for(var n=[],r=0;r<e;r++)n.push($e.call(t[r]));return n}return $e.call(t)}return t}function sn(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")"}function ln(t,e,n,r,i,o){var a=t._getter,s=t._setter,l="spline"===e,u=r.length;if(u){var c,d=T(r[0].value),f=!1,h=!1,p=d?function(t){var e=t[t.length-1].value;return T(e&&e[0])?2:1}(r):0;r.sort(function(t,e){return t.time-e.time}),c=r[u-1].time;for(var g=[],m=[],v=r[0].value,y=!0,x=0;x<u;x++){g.push(r[x].time/c);var b=r[x].value;if(d&&nn(b,v,p)||!d&&b===v||(y=!1),"string"==typeof(v=b)){var _=Ve(b);_?(b=_,f=!0):h=!0}m.push(b)}if(o||!y){var w=m[u-1];for(x=0;x<u-1;x++)d?en(m[x],w,p):!isNaN(m[x])||isNaN(w)||h||f||(m[x]=w);d&&en(a(t._target,i),w,p);var S,C,M,k,A,I=0,D=0;if(f)var O=[0,0,0,0];var P=new _e({target:t._target,life:c,loop:t._loop,delay:t._delay,onframe:function(t,e){var n;if(e<0)n=0;else if(e<D){for(n=Math.min(I+1,u-1);0<=n&&!(g[n]<=e);n--);n=Math.min(n,u-2)}else{for(n=I;n<u&&!(g[n]>e);n++);n=Math.min(n-1,u-2)}D=e;var r=g[(I=n)+1]-g[n];if(0!=r)if(S=(e-g[n])/r,l)if(M=m[n],C=m[0===n?n:n-1],k=m[u-2<n?u-1:n+1],A=m[u-3<n?u-1:n+2],d)rn(C,M,k,A,S,S*S,S*S*S,a(t,i),p);else{if(f)o=rn(C,M,k,A,S,S*S,S*S*S,O,1),o=sn(O);else{if(h)return Qe(M,k,S);o=on(C,M,k,A,S,S*S,S*S*S)}s(t,i,o)}else if(d)tn(m[n],m[n+1],S,a(t,i),p);else{var o;if(f)tn(m[n],m[n+1],S,O,1),o=sn(O);else{if(h)return Qe(m[n],m[n+1],S);o=Je(m[n],m[n+1],S)}s(t,i,o)}},ondestroy:n});return e&&"spline"!==e&&(P.easing=e),P}}}function un(t,e,n,r){this._tracks={},this._target=t,this._loop=e||!1,this._getter=n||Ze,this._setter=r||Ke,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]}un.prototype={when:function(t,e){var n=this._tracks;for(var r in e)if(e.hasOwnProperty(r)){if(!n[r]){n[r]=[];var i=this._getter(this._target,r);if(null==i)continue;0!==t&&n[r].push({time:0,value:an(i)})}n[r].push({time:t,value:e[r]})}return this},during:function(t){return this._onframeList.push(t),this},pause:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].pause();this._paused=!0},resume:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var t=this._doneList,e=t.length,n=0;n<e;n++)t[n].call(this)},start:function(t,e){function n(){--o||i._doneCallback()}var r,i=this,o=0;for(var a in this._tracks)if(this._tracks.hasOwnProperty(a)){var s=ln(this,t,n,this._tracks[a],a,e);s&&(this._clipList.push(s),o++,this.animation&&this.animation.addClip(s),r=s)}if(r){var l=r.onframe;r.onframe=function(t,e){l(t,e);for(var n=0;n<i._onframeList.length;n++)i._onframeList[n](t,e)}}return o||this._doneCallback(),this},stop:function(t){for(var e=this._clipList,n=this.animation,r=0;r<e.length;r++){var i=e[r];t&&i.onframe(this._target,1),n&&n.removeClip(i)}e.length=0},delay:function(t){return this._delay=t,this},done:function(t){return t&&this._doneList.push(t),this},getClips:function(){return this._clipList}};var cn=1;"undefined"!=typeof window&&(cn=Math.max(window.devicePixelRatio||1,1));var dn=cn;function fn(){this.animators=[]}function hn(t,e,n,r,i,o,a,s){N(r)?(o=i,i=r,r=0):L(i)?(o=i,i="linear",r=0):L(r)?(o=r,r=0):n=L(n)?(o=n,500):n||500,t.stopAnimation(),function t(e,n,r,i,o,a,s){var l={},u=0;for(var c in i)i.hasOwnProperty(c)&&(null!=r[c]?B(i[c])&&!T(i[c])?t(e,n?n+"."+c:c,r[c],i[c],o,a,s):(s?(l[c]=r[c],pn(e,n,c,i[c])):l[c]=i[c],u++):null==i[c]||s||pn(e,n,c,i[c]));0<u&&e.animate(n,!1).when(null==o?500:o,l).delay(a||0)}(t,"",t,e,n,r,s);var l=t.animators.slice(),u=l.length;function c(){--u||o&&o()}u||o&&o();for(var d=0;d<l.length;d++)l[d].done(c).start(i,a)}function pn(t,e,n,r){if(e){var i={};i[e]={},i[e][n]=r,t.attr(i)}else t.attr(n,r)}fn.prototype={constructor:fn,animate:function(t,e){var n,r=!1,i=this,o=this.__zr;if(t){var a=t.split("."),s=i;r="shape"===a[0];for(var l=0,u=a.length;l<u;l++)s=s&&s[a[l]];s&&(n=s)}else n=i;if(n){var c=i.animators,d=new un(n,e);return d.during(function(t){i.dirty(r)}).done(function(){c.splice(S(c,d),1)}),c.push(d),o&&o.animation.addAnimator(d),d}},stopAnimation:function(t){for(var e=this.animators,n=e.length,r=0;r<n;r++)e[r].stop(t);return e.length=0,this},animateTo:function(t,e,n,r,i,o){hn(this,t,e,n,r,i,o)},animateFrom:function(t,e,n,r,i,o){hn(this,t,e,n,r,i,o,!0)}};var gn=function(t){ge.call(this,t),kt.call(this,t),fn.call(this,t),this.id=t.id||r()};gn.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,isGroup:!1,drift:function(t,e){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0}var n=this.transform;(n=n||(this.transform=[1,0,0,1,0,0]))[4]+=t,n[5]+=e,this.decomposeTransform(),this.dirty(!1)},beforeUpdate:function(){},afterUpdate:function(){},update:function(){this.updateTransform()},traverse:function(t,e){},attrKV:function(t,e){if("position"===t||"scale"===t||"origin"===t){if(e){var n=this[t];(n=n||(this[t]=[]))[0]=e[0],n[1]=e[1]}}else this[t]=e},hide:function(){this.ignore=!0,this.__zr&&this.__zr.refresh()},show:function(){this.ignore=!1,this.__zr&&this.__zr.refresh()},attr:function(t,e){if("string"==typeof t)this.attrKV(t,e);else if(B(t))for(var n in t)t.hasOwnProperty(n)&&this.attrKV(n,t[n]);return this.dirty(!1),this},setClipPath:function(t){var e=this.__zr;e&&t.addSelfToZr(e),this.clipPath&&this.clipPath!==t&&this.removeClipPath(),(this.clipPath=t).__zr=e,(t.__clipTarget=this).dirty(!1)},removeClipPath:function(){var t=this.clipPath;t&&(t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__clipTarget=null,this.clipPath=null,this.dirty(!1))},addSelfToZr:function(t){this.__zr=t;var e=this.animators;if(e)for(var n=0;n<e.length;n++)t.animation.addAnimator(e[n]);this.clipPath&&this.clipPath.addSelfToZr(t)},removeSelfFromZr:function(t){this.__zr=null;var e=this.animators;if(e)for(var n=0;n<e.length;n++)t.animation.removeAnimator(e[n]);this.clipPath&&this.clipPath.removeSelfFromZr(t)}},M(gn,fn),M(gn,ge),M(gn,kt);var mn,vn,yn,xn,bn=bt,_n=Math.min,wn=Math.max;function Sn(t,e,n,r){n<0&&(t+=n,n=-n),r<0&&(e+=r,r=-r),this.x=t,this.y=e,this.width=n,this.height=r}Sn.prototype={constructor:Sn,union:function(t){var e=_n(t.x,this.x),n=_n(t.y,this.y);this.width=wn(t.x+t.width,this.x+this.width)-e,this.height=wn(t.y+t.height,this.y+this.height)-n,this.x=e,this.y=n},applyTransform:(mn=[],vn=[],yn=[],xn=[],function(t){if(t){mn[0]=yn[0]=this.x,mn[1]=xn[1]=this.y,vn[0]=xn[0]=this.x+this.width,vn[1]=yn[1]=this.y+this.height,bn(mn,mn,t),bn(vn,vn,t),bn(yn,yn,t),bn(xn,xn,t),this.x=_n(mn[0],vn[0],yn[0],xn[0]),this.y=_n(mn[1],vn[1],yn[1],xn[1]);var e=wn(mn[0],vn[0],yn[0],xn[0]),n=wn(mn[1],vn[1],yn[1],xn[1]);this.width=e-this.x,this.height=n-this.y}}),calculateTransform:function(t){var e=t.width/this.width,n=t.height/this.height,r=re();return se(r,r,[-this.x,-this.y]),ue(r,r,[e,n]),se(r,r,[t.x,t.y]),r},intersect:function(t){if(!t)return!1;t instanceof Sn||(t=Sn.create(t));var e=this;return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)},contain:function(t,e){var n=this;return t>=n.x&&t<=n.x+n.width&&e>=n.y&&e<=n.y+n.height},clone:function(){return new Sn(this.x,this.y,this.width,this.height)},copy:function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},Sn.create=function(t){return new Sn(t.x,t.y,t.width,t.height)};var Cn=function(t){for(var e in gn.call(this,t=t||{}),t)t.hasOwnProperty(e)&&(this[e]=t[e]);this._children=[],this.__storage=null,this.__dirty=!0};function Mn(t,e,n,r){var i=e+1;if(i===n)return 1;if(r(t[i++],t[e])<0){for(;i<n&&r(t[i],t[i-1])<0;)i++;!function(t,e,n){for(n--;e<n;){var r=t[e];t[e++]=t[n],t[n--]=r}}(t,e,i)}else for(;i<n&&0<=r(t[i],t[i-1]);)i++;return i-e}function Tn(t,e,n,r,i){for(r===e&&r++;r<n;r++){for(var o,a=t[r],s=e,l=r;s<l;)i(a,t[o=s+l>>>1])<0?l=o:s=1+o;var u=r-s;switch(u){case 3:t[s+3]=t[s+2];case 2:t[s+2]=t[s+1];case 1:t[s+1]=t[s];break;default:for(;0<u;)t[s+u]=t[s+u-1],u--}t[s]=a}}function kn(t,e,n,r,i,o){var a=0,s=0,l=1;if(0<o(t,e[n+i])){for(s=r-i;l<s&&0<o(t,e[n+i+l]);)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s),a+=i,l+=i}else{for(s=i+1;l<s&&o(t,e[n+i-l])<=0;)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s);var u=a;a=i-l,l=i-u}for(a++;a<l;){var c=a+(l-a>>>1);0<o(t,e[n+c])?a=c+1:l=c}return l}function An(t,e,n,r,i,o){var a=0,s=0,l=1;if(o(t,e[n+i])<0){for(s=i+1;l<s&&o(t,e[n+i-l])<0;)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s);var u=a;a=i-l,l=i-u}else{for(s=r-i;l<s&&0<=o(t,e[n+i+l]);)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s),a+=i,l+=i}for(a++;a<l;){var c=a+(l-a>>>1);o(t,e[n+c])<0?l=c:a=c+1}return l}function In(t,e){var n,r,i=7,o=0,a=[];function s(s){var l=n[s],u=r[s],c=n[s+1],d=r[s+1];r[s]=u+d,s===o-3&&(n[s+1]=n[s+2],r[s+1]=r[s+2]),o--;var f=An(t[c],t,l,u,0,e);l+=f,0!=(u-=f)&&0!==(d=kn(t[l+u-1],t,c,d,d-1,e))&&(u<=d?function(n,r,o,s){var l=0;for(l=0;l<r;l++)a[l]=t[n+l];var u=0,c=o,d=n;if(t[d++]=t[c++],0!=--s){if(1===r){for(l=0;l<s;l++)t[d+l]=t[c+l];return t[d+s]=a[u]}for(var f,h,p,g=i;;){h=f=0,p=!1;do{if(e(t[c],a[u])<0){if(t[d++]=t[c++],h++,(f=0)==--s){p=!0;break}}else if(t[d++]=a[u++],f++,h=0,1==--r){p=!0;break}}while((f|h)<g);if(p)break;do{if(0!==(f=An(t[c],a,u,r,0,e))){for(l=0;l<f;l++)t[d+l]=a[u+l];if(d+=f,u+=f,(r-=f)<=1){p=!0;break}}if(t[d++]=t[c++],0==--s){p=!0;break}if(0!==(h=kn(a[u],t,c,s,0,e))){for(l=0;l<h;l++)t[d+l]=t[c+l];if(d+=h,c+=h,0==(s-=h)){p=!0;break}}if(t[d++]=a[u++],1==--r){p=!0;break}g--}while(7<=f||7<=h);if(p)break;g<0&&(g=0),g+=2}if((i=g)<1&&(i=1),1===r){for(l=0;l<s;l++)t[d+l]=t[c+l];t[d+s]=a[u]}else{if(0===r)throw new Error;for(l=0;l<r;l++)t[d+l]=a[u+l]}}else for(l=0;l<r;l++)t[d+l]=a[u+l]}(l,u,c,d):function(n,r,o,s){var l=0;for(l=0;l<s;l++)a[l]=t[o+l];var u=n+r-1,c=s-1,d=o+s-1,f=0,h=0;if(t[d--]=t[u--],0!=--r){if(1===s){for(h=1+(d-=r),f=1+(u-=r),l=r-1;0<=l;l--)t[h+l]=t[f+l];return t[d]=a[c]}for(var p=i;;){var g=0,m=0,v=!1;do{if(e(a[c],t[u])<0){if(t[d--]=t[u--],g++,(m=0)==--r){v=!0;break}}else if(t[d--]=a[c--],m++,g=0,1==--s){v=!0;break}}while((g|m)<p);if(v)break;do{if(0!=(g=r-An(a[c],t,n,r,r-1,e))){for(r-=g,h=1+(d-=g),f=1+(u-=g),l=g-1;0<=l;l--)t[h+l]=t[f+l];if(0===r){v=!0;break}}if(t[d--]=a[c--],1==--s){v=!0;break}if(0!=(m=s-kn(t[u],a,0,s,s-1,e))){for(s-=m,h=1+(d-=m),f=1+(c-=m),l=0;l<m;l++)t[h+l]=a[f+l];if(s<=1){v=!0;break}}if(t[d--]=t[u--],0==--r){v=!0;break}p--}while(7<=g||7<=m);if(v)break;p<0&&(p=0),p+=2}if((i=p)<1&&(i=1),1===s){for(h=1+(d-=r),f=1+(u-=r),l=r-1;0<=l;l--)t[h+l]=t[f+l];t[d]=a[c]}else{if(0===s)throw new Error;for(f=d-(s-1),l=0;l<s;l++)t[f+l]=a[l]}}else for(f=d-(s-1),l=0;l<s;l++)t[f+l]=a[l]}(l,u,c,d))}n=[],r=[],this.mergeRuns=function(){for(;1<o;){var t=o-2;if(1<=t&&r[t-1]<=r[t]+r[t+1]||2<=t&&r[t-2]<=r[t]+r[t-1])r[t-1]<r[t+1]&&t--;else if(r[t]>r[t+1])break;s(t)}},this.forceMergeRuns=function(){for(;1<o;){var t=o-2;0<t&&r[t-1]<r[t+1]&&t--,s(t)}},this.pushRun=function(t,e){n[o]=t,r[o]=e,o+=1}}function Dn(t,e,n,r){var i=(r=r||t.length)-(n=n||0);if(!(i<2)){var o=0;if(i<32)Tn(t,n,r,n+(o=Mn(t,n,r,e)),e);else{var a=new In(t,e),s=function(t){for(var e=0;32<=t;)e|=1&t,t>>=1;return t+e}(i);do{if((o=Mn(t,n,r,e))<s){var l=i;s<l&&(l=s),Tn(t,n,n+l,n+o,e),o=l}a.pushRun(n,o),a.mergeRuns(),i-=o,n+=o}while(0!==i);a.forceMergeRuns()}}}function On(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel}function Pn(){this._roots=[],this._displayList=[],this._displayListLen=0}Cn.prototype={constructor:Cn,isGroup:!0,type:"group",silent:!1,children:function(){return this._children.slice()},childAt:function(t){return this._children[t]},childOfName:function(t){for(var e=this._children,n=0;n<e.length;n++)if(e[n].name===t)return e[n]},childCount:function(){return this._children.length},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},addBefore:function(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var n=this._children,r=n.indexOf(e);0<=r&&(n.splice(r,0,t),this._doAdd(t))}return this},_doAdd:function(t){t.parent&&t.parent.remove(t);var e=(t.parent=this).__storage,n=this.__zr;e&&e!==t.__storage&&(e.addToStorage(t),t instanceof Cn&&t.addChildrenToStorage(e)),n&&n.refresh()},remove:function(t){var e=this.__zr,n=this.__storage,r=this._children,i=S(r,t);return i<0||(r.splice(i,1),t.parent=null,n&&(n.delFromStorage(t),t instanceof Cn&&t.delChildrenFromStorage(n)),e&&e.refresh()),this},removeAll:function(){var t,e,n=this._children,r=this.__storage;for(e=0;e<n.length;e++)t=n[e],r&&(r.delFromStorage(t),t instanceof Cn&&t.delChildrenFromStorage(r)),t.parent=null;return n.length=0,this},eachChild:function(t,e){for(var n=this._children,r=0;r<n.length;r++)t.call(e,n[r],r);return this},traverse:function(t,e){for(var n=0;n<this._children.length;n++){var r=this._children[n];t.call(e,r),"group"===r.type&&r.traverse(t,e)}return this},addChildrenToStorage:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.addToStorage(n),n instanceof Cn&&n.addChildrenToStorage(t)}},delChildrenFromStorage:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.delFromStorage(n),n instanceof Cn&&n.delChildrenFromStorage(t)}},dirty:function(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this},getBoundingRect:function(t){for(var e=null,n=new Sn(0,0,0,0),r=t||this._children,i=[],o=0;o<r.length;o++){var a=r[o];if(!a.ignore&&!a.invisible){var s=a.getBoundingRect(),l=a.getLocalTransform(i);l?(n.copy(s),n.applyTransform(l),(e=e||n.clone()).union(n)):(e=e||s.clone()).union(s)}}return e||n}},C(Cn,gn),Pn.prototype={constructor:Pn,traverse:function(t,e){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,e)},getDisplayList:function(t,e){return e=e||!1,t&&this.updateDisplayList(e),this._displayList},updateDisplayList:function(t){this._displayListLen=0;for(var e=this._roots,n=this._displayList,r=0,o=e.length;r<o;r++)this._updateAndAddDisplayable(e[r],null,t);n.length=this._displayListLen,i.canvasSupported&&Dn(n,On)},_updateAndAddDisplayable:function(t,e,n){if(!t.ignore||n){t.beforeUpdate(),t.__dirty&&t.update(),t.afterUpdate();var r=t.clipPath;if(r){e=e?e.slice():[];for(var i=r,o=t;i;)i.parent=o,i.updateTransform(),e.push(i),i=(o=i).clipPath}if(t.isGroup){for(var a=t._children,s=0;s<a.length;s++){var l=a[s];t.__dirty&&(l.__dirty=!0),this._updateAndAddDisplayable(l,e,n)}t.__dirty=!1}else t.__clipPaths=e,this._displayList[this._displayListLen++]=t}},addRoot:function(t){t.__storage!==this&&(t instanceof Cn&&t.addChildrenToStorage(this),this.addToStorage(t),this._roots.push(t))},delRoot:function(t){if(null==t){for(var e=0;e<this._roots.length;e++){var n=this._roots[e];n instanceof Cn&&n.delChildrenFromStorage(this)}return this._roots=[],this._displayList=[],void(this._displayListLen=0)}if(t instanceof Array){e=0;for(var r=t.length;e<r;e++)this.delRoot(t[e])}else{var i=S(this._roots,t);0<=i&&(this.delFromStorage(t),this._roots.splice(i,1),t instanceof Cn&&t.delChildrenFromStorage(this))}},addToStorage:function(t){return t&&(t.__storage=this,t.dirty(!1)),this},delFromStorage:function(t){return t&&(t.__storage=null),this},dispose:function(){this._renderList=this._roots=null},displayableSortFunc:On};var En={shadowBlur:1,shadowOffsetX:1,shadowOffsetY:1,textShadowBlur:1,textShadowOffsetX:1,textShadowOffsetY:1,textBoxShadowBlur:1,textBoxShadowOffsetX:1,textBoxShadowOffsetY:1},Rn=function(t,e,n){return En.hasOwnProperty(e)?n*t.dpr:n},Ln=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]],Nn=function(t){this.extendFrom(t,!1)};function Bn(t,e,n){var r=null==e.x?0:e.x,i=null==e.x2?1:e.x2,o=null==e.y?0:e.y,a=null==e.y2?0:e.y2;return e.global||(r=r*n.width+n.x,i=i*n.width+n.x,o=o*n.height+n.y,a=a*n.height+n.y),r=isNaN(r)?0:r,i=isNaN(i)?1:i,o=isNaN(o)?0:o,a=isNaN(a)?0:a,t.createLinearGradient(r,o,i,a)}function zn(t,e,n){var r=n.width,i=n.height,o=Math.min(r,i),a=null==e.x?.5:e.x,s=null==e.y?.5:e.y,l=null==e.r?.5:e.r;return e.global||(a=a*r+n.x,s=s*i+n.y,l*=o),t.createRadialGradient(a,s,0,a,s,l)}for(var Vn=Nn.prototype={constructor:Nn,fill:"#000",stroke:null,opacity:1,fillOpacity:null,strokeOpacity:null,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontSize:null,fontFamily:null,textTag:null,textFill:"#000",textStroke:null,textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:!1,textRotation:0,textOrigin:null,textBackgroundColor:null,textBorderColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function(t,e,n){var r=this,i=n&&n.style,o=!i||1!==t.__attrCachedBy;t.__attrCachedBy=1;for(var a=0;a<Ln.length;a++){var s=Ln[a],l=s[0];!o&&r[l]===i[l]||(t[l]=Rn(t,l,r[l]||s[1]))}!o&&r.fill===i.fill||(t.fillStyle=r.fill),!o&&r.stroke===i.stroke||(t.strokeStyle=r.stroke),!o&&r.opacity===i.opacity||(t.globalAlpha=null==r.opacity?1:r.opacity),!o&&r.blend===i.blend||(t.globalCompositeOperation=r.blend||"source-over"),this.hasStroke()&&(t.lineWidth=r.lineWidth/(this.strokeNoScale&&e&&e.getLineScale?e.getLineScale():1))},hasFill:function(){var t=this.fill;return null!=t&&"none"!==t},hasStroke:function(){var t=this.stroke;return null!=t&&"none"!==t&&0<this.lineWidth},extendFrom:function(t,e){if(t)for(var n in t)!t.hasOwnProperty(n)||!0!==e&&(!1===e?this.hasOwnProperty(n):null==t[n])||(this[n]=t[n])},set:function(t,e){"string"==typeof t?this[t]=e:this.extendFrom(t,!0)},clone:function(){var t=new this.constructor;return t.extendFrom(this,!0),t},getGradient:function(t,e,n){for(var r=("radial"===e.type?zn:Bn)(t,e,n),i=e.colorStops,o=0;o<i.length;o++)r.addColorStop(i[o].offset,i[o].color);return r}},Fn=0;Fn<Ln.length;Fn++){var Hn=Ln[Fn];Hn[0]in Vn||(Vn[Hn[0]]=Hn[1])}function Wn(t,e){this.image=t,this.repeat=e,this.type="pattern"}function jn(){return!1}function Gn(t,e,n){var r=_(),i=e.getWidth(),o=e.getHeight(),a=r.style;return a&&(a.position="absolute",a.left=0,a.top=0,a.width=i+"px",a.height=o+"px",r.setAttribute("data-zr-dom-id",t)),r.width=i*n,r.height=o*n,r}function Un(t,e,n){var r;n=n||dn,"string"==typeof t?r=Gn(t,e,n):B(t)&&(t=(r=t).id),this.id=t;var i=(this.dom=r).style;i&&(r.onselectstart=jn,i["-webkit-user-select"]="none",i["user-select"]="none",i["-webkit-touch-callout"]="none",i["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",i.padding=0,i.margin=0,i["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=e,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=n}Nn.getGradient=Vn.getGradient,Un.prototype={constructor:Un,__dirty:!0,__used:!(Wn.prototype.getCanvasPattern=function(t){return t.createPattern(this.image,this.repeat||"repeat")}),__drawIndex:0,__startIndex:0,__endIndex:0,incremental:!1,getElementCount:function(){return this.__endIndex-this.__startIndex},initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},createBackBuffer:function(){var t=this.dpr;this.domBack=Gn("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),1!==t&&this.ctxBack.scale(t,t)},resize:function(t,e){var n=this.dpr,r=this.dom,i=r.style,o=this.domBack;i&&(i.width=t+"px",i.height=e+"px"),r.width=t*n,r.height=e*n,o&&(o.width=t*n,o.height=e*n,1!==n&&this.ctxBack.scale(n,n))},clear:function(t,e){var n,r=this.dom,i=this.ctx,o=r.width,a=r.height,s=(e=e||this.clearColor,this.motionBlur&&!t),l=this.lastFrameAlpha,u=this.dpr;if(s&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(r,0,0,o/u,a/u)),i.clearRect(0,0,o,a),e&&"transparent"!==e&&(e.colorStops?(n=e.__canvasGradient||Nn.getGradient(i,e,{x:0,y:0,width:o,height:a}),e.__canvasGradient=n):e.image&&(n=Wn.prototype.getCanvasPattern.call(e,i)),i.save(),i.fillStyle=n||e,i.fillRect(0,0,o,a),i.restore()),s){var c=this.domBack;i.save(),i.globalAlpha=l,i.drawImage(c,0,0,o,a),i.restore()}}};var qn="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){setTimeout(t,16)},Xn=new Ce(50);function Yn(t){if("string"!=typeof t)return t;var e=Xn.get(t);return e&&e.image}function $n(t,e,n,r,i){if(t){if("string"!=typeof t)return t;if(e&&e.__zrImageSrc===t||!n)return e;var o=Xn.get(t),a={hostEl:n,cb:r,cbPayload:i};return o?Kn(e=o.image)||o.pending.push(a):((e=new Image).onload=e.onerror=Zn,Xn.put(t,e.__cachedImgObj={image:e,pending:[a]}),e.src=e.__zrImageSrc=t),e}return e}function Zn(){var t=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var n=t.pending[e],r=n.cb;r&&r(this,n.cbPayload),n.hostEl.dirty()}t.pending.length=0}function Kn(t){return t&&t.width&&t.height}var Jn={},Qn=0,tr=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,er="12px sans-serif",nr={};function rr(t,e){var n=t+":"+(e=e||er);if(Jn[n])return Jn[n];for(var r,i,o=(t+"").split("\n"),a=0,s=0,l=o.length;s<l;s++)a=Math.max((r=o[s],i=e,nr.measureText(r,i)).width,a);return 5e3<Qn&&(Qn=0,Jn={}),Qn++,Jn[n]=a}function ir(t,e,n,r,i,o,a,s){return a?function(t,e,n,r,i,o,a,s){var l=pr(t,{rich:a,truncate:s,font:e,textAlign:n,textPadding:i,textLineHeight:o}),u=l.outerWidth,c=l.outerHeight;return new Sn(or(0,u,n),ar(0,c,r),u,c)}(t,e,n,r,i,o,a,s):function(t,e,n,r,i,o,a){var s=hr(t,e,i,o,a),l=rr(t,e);i&&(l+=i[1]+i[3]);var u=s.outerHeight,c=new Sn(or(0,l,n),ar(0,u,r),l,u);return c.lineHeight=s.lineHeight,c}(t,e,n,r,i,o,s)}function or(t,e,n){return"right"===n?t-=e:"center"===n&&(t-=e/2),t}function ar(t,e,n){return"middle"===n?t-=e/2:"bottom"===n&&(t-=e),t}function sr(t,e,n){var r=e.textDistance,i=n.x,o=n.y;r=r||0;var a=n.height,s=n.width,l=a/2,u="left",c="top";switch(e.textPosition){case"left":i-=r,o+=l,u="right",c="middle";break;case"right":i+=r+s,o+=l,c="middle";break;case"top":i+=s/2,o-=r,u="center",c="bottom";break;case"bottom":i+=s/2,o+=a+r,u="center";break;case"inside":i+=s/2,o+=l,u="center",c="middle";break;case"insideLeft":i+=r,o+=l,c="middle";break;case"insideRight":i+=s-r,o+=l,u="right",c="middle";break;case"insideTop":i+=s/2,o+=r,u="center";break;case"insideBottom":i+=s/2,o+=a-r,u="center",c="bottom";break;case"insideTopLeft":i+=r,o+=r;break;case"insideTopRight":i+=s-r,o+=r,u="right";break;case"insideBottomLeft":i+=r,o+=a-r,c="bottom";break;case"insideBottomRight":i+=s-r,o+=a-r,u="right",c="bottom"}return(t=t||{}).x=i,t.y=o,t.textAlign=u,t.textVerticalAlign=c,t}function lr(t,e,n,r,i){if(!e)return"";var o=(t+"").split("\n");i=ur(e,n,r,i);for(var a=0,s=o.length;a<s;a++)o[a]=cr(o[a],i);return o.join("\n")}function ur(t,e,n,r){(r=x({},r)).font=e,n=j(n,"..."),r.maxIterations=j(r.maxIterations,2);var i=r.minChar=j(r.minChar,0);r.cnCharWidth=rr("国",e);var o=r.ascCharWidth=rr("a",e);r.placeholder=j(r.placeholder,"");for(var a=t=Math.max(0,t-1),s=0;s<i&&o<=a;s++)a-=o;var l=rr(n,e);return a<l&&(n="",l=0),a=t-l,r.ellipsis=n,r.ellipsisWidth=l,r.contentWidth=a,r.containerWidth=t,r}function cr(t,e){var n=e.containerWidth,r=e.font,i=e.contentWidth;if(!n)return"";var o=rr(t,r);if(o<=n)return t;for(var a=0;;a++){if(o<=i||a>=e.maxIterations){t+=e.ellipsis;break}var s=0===a?dr(t,i,e.ascCharWidth,e.cnCharWidth):0<o?Math.floor(t.length*i/o):0;o=rr(t=t.substr(0,s),r)}return""===t&&(t=e.placeholder),t}function dr(t,e,n,r){for(var i=0,o=0,a=t.length;o<a&&i<e;o++){var s=t.charCodeAt(o);i+=0<=s&&s<=127?n:r}return o}function fr(t){return rr("国",t)}function hr(t,e,n,r,i){null!=t&&(t+="");var o=j(r,fr(e)),a=t?t.split("\n"):[],s=a.length*o,l=s,u=!0;if(n&&(l+=n[0]+n[2]),t&&i){u=!1;var c=i.outerHeight,d=i.outerWidth;if(null!=c&&c<l)t="",a=[];else if(null!=d)for(var f=ur(d-(n?n[1]+n[3]:0),e,i.ellipsis,{minChar:i.minChar,placeholder:i.placeholder}),h=0,p=a.length;h<p;h++)a[h]=cr(a[h],f)}return{lines:a,height:s,outerHeight:l,lineHeight:o,canCacheByTextString:u}}function pr(t,e){var n={lines:[],width:0,height:0};if(null!=t&&(t+=""),!t)return n;for(var r,i=tr.lastIndex=0;null!=(r=tr.exec(t));){var o=r.index;i<o&&gr(n,t.substring(i,o)),gr(n,r[2],r[1]),i=tr.lastIndex}i<t.length&&gr(n,t.substring(i,t.length));var a=n.lines,s=0,l=0,u=[],c=e.textPadding,d=e.truncate,f=d&&d.outerWidth,h=d&&d.outerHeight;c&&(null!=f&&(f-=c[1]+c[3]),null!=h&&(h-=c[0]+c[2]));for(var p=0;p<a.length;p++){for(var g=a[p],m=0,v=0,y=0;y<g.tokens.length;y++){var x=(I=g.tokens[y]).styleName&&e.rich[I.styleName]||{},b=I.textPadding=x.textPadding,_=I.font=x.font||e.font,w=I.textHeight=j(x.textHeight,fr(_));if(b&&(w+=b[0]+b[2]),I.height=w,I.lineHeight=G(x.textLineHeight,e.textLineHeight,w),I.textAlign=x&&x.textAlign||e.textAlign,I.textVerticalAlign=x&&x.textVerticalAlign||"middle",null!=h&&s+I.lineHeight>h)return{lines:[],width:0,height:0};I.textWidth=rr(I.text,_);var S=x.textWidth,C=null==S||"auto"===S;if("string"==typeof S&&"%"===S.charAt(S.length-1))I.percentWidth=S,u.push(I),S=0;else{if(C){S=I.textWidth;var M=x.textBackgroundColor,T=M&&M.image;T&&Kn(T=Yn(T))&&(S=Math.max(S,T.width*w/T.height))}var k=b?b[1]+b[3]:0;S+=k;var A=null!=f?f-v:null;null!=A&&A<S&&(!C||A<k?(I.text="",I.textWidth=S=0):(I.text=lr(I.text,A-k,_,d.ellipsis,{minChar:d.minChar}),I.textWidth=rr(I.text,_),S=I.textWidth+k))}v+=I.width=S,x&&(m=Math.max(m,I.lineHeight))}g.width=v,s+=g.lineHeight=m,l=Math.max(l,v)}for(n.outerWidth=n.width=j(e.textWidth,l),n.outerHeight=n.height=j(e.textHeight,s),c&&(n.outerWidth+=c[1]+c[3],n.outerHeight+=c[0]+c[2]),p=0;p<u.length;p++){var I,D=(I=u[p]).percentWidth;I.width=parseInt(D,10)/100*l}return n}function gr(t,e,n){for(var r=""===e,i=e.split("\n"),o=t.lines,a=0;a<i.length;a++){var s=i[a],l={styleName:n,text:s,isLineHolder:!s&&!r};if(a)o.push({tokens:[l]});else{var u=(o[o.length-1]||(o[0]={tokens:[]})).tokens,c=u.length;1===c&&u[0].isLineHolder?u[0]=l:!s&&c&&!r||u.push(l)}}}function mr(t){var e=(t.fontSize||t.fontFamily)&&[t.fontStyle,t.fontWeight,(t.fontSize||12)+"px",t.fontFamily||"sans-serif"].join(" ");return e&&Y(e)||t.textFont||t.font}function vr(t,e){var n,r,i,o,a,s=e.x,l=e.y,u=e.width,c=e.height,d=e.r;u<0&&(s+=u,u=-u),c<0&&(l+=c,c=-c),"number"==typeof d?n=r=i=o=d:d instanceof Array?1===d.length?n=r=i=o=d[0]:2===d.length?(n=i=d[0],r=o=d[1]):3===d.length?(n=d[0],r=o=d[1],i=d[2]):(n=d[0],r=d[1],i=d[2],o=d[3]):n=r=i=o=0,u<n+r&&(n*=u/(a=n+r),r*=u/a),u<i+o&&(i*=u/(a=i+o),o*=u/a),c<r+i&&(r*=c/(a=r+i),i*=c/a),c<n+o&&(n*=c/(a=n+o),o*=c/a),t.moveTo(s+n,l),t.lineTo(s+u-r,l),0!==r&&t.arc(s+u-r,l+r,r,-Math.PI/2,0),t.lineTo(s+u,l+c-i),0!==i&&t.arc(s+u-i,l+c-i,i,0,Math.PI/2),t.lineTo(s+o,l+c),0!==o&&t.arc(s+o,l+c-o,o,Math.PI/2,Math.PI),t.lineTo(s,l+n),0!==n&&t.arc(s+n,l+n,n,Math.PI,1.5*Math.PI)}nr.measureText=function(t,e){var n=w();return n.font=e||er,n.measureText(t)};var yr=er,xr={left:1,right:1,center:1},br={top:1,bottom:1,middle:1},_r=[["textShadowBlur","shadowBlur",0],["textShadowOffsetX","shadowOffsetX",0],["textShadowOffsetY","shadowOffsetY",0],["textShadowColor","shadowColor","transparent"]],wr={},Sr={};function Cr(t){return Mr(t),k(t.rich,Mr),t}function Mr(t){if(t){t.font=mr(t);var e=t.textAlign;"middle"===e&&(e="center"),t.textAlign=null==e||xr[e]?e:"left";var n=t.textVerticalAlign||t.textBaseline;"center"===n&&(n="middle"),t.textVerticalAlign=null==n||br[n]?n:"top",t.textPadding&&(t.textPadding=q(t.textPadding))}}function Tr(t,e,n,r,i,o){r.rich?function(t,e,n,r,i,o){9!==o&&(e.__attrCachedBy=0);var a=t.__textCotentBlock;a&&!t.__dirtyText||(a=t.__textCotentBlock=pr(n,r)),function(t,e,n,r,i){var o=n.width,a=n.outerWidth,s=n.outerHeight,l=r.textPadding,u=Pr(Sr,t,r,i),c=u.baseX,d=u.baseY,f=u.textAlign,h=u.textVerticalAlign;kr(e,r,i,c,d);var p=or(c,a,f),g=ar(d,s,h),m=p,v=g;l&&(m+=l[3],v+=l[0]);var y=m+o;Ir(r)&&Dr(t,e,r,p,g,a,s);for(var x=0;x<n.lines.length;x++){for(var b,_=n.lines[x],w=_.tokens,S=w.length,C=_.lineHeight,M=_.width,T=0,k=m,A=y,I=S-1;T<S&&(!(b=w[T]).textAlign||"left"===b.textAlign);)Ar(t,e,b,r,C,v,k,"left"),M-=b.width,k+=b.width,T++;for(;0<=I&&"right"===(b=w[I]).textAlign;)Ar(t,e,b,r,C,v,A,"right"),M-=b.width,A-=b.width,I--;for(k+=(o-(k-m)-(y-A)-M)/2;T<=I;)Ar(t,e,b=w[T],r,C,v,k+b.width/2,"center"),k+=b.width,T++;v+=C}}(t,e,a,r,i)}(t,e,n,r,i,o):function(t,e,n,r,i,o){var a,s=Ir(r),l=!1,u=2===e.__attrCachedBy;9!==o?(o&&(a=o.style,l=!s&&u&&a),e.__attrCachedBy=s?0:2):u&&(e.__attrCachedBy=0);var c=r.font||yr;l&&c===(a.font||yr)||(e.font=c);var d=t.__computedFont;t.__styleFont!==c&&(t.__styleFont=c,d=t.__computedFont=e.font);var f=r.textPadding,h=t.__textCotentBlock;h&&!t.__dirtyText||(h=t.__textCotentBlock=hr(n,d,f,r.textLineHeight,r.truncate));var p=h.outerHeight,g=h.lines,m=h.lineHeight,v=Pr(Sr,t,r,i),y=v.baseX,x=v.baseY,b=v.textAlign||"left",_=v.textVerticalAlign;kr(e,r,i,y,x);var w=ar(x,p,_),S=y,C=w;if(s||f){var M=rr(n,d);f&&(M+=f[1]+f[3]);var T=or(y,M,b);s&&Dr(t,e,r,T,w,M,p),f&&(S=Br(y,b,f),C+=f[0])}e.textAlign=b,e.textBaseline="middle",e.globalAlpha=r.opacity||1;for(var k=0;k<_r.length;k++){var A=_r[k],I=A[0],D=A[1],O=r[I];l&&O===a[I]||(e[D]=Rn(e,D,O||A[2]))}C+=m/2;var P=r.textStrokeWidth,E=!l||P!==(l?a.textStrokeWidth:null),R=!l||E||r.textStroke!==a.textStroke,L=Rr(r.textStroke,P),N=Lr(r.textFill);if(L&&(E&&(e.lineWidth=P),R&&(e.strokeStyle=L)),N&&(l&&r.textFill===a.textFill||(e.fillStyle=N)),1===g.length)L&&e.strokeText(g[0],S,C),N&&e.fillText(g[0],S,C);else for(k=0;k<g.length;k++)L&&e.strokeText(g[k],S,C),N&&e.fillText(g[k],S,C),C+=m}(t,e,n,r,i,o)}function kr(t,e,n,r,i){if(n&&e.textRotation){var o=e.textOrigin;"center"===o?(r=n.width/2+n.x,i=n.height/2+n.y):o&&(r=o[0]+n.x,i=o[1]+n.y),t.translate(r,i),t.rotate(-e.textRotation),t.translate(-r,-i)}}function Ar(t,e,n,r,i,o,a,s){var l=r.rich[n.styleName]||{};l.text=n.text;var u=n.textVerticalAlign,c=o+i/2;"top"===u?c=o+n.height/2:"bottom"===u&&(c=o+i-n.height/2),!n.isLineHolder&&Ir(l)&&Dr(t,e,l,"right"===s?a-n.width:"center"===s?a-n.width/2:a,c-n.height/2,n.width,n.height);var d=n.textPadding;d&&(a=Br(a,s,d),c-=n.height/2-d[2]-n.textHeight/2),Er(e,"shadowBlur",G(l.textShadowBlur,r.textShadowBlur,0)),Er(e,"shadowColor",l.textShadowColor||r.textShadowColor||"transparent"),Er(e,"shadowOffsetX",G(l.textShadowOffsetX,r.textShadowOffsetX,0)),Er(e,"shadowOffsetY",G(l.textShadowOffsetY,r.textShadowOffsetY,0)),Er(e,"textAlign",s),Er(e,"textBaseline","middle"),Er(e,"font",n.font||yr);var f=Rr(l.textStroke||r.textStroke,p),h=Lr(l.textFill||r.textFill),p=j(l.textStrokeWidth,r.textStrokeWidth);f&&(Er(e,"lineWidth",p),Er(e,"strokeStyle",f),e.strokeText(n.text,a,c)),h&&(Er(e,"fillStyle",h),e.fillText(n.text,a,c))}function Ir(t){return!!(t.textBackgroundColor||t.textBorderWidth&&t.textBorderColor)}function Dr(t,e,n,r,i,o,a){var s=n.textBackgroundColor,l=n.textBorderWidth,u=n.textBorderColor,c=N(s);if(Er(e,"shadowBlur",n.textBoxShadowBlur||0),Er(e,"shadowColor",n.textBoxShadowColor||"transparent"),Er(e,"shadowOffsetX",n.textBoxShadowOffsetX||0),Er(e,"shadowOffsetY",n.textBoxShadowOffsetY||0),c||l&&u){e.beginPath();var d=n.textBorderRadius;d?vr(e,{x:r,y:i,width:o,height:a,r:d}):e.rect(r,i,o,a),e.closePath()}if(c)if(Er(e,"fillStyle",s),null!=n.fillOpacity){var f=e.globalAlpha;e.globalAlpha=n.fillOpacity*n.opacity,e.fill(),e.globalAlpha=f}else e.fill();else if(B(s)){var h=s.image;(h=$n(h,null,t,Or,s))&&Kn(h)&&e.drawImage(h,r,i,o,a)}l&&u&&(Er(e,"lineWidth",l),Er(e,"strokeStyle",u),null!=n.strokeOpacity?(f=e.globalAlpha,e.globalAlpha=n.strokeOpacity*n.opacity,e.stroke(),e.globalAlpha=f):e.stroke())}function Or(t,e){e.image=t}function Pr(t,e,n,r){var i=n.x||0,o=n.y||0,a=n.textAlign,s=n.textVerticalAlign;if(r){var l=n.textPosition;if(l instanceof Array)i=r.x+Nr(l[0],r.width),o=r.y+Nr(l[1],r.height);else{var u=e&&e.calculateTextPosition?e.calculateTextPosition(wr,n,r):sr(wr,n,r);i=u.x,o=u.y,a=a||u.textAlign,s=s||u.textVerticalAlign}var c=n.textOffset;c&&(i+=c[0],o+=c[1])}return(t=t||{}).baseX=i,t.baseY=o,t.textAlign=a,t.textVerticalAlign=s,t}function Er(t,e,n){return t[e]=Rn(t,e,n),t[e]}function Rr(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t}function Lr(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t}function Nr(t,e){return"string"==typeof t?0<=t.lastIndexOf("%")?parseFloat(t)/100*e:parseFloat(t):t}function Br(t,e,n){return"right"===e?t-n[1]:"center"===e?t+n[3]/2-n[1]/2:t+n[3]}function zr(t,e){return null!=t&&(t||e.textBackgroundColor||e.textBorderWidth&&e.textBorderColor||e.textPadding)}function Vr(){}var Fr=new Sn;function Hr(t){for(var e in gn.call(this,t=t||{}),t)t.hasOwnProperty(e)&&"style"!==e&&(this[e]=t[e]);this.style=new Nn(t.style,this),this._rect=null,this.__clipPaths=null}function Wr(t){Hr.call(this,t)}Hr.prototype={constructor:Hr,type:"displayable",__dirty:!0,invisible:!(Vr.prototype={constructor:Vr,drawRectText:function(t,e){var n=this.style;e=n.textRect||e,this.__dirty&&Cr(n);var r=n.text;if(null!=r&&(r+=""),zr(r,n)){t.save();var i=this.transform;n.transformText?this.setTransform(t):i&&(Fr.copy(e),Fr.applyTransform(i),e=Fr),Tr(this,t,r,n,e,9),t.restore()}}}),z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:!1,incremental:!1,globalScaleRatio:1,beforeBrush:function(t){},afterBrush:function(t){},brush:function(t,e){},getBoundingRect:function(){},contain:function(t,e){return this.rectContain(t,e)},traverse:function(t,e){t.call(e,this)},rectContain:function(t,e){var n=this.transformCoordToLocal(t,e);return this.getBoundingRect().contain(n[0],n[1])},dirty:function(){this.__dirty=this.__dirtyText=!0,this._rect=null,this.__zr&&this.__zr.refresh()},animateStyle:function(t){return this.animate("style",t)},attrKV:function(t,e){"style"!==t?gn.prototype.attrKV.call(this,t,e):this.style.set(e)},setStyle:function(t,e){return this.style.set(t,e),this.dirty(!1),this},useStyle:function(t){return this.style=new Nn(t,this),this.dirty(!1),this},calculateTextPosition:null},C(Hr,gn),M(Hr,Vr),Wr.prototype={constructor:Wr,type:"image",brush:function(t,e){var n=this.style,r=n.image;n.bind(t,this,e);var i=this._image=$n(r,this._image,this,this.onload);if(i&&Kn(i)){var o=n.x||0,a=n.y||0,s=n.width,l=n.height,u=i.width/i.height;if(null==s&&null!=l?s=l*u:null==l&&null!=s?l=s/u:null==s&&null==l&&(s=i.width,l=i.height),this.setTransform(t),n.sWidth&&n.sHeight){var c=n.sx||0,d=n.sy||0;t.drawImage(i,c,d,n.sWidth,n.sHeight,o,a,s,l)}else if(n.sx&&n.sy){var f=s-(c=n.sx),h=l-(d=n.sy);t.drawImage(i,c,d,f,h,o,a,s,l)}else t.drawImage(i,o,a,s,l);null!=n.text&&(this.restoreTransform(t),this.drawRectText(t,this.getBoundingRect()))}},getBoundingRect:function(){var t=this.style;return this._rect||(this._rect=new Sn(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect}},C(Wr,Hr);var jr=314159;function Gr(t){return parseInt(t,10)}var Ur=new Sn(0,0,0,0),qr=new Sn(0,0,0,0);function Xr(t,e,n){this.type="canvas";var r=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._opts=n=x({},n||{}),this.dpr=n.devicePixelRatio||dn,this._singleCanvas=r;var i=(this.root=t).style;i&&(i["-webkit-tap-highlight-color"]="transparent",i["-webkit-user-select"]=i["user-select"]=i["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;var o=this._zlevelList=[],a=this._layers={};if(this._layerConfig={},this._needsManuallyCompositing=!1,r){var s=t.width,l=t.height;null!=n.width&&(s=n.width),null!=n.height&&(l=n.height),this.dpr=n.devicePixelRatio||1,t.width=s*this.dpr,t.height=l*this.dpr,this._width=s,this._height=l;var u=new Un(t,this,this.dpr);u.__builtin__=!0,u.initContext(),(a[jr]=u).zlevel=jr,o.push(jr),this._domRoot=t}else{this._width=this._getSize(0),this._height=this._getSize(1);var c=this._domRoot=function(t,e){var n=document.createElement("div");return n.style.cssText=["position:relative","width:"+t+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",n}(this._width,this._height);t.appendChild(c)}this._hoverlayer=null,this._hoverElements=[]}function Yr(t){this.stage=(t=t||{}).stage||{},this.onframe=t.onframe||function(){},this._clips=[],this._running=!1,this._paused=!1,kt.call(this)}Xr.prototype={constructor:Xr,getType:function(){return"canvas"},isSingleCanvas:function(){return this._singleCanvas},getViewportRoot:function(){return this._domRoot},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(t){var e=this.storage.getDisplayList(!0),n=this._zlevelList;this._redrawId=Math.random(),this._paintList(e,t,this._redrawId);for(var r=0;r<n.length;r++){var i=this._layers[n[r]];!i.__builtin__&&i.refresh&&i.refresh(0===r?this._backgroundColor:null)}return this.refreshHover(),this},addHover:function(t,e){if(!t.__hoverMir){var n=new t.constructor({style:t.style,shape:t.shape,z:t.z,z2:t.z2,silent:t.silent});return(n.__from=t).__hoverMir=n,e&&n.setStyle(e),this._hoverElements.push(n),n}},removeHover:function(t){var e=this._hoverElements,n=S(e,t.__hoverMir);0<=n&&e.splice(n,1),t.__hoverMir=null},clearHover:function(t){for(var e=this._hoverElements,n=0;n<e.length;n++){var r=e[n].__from;r&&(r.__hoverMir=null)}e.length=0},refreshHover:function(){var t=this._hoverElements,e=t.length,n=this._hoverlayer;if(n&&n.clear(),e){Dn(t,this.storage.displayableSortFunc);var r={};(n=n||(this._hoverlayer=this.getLayer(1e5))).ctx.save();for(var i=0;i<e;){var o=t[i],a=o.__from;a&&a.__zr?(i++,a.invisible||(o.transform=a.transform,o.invTransform=a.invTransform,o.__clipPaths=a.__clipPaths,this._doPaintEl(o,n,!0,r))):(t.splice(i,1),a.__hoverMir=null,e--)}n.ctx.restore()}},getHoverLayer:function(){return this.getLayer(1e5)},_paintList:function(t,e,n){if(this._redrawId===n){e=e||!1,this._updateLayerStatus(t);var r=this._doPaintList(t,e);if(this._needsManuallyCompositing&&this._compositeManually(),!r){var i=this;qn(function(){i._paintList(t,e,n)})}}},_compositeManually:function(){var t=this.getLayer(jr).ctx,e=this._domRoot.width,n=this._domRoot.height;t.clearRect(0,0,e,n),this.eachBuiltinLayer(function(r){r.virtual&&t.drawImage(r.dom,0,0,e,n)})},_doPaintList:function(t,e){for(var n=[],r=0;r<this._zlevelList.length;r++)(s=this._layers[this._zlevelList[r]]).__builtin__&&s!==this._hoverlayer&&(s.__dirty||e)&&n.push(s);for(var o=!0,a=0;a<n.length;a++){var s,l=(s=n[a]).ctx,u={};l.save();var c=e?s.__startIndex:s.__drawIndex,d=!e&&s.incremental&&Date.now,f=d&&Date.now(),h=s.zlevel===this._zlevelList[0]?this._backgroundColor:null;if(s.__startIndex===s.__endIndex)s.clear(!1,h);else if(c===s.__startIndex){var p=t[c];p.incremental&&p.notClear&&!e||s.clear(!1,h)}-1===c&&(console.error("For some unknown reason. drawIndex is -1"),c=s.__startIndex);for(var g=c;g<s.__endIndex;g++){var m=t[g];if(this._doPaintEl(m,s,e,u),m.__dirty=m.__dirtyText=!1,d&&15<Date.now()-f)break}s.__drawIndex=g,s.__drawIndex<s.__endIndex&&(o=!1),u.prevElClipPaths&&l.restore(),l.restore()}return i.wxa&&k(this._layers,function(t){t&&t.ctx&&t.ctx.draw&&t.ctx.draw()}),o},_doPaintEl:function(t,e,n,r){var i=e.ctx,o=t.transform;if((e.__dirty||n)&&!t.invisible&&0!==t.style.opacity&&(!o||o[0]||o[3])&&(!t.culling||!function(t,e,n){return Ur.copy(t.getBoundingRect()),t.transform&&Ur.applyTransform(t.transform),qr.width=e,qr.height=n,!Ur.intersect(qr)}(t,this._width,this._height))){var a=t.__clipPaths,s=r.prevElClipPaths;s&&!function(t,e){if(t===e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1}(a,s)||(s&&(i.restore(),r.prevElClipPaths=null,r.prevEl=null),a&&(i.save(),function(t,e){for(var n=0;n<t.length;n++){var r=t[n];r.setTransform(e),e.beginPath(),r.buildPath(e,r.shape),e.clip(),r.restoreTransform(e)}}(a,i),r.prevElClipPaths=a)),t.beforeBrush&&t.beforeBrush(i),t.brush(i,r.prevEl||null),(r.prevEl=t).afterBrush&&t.afterBrush(i)}},getLayer:function(t,e){this._singleCanvas&&!this._needsManuallyCompositing&&(t=jr);var n=this._layers[t];return n||((n=new Un("zr_"+t,this,this.dpr)).zlevel=t,n.__builtin__=!0,this._layerConfig[t]?v(n,this._layerConfig[t],!0):this._layerConfig[t-.01]&&v(n,this._layerConfig[t-.01],!0),e&&(n.virtual=e),this.insertLayer(t,n),n.initContext()),n},insertLayer:function(t,e){var n=this._layers,r=this._zlevelList,i=r.length,o=null,a=-1,s=this._domRoot;if(n[t]);else if(function(t){return!!t&&(!!t.__builtin__||"function"==typeof t.resize&&"function"==typeof t.refresh)}(e)){if(0<i&&t>r[0]){for(a=0;a<i-1&&!(r[a]<t&&r[a+1]>t);a++);o=n[r[a]]}if(r.splice(a+1,0,t),!(n[t]=e).virtual)if(o){var l=o.dom;l.nextSibling?s.insertBefore(e.dom,l.nextSibling):s.appendChild(e.dom)}else s.firstChild?s.insertBefore(e.dom,s.firstChild):s.appendChild(e.dom)}},eachLayer:function(t,e){var n,r,i=this._zlevelList;for(r=0;r<i.length;r++)t.call(e,this._layers[n=i[r]],n)},eachBuiltinLayer:function(t,e){var n,r,i,o=this._zlevelList;for(i=0;i<o.length;i++)(n=this._layers[r=o[i]]).__builtin__&&t.call(e,n,r)},eachOtherLayer:function(t,e){var n,r,i,o=this._zlevelList;for(i=0;i<o.length;i++)(n=this._layers[r=o[i]]).__builtin__||t.call(e,n,r)},getLayers:function(){return this._layers},_updateLayerStatus:function(t){function e(t){i&&(i.__endIndex!==t&&(i.__dirty=!0),i.__endIndex=t)}if(this.eachBuiltinLayer(function(t,e){t.__dirty=t.__used=!1}),this._singleCanvas)for(var n=1;n<t.length;n++)if((a=t[n]).zlevel!==t[n-1].zlevel||a.incremental){this._needsManuallyCompositing=!0;break}var r,i=null,o=0;for(n=0;n<t.length;n++){var a,s,l=(a=t[n]).zlevel;r!==l&&(r=l,o=0),a.incremental?((s=this.getLayer(l+.001,this._needsManuallyCompositing)).incremental=!0,o=1):s=this.getLayer(l+(0<o?.01:0),this._needsManuallyCompositing),s!==i&&(s.__used=!0,s.__startIndex!==n&&(s.__dirty=!0),s.__startIndex=n,s.__drawIndex=s.incremental?-1:n,e(n),i=s),a.__dirty&&(s.__dirty=!0,s.incremental&&s.__drawIndex<0&&(s.__drawIndex=n))}e(n),this.eachBuiltinLayer(function(t,e){!t.__used&&0<t.getElementCount()&&(t.__dirty=!0,t.__startIndex=t.__endIndex=t.__drawIndex=0),t.__dirty&&t.__drawIndex<0&&(t.__drawIndex=t.__startIndex)})},clear:function(){return this.eachBuiltinLayer(this._clearLayer),this},_clearLayer:function(t){t.clear()},setBackgroundColor:function(t){this._backgroundColor=t},configLayer:function(t,e){if(e){var n=this._layerConfig;n[t]?v(n[t],e,!0):n[t]=e;for(var r=0;r<this._zlevelList.length;r++){var i=this._zlevelList[r];i!==t&&i!==t+.01||v(this._layers[i],n[t],!0)}}},delLayer:function(t){var e=this._layers,n=this._zlevelList,r=e[t];r&&(r.dom.parentNode.removeChild(r.dom),delete e[t],n.splice(S(n,t),1))},resize:function(t,e){if(this._domRoot.style){var n=this._domRoot;n.style.display="none";var r=this._opts;if(null!=t&&(r.width=t),null!=e&&(r.height=e),t=this._getSize(0),e=this._getSize(1),n.style.display="",this._width!==t||e!==this._height){for(var i in n.style.width=t+"px",n.style.height=e+"px",this._layers)this._layers.hasOwnProperty(i)&&this._layers[i].resize(t,e);k(this._progressiveLayers,function(n){n.resize(t,e)}),this.refresh(!0)}this._width=t,this._height=e}else{if(null==t||null==e)return;this._width=t,this._height=e,this.getLayer(jr).resize(t,e)}return this},clearLayer:function(t){var e=this._layers[t];e&&e.clear()},dispose:function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},getRenderedCanvas:function(t){if(this._singleCanvas&&!this._compositeManually)return this._layers[jr].dom;var e=new Un("image",this,(t=t||{}).pixelRatio||this.dpr);if(e.initContext(),e.clear(!1,t.backgroundColor||this._backgroundColor),t.pixelRatio<=this.dpr){this.refresh();var n=e.dom.width,r=e.dom.height,i=e.ctx;this.eachLayer(function(t){t.__builtin__?i.drawImage(t.dom,0,0,n,r):t.renderToCanvas&&(e.ctx.save(),t.renderToCanvas(e.ctx),e.ctx.restore())})}else for(var o={},a=this.storage.getDisplayList(!0),s=0;s<a.length;s++)this._doPaintEl(a[s],e,!0,o);return e.dom},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(t){var e=this._opts,n=["width","height"][t],r=["clientWidth","clientHeight"][t],i=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(null!=e[n]&&"auto"!==e[n])return parseFloat(e[n]);var a=this.root,s=document.defaultView.getComputedStyle(a);return(a[r]||Gr(s[n])||Gr(a.style[n]))-(Gr(s[i])||0)-(Gr(s[o])||0)|0},pathToImage:function(t,e){e=e||this.dpr;var n=document.createElement("canvas"),r=n.getContext("2d"),i=t.getBoundingRect(),o=t.style,a=o.shadowBlur*e,s=o.shadowOffsetX*e,l=o.shadowOffsetY*e,u=o.hasStroke()?o.lineWidth:0,c=Math.max(u/2,a-s),d=Math.max(u/2,s+a),f=Math.max(u/2,a-l),h=Math.max(u/2,l+a),p=i.width+c+d,g=i.height+f+h;n.width=p*e,n.height=g*e,r.scale(e,e),r.clearRect(0,0,p,g),r.dpr=e;var m={position:t.position,rotation:t.rotation,scale:t.scale};t.position=[c-i.x,f-i.y],t.rotation=0,t.scale=[1,1],t.updateTransform(),t&&t.brush(r);var v=new Wr({style:{x:0,y:0,image:n}});return null!=m.position&&(v.position=t.position=m.position),null!=m.rotation&&(v.rotation=t.rotation=m.rotation),null!=m.scale&&(v.scale=t.scale=m.scale),v}},Yr.prototype={constructor:Yr,addClip:function(t){this._clips.push(t)},addAnimator:function(t){t.animation=this;for(var e=t.getClips(),n=0;n<e.length;n++)this.addClip(e[n])},removeClip:function(t){var e=S(this._clips,t);0<=e&&this._clips.splice(e,1)},removeAnimator:function(t){for(var e=t.getClips(),n=0;n<e.length;n++)this.removeClip(e[n]);t.animation=null},_update:function(){for(var t=(new Date).getTime()-this._pausedTime,e=t-this._time,n=this._clips,r=n.length,i=[],o=[],a=0;a<r;a++){var s=n[a],l=s.step(t,e);l&&(i.push(l),o.push(s))}for(a=0;a<r;)n[a]._needsRemove?(n[a]=n[r-1],n.pop(),r--):a++;for(r=i.length,a=0;a<r;a++)o[a].fire(i[a]);this._time=t,this.onframe(e),this.trigger("frame",e),this.stage.update&&this.stage.update()},_startLoop:function(){var t=this;this._running=!0,qn(function e(){t._running&&(qn(e),t._paused||t._update())})},start:function(){this._time=(new Date).getTime(),this._pausedTime=0,this._startLoop()},stop:function(){this._running=!1},pause:function(){this._paused||(this._pauseStart=(new Date).getTime(),this._paused=!0)},resume:function(){this._paused&&(this._pausedTime+=(new Date).getTime()-this._pauseStart,this._paused=!1)},clear:function(){this._clips=[]},isFinished:function(){return!this._clips.length},animate:function(t,e){var n=new un(t,(e=e||{}).loop,e.getter,e.setter);return this.addAnimator(n),n}},M(Yr,kt);var $r,Zr,Kr=i.domSupported,Jr=(Zr={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},{mouse:$r=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],touch:["touchstart","touchend","touchmove"],pointer:A($r,function(t){var e=t.replace("mouse","pointer");return Zr.hasOwnProperty(e)?e:t})}),Qr=["mousemove","mouseup"],ti=["pointermove","pointerup"];function ei(t){return"mousewheel"===t&&i.browser.firefox?"DOMMouseScroll":t}function ni(t){var e=t.pointerType;return"pen"===e||"touch"===e}function ri(t){t&&(t.zrByTouch=!0)}function ii(t,e){for(var n=e,r=!1;n&&9!==n.nodeType&&!(r=n.domBelongToZr||n!==e&&n===t.painterRoot);)n=n.parentNode;return r}function oi(t,e){this.type=e.type,this.target=this.currentTarget=t.dom,this.pointerType=e.pointerType,this.clientX=e.clientX,this.clientY=e.clientY}var ai=oi.prototype;ai.stopPropagation=ai.stopImmediatePropagation=ai.preventDefault=et;var si={mousedown:function(t){t=Wt(this.dom,t),this._mayPointerCapture=[t.zrX,t.zrY],this.trigger("mousedown",t)},mousemove:function(t){t=Wt(this.dom,t);var e=this._mayPointerCapture;!e||t.zrX===e[0]&&t.zrY===e[1]||di(this,!0),this.trigger("mousemove",t)},mouseup:function(t){t=Wt(this.dom,t),di(this,!1),this.trigger("mouseup",t)},mouseout:function(t){t=Wt(this.dom,t),this._pointerCapturing&&(t.zrEventControl="no_globalout"),t.zrIsToLocalDOM=ii(this,t.toElement||t.relatedTarget),this.trigger("mouseout",t)},touchstart:function(t){ri(t=Wt(this.dom,t)),this._lastTouchMoment=new Date,this.handler.processGesture(t,"start"),si.mousemove.call(this,t),si.mousedown.call(this,t)},touchmove:function(t){ri(t=Wt(this.dom,t)),this.handler.processGesture(t,"change"),si.mousemove.call(this,t)},touchend:function(t){ri(t=Wt(this.dom,t)),this.handler.processGesture(t,"end"),si.mouseup.call(this,t),+new Date-this._lastTouchMoment<300&&si.click.call(this,t)},pointerdown:function(t){si.mousedown.call(this,t)},pointermove:function(t){ni(t)||si.mousemove.call(this,t)},pointerup:function(t){si.mouseup.call(this,t)},pointerout:function(t){ni(t)||si.mouseout.call(this,t)}};k(["click","mousewheel","dblclick","contextmenu"],function(t){si[t]=function(e){e=Wt(this.dom,e),this.trigger(t,e)}});var li={pointermove:function(t){ni(t)||li.mousemove.call(this,t)},pointerup:function(t){li.mouseup.call(this,t)},mousemove:function(t){this.trigger("mousemove",t)},mouseup:function(t){var e=this._pointerCapturing;di(this,!1),this.trigger("mouseup",t),e&&(t.zrEventControl="only_globalout",this.trigger("mouseout",t))}};function ui(t,e,n,r){t.mounted[e]=n,t.listenerOpts[e]=r,jt(t.domTarget,ei(e),n,r)}function ci(t){var e,n,r,i=t.mounted;for(var o in i)i.hasOwnProperty(o)&&(e=t.domTarget,n=ei(o),r=i[o],Nt?e.removeEventListener(n,r,t.listenerOpts[o]):e.detachEvent("on"+n,r));t.mounted={}}function di(t,e){if(t._mayPointerCapture=null,Kr&&t._pointerCapturing^e){t._pointerCapturing=e;var n=t._globalHandlerScope;e?function(t,e){function n(n){ui(e,n,function(r){r=Ht(r),ii(t,r.target)||(r=function(t,e){return Wt(t.dom,new oi(t,e),!0)}(t,r),e.domHandlers[n].call(t,r))},{capture:!0})}i.pointerEventsSupported?k(ti,n):i.touchEventsSupported||k(Qr,n)}(t,n):ci(n)}}function fi(t,e){this.domTarget=t,this.domHandlers=e,this.mounted={},this.listenerOpts={},this.touchTimer=null,this.touching=!1}function hi(t,e){kt.call(this),this.dom=t,this.painterRoot=e,this._localHandlerScope=new fi(t,si),Kr&&(this._globalHandlerScope=new fi(document,li)),this._pointerCapturing=!1,this._mayPointerCapture=null,function(t,e){var n=e.domHandlers;i.pointerEventsSupported?k(Jr.pointer,function(r){ui(e,r,function(e){n[r].call(t,e)})}):(i.touchEventsSupported&&k(Jr.touch,function(r){ui(e,r,function(i){n[r].call(t,i),function(t){t.touching=!0,null!=t.touchTimer&&(clearTimeout(t.touchTimer),t.touchTimer=null),t.touchTimer=setTimeout(function(){t.touching=!1,t.touchTimer=null},700)}(e)})}),k(Jr.mouse,function(r){ui(e,r,function(i){i=Ht(i),e.touching||n[r].call(t,i)})}))}(this,this._localHandlerScope)}var pi=hi.prototype;pi.dispose=function(){ci(this._localHandlerScope),Kr&&ci(this._globalHandlerScope)},pi.setCursor=function(t){this.dom.style&&(this.dom.style.cursor=t||"default")},M(hi,kt);var gi=!i.canvasSupported,mi={canvas:Xr},vi={};function yi(t,e){var n=new bi(r(),t,e);return vi[n.id]=n}function xi(t,e){mi[t]=e}var bi=function(t,e,n){n=n||{},this.dom=e,this.id=t;var r=this,o=new Pn,a=n.renderer;if(gi){if(!mi.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");a="vml"}else a&&mi[a]||(a="canvas");var s=new mi[a](e,o,n,t);this.storage=o,this.painter=s;var l=i.node||i.worker?null:new hi(s.getViewportRoot(),s.root);this.handler=new Jt(o,s,l,s.root),this.animation=new Yr({stage:{update:P(this.flush,this)}}),this.animation.start();var u=o.delFromStorage,c=o.addToStorage;o.delFromStorage=function(t){u.call(o,t),t&&t.removeSelfFromZr(r)},o.addToStorage=function(t){c.call(o,t),t.addSelfToZr(r)}};bi.prototype={constructor:bi,getId:function(){return this.id},add:function(t){this.storage.addRoot(t),this._needsRefresh=!0},remove:function(t){this.storage.delRoot(t),this._needsRefresh=!0},configLayer:function(t,e){this.painter.configLayer&&this.painter.configLayer(t,e),this._needsRefresh=!0},setBackgroundColor:function(t){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this._needsRefresh=!0},refreshImmediately:function(){this._needsRefresh=this._needsRefreshHover=!1,this.painter.refresh(),this._needsRefresh=this._needsRefreshHover=!1},refresh:function(){this._needsRefresh=!0},flush:function(){var t;this._needsRefresh&&(t=!0,this.refreshImmediately()),this._needsRefreshHover&&(t=!0,this.refreshHoverImmediately()),t&&this.trigger("rendered")},addHover:function(t,e){if(this.painter.addHover){var n=this.painter.addHover(t,e);return this.refreshHover(),n}},removeHover:function(t){this.painter.removeHover&&(this.painter.removeHover(t),this.refreshHover())},clearHover:function(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover())},refreshHover:function(){this._needsRefreshHover=!0},refreshHoverImmediately:function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover()},resize:function(t){this.painter.resize((t=t||{}).width,t.height),this.handler.resize()},clearAnimation:function(){this.animation.clear()},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()},pathToImage:function(t,e){return this.painter.pathToImage(t,e)},setCursorStyle:function(t){this.handler.setCursorStyle(t)},findHover:function(t,e){return this.handler.findHover(t,e)},on:function(t,e,n){this.handler.on(t,e,n)},off:function(t,e){this.handler.off(t,e)},trigger:function(t,e){this.handler.trigger(t,e)},clear:function(){this.storage.delRoot(),this.painter.clear()},dispose:function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,function(t){delete vi[t]}(this.id)}};var _i=(Object.freeze||Object)({version:"4.3.2",init:yi,dispose:function(t){if(t)t.dispose();else{for(var e in vi)vi.hasOwnProperty(e)&&vi[e].dispose();vi={}}return this},getInstance:function(t){return vi[t]},registerPainter:xi}),wi=k,Si=B,Ci=R,Mi="series\0";function Ti(t){return t instanceof Array?t:null==t?[]:[t]}function ki(t,e,n){if(t){t[e]=t[e]||{},t.emphasis=t.emphasis||{},t.emphasis[e]=t.emphasis[e]||{};for(var r=0,i=n.length;r<i;r++){var o=n[r];!t.emphasis[e].hasOwnProperty(o)&&t[e].hasOwnProperty(o)&&(t.emphasis[e][o]=t[e][o])}}}var Ai=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function Ii(t){return!Si(t)||Ci(t)||t instanceof Date?t:t.value}function Di(t,e){e=(e||[]).slice();var n=A(t||[],function(t,e){return{exist:t}});return wi(e,function(t,r){if(Si(t)){for(var i=0;i<n.length;i++)if(!n[i].option&&null!=t.id&&n[i].exist.id===t.id+"")return n[i].option=t,void(e[r]=null);for(i=0;i<n.length;i++){var o=n[i].exist;if(!(n[i].option||null!=o.id&&null!=t.id||null==t.name||Ei(t)||Ei(o)||o.name!==t.name+""))return n[i].option=t,void(e[r]=null)}}}),wi(e,function(t,e){if(Si(t)){for(var r=0;r<n.length;r++)if(!n[r].option&&!Ei(n[r].exist)&&null==t.id){n[r].option=t;break}r>=n.length&&n.push({option:t})}}),n}function Oi(t){var e=Q();wi(t,function(t,n){var r=t.exist;r&&e.set(r.id,t)}),wi(t,function(t,n){var r=t.option;X(!r||null==r.id||!e.get(r.id)||e.get(r.id)===t,"id duplicates: "+(r&&r.id)),r&&null!=r.id&&e.set(r.id,t),t.keyInfo||(t.keyInfo={})}),wi(t,function(t,n){var r=t.exist,i=t.option,o=t.keyInfo;if(Si(i)){if(o.name=null!=i.name?i.name+"":r?r.name:Mi+n,r)o.id=r.id;else if(null!=i.id)o.id=i.id+"";else for(var a=0;o.id="\0"+o.name+"\0"+a++,e.get(o.id););e.set(o.id,t)}})}function Pi(t){var e=t.name;return!(!e||!e.indexOf(Mi))}function Ei(t){return Si(t)&&t.id&&0===(t.id+"").indexOf("\0_ec_\0")}function Ri(t,e){return null!=e.dataIndexInside?e.dataIndexInside:null!=e.dataIndex?R(e.dataIndex)?A(e.dataIndex,function(e){return t.indexOfRawIndex(e)}):t.indexOfRawIndex(e.dataIndex):null!=e.name?R(e.name)?A(e.name,function(e){return t.indexOfName(e)}):t.indexOfName(e.name):void 0}function Li(){var t="__\0ec_inner_"+Ni+++"_"+Math.random().toFixed(5);return function(e){return e[t]||(e[t]={})}}var Ni=0;function Bi(t,e,n){if(N(e)){var r={};r[e+"Index"]=0,e=r}var i=n&&n.defaultMainType;!i||zi(e,i+"Index")||zi(e,i+"Id")||zi(e,i+"Name")||(e[i+"Index"]=0);var o={};return wi(e,function(r,i){if(r=e[i],"dataIndex"!==i&&"dataIndexInside"!==i){var a=i.match(/^(\w+)(Index|Id|Name)$/)||[],s=a[1],l=(a[2]||"").toLowerCase();if(!(!s||!l||null==r||"index"===l&&"none"===r||n&&n.includeMainTypes&&S(n.includeMainTypes,s)<0)){var u={mainType:s};"index"===l&&"all"===r||(u[l]=r);var c=t.queryComponents(u);o[s+"Models"]=c,o[s+"Model"]=c[0]}}else o[i]=r}),o}function zi(t,e){return t&&t.hasOwnProperty(e)}function Vi(t,e,n){t.setAttribute?t.setAttribute(e,n):t[e]=n}function Fi(t){return"auto"===t?i.domSupported?"html":"richText":t||"html"}function Hi(t,e){var n=Q(),r=[];return k(t,function(t){var i=e(t);(n.get(i)||(r.push(i),n.set(i,[]))).push(t)}),{keys:r,buckets:n}}var Wi="___EC__COMPONENT__CONTAINER___";function ji(t){var e={main:"",sub:""};return t&&(t=t.split("."),e.main=t[0]||"",e.sub=t[1]||""),e}function Gi(t){(t.$constructor=t).extend=function(t){function e(){t.$constructor?t.$constructor.apply(this,arguments):n.apply(this,arguments)}var n=this;return x(e.prototype,t),e.extend=this.extend,e.superCall=Xi,e.superApply=Yi,C(e,this),e.superClass=n,e}}var Ui=0;function qi(t){var e=["__\0is_clz",Ui++,Math.random().toFixed(3)].join("_");t.prototype[e]=!0,t.isInstance=function(t){return!(!t||!t[e])}}function Xi(t,e){var n=U(arguments,2);return this.superClass.prototype[e].apply(t,n)}function Yi(t,e,n){return this.superClass.prototype[e].apply(t,n)}function $i(t,e){e=e||{};var n={};if(t.registerClass=function(t,e){return e&&(function(t){X(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(t),'componentType "'+t+'" illegal')}(e),(e=ji(e)).sub?e.sub!==Wi&&((function(t){var e=n[t.main];return e&&e[Wi]||((e=n[t.main]={})[Wi]=!0),e}(e))[e.sub]=t):n[e.main]=t),t},t.getClass=function(t,e,r){var i=n[t];if(i&&i[Wi]&&(i=e?i[e]:null),r&&!i)throw new Error(e?"Component "+t+"."+(e||"")+" not exists. Load it first.":t+".type should be specified.");return i},t.getClassesByMainType=function(t){t=ji(t);var e=[],r=n[t.main];return r&&r[Wi]?k(r,function(t,n){n!==Wi&&e.push(t)}):e.push(r),e},t.hasClass=function(t){return t=ji(t),!!n[t.main]},t.getAllClassMainTypes=function(){var t=[];return k(n,function(e,n){t.push(n)}),t},t.hasSubTypes=function(t){t=ji(t);var e=n[t.main];return e&&e[Wi]},t.parseClassType=ji,e.registerWhenExtend){var r=t.extend;r&&(t.extend=function(e){var n=r.call(this,e);return t.registerClass(n,e.type)})}return t}function Zi(t){for(var e=0;e<t.length;e++)t[e][1]||(t[e][1]=t[e][0]);return function(e,n,r){for(var i={},o=0;o<t.length;o++){var a=t[o][1];if(!(n&&0<=S(n,a)||r&&S(r,a)<0)){var s=e.getShallow(a);null!=s&&(i[t[o][0]]=s)}}return i}}var Ki=Zi([["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),Ji={getLineStyle:function(t){var e=Ki(this,t);return e.lineDash=this.getLineDash(e.lineWidth),e},getLineDash:function(t){null==t&&(t=1);var e=this.get("type"),n=Math.max(t,2),r=4*t;return"solid"!==e&&null!=e&&("dashed"===e?[r,r]:[n,n])}},Qi=Zi([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),to={getAreaStyle:function(t,e){return Qi(this,t,e)}},eo=Math.pow,no=Math.sqrt,ro=1e-8,io=1e-4,oo=no(3),ao=1/3,so=it(),lo=it(),uo=it();function co(t){return-ro<t&&t<ro}function fo(t){return ro<t||t<-ro}function ho(t,e,n,r,i){var o=1-i;return o*o*(o*t+3*i*e)+i*i*(i*r+3*o*n)}function po(t,e,n,r,i){var o=1-i;return 3*(((e-t)*o+2*(n-e)*i)*o+(r-n)*i*i)}function go(t,e,n,r,i){var o=6*n-12*e+6*t,a=9*e+3*r-3*t-9*n,s=3*e-3*t,l=0;if(co(a))fo(o)&&0<=(c=-s/o)&&c<=1&&(i[l++]=c);else{var u=o*o-4*a*s;if(co(u))i[0]=-o/(2*a);else if(0<u){var c,d=no(u),f=(-o-d)/(2*a);0<=(c=(-o+d)/(2*a))&&c<=1&&(i[l++]=c),0<=f&&f<=1&&(i[l++]=f)}}return l}function mo(t,e,n,r,i,o){var a=(e-t)*i+t,s=(n-e)*i+e,l=(r-n)*i+n,u=(s-a)*i+a,c=(l-s)*i+s,d=(c-u)*i+u;o[0]=t,o[1]=a,o[2]=u,o[3]=d,o[4]=d,o[5]=c,o[6]=l,o[7]=r}function vo(t,e,n,r){var i=1-r;return i*(i*t+2*r*e)+r*r*n}function yo(t,e,n,r){return 2*((1-r)*(e-t)+r*(n-e))}function xo(t,e,n){var r=t+n-2*e;return 0==r?.5:(t-e)/r}function bo(t,e,n,r,i){var o=(e-t)*r+t,a=(n-e)*r+e,s=(a-o)*r+o;i[0]=t,i[1]=o,i[2]=s,i[3]=s,i[4]=a,i[5]=n}var _o=Math.min,wo=Math.max,So=Math.sin,Co=Math.cos,Mo=2*Math.PI,To=it(),ko=it(),Ao=it();function Io(t,e,n){if(0!==t.length){var r,i=t[0],o=i[0],a=i[0],s=i[1],l=i[1];for(r=1;r<t.length;r++)o=_o(o,(i=t[r])[0]),a=wo(a,i[0]),s=_o(s,i[1]),l=wo(l,i[1]);e[0]=o,e[1]=s,n[0]=a,n[1]=l}}function Do(t,e,n,r,i,o){i[0]=_o(t,n),i[1]=_o(e,r),o[0]=wo(t,n),o[1]=wo(e,r)}var Oo=[],Po=[];function Eo(t,e,n,r,i,o,a,s,l,u){var c,d=go,f=ho,h=d(t,n,i,a,Oo);for(l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0,c=0;c<h;c++){var p=f(t,n,i,a,Oo[c]);l[0]=_o(p,l[0]),u[0]=wo(p,u[0])}for(h=d(e,r,o,s,Po),c=0;c<h;c++){var g=f(e,r,o,s,Po[c]);l[1]=_o(g,l[1]),u[1]=wo(g,u[1])}l[0]=_o(t,l[0]),u[0]=wo(t,u[0]),l[0]=_o(a,l[0]),u[0]=wo(a,u[0]),l[1]=_o(e,l[1]),u[1]=wo(e,u[1]),l[1]=_o(s,l[1]),u[1]=wo(s,u[1])}function Ro(t,e,n,r,i,o,a,s,l){var u=_t,c=wt,d=Math.abs(i-o);if(d%Mo<1e-4&&1e-4<d)return s[0]=t-n,s[1]=e-r,l[0]=t+n,void(l[1]=e+r);if(To[0]=Co(i)*n+t,To[1]=So(i)*r+e,ko[0]=Co(o)*n+t,ko[1]=So(o)*r+e,u(s,To,ko),c(l,To,ko),(i%=Mo)<0&&(i+=Mo),(o%=Mo)<0&&(o+=Mo),o<i&&!a?o+=Mo:i<o&&a&&(i+=Mo),a){var f=o;o=i,i=f}for(var h=0;h<o;h+=Math.PI/2)i<h&&(Ao[0]=Co(h)*n+t,Ao[1]=So(h)*r+e,u(s,Ao,s),c(l,Ao,l))}var Lo={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},No=[],Bo=[],zo=[],Vo=[],Fo=Math.min,Ho=Math.max,Wo=Math.cos,jo=Math.sin,Go=Math.sqrt,Uo=Math.abs,qo="undefined"!=typeof Float32Array,Xo=function(t){this._saveData=!t,this._saveData&&(this.data=[]),this._ctx=null};function Yo(t,e,n,r,i,o,a){if(0===i)return!1;var s,l=i;if(e+l<a&&r+l<a||a<e-l&&a<r-l||t+l<o&&n+l<o||o<t-l&&o<n-l)return!1;if(t===n)return Math.abs(o-t)<=l/2;var u=(s=(e-r)/(t-n))*o-a+(t*r-n*e)/(t-n);return u*u/(s*s+1)<=l/2*l/2}function $o(t,e,n,r,i,o,a,s,l,u,c){if(0===l)return!1;var d=l;return!(e+d<c&&r+d<c&&o+d<c&&s+d<c||c<e-d&&c<r-d&&c<o-d&&c<s-d||t+d<u&&n+d<u&&i+d<u&&a+d<u||u<t-d&&u<n-d&&u<i-d&&u<a-d)&&function(t,e,n,r,i,o,a,s,l,u,c){var d,f,h,p,g,m=.005,v=1/0;so[0]=l,so[1]=u;for(var y=0;y<1;y+=.05)lo[0]=ho(t,n,i,a,y),lo[1]=ho(e,r,o,s,y),(p=yt(so,lo))<v&&(d=y,v=p);v=1/0;for(var x=0;x<32&&!(m<io);x++)h=d+m,lo[0]=ho(t,n,i,a,f=d-m),lo[1]=ho(e,r,o,s,f),p=yt(lo,so),0<=f&&p<v?(d=f,v=p):(uo[0]=ho(t,n,i,a,h),uo[1]=ho(e,r,o,s,h),g=yt(uo,so),h<=1&&g<v?(d=h,v=g):m*=.5);return no(v)}(t,e,n,r,i,o,a,s,u,c)<=d/2}function Zo(t,e,n,r,i,o,a,s,l){if(0===a)return!1;var u=a;return!(e+u<l&&r+u<l&&o+u<l||l<e-u&&l<r-u&&l<o-u||t+u<s&&n+u<s&&i+u<s||s<t-u&&s<n-u&&s<i-u)&&function(t,e,n,r,i,o,a,s,l){var u,c=.005,d=1/0;so[0]=a,so[1]=s;for(var f=0;f<1;f+=.05)lo[0]=vo(t,n,i,f),lo[1]=vo(e,r,o,f),(m=yt(so,lo))<d&&(u=f,d=m);d=1/0;for(var h=0;h<32&&!(c<io);h++){var p=u-c,g=u+c;lo[0]=vo(t,n,i,p),lo[1]=vo(e,r,o,p);var m=yt(lo,so);if(0<=p&&m<d)u=p,d=m;else{uo[0]=vo(t,n,i,g),uo[1]=vo(e,r,o,g);var v=yt(uo,so);g<=1&&v<d?(u=g,d=v):c*=.5}}return no(d)}(t,e,n,r,i,o,s,l)<=u/2}Xo.prototype={constructor:Xo,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function(t,e,n){this._ux=Uo((n=n||0)/dn/t)||0,this._uy=Uo(n/dn/e)||0},getContext:function(){return this._ctx},beginPath:function(t){return(this._ctx=t)&&t.beginPath(),t&&(this.dpr=t.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(t,e){return this.addData(Lo.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},lineTo:function(t,e){var n=Uo(t-this._xi)>this._ux||Uo(e-this._yi)>this._uy||this._len<5;return this.addData(Lo.L,t,e),this._ctx&&n&&(this._needsDash()?this._dashedLineTo(t,e):this._ctx.lineTo(t,e)),n&&(this._xi=t,this._yi=e),this},bezierCurveTo:function(t,e,n,r,i,o){return this.addData(Lo.C,t,e,n,r,i,o),this._ctx&&(this._needsDash()?this._dashedBezierTo(t,e,n,r,i,o):this._ctx.bezierCurveTo(t,e,n,r,i,o)),this._xi=i,this._yi=o,this},quadraticCurveTo:function(t,e,n,r){return this.addData(Lo.Q,t,e,n,r),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(t,e,n,r):this._ctx.quadraticCurveTo(t,e,n,r)),this._xi=n,this._yi=r,this},arc:function(t,e,n,r,i,o){return this.addData(Lo.A,t,e,n,n,r,i-r,0,o?0:1),this._ctx&&this._ctx.arc(t,e,n,r,i,o),this._xi=Wo(i)*n+t,this._yi=jo(i)*n+e,this},arcTo:function(t,e,n,r,i){return this._ctx&&this._ctx.arcTo(t,e,n,r,i),this},rect:function(t,e,n,r){return this._ctx&&this._ctx.rect(t,e,n,r),this.addData(Lo.R,t,e,n,r),this},closePath:function(){this.addData(Lo.Z);var t=this._ctx,e=this._x0,n=this._y0;return t&&(this._needsDash()&&this._dashedLineTo(e,n),t.closePath()),this._xi=e,this._yi=n,this},fill:function(t){t&&t.fill(),this.toStatic()},stroke:function(t){t&&t.stroke(),this.toStatic()},setLineDash:function(t){if(t instanceof Array){this._lineDash=t;for(var e=this._dashIdx=0,n=0;n<t.length;n++)e+=t[n];this._dashSum=e}return this},setLineDashOffset:function(t){return this._dashOffset=t,this},len:function(){return this._len},setData:function(t){var e=t.length;this.data&&this.data.length===e||!qo||(this.data=new Float32Array(e));for(var n=0;n<e;n++)this.data[n]=t[n];this._len=e},appendPath:function(t){t instanceof Array||(t=[t]);for(var e=t.length,n=0,r=this._len,i=0;i<e;i++)n+=t[i].len();for(qo&&this.data instanceof Float32Array&&(this.data=new Float32Array(r+n)),i=0;i<e;i++)for(var o=t[i].data,a=0;a<o.length;a++)this.data[r++]=o[a];this._len=r},addData:function(t){if(this._saveData){var e=this.data;this._len+arguments.length>e.length&&(this._expandData(),e=this.data);for(var n=0;n<arguments.length;n++)e[this._len++]=arguments[n];this._prevCmd=t}},_expandData:function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}},_needsDash:function(){return this._lineDash},_dashedLineTo:function(t,e){var n,r,i=this._dashSum,o=this._dashOffset,a=this._lineDash,s=this._ctx,l=this._xi,u=this._yi,c=t-l,d=e-u,f=Go(c*c+d*d),h=l,p=u,g=a.length;for(o<0&&(o=i+o),h-=(o%=i)*(c/=f),p-=o*(d/=f);0<c&&h<=t||c<0&&t<=h||0===c&&(0<d&&p<=e||d<0&&e<=p);)h+=c*(n=a[r=this._dashIdx]),p+=d*n,this._dashIdx=(r+1)%g,0<c&&h<l||c<0&&l<h||0<d&&p<u||d<0&&u<p||s[r%2?"moveTo":"lineTo"](0<=c?Fo(h,t):Ho(h,t),0<=d?Fo(p,e):Ho(p,e));this._dashOffset=-Go((c=h-t)*c+(d=p-e)*d)},_dashedBezierTo:function(t,e,n,r,i,o){var a,s,l,u,c,d=this._dashSum,f=this._dashOffset,h=this._lineDash,p=this._ctx,g=this._xi,m=this._yi,v=ho,y=0,x=this._dashIdx,b=h.length,_=0;for(f<0&&(f=d+f),f%=d,a=0;a<1;a+=.1)s=v(g,t,n,i,a+.1)-v(g,t,n,i,a),l=v(m,e,r,o,a+.1)-v(m,e,r,o,a),y+=Go(s*s+l*l);for(;x<b&&!(f<(_+=h[x]));x++);for(a=(_-f)/y;a<=1;)u=v(g,t,n,i,a),c=v(m,e,r,o,a),x%2?p.moveTo(u,c):p.lineTo(u,c),a+=h[x]/y,x=(x+1)%b;x%2!=0&&p.lineTo(i,o),this._dashOffset=-Go((s=i-u)*s+(l=o-c)*l)},_dashedQuadraticTo:function(t,e,n,r){var i=n,o=r;n=(n+2*t)/3,r=(r+2*e)/3,this._dashedBezierTo(t=(this._xi+2*t)/3,e=(this._yi+2*e)/3,n,r,i,o)},toStatic:function(){var t=this.data;t instanceof Array&&(t.length=this._len,qo&&(this.data=new Float32Array(t)))},getBoundingRect:function(){No[0]=No[1]=zo[0]=zo[1]=Number.MAX_VALUE,Bo[0]=Bo[1]=Vo[0]=Vo[1]=-Number.MAX_VALUE;for(var t,e,n,r,i,o,a,s,l,u,c,d,f,h,p=this.data,g=0,m=0,v=0,y=0,x=0;x<p.length;){var b=p[x++];switch(1===x&&(v=g=p[x],y=m=p[x+1]),b){case Lo.M:g=v=p[x++],m=y=p[x++],zo[0]=v,zo[1]=y,Vo[0]=v,Vo[1]=y;break;case Lo.L:Do(g,m,p[x],p[x+1],zo,Vo),g=p[x++],m=p[x++];break;case Lo.C:Eo(g,m,p[x++],p[x++],p[x++],p[x++],p[x],p[x+1],zo,Vo),g=p[x++],m=p[x++];break;case Lo.Q:e=m,n=p[x++],r=p[x++],o=p[x+1],a=zo,s=Vo,u=l=void 0,u=vo,c=wo(_o((l=xo)(t=g,n,i=p[x]),1),0),d=wo(_o(l(e,r,o),1),0),f=u(t,n,i,c),h=u(e,r,o,d),a[0]=_o(t,i,f),a[1]=_o(e,o,h),s[0]=wo(t,i,f),s[1]=wo(e,o,h),g=p[x++],m=p[x++];break;case Lo.A:var _=p[x++],w=p[x++],S=p[x++],C=p[x++],M=p[x++],T=p[x++]+M;x+=1;var k=1-p[x++];1===x&&(v=Wo(M)*S+_,y=jo(M)*C+w),Ro(_,w,S,C,M,T,k,zo,Vo),g=Wo(T)*S+_,m=jo(T)*C+w;break;case Lo.R:Do(v=g=p[x++],y=m=p[x++],v+p[x++],y+p[x++],zo,Vo);break;case Lo.Z:g=v,m=y}_t(No,No,zo),wt(Bo,Bo,Vo)}return 0===x&&(No[0]=No[1]=Bo[0]=Bo[1]=0),new Sn(No[0],No[1],Bo[0]-No[0],Bo[1]-No[1])},rebuildPath:function(t){for(var e,n,r,i,o,a,s=this.data,l=this._ux,u=this._uy,c=this._len,d=0;d<c;){var f=s[d++];switch(1===d&&(e=r=s[d],n=i=s[d+1]),f){case Lo.M:e=r=s[d++],n=i=s[d++],t.moveTo(r,i);break;case Lo.L:o=s[d++],a=s[d++],(Uo(o-r)>l||Uo(a-i)>u||d===c-1)&&(t.lineTo(o,a),r=o,i=a);break;case Lo.C:t.bezierCurveTo(s[d++],s[d++],s[d++],s[d++],s[d++],s[d++]),r=s[d-2],i=s[d-1];break;case Lo.Q:t.quadraticCurveTo(s[d++],s[d++],s[d++],s[d++]),r=s[d-2],i=s[d-1];break;case Lo.A:var h=s[d++],p=s[d++],g=s[d++],m=s[d++],v=s[d++],y=s[d++],x=s[d++],b=s[d++],_=m<g?g:m,w=m<g?1:g/m,S=m<g?m/g:1,C=v+y;.001<Math.abs(g-m)?(t.translate(h,p),t.rotate(x),t.scale(w,S),t.arc(0,0,_,v,C,1-b),t.scale(1/w,1/S),t.rotate(-x),t.translate(-h,-p)):t.arc(h,p,_,v,C,1-b),1===d&&(e=Wo(v)*g+h,n=jo(v)*m+p),r=Wo(C)*g+h,i=jo(C)*m+p;break;case Lo.R:e=r=s[d],n=i=s[d+1],t.rect(s[d++],s[d++],s[d++],s[d++]);break;case Lo.Z:t.closePath(),r=e,i=n}}}},Xo.CMD=Lo;var Ko=2*Math.PI;function Jo(t){return(t%=Ko)<0&&(t+=Ko),t}var Qo=2*Math.PI;function ta(t,e,n,r,i,o,a,s,l){if(0===a)return!1;var u=a;s-=t,l-=e;var c=Math.sqrt(s*s+l*l);if(n<c-u||c+u<n)return!1;if(Math.abs(r-i)%Qo<1e-4)return!0;if(o){var d=r;r=Jo(i),i=Jo(d)}else r=Jo(r),i=Jo(i);i<r&&(i+=Qo);var f=Math.atan2(l,s);return f<0&&(f+=Qo),r<=f&&f<=i||r<=f+Qo&&f+Qo<=i}function ea(t,e,n,r,i,o){if(e<o&&r<o||o<e&&o<r)return 0;if(r===e)return 0;var a=r<e?1:-1,s=(o-e)/(r-e);1!=s&&0!=s||(a=r<e?.5:-.5);var l=s*(n-t)+t;return l===i?1/0:i<l?a:0}var na=Xo.CMD,ra=2*Math.PI,ia=[-1,-1,-1],oa=[-1,-1];function aa(t,e,n,r,i,o,a,s,l,u){if(e<u&&r<u&&o<u&&s<u||u<e&&u<r&&u<o&&u<s)return 0;var c,d=function(t,e,n,r,i,o){var a=r+3*(e-n)-t,s=3*(n-2*e+t),l=3*(e-t),u=t-i,c=s*s-3*a*l,d=s*l-9*a*u,f=l*l-3*s*u,h=0;if(co(c)&&co(d))co(s)?o[0]=0:0<=(C=-l/s)&&C<=1&&(o[h++]=C);else{var p=d*d-4*c*f;if(co(p)){var g=d/c,m=-g/2;0<=(C=-s/a+g)&&C<=1&&(o[h++]=C),0<=m&&m<=1&&(o[h++]=m)}else if(0<p){var v=no(p),y=c*s+1.5*a*(-d+v),x=c*s+1.5*a*(-d-v);0<=(C=(-s-((y=y<0?-eo(-y,ao):eo(y,ao))+(x=x<0?-eo(-x,ao):eo(x,ao))))/(3*a))&&C<=1&&(o[h++]=C)}else{var b=(2*c*s-3*a*d)/(2*no(c*c*c)),_=Math.acos(b)/3,w=no(c),S=Math.cos(_),C=(-s-2*w*S)/(3*a),M=(m=(-s+w*(S+oo*Math.sin(_)))/(3*a),(-s+w*(S-oo*Math.sin(_)))/(3*a));0<=C&&C<=1&&(o[h++]=C),0<=m&&m<=1&&(o[h++]=m),0<=M&&M<=1&&(o[h++]=M)}}return h}(e,r,o,s,u,ia);if(0===d)return 0;for(var f,h,p=0,g=-1,m=0;m<d;m++){var v=ia[m],y=0===v||1===v?.5:1;ho(t,n,i,a,v)<l||(g<0&&(g=go(e,r,o,s,oa),oa[1]<oa[0]&&1<g&&(c=oa[0],oa[0]=oa[1],oa[1]=c),f=ho(e,r,o,s,oa[0]),1<g&&(h=ho(e,r,o,s,oa[1]))),p+=2===g?v<oa[0]?f<e?y:-y:v<oa[1]?h<f?y:-y:s<h?y:-y:v<oa[0]?f<e?y:-y:s<f?y:-y)}return p}function sa(t,e,n,r,i,o,a,s){if(e<s&&r<s&&o<s||s<e&&s<r&&s<o)return 0;var l=function(t,e,n,r,i){var o=t-2*e+n,a=2*(e-t),s=t-r,l=0;if(co(o))fo(a)&&0<=(c=-s/a)&&c<=1&&(i[l++]=c);else{var u=a*a-4*o*s;if(co(u))0<=(c=-a/(2*o))&&c<=1&&(i[l++]=c);else if(0<u){var c,d=no(u),f=(-a-d)/(2*o);0<=(c=(-a+d)/(2*o))&&c<=1&&(i[l++]=c),0<=f&&f<=1&&(i[l++]=f)}}return l}(e,r,o,s,ia);if(0===l)return 0;var u=xo(e,r,o);if(0<=u&&u<=1){for(var c=0,d=vo(e,r,o,u),f=0;f<l;f++){var h=0===ia[f]||1===ia[f]?.5:1;vo(t,n,i,ia[f])<a||(c+=ia[f]<u?d<e?h:-h:o<d?h:-h)}return c}return h=0===ia[0]||1===ia[0]?.5:1,vo(t,n,i,ia[0])<a?0:o<e?h:-h}function la(t,e,n,r,i,o,a,s){if(n<(s-=e)||s<-n)return 0;var l=Math.sqrt(n*n-s*s);ia[0]=-l,ia[1]=l;var u=Math.abs(r-i);if(u<1e-4)return 0;if(u%ra<1e-4){i=ra;var c=o?1:-1;return a>=ia[r=0]+t&&a<=ia[1]+t?c:0}o?(l=r,r=Jo(i),i=Jo(l)):(r=Jo(r),i=Jo(i)),i<r&&(i+=ra);for(var d=0,f=0;f<2;f++){var h=ia[f];if(a<h+t){var p=Math.atan2(s,h);c=o?1:-1,p<0&&(p=ra+p),(r<=p&&p<=i||r<=p+ra&&p+ra<=i)&&(p>Math.PI/2&&p<1.5*Math.PI&&(c=-c),d+=c)}}return d}function ua(t,e,n,r,i){for(var o=0,a=0,s=0,l=0,u=0,c=0;c<t.length;){var d=t[c++];switch(d===na.M&&1<c&&(n||(o+=ea(a,s,l,u,r,i))),1===c&&(l=a=t[c],u=s=t[c+1]),d){case na.M:a=l=t[c++],s=u=t[c++];break;case na.L:if(n){if(Yo(a,s,t[c],t[c+1],e,r,i))return!0}else o+=ea(a,s,t[c],t[c+1],r,i)||0;a=t[c++],s=t[c++];break;case na.C:if(n){if($o(a,s,t[c++],t[c++],t[c++],t[c++],t[c],t[c+1],e,r,i))return!0}else o+=aa(a,s,t[c++],t[c++],t[c++],t[c++],t[c],t[c+1],r,i)||0;a=t[c++],s=t[c++];break;case na.Q:if(n){if(Zo(a,s,t[c++],t[c++],t[c],t[c+1],e,r,i))return!0}else o+=sa(a,s,t[c++],t[c++],t[c],t[c+1],r,i)||0;a=t[c++],s=t[c++];break;case na.A:var f=t[c++],h=t[c++],p=t[c++],g=t[c++],m=t[c++],v=t[c++];c+=1;var y=1-t[c++],x=Math.cos(m)*p+f,b=Math.sin(m)*g+h;1<c?o+=ea(a,s,x,b,r,i):(l=x,u=b);var _=(r-f)*g/p+f;if(n){if(ta(f,h,g,m,m+v,y,e,_,i))return!0}else o+=la(f,h,g,m,m+v,y,_,i);a=Math.cos(m+v)*p+f,s=Math.sin(m+v)*g+h;break;case na.R:if(l=a=t[c++],u=s=t[c++],x=l+t[c++],b=u+t[c++],n){if(Yo(l,u,x,u,e,r,i)||Yo(x,u,x,b,e,r,i)||Yo(x,b,l,b,e,r,i)||Yo(l,b,l,u,e,r,i))return!0}else o+=ea(x,u,x,b,r,i),o+=ea(l,b,l,u,r,i);break;case na.Z:if(n){if(Yo(a,s,l,u,e,r,i))return!0}else o+=ea(a,s,l,u,r,i);a=l,s=u}}return n||function(t,e){return Math.abs(t-e)<1e-4}(s,u)||(o+=ea(a,s,l,u,r,i)||0),0!==o}var ca=Wn.prototype.getCanvasPattern,da=Math.abs,fa=new Xo(!0);function ha(t){Hr.call(this,t),this.path=null}function pa(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}ha.prototype={constructor:ha,type:"path",__dirtyPath:!0,strokeContainThreshold:5,segmentIgnoreThreshold:0,subPixelOptimize:!1,brush:function(t,e){var n,r=this.style,i=this.path||fa,o=r.hasStroke(),a=r.hasFill(),s=r.fill,l=r.stroke,u=a&&!!s.colorStops,c=o&&!!l.colorStops,d=a&&!!s.image,f=o&&!!l.image;r.bind(t,this,e),this.setTransform(t),this.__dirty&&(u&&(n=n||this.getBoundingRect(),this._fillGradient=r.getGradient(t,s,n)),c&&(n=n||this.getBoundingRect(),this._strokeGradient=r.getGradient(t,l,n))),u?t.fillStyle=this._fillGradient:d&&(t.fillStyle=ca.call(s,t)),c?t.strokeStyle=this._strokeGradient:f&&(t.strokeStyle=ca.call(l,t));var h=r.lineDash,p=r.lineDashOffset,g=!!t.setLineDash,m=this.getGlobalScale();if(i.setScale(m[0],m[1],this.segmentIgnoreThreshold),this.__dirtyPath||h&&!g&&o?(i.beginPath(t),h&&!g&&(i.setLineDash(h),i.setLineDashOffset(p)),this.buildPath(i,this.shape,!1),this.path&&(this.__dirtyPath=!1)):(t.beginPath(),this.path.rebuildPath(t)),a)if(null!=r.fillOpacity){var v=t.globalAlpha;t.globalAlpha=r.fillOpacity*r.opacity,i.fill(t),t.globalAlpha=v}else i.fill(t);h&&g&&(t.setLineDash(h),t.lineDashOffset=p),o&&(null!=r.strokeOpacity?(v=t.globalAlpha,t.globalAlpha=r.strokeOpacity*r.opacity,i.stroke(t),t.globalAlpha=v):i.stroke(t)),h&&g&&t.setLineDash([]),null!=r.text&&(this.restoreTransform(t),this.drawRectText(t,this.getBoundingRect()))},buildPath:function(t,e,n){},createPathProxy:function(){this.path=new Xo},getBoundingRect:function(){var t=this._rect,e=this.style,n=!t;if(n){var r=this.path;r=r||(this.path=new Xo),this.__dirtyPath&&(r.beginPath(),this.buildPath(r,this.shape,!1)),t=r.getBoundingRect()}if(this._rect=t,e.hasStroke()){var i=this._rectWithStroke||(this._rectWithStroke=t.clone());if(this.__dirty||n){i.copy(t);var o=e.lineWidth,a=e.strokeNoScale?this.getLineScale():1;e.hasFill()||(o=Math.max(o,this.strokeContainThreshold||4)),1e-10<a&&(i.width+=o/a,i.height+=o/a,i.x-=o/a/2,i.y-=o/a/2)}return i}return t},contain:function(t,e){var n=this.transformCoordToLocal(t,e),r=this.getBoundingRect(),i=this.style;if(r.contain(t=n[0],e=n[1])){var o=this.path.data;if(i.hasStroke()){var a=i.lineWidth,s=i.strokeNoScale?this.getLineScale():1;if(1e-10<s&&(i.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),function(t,e,n,r){return ua(t,e,!0,n,r)}(o,a/s,t,e)))return!0}if(i.hasFill())return function(t,e,n){return ua(t,0,!1,e,n)}(o,t,e)}return!1},dirty:function(t){null==t&&(t=!0),t&&(this.__dirtyPath=t,this._rect=null),this.__dirty=this.__dirtyText=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty()},animateShape:function(t){return this.animate("shape",t)},attrKV:function(t,e){"shape"===t?(this.setShape(e),this.__dirtyPath=!0,this._rect=null):Hr.prototype.attrKV.call(this,t,e)},setShape:function(t,e){var n=this.shape;if(n){if(B(t))for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);else n[t]=e;this.dirty(!0)}return this},getLineScale:function(){var t=this.transform;return t&&1e-10<da(t[0]-1)&&1e-10<da(t[3]-1)?Math.sqrt(da(t[0]*t[3]-t[2]*t[1])):1}},ha.extend=function(t){function e(e){ha.call(this,e),t.style&&this.style.extendFrom(t.style,!1);var n=t.shape;if(n){this.shape=this.shape||{};var r=this.shape;for(var i in n)!r.hasOwnProperty(i)&&n.hasOwnProperty(i)&&(r[i]=n[i])}t.init&&t.init.call(this,e)}for(var n in C(e,ha),t)"style"!==n&&"shape"!==n&&(e.prototype[n]=t[n]);return e},C(ha,Hr);var ga=Xo.CMD,ma=[[],[],[]],va=Math.sqrt,ya=Math.atan2,xa=Math.sqrt,ba=Math.sin,_a=Math.cos,wa=Math.PI,Sa=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(pa(t)*pa(e))},Ca=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Sa(t,e))};function Ma(t,e,n,r,i,o,a,s,l,u,c){var d=l*(wa/180),f=_a(d)*(t-n)/2+ba(d)*(e-r)/2,h=-1*ba(d)*(t-n)/2+_a(d)*(e-r)/2,p=f*f/(a*a)+h*h/(s*s);1<p&&(a*=xa(p),s*=xa(p));var g=(i===o?-1:1)*xa((a*a*(s*s)-a*a*(h*h)-s*s*(f*f))/(a*a*(h*h)+s*s*(f*f)))||0,m=g*a*h/s,v=g*-s*f/a,y=(t+n)/2+_a(d)*m-ba(d)*v,x=(e+r)/2+ba(d)*m+_a(d)*v,b=Ca([1,0],[(f-m)/a,(h-v)/s]),_=[(f-m)/a,(h-v)/s],w=[(-1*f-m)/a,(-1*h-v)/s],S=Ca(_,w);Sa(_,w)<=-1&&(S=wa),1<=Sa(_,w)&&(S=0),0===o&&0<S&&(S-=2*wa),1===o&&S<0&&(S+=2*wa),c.addData(u,y,x,a,s,b,S,d,o)}var Ta=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,ka=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function Aa(t,e){var n=function(t){if(!t)return new Xo;for(var e,n=0,r=0,i=n,o=r,a=new Xo,s=Xo.CMD,l=t.match(Ta),u=0;u<l.length;u++){for(var c,d=l[u],f=d.charAt(0),h=d.match(ka)||[],p=h.length,g=0;g<p;g++)h[g]=parseFloat(h[g]);for(var m=0;m<p;){var v,y,x,b,_,w,S,C=n,M=r;switch(f){case"l":n+=h[m++],r+=h[m++],a.addData(c=s.L,n,r);break;case"L":n=h[m++],r=h[m++],a.addData(c=s.L,n,r);break;case"m":n+=h[m++],r+=h[m++],a.addData(c=s.M,n,r),i=n,o=r,f="l";break;case"M":n=h[m++],r=h[m++],a.addData(c=s.M,n,r),i=n,o=r,f="L";break;case"h":n+=h[m++],a.addData(c=s.L,n,r);break;case"H":n=h[m++],a.addData(c=s.L,n,r);break;case"v":r+=h[m++],a.addData(c=s.L,n,r);break;case"V":r=h[m++],a.addData(c=s.L,n,r);break;case"C":a.addData(c=s.C,h[m++],h[m++],h[m++],h[m++],h[m++],h[m++]),n=h[m-2],r=h[m-1];break;case"c":a.addData(c=s.C,h[m++]+n,h[m++]+r,h[m++]+n,h[m++]+r,h[m++]+n,h[m++]+r),n+=h[m-2],r+=h[m-1];break;case"S":v=n,y=r;var T=a.len(),k=a.data;e===s.C&&(v+=n-k[T-4],y+=r-k[T-3]),C=h[m++],M=h[m++],n=h[m++],r=h[m++],a.addData(c=s.C,v,y,C,M,n,r);break;case"s":v=n,y=r,T=a.len(),k=a.data,e===s.C&&(v+=n-k[T-4],y+=r-k[T-3]),C=n+h[m++],M=r+h[m++],n+=h[m++],r+=h[m++],a.addData(c=s.C,v,y,C,M,n,r);break;case"Q":C=h[m++],M=h[m++],n=h[m++],r=h[m++],a.addData(c=s.Q,C,M,n,r);break;case"q":C=h[m++]+n,M=h[m++]+r,n+=h[m++],r+=h[m++],a.addData(c=s.Q,C,M,n,r);break;case"T":v=n,y=r,T=a.len(),k=a.data,e===s.Q&&(v+=n-k[T-4],y+=r-k[T-3]),n=h[m++],r=h[m++],a.addData(c=s.Q,v,y,n,r);break;case"t":v=n,y=r,T=a.len(),k=a.data,e===s.Q&&(v+=n-k[T-4],y+=r-k[T-3]),n+=h[m++],r+=h[m++],a.addData(c=s.Q,v,y,n,r);break;case"A":x=h[m++],b=h[m++],_=h[m++],w=h[m++],S=h[m++],Ma(C=n,M=r,n=h[m++],r=h[m++],w,S,x,b,_,c=s.A,a);break;case"a":x=h[m++],b=h[m++],_=h[m++],w=h[m++],S=h[m++],Ma(C=n,M=r,n+=h[m++],r+=h[m++],w,S,x,b,_,c=s.A,a)}}"z"!==f&&"Z"!==f||(a.addData(c=s.Z),n=i,r=o),e=c}return a.toStatic(),a}(t);return(e=e||{}).buildPath=function(t){if(t.setData)t.setData(n.data),(e=t.getContext())&&t.rebuildPath(e);else{var e=t;n.rebuildPath(e)}},e.applyTransform=function(t){(function(t,e){var n,r,i,o,a,s=t.data,l=ga.M,u=ga.C,c=ga.L,d=ga.R,f=ga.A,h=ga.Q;for(o=i=0;i<s.length;){switch(n=s[i++],o=i,r=0,n){case l:case c:r=1;break;case u:r=3;break;case h:r=2;break;case f:var p=e[4],g=e[5],m=va(e[0]*e[0]+e[1]*e[1]),v=va(e[2]*e[2]+e[3]*e[3]),y=ya(-e[1]/v,e[0]/m);s[i]*=m,s[i++]+=p,s[i]*=v,s[i++]+=g,s[i++]*=m,s[i++]*=v,s[i++]+=y,s[i++]+=y,o=i+=2;break;case d:x[0]=s[i++],x[1]=s[i++],bt(x,x,e),s[o++]=x[0],s[o++]=x[1],x[0]+=s[i++],x[1]+=s[i++],bt(x,x,e),s[o++]=x[0],s[o++]=x[1]}for(a=0;a<r;a++){var x;(x=ma[a])[0]=s[i++],x[1]=s[i++],bt(x,x,e),s[o++]=x[0],s[o++]=x[1]}}})(n,t),this.dirty(!0)},e}function Ia(t,e){return new ha(Aa(t,e))}var Da=function(t){Hr.call(this,t)};function Oa(t){return i.browser.ie&&11<=i.browser.version?function(){var e,n=this.__clipPaths,r=this.style;if(n)for(var i=0;i<n.length;i++){var o=n[i],a=o&&o.shape,s=o&&o.type;if(a&&("sector"===s&&a.startAngle===a.endAngle||"rect"===s&&(!a.width||!a.height))){for(var l=0;l<Ea.length;l++)Ea[l][2]=r[Ea[l][0]],r[Ea[l][0]]=Ea[l][1];e=!0;break}}if(t.apply(this,arguments),e)for(l=0;l<Ea.length;l++)r[Ea[l][0]]=Ea[l][2]}:t}Da.prototype={constructor:Da,type:"text",brush:function(t,e){var n=this.style;this.__dirty&&Cr(n),n.fill=n.stroke=n.shadowBlur=n.shadowColor=n.shadowOffsetX=n.shadowOffsetY=null;var r=n.text;null!=r&&(r+=""),zr(r,n)?(this.setTransform(t),Tr(this,t,r,n,null,e),this.restoreTransform(t)):t.__attrCachedBy=0},getBoundingRect:function(){var t=this.style;if(this.__dirty&&Cr(t),!this._rect){var e=t.text;null!=e?e+="":e="";var n=ir(t.text+"",t.font,t.textAlign,t.textVerticalAlign,t.textPadding,t.textLineHeight,t.rich);if(n.x+=t.x||0,n.y+=t.y||0,Rr(t.textStroke,t.textStrokeWidth)){var r=t.textStrokeWidth;n.x-=r/2,n.y-=r/2,n.width+=r,n.height+=r}this._rect=n}return this._rect}},C(Da,Hr);var Pa=ha.extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function(t,e,n){n&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0)}}),Ea=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]],Ra=ha.extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:Oa(ha.prototype.brush),buildPath:function(t,e){var n=e.cx,r=e.cy,i=Math.max(e.r0||0,0),o=Math.max(e.r,0),a=e.startAngle,s=e.endAngle,l=e.clockwise,u=Math.cos(a),c=Math.sin(a);t.moveTo(u*i+n,c*i+r),t.lineTo(u*o+n,c*o+r),t.arc(n,r,o,a,s,!l),t.lineTo(Math.cos(s)*i+n,Math.sin(s)*i+r),0!==i&&t.arc(n,r,i,s,a,l),t.closePath()}}),La=ha.extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(t,e){var n=e.cx,r=e.cy,i=2*Math.PI;t.moveTo(n+e.r,r),t.arc(n,r,e.r,0,i,!1),t.moveTo(n+e.r0,r),t.arc(n,r,e.r0,0,i,!0)}});function Na(t,e,n,r,i,o,a){var s=.5*(n-t),l=.5*(r-e);return(2*(e-n)+s+l)*a+(-3*(e-n)-2*s-l)*o+s*i+e}function Ba(t,e,n){var r=e.points,i=e.smooth;if(r&&2<=r.length){if(i&&"spline"!==i){var o=function(t,e,n,r){var i,o,a,s,l=[],u=[],c=[],d=[];if(r){a=[1/0,1/0],s=[-1/0,-1/0];for(var f=0,h=t.length;f<h;f++)_t(a,a,t[f]),wt(s,s,t[f]);_t(a,a,r[0]),wt(s,s,r[1])}for(f=0,h=t.length;f<h;f++){var p=t[f];if(n)i=t[f?f-1:h-1],o=t[(f+1)%h];else{if(0===f||f===h-1){l.push(at(t[f]));continue}i=t[f-1],o=t[f+1]}ct(u,o,i),ht(u,u,e);var g=gt(p,i),m=gt(p,o),v=g+m;0!==v&&(g/=v,m/=v),ht(c,u,-g),ht(d,u,m);var y=lt([],p,c),x=lt([],p,d);r&&(wt(y,y,a),_t(y,y,s),wt(x,x,a),_t(x,x,s)),l.push(y),l.push(x)}return n&&l.push(l.shift()),l}(r,i,n,e.smoothConstraint);t.moveTo(r[0][0],r[0][1]);for(var a=r.length,s=0;s<(n?a:a-1);s++){var l=o[2*s],u=o[2*s+1],c=r[(s+1)%a];t.bezierCurveTo(l[0],l[1],u[0],u[1],c[0],c[1])}}else{"spline"===i&&(r=function(t,e){for(var n=t.length,r=[],i=0,o=1;o<n;o++)i+=gt(t[o-1],t[o]);var a=i/2;for(a=a<n?n:a,o=0;o<a;o++){var s,l,u,c=o/(a-1)*(e?n:n-1),d=Math.floor(c),f=c-d,h=t[d%n];u=e?(s=t[(d-1+n)%n],l=t[(d+1)%n],t[(d+2)%n]):(s=t[0===d?d:d-1],l=t[n-2<d?n-1:d+1],t[n-3<d?n-1:d+2]);var p=f*f,g=f*p;r.push([Na(s[0],h[0],l[0],u[0],f,p,g),Na(s[1],h[1],l[1],u[1],f,p,g)])}return r}(r,n)),t.moveTo(r[0][0],r[0][1]),s=1;for(var d=r.length;s<d;s++)t.lineTo(r[s][0],r[s][1])}n&&t.closePath()}}var za=ha.extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(t,e){Ba(t,e,!0)}}),Va=ha.extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(t,e){Ba(t,e,!1)}}),Fa=Math.round;function Ha(t,e,n){if(e){var r=e.x1,i=e.x2,o=e.y1,a=e.y2;t.x1=r,t.x2=i,t.y1=o,t.y2=a;var s=n&&n.lineWidth;s&&(Fa(2*r)===Fa(2*i)&&(t.x1=t.x2=ja(r,s,!0)),Fa(2*o)===Fa(2*a)&&(t.y1=t.y2=ja(o,s,!0)))}}function Wa(t,e,n){if(e){var r=e.x,i=e.y,o=e.width,a=e.height;t.x=r,t.y=i,t.width=o,t.height=a;var s=n&&n.lineWidth;s&&(t.x=ja(r,s,!0),t.y=ja(i,s,!0),t.width=Math.max(ja(r+o,s,!1)-t.x,0===o?0:1),t.height=Math.max(ja(i+a,s,!1)-t.y,0===a?0:1))}}function ja(t,e,n){if(!e)return t;var r=Fa(2*t);return(r+Fa(e))%2==0?r/2:(r+(n?1:-1))/2}var Ga={},Ua=ha.extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function(t,e){var n,r,i,o;this.subPixelOptimize?(Wa(Ga,e,this.style),n=Ga.x,r=Ga.y,i=Ga.width,o=Ga.height,Ga.r=e.r,e=Ga):(n=e.x,r=e.y,i=e.width,o=e.height),e.r?vr(t,e):t.rect(n,r,i,o),t.closePath()}}),qa={},Xa=ha.extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n,r,i,o;o=this.subPixelOptimize?(Ha(qa,e,this.style),n=qa.x1,r=qa.y1,i=qa.x2,qa.y2):(n=e.x1,r=e.y1,i=e.x2,e.y2);var a=e.percent;0!==a&&(t.moveTo(n,r),a<1&&(i=n*(1-a)+i*a,o=r*(1-a)+o*a),t.lineTo(i,o))},pointAt:function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]}}),Ya=[];function $a(t,e,n){return null===t.cpx2||null===t.cpy2?[(n?po:ho)(t.x1,t.cpx1,t.cpx2,t.x2,e),(n?po:ho)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(n?yo:vo)(t.x1,t.cpx1,t.x2,e),(n?yo:vo)(t.y1,t.cpy1,t.y2,e)]}function Za(t){this.colorStops=t||[]}var Ka=ha.extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.x1,r=e.y1,i=e.x2,o=e.y2,a=e.cpx1,s=e.cpy1,l=e.cpx2,u=e.cpy2,c=e.percent;0!==c&&(t.moveTo(n,r),null==l||null==u?(c<1&&(bo(n,a,i,c,Ya),a=Ya[1],i=Ya[2],bo(r,s,o,c,Ya),s=Ya[1],o=Ya[2]),t.quadraticCurveTo(a,s,i,o)):(c<1&&(mo(n,a,l,i,c,Ya),a=Ya[1],l=Ya[2],i=Ya[3],mo(r,s,u,o,c,Ya),s=Ya[1],u=Ya[2],o=Ya[3]),t.bezierCurveTo(a,s,l,u,i,o)))},pointAt:function(t){return $a(this.shape,t,!1)},tangentAt:function(t){var e=$a(this.shape,t,!0);return pt(e,e)}}),Ja=ha.extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.cx,r=e.cy,i=Math.max(e.r,0),o=e.startAngle,a=e.endAngle,s=e.clockwise,l=Math.cos(o),u=Math.sin(o);t.moveTo(l*i+n,u*i+r),t.arc(n,r,i,o,a,!s)}}),Qa=ha.extend({type:"compound",shape:{paths:null},_updatePathDirty:function(){for(var t=this.__dirtyPath,e=this.shape.paths,n=0;n<e.length;n++)t=t||e[n].__dirtyPath;this.__dirtyPath=t,this.__dirty=this.__dirty||t},beforeBrush:function(){this._updatePathDirty();for(var t=this.shape.paths||[],e=this.getGlobalScale(),n=0;n<t.length;n++)t[n].path||t[n].createPathProxy(),t[n].path.setScale(e[0],e[1],t[n].segmentIgnoreThreshold)},buildPath:function(t,e){for(var n=e.paths||[],r=0;r<n.length;r++)n[r].buildPath(t,n[r].shape,!0)},afterBrush:function(){for(var t=this.shape.paths||[],e=0;e<t.length;e++)t[e].__dirtyPath=!1},getBoundingRect:function(){return this._updatePathDirty(),ha.prototype.getBoundingRect.call(this)}});function ts(t,e,n,r,i,o){this.x=null==t?0:t,this.y=null==e?0:e,this.x2=null==n?1:n,this.y2=null==r?0:r,this.type="linear",this.global=o||!1,Za.call(this,i)}function es(t,e,n,r,i){this.x=null==t?.5:t,this.y=null==e?.5:e,this.r=null==n?.5:n,this.type="radial",this.global=i||!1,Za.call(this,r)}function ns(t){Hr.call(this,t),this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.notClear=!0}Za.prototype={constructor:Za,addColorStop:function(t,e){this.colorStops.push({offset:t,color:e})}},ts.prototype={constructor:ts},C(ts,Za),es.prototype={constructor:es},C(es,Za),ns.prototype.incremental=!0,ns.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.dirty(),this.notClear=!1},ns.prototype.addDisplayable=function(t,e){e?this._temporaryDisplayables.push(t):this._displayables.push(t),this.dirty()},ns.prototype.addDisplayables=function(t,e){e=e||!1;for(var n=0;n<t.length;n++)this.addDisplayable(t[n],e)},ns.prototype.eachPendingDisplayable=function(t){for(var e=this._cursor;e<this._displayables.length;e++)t&&t(this._displayables[e]);for(e=0;e<this._temporaryDisplayables.length;e++)t&&t(this._temporaryDisplayables[e])},ns.prototype.update=function(){this.updateTransform();for(var t=this._cursor;t<this._displayables.length;t++)(e=this._displayables[t]).parent=this,e.update(),e.parent=null;for(t=0;t<this._temporaryDisplayables.length;t++){var e;(e=this._temporaryDisplayables[t]).parent=this,e.update(),e.parent=null}},ns.prototype.brush=function(t,e){for(var n=this._cursor;n<this._displayables.length;n++)(r=this._displayables[n]).beforeBrush&&r.beforeBrush(t),r.brush(t,n===this._cursor?null:this._displayables[n-1]),r.afterBrush&&r.afterBrush(t);for(this._cursor=n,n=0;n<this._temporaryDisplayables.length;n++){var r;(r=this._temporaryDisplayables[n]).beforeBrush&&r.beforeBrush(t),r.brush(t,0===n?null:this._temporaryDisplayables[n-1]),r.afterBrush&&r.afterBrush(t)}this._temporaryDisplayables=[],this.notClear=!0};var rs=[];ns.prototype.getBoundingRect=function(){if(!this._rect){for(var t=new Sn(1/0,1/0,-1/0,-1/0),e=0;e<this._displayables.length;e++){var n=this._displayables[e],r=n.getBoundingRect().clone();n.needLocalTransform()&&r.applyTransform(n.getLocalTransform(rs)),t.union(r)}this._rect=t}return this._rect},ns.prototype.contain=function(t,e){var n=this.transformCoordToLocal(t,e);if(this.getBoundingRect().contain(n[0],n[1]))for(var r=0;r<this._displayables.length;r++)if(this._displayables[r].contain(t,e))return!0;return!1},C(ns,Hr);var is=Math.max,os=Math.min,as={},ss={color:"textFill",textBorderColor:"textStroke",textBorderWidth:"textStrokeWidth"},ls="emphasis",us="normal",cs=1,ds={},fs={};function hs(t){return ha.extend(t)}function ps(t,e){fs[t]=e}function gs(t){if(fs.hasOwnProperty(t))return fs[t]}function ms(t,e,n,r){var i=Ia(t,e);return n&&("center"===r&&(n=ys(n,i.getBoundingRect())),bs(i,n)),i}function vs(t,e,n){var r=new Wr({style:{image:t,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(t){"center"===n&&r.setStyle(ys(e,{width:t.width,height:t.height}))}});return r}function ys(t,e){var n,r=e.width/e.height,i=t.height*r;return n=i<=t.width?t.height:(i=t.width)/r,{x:t.x+t.width/2-i/2,y:t.y+t.height/2-n/2,width:i,height:n}}var xs=function(t,e){for(var n=[],r=t.length,i=0;i<r;i++){var o=t[i];o.path||o.createPathProxy(),o.__dirtyPath&&o.buildPath(o.path,o.shape,!0),n.push(o.path)}var a=new ha(e);return a.createPathProxy(),a.buildPath=function(t){t.appendPath(n);var e=t.getContext();e&&t.rebuildPath(e)},a};function bs(t,e){if(t.applyTransform){var n=t.getBoundingRect().calculateTransform(e);t.applyTransform(n)}}var _s=ja;function ws(t){return null!=t&&"none"!==t}var Ss=Q(),Cs=0;function Ms(t){var e=t.__hoverStl;if(e&&!t.__highlighted){var n=t.__zr,r=t.useHoverLayer&&n&&"canvas"===n.painter.type;if(t.__highlighted=r?"layer":"plain",!(t.isGroup||!n&&t.useHoverLayer)){var i=t,o=t.style;r&&(o=(i=n.addHover(t)).style),qs(o),r||function(t){if(t.__hoverStlDirty){t.__hoverStlDirty=!1;var e=t.__hoverStl;if(e){var n=t.__cachedNormalStl={};t.__cachedNormalZ2=t.z2;var r=t.style;for(var i in e)null!=e[i]&&(n[i]=r[i]);n.fill=r.fill,n.stroke=r.stroke}else t.__cachedNormalStl=t.__cachedNormalZ2=null}}(i),o.extendFrom(e),Ts(o,e,"fill"),Ts(o,e,"stroke"),Us(o),r||(t.dirty(!1),t.z2+=1)}}}function Ts(t,e,n){!ws(e[n])&&ws(t[n])&&(t[n]=function(t){if("string"!=typeof t)return t;var e=Ss.get(t);return e||(e=He(t,-.1),Cs<1e4&&(Ss.set(t,e),Cs++)),e}(t[n]))}function ks(t){var e=t.__highlighted;if(e&&(t.__highlighted=!1,!t.isGroup))if("layer"===e)t.__zr&&t.__zr.removeHover(t);else{var n=t.style,r=t.__cachedNormalStl;r&&(qs(n),t.setStyle(r),Us(n));var i=t.__cachedNormalZ2;null!=i&&t.z2-i==1&&(t.z2=i)}}function As(t,e,n){var r,i=us,o=us;t.__highlighted&&(i=ls,r=!0),e(t,n),t.__highlighted&&(o=ls,r=!0),t.isGroup&&t.traverse(function(t){t.isGroup||e(t,n)}),r&&t.__highDownOnUpdate&&t.__highDownOnUpdate(i,o)}function Is(t,e){e=t.__hoverStl=!1!==e&&(t.hoverStyle||e||{}),t.__hoverStlDirty=!0,t.__highlighted&&(t.__cachedNormalStl=null,ks(t),Ms(t))}function Ds(t){Rs(this,t)||this.__highByOuter||As(this,Ms)}function Os(t){Rs(this,t)||this.__highByOuter||As(this,ks)}function Ps(t){this.__highByOuter|=1<<(t||0),As(this,Ms)}function Es(t){(this.__highByOuter&=~(1<<(t||0)))||As(this,ks)}function Rs(t,e){return t.__highDownSilentOnTouch&&e.zrByTouch}function Ls(t,e){Ns(t,!0),As(t,Is,e)}function Ns(t,e){var n=!1===e;if(t.__highDownSilentOnTouch=t.highDownSilentOnTouch,t.__highDownOnUpdate=t.highDownOnUpdate,!n||t.__highDownDispatcher){var r=n?"off":"on";t[r]("mouseover",Ds)[r]("mouseout",Os),t[r]("emphasis",Ps)[r]("normal",Es),t.__highByOuter=t.__highByOuter||0,t.__highDownDispatcher=!n}}function Bs(t){return!(!t||!t.__highDownDispatcher)}function zs(t){var e=ds[t];return null==e&&cs<=32&&(e=ds[t]=cs++),e}function Vs(t,e,n,r,i,o,a){var s,l=(i=i||as).labelFetcher,u=i.labelDataIndex,c=i.labelDimIndex,d=i.labelProp,f=n.getShallow("show"),h=r.getShallow("show");(f||h)&&(l&&(s=l.getFormattedLabel(u,"normal",null,c,d)),null==s&&(s=L(i.defaultText)?i.defaultText(u,i):i.defaultText));var p=f?s:null,g=h?j(l?l.getFormattedLabel(u,"emphasis",null,c,d):null,s):null;null==p&&null==g||(Hs(t,n,o,i),Hs(e,r,a,i,!0)),t.text=p,e.text=g}function Fs(t,e,n){var r=t.style;e&&(qs(r),t.setStyle(e),Us(r)),r=t.__hoverStl,n&&r&&(qs(r),x(r,n),Us(r))}function Hs(t,e,n,r,i){return Ws(t,e,r,i),n&&x(t,n),t}function Ws(t,e,n,r){if((n=n||as).isRectText){var i;n.getTextPosition?i=n.getTextPosition(e,r):"outside"===(i=e.getShallow("position")||(r?null:"inside"))&&(i="top"),t.textPosition=i,t.textOffset=e.getShallow("offset");var o=e.getShallow("rotate");null!=o&&(o*=Math.PI/180),t.textRotation=o,t.textDistance=j(e.getShallow("distance"),r?null:5)}var a,s=e.ecModel,l=s&&s.option.textStyle,u=function(t){for(var e;t&&t!==t.ecModel;){var n=(t.option||as).rich;if(n)for(var r in e=e||{},n)n.hasOwnProperty(r)&&(e[r]=1);t=t.parentModel}return e}(e);if(u)for(var c in a={},u)if(u.hasOwnProperty(c)){var d=e.getModel(["rich",c]);js(a[c]={},d,l,n,r)}return t.rich=a,js(t,e,l,n,r,!0),n.forceRich&&!n.textStyle&&(n.textStyle={}),t}function js(t,e,n,r,i,o){n=!i&&n||as,t.textFill=Gs(e.getShallow("color"),r)||n.color,t.textStroke=Gs(e.getShallow("textBorderColor"),r)||n.textBorderColor,t.textStrokeWidth=j(e.getShallow("textBorderWidth"),n.textBorderWidth),i||(o&&(t.insideRollbackOpt=r,Us(t)),null==t.textFill&&(t.textFill=r.autoColor)),t.fontStyle=e.getShallow("fontStyle")||n.fontStyle,t.fontWeight=e.getShallow("fontWeight")||n.fontWeight,t.fontSize=e.getShallow("fontSize")||n.fontSize,t.fontFamily=e.getShallow("fontFamily")||n.fontFamily,t.textAlign=e.getShallow("align"),t.textVerticalAlign=e.getShallow("verticalAlign")||e.getShallow("baseline"),t.textLineHeight=e.getShallow("lineHeight"),t.textWidth=e.getShallow("width"),t.textHeight=e.getShallow("height"),t.textTag=e.getShallow("tag"),o&&r.disableBox||(t.textBackgroundColor=Gs(e.getShallow("backgroundColor"),r),t.textPadding=e.getShallow("padding"),t.textBorderColor=Gs(e.getShallow("borderColor"),r),t.textBorderWidth=e.getShallow("borderWidth"),t.textBorderRadius=e.getShallow("borderRadius"),t.textBoxShadowColor=e.getShallow("shadowColor"),t.textBoxShadowBlur=e.getShallow("shadowBlur"),t.textBoxShadowOffsetX=e.getShallow("shadowOffsetX"),t.textBoxShadowOffsetY=e.getShallow("shadowOffsetY")),t.textShadowColor=e.getShallow("textShadowColor")||n.textShadowColor,t.textShadowBlur=e.getShallow("textShadowBlur")||n.textShadowBlur,t.textShadowOffsetX=e.getShallow("textShadowOffsetX")||n.textShadowOffsetX,t.textShadowOffsetY=e.getShallow("textShadowOffsetY")||n.textShadowOffsetY}function Gs(t,e){return"auto"!==t?t:e&&e.autoColor?e.autoColor:null}function Us(t){var e,n=t.textPosition,r=t.insideRollbackOpt;if(r&&null==t.textFill){var i=r.autoColor,o=r.useInsideStyle,a=!1!==o&&(!0===o||r.isRectText&&n&&"string"==typeof n&&0<=n.indexOf("inside")),s=!a&&null!=i;(a||s)&&(e={textFill:t.textFill,textStroke:t.textStroke,textStrokeWidth:t.textStrokeWidth}),a&&(t.textFill="#fff",null==t.textStroke&&(t.textStroke=i,null==t.textStrokeWidth&&(t.textStrokeWidth=2))),s&&(t.textFill=i)}t.insideRollback=e}function qs(t){var e=t.insideRollback;e&&(t.textFill=e.textFill,t.textStroke=e.textStroke,t.textStrokeWidth=e.textStrokeWidth,t.insideRollback=null)}function Xs(t,e){var n=e&&e.getModel("textStyle");return Y([t.fontStyle||n&&n.getShallow("fontStyle")||"",t.fontWeight||n&&n.getShallow("fontWeight")||"",(t.fontSize||n&&n.getShallow("fontSize")||12)+"px",t.fontFamily||n&&n.getShallow("fontFamily")||"sans-serif"].join(" "))}function Ys(t,e,n,r,i,o){if("function"==typeof i&&(o=i,i=null),r&&r.isAnimationEnabled()){var a=t?"Update":"",s=r.getShallow("animationDuration"+a),l=r.getShallow("animationEasing"+a),u=r.getShallow("animationDelay"+a);"function"==typeof u&&(u=u(i,r.getAnimationDelayParams?r.getAnimationDelayParams(e,i):null)),"function"==typeof s&&(s=s(i)),0<s?e.animateTo(n,s,u||0,l,o,!!o):(e.stopAnimation(),e.attr(n),o&&o())}else e.stopAnimation(),e.attr(n),o&&o()}function $s(t,e,n,r,i){Ys(!0,t,e,n,r,i)}function Zs(t,e,n,r,i){Ys(!1,t,e,n,r,i)}function Ks(t,e){for(var n=ie([]);t&&t!==e;)ae(n,t.getLocalTransform(),n),t=t.parent;return n}function Js(t,e,n){return e&&!T(e)&&(e=ge.getLocalTransform(e)),n&&(e=ce([],e)),bt([],t,e)}function Qs(t,e,n){var r=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),i=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),o=["left"===t?-r:"right"===t?r:0,"top"===t?-i:"bottom"===t?i:0];return o=Js(o,e,n),Math.abs(o[0])>Math.abs(o[1])?0<o[0]?"right":"left":0<o[1]?"bottom":"top"}function tl(t,e,n,r){if(t&&e){var i,o=(i={},t.traverse(function(t){!t.isGroup&&t.anid&&(i[t.anid]=t)}),i);e.traverse(function(t){if(!t.isGroup&&t.anid){var e=o[t.anid];if(e){var r=a(t);t.attr(a(e)),$s(t,r,n,t.dataIndex)}}})}function a(t){var e={position:at(t.position),rotation:t.rotation};return t.shape&&(e.shape=x({},t.shape)),e}}function el(t,e){return A(t,function(t){var n=t[0];n=is(n,e.x),n=os(n,e.x+e.width);var r=t[1];return r=is(r,e.y),[n,r=os(r,e.y+e.height)]})}function nl(t,e,n){var r=(e=x({rectHover:!0},e)).style={strokeNoScale:!0};if(n=n||{x:-1,y:-1,width:2,height:2},t)return 0===t.indexOf("image://")?(r.image=t.slice(8),b(r,n),new Wr(e)):ms(t.replace("path://",""),e,n,"center")}function rl(t,e,n,r,i){for(var o=0,a=i[i.length-1];o<i.length;o++){var s=i[o];if(il(t,e,n,r,s[0],s[1],a[0],a[1]))return!0;a=s}}function il(t,e,n,r,i,o,a,s){var l=n-t,u=r-e,c=a-i,d=s-o,f=ol(c,d,l,u);if(function(t){return t<=1e-6&&-1e-6<=t}(f))return!1;var h=t-i,p=e-o,g=ol(h,p,l,u)/f;if(g<0||1<g)return!1;var m=ol(h,p,c,d)/f;return!(m<0||1<m)}function ol(t,e,n,r){return t*r-n*e}ps("circle",Pa),ps("sector",Ra),ps("ring",La),ps("polygon",za),ps("polyline",Va),ps("rect",Ua),ps("line",Xa),ps("bezierCurve",Ka),ps("arc",Ja);var al=(Object.freeze||Object)({Z2_EMPHASIS_LIFT:1,CACHED_LABEL_STYLE_PROPERTIES:ss,extendShape:hs,extendPath:function(t,e){return function(t,e){return ha.extend(Aa(t,e))}(t,e)},registerShape:ps,getShapeClass:gs,makePath:ms,makeImage:vs,mergePath:xs,resizePath:bs,subPixelOptimizeLine:function(t){return Ha(t.shape,t.shape,t.style),t},subPixelOptimizeRect:function(t){return Wa(t.shape,t.shape,t.style),t},subPixelOptimize:_s,setElementHoverStyle:Is,setHoverStyle:Ls,setAsHighDownDispatcher:Ns,isHighDownDispatcher:Bs,getHighlightDigit:zs,setLabelStyle:Vs,modifyLabelStyle:Fs,setTextStyle:Hs,setText:function(t,e,n){var r,i={isRectText:!0};!1===n?r=!0:i.autoColor=n,Ws(t,e,i,r)},getFont:Xs,updateProps:$s,initProps:Zs,getTransform:Ks,applyTransform:Js,transformDirection:Qs,groupTransition:tl,clipPointsByRect:el,clipRectByRect:function(t,e){var n=is(t.x,e.x),r=os(t.x+t.width,e.x+e.width),i=is(t.y,e.y),o=os(t.y+t.height,e.y+e.height);if(n<=r&&i<=o)return{x:n,y:i,width:r-n,height:o-i}},createIcon:nl,linePolygonIntersect:rl,lineLineIntersect:il,Group:Cn,Image:Wr,Text:Da,Circle:Pa,Sector:Ra,Ring:La,Polygon:za,Polyline:Va,Rect:Ua,Line:Xa,BezierCurve:Ka,Arc:Ja,IncrementalDisplayable:ns,CompoundPath:Qa,LinearGradient:ts,RadialGradient:es,BoundingRect:Sn}),sl=["textStyle","color"],ll={getTextColor:function(t){var e=this.ecModel;return this.getShallow("color")||(!t&&e?e.get(sl):null)},getFont:function(){return Xs({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},getTextRect:function(t){return ir(t,this.getFont(),this.getShallow("align"),this.getShallow("verticalAlign")||this.getShallow("baseline"),this.getShallow("padding"),this.getShallow("lineHeight"),this.getShallow("rich"),this.getShallow("truncateText"))}},ul=Zi([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["textPosition"],["textAlign"]]),cl={getItemStyle:function(t,e){var n=ul(this,t,e),r=this.getBorderLineDash();return r&&(n.lineDash=r),n},getBorderLineDash:function(){var t=this.get("borderType");return"solid"===t||null==t?null:"dashed"===t?[5,5]:[1,1]}},dl=M,fl=Li();function hl(t,e,n){this.parentModel=e,this.ecModel=n,this.option=t}function pl(t,e,n){for(var r=0;r<e.length&&(!e[r]||null!=(t=t&&"object"==typeof t?t[e[r]]:null));r++);return null==t&&n&&(t=n.get(e)),t}function gl(t,e){var n=fl(t).getParent;return n?n.call(t,e):t.parentModel}hl.prototype={constructor:hl,init:null,mergeOption:function(t){v(this.option,t,!0)},get:function(t,e){return null==t?this.option:pl(this.option,this.parsePath(t),!e&&gl(this,t))},getShallow:function(t,e){var n=this.option,r=null==n?n:n[t],i=!e&&gl(this,t);return null==r&&i&&(r=i.getShallow(t)),r},getModel:function(t,e){var n;return new hl(null==t?this.option:pl(this.option,t=this.parsePath(t)),e=e||(n=gl(this,t))&&n.getModel(t),this.ecModel)},isEmpty:function(){return null==this.option},restoreData:function(){},clone:function(){return new this.constructor(m(this.option))},setReadOnly:function(t){},parsePath:function(t){return"string"==typeof t&&(t=t.split(".")),t},customizeGetParent:function(t){fl(this).getParent=t},isAnimationEnabled:function(){if(!i.node){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}}},Gi(hl),qi(hl),dl(hl,Ji),dl(hl,to),dl(hl,ll),dl(hl,cl);var ml=0;function vl(t){return[t||"",ml++,Math.random().toFixed(5)].join("_")}var yl=1e-4;function xl(t,e,n,r){var i=e[1]-e[0],o=n[1]-n[0];if(0==i)return 0==o?n[0]:(n[0]+n[1])/2;if(r)if(0<i){if(t<=e[0])return n[0];if(t>=e[1])return n[1]}else{if(t>=e[0])return n[0];if(t<=e[1])return n[1]}else{if(t===e[0])return n[0];if(t===e[1])return n[1]}return(t-e[0])/i*o+n[0]}function bl(t,e){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%"}return"string"==typeof t?function(t){return t.replace(/^\s+|\s+$/g,"")}(t).match(/%$/)?parseFloat(t)/100*e:parseFloat(t):null==t?NaN:+t}function _l(t,e,n){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),t=(+t).toFixed(e),n?t:+t}function wl(t){return t.sort(function(t,e){return t-e}),t}function Sl(t){if(t=+t,isNaN(t))return 0;for(var e=1,n=0;Math.round(t*e)/e!==t;)e*=10,n++;return n}function Cl(t){var e=t.toString(),n=e.indexOf("e");if(0<n){var r=+e.slice(n+1);return r<0?-r:0}var i=e.indexOf(".");return i<0?0:e.length-1-i}function Ml(t,e){var n=Math.log,r=Math.LN10,i=Math.floor(n(t[1]-t[0])/r),o=Math.round(n(Math.abs(e[1]-e[0]))/r),a=Math.min(Math.max(-i+o,0),20);return isFinite(a)?a:20}function Tl(t,e,n){if(!t[e])return 0;var r=I(t,function(t,e){return t+(isNaN(e)?0:e)},0);if(0===r)return 0;for(var i=Math.pow(10,n),o=A(t,function(t){return(isNaN(t)?0:t)/r*i*100}),a=100*i,s=A(o,function(t){return Math.floor(t)}),l=I(s,function(t,e){return t+e},0),u=A(o,function(t,e){return t-s[e]});l<a;){for(var c=Number.NEGATIVE_INFINITY,d=null,f=0,h=u.length;f<h;++f)u[f]>c&&(c=u[f],d=f);++s[d],u[d]=0,++l}return s[e]/i}var kl=9007199254740991;function Al(t){var e=2*Math.PI;return(t%e+e)%e}function Il(t){return-yl<t&&t<yl}var Dl=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d\d)(?::(\d\d)(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function Ol(t){if(t instanceof Date)return t;if("string"!=typeof t)return null==t?new Date(NaN):new Date(Math.round(t));var e=Dl.exec(t);if(!e)return new Date(NaN);if(e[8]){var n=+e[4]||0;return"Z"!==e[8].toUpperCase()&&(n-=e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,n,+(e[5]||0),+e[6]||0,+e[7]||0))}return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,+e[7]||0)}function Pl(t){return Math.pow(10,El(t))}function El(t){if(0===t)return 0;var e=Math.floor(Math.log(t)/Math.LN10);return 10<=t/Math.pow(10,e)&&e++,e}function Rl(t,e){var n=El(t),r=Math.pow(10,n),i=t/r;return t=(e?i<1.5?1:i<2.5?2:i<4?3:i<7?5:10:i<1?1:i<2?2:i<3?3:i<5?5:10)*r,-20<=n?+t.toFixed(n<0?-n:0):t}function Ll(t){t.sort(function(t,e){return function t(e,n,r){return e.interval[r]<n.interval[r]||e.interval[r]===n.interval[r]&&(e.close[r]-n.close[r]==(r?-1:1)||!r&&t(e,n,1))}(t,e,0)?-1:1});for(var e=-1/0,n=1,r=0;r<t.length;){for(var i=t[r].interval,o=t[r].close,a=0;a<2;a++)i[a]<=e&&(i[a]=e,o[a]=a?1:1-n),e=i[a],n=o[a];i[0]===i[1]&&o[0]*o[1]!=1?t.splice(r,1):r++}return t}function Nl(t){return 0<=t-parseFloat(t)}var Bl=(Object.freeze||Object)({linearMap:xl,parsePercent:bl,round:_l,asc:wl,getPrecision:Sl,getPrecisionSafe:Cl,getPixelPrecision:Ml,getPercentWithPrecision:Tl,MAX_SAFE_INTEGER:kl,remRadian:Al,isRadianAroundZero:Il,parseDate:Ol,quantity:Pl,quantityExponent:El,nice:Rl,quantile:function(t,e){var n=(t.length-1)*e+1,r=Math.floor(n),i=+t[r-1],o=n-r;return o?i+o*(t[r]-i):i},reformIntervals:Ll,isNumeric:Nl});function zl(t){return isNaN(t)?"-":(t=(t+"").split("."))[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(1<t.length?"."+t[1]:"")}function Vl(t,e){return t=(t||"").toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()}),e&&t&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t}var Fl=q,Hl=/([&<>"'])/g,Wl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function jl(t){return null==t?"":(t+"").replace(Hl,function(t,e){return Wl[e]})}function Gl(t,e){return"{"+t+(null==e?"":e)+"}"}var Ul=["a","b","c","d","e","f","g"];function ql(t,e,n){R(e)||(e=[e]);var r=e.length;if(!r)return"";for(var i=e[0].$vars||[],o=0;o<i.length;o++){var a=Ul[o];t=t.replace(Gl(a),Gl(a,0))}for(var s=0;s<r;s++)for(var l=0;l<i.length;l++){var u=e[s][i[l]];t=t.replace(Gl(Ul[l],s),n?jl(u):u)}return t}function Xl(t,e,n){return k(e,function(e,r){t=t.replace("{"+r+"}",n?jl(e):e)}),t}function Yl(t,e){var n=(t=N(t)?{color:t,extraCssText:e}:t||{}).color,r=(e=t.extraCssText,t.renderMode||"html"),i=t.markerId||"X";return n?"html"===r?"subItem"===t.type?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+jl(n)+";"+(e||"")+'"></span>':'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:'+jl(n)+";"+(e||"")+'"></span>':{renderMode:r,content:"{marker"+i+"|}  ",style:{color:n}}:""}function $l(t,e){return"0000".substr(0,e-(t+="").length)+t}function Zl(t,e,n){"week"!==t&&"month"!==t&&"quarter"!==t&&"half-year"!==t&&"year"!==t||(t="MM-dd\nyyyy");var r=Ol(e),i=n?"UTC":"",o=r["get"+i+"FullYear"](),a=r["get"+i+"Month"]()+1,s=r["get"+i+"Date"](),l=r["get"+i+"Hours"](),u=r["get"+i+"Minutes"](),c=r["get"+i+"Seconds"](),d=r["get"+i+"Milliseconds"]();return t.replace("MM",$l(a,2)).replace("M",a).replace("yyyy",o).replace("yy",o%100).replace("dd",$l(s,2)).replace("d",s).replace("hh",$l(l,2)).replace("h",l).replace("mm",$l(u,2)).replace("m",u).replace("ss",$l(c,2)).replace("s",c).replace("SSS",$l(d,3))}function Kl(t){return t?t.charAt(0).toUpperCase()+t.substr(1):t}var Jl=lr;function Ql(t,e){if("_blank"===e||"blank"===e){var n=window.open();n.opener=null,n.location=t}else window.open(t,e)}var tu=(Object.freeze||Object)({addCommas:zl,toCamelCase:Vl,normalizeCssArray:Fl,encodeHTML:jl,formatTpl:ql,formatTplSimple:Xl,getTooltipMarker:Yl,formatTime:Zl,capitalFirst:Kl,truncateText:Jl,getTextBoundingRect:function(t){return ir(t.text,t.font,t.textAlign,t.textVerticalAlign,t.textPadding,t.textLineHeight,t.rich,t.truncate)},getTextRect:function(t,e,n,r,i,o,a,s){return ir(t,e,n,r,i,s,o,a)},windowOpen:Ql}),eu=k,nu=["left","right","top","bottom","width","height"],ru=[["width","left","right"],["height","top","bottom"]];function iu(t,e,n,r,i){var o=0,a=0;null==r&&(r=1/0),null==i&&(i=1/0);var s=0;e.eachChild(function(l,u){var c,d,f=l.position,h=l.getBoundingRect(),p=e.childAt(u+1),g=p&&p.getBoundingRect();if("horizontal"===t){var m=h.width+(g?-g.x+h.x:0);s=r<(c=o+m)||l.newline?(o=0,c=m,a+=s+n,h.height):Math.max(s,h.height)}else{var v=h.height+(g?-g.y+h.y:0);s=i<(d=a+v)||l.newline?(o+=s+n,a=0,d=v,h.width):Math.max(s,h.width)}l.newline||(f[0]=o,f[1]=a,"horizontal"===t?o=c+n:a=d+n)})}var ou=iu;function au(t,e,n){n=Fl(n||0);var r=e.width,i=e.height,o=bl(t.left,r),a=bl(t.top,i),s=bl(t.right,r),l=bl(t.bottom,i),u=bl(t.width,r),c=bl(t.height,i),d=n[2]+n[0],f=n[1]+n[3],h=t.aspect;switch(isNaN(u)&&(u=r-s-f-o),isNaN(c)&&(c=i-l-d-a),null!=h&&(isNaN(u)&&isNaN(c)&&(r/i<h?u=.8*r:c=.8*i),isNaN(u)&&(u=h*c),isNaN(c)&&(c=u/h)),isNaN(o)&&(o=r-s-u-f),isNaN(a)&&(a=i-l-c-d),t.left||t.right){case"center":o=r/2-u/2-n[3];break;case"right":o=r-u-f}switch(t.top||t.bottom){case"middle":case"center":a=i/2-c/2-n[0];break;case"bottom":a=i-c-d}o=o||0,a=a||0,isNaN(u)&&(u=r-f-o-(s||0)),isNaN(c)&&(c=i-d-a-(l||0));var p=new Sn(o+n[3],a+n[0],u,c);return p.margin=n,p}function su(t,e,n,r,i){var o=!i||!i.hv||i.hv[0],a=!i||!i.hv||i.hv[1],s=i&&i.boundingMode||"all";if(o||a){var l;if("raw"===s)l="group"===t.type?new Sn(0,0,+e.width||0,+e.height||0):t.getBoundingRect();else if(l=t.getBoundingRect(),t.needLocalTransform()){var u=t.getLocalTransform();(l=l.clone()).applyTransform(u)}e=au(b({width:l.width,height:l.height},e),n,r);var c=t.position,d=o?e.x-l.x:0,f=a?e.y-l.y:0;t.attr("position","raw"===s?[d,f]:[c[0]+d,c[1]+f])}}function lu(t,e,n){B(n)||(n={});var r=n.ignoreSize;R(r)||(r=[r,r]);var i=a(ru[0],0),o=a(ru[1],1);function a(n,i){var o={},a=0,u={},c=0;if(eu(n,function(e){u[e]=t[e]}),eu(n,function(t){s(e,t)&&(o[t]=u[t]=e[t]),l(o,t)&&a++,l(u,t)&&c++}),r[i])return l(e,n[1])?u[n[2]]=null:l(e,n[2])&&(u[n[1]]=null),u;if(2!==c&&a){if(2<=a)return o;for(var d=0;d<n.length;d++){var f=n[d];if(!s(o,f)&&s(t,f)){o[f]=t[f];break}}return o}return u}function s(t,e){return t.hasOwnProperty(e)}function l(t,e){return null!=t[e]&&"auto"!==t[e]}function u(t,e,n){eu(t,function(t){e[t]=n[t]})}u(ru[0],t,i),u(ru[1],t,o)}function uu(t){return cu({},t)}function cu(t,e){return e&&t&&eu(nu,function(n){e.hasOwnProperty(n)&&(t[n]=e[n])}),t}E(iu,"vertical"),E(iu,"horizontal");var du,fu,hu,pu=Li(),gu=hl.extend({type:"component",id:"",name:"",mainType:"",subType:"",componentIndex:0,defaultOption:null,ecModel:null,dependentModels:[],uid:null,layoutMode:null,$constructor:function(t,e,n,r){hl.call(this,t,e,n,r),this.uid=vl("ec_cpt_model")},init:function(t,e,n,r){this.mergeDefaultAndTheme(t,n)},mergeDefaultAndTheme:function(t,e){var n=this.layoutMode,r=n?uu(t):{};v(t,e.getTheme().get(this.mainType)),v(t,this.getDefaultOption()),n&&lu(t,r,n)},mergeOption:function(t,e){v(this.option,t,!0);var n=this.layoutMode;n&&lu(this.option,t,n)},optionUpdated:function(t,e){},getDefaultOption:function(){var t=pu(this);if(!t.defaultOption){for(var e=[],n=this.constructor;n;){var r=n.prototype.defaultOption;r&&e.push(r),n=n.superClass}for(var i={},o=e.length-1;0<=o;o--)i=v(i,e[o],!0);t.defaultOption=i}return t.defaultOption},getReferringComponents:function(t){return this.ecModel.queryComponents({mainType:t,index:this.get(t+"Index",!0),id:this.get(t+"Id",!0)})}});function mu(t,e){return t[e]||(t[e]={predecessor:[],successor:[]}),t[e]}$i(gu,{registerWhenExtend:!0}),fu={},(du=gu).registerSubTypeDefaulter=function(t,e){t=ji(t),fu[t.main]=e},du.determineSubType=function(t,e){var n=e.type;if(!n){var r=ji(t).main;du.hasSubTypes(t)&&fu[r]&&(n=fu[r](e))}return n},hu=function(t){var e=[];return k(gu.getClassesByMainType(t),function(t){e=e.concat(t.prototype.dependencies||[])}),e=A(e,function(t){return ji(t).main}),"dataset"!==t&&S(e,"dataset")<=0&&e.unshift("dataset"),e},gu.topologicalTravel=function(t,e,n,r){if(t.length){var i=function(t){var e={},n=[];return k(t,function(r){var i=mu(e,r),o=function(t,e){var n=[];return k(t,function(t){0<=S(e,t)&&n.push(t)}),n}(i.originalDeps=hu(r),t);i.entryCount=o.length,0===i.entryCount&&n.push(r),k(o,function(t){S(i.predecessor,t)<0&&i.predecessor.push(t);var n=mu(e,t);S(n.successor,t)<0&&n.successor.push(r)})}),{graph:e,noEntryList:n}}(e),o=i.graph,a=i.noEntryList,s={};for(k(t,function(t){s[t]=!0});a.length;){var l=a.pop(),u=o[l],c=!!s[l];c&&(n.call(r,l,u.originalDeps.slice()),delete s[l]),k(u.successor,c?f:d)}k(s,function(){throw new Error("Circle dependency may exists")})}function d(t){o[t].entryCount--,0===o[t].entryCount&&a.push(t)}function f(t){s[t]=!0,d(t)}},M(gu,{getBoxLayoutParams:function(){return{left:this.get("left"),top:this.get("top"),right:this.get("right"),bottom:this.get("bottom"),width:this.get("width"),height:this.get("height")}}});var vu="";"undefined"!=typeof navigator&&(vu=navigator.platform||"");var yu={color:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],gradientColor:["#f6efa6","#d88273","#bf444c"],textStyle:{fontFamily:vu.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,animation:"auto",animationDuration:1e3,animationDurationUpdate:300,animationEasing:"exponentialOut",animationEasingUpdate:"cubicOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1},xu=Li(),bu={clearColorPalette:function(){xu(this).colorIdx=0,xu(this).colorNameMap={}},getColorFromPalette:function(t,e,n){var r=xu(e=e||this),i=r.colorIdx||0,o=r.colorNameMap=r.colorNameMap||{};if(o.hasOwnProperty(t))return o[t];var a=Ti(this.get("color",!0)),s=this.get("colorLayer",!0),l=null!=n&&s?function(t,e){for(var n=t.length,r=0;r<n;r++)if(t[r].length>e)return t[r];return t[n-1]}(s,n):a;if((l=l||a)&&l.length){var u=l[i];return t&&(o[t]=u),r.colorIdx=(i+1)%l.length,u}}},_u="original",wu="arrayRows",Su="objectRows",Cu="keyedColumns",Mu="unknown",Tu="typedArray",ku="column",Au="row";function Iu(t){this.fromDataset=t.fromDataset,this.data=t.data||(t.sourceFormat===Cu?{}:[]),this.sourceFormat=t.sourceFormat||Mu,this.seriesLayoutBy=t.seriesLayoutBy||ku,this.dimensionsDefine=t.dimensionsDefine,this.encodeDefine=t.encodeDefine&&Q(t.encodeDefine),this.startIndex=t.startIndex||0,this.dimensionsDetectCount=t.dimensionsDetectCount}Iu.seriesDataToSource=function(t){return new Iu({data:t,sourceFormat:V(t)?Tu:_u,fromDataset:!1})},qi(Iu);var Du=Li();function Ou(t){var e=t.option,n=e.data,r=V(n)?Tu:_u,i=!1,o=e.seriesLayoutBy,a=e.sourceHeader,s=e.dimensions,l=Nu(t);if(l){var u=l.option;n=u.source,r=Du(l).sourceFormat,i=!0,o=o||u.seriesLayoutBy,null==a&&(a=u.sourceHeader),s=s||u.dimensions}var c=function(t,e,n,r,i){if(!t)return{dimensionsDefine:Pu(i)};var o,a;if(e===wu)"auto"===r||null==r?Eu(function(t){null!=t&&"-"!==t&&(N(t)?null==a&&(a=1):a=0)},n,t,10):a=r?1:0,i||1!==a||(i=[],Eu(function(t,e){i[e]=null!=t?t:""},n,t)),o=i?i.length:n===Au?t.length:t[0]?t[0].length:null;else if(e===Su)i=i||function(t){for(var e,n=0;n<t.length&&!(e=t[n++]););if(e){var r=[];return k(e,function(t,e){r.push(e)}),r}}(t);else if(e===Cu)i||(i=[],k(t,function(t,e){i.push(e)}));else if(e===_u){var s=Ii(t[0]);o=R(s)&&s.length||1}return{startIndex:a,dimensionsDefine:Pu(i),dimensionsDetectCount:o}}(n,r,o,a,s);Du(t).source=new Iu({data:n,fromDataset:i,seriesLayoutBy:o,sourceFormat:r,dimensionsDefine:c.dimensionsDefine,startIndex:c.startIndex,dimensionsDetectCount:c.dimensionsDetectCount,encodeDefine:e.encode})}function Pu(t){if(t){var e=Q();return A(t,function(t,n){if(null==(t=x({},B(t)?t:{name:t})).name)return t;t.name+="",null==t.displayName&&(t.displayName=t.name);var r=e.get(t.name);return r?t.name+="-"+r.count++:e.set(t.name,{count:1}),t})}}function Eu(t,e,n,r){if(null==r&&(r=1/0),e===Au)for(var i=0;i<n.length&&i<r;i++)t(n[i]?n[i][0]:null,i);else{var o=n[0]||[];for(i=0;i<o.length&&i<r;i++)t(o[i],i)}}function Ru(t,e,n){var r={},i=Nu(e);if(!i||!t)return r;var o,a,s=[],l=[],u=Du(e.ecModel).datasetMap,c=i.uid+"_"+n.seriesLayoutBy;k(t=t.slice(),function(e,n){B(e)||(t[n]={name:e}),"ordinal"===e.type&&null==o&&(a=h(t[o=n])),r[e.name]=[]});var d=u.get(c)||u.set(c,{categoryWayDim:a,valueWayDim:0});function f(t,e,n){for(var r=0;r<n;r++)t.push(e+r)}function h(t){var e=t.dimsDef;return e?e.length:1}return k(t,function(t,e){var n=t.name,i=h(t);if(null==o){var a=d.valueWayDim;f(r[n],a,i),f(l,a,i),d.valueWayDim+=i}else o===e?(f(r[n],0,i),f(s,0,i)):(f(r[n],a=d.categoryWayDim,i),f(l,a,i),d.categoryWayDim+=i)}),s.length&&(r.itemName=s),l.length&&(r.seriesName=l),r}function Lu(t,e,n){var r={};if(!Nu(t))return r;var i,o=e.sourceFormat,a=e.dimensionsDefine;o!==Su&&o!==Cu||k(a,function(t,e){"name"===(B(t)?t.name:t)&&(i=e)});var s=function(){for(var t={},r={},s=[],l=0,u=Math.min(5,n);l<u;l++){var c=Bu(e.data,o,e.seriesLayoutBy,a,e.startIndex,l);s.push(c);var d=3===c;if(d&&null==t.v&&l!==i&&(t.v=l),null!=t.n&&t.n!==t.v&&(d||3!==s[t.n])||(t.n=l),f(t)&&3!==s[t.n])return t;d||(2===c&&null==r.v&&l!==i&&(r.v=l),null!=r.n&&r.n!==r.v||(r.n=l))}function f(t){return null!=t.v&&null!=t.n}return f(t)?t:f(r)?r:null}();if(s){r.value=s.v;var l=null!=i?i:s.n;r.itemName=[l],r.seriesName=[l]}return r}function Nu(t){var e=t.option;if(!e.data)return t.ecModel.getComponent("dataset",e.datasetIndex||0)}function Bu(t,e,n,r,i,o){var a,s,l;if(V(t))return 3;if(r){var u=r[o];B(u)?(s=u.name,l=u.type):N(u)&&(s=u)}if(null!=l)return"ordinal"===l?1:3;if(e===wu)if(n===Au){for(var c=t[o],d=0;d<(c||[]).length&&d<5;d++)if(null!=(a=g(c[i+d])))return a}else for(d=0;d<t.length&&d<5;d++){var f=t[i+d];if(f&&null!=(a=g(f[o])))return a}else if(e===Su){if(!s)return 3;for(d=0;d<t.length&&d<5;d++)if((h=t[d])&&null!=(a=g(h[s])))return a}else if(e===Cu){if(!s)return 3;if(!(c=t[s])||V(c))return 3;for(d=0;d<c.length&&d<5;d++)if(null!=(a=g(c[d])))return a}else if(e===_u)for(d=0;d<t.length&&d<5;d++){var h,p=Ii(h=t[d]);if(!R(p))return 3;if(null!=(a=g(p[o])))return a}function g(t){var e=N(t);return null!=t&&isFinite(t)&&""!==t?e?2:3:e&&"-"!==t?1:void 0}return 3}var zu="\0_ec_inner",Vu=hl.extend({init:function(t,e,n,r){n=n||{},this.option=null,this._theme=new hl(n),this._optionManager=r},setOption:function(t,e){X(!(zu in t),"please use chart.getOption()"),this._optionManager.setOption(t,e),this.resetOption(null)},resetOption:function(t){var e=!1,n=this._optionManager;if(!t||"recreate"===t){var r=n.mountOption("recreate"===t);this.option&&"recreate"!==t?(this.restoreData(),this.mergeOption(r)):(function(t){t=t,this.option={},this.option[zu]=1,this._componentsMap=Q({series:[]}),function(t,e){var n=t.color&&!t.colorLayer;k(e,function(e,r){"colorLayer"===r&&n||gu.hasClass(r)||("object"==typeof e?t[r]=t[r]?v(t[r],e,!1):m(e):null==t[r]&&(t[r]=e))})}(t,this._theme.option),v(t,yu,!1),this.mergeOption(t)}).call(this,r),e=!0}if("timeline"!==t&&"media"!==t||this.restoreData(),!t||"recreate"===t||"timeline"===t){var i=n.getTimelineOption(this);i&&(this.mergeOption(i),e=!0)}if(!t||"recreate"===t||"media"===t){var o=n.getMediaOption(this,this._api);o.length&&k(o,function(t){this.mergeOption(t,e=!0)},this)}return e},mergeOption:function(t){var e=this.option,n=this._componentsMap,r=[];!function(t){Du(t).datasetMap=Q()}(this),k(t,function(t,n){null!=t&&(gu.hasClass(n)?n&&r.push(n):e[n]=null==e[n]?m(t):v(e[n],t,!0))}),gu.topologicalTravel(r,gu.getAllClassMainTypes(),function(r,i){var o=Ti(t[r]),a=Di(n.get(r),o);Oi(a),k(a,function(t,e){var n=t.option;B(n)&&(t.keyInfo.mainType=r,t.keyInfo.subType=function(t,e,n){return e.type?e.type:n?n.subType:gu.determineSubType(t,e)}(r,n,t.exist))});var s=function(t,e){R(e)||(e=e?[e]:[]);var n={};return k(e,function(e){n[e]=(t.get(e)||[]).slice()}),n}(n,i);e[r]=[],n.set(r,[]),k(a,function(t,i){var o=t.exist,a=t.option;if(X(B(a)||o,"Empty component definition"),a){var l=gu.getClass(r,t.keyInfo.subType,!0);if(o&&o.constructor===l)o.name=t.keyInfo.name,o.mergeOption(a,this),o.optionUpdated(a,!1);else{var u=x({dependentModels:s,componentIndex:i},t.keyInfo);x(o=new l(a,this,this,u),u),o.init(a,this,this,u),o.optionUpdated(null,!0)}}else o.mergeOption({},this),o.optionUpdated({},!1);n.get(r)[i]=o,e[r][i]=o.option},this),"series"===r&&Fu(this,n.get("series"))},this),this._seriesIndicesMap=Q(this._seriesIndices=this._seriesIndices||[])},getOption:function(){var t=m(this.option);return k(t,function(e,n){if(gu.hasClass(n)){for(var r=(e=Ti(e)).length-1;0<=r;r--)Ei(e[r])&&e.splice(r,1);t[n]=e}}),delete t[zu],t},getTheme:function(){return this._theme},getComponent:function(t,e){var n=this._componentsMap.get(t);if(n)return n[e||0]},queryComponents:function(t){var e=t.mainType;if(!e)return[];var n,r=t.index,i=t.id,o=t.name,a=this._componentsMap.get(e);if(!a||!a.length)return[];if(null!=r)R(r)||(r=[r]),n=D(A(r,function(t){return a[t]}),function(t){return!!t});else if(null!=i){var s=R(i);n=D(a,function(t){return s&&0<=S(i,t.id)||!s&&t.id===i})}else if(null!=o){var l=R(o);n=D(a,function(t){return l&&0<=S(o,t.name)||!l&&t.name===o})}else n=a.slice();return Hu(n,t)},findComponents:function(t){var e,n,r,i,o,a=t.mainType,s=(n=a+"Index",r=a+"Id",i=a+"Name",!(e=t.query)||null==e[n]&&null==e[r]&&null==e[i]?null:{mainType:a,index:e[n],id:e[r],name:e[i]});return o=Hu(s?this.queryComponents(s):this._componentsMap.get(a),t),t.filter?D(o,t.filter):o},eachComponent:function(t,e,n){var r=this._componentsMap;"function"==typeof t?(n=e,e=t,r.each(function(t,r){k(t,function(t,i){e.call(n,r,t,i)})})):N(t)?k(r.get(t),e,n):B(t)&&k(this.findComponents(t),e,n)},getSeriesByName:function(t){return D(this._componentsMap.get("series"),function(e){return e.name===t})},getSeriesByIndex:function(t){return this._componentsMap.get("series")[t]},getSeriesByType:function(t){return D(this._componentsMap.get("series"),function(e){return e.subType===t})},getSeries:function(){return this._componentsMap.get("series").slice()},getSeriesCount:function(){return this._componentsMap.get("series").length},eachSeries:function(t,e){k(this._seriesIndices,function(n){var r=this._componentsMap.get("series")[n];t.call(e,r,n)},this)},eachRawSeries:function(t,e){k(this._componentsMap.get("series"),t,e)},eachSeriesByType:function(t,e,n){k(this._seriesIndices,function(r){var i=this._componentsMap.get("series")[r];i.subType===t&&e.call(n,i,r)},this)},eachRawSeriesByType:function(t,e,n){return k(this.getSeriesByType(t),e,n)},isSeriesFiltered:function(t){return null==this._seriesIndicesMap.get(t.componentIndex)},getCurrentSeriesIndices:function(){return(this._seriesIndices||[]).slice()},filterSeries:function(t,e){Fu(this,D(this._componentsMap.get("series"),t,e))},restoreData:function(t){var e=this._componentsMap;Fu(this,e.get("series"));var n=[];e.each(function(t,e){n.push(e)}),gu.topologicalTravel(n,gu.getAllClassMainTypes(),function(n,r){k(e.get(n),function(e){"series"===n&&function(t,e){if(e){var n=e.seiresIndex,r=e.seriesId,i=e.seriesName;return null!=n&&t.componentIndex!==n||null!=r&&t.id!==r||null!=i&&t.name!==i}}(e,t)||e.restoreData()})})}});function Fu(t,e){t._seriesIndicesMap=Q(t._seriesIndices=A(e,function(t){return t.componentIndex})||[])}function Hu(t,e){return e.hasOwnProperty("subType")?D(t,function(t){return t.subType===e.subType}):t}M(Vu,bu);var Wu=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isDisposed","on","off","getDataURL","getConnectedDataURL","getModel","getOption","getViewOfComponentModel","getViewOfSeriesModel"];function ju(t){k(Wu,function(e){this[e]=P(t[e],t)},this)}var Gu={};function Uu(){this._coordinateSystems=[]}Uu.prototype={constructor:Uu,create:function(t,e){var n=[];k(Gu,function(r,i){var o=r.create(t,e);n=n.concat(o||[])}),this._coordinateSystems=n},update:function(t,e){k(this._coordinateSystems,function(n){n.update&&n.update(t,e)})},getCoordinateSystems:function(){return this._coordinateSystems.slice()}},Uu.register=function(t,e){Gu[t]=e},Uu.get=function(t){return Gu[t]};var qu=k,Xu=m,Yu=A,$u=v,Zu=/^(min|max)?(.+)$/;function Ku(t){this._api=t,this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[]}function Ju(t,e,n){var r={width:e,height:n,aspectratio:e/n},i=!0;return k(t,function(t,e){var n=e.match(Zu);if(n&&n[1]&&n[2]){var o=n[1],a=n[2].toLowerCase();!function(t,e,n){return"min"===n?e<=t:"max"===n?t<=e:t===e}(r[a],t,o)&&(i=!1)}}),i}Ku.prototype={constructor:Ku,setOption:function(t,e){t&&k(Ti(t.series),function(t){t&&t.data&&V(t.data)&&Z(t.data)}),t=Xu(t);var n=this._optionBackup,r=(function(t,e,n){var r,i,o=[],a=[],s=t.timeline;return t.baseOption&&(i=t.baseOption),(s||t.options)&&(i=i||{},o=(t.options||[]).slice()),t.media&&(i=i||{},qu(t.media,function(t){t&&t.option&&(t.query?a.push(t):r=r||t)})),(i=i||t).timeline||(i.timeline=s),qu([i].concat(o).concat(A(a,function(t){return t.option})),function(t){qu(e,function(e){e(t,n)})}),{baseOption:i,timelineOptions:o,mediaDefault:r,mediaList:a}}).call(this,t,e,!n);this._newBaseOption=r.baseOption,n?(function(t,e){qu(e=e||{},function(e,n){if(null!=e){var r=t[n];if(gu.hasClass(n)){e=Ti(e);var i=Di(r=Ti(r),e);t[n]=Yu(i,function(t){return t.option&&t.exist?$u(t.exist,t.option,!0):t.exist||t.option})}else t[n]=$u(r,e,!0)}})}(n.baseOption,r.baseOption),r.timelineOptions.length&&(n.timelineOptions=r.timelineOptions),r.mediaList.length&&(n.mediaList=r.mediaList),r.mediaDefault&&(n.mediaDefault=r.mediaDefault)):this._optionBackup=r},mountOption:function(t){var e=this._optionBackup;return this._timelineOptions=Yu(e.timelineOptions,Xu),this._mediaList=Yu(e.mediaList,Xu),this._mediaDefault=Xu(e.mediaDefault),this._currentMediaIndices=[],Xu(t?e.baseOption:this._newBaseOption)},getTimelineOption:function(t){var e,n=this._timelineOptions;if(n.length){var r=t.getComponent("timeline");r&&(e=Xu(n[r.getCurrentIndex()],!0))}return e},getMediaOption:function(t){var e=this._api.getWidth(),n=this._api.getHeight(),r=this._mediaList,i=this._mediaDefault,o=[],a=[];if(!r.length&&!i)return a;for(var s=0,l=r.length;s<l;s++)Ju(r[s].query,e,n)&&o.push(s);return!o.length&&i&&(o=[-1]),o.length&&!function(t,e){return t.join(",")===e.join(",")}(o,this._currentMediaIndices)&&(a=Yu(o,function(t){return Xu(-1===t?i.option:r[t].option)})),this._currentMediaIndices=o,a}};var Qu=k,tc=B,ec=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function nc(t){var e=t&&t.itemStyle;if(e)for(var n=0,r=ec.length;n<r;n++){var i=ec[n],o=e.normal,a=e.emphasis;o&&o[i]&&(t[i]=t[i]||{},t[i].normal?v(t[i].normal,o[i]):t[i].normal=o[i],o[i]=null),a&&a[i]&&(t[i]=t[i]||{},t[i].emphasis?v(t[i].emphasis,a[i]):t[i].emphasis=a[i],a[i]=null)}}function rc(t,e,n){if(t&&t[e]&&(t[e].normal||t[e].emphasis)){var r=t[e].normal,i=t[e].emphasis;r&&(n?(t[e].normal=t[e].emphasis=null,b(t[e],r)):t[e]=r),i&&(t.emphasis=t.emphasis||{},t.emphasis[e]=i)}}function ic(t){rc(t,"itemStyle"),rc(t,"lineStyle"),rc(t,"areaStyle"),rc(t,"label"),rc(t,"labelLine"),rc(t,"upperLabel"),rc(t,"edgeLabel")}function oc(t,e){var n=tc(t)&&t[e],r=tc(n)&&n.textStyle;if(r)for(var i=0,o=Ai.length;i<o;i++)r.hasOwnProperty(e=Ai[i])&&(n[e]=r[e])}function ac(t){t&&(ic(t),oc(t,"label"),t.emphasis&&oc(t.emphasis,"label"))}function sc(t){return R(t)?t:t?[t]:[]}function lc(t){return(R(t)?t[0]:t)||{}}function uc(t){k(cc,function(e){e[0]in t&&!(e[1]in t)&&(t[e[1]]=t[e[0]])})}var cc=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],dc=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],fc=function(t,e){(function(t,e){Qu(sc(t.series),function(t){tc(t)&&function(t){if(tc(t)){nc(t),ic(t),oc(t,"label"),oc(t,"upperLabel"),oc(t,"edgeLabel"),t.emphasis&&(oc(t.emphasis,"label"),oc(t.emphasis,"upperLabel"),oc(t.emphasis,"edgeLabel")),(n=t.markPoint)&&(nc(n),ac(n)),(r=t.markLine)&&(nc(r),ac(r));var e=t.markArea;e&&ac(e);var n,r,i=t.data;if("graph"===t.type){i=i||t.nodes;var o=t.links||t.edges;if(o&&!V(o))for(var a=0;a<o.length;a++)ac(o[a]);k(t.categories,function(t){ic(t)})}if(i&&!V(i))for(a=0;a<i.length;a++)ac(i[a]);if((n=t.markPoint)&&n.data){var s=n.data;for(a=0;a<s.length;a++)ac(s[a])}if((r=t.markLine)&&r.data){var l=r.data;for(a=0;a<l.length;a++)R(l[a])?(ac(l[a][0]),ac(l[a][1])):ac(l[a])}"gauge"===t.type?(oc(t,"axisLabel"),oc(t,"title"),oc(t,"detail")):"treemap"===t.type?(rc(t.breadcrumb,"itemStyle"),k(t.levels,function(t){ic(t)})):"tree"===t.type&&ic(t.leaves)}}(t)});var n=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];e&&n.push("valueAxis","categoryAxis","logAxis","timeAxis"),Qu(n,function(e){Qu(sc(t[e]),function(t){t&&(oc(t,"axisLabel"),oc(t.axisPointer,"label"))})}),Qu(sc(t.parallel),function(t){var e=t&&t.parallelAxisDefault;oc(e,"axisLabel"),oc(e&&e.axisPointer,"label")}),Qu(sc(t.calendar),function(t){rc(t,"itemStyle"),oc(t,"dayLabel"),oc(t,"monthLabel"),oc(t,"yearLabel")}),Qu(sc(t.radar),function(t){oc(t,"name")}),Qu(sc(t.geo),function(t){tc(t)&&(ac(t),Qu(sc(t.regions),function(t){ac(t)}))}),Qu(sc(t.timeline),function(t){ac(t),rc(t,"label"),rc(t,"itemStyle"),rc(t,"controlStyle",!0);var e=t.data;R(e)&&k(e,function(t){B(t)&&(rc(t,"label"),rc(t,"itemStyle"))})}),Qu(sc(t.toolbox),function(t){rc(t,"iconStyle"),Qu(t.feature,function(t){rc(t,"iconStyle")})}),oc(lc(t.axisPointer),"label"),oc(lc(t.tooltip).axisPointer,"label")})(t,e),t.series=Ti(t.series),k(t.series,function(t){if(B(t)){var e=t.type;if("line"===e)null!=t.clipOverflow&&(t.clip=t.clipOverflow);else if("pie"===e||"gauge"===e)null!=t.clockWise&&(t.clockwise=t.clockWise);else if("gauge"===e){var n=function(t,e){e=e.split(",");for(var n=t,r=0;r<e.length&&null!=(n=n&&n[e[r]]);r++);return n}(t,"pointer.color");null!=n&&function(t,e,n,r){e=e.split(",");for(var i,o=t,a=0;a<e.length-1;a++)null==o[i=e[a]]&&(o[i]={}),o=o[i];null!=o[e[a]]||(o[e[a]]=n)}(t,"itemStyle.color",n)}uc(t)}}),t.dataRange&&(t.visualMap=t.dataRange),k(dc,function(e){var n=t[e];n&&(R(n)||(n=[n]),k(n,function(t){uc(t)}))})};function hc(t){k(t,function(e,n){var r=[],i=[NaN,NaN],o=e.data,a=e.isStackedByIndex,s=o.map([e.stackResultDimension,e.stackedOverDimension],function(s,l,u){var c,d,f=o.get(e.stackedDimension,u);if(isNaN(f))return i;a?d=o.getRawIndex(u):c=o.get(e.stackedByDimension,u);for(var h=NaN,p=n-1;0<=p;p--){var g=t[p];if(a||(d=g.data.rawIndexOf(g.stackedByDimension,c)),0<=d){var m=g.data.getByRawIndex(g.stackResultDimension,d);if(0<=f&&0<m||f<=0&&m<0){f+=m,h=m;break}}}return r[0]=f,r[1]=h,r});o.hostModel.setData(s),e.data=s})}function pc(t,e){Iu.isInstance(t)||(t=Iu.seriesDataToSource(t)),this._source=t;var n=this._data=t.data,r=t.sourceFormat;r===Tu&&(this._offset=0,this._dimSize=e,this._data=n),x(this,mc[r===wu?r+"_"+t.seriesLayoutBy:r])}var gc=pc.prototype;gc.pure=!1;var mc={arrayRows_column:{pure:gc.persistent=!0,count:function(){return Math.max(0,this._data.length-this._source.startIndex)},getItem:function(t){return this._data[t+this._source.startIndex]},appendData:xc},arrayRows_row:{pure:!0,count:function(){var t=this._data[0];return t?Math.max(0,t.length-this._source.startIndex):0},getItem:function(t){t+=this._source.startIndex;for(var e=[],n=this._data,r=0;r<n.length;r++){var i=n[r];e.push(i?i[t]:null)}return e},appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},objectRows:{pure:!0,count:vc,getItem:yc,appendData:xc},keyedColumns:{pure:!0,count:function(){var t=this._data[this._source.dimensionsDefine[0].name];return t?t.length:0},getItem:function(t){for(var e=[],n=this._source.dimensionsDefine,r=0;r<n.length;r++){var i=this._data[n[r].name];e.push(i?i[t]:null)}return e},appendData:function(t){var e=this._data;k(t,function(t,n){for(var r=e[n]||(e[n]=[]),i=0;i<(t||[]).length;i++)r.push(t[i])})}},original:{count:vc,getItem:yc,appendData:xc},typedArray:{persistent:!(gc.getSource=function(){return this._source}),pure:!0,count:function(){return this._data?this._data.length/this._dimSize:0},getItem:function(t,e){e=e||[];for(var n=this._dimSize*(t-=this._offset),r=0;r<this._dimSize;r++)e[r]=this._data[n+r];return e},appendData:function(t){this._data=t},clean:function(){this._offset+=this.count(),this._data=null}}};function vc(){return this._data.length}function yc(t){return this._data[t]}function xc(t){for(var e=0;e<t.length;e++)this._data.push(t[e])}var bc={arrayRows:_c,objectRows:function(t,e,n,r){return null!=n?t[r]:t},keyedColumns:_c,original:function(t,e,n,r){var i=Ii(t);return null!=n&&i instanceof Array?i[n]:i},typedArray:_c};function _c(t,e,n,r){return null!=n?t[n]:t}var wc={arrayRows:Sc,objectRows:function(t,e,n,r){return Cc(t[e],this._dimensionInfos[e])},keyedColumns:Sc,original:function(t,e,n,r){var i=t&&(null==t.value?t:t.value);return!this._rawData.pure&&function(t){return Si(t)&&!(t instanceof Array)}(t)&&(this.hasItemOption=!0),Cc(i instanceof Array?i[r]:i,this._dimensionInfos[e])},typedArray:function(t,e,n,r){return t[r]}};function Sc(t,e,n,r){return Cc(t[r],this._dimensionInfos[e])}function Cc(t,e){var n=e&&e.type;if("ordinal"!==n)return"time"===n&&"number"!=typeof t&&null!=t&&"-"!==t&&(t=+Ol(t)),null==t||""===t?NaN:+t;var r=e&&e.ordinalMeta;return r?r.parseAndCollect(t):t}function Mc(t,e,n){if(t){var r=t.getRawDataItem(e);if(null!=r){var i,o,a=t.getProvider().getSource().sourceFormat,s=t.getDimensionInfo(n);return s&&(i=s.name,o=s.index),bc[a](r,e,o,i)}}}function Tc(t,e,n){if(t){var r=t.getProvider().getSource().sourceFormat;if(r===_u||r===Su){var i=t.getRawDataItem(e);return r!==_u||B(i)||(i=null),i?i[n]:void 0}}}var kc=/\{@(.+?)\}/g,Ac={getDataParams:function(t,e){var n=this.getData(e),r=this.getRawValue(t,e),i=n.getRawIndex(t),o=n.getName(t),a=n.getRawDataItem(t),s=n.getItemVisual(t,"color"),l=n.getItemVisual(t,"borderColor"),u=this.ecModel.getComponent("tooltip"),c=Fi(u&&u.get("renderMode")),d=this.mainType,f="series"===d,h=n.userOutput;return{componentType:d,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:f?this.subType:null,seriesIndex:this.seriesIndex,seriesId:f?this.id:null,seriesName:f?this.name:null,name:o,dataIndex:i,data:a,dataType:e,value:r,color:s,borderColor:l,dimensionNames:h?h.dimensionNames:null,encode:h?h.encode:null,marker:Yl({color:s,renderMode:c}),$vars:["seriesName","name","value"]}},getFormattedLabel:function(t,e,n,r,i){e=e||"normal";var o=this.getData(n),a=o.getItemModel(t),s=this.getDataParams(t,n);null!=r&&s.value instanceof Array&&(s.value=s.value[r]);var l=a.get("normal"===e?[i||"label","formatter"]:[e,i||"label","formatter"]);return"function"==typeof l?(s.status=e,s.dimensionIndex=r,l(s)):"string"==typeof l?ql(l,s).replace(kc,function(e,n){var r=n.length;return"["===n.charAt(0)&&"]"===n.charAt(r-1)&&(n=+n.slice(1,r-1)),Mc(o,t,n)}):void 0},getRawValue:function(t,e){return Mc(this.getData(e),t)},formatTooltip:function(){}};function Ic(t){return new Dc(t)}function Dc(t){this._reset=(t=t||{}).reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0}var Oc=Dc.prototype;Oc.perform=function(t){var e,n=this._upstream,r=t&&t.skip;if(this._dirty&&n){var i=this.context;i.data=i.outputData=n.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!r&&(e=this._plan(this.context));var o,a=c(this._modBy),s=this._modDataCount||0,l=c(t&&t.modBy),u=t&&t.modDataCount||0;function c(t){return 1<=t||(t=1),t}a===l&&s===u||(e="reset"),!this._dirty&&"reset"!==e||(this._dirty=!1,o=function(t,e){var n,r;t._dueIndex=t._outputDueEnd=t._dueEnd=0,t._settedOutputEnd=null,!e&&t._reset&&((n=t._reset(t.context))&&n.progress&&(r=n.forceFirstProgress,n=n.progress),R(n)&&!n.length&&(n=null)),t._progress=n,t._modBy=t._modDataCount=null;var i=t._downstream;return i&&i.dirty(),r}(this,r)),this._modBy=l,this._modDataCount=u;var d=t&&t.step;if(this._dueEnd=n?n._outputDueEnd:this._count?this._count(this.context):1/0,this._progress){var f=this._dueIndex,h=Math.min(null!=d?this._dueIndex+d:1/0,this._dueEnd);if(!r&&(o||f<h)){var p=this._progress;if(R(p))for(var g=0;g<p.length;g++)Hc(this,p[g],f,h,l,u);else Hc(this,p,f,h,l,u)}this._dueIndex=h,this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:h}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished()};var Pc,Ec,Rc,Lc,Nc,Bc,zc=Bc={reset:function(t,e,n,r){Ec=t,Pc=e,Rc=n,Lc=r,Nc=Math.ceil(Lc/Rc),Bc.next=1<Rc&&0<Lc?Fc:Vc}};function Vc(){return Ec<Pc?Ec++:null}function Fc(){var t=Ec%Nc*Rc+Math.ceil(Ec/Nc),e=Pc<=Ec?null:t<Lc?t:Ec;return Ec++,e}function Hc(t,e,n,r,i,o){zc.reset(n,r,i,o),t._callingProgress=e,t._callingProgress({start:n,end:r,count:r-n,next:zc.next},t.context)}Oc.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},Oc.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},Oc.pipe=function(t){this._downstream===t&&!this._dirty||((this._downstream=t)._upstream=this,t.dirty())},Oc.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},Oc.getUpstream=function(){return this._upstream},Oc.getDownstream=function(){return this._downstream},Oc.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t};var Wc=Li(),jc=gu.extend({type:"series.__base__",seriesIndex:0,coordinateSystem:null,defaultOption:null,legendVisualProvider:null,visualColorAccessPath:"itemStyle.color",visualBorderColorAccessPath:"itemStyle.borderColor",layoutMode:null,init:function(t,e,n,r){this.seriesIndex=this.componentIndex,this.dataTask=Ic({count:Uc,reset:qc}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(t,n),Ou(this);var i=this.getInitialData(t,n);Yc(i,this),this.dataTask.context.data=i,Wc(this).dataBeforeProcessed=i,Gc(this)},mergeDefaultAndTheme:function(t,e){var n=this.layoutMode,r=n?uu(t):{},i=this.subType;gu.hasClass(i)&&(i+="Series"),v(t,e.getTheme().get(this.subType)),v(t,this.getDefaultOption()),ki(t,"label",["show"]),this.fillDataTextStyle(t.data),n&&lu(t,r,n)},mergeOption:function(t,e){t=v(this.option,t,!0),this.fillDataTextStyle(t.data);var n=this.layoutMode;n&&lu(this.option,t,n),Ou(this);var r=this.getInitialData(t,e);Yc(r,this),this.dataTask.dirty(),this.dataTask.context.data=r,Wc(this).dataBeforeProcessed=r,Gc(this)},fillDataTextStyle:function(t){if(t&&!V(t))for(var e=["show"],n=0;n<t.length;n++)t[n]&&t[n].label&&ki(t[n],"label",e)},getInitialData:function(){},appendData:function(t){this.getRawData().appendData(t.data)},getData:function(t){var e=Zc(this);if(e){var n=e.context.data;return null==t?n:n.getLinkedData(t)}return Wc(this).data},setData:function(t){var e=Zc(this);if(e){var n=e.context;n.data!==t&&e.modifyOutputEnd&&e.setOutputEnd(t.count()),n.outputData=t,e!==this.dataTask&&(n.data=t)}Wc(this).data=t},getSource:function(){return function(t){return Du(t).source}(this)},getRawData:function(){return Wc(this).dataBeforeProcessed},getBaseAxis:function(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis()},formatTooltip:function(t,e,n,r){var i=this,o="html"===(r=r||"html")?"<br/>":"\n",a="richText"===r,s={},l=0,u=this.getData(),c=u.mapDimension("defaultedTooltip",!0),d=c.length,f=this.getRawValue(t),h=R(f),p=u.getItemVisual(t,"color");B(p)&&p.colorStops&&(p=(p.colorStops[0]||{}).color),p=p||"transparent";var g=(1<d||h&&!d?function(n){var o=I(n,function(t,e,n){var r=u.getDimensionInfo(n);return t|(r&&!1!==r.tooltip&&null!=r.displayName)},0),d=[];function f(t,n){var c=u.getDimensionInfo(n);if(c&&!1!==c.otherDims.tooltip){var f=c.type,h="sub"+i.seriesIndex+"at"+l,g=Yl({color:p,type:"subItem",renderMode:r,markerId:h}),m=(o?("string"==typeof g?g:g.content)+jl(c.displayName||"-")+": ":"")+jl("ordinal"===f?t+"":"time"===f?e?"":Zl("yyyy/MM/dd hh:mm:ss",t):zl(t));m&&d.push(m),a&&(s[h]=p,++l)}}c.length?k(c,function(e){f(Mc(u,t,e),e)}):k(n,f);var h=o?a?"\n":"<br/>":"",g=h+d.join(h||", ");return{renderMode:r,content:g,style:s}}(f):function(t){return{renderMode:r,content:jl(zl(t)),style:s}}(d?Mc(u,t,c[0]):h?f[0]:f)).content,m=i.seriesIndex+"at"+l,v=Yl({color:p,type:"item",renderMode:r,markerId:m});s[m]=p,++l;var y=u.getName(t),x=this.name;Pi(this)||(x=""),x=x?jl(x)+(e?": ":o):"";var b="string"==typeof v?v:v.content;return{html:e?b+x+g:x+b+(y?jl(y)+": "+g:g),markers:s}},isAnimationEnabled:function(){if(i.node)return!1;var t=this.getShallow("animation");return t&&this.getData().count()>this.getShallow("animationThreshold")&&(t=!1),t},restoreData:function(){this.dataTask.dirty()},getColorFromPalette:function(t,e,n){var r=this.ecModel;return bu.getColorFromPalette.call(this,t,e,n)||r.getColorFromPalette(t,e,n)},coordDimToDataDim:function(t){return this.getRawData().mapDimension(t,!0)},getProgressive:function(){return this.get("progressive")},getProgressiveThreshold:function(){return this.get("progressiveThreshold")},getAxisTooltipData:null,getTooltipPosition:null,pipeTask:null,preventIncremental:null,pipelineContext:null});function Gc(t){var e=t.name;Pi(t)||(t.name=function(t){var e=t.getRawData(),n=e.mapDimension("seriesName",!0),r=[];return k(n,function(t){var n=e.getDimensionInfo(t);n.displayName&&r.push(n.displayName)}),r.join(" ")}(t)||e)}function Uc(t){return t.model.getRawData().count()}function qc(t){var e=t.model;return e.setData(e.getRawData().cloneShallow()),Xc}function Xc(t,e){e.outputData&&t.end>e.outputData.count()&&e.model.getRawData().cloneShallow(e.outputData)}function Yc(t,e){k(t.CHANGABLE_METHODS,function(n){t.wrapMethod(n,E($c,e))})}function $c(t){var e=Zc(t);e&&e.setOutputEnd(this.count())}function Zc(t){var e=(t.ecModel||{}).scheduler,n=e&&e.getPipeline(t.uid);if(n){var r=n.currentTask;if(r){var i=r.agentStubMap;i&&(r=i.get(t.uid))}return r}}M(jc,Ac),M(jc,bu);var Kc=function(){this.group=new Cn,this.uid=vl("viewComponent")},Jc=Kc.prototype={constructor:Kc,init:function(t,e){},render:function(t,e,n,r){},dispose:function(){},filterForExposedEvent:null};function Qc(){var t=Li();return function(e){var n=t(e),r=e.pipelineContext,i=n.large,o=n.progressiveRender,a=n.large=r&&r.large,s=n.progressiveRender=r&&r.progressiveRender;return!!(i^a||o^s)&&"reset"}}Jc.updateView=Jc.updateLayout=Jc.updateVisual=function(t,e,n,r){},Gi(Kc),$i(Kc,{registerWhenExtend:!0});var td=Li(),ed=Qc();function nd(){this.group=new Cn,this.uid=vl("viewChart"),this.renderTask=Ic({plan:ad,reset:sd}),this.renderTask.context={view:this}}var rd=nd.prototype={type:"chart",init:function(t,e){},render:function(t,e,n,r){},highlight:function(t,e,n,r){od(t.getData(),r,"emphasis")},downplay:function(t,e,n,r){od(t.getData(),r,"normal")},remove:function(t,e){this.group.removeAll()},dispose:function(){},incrementalPrepareRender:null,incrementalRender:null,updateTransform:null,filterForExposedEvent:null};function id(t,e,n){if(t&&(t.trigger(e,n),t.isGroup&&!Bs(t)))for(var r=0,i=t.childCount();r<i;r++)id(t.childAt(r),e,n)}function od(t,e,n){var r=Ri(t,e),i=e&&null!=e.highlightKey?zs(e.highlightKey):null;null!=r?k(Ti(r),function(e){id(t.getItemGraphicEl(e),n,i)}):t.eachItemGraphicEl(function(t){id(t,n,i)})}function ad(t){return ed(t.model)}function sd(t){var e=t.model,n=t.ecModel,r=t.api,i=t.payload,o=e.pipelineContext.progressiveRender,a=t.view,s=i&&td(i).updateMethod,l=o?"incrementalPrepareRender":s&&a[s]?s:"render";return"render"!==l&&a[l](e,n,r,i),ld[l]}rd.updateView=rd.updateLayout=rd.updateVisual=function(t,e,n,r){this.render(t,e,n,r)},Gi(nd),$i(nd,{registerWhenExtend:!0}),nd.markUpdateMethod=function(t,e){td(t).updateMethod=e};var ld={incrementalPrepareRender:{progress:function(t,e){e.view.incrementalRender(t,e.model,e.ecModel,e.api,e.payload)}},render:{forceFirstProgress:!0,progress:function(t,e){e.view.render(e.model,e.ecModel,e.api,e.payload)}}},ud="\0__throttleOriginMethod",cd="\0__throttleRate",dd="\0__throttleType";function fd(t,e,n){var r,i,o,a,s,l=0,u=0,c=null;function d(){u=(new Date).getTime(),c=null,t.apply(o,a||[])}function f(){r=(new Date).getTime(),o=this,a=arguments;var t=s||e,f=s||n;s=null,i=r-(f?l:u)-t,clearTimeout(c),f?c=setTimeout(d,t):0<=i?d():c=setTimeout(d,-i),l=r}return e=e||0,f.clear=function(){c&&(clearTimeout(c),c=null)},f.debounceNextCall=function(t){s=t},f}function hd(t,e,n,r){var i=t[e];if(i){var o=i[ud]||i;if(i[cd]!==n||i[dd]!==r){if(null==n||!r)return t[e]=o;(i=t[e]=fd(o,n,"debounce"===r))[ud]=o,i[dd]=r,i[cd]=n}return i}}function pd(t,e){var n=t[e];n&&n[ud]&&(t[e]=n[ud])}var gd={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){var n=t.getData(),r=(t.visualColorAccessPath||"itemStyle.color").split("."),i=t.get(r),o=!L(i)||i instanceof Za?null:i;i&&!o||(i=t.getColorFromPalette(t.name,null,e.getSeriesCount())),n.setVisual("color",i);var a=(t.visualBorderColorAccessPath||"itemStyle.borderColor").split("."),s=t.get(a);if(n.setVisual("borderColor",s),!e.isSeriesFiltered(t))return o&&n.each(function(e){n.setItemVisual(e,"color",o(t.getDataParams(e)))}),{dataEach:n.hasItemOption?function(t,e){var n=t.getItemModel(e),i=n.get(r,!0),o=n.get(a,!0);null!=i&&t.setItemVisual(e,"color",i),null!=o&&t.setItemVisual(e,"borderColor",o)}:null}}},md={legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}},vd=Math.PI;function yd(t,e,n,r){this.ecInstance=t,this.api=e,n=this._dataProcessorHandlers=n.slice(),r=this._visualHandlers=r.slice(),this._allHandlers=n.concat(r),this._stageTaskMap=Q()}var xd=yd.prototype;function bd(t,e,n,r,i){var o;function a(t,e){return t.setDirty&&(!t.dirtyMap||t.dirtyMap.get(e.__pipeline.id))}i=i||{},k(e,function(e,s){if(!i.visualType||i.visualType===e.visualType){var l=t._stageTaskMap.get(e.uid),u=l.seriesTaskMap,c=l.overallTask;if(c){var d,f=c.agentStubMap;f.each(function(t){a(i,t)&&(t.dirty(),d=!0)}),d&&c.dirty(),_d(c,r);var h=t.getPerformArgs(c,i.block);f.each(function(t){t.perform(h)}),o|=c.perform(h)}else u&&u.each(function(s,l){a(i,s)&&s.dirty();var u=t.getPerformArgs(s,i.block);u.skip=!e.performRawSeries&&n.isSeriesFiltered(s.context.model),_d(s,r),o|=s.perform(u)})}}),t.unfinished|=o}xd.restoreData=function(t,e){t.restoreData(e),this._stageTaskMap.each(function(t){var e=t.overallTask;e&&e.dirty()})},xd.getPerformArgs=function(t,e){if(t.__pipeline){var n=this._pipelineMap.get(t.__pipeline.id),r=n.context,i=!e&&n.progressiveEnabled&&(!r||r.progressiveRender)&&t.__idxInPipeline>n.blockIndex?n.step:null,o=r&&r.modDataCount;return{step:i,modBy:null!=o?Math.ceil(o/i):null,modDataCount:o}}},xd.getPipeline=function(t){return this._pipelineMap.get(t)},xd.updateStreamModes=function(t,e){var n=this._pipelineMap.get(t.uid),r=t.getData().count(),i=n.progressiveEnabled&&e.incrementalPrepareRender&&r>=n.threshold,o=t.get("large")&&r>=t.get("largeThreshold"),a="mod"===t.get("progressiveChunkMode")?r:null;t.pipelineContext=n.context={progressiveRender:i,modDataCount:a,large:o}},xd.restorePipelines=function(t){var e=this,n=e._pipelineMap=Q();t.eachSeries(function(t){var r=t.getProgressive(),i=t.uid;n.set(i,{id:i,head:null,tail:null,threshold:t.getProgressiveThreshold(),progressiveEnabled:r&&!(t.preventIncremental&&t.preventIncremental()),blockIndex:-1,step:Math.round(r||700),count:0}),Od(e,t,t.dataTask)})},xd.prepareStageTasks=function(){var t=this._stageTaskMap,e=this.ecInstance.getModel(),n=this.api;k(this._allHandlers,function(r){var i=t.get(r.uid)||t.set(r.uid,[]);r.reset&&function(t,e,n,r,i){var o=n.seriesTaskMap||(n.seriesTaskMap=Q()),a=e.seriesType,s=e.getTargetSeries;function l(n){var a=n.uid,s=o.get(a)||o.set(a,Ic({plan:Td,reset:kd,count:Dd}));s.context={model:n,ecModel:r,api:i,useClearVisual:e.isVisual&&!e.isLayout,plan:e.plan,reset:e.reset,scheduler:t},Od(t,n,s)}e.createOnAllSeries?r.eachRawSeries(l):a?r.eachRawSeriesByType(a,l):s&&s(r,i).each(l);var u=t._pipelineMap;o.each(function(t,e){u.get(e)||(t.dispose(),o.removeKey(e))})}(this,r,i,e,n),r.overallReset&&function(t,e,n,r,i){var o=n.overallTask=n.overallTask||Ic({reset:wd});o.context={ecModel:r,api:i,overallReset:e.overallReset,scheduler:t};var a=o.agentStubMap=o.agentStubMap||Q(),s=e.seriesType,l=e.getTargetSeries,u=!0,c=e.modifyOutputEnd;function d(e){var n=e.uid,r=a.get(n);r||(r=a.set(n,Ic({reset:Sd,onDirty:Md})),o.dirty()),r.context={model:e,overallProgress:u,modifyOutputEnd:c},r.agent=o,r.__block=u,Od(t,e,r)}s?r.eachRawSeriesByType(s,d):l?l(r,i).each(d):(u=!1,k(r.getSeries(),d));var f=t._pipelineMap;a.each(function(t,e){f.get(e)||(t.dispose(),o.dirty(),a.removeKey(e))})}(this,r,i,e,n)},this)},xd.prepareView=function(t,e,n,r){var i=t.renderTask,o=i.context;o.model=e,o.ecModel=n,o.api=r,i.__block=!t.incrementalPrepareRender,Od(this,e,i)},xd.performDataProcessorTasks=function(t,e){bd(this,this._dataProcessorHandlers,t,e,{block:!0})},xd.performVisualTasks=function(t,e,n){bd(this,this._visualHandlers,t,e,n)},xd.performSeriesTasks=function(t){var e;t.eachSeries(function(t){e|=t.dataTask.perform()}),this.unfinished|=e},xd.plan=function(){this._pipelineMap.each(function(t){var e=t.tail;do{if(e.__block){t.blockIndex=e.__idxInPipeline;break}e=e.getUpstream()}while(e)})};var _d=xd.updatePayload=function(t,e){"remain"!==e&&(t.context.payload=e)};function wd(t){t.overallReset(t.ecModel,t.api,t.payload)}function Sd(t,e){return t.overallProgress&&Cd}function Cd(){this.agent.dirty(),this.getDownstream().dirty()}function Md(){this.agent&&this.agent.dirty()}function Td(t){return t.plan&&t.plan(t.model,t.ecModel,t.api,t.payload)}function kd(t){t.useClearVisual&&t.data.clearAllVisual();var e=t.resetDefines=Ti(t.reset(t.model,t.ecModel,t.api,t.payload));return 1<e.length?A(e,function(t,e){return Id(e)}):Ad}var Ad=Id(0);function Id(t){return function(e,n){var r=n.data,i=n.resetDefines[t];if(i&&i.dataEach)for(var o=e.start;o<e.end;o++)i.dataEach(r,o);else i&&i.progress&&i.progress(e,r)}}function Dd(t){return t.data.count()}function Od(t,e,n){var r=t._pipelineMap.get(e.uid);r.head||(r.head=n),r.tail&&r.tail.pipe(n),(r.tail=n).__idxInPipeline=r.count++,n.__pipeline=r}yd.wrapStageHandler=function(t,e){return L(t)&&(t={overallReset:t,seriesType:function(t){Pd=null;try{t(Ed,Rd)}catch(t){}return Pd}(t)}),t.uid=vl("stageHandler"),e&&(t.visualType=e),t};var Pd,Ed={},Rd={};function Ld(t,e){for(var n in e.prototype)t[n]=et}function Nd(){return{axisLine:{lineStyle:{color:Vd}},axisTick:{lineStyle:{color:Vd}},axisLabel:{textStyle:{color:Vd}},splitLine:{lineStyle:{type:"dashed",color:"#aaa"}},splitArea:{areaStyle:{color:Vd}}}}Ld(Ed,Vu),Ld(Rd,ju),Ed.eachSeriesByType=Ed.eachRawSeriesByType=function(t){Pd=t},Ed.eachComponent=function(t){"series"===t.mainType&&t.subType&&(Pd=t.subType)};var Bd=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"],zd={color:Bd,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],Bd]},Vd="#eee",Fd=["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],Hd={color:Fd,backgroundColor:"#333",tooltip:{axisPointer:{lineStyle:{color:Vd},crossStyle:{color:Vd},label:{color:"#000"}}},legend:{textStyle:{color:Vd}},textStyle:{color:Vd},title:{textStyle:{color:Vd}},toolbox:{iconStyle:{normal:{borderColor:Vd}}},dataZoom:{textStyle:{color:Vd}},visualMap:{textStyle:{color:Vd}},timeline:{lineStyle:{color:Vd},itemStyle:{normal:{color:Fd[1]}},label:{normal:{textStyle:{color:Vd}}},controlStyle:{normal:{color:Vd,borderColor:Vd}}},timeAxis:Nd(),logAxis:Nd(),valueAxis:Nd(),categoryAxis:Nd(),line:{symbol:"circle"},graph:{color:Fd},gauge:{title:{textStyle:{color:Vd}}},candlestick:{itemStyle:{normal:{color:"#FD1050",color0:"#0CF49B",borderColor:"#FD1050",borderColor0:"#0CF49B"}}}};Hd.categoryAxis.splitLine.show=!1,gu.extend({type:"dataset",defaultOption:{seriesLayoutBy:ku,sourceHeader:null,dimensions:null,source:null},optionUpdated:function(){!function(t){var e=t.option.source,n=Mu;if(V(e))n=Tu;else if(R(e)){0===e.length&&(n=wu);for(var r=0,i=e.length;r<i;r++){var o=e[r];if(null!=o){if(R(o)){n=wu;break}if(B(o)){n=Su;break}}}}else if(B(e)){for(var a in e)if(e.hasOwnProperty(a)&&T(e[a])){n=Cu;break}}else if(null!=e)throw new Error("Invalid data");Du(t).sourceFormat=n}(this)}}),Kc.extend({type:"dataset"});var Wd=ha.extend({type:"ellipse",shape:{cx:0,cy:0,rx:0,ry:0},buildPath:function(t,e){var n=e.cx,r=e.cy,i=e.rx,o=e.ry,a=.5522848*i,s=.5522848*o;t.moveTo(n-i,r),t.bezierCurveTo(n-i,r-s,n-a,r-o,n,r-o),t.bezierCurveTo(n+a,r-o,n+i,r-s,n+i,r),t.bezierCurveTo(n+i,r+s,n+a,r+o,n,r+o),t.bezierCurveTo(n-a,r+o,n-i,r+s,n-i,r),t.closePath()}}),jd=/[\s,]+/;function Gd(t){for(N(t)&&(t=(new DOMParser).parseFromString(t,"text/xml")),9===t.nodeType&&(t=t.firstChild);"svg"!==t.nodeName.toLowerCase()||1!==t.nodeType;)t=t.nextSibling;return t}function Ud(){this._defs={},this._root=null,this._isDefine=!1,this._isText=!1}Ud.prototype.parse=function(t,e){e=e||{};var n=Gd(t);if(!n)throw new Error("Illegal svg");var r=new Cn;this._root=r;var i=n.getAttribute("viewBox")||"",o=parseFloat(n.getAttribute("width")||e.width),a=parseFloat(n.getAttribute("height")||e.height);isNaN(o)&&(o=null),isNaN(a)&&(a=null),Kd(n,r,null,!0);for(var s,l,u=n.firstChild;u;)this._parseNode(u,r),u=u.nextSibling;if(i){var c=Y(i).split(jd);4<=c.length&&(s={x:parseFloat(c[0]||0),y:parseFloat(c[1]||0),width:parseFloat(c[2]),height:parseFloat(c[3])})}if(s&&null!=o&&null!=a&&(l=nf(s,o,a),!e.ignoreViewBox)){var d=r;(r=new Cn).add(d),d.scale=l.scale.slice(),d.position=l.position.slice()}return e.ignoreRootClip||null==o||null==a||r.setClipPath(new Ua({shape:{x:0,y:0,width:o,height:a}})),{root:r,width:o,height:a,viewBoxRect:s,viewBoxTransform:l}},Ud.prototype._parseNode=function(t,e){var n,r,i=t.nodeName.toLowerCase();if("defs"===i?this._isDefine=!0:"text"===i&&(this._isText=!0),this._isDefine){if(r=Xd[i]){var o=r.call(this,t),a=t.getAttribute("id");a&&(this._defs[a]=o)}}else(r=qd[i])&&(n=r.call(this,t,e),e.add(n));for(var s=t.firstChild;s;)1===s.nodeType&&this._parseNode(s,n),3===s.nodeType&&this._isText&&this._parseText(s,n),s=s.nextSibling;"defs"===i?this._isDefine=!1:"text"===i&&(this._isText=!1)},Ud.prototype._parseText=function(t,e){if(1===t.nodeType){var n=t.getAttribute("dx")||0,r=t.getAttribute("dy")||0;this._textX+=parseFloat(n),this._textY+=parseFloat(r)}var i=new Da({style:{text:t.textContent,transformText:!0},position:[this._textX||0,this._textY||0]});Yd(e,i),Kd(t,i,this._defs);var o=i.style.fontSize;o&&o<9&&(i.style.fontSize=9,i.scale=i.scale||[1,1],i.scale[0]*=o/9,i.scale[1]*=o/9);var a=i.getBoundingRect();return this._textX+=a.width,e.add(i),i};var qd={g:function(t,e){var n=new Cn;return Yd(e,n),Kd(t,n,this._defs),n},rect:function(t,e){var n=new Ua;return Yd(e,n),Kd(t,n,this._defs),n.setShape({x:parseFloat(t.getAttribute("x")||0),y:parseFloat(t.getAttribute("y")||0),width:parseFloat(t.getAttribute("width")||0),height:parseFloat(t.getAttribute("height")||0)}),n},circle:function(t,e){var n=new Pa;return Yd(e,n),Kd(t,n,this._defs),n.setShape({cx:parseFloat(t.getAttribute("cx")||0),cy:parseFloat(t.getAttribute("cy")||0),r:parseFloat(t.getAttribute("r")||0)}),n},line:function(t,e){var n=new Xa;return Yd(e,n),Kd(t,n,this._defs),n.setShape({x1:parseFloat(t.getAttribute("x1")||0),y1:parseFloat(t.getAttribute("y1")||0),x2:parseFloat(t.getAttribute("x2")||0),y2:parseFloat(t.getAttribute("y2")||0)}),n},ellipse:function(t,e){var n=new Wd;return Yd(e,n),Kd(t,n,this._defs),n.setShape({cx:parseFloat(t.getAttribute("cx")||0),cy:parseFloat(t.getAttribute("cy")||0),rx:parseFloat(t.getAttribute("rx")||0),ry:parseFloat(t.getAttribute("ry")||0)}),n},polygon:function(t,e){var n=t.getAttribute("points");n=n&&$d(n);var r=new za({shape:{points:n||[]}});return Yd(e,r),Kd(t,r,this._defs),r},polyline:function(t,e){var n=new ha;Yd(e,n),Kd(t,n,this._defs);var r=t.getAttribute("points");return r=r&&$d(r),new Va({shape:{points:r||[]}})},image:function(t,e){var n=new Wr;return Yd(e,n),Kd(t,n,this._defs),n.setStyle({image:t.getAttribute("xlink:href"),x:t.getAttribute("x"),y:t.getAttribute("y"),width:t.getAttribute("width"),height:t.getAttribute("height")}),n},text:function(t,e){var n=t.getAttribute("x")||0,r=t.getAttribute("y")||0,i=t.getAttribute("dx")||0,o=t.getAttribute("dy")||0;this._textX=parseFloat(n)+parseFloat(i),this._textY=parseFloat(r)+parseFloat(o);var a=new Cn;return Yd(e,a),Kd(t,a,this._defs),a},tspan:function(t,e){var n=t.getAttribute("x"),r=t.getAttribute("y");null!=n&&(this._textX=parseFloat(n)),null!=r&&(this._textY=parseFloat(r));var i=t.getAttribute("dx")||0,o=t.getAttribute("dy")||0,a=new Cn;return Yd(e,a),Kd(t,a,this._defs),this._textX+=i,this._textY+=o,a},path:function(t,e){var n=Ia(t.getAttribute("d")||"");return Yd(e,n),Kd(t,n,this._defs),n}},Xd={lineargradient:function(t){var e=new ts(parseInt(t.getAttribute("x1")||0,10),parseInt(t.getAttribute("y1")||0,10),parseInt(t.getAttribute("x2")||10,10),parseInt(t.getAttribute("y2")||0,10));return function(t,e){for(var n=t.firstChild;n;){if(1===n.nodeType){var r=n.getAttribute("offset");r=0<r.indexOf("%")?parseInt(r,10)/100:r?parseFloat(r):0;var i=n.getAttribute("stop-color")||"#000000";e.addColorStop(r,i)}n=n.nextSibling}}(t,e),e},radialgradient:function(t){}};function Yd(t,e){t&&t.__inheritedStyle&&(e.__inheritedStyle||(e.__inheritedStyle={}),b(e.__inheritedStyle,t.__inheritedStyle))}function $d(t){for(var e=Y(t).split(jd),n=[],r=0;r<e.length;r+=2){var i=parseFloat(e[r]),o=parseFloat(e[r+1]);n.push([i,o])}return n}var Zd={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-align":"textAlign","alignment-baseline":"textBaseline"};function Kd(t,e,n,r){var i=e.__inheritedStyle||{},o="text"===e.type;if(1===t.nodeType&&(function(t,e){var n=t.getAttribute("transform");if(n){n=n.replace(/,/g," ");var r=null,i=[];n.replace(tf,function(t,e,n){i.push(e,n)});for(var o=i.length-1;0<o;o-=2){var a=i[o],s=i[o-1];switch(r=r||re(),s){case"translate":a=Y(a).split(jd),se(r,r,[parseFloat(a[0]),parseFloat(a[1]||0)]);break;case"scale":a=Y(a).split(jd),ue(r,r,[parseFloat(a[0]),parseFloat(a[1]||a[0])]);break;case"rotate":a=Y(a).split(jd),le(r,r,parseFloat(a[0]));break;case"skew":a=Y(a).split(jd),console.warn("Skew transform is not supported yet");break;case"matrix":a=Y(a).split(jd),r[0]=parseFloat(a[0]),r[1]=parseFloat(a[1]),r[2]=parseFloat(a[2]),r[3]=parseFloat(a[3]),r[4]=parseFloat(a[4]),r[5]=parseFloat(a[5])}}e.setLocalTransform(r)}}(t,e),x(i,function(t){var e=t.getAttribute("style"),n={};if(!e)return n;var r,i={};for(ef.lastIndex=0;null!=(r=ef.exec(e));)i[r[1]]=r[2];for(var o in Zd)Zd.hasOwnProperty(o)&&null!=i[o]&&(n[Zd[o]]=i[o]);return n}(t)),!r))for(var a in Zd)if(Zd.hasOwnProperty(a)){var s=t.getAttribute(a);null!=s&&(i[Zd[a]]=s)}var l=o?"textFill":"fill",u=o?"textStroke":"stroke";e.style=e.style||new Nn;var c=e.style;null!=i.fill&&c.set(l,Qd(i.fill,n)),null!=i.stroke&&c.set(u,Qd(i.stroke,n)),k(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],function(t){null!=i[t]&&c.set("lineWidth"===t&&o?"textStrokeWidth":t,parseFloat(i[t]))}),i.textBaseline&&"auto"!==i.textBaseline||(i.textBaseline="alphabetic"),"alphabetic"===i.textBaseline&&(i.textBaseline="bottom"),"start"===i.textAlign&&(i.textAlign="left"),"end"===i.textAlign&&(i.textAlign="right"),k(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign","textBaseline"],function(t){null!=i[t]&&c.set(t,i[t])}),i.lineDash&&(e.style.lineDash=Y(i.lineDash).split(jd)),c[u]&&"none"!==c[u]&&(e[u]=!0),e.__inheritedStyle=i}var Jd=/url\(\s*#(.*?)\)/;function Qd(t,e){var n=e&&t&&t.match(Jd);return n?e[Y(n[1])]:t}var tf=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.e,]*)\)/g,ef=/([^\s:;]+)\s*:\s*([^:;]+)/g;function nf(t,e,n){var r=Math.min(e/t.width,n/t.height);return{scale:[r,r],position:[-(t.x+t.width/2)*r+e/2,-(t.y+t.height/2)*r+n/2]}}var rf=Q(),of=function(t){return rf.get(t)},af={geoJSON:function(t){var e=t.source;t.geoJSON=N(e)?"undefined"!=typeof JSON&&JSON.parse?JSON.parse(e):new Function("return ("+e+");")():e},svg:function(t){t.svgXML=Gd(t.source)}},sf=X,lf=k,uf=L,cf=B,df=gu.parseClassType,ff={PROCESSOR:{FILTER:1e3,SERIES_FILTER:800,STATISTIC:5e3},VISUAL:{LAYOUT:1e3,PROGRESSIVE_LAYOUT:1100,GLOBAL:2e3,CHART:3e3,POST_CHART_LAYOUT:3500,COMPONENT:4e3,BRUSH:5e3}},hf="__flagInMainProcess",pf="__optionUpdated",gf=/^[a-zA-Z0-9_]+$/;function mf(t,e){return function(n,r,i){!e&&this._disposed||(n=n&&n.toLowerCase(),kt.prototype[t].call(this,n,r,i))}}function vf(){kt.call(this)}function yf(t,e,n){n=n||{},"string"==typeof e&&(e=Wf[e]),this._dom=t;var r=this._zr=yi(t,{renderer:n.renderer||"canvas",devicePixelRatio:n.devicePixelRatio,width:n.width,height:n.height});this._throttledZrFlush=fd(P(r.flush,r),17),(e=m(e))&&fc(e,!0),this._theme=e,this._chartsViews=[],this._chartsMap={},this._componentsViews=[],this._componentsMap={},this._coordSysMgr=new Uu;var i=this._api=function(t){var e=t._coordSysMgr;return x(new ju(t),{getCoordinateSystems:P(e.getCoordinateSystems,e),getComponentByElement:function(e){for(;e;){var n=e.__ecComponentInfo;if(null!=n)return t._model.getComponent(n.mainType,n.index);e=e.parent}}})}(this);function o(t,e){return t.__prio-e.__prio}Dn(Hf,o),Dn(zf,o),this._scheduler=new yd(this,i,zf,Hf),kt.call(this,this._ecEventProcessor=new Lf),this._messageCenter=new vf,this._initEvents(),this.resize=P(this.resize,this),this._pendingActions=[],r.animation.on("frame",this._onframe,this),function(t,e){t.on("rendered",function(){e.trigger("rendered"),!t.animation.isFinished()||e[pf]||e._scheduler.unfinished||e._pendingActions.length||e.trigger("finished")})}(r,this),Z(this)}vf.prototype.on=mf("on",!0),vf.prototype.off=mf("off",!0),vf.prototype.one=mf("one",!0),M(vf,kt);var xf=yf.prototype;function bf(t,e,n){if(!this._disposed){var r,i=this._model,o=this._coordSysMgr.getCoordinateSystems();e=Bi(i,e);for(var a=0;a<o.length;a++){var s=o[a];if(s[t]&&null!=(r=s[t](i,e,n)))return r}}}xf._onframe=function(){if(!this._disposed){var t=this._scheduler;if(this[pf]){var e=this[pf].silent;this[hf]=!0,wf(this),_f.update.call(this),this[hf]=!1,this[pf]=!1,Tf.call(this,e),kf.call(this,e)}else if(t.unfinished){var n=1,r=this._model;t.unfinished=!1;do{var i=+new Date;t.performSeriesTasks(r),t.performDataProcessorTasks(r),Cf(this,r),t.performVisualTasks(r),Of(this,this._model,0,"remain"),n-=+new Date-i}while(0<n&&t.unfinished);t.unfinished||this._zr.flush()}}},xf.getDom=function(){return this._dom},xf.getZr=function(){return this._zr},xf.setOption=function(t,e,n){if(!this._disposed){var r;if(cf(e)&&(n=e.lazyUpdate,r=e.silent,e=e.notMerge),this[hf]=!0,!this._model||e){var i=new Ku(this._api),o=this._theme,a=this._model=new Vu;a.scheduler=this._scheduler,a.init(null,null,o,i)}this._model.setOption(t,Vf),n?(this[pf]={silent:r},this[hf]=!1):(wf(this),_f.update.call(this),this._zr.flush(),this[pf]=!1,this[hf]=!1,Tf.call(this,r),kf.call(this,r))}},xf.setTheme=function(){console.error("ECharts#setTheme() is DEPRECATED in ECharts 3.0")},xf.getModel=function(){return this._model},xf.getOption=function(){return this._model&&this._model.getOption()},xf.getWidth=function(){return this._zr.getWidth()},xf.getHeight=function(){return this._zr.getHeight()},xf.getDevicePixelRatio=function(){return this._zr.painter.dpr||window.devicePixelRatio||1},xf.getRenderedCanvas=function(t){if(i.canvasSupported)return(t=t||{}).pixelRatio=t.pixelRatio||1,t.backgroundColor=t.backgroundColor||this._model.get("backgroundColor"),this._zr.painter.getRenderedCanvas(t)},xf.getSvgDataURL=function(){if(i.svgSupported){var t=this._zr;return k(t.storage.getDisplayList(),function(t){t.stopAnimation(!0)}),t.painter.toDataURL()}},xf.getDataURL=function(t){if(!this._disposed){var e=(t=t||{}).excludeComponents,n=this._model,r=[],i=this;lf(e,function(t){n.eachComponent({mainType:t},function(t){var e=i._componentsMap[t.__viewId];e.group.ignore||(r.push(e),e.group.ignore=!0)})});var o="svg"===this._zr.painter.getType()?this.getSvgDataURL():this.getRenderedCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return lf(r,function(t){t.group.ignore=!1}),o}},xf.getConnectedDataURL=function(t){if(!this._disposed&&i.canvasSupported){var e="svg"===t.type,n=this.group,r=Math.min,o=Math.max;if(Uf[n]){var a=1/0,s=1/0,l=-1/0,u=-1/0,c=[],d=t&&t.pixelRatio||1;k(Gf,function(i,d){if(i.group===n){var f=e?i.getZr().painter.getSvgDom().innerHTML:i.getRenderedCanvas(m(t)),h=i.getDom().getBoundingClientRect();a=r(h.left,a),s=r(h.top,s),l=o(h.right,l),u=o(h.bottom,u),c.push({dom:f,left:h.left,top:h.top})}});var f=(l*=d)-(a*=d),h=(u*=d)-(s*=d),p=_(),g=yi(p,{renderer:e?"svg":"canvas"});if(g.resize({width:f,height:h}),e){var v="";return lf(c,function(t){v+='<g transform="translate('+(t.left-a)+","+(t.top-s)+')">'+t.dom+"</g>"}),g.painter.getSvgRoot().innerHTML=v,t.connectedBackgroundColor&&g.painter.setBackgroundColor(t.connectedBackgroundColor),g.refreshImmediately(),g.painter.toDataURL()}return t.connectedBackgroundColor&&g.add(new Ua({shape:{x:0,y:0,width:f,height:h},style:{fill:t.connectedBackgroundColor}})),lf(c,function(t){var e=new Wr({style:{x:t.left*d-a,y:t.top*d-s,image:t.dom}});g.add(e)}),g.refreshImmediately(),p.toDataURL("image/"+(t&&t.type||"png"))}return this.getDataURL(t)}},xf.convertToPixel=E(bf,"convertToPixel"),xf.convertFromPixel=E(bf,"convertFromPixel"),xf.containPixel=function(t,e){var n;if(!this._disposed)return k(t=Bi(this._model,t),function(t,r){0<=r.indexOf("Models")&&k(t,function(t){var i=t.coordinateSystem;if(i&&i.containPoint)n|=!!i.containPoint(e);else if("seriesModels"===r){var o=this._chartsMap[t.__viewId];o&&o.containPoint&&(n|=o.containPoint(e,t))}},this)},this),!!n},xf.getVisual=function(t,e){var n=(t=Bi(this._model,t,{defaultMainType:"series"})).seriesModel.getData(),r=t.hasOwnProperty("dataIndexInside")?t.dataIndexInside:t.hasOwnProperty("dataIndex")?n.indexOfRawIndex(t.dataIndex):null;return null!=r?n.getItemVisual(r,e):n.getVisual(e)},xf.getViewOfComponentModel=function(t){return this._componentsMap[t.__viewId]},xf.getViewOfSeriesModel=function(t){return this._chartsMap[t.__viewId]};var _f={prepareAndUpdate:function(t){wf(this),_f.update.call(this,t)},update:function(t){var e=this._model,n=this._api,r=this._zr,o=this._coordSysMgr,a=this._scheduler;if(e){a.restoreData(e,t),a.performSeriesTasks(e),o.create(e,n),a.performDataProcessorTasks(e,t),Cf(this,e),o.update(e,n),If(e),a.performVisualTasks(e,t),Df(this,e,n,t);var s=e.get("backgroundColor")||"transparent";if(i.canvasSupported)r.setBackgroundColor(s);else{var l=Ve(s);s=Xe(l,"rgb"),0===l[3]&&(s="transparent")}Pf(e,n)}},updateTransform:function(t){var e=this._model,n=this,r=this._api;if(e){var i=[];e.eachComponent(function(o,a){var s=n.getViewOfComponentModel(a);if(s&&s.__alive)if(s.updateTransform){var l=s.updateTransform(a,e,r,t);l&&l.update&&i.push(s)}else i.push(s)});var o=Q();e.eachSeries(function(i){var a=n._chartsMap[i.__viewId];if(a.updateTransform){var s=a.updateTransform(i,e,r,t);s&&s.update&&o.set(i.uid,1)}else o.set(i.uid,1)}),If(e),this._scheduler.performVisualTasks(e,t,{setDirty:!0,dirtyMap:o}),Of(n,e,0,t,o),Pf(e,this._api)}},updateView:function(t){var e=this._model;e&&(nd.markUpdateMethod(t,"updateView"),If(e),this._scheduler.performVisualTasks(e,t,{setDirty:!0}),Df(this,this._model,this._api,t),Pf(e,this._api))},updateVisual:function(t){_f.update.call(this,t)},updateLayout:function(t){_f.update.call(this,t)}};function wf(t){var e=t._model,n=t._scheduler;n.restorePipelines(e),n.prepareStageTasks(),Af(t,"component",e,n),Af(t,"chart",e,n),n.plan()}function Sf(t,e,n,r,i){var o=t._model;if(r){var a={};a[r+"Id"]=n[r+"Id"],a[r+"Index"]=n[r+"Index"],a[r+"Name"]=n[r+"Name"];var s={mainType:r,query:a};i&&(s.subType=i);var l=n.excludeSeriesId;null!=l&&(l=Q(Ti(l))),o&&o.eachComponent(s,function(e){l&&null!=l.get(e.id)||u(t["series"===r?"_chartsMap":"_componentsMap"][e.__viewId])},t)}else lf(t._componentsViews.concat(t._chartsViews),u);function u(r){r&&r.__alive&&r[e]&&r[e](r.__model,o,t._api,n)}}function Cf(t,e){var n=t._chartsMap,r=t._scheduler;e.eachSeries(function(t){r.updateStreamModes(t,n[t.__viewId])})}function Mf(t,e){var n=t.type,r=t.escapeConnect,i=Nf[n],o=i.actionInfo,a=(o.update||"update").split(":"),s=a.pop();a=null!=a[0]&&df(a[0]),this[hf]=!0;var l=[t],u=!1;t.batch&&(u=!0,l=A(t.batch,function(e){return(e=b(x({},e),t)).batch=null,e}));var c,d=[],f="highlight"===n||"downplay"===n;lf(l,function(t){(c=(c=i.action(t,this._model,this._api))||x({},t)).type=o.event||c.type,d.push(c),f?Sf(this,s,t,"series"):a&&Sf(this,s,t,a.main,a.sub)},this),"none"===s||f||a||(this[pf]?(wf(this),_f.update.call(this,t),this[pf]=!1):_f[s].call(this,t)),c=u?{type:o.event||n,escapeConnect:r,batch:d}:d[0],this[hf]=!1,e||this._messageCenter.trigger(c.type,c)}function Tf(t){for(var e=this._pendingActions;e.length;){var n=e.shift();Mf.call(this,n,t)}}function kf(t){t||this.trigger("updated")}function Af(t,e,n,r){for(var i="component"===e,o=i?t._componentsViews:t._chartsViews,a=i?t._componentsMap:t._chartsMap,s=t._zr,l=t._api,u=0;u<o.length;u++)o[u].__alive=!1;function c(t){var e="_ec_"+t.id+"_"+t.type,u=a[e];if(!u){var c=df(t.type);(u=new(i?Kc.getClass(c.main,c.sub):nd.getClass(c.sub))).init(n,l),a[e]=u,o.push(u),s.add(u.group)}t.__viewId=u.__id=e,u.__alive=!0,u.__model=t,u.group.__ecComponentInfo={mainType:t.mainType,index:t.componentIndex},i||r.prepareView(u,t,n,l)}for(i?n.eachComponent(function(t,e){"series"!==t&&c(e)}):n.eachSeries(c),u=0;u<o.length;){var d=o[u];d.__alive?u++:(i||d.renderTask.dispose(),s.remove(d.group),d.dispose(n,l),o.splice(u,1),delete a[d.__id],d.__id=d.group.__ecComponentInfo=null)}}function If(t){t.clearColorPalette(),t.eachSeries(function(t){t.clearColorPalette()})}function Df(t,e,n,r){!function(t,e,n,r,i){lf(t._componentsViews,function(t){var i=t.__model;t.render(i,e,n,r),Rf(i,t)})}(t,e,n,r),lf(t._chartsViews,function(t){t.__alive=!1}),Of(t,e,0,r),lf(t._chartsViews,function(t){t.__alive||t.remove(e,n)})}function Of(t,e,n,r,o){var a,s=t._scheduler;e.eachSeries(function(e){var n=t._chartsMap[e.__viewId];n.__alive=!0;var i=n.renderTask;s.updatePayload(i,r),o&&o.get(e.uid)&&i.dirty(),a|=i.perform(s.getPerformArgs(i)),n.group.silent=!!e.get("silent"),Rf(e,n),function(t,e){var n=t.get("blendMode")||null;e.group.traverse(function(t){t.isGroup||t.style.blend!==n&&t.setStyle("blend",n),t.eachPendingDisplayable&&t.eachPendingDisplayable(function(t){t.setStyle("blend",n)})})}(e,n)}),s.unfinished|=a,function(t,e){var n=0;t._zr.storage.traverse(function(t){n++}),n>e.get("hoverLayerThreshold")&&!i.node&&e.eachSeries(function(e){if(!e.preventUsingHoverLayer){var n=t._chartsMap[e.__viewId];n.__alive&&n.group.traverse(function(t){t.useHoverLayer=!0})}})}(t,e),function(t,e){var n=e.getModel("aria");if(n.get("show"))if(n.get("description"))t.setAttribute("aria-label",n.get("description"));else{var r=0;e.eachSeries(function(t,e){++r},this);var i,o=n.get("data.maxCount")||10,a=n.get("series.maxCount")||10,s=Math.min(r,a);if(!(r<1)){var l=function(){var t=e.getModel("title").option;return t&&t.length&&(t=t[0]),t&&t.text}();i=l?c(d("general.withTitle"),{title:l}):d("general.withoutTitle");var u=[];i+=c(d(1<r?"series.multiple.prefix":"series.single.prefix"),{seriesCount:r}),e.eachSeries(function(t,e){if(e<s){var n,i=t.get("name"),a="series."+(1<r?"multiple":"single")+".";n=c(n=d(i?a+"withName":a+"withoutName"),{seriesId:t.seriesIndex,seriesName:t.get("name"),seriesType:function(t){return md.series.typeNames[t]||"自定义图"}(t.subType)});var l=t.getData();(window.data=l).count()>o?n+=c(d("data.partialData"),{displayCnt:o}):n+=d("data.allData");for(var f=[],h=0;h<l.count();h++)if(h<o){var p=l.getName(h),g=Mc(l,h);f.push(c(d(p?"data.withName":"data.withoutName"),{name:p,value:g}))}n+=f.join(d("data.separator.middle"))+d("data.separator.end"),u.push(n)}}),i+=u.join(d("series.multiple.separator.middle"))+d("series.multiple.separator.end"),t.setAttribute("aria-label",i)}}function c(t,e){if("string"!=typeof t)return t;var n=t;return k(e,function(t,e){n=n.replace(new RegExp("\\{\\s*"+e+"\\s*\\}","g"),t)}),n}function d(t){var e=n.get(t);if(null!=e)return e;for(var r=t.split("."),i=md.aria,o=0;o<r.length;++o)i=i[r[o]];return i}}(t._zr.dom,e)}function Pf(t,e){lf(Ff,function(n){n(t,e)})}xf.resize=function(t){if(!this._disposed){this._zr.resize(t);var e=this._model;if(this._loadingFX&&this._loadingFX.resize(),e){var n=e.resetOption("media"),r=t&&t.silent;this[hf]=!0,n&&wf(this),_f.update.call(this),this[hf]=!1,Tf.call(this,r),kf.call(this,r)}}},xf.showLoading=function(t,e){if(!this._disposed&&(cf(t)&&(e=t,t=""),t=t||"default",this.hideLoading(),jf[t])){var n=jf[t](this._api,e),r=this._zr;this._loadingFX=n,r.add(n)}},xf.hideLoading=function(){this._disposed||(this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null)},xf.makeActionFromEvent=function(t){var e=x({},t);return e.type=Bf[t.type],e},xf.dispatchAction=function(t,e){this._disposed||(cf(e)||(e={silent:!!e}),Nf[t.type]&&this._model&&(this[hf]?this._pendingActions.push(t):(Mf.call(this,t,e.silent),e.flush?this._zr.flush(!0):!1!==e.flush&&i.browser.weChat&&this._throttledZrFlush(),Tf.call(this,e.silent),kf.call(this,e.silent))))},xf.appendData=function(t){if(!this._disposed){var e=t.seriesIndex;this.getModel().getSeriesByIndex(e).appendData(t),this._scheduler.unfinished=!0}},xf.on=mf("on",!1),xf.off=mf("off",!1),xf.one=mf("one",!1);var Ef=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];function Rf(t,e){var n=t.get("z"),r=t.get("zlevel");e.group.traverse(function(t){"group"!==t.type&&(null!=n&&(t.z=n),null!=r&&(t.zlevel=r))})}function Lf(){}xf._initEvents=function(){lf(Ef,function(t){function e(e){var n,r=this.getModel(),i=e.target;if("globalout"===t)n={};else if(i&&null!=i.dataIndex){var o=i.dataModel||r.getSeriesByIndex(i.seriesIndex);n=o&&o.getDataParams(i.dataIndex,i.dataType,i)||{}}else i&&i.eventData&&(n=x({},i.eventData));if(n){var a=n.componentType,s=n.componentIndex;"markLine"!==a&&"markPoint"!==a&&"markArea"!==a||(a="series",s=n.seriesIndex);var l=a&&null!=s&&r.getComponent(a,s),u=l&&this["series"===l.mainType?"_chartsMap":"_componentsMap"][l.__viewId];n.event=e,n.type=t,this._ecEventProcessor.eventInfo={targetEl:i,packedEvent:n,model:l,view:u},this.trigger(t,n)}}e.zrEventfulCallAtLast=!0,this._zr.on(t,e,this)},this),lf(Bf,function(t,e){this._messageCenter.on(e,function(t){this.trigger(e,t)},this)},this)},xf.isDisposed=function(){return this._disposed},xf.clear=function(){this._disposed||this.setOption({series:[]},!0)},xf.dispose=function(){if(!this._disposed){this._disposed=!0,Vi(this.getDom(),Yf,"");var t=this._api,e=this._model;lf(this._componentsViews,function(n){n.dispose(e,t)}),lf(this._chartsViews,function(n){n.dispose(e,t)}),this._zr.dispose(),delete Gf[this.id]}},M(yf,kt),Lf.prototype={constructor:Lf,normalizeQuery:function(t){var e={},n={},r={};if(N(t)){var i=df(t);e.mainType=i.main||null,e.subType=i.sub||null}else{var o=["Index","Name","Id"],a={name:1,dataIndex:1,dataType:1};k(t,function(t,i){for(var s=!1,l=0;l<o.length;l++){var u=o[l],c=i.lastIndexOf(u);if(0<c&&c===i.length-u.length){var d=i.slice(0,c);"data"!==d&&(e.mainType=d,e[u.toLowerCase()]=t,s=!0)}}a.hasOwnProperty(i)&&(n[i]=t,s=!0),s||(r[i]=t)})}return{cptQuery:e,dataQuery:n,otherQuery:r}},filter:function(t,e,n){var r=this.eventInfo;if(!r)return!0;var i=r.targetEl,o=r.packedEvent,a=r.model,s=r.view;if(!a||!s)return!0;var l=e.cptQuery,u=e.dataQuery;return c(l,a,"mainType")&&c(l,a,"subType")&&c(l,a,"index","componentIndex")&&c(l,a,"name")&&c(l,a,"id")&&c(u,o,"name")&&c(u,o,"dataIndex")&&c(u,o,"dataType")&&(!s.filterForExposedEvent||s.filterForExposedEvent(t,e.otherQuery,i,o));function c(t,e,n,r){return null==t[n]||e[r||n]===t[n]}},afterTrigger:function(){this.eventInfo=null}};var Nf={},Bf={},zf=[],Vf=[],Ff=[],Hf=[],Wf={},jf={},Gf={},Uf={},qf=new Date-0,Xf=new Date-0,Yf="_echarts_instance_";function $f(t){Uf[t]=!1}var Zf=$f;function Kf(t){return Gf[function(t,e){return t.getAttribute?t.getAttribute(e):t[e]}(t,Yf)]}function Jf(t,e){Wf[t]=e}function Qf(t){Vf.push(t)}function th(t,e){oh(zf,t,e,1e3)}function eh(t,e,n){"function"==typeof e&&(n=e,e="");var r=cf(t)?t.type:[t,t={event:e}][0];t.event=(t.event||r).toLowerCase(),e=t.event,sf(gf.test(r)&&gf.test(e)),Nf[r]||(Nf[r]={action:n,actionInfo:t}),Bf[e]=r}function nh(t,e){Uu.register(t,e)}function rh(t,e){oh(Hf,t,e,1e3,"layout")}function ih(t,e){oh(Hf,t,e,3e3,"visual")}function oh(t,e,n,r,i){(uf(e)||cf(e))&&(n=e,e=r);var o=yd.wrapStageHandler(n,i);return o.__prio=e,o.__raw=n,t.push(o),o}function ah(t,e){jf[t]=e}function sh(t){return gu.extend(t)}function lh(t){return Kc.extend(t)}function uh(t){return jc.extend(t)}function ch(t){return nd.extend(t)}function dh(t){return t}function fh(t,e,n,r,i){this._old=t,this._new=e,this._oldKeyGetter=n||dh,this._newKeyGetter=r||dh,this.context=i}function hh(t,e,n,r,i){for(var o=0;o<t.length;o++){var a="_ec_"+i[r](t[o],o),s=e[a];null==s?(n.push(a),e[a]=o):(s.length||(e[a]=s=[s]),s.push(o))}}ih(2e3,gd),Qf(fc),th(900,function(t){var e=Q();t.eachSeries(function(t){var n=t.get("stack");if(n){var r=e.get(n)||e.set(n,[]),i=t.getData(),o={stackResultDimension:i.getCalculationInfo("stackResultDimension"),stackedOverDimension:i.getCalculationInfo("stackedOverDimension"),stackedDimension:i.getCalculationInfo("stackedDimension"),stackedByDimension:i.getCalculationInfo("stackedByDimension"),isStackedByIndex:i.getCalculationInfo("isStackedByIndex"),data:i,seriesModel:t};if(!o.stackedDimension||!o.isStackedByIndex&&!o.stackedByDimension)return;r.length&&i.setCalculationInfo("stackedOnSeries",r[r.length-1].seriesModel),r.push(o)}}),e.each(hc)}),ah("default",function(t,e){b(e=e||{},{text:"loading",textColor:"#000",fontSize:"12px",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#c23531",spinnerRadius:10,lineWidth:5,zlevel:0});var n=new Cn,r=new Ua({style:{fill:e.maskColor},zlevel:e.zlevel,z:1e4});n.add(r);var i=e.fontSize+" sans-serif",o=new Ua({style:{fill:"none",text:e.text,font:i,textPosition:"right",textDistance:10,textFill:e.textColor},zlevel:e.zlevel,z:10001});if(n.add(o),e.showSpinner){var a=new Ja({shape:{startAngle:-vd/2,endAngle:-vd/2+.1,r:e.spinnerRadius},style:{stroke:e.color,lineCap:"round",lineWidth:e.lineWidth},zlevel:e.zlevel,z:10001});a.animateShape(!0).when(1e3,{endAngle:3*vd/2}).start("circularInOut"),a.animateShape(!0).when(1e3,{startAngle:3*vd/2}).delay(300).start("circularInOut"),n.add(a)}return n.resize=function(){var n=rr(e.text,i),s=e.showSpinner?e.spinnerRadius:0,l=(t.getWidth()-2*s-(e.showSpinner&&n?10:0)-n)/2-(e.showSpinner?0:n/2),u=t.getHeight()/2;e.showSpinner&&a.setShape({cx:l,cy:u}),o.setShape({x:l-s,y:u-s,width:2*s,height:2*s}),r.setShape({x:0,y:0,width:t.getWidth(),height:t.getHeight()})},n.resize(),n}),eh({type:"highlight",event:"highlight",update:"highlight"},et),eh({type:"downplay",event:"downplay",update:"downplay"},et),Jf("light",zd),Jf("dark",Hd),fh.prototype={constructor:fh,add:function(t){return this._add=t,this},update:function(t){return this._update=t,this},remove:function(t){return this._remove=t,this},execute:function(){var t=this._old,e=this._new,n={},r=[],i=[];for(hh(t,{},r,"_oldKeyGetter",this),hh(e,n,i,"_newKeyGetter",this),o=0;o<t.length;o++)null!=(s=n[a=r[o]])?((u=s.length)?(1===u&&(n[a]=null),s=s.shift()):n[a]=null,this._update&&this._update(s,o)):this._remove&&this._remove(o);for(var o=0;o<i.length;o++){var a=i[o];if(n.hasOwnProperty(a)){var s;if(null==(s=n[a]))continue;if(s.length)for(var l=0,u=s.length;l<u;l++)this._add&&this._add(s[l]);else this._add&&this._add(s)}}}};var ph=Q(["tooltip","label","itemName","itemId","seriesName"]);function gh(t,e){return t.hasOwnProperty(e)||(t[e]=[]),t[e]}function mh(t){return"category"===t?"ordinal":"time"===t?"time":"float"}function vh(t){null!=t&&x(this,t),this.otherDims={}}var yh=B,xh="undefined",bh={float:typeof Float64Array==xh?Array:Float64Array,int:typeof Int32Array==xh?Array:Int32Array,ordinal:Array,number:Array,time:Array},_h=typeof Uint32Array==xh?Array:Uint32Array,wh=typeof Int32Array==xh?Array:Int32Array,Sh=typeof Uint16Array==xh?Array:Uint16Array;function Ch(t){return 65535<t._rawCount?_h:Sh}var Mh=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_rawData","_chunkSize","_chunkCount","_dimValueGetter","_count","_rawCount","_nameDimIdx","_idDimIdx"],Th=["_extent","_approximateExtent","_rawExtent"];function kh(t,e){k(Mh.concat(e.__wrappedMethods||[]),function(n){e.hasOwnProperty(n)&&(t[n]=e[n])}),t.__wrappedMethods=e.__wrappedMethods,k(Th,function(n){t[n]=m(e[n])}),t._calculationInfo=x(e._calculationInfo)}var Ah=function(t,e){t=t||["x","y"];for(var n={},r=[],i={},o=0;o<t.length;o++){var a=t[o];N(a)?a=new vh({name:a}):a instanceof vh||(a=new vh(a));var s=a.name;a.type=a.type||"float",a.coordDim||(a.coordDim=s,a.coordDimIndex=0),a.otherDims=a.otherDims||{},r.push(s),(n[s]=a).index=o,a.createInvertedIndices&&(i[s]=[])}this.dimensions=r,this._dimensionInfos=n,this.hostModel=e,this._indices=null,this._count=0,this._rawCount=0,this._storage={},this._nameList=[],this._idList=[],this._optionModels=[],this._visual={},this._layout={},this._itemVisuals=[],this.hasItemVisual={},this._itemLayouts=[],this._graphicEls=[],this._chunkSize=1e5,this._chunkCount=0,this._rawExtent={},this._extent={},this._approximateExtent={},this._dimensionsSummary=function(t){var e={},n=e.encode={},r=Q(),i=[],o=[],a=e.userOutput={dimensionNames:t.dimensions.slice(),encode:{}};k(t.dimensions,function(e){var s=t.getDimensionInfo(e),l=s.coordDim;if(l){var u=s.coordDimIndex;gh(n,l)[u]=e,s.isExtraCoord||(r.set(l,1),function(t){return!("ordinal"===t||"time"===t)}(s.type)&&(i[0]=e),gh(a.encode,l)[u]=s.index),s.defaultTooltip&&o.push(e)}ph.each(function(t,e){var r=gh(n,e),i=s.otherDims[e];null!=i&&!1!==i&&(r[i]=s.name)})});var s=[],l={};r.each(function(t,e){var r=n[e];l[e]=r[0],s=s.concat(r)}),e.dataDimsOnCoord=s,e.encodeFirstDimNotExtra=l;var u=n.label;u&&u.length&&(i=u.slice());var c=n.tooltip;return c&&c.length?o=c.slice():o.length||(o=i.slice()),n.defaultedLabel=i,n.defaultedTooltip=o,e}(this),this._invertedIndicesMap=i,this._calculationInfo={},this.userOutput=this._dimensionsSummary.userOutput},Ih=Ah.prototype;function Dh(t,e,n,r,i){var o=bh[e.type],a=r-1,s=e.name,l=t[s][a];if(l&&l.length<n){for(var u=new o(Math.min(i-a*n,n)),c=0;c<l.length;c++)u[c]=l[c];t[s][a]=u}for(var d=r*n;d<i;d+=n)t[s].push(new o(Math.min(i-d,n)))}function Oh(t){var e=t._invertedIndicesMap;k(e,function(n,r){var i=t._dimensionInfos[r].ordinalMeta;if(i){n=e[r]=new wh(i.categories.length);for(var o=0;o<n.length;o++)n[o]=-1;for(o=0;o<t._count;o++)n[t.get(r,o)]=o}})}function Ph(t,e,n){var r;if(null!=e){var i=t._chunkSize,o=Math.floor(n/i),a=t.dimensions[e],s=t._storage[a][o];if(s){r=s[n%i];var l=t._dimensionInfos[a].ordinalMeta;l&&l.categories.length&&(r=l.categories[r])}}return r}function Eh(t){return t}function Rh(t){return t<this._count&&0<=t?this._indices[t]:-1}function Lh(t,e){var n=t._idList[e];return null==n&&(n=Ph(t,t._idDimIdx,e)),null==n&&(n="e\0\0"+e),n}function Nh(t){return R(t)||(t=[t]),t}function Bh(t,e){var n=t.dimensions,r=new Ah(A(n,t.getDimensionInfo,t),t.hostModel);kh(r,t);for(var i=r._storage={},o=t._storage,a=0;a<n.length;a++){var s=n[a];o[s]&&(0<=S(e,s)?(i[s]=zh(o[s]),r._rawExtent[s]=[1/0,-1/0],r._extent[s]=null):i[s]=o[s])}return r}function zh(t){for(var e,n,r=new Array(t.length),i=0;i<t.length;i++)r[i]=(n=void 0,(n=(e=t[i]).constructor)===Array?e.slice():new n(e));return r}function Vh(t){t.seriesIndex=this.seriesIndex,t.dataIndex=this.dataIndex,t.dataType=this.dataType}function Fh(t,e,n){Iu.isInstance(e)||(e=Iu.seriesDataToSource(e)),n=n||{},t=(t||[]).slice();for(var r=(n.dimsDef||[]).slice(),i=Q(),o=Q(),a=[],s=function(t,e,n,r){var i=Math.max(t.dimensionsDetectCount||1,e.length,n.length,r||0);return k(e,function(t){var e=t.dimsDef;e&&(i=Math.max(i,e.length))}),i}(e,t,r,n.dimCount),l=0;l<s;l++){var u=r[l]=x({},B(r[l])?r[l]:{name:r[l]}),c=u.name,d=a[l]=new vh;null!=c&&null==i.get(c)&&(d.name=d.displayName=c,i.set(c,l)),null!=u.type&&(d.type=u.type),null!=u.displayName&&(d.displayName=u.displayName)}var f=n.encodeDef;!f&&n.encodeDefaulter&&(f=n.encodeDefaulter(e,s)),(f=Q(f)).each(function(t,e){if(1===(t=Ti(t).slice()).length&&!N(t[0])&&t[0]<0)f.set(e,!1);else{var n=f.set(e,[]);k(t,function(t,r){N(t)&&(t=i.get(t)),null!=t&&t<s&&(n[r]=t,p(a[t],e,r))})}});var h=0;function p(t,e,n){null!=ph.get(e)?t.otherDims[e]=n:(t.coordDim=e,t.coordDimIndex=n,o.set(e,!0))}k(t,function(t,e){var n,r,i;if(N(t))n=t,t={};else{n=t.name;var o=t.ordinalMeta;t.ordinalMeta=null,(t=m(t)).ordinalMeta=o,r=t.dimsDef,i=t.otherDims,t.name=t.coordDim=t.coordDimIndex=t.dimsDef=t.otherDims=null}if(!1!==(s=f.get(n))){var s;if(!(s=Ti(s)).length)for(var l=0;l<(r&&r.length||1);l++){for(;h<a.length&&null!=a[h].coordDim;)h++;h<a.length&&s.push(h++)}k(s,function(e,o){var s=a[e];if(p(b(s,t),n,o),null==s.name&&r){var l=r[o];B(l)||(l={name:l}),s.name=s.displayName=l.name,s.defaultTooltip=l.defaultTooltip}i&&b(s.otherDims,i)})}});var g=n.generateCoord,v=n.generateCoordCount,y=null!=v;v=g?v||1:0;for(var _,w=g||"value",S=0;S<s;S++)null==(d=a[S]=a[S]||new vh).coordDim&&(d.coordDim=Hh(w,o,y),d.coordDimIndex=0,(!g||v<=0)&&(d.isExtraCoord=!0),v--),null==d.name&&(d.name=Hh(d.coordDim,i)),null==d.type&&(1===Bu((_=e).data,_.sourceFormat,_.seriesLayoutBy,_.dimensionsDefine,_.startIndex,S)||d.isExtraCoord&&(null!=d.otherDims.itemName||null!=d.otherDims.seriesName))&&(d.type="ordinal");return a}function Hh(t,e,n){if(n||null!=e.get(t)){for(var r=0;null!=e.get(t+r);)r++;t+=r}return e.set(t,!0),t}Ih.type="list",Ih.hasItemOption=!0,Ih.getDimension=function(t){return"number"!=typeof t&&(isNaN(t)||this._dimensionInfos.hasOwnProperty(t))||(t=this.dimensions[t]),t},Ih.getDimensionInfo=function(t){return this._dimensionInfos[this.getDimension(t)]},Ih.getDimensionsOnCoord=function(){return this._dimensionsSummary.dataDimsOnCoord.slice()},Ih.mapDimension=function(t,e){var n=this._dimensionsSummary;if(null==e)return n.encodeFirstDimNotExtra[t];var r=n.encode[t];return!0===e?(r||[]).slice():r&&r[e]},Ih.initData=function(t,e,n){(Iu.isInstance(t)||T(t))&&(t=new pc(t,this.dimensions.length)),this._rawData=t,this._storage={},this._indices=null,this._nameList=e||[],this._idList=[],this._nameRepeatCount={},n||(this.hasItemOption=!1),this.defaultDimValueGetter=wc[this._rawData.getSource().sourceFormat],this._dimValueGetter=n=n||this.defaultDimValueGetter,this._dimValueGetterArrayRows=wc.arrayRows,this._rawExtent={},this._initDataFromProvider(0,t.count()),t.pure&&(this.hasItemOption=!1)},Ih.getProvider=function(){return this._rawData},Ih.appendData=function(t){var e=this._rawData,n=this.count();e.appendData(t);var r=e.count();e.persistent||(r+=n),this._initDataFromProvider(n,r)},Ih.appendValues=function(t,e){for(var n=this._chunkSize,r=this._storage,i=this.dimensions,o=i.length,a=this._rawExtent,s=this.count(),l=s+Math.max(t.length,e?e.length:0),u=this._chunkCount,c=0;c<o;c++)a[v=i[c]]||(a[v]=[1/0,-1/0]),r[v]||(r[v]=[]),Dh(r,this._dimensionInfos[v],n,u,l),this._chunkCount=r[v].length;for(var d=new Array(o),f=s;f<l;f++){for(var h=f-s,p=Math.floor(f/n),g=f%n,m=0;m<o;m++){var v=i[m],y=this._dimValueGetterArrayRows(t[h]||d,v,h,m);r[v][p][g]=y;var x=a[v];y<x[0]&&(x[0]=y),y>x[1]&&(x[1]=y)}e&&(this._nameList[f]=e[h])}this._rawCount=this._count=l,this._extent={},Oh(this)},Ih._initDataFromProvider=function(t,e){if(!(e<=t)){for(var n,r=this._chunkSize,i=this._rawData,o=this._storage,a=this.dimensions,s=a.length,l=this._dimensionInfos,u=this._nameList,c=this._idList,d=this._rawExtent,f=this._nameRepeatCount={},h=this._chunkCount,p=0;p<s;p++){d[_=a[p]]||(d[_]=[1/0,-1/0]);var g=l[_];0===g.otherDims.itemName&&(n=this._nameDimIdx=p),0===g.otherDims.itemId&&(this._idDimIdx=p),o[_]||(o[_]=[]),Dh(o,g,r,h,e),this._chunkCount=o[_].length}for(var m=new Array(s),v=t;v<e;v++){m=i.getItem(v,m);for(var y=Math.floor(v/r),x=v%r,b=0;b<s;b++){var _,w=o[_=a[b]][y],S=this._dimValueGetter(m,_,v,b);w[x]=S;var C=d[_];S<C[0]&&(C[0]=S),S>C[1]&&(C[1]=S)}if(!i.pure){var M=u[v];if(m&&null==M)if(null!=m.name)u[v]=M=m.name;else if(null!=n){var T=a[n],k=o[T][y];if(k){M=k[x];var A=l[T].ordinalMeta;A&&A.categories.length&&(M=A.categories[M])}}var I=null==m?null:m.id;null==I&&null!=M&&(f[M]=f[M]||0,0<f[I=M]&&(I+="__ec__"+f[M]),f[M]++),null!=I&&(c[v]=I)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=e,this._extent={},Oh(this)}},Ih.count=function(){return this._count},Ih.getIndices=function(){var t=this._indices;if(t){var e=t.constructor,n=this._count;if(e===Array){i=new e(n);for(var r=0;r<n;r++)i[r]=t[r]}else i=new e(t.buffer,0,n)}else{var i=new(e=Ch(this))(this.count());for(r=0;r<i.length;r++)i[r]=r}return i},Ih.get=function(t,e){if(!(0<=e&&e<this._count))return NaN;var n=this._storage;if(!n[t])return NaN;e=this.getRawIndex(e);var r=Math.floor(e/this._chunkSize);return n[t][r][e%this._chunkSize]},Ih.getByRawIndex=function(t,e){if(!(0<=e&&e<this._rawCount))return NaN;var n=this._storage[t];return n?n[Math.floor(e/this._chunkSize)][e%this._chunkSize]:NaN},Ih._getFast=function(t,e){var n=Math.floor(e/this._chunkSize);return this._storage[t][n][e%this._chunkSize]},Ih.getValues=function(t,e){var n=[];R(t)||(e=t,t=this.dimensions);for(var r=0,i=t.length;r<i;r++)n.push(this.get(t[r],e));return n},Ih.hasValue=function(t){for(var e=this._dimensionsSummary.dataDimsOnCoord,n=0,r=e.length;n<r;n++)if(isNaN(this.get(e[n],t)))return!1;return!0},Ih.getDataExtent=function(t){t=this.getDimension(t);var e=[1/0,-1/0];if(!this._storage[t])return e;var n,r=this.count();if(!this._indices)return this._rawExtent[t].slice();if(n=this._extent[t])return n.slice();for(var i=(n=e)[0],o=n[1],a=0;a<r;a++){var s=this._getFast(t,this.getRawIndex(a));s<i&&(i=s),o<s&&(o=s)}return this._extent[t]=[i,o]},Ih.getApproximateExtent=function(t){return t=this.getDimension(t),this._approximateExtent[t]||this.getDataExtent(t)},Ih.setApproximateExtent=function(t,e){e=this.getDimension(e),this._approximateExtent[e]=t.slice()},Ih.getCalculationInfo=function(t){return this._calculationInfo[t]},Ih.setCalculationInfo=function(t,e){yh(t)?x(this._calculationInfo,t):this._calculationInfo[t]=e},Ih.getSum=function(t){var e=0;if(this._storage[t])for(var n=0,r=this.count();n<r;n++){var i=this.get(t,n);isNaN(i)||(e+=i)}return e},Ih.getMedian=function(t){var e=[];this.each(t,function(t,n){isNaN(t)||e.push(t)});var n=[].concat(e).sort(function(t,e){return t-e}),r=this.count();return 0===r?0:r%2==1?n[(r-1)/2]:(n[r/2]+n[r/2-1])/2},Ih.rawIndexOf=function(t,e){var n=(t&&this._invertedIndicesMap[t])[e];return null==n||isNaN(n)?-1:n},Ih.indexOfName=function(t){for(var e=0,n=this.count();e<n;e++)if(this.getName(e)===t)return e;return-1},Ih.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var e=this._indices,n=e[t];if(null!=n&&n<this._count&&n===t)return t;for(var r=0,i=this._count-1;r<=i;){var o=(r+i)/2|0;if(e[o]<t)r=1+o;else{if(!(e[o]>t))return o;i=o-1}}return-1},Ih.indicesOfNearest=function(t,e,n){var r=[];if(!this._storage[t])return r;null==n&&(n=1/0);for(var i=1/0,o=-1,a=0,s=0,l=this.count();s<l;s++){var u=e-this.get(t,s),c=Math.abs(u);c<=n&&((c<i||c===i&&0<=u&&o<0)&&(i=c,o=u,a=0),u===o&&(r[a++]=s))}return r.length=a,r},Ih.getRawIndex=Eh,Ih.getRawDataItem=function(t){if(this._rawData.persistent)return this._rawData.getItem(this.getRawIndex(t));for(var e=[],n=0;n<this.dimensions.length;n++)e.push(this.get(this.dimensions[n],t));return e},Ih.getName=function(t){var e=this.getRawIndex(t);return this._nameList[e]||Ph(this,this._nameDimIdx,e)||""},Ih.getId=function(t){return Lh(this,this.getRawIndex(t))},Ih.each=function(t,e,n,r){if(this._count){"function"==typeof t&&(r=n,n=e,e=t,t=[]),n=n||r||this;for(var i=(t=A(Nh(t),this.getDimension,this)).length,o=0;o<this.count();o++)switch(i){case 0:e.call(n,o);break;case 1:e.call(n,this.get(t[0],o),o);break;case 2:e.call(n,this.get(t[0],o),this.get(t[1],o),o);break;default:for(var a=0,s=[];a<i;a++)s[a]=this.get(t[a],o);s[a]=o,e.apply(n,s)}}},Ih.filterSelf=function(t,e,n,r){if(this._count){"function"==typeof t&&(r=n,n=e,e=t,t=[]),n=n||r||this,t=A(Nh(t),this.getDimension,this);for(var i=this.count(),o=new(Ch(this))(i),a=[],s=t.length,l=0,u=t[0],c=0;c<i;c++){var d,f=this.getRawIndex(c);if(0===s)d=e.call(n,c);else if(1===s){var h=this._getFast(u,f);d=e.call(n,h,c)}else{for(var p=0;p<s;p++)a[p]=this._getFast(u,f);a[p]=c,d=e.apply(n,a)}d&&(o[l++]=f)}return l<i&&(this._indices=o),this._count=l,this._extent={},this.getRawIndex=this._indices?Rh:Eh,this}},Ih.selectRange=function(t){if(this._count){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);var r=e.length;if(r){var i=this.count(),o=new(Ch(this))(i),a=0,s=e[0],l=t[s][0],u=t[s][1],c=!1;if(!this._indices){var d=0;if(1===r){for(var f=this._storage[e[0]],h=0;h<this._chunkCount;h++)for(var p=f[h],g=Math.min(this._count-h*this._chunkSize,this._chunkSize),m=0;m<g;m++)(l<=(_=p[m])&&_<=u||isNaN(_))&&(o[a++]=d),d++;c=!0}else if(2===r){f=this._storage[s];var v=this._storage[e[1]],y=t[e[1]][0],x=t[e[1]][1];for(h=0;h<this._chunkCount;h++){p=f[h];var b=v[h];for(g=Math.min(this._count-h*this._chunkSize,this._chunkSize),m=0;m<g;m++){var _=p[m],w=b[m];(l<=_&&_<=u||isNaN(_))&&(y<=w&&w<=x||isNaN(w))&&(o[a++]=d),d++}}c=!0}}if(!c)if(1===r)for(m=0;m<i;m++){var S=this.getRawIndex(m);(l<=(_=this._getFast(s,S))&&_<=u||isNaN(_))&&(o[a++]=S)}else for(m=0;m<i;m++){var C=!0;for(S=this.getRawIndex(m),h=0;h<r;h++){var M=e[h];((_=this._getFast(n,S))<t[M][0]||_>t[M][1])&&(C=!1)}C&&(o[a++]=this.getRawIndex(m))}return a<i&&(this._indices=o),this._count=a,this._extent={},this.getRawIndex=this._indices?Rh:Eh,this}}},Ih.mapArray=function(t,e,n,r){"function"==typeof t&&(r=n,n=e,e=t,t=[]);var i=[];return this.each(t,function(){i.push(e&&e.apply(this,arguments))},n=n||r||this),i},Ih.map=function(t,e,n,r){n=n||r||this;var i=Bh(this,t=A(Nh(t),this.getDimension,this));i._indices=this._indices,i.getRawIndex=i._indices?Rh:Eh;for(var o=i._storage,a=[],s=this._chunkSize,l=t.length,u=this.count(),c=[],d=i._rawExtent,f=0;f<u;f++){for(var h=0;h<l;h++)c[h]=this.get(t[h],f);c[l]=f;var p=e&&e.apply(n,c);if(null!=p){"object"!=typeof p&&(a[0]=p,p=a);for(var g=this.getRawIndex(f),m=Math.floor(g/s),v=g%s,y=0;y<p.length;y++){var x=t[y],b=p[y],_=d[x],w=o[x];w&&(w[m][v]=b),b<_[0]&&(_[0]=b),b>_[1]&&(_[1]=b)}}}return i},Ih.downSample=function(t,e,n,r){for(var i=Bh(this,[t]),o=i._storage,a=[],s=Math.floor(1/e),l=o[t],u=this.count(),c=this._chunkSize,d=i._rawExtent[t],f=new(Ch(this))(u),h=0,p=0;p<u;p+=s){u-p<s&&(a.length=s=u-p);for(var g=0;g<s;g++){var m=this.getRawIndex(p+g),v=Math.floor(m/c);a[g]=l[v][m%c]}var y=n(a),x=this.getRawIndex(Math.min(p+r(a,y)||0,u-1)),b=x%c;(l[Math.floor(x/c)][b]=y)<d[0]&&(d[0]=y),y>d[1]&&(d[1]=y),f[h++]=x}return i._count=h,i._indices=f,i.getRawIndex=Rh,i},Ih.getItemModel=function(t){var e=this.hostModel;return new hl(this.getRawDataItem(t),e,e&&e.ecModel)},Ih.diff=function(t){var e=this;return new fh(t?t.getIndices():[],this.getIndices(),function(e){return Lh(t,e)},function(t){return Lh(e,t)})},Ih.getVisual=function(t){var e=this._visual;return e&&e[t]},Ih.setVisual=function(t,e){if(yh(t))for(var n in t)t.hasOwnProperty(n)&&this.setVisual(n,t[n]);else this._visual=this._visual||{},this._visual[t]=e},Ih.setLayout=function(t,e){if(yh(t))for(var n in t)t.hasOwnProperty(n)&&this.setLayout(n,t[n]);else this._layout[t]=e},Ih.getLayout=function(t){return this._layout[t]},Ih.getItemLayout=function(t){return this._itemLayouts[t]},Ih.setItemLayout=function(t,e,n){this._itemLayouts[t]=n?x(this._itemLayouts[t]||{},e):e},Ih.clearItemLayouts=function(){this._itemLayouts.length=0},Ih.getItemVisual=function(t,e,n){var r=this._itemVisuals[t],i=r&&r[e];return null!=i||n?i:this.getVisual(e)},Ih.setItemVisual=function(t,e,n){var r=this._itemVisuals[t]||{},i=this.hasItemVisual;if(this._itemVisuals[t]=r,yh(e))for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o],i[o]=!0);else r[e]=n,i[e]=!0},Ih.clearAllVisual=function(){this._visual={},this._itemVisuals=[],this.hasItemVisual={}},Ih.setItemGraphicEl=function(t,e){var n=this.hostModel;e&&(e.dataIndex=t,e.dataType=this.dataType,e.seriesIndex=n&&n.seriesIndex,"group"===e.type&&e.traverse(Vh,e)),this._graphicEls[t]=e},Ih.getItemGraphicEl=function(t){return this._graphicEls[t]},Ih.eachItemGraphicEl=function(t,e){k(this._graphicEls,function(n,r){n&&t&&t.call(e,n,r)})},Ih.cloneShallow=function(t){if(!t){var e=A(this.dimensions,this.getDimensionInfo,this);t=new Ah(e,this.hostModel)}return t._storage=this._storage,kh(t,this),t._indices=this._indices?new(0,this._indices.constructor)(this._indices):null,t.getRawIndex=t._indices?Rh:Eh,t},Ih.wrapMethod=function(t,e){var n=this[t];"function"==typeof n&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var t=n.apply(this,arguments);return e.apply(this,[t].concat(U(arguments)))})},Ih.TRANSFERABLE_METHODS=["cloneShallow","downSample","map"],Ih.CHANGABLE_METHODS=["filterSelf","selectRange"];var Wh=function(t,e){return Fh((e=e||{}).coordDimensions||[],t,{dimsDef:e.dimensionsDefine||t.dimensionsDefine,encodeDef:e.encodeDefine||t.encodeDefine,dimCount:e.dimensionsCount,encodeDefaulter:e.encodeDefaulter,generateCoord:e.generateCoord,generateCoordCount:e.generateCoordCount})};function jh(t){this.coordSysName=t,this.coordSysDims=[],this.axisMap=Q(),this.categoryAxisMap=Q(),this.firstCategoryDimIndex=null}var Gh={cartesian2d:function(t,e,n,r){var i=t.getReferringComponents("xAxis")[0],o=t.getReferringComponents("yAxis")[0];e.coordSysDims=["x","y"],n.set("x",i),n.set("y",o),Uh(i)&&(r.set("x",i),e.firstCategoryDimIndex=0),Uh(o)&&(r.set("y",o),e.firstCategoryDimIndex=1)},singleAxis:function(t,e,n,r){var i=t.getReferringComponents("singleAxis")[0];e.coordSysDims=["single"],n.set("single",i),Uh(i)&&(r.set("single",i),e.firstCategoryDimIndex=0)},polar:function(t,e,n,r){var i=t.getReferringComponents("polar")[0],o=i.findAxisModel("radiusAxis"),a=i.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],n.set("radius",o),n.set("angle",a),Uh(o)&&(r.set("radius",o),e.firstCategoryDimIndex=0),Uh(a)&&(r.set("angle",a),null==e.firstCategoryDimIndex&&(e.firstCategoryDimIndex=1))},geo:function(t,e,n,r){e.coordSysDims=["lng","lat"]},parallel:function(t,e,n,r){var i=t.ecModel,o=i.getComponent("parallel",t.get("parallelIndex")),a=e.coordSysDims=o.dimensions.slice();k(o.parallelAxisIndex,function(t,o){var s=i.getComponent("parallelAxis",t),l=a[o];n.set(l,s),Uh(s)&&null==e.firstCategoryDimIndex&&(r.set(l,s),e.firstCategoryDimIndex=o)})}};function Uh(t){return"category"===t.get("type")}function qh(t,e,n){var r,i,o,a,s=(n=n||{}).byIndex,l=n.stackedCoordDimension,u=!(!t||!t.get("stack"));if(k(e,function(t,n){N(t)&&(e[n]=t={name:t}),u&&!t.isExtraCoord&&(s||r||!t.ordinalMeta||(r=t),i||"ordinal"===t.type||"time"===t.type||l&&l!==t.coordDim||(i=t))}),!i||s||r||(s=!0),i){o="__\0ecstackresult",a="__\0ecstackedover",r&&(r.createInvertedIndices=!0);var c=i.coordDim,d=i.type,f=0;k(e,function(t){t.coordDim===c&&f++}),e.push({name:o,coordDim:c,coordDimIndex:f,type:d,isExtraCoord:!0,isCalculationCoord:!0}),f++,e.push({name:a,coordDim:a,coordDimIndex:f,type:d,isExtraCoord:!0,isCalculationCoord:!0})}return{stackedDimension:i&&i.name,stackedByDimension:r&&r.name,isStackedByIndex:s,stackedOverDimension:a,stackResultDimension:o}}function Xh(t,e){return!!e&&e===t.getCalculationInfo("stackedDimension")}function Yh(t,e){return Xh(t,e)?t.getCalculationInfo("stackResultDimension"):e}function $h(t,e,n){n=n||{},Iu.isInstance(t)||(t=Iu.seriesDataToSource(t));var r,i=e.get("coordinateSystem"),o=Uu.get(i),a=function(t){var e=t.get("coordinateSystem"),n=new jh(e),r=Gh[e];if(r)return r(t,n,n.axisMap,n.categoryAxisMap),n}(e);a&&(r=A(a.coordSysDims,function(t){var e={name:t},n=a.axisMap.get(t);if(n){var r=n.get("type");e.type=mh(r)}return e})),r=r||o&&(o.getDimensionsInfo?o.getDimensionsInfo():o.dimensions.slice())||["x","y"];var s,l,u=Wh(t,{coordDimensions:r,generateCoord:n.generateCoord,encodeDefaulter:n.useEncodeDefaulter?E(Ru,r,e):null});a&&k(u,function(t,e){var n=a.categoryAxisMap.get(t.coordDim);n&&(null==s&&(s=e),t.ordinalMeta=n.getOrdinalMeta()),null!=t.otherDims.itemName&&(l=!0)}),l||null==s||(u[s].otherDims.itemName=0);var c=qh(e,u),d=new Ah(u,e);d.setCalculationInfo(c);var f=null!=s&&function(t){if(t.sourceFormat===_u){var e=function(t){for(var e=0;e<t.length&&null==t[e];)e++;return t[e]}(t.data||[]);return null!=e&&!R(Ii(e))}}(t)?function(t,e,n,r){return r===s?n:this.defaultDimValueGetter(t,e,n,r)}:null;return d.hasItemOption=!1,d.initData(t,null,f),d}function Zh(t){this._setting=t||{},this._extent=[1/0,-1/0],this._interval=0,this.init&&this.init.apply(this,arguments)}function Kh(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication}Zh.prototype.parse=function(t){return t},Zh.prototype.getSetting=function(t){return this._setting[t]},Zh.prototype.contain=function(t){var e=this._extent;return t>=e[0]&&t<=e[1]},Zh.prototype.normalize=function(t){var e=this._extent;return e[1]===e[0]?.5:(t-e[0])/(e[1]-e[0])},Zh.prototype.scale=function(t){var e=this._extent;return t*(e[1]-e[0])+e[0]},Zh.prototype.unionExtent=function(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1])},Zh.prototype.unionExtentFromData=function(t,e){this.unionExtent(t.getApproximateExtent(e))},Zh.prototype.getExtent=function(){return this._extent.slice()},Zh.prototype.setExtent=function(t,e){var n=this._extent;isNaN(t)||(n[0]=t),isNaN(e)||(n[1]=e)},Zh.prototype.isBlank=function(){return this._isBlank},Zh.prototype.setBlank=function(t){this._isBlank=t},Zh.prototype.getLabel=null,Gi(Zh),$i(Zh,{registerWhenExtend:!0}),Kh.createByAxisModel=function(t){var e=t.option,n=e.data,r=n&&A(n,tp);return new Kh({categories:r,needCollect:!r,deduplication:!1!==e.dedplication})};var Jh=Kh.prototype;function Qh(t){return t._map||(t._map=Q(t.categories))}function tp(t){return B(t)&&null!=t.value?t.value:t+""}Jh.getOrdinal=function(t){return Qh(this).get(t)},Jh.parseAndCollect=function(t){var e,n=this._needCollect;if("string"!=typeof t&&!n)return t;if(n&&!this._deduplication)return this.categories[e=this.categories.length]=t,e;var r=Qh(this);return null==(e=r.get(t))&&(n?(this.categories[e=this.categories.length]=t,r.set(t,e)):e=NaN),e};var ep=Zh.prototype,np=Zh.extend({type:"ordinal",init:function(t,e){t&&!R(t)||(t=new Kh({categories:t})),this._ordinalMeta=t,this._extent=e||[0,t.categories.length-1]},parse:function(t){return"string"==typeof t?this._ordinalMeta.getOrdinal(t):Math.round(t)},contain:function(t){return t=this.parse(t),ep.contain.call(this,t)&&null!=this._ordinalMeta.categories[t]},normalize:function(t){return ep.normalize.call(this,this.parse(t))},scale:function(t){return Math.round(ep.scale.call(this,t))},getTicks:function(){for(var t=[],e=this._extent,n=e[0];n<=e[1];)t.push(n),n++;return t},getLabel:function(t){if(!this.isBlank())return this._ordinalMeta.categories[t]},count:function(){return this._extent[1]-this._extent[0]+1},unionExtentFromData:function(t,e){this.unionExtent(t.getApproximateExtent(e))},getOrdinalMeta:function(){return this._ordinalMeta},niceTicks:et,niceExtent:et});np.create=function(){return new np};var rp=_l;function ip(t){return Cl(t)+2}function op(t,e,n){t[e]=Math.max(Math.min(t[e],n[1]),n[0])}function ap(t,e){isFinite(t[0])||(t[0]=e[0]),isFinite(t[1])||(t[1]=e[1]),op(t,0,e),op(t,1,e),t[0]>t[1]&&(t[0]=t[1])}var sp=_l,lp=Zh.extend({type:"interval",_interval:0,_intervalPrecision:2,setExtent:function(t,e){var n=this._extent;isNaN(t)||(n[0]=parseFloat(t)),isNaN(e)||(n[1]=parseFloat(e))},unionExtent:function(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]),lp.prototype.setExtent.call(this,e[0],e[1])},getInterval:function(){return this._interval},setInterval:function(t){this._interval=t,this._niceExtent=this._extent.slice(),this._intervalPrecision=ip(t)},getTicks:function(t){var e=this._interval,n=this._extent,r=this._niceExtent,i=this._intervalPrecision,o=[];if(!e)return o;n[0]<r[0]&&o.push(t?sp(r[0]-e,i):n[0]);for(var a=r[0];a<=r[1]&&(o.push(a),(a=sp(a+e,i))!==o[o.length-1]);)if(1e4<o.length)return[];var s=o.length?o[o.length-1]:r[1];return n[1]>s&&o.push(t?sp(s+e,i):n[1]),o},getMinorTicks:function(t){for(var e=this.getTicks(!0),n=[],r=this.getExtent(),i=1;i<e.length;i++){for(var o=e[i-1],a=0,s=[],l=(e[i]-o)/t;a<t-1;){var u=_l(o+(a+1)*l);u>r[0]&&u<r[1]&&s.push(u),a++}n.push(s)}return n},getLabel:function(t,e){if(null==t)return"";var n=e&&e.precision;return null==n?n=Cl(t)||0:"auto"===n&&(n=this._intervalPrecision),zl(t=sp(t,n,!0))},niceTicks:function(t,e,n){t=t||5;var r=this._extent,i=r[1]-r[0];if(isFinite(i)){i<0&&(i=-i,r.reverse());var o=function(t,e,n,r){var i={},o=i.interval=Rl((t[1]-t[0])/e,!0);null!=n&&o<n&&(o=i.interval=n),null!=r&&r<o&&(o=i.interval=r);var a=i.intervalPrecision=ip(o);return ap(i.niceTickExtent=[rp(Math.ceil(t[0]/o)*o,a),rp(Math.floor(t[1]/o)*o,a)],t),i}(r,t,e,n);this._intervalPrecision=o.intervalPrecision,this._interval=o.interval,this._niceExtent=o.niceTickExtent}},niceExtent:function(t){var e=this._extent;if(e[0]===e[1])if(0!==e[0]){var n=e[0];t.fixMax||(e[1]+=n/2),e[0]-=n/2}else e[1]=1;isFinite(e[1]-e[0])||(e[0]=0,e[1]=1),this.niceTicks(t.splitNumber,t.minInterval,t.maxInterval);var r=this._interval;t.fixMin||(e[0]=sp(Math.floor(e[0]/r)*r)),t.fixMax||(e[1]=sp(Math.ceil(e[1]/r)*r))}});lp.create=function(){return new lp};var up="__ec_stack_",cp="undefined"!=typeof Float32Array?Float32Array:Array;function dp(t){return t.get("stack")||up+t.seriesIndex}function fp(t){return t.dim+t.index}function hp(t,e){var n=[];return e.eachSeriesByType(t,function(t){xp(t)&&!bp(t)&&n.push(t)}),n}function pp(t){var e=function(t){var e={};k(t,function(t){var n=t.coordinateSystem.getBaseAxis();if("time"===n.type||"value"===n.type)for(var r=t.getData(),i=n.dim+"_"+n.index,o=r.mapDimension(n.dim),a=0,s=r.count();a<s;++a){var l=r.get(o,a);e[i]?e[i].push(l):e[i]=[l]}});var n=[];for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if(i){i.sort(function(t,e){return t-e});for(var o=null,a=1;a<i.length;++a){var s=i[a]-i[a-1];0<s&&(o=null===o?s:Math.min(o,s))}n[r]=o}}return n}(t),n=[];return k(t,function(t){var r,i=t.coordinateSystem.getBaseAxis(),o=i.getExtent();if("category"===i.type)r=i.getBandWidth();else if("value"===i.type||"time"===i.type){var a=e[i.dim+"_"+i.index],s=Math.abs(o[1]-o[0]),l=i.scale.getExtent(),u=Math.abs(l[1]-l[0]);r=a?s/u*a:s}else{var c=t.getData();r=Math.abs(o[1]-o[0])/c.count()}var d=bl(t.get("barWidth"),r),f=bl(t.get("barMaxWidth"),r),h=bl(t.get("barMinWidth")||1,r),p=t.get("barGap"),g=t.get("barCategoryGap");n.push({bandWidth:r,barWidth:d,barMaxWidth:f,barMinWidth:h,barGap:p,barCategoryGap:g,axisKey:fp(i),stackId:dp(t)})}),gp(n)}function gp(t){var e={};k(t,function(t,n){var r=t.axisKey,i=t.bandWidth,o=e[r]||{bandWidth:i,remainedWidth:i,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},a=o.stacks;e[r]=o;var s=t.stackId;a[s]||o.autoWidthCount++,a[s]=a[s]||{width:0,maxWidth:0};var l=t.barWidth;l&&!a[s].width&&(a[s].width=l,l=Math.min(o.remainedWidth,l),o.remainedWidth-=l);var u=t.barMaxWidth;u&&(a[s].maxWidth=u);var c=t.barMinWidth;c&&(a[s].minWidth=c);var d=t.barGap;null!=d&&(o.gap=d);var f=t.barCategoryGap;null!=f&&(o.categoryGap=f)});var n={};return k(e,function(t,e){n[e]={};var r=t.stacks,i=t.bandWidth,o=bl(t.categoryGap,i),a=bl(t.gap,1),s=t.remainedWidth,l=t.autoWidthCount,u=(s-o)/(l+(l-1)*a);u=Math.max(u,0),k(r,function(t){var e=t.maxWidth,n=t.minWidth;if(t.width)r=t.width,e&&(r=Math.min(r,e)),n&&(r=Math.max(r,n)),t.width=r,s-=r+a*r,l--;else{var r=u;e&&e<r&&(r=Math.min(e,s)),n&&r<n&&(r=n),r!==u&&(t.width=r,s-=r+a*r,l--)}}),u=(s-o)/(l+(l-1)*a),u=Math.max(u,0);var c,d=0;k(r,function(t,e){t.width||(t.width=u),d+=(c=t).width*(1+a)}),c&&(d-=c.width*a);var f=-d/2;k(r,function(t,r){n[e][r]=n[e][r]||{bandWidth:i,offset:f,width:t.width},f+=t.width*(1+a)})}),n}function mp(t,e,n){if(t&&e){var r=t[fp(e)];return null!=r&&null!=n&&(r=r[dp(n)]),r}}function vp(t,e){var n=hp(t,e),r=pp(n),i={};k(n,function(t){var e=t.getData(),n=t.coordinateSystem,o=n.getBaseAxis(),a=dp(t),s=r[fp(o)][a],l=s.offset,u=s.width,c=n.getOtherAxis(o),d=t.get("barMinHeight")||0;i[a]=i[a]||[],e.setLayout({bandWidth:s.bandWidth,offset:l,size:u});for(var f=e.mapDimension(c.dim),h=e.mapDimension(o.dim),p=Xh(e,f),g=c.isHorizontal(),m=_p(0,c),v=0,y=e.count();v<y;v++){var x,b,_,w,S,C=e.get(f,v),M=e.get(h,v),T=0<=C?"p":"n",k=m;p&&(i[a][M]||(i[a][M]={p:m,n:m}),k=i[a][M][T]),g?(x=k,b=(S=n.dataToPoint([C,M]))[1]+l,_=S[0]-m,w=u,Math.abs(_)<d&&(_=(_<0?-1:1)*d),isNaN(_)||p&&(i[a][M][T]+=_)):(x=(S=n.dataToPoint([M,C]))[0]+l,b=k,_=u,w=S[1]-m,Math.abs(w)<d&&(w=(w<=0?-1:1)*d),isNaN(w)||p&&(i[a][M][T]+=w)),e.setItemLayout(v,{x:x,y:b,width:_,height:w})}},this)}var yp={seriesType:"bar",plan:Qc(),reset:function(t){if(xp(t)&&bp(t)){var e=t.getData(),n=t.coordinateSystem,r=n.grid.getRect(),i=n.getBaseAxis(),o=n.getOtherAxis(i),a=e.mapDimension(o.dim),s=e.mapDimension(i.dim),l=o.isHorizontal(),u=l?0:1,c=mp(pp([t]),i,t).width;return.5<c||(c=.5),{progress:function(t,e){for(var i,d=t.count,f=new cp(2*d),h=new cp(2*d),p=new cp(d),g=[],m=[],v=0,y=0;null!=(i=t.next());)m[u]=e.get(a,i),m[1-u]=e.get(s,i),g=n.dataToPoint(m,null,g),h[v]=l?r.x+r.width:g[0],f[v++]=g[0],h[v]=l?g[1]:r.y+r.height,f[v++]=g[1],p[y++]=i;e.setLayout({largePoints:f,largeDataIndices:p,largeBackgroundPoints:h,barWidth:c,valueAxisStart:_p(0,o),backgroundStart:l?r.x:r.y,valueAxisHorizontal:l})}}}}};function xp(t){return t.coordinateSystem&&"cartesian2d"===t.coordinateSystem.type}function bp(t){return t.pipelineContext&&t.pipelineContext.large}function _p(t,e){return e.toGlobalCoord(e.dataToCoord("log"===e.type?1:0))}var wp=lp.prototype,Sp=Math.ceil,Cp=Math.floor,Mp=36e5,Tp=864e5,kp=lp.extend({type:"time",getLabel:function(t){var e=this._stepLvl,n=new Date(t);return Zl(e[0],n,this.getSetting("useUTC"))},niceExtent:function(t){var e=this._extent;if(e[0]===e[1]&&(e[0]-=Tp,e[1]+=Tp),e[1]===-1/0&&e[0]===1/0){var n=new Date;e[1]=+new Date(n.getFullYear(),n.getMonth(),n.getDate()),e[0]=e[1]-Tp}this.niceTicks(t.splitNumber,t.minInterval,t.maxInterval);var r=this._interval;t.fixMin||(e[0]=_l(Cp(e[0]/r)*r)),t.fixMax||(e[1]=_l(Sp(e[1]/r)*r))},niceTicks:function(t,e,n){var r=this._extent,i=r[1]-r[0],o=i/(t=t||10);null!=e&&o<e&&(o=e),null!=n&&n<o&&(o=n);var a=Ap.length,s=function(t,e,n,r){for(;n<r;){var i=n+r>>>1;t[i][1]<e?n=1+i:r=i}return n}(Ap,o,0,a),l=Ap[Math.min(s,a-1)],u=l[1];"year"===l[0]&&(u*=Rl(i/u/t,!0));var c=this.getSetting("useUTC")?0:60*new Date(+r[0]||+r[1]).getTimezoneOffset()*1e3,d=[Math.round(Sp((r[0]-c)/u)*u+c),Math.round(Cp((r[1]-c)/u)*u+c)];ap(d,r),this._stepLvl=l,this._interval=u,this._niceExtent=d},parse:function(t){return+Ol(t)}});k(["contain","normalize"],function(t){kp.prototype[t]=function(e){return wp[t].call(this,this.parse(e))}});var Ap=[["hh:mm:ss",1e3],["hh:mm:ss",5e3],["hh:mm:ss",1e4],["hh:mm:ss",15e3],["hh:mm:ss",3e4],["hh:mm\nMM-dd",6e4],["hh:mm\nMM-dd",3e5],["hh:mm\nMM-dd",6e5],["hh:mm\nMM-dd",9e5],["hh:mm\nMM-dd",18e5],["hh:mm\nMM-dd",Mp],["hh:mm\nMM-dd",72e5],["hh:mm\nMM-dd",6*Mp],["hh:mm\nMM-dd",432e5],["MM-dd\nyyyy",Tp],["MM-dd\nyyyy",2*Tp],["MM-dd\nyyyy",3*Tp],["MM-dd\nyyyy",4*Tp],["MM-dd\nyyyy",5*Tp],["MM-dd\nyyyy",6*Tp],["week",7*Tp],["MM-dd\nyyyy",864e6],["week",14*Tp],["week",21*Tp],["month",31*Tp],["week",42*Tp],["month",62*Tp],["week",70*Tp],["quarter",95*Tp],["month",31*Tp*4],["month",13392e6],["half-year",16416e6],["month",31*Tp*8],["month",26784e6],["year",380*Tp]];kp.create=function(t){return new kp({useUTC:t.ecModel.get("useUTC")})};var Ip=Zh.prototype,Dp=lp.prototype,Op=Cl,Pp=_l,Ep=Math.floor,Rp=Math.ceil,Lp=Math.pow,Np=Math.log,Bp=Zh.extend({type:"log",base:10,$constructor:function(){Zh.apply(this,arguments),this._originalScale=new lp},getTicks:function(t){var e=this._originalScale,n=this._extent,r=e.getExtent();return A(Dp.getTicks.call(this,t),function(t){var i=_l(Lp(this.base,t));return i=t===n[0]&&e.__fixMin?zp(i,r[0]):i,t===n[1]&&e.__fixMax?zp(i,r[1]):i},this)},getMinorTicks:Dp.getMinorTicks,getLabel:Dp.getLabel,scale:function(t){return t=Ip.scale.call(this,t),Lp(this.base,t)},setExtent:function(t,e){var n=this.base;t=Np(t)/Np(n),e=Np(e)/Np(n),Dp.setExtent.call(this,t,e)},getExtent:function(){var t=this.base,e=Ip.getExtent.call(this);e[0]=Lp(t,e[0]),e[1]=Lp(t,e[1]);var n=this._originalScale,r=n.getExtent();return n.__fixMin&&(e[0]=zp(e[0],r[0])),n.__fixMax&&(e[1]=zp(e[1],r[1])),e},unionExtent:function(t){this._originalScale.unionExtent(t);var e=this.base;t[0]=Np(t[0])/Np(e),t[1]=Np(t[1])/Np(e),Ip.unionExtent.call(this,t)},unionExtentFromData:function(t,e){this.unionExtent(t.getApproximateExtent(e))},niceTicks:function(t){t=t||10;var e=this._extent,n=e[1]-e[0];if(!(n==1/0||n<=0)){var r=Pl(n);for(t/n*r<=.5&&(r*=10);!isNaN(r)&&Math.abs(r)<1&&0<Math.abs(r);)r*=10;var i=[_l(Rp(e[0]/r)*r),_l(Ep(e[1]/r)*r)];this._interval=r,this._niceExtent=i}},niceExtent:function(t){Dp.niceExtent.call(this,t);var e=this._originalScale;e.__fixMin=t.fixMin,e.__fixMax=t.fixMax}});function zp(t,e){return Pp(t,Op(e))}function Vp(t,e){var n,r,i,o=t.type,a=e.getMin(),s=e.getMax(),l=t.getExtent();"ordinal"===o?n=e.getCategories().length:(R(r=e.get("boundaryGap"))||(r=[r||0,r||0]),"boolean"==typeof r[0]&&(r=[0,0]),r[0]=bl(r[0],1),r[1]=bl(r[1],1),i=l[1]-l[0]||Math.abs(l[0])),"dataMin"===a?a=l[0]:"function"==typeof a&&(a=a({min:l[0],max:l[1]})),"dataMax"===s?s=l[1]:"function"==typeof s&&(s=s({min:l[0],max:l[1]}));var u=null!=a,c=null!=s;null==a&&(a="ordinal"===o?n?0:NaN:l[0]-r[0]*i),null==s&&(s="ordinal"===o?n?n-1:NaN:l[1]+r[1]*i),null!=a&&isFinite(a)||(a=NaN),null!=s&&isFinite(s)||(s=NaN),t.setBlank(H(a)||H(s)||"ordinal"===o&&!t.getOrdinalMeta().categories.length),e.getNeedCrossZero()&&(0<a&&0<s&&!u&&(a=0),a<0&&s<0&&!c&&(s=0));var d=e.ecModel;if(d&&"time"===o){var f,h=hp("bar",d);if(k(h,function(t){f|=t.getBaseAxis()===e.axis}),f){var p=pp(h),g=function(t,e,n,r){var i=n.axis.getExtent(),o=i[1]-i[0],a=mp(r,n.axis);if(void 0===a)return{min:t,max:e};var s=1/0;k(a,function(t){s=Math.min(t.offset,s)});var l=-1/0;k(a,function(t){l=Math.max(t.offset+t.width,l)}),s=Math.abs(s),l=Math.abs(l);var u=s+l,c=e-t,d=c/(1-(s+l)/o)-c;return{min:t-=s/u*d,max:e+=l/u*d}}(a,s,e,p);a=g.min,s=g.max}}return{extent:[a,s],fixMin:u,fixMax:c}}function Fp(t,e){var n=Vp(t,e),r=n.extent,i=e.get("splitNumber");"log"===t.type&&(t.base=e.get("logBase"));var o=t.type;t.setExtent(r[0],r[1]),t.niceExtent({splitNumber:i,fixMin:n.fixMin,fixMax:n.fixMax,minInterval:"interval"===o||"time"===o?e.get("minInterval"):null,maxInterval:"interval"===o||"time"===o?e.get("maxInterval"):null});var a=e.get("interval");null!=a&&t.setInterval&&t.setInterval(a)}function Hp(t,e){if(e=e||t.get("type"))switch(e){case"category":return new np(t.getOrdinalMeta?t.getOrdinalMeta():t.getCategories(),[1/0,-1/0]);case"value":return new lp;default:return(Zh.getClass(e)||lp).create(t)}}function Wp(t){var e,n=t.getLabelModel().get("formatter"),r="category"===t.type?t.scale.getExtent()[0]:null;return"string"==typeof n?(e=n,n=function(n){return n=t.scale.getLabel(n),e.replace("{value}",null!=n?n:"")}):"function"==typeof n?function(e,i){return null!=r&&(i=e-r),n(jp(t,e),i)}:function(e){return t.scale.getLabel(e)}}function jp(t,e){return"category"===t.type?t.scale.getLabel(e):e}function Gp(t){var e=t.get("interval");return null==e?"auto":e}function Up(t){return"category"===t.type&&0===Gp(t.getLabelModel())}k(["contain","normalize"],function(t){Bp.prototype[t]=function(e){return e=Np(e)/Np(this.base),Ip[t].call(this,e)}}),Bp.create=function(){return new Bp};var qp={getMin:function(t){var e=this.option,n=t||null==e.rangeStart?e.min:e.rangeStart;return this.axis&&null!=n&&"dataMin"!==n&&"function"!=typeof n&&!H(n)&&(n=this.axis.scale.parse(n)),n},getMax:function(t){var e=this.option,n=t||null==e.rangeEnd?e.max:e.rangeEnd;return this.axis&&null!=n&&"dataMax"!==n&&"function"!=typeof n&&!H(n)&&(n=this.axis.scale.parse(n)),n},getNeedCrossZero:function(){var t=this.option;return null==t.rangeStart&&null==t.rangeEnd&&!t.scale},getCoordSysModel:et,setRange:function(t,e){this.option.rangeStart=t,this.option.rangeEnd=e},resetRange:function(){this.option.rangeStart=this.option.rangeEnd=null}},Xp=hs({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var n=e.cx,r=e.cy,i=e.width/2,o=e.height/2;t.moveTo(n,r-o),t.lineTo(n+i,r+o),t.lineTo(n-i,r+o),t.closePath()}}),Yp=hs({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var n=e.cx,r=e.cy,i=e.width/2,o=e.height/2;t.moveTo(n,r-o),t.lineTo(n+i,r),t.lineTo(n,r+o),t.lineTo(n-i,r),t.closePath()}}),$p=hs({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.x,r=e.y,i=e.width/5*3,o=Math.max(i,e.height),a=i/2,s=a*a/(o-a),l=r-o+a+s,u=Math.asin(s/a),c=Math.cos(u)*a,d=Math.sin(u),f=Math.cos(u),h=.6*a,p=.7*a;t.moveTo(n-c,l+s),t.arc(n,l,a,Math.PI-u,2*Math.PI+u),t.bezierCurveTo(n+c-d*h,l+s+f*h,n,r-p,n,r),t.bezierCurveTo(n,r-p,n-c+d*h,l+s+f*h,n-c,l+s),t.closePath()}}),Zp=hs({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.height,r=e.x,i=e.y,o=e.width/3*2;t.moveTo(r,i),t.lineTo(r+o,i+n),t.lineTo(r,i+n/4*3),t.lineTo(r-o,i+n),t.lineTo(r,i),t.closePath()}}),Kp={line:function(t,e,n,r,i){i.x1=t,i.y1=e+r/2,i.x2=t+n,i.y2=e+r/2},rect:function(t,e,n,r,i){i.x=t,i.y=e,i.width=n,i.height=r},roundRect:function(t,e,n,r,i){i.x=t,i.y=e,i.width=n,i.height=r,i.r=Math.min(n,r)/4},square:function(t,e,n,r,i){var o=Math.min(n,r);i.x=t,i.y=e,i.width=o,i.height=o},circle:function(t,e,n,r,i){i.cx=t+n/2,i.cy=e+r/2,i.r=Math.min(n,r)/2},diamond:function(t,e,n,r,i){i.cx=t+n/2,i.cy=e+r/2,i.width=n,i.height=r},pin:function(t,e,n,r,i){i.x=t+n/2,i.y=e+r/2,i.width=n,i.height=r},arrow:function(t,e,n,r,i){i.x=t+n/2,i.y=e+r/2,i.width=n,i.height=r},triangle:function(t,e,n,r,i){i.cx=t+n/2,i.cy=e+r/2,i.width=n,i.height=r}},Jp={};k({line:Xa,rect:Ua,roundRect:Ua,square:Ua,circle:Pa,diamond:Yp,pin:$p,arrow:Zp,triangle:Xp},function(t,e){Jp[e]=new t});var Qp=hs({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(t,e,n){var r=sr(t,e,n),i=this.shape;return i&&"pin"===i.symbolType&&"inside"===e.textPosition&&(r.y=n.y+.4*n.height),r},buildPath:function(t,e,n){var r=e.symbolType;if("none"!==r){var i=Jp[r];i=i||Jp[r="rect"],Kp[r](e.x,e.y,e.width,e.height,i.shape),i.buildPath(t,i.shape,n)}}});function tg(t,e){if("image"!==this.type){var n=this.style,r=this.shape;r&&"line"===r.symbolType?n.stroke=t:this.__isEmptyBrush?(n.stroke=t,n.fill=e||"#fff"):(n.fill&&(n.fill=t),n.stroke&&(n.stroke=t)),this.dirty(!1)}}function eg(t,e,n,r,i,o,a){var s,l=0===t.indexOf("empty");return l&&(t=t.substr(5,1).toLowerCase()+t.substr(6)),(s=0===t.indexOf("image://")?vs(t.slice(8),new Sn(e,n,r,i),a?"center":"cover"):0===t.indexOf("path://")?ms(t.slice(7),{},new Sn(e,n,r,i),a?"center":"cover"):new Qp({shape:{symbolType:t,x:e,y:n,width:r,height:i}})).__isEmptyBrush=l,s.setColor=tg,s.setColor(o),s}var ng=(Object.freeze||Object)({createList:function(t){return $h(t.getSource(),t)},getLayoutRect:au,dataStack:{isDimensionStacked:Xh,enableDataStack:qh,getStackedDimension:Yh},createScale:function(t,e){var n=e;hl.isInstance(e)||M(n=new hl(e),qp);var r=Hp(n);return r.setExtent(t[0],t[1]),Fp(r,n),r},mixinAxisModelCommonMethods:function(t){M(t,qp)},completeDimensions:Fh,createDimensions:Wh,createSymbol:eg});function rg(t,e){return Math.abs(t-e)<1e-8}function ig(t,e,n){var r=0,i=t[0];if(!i)return!1;for(var o=1;o<t.length;o++){var a=t[o];r+=ea(i[0],i[1],a[0],a[1],e,n),i=a}var s=t[0];return rg(i[0],s[0])&&rg(i[1],s[1])||(r+=ea(i[0],i[1],s[0],s[1],e,n)),0!==r}function og(t,e,n){if(this.name=t,this.geometries=e,n)n=[n[0],n[1]];else{var r=this.getBoundingRect();n=[r.x+r.width/2,r.y+r.height/2]}this.center=n}function ag(t,e,n){for(var r=[],i=e[0],o=e[1],a=0;a<t.length;a+=2){var s=t.charCodeAt(a)-64,l=t.charCodeAt(a+1)-64;s=s>>1^-(1&s),l=l>>1^-(1&l),i=s+=i,o=l+=o,r.push([s/n,l/n])}return r}function sg(t,e){return function(t){if(t.UTF8Encoding){var e=t.UTF8Scale;null==e&&(e=1024);for(var n=t.features,r=0;r<n.length;r++)for(var i=n[r].geometry,o=i.coordinates,a=i.encodeOffsets,s=0;s<o.length;s++){var l=o[s];if("Polygon"===i.type)o[s]=ag(l,a[s],e);else if("MultiPolygon"===i.type)for(var u=0;u<l.length;u++)l[u]=ag(l[u],a[s][u],e)}t.UTF8Encoding=!1}}(t),A(D(t.features,function(t){return t.geometry&&t.properties&&0<t.geometry.coordinates.length}),function(t){var n=t.properties,r=t.geometry,i=r.coordinates,o=[];"Polygon"===r.type&&o.push({type:"polygon",exterior:i[0],interiors:i.slice(1)}),"MultiPolygon"===r.type&&k(i,function(t){t[0]&&o.push({type:"polygon",exterior:t[0],interiors:t.slice(1)})});var a=new og(n[e||"name"],o,n.cp);return a.properties=n,a})}og.prototype={constructor:og,properties:null,getBoundingRect:function(){var t=this._rect;if(t)return t;for(var e=Number.MAX_VALUE,n=[e,e],r=[-e,-e],i=[],o=[],a=this.geometries,s=0;s<a.length;s++)"polygon"===a[s].type&&(Io(a[s].exterior,i,o),_t(n,n,i),wt(r,r,o));return 0===s&&(n[0]=n[1]=r[0]=r[1]=0),this._rect=new Sn(n[0],n[1],r[0]-n[0],r[1]-n[1])},contain:function(t){var e=this.getBoundingRect(),n=this.geometries;if(!e.contain(t[0],t[1]))return!1;t:for(var r=0,i=n.length;r<i;r++)if("polygon"===n[r].type){var o=n[r].interiors;if(ig(n[r].exterior,t[0],t[1])){for(var a=0;a<(o?o.length:0);a++)if(ig(o[a]))continue t;return!0}}return!1},transformTo:function(t,e,n,r){var i=this.getBoundingRect(),o=i.width/i.height;n?r=r||n/o:n=o*r;for(var a=new Sn(t,e,n,r),s=i.calculateTransform(a),l=this.geometries,u=0;u<l.length;u++)if("polygon"===l[u].type){for(var c=l[u].exterior,d=l[u].interiors,f=0;f<c.length;f++)bt(c[f],c[f],s);for(var h=0;h<(d?d.length:0);h++)for(f=0;f<d[h].length;f++)bt(d[h][f],d[h][f],s)}(i=this._rect).copy(a),this.center=[i.x+i.width/2,i.y+i.height/2]},cloneShallow:function(t){null==t&&(t=this.name);var e=new og(t,this.geometries,this.center);return e._rect=this._rect,e.transformTo=null,e}};var lg=Li();function ug(t,e){var n,r=cg(t,"labels"),i=Gp(e);return dg(r,i)||fg(r,i,{labels:L(i)?pg(t,i):hg(t,n="auto"===i?function(t){var e=lg(t).autoInterval;return null!=e?e:lg(t).autoInterval=t.calculateCategoryInterval()}(t):i),labelCategoryInterval:n})}function cg(t,e){return lg(t)[e]||(lg(t)[e]=[])}function dg(t,e){for(var n=0;n<t.length;n++)if(t[n].key===e)return t[n].value}function fg(t,e,n){return t.push({key:e,value:n}),n}function hg(t,e,n){var r=Wp(t),i=t.scale,o=i.getExtent(),a=t.getLabelModel(),s=[],l=Math.max((e||0)+1,1),u=o[0],c=i.count();0!==u&&1<l&&2<c/l&&(u=Math.round(Math.ceil(u/l)*l));var d=Up(t),f=a.get("showMinLabel")||d,h=a.get("showMaxLabel")||d;f&&u!==o[0]&&g(o[0]);for(var p=u;p<=o[1];p+=l)g(p);function g(t){s.push(n?t:{formattedLabel:r(t),rawLabel:i.getLabel(t),tickValue:t})}return h&&p-l!==o[1]&&g(o[1]),s}function pg(t,e,n){var r=t.scale,i=Wp(t),o=[];return k(r.getTicks(),function(t){var a=r.getLabel(t);e(t,a)&&o.push(n?t:{formattedLabel:i(t),rawLabel:a,tickValue:t})}),o}var gg=[0,1],mg=function(t,e,n){this.dim=t,this.scale=e,this._extent=n||[0,0],this.inverse=!1,this.onBand=!1};function vg(t,e){var n=(t[1]-t[0])/e/2;t[0]+=n,t[1]-=n}mg.prototype={constructor:mg,contain:function(t){var e=this._extent,n=Math.min(e[0],e[1]),r=Math.max(e[0],e[1]);return n<=t&&t<=r},containData:function(t){return this.scale.contain(t)},getExtent:function(){return this._extent.slice()},getPixelPrecision:function(t){return Ml(t||this.scale.getExtent(),this._extent)},setExtent:function(t,e){var n=this._extent;n[0]=t,n[1]=e},dataToCoord:function(t,e){var n=this._extent,r=this.scale;return t=r.normalize(t),this.onBand&&"ordinal"===r.type&&vg(n=n.slice(),r.count()),xl(t,gg,n,e)},coordToData:function(t,e){var n=this._extent,r=this.scale;this.onBand&&"ordinal"===r.type&&vg(n=n.slice(),r.count());var i=xl(t,n,gg,e);return this.scale.scale(i)},pointToData:function(t,e){},getTicksCoords:function(t){var e=(t=t||{}).tickModel||this.getTickModel(),n=A(function(t,e){return"category"===t.type?function(t,e){var n,r,i=cg(t,"ticks"),o=Gp(e),a=dg(i,o);if(a)return a;if(e.get("show")&&!t.scale.isBlank()||(n=[]),L(o))n=pg(t,o,!0);else if("auto"===o){var s=ug(t,t.getLabelModel());r=s.labelCategoryInterval,n=A(s.labels,function(t){return t.tickValue})}else n=hg(t,r=o,!0);return fg(i,o,{ticks:n,tickCategoryInterval:r})}(t,e):{ticks:t.scale.getTicks()}}(this,e).ticks,function(t){return{coord:this.dataToCoord(t),tickValue:t}},this);return function(t,e,n,r){var i=e.length;if(t.onBand&&!n&&i){var o,a=t.getExtent();if(1===i)e[0].coord=a[0],o=e[1]={coord:a[0]};else{var s=(e[i-1].coord-e[0].coord)/(e[i-1].tickValue-e[0].tickValue);k(e,function(t){t.coord-=s/2});var l=t.scale.getExtent();e.push(o={coord:e[i-1].coord+s*(1+l[1]-e[i-1].tickValue)})}var u=a[0]>a[1];c(e[0].coord,a[0])&&(r?e[0].coord=a[0]:e.shift()),r&&c(a[0],e[0].coord)&&e.unshift({coord:a[0]}),c(a[1],o.coord)&&(r?o.coord=a[1]:e.pop()),r&&c(o.coord,a[1])&&e.push({coord:a[1]})}function c(t,e){return t=_l(t),e=_l(e),u?e<t:t<e}}(this,n,e.get("alignWithLabel"),t.clamp),n},getMinorTicksCoords:function(){if("ordinal"===this.scale.type)return[];var t=this.model.getModel("minorTick").get("splitNumber");return 0<t&&t<100||(t=5),A(this.scale.getMinorTicks(t),function(t){return A(t,function(t){return{coord:this.dataToCoord(t),tickValue:t}},this)},this)},getViewLabels:function(){return function(t){return"category"===t.type?function(t){var e=t.getLabelModel(),n=ug(t,e);return!e.get("show")||t.scale.isBlank()?{labels:[],labelCategoryInterval:n.labelCategoryInterval}:n}(t):function(t){var e=t.scale.getTicks(),n=Wp(t);return{labels:A(e,function(e,r){return{formattedLabel:n(e,r),rawLabel:t.scale.getLabel(e),tickValue:e}})}}(t)}(this).labels},getLabelModel:function(){return this.model.getModel("axisLabel")},getTickModel:function(){return this.model.getModel("axisTick")},getBandWidth:function(){var t=this._extent,e=this.scale.getExtent(),n=e[1]-e[0]+(this.onBand?1:0);0===n&&(n=1);var r=Math.abs(t[1]-t[0]);return Math.abs(r)/n},isHorizontal:null,getRotate:null,calculateCategoryInterval:function(){return function(t){var e=function(t){var e=t.getLabelModel();return{axisRotate:t.getRotate?t.getRotate():t.isHorizontal&&!t.isHorizontal()?90:0,labelRotate:e.get("rotate")||0,font:e.getFont()}}(t),n=Wp(t),r=(e.axisRotate-e.labelRotate)/180*Math.PI,i=t.scale,o=i.getExtent(),a=i.count();if(o[1]-o[0]<1)return 0;var s=1;40<a&&(s=Math.max(1,Math.floor(a/40)));for(var l=o[0],u=t.dataToCoord(l+1)-t.dataToCoord(l),c=Math.abs(u*Math.cos(r)),d=Math.abs(u*Math.sin(r)),f=0,h=0;l<=o[1];l+=s){var p,g=ir(n(l),e.font,"center","top");p=1.3*g.height,f=Math.max(f,1.3*g.width,7),h=Math.max(h,p,7)}var m=f/c,v=h/d;isNaN(m)&&(m=1/0),isNaN(v)&&(v=1/0);var y=Math.max(0,Math.floor(Math.min(m,v))),x=lg(t.model),b=t.getExtent(),_=x.lastAutoInterval,w=x.lastTickCount;return null!=_&&null!=w&&Math.abs(_-y)<=1&&Math.abs(w-a)<=1&&y<_&&x.axisExtend0===b[0]&&x.axisExtend1===b[1]?y=_:(x.lastTickCount=a,x.lastAutoInterval=y,x.axisExtend0=b[0],x.axisExtend1=b[1]),y}(this)}};var yg=sg,xg={};k(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend","defaults","clone","merge"],function(t){xg[t]=nt[t]});var bg={};function _g(t,e){var n=t.mapDimension("defaultedLabel",!0),r=n.length;if(1===r)return Mc(t,e,n[0]);if(r){for(var i=[],o=0;o<n.length;o++){var a=Mc(t,e,n[o]);i.push(a)}return i.join(" ")}}function wg(t,e,n){Cn.call(this),this.updateData(t,e,n)}k(["extendShape","extendPath","makePath","makeImage","mergePath","resizePath","createIcon","setHoverStyle","setLabelStyle","setTextStyle","setText","getFont","updateProps","initProps","getTransform","clipPointsByRect","clipRectByRect","registerShape","getShapeClass","Group","Image","Text","Circle","Sector","Ring","Polygon","Polyline","Rect","Line","BezierCurve","Arc","IncrementalDisplayable","CompoundPath","LinearGradient","RadialGradient","BoundingRect"],function(t){bg[t]=al[t]}),jc.extend({type:"series.line",dependencies:["grid","polar"],getInitialData:function(t,e){return $h(this.getSource(),this,{useEncodeDefaulter:!0})},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,clip:!0,label:{position:"top"},lineStyle:{width:2,type:"solid"},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0}});var Sg=wg.prototype,Cg=wg.getSymbolSize=function(t,e){var n=t.getItemVisual(e,"symbolSize");return n instanceof Array?n.slice():[+n,+n]};function Mg(t){return[t[0]/2,t[1]/2]}function Tg(t,e){this.parent.drift(t,e)}Sg._createSymbol=function(t,e,n,r,i){this.removeAll();var o=eg(t,-1,-1,2,2,e.getItemVisual(n,"color"),i);o.attr({z2:100,culling:!0,scale:Mg(r)}),o.drift=Tg,this._symbolType=t,this.add(o)},Sg.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(t)},Sg.getSymbolPath=function(){return this.childAt(0)},Sg.getScale=function(){return this.childAt(0).scale},Sg.highlight=function(){this.childAt(0).trigger("emphasis")},Sg.downplay=function(){this.childAt(0).trigger("normal")},Sg.setZ=function(t,e){var n=this.childAt(0);n.zlevel=t,n.z=e},Sg.setDraggable=function(t){var e=this.childAt(0);e.draggable=t,e.cursor=t?"move":e.cursor},Sg.updateData=function(t,e,n){this.silent=!1;var r=t.getItemVisual(e,"symbol")||"circle",i=t.hostModel,o=Cg(t,e),a=r!==this._symbolType;if(a){var s=t.getItemVisual(e,"symbolKeepAspect");this._createSymbol(r,t,e,o,s)}else(l=this.childAt(0)).silent=!1,$s(l,{scale:Mg(o)},i,e);if(this._updateCommon(t,e,o,n),a){var l=this.childAt(0),u=n&&n.fadeIn,c={scale:l.scale.slice()};u&&(c.style={opacity:l.style.opacity}),l.scale=[0,0],u&&(l.style.opacity=0),Zs(l,c,i,e)}this._seriesModel=i};var kg=["itemStyle"],Ag=["emphasis","itemStyle"],Ig=["label"],Dg=["emphasis","label"];function Og(t,e){if(!this.incremental&&!this.useHoverLayer)if("emphasis"===e){var n=this.__symbolOriginalScale,r=n[1]/n[0],i={scale:[Math.max(1.1*n[0],n[0]+3),Math.max(1.1*n[1],n[1]+3*r)]};this.animateTo(i,400,"elasticOut")}else"normal"===e&&this.animateTo({scale:this.__symbolOriginalScale},400,"elasticOut")}function Pg(t){this.group=new Cn,this._symbolCtor=t||wg}Sg._updateCommon=function(t,e,n,r){var i=this.childAt(0),o=t.hostModel,a=t.getItemVisual(e,"color");"image"!==i.type?i.useStyle({strokeNoScale:!0}):i.setStyle({opacity:1,shadowBlur:null,shadowOffsetX:null,shadowOffsetY:null,shadowColor:null});var s=r&&r.itemStyle,l=r&&r.hoverItemStyle,u=r&&r.symbolOffset,c=r&&r.labelModel,d=r&&r.hoverLabelModel,f=r&&r.hoverAnimation,h=r&&r.cursorStyle;if(!r||t.hasItemOption){var p=r&&r.itemModel?r.itemModel:t.getItemModel(e);s=p.getModel(kg).getItemStyle(["color"]),l=p.getModel(Ag).getItemStyle(),u=p.getShallow("symbolOffset"),c=p.getModel(Ig),d=p.getModel(Dg),f=p.getShallow("hoverAnimation"),h=p.getShallow("cursor")}else l=x({},l);var g=i.style,m=t.getItemVisual(e,"symbolRotate");i.attr("rotation",(m||0)*Math.PI/180||0),u&&i.attr("position",[bl(u[0],n[0]),bl(u[1],n[1])]),h&&i.attr("cursor",h),i.setColor(a,r&&r.symbolInnerColor),i.setStyle(s);var v=t.getItemVisual(e,"opacity");null!=v&&(g.opacity=v);var y=t.getItemVisual(e,"liftZ"),b=i.__z2Origin;null!=y?null==b&&(i.__z2Origin=i.z2,i.z2+=y):null!=b&&(i.z2=b,i.__z2Origin=null);var _=r&&r.useNameLabel;Vs(g,l,c,d,{labelFetcher:o,labelDataIndex:e,defaultText:function(e,n){return _?t.getName(e):_g(t,e)},isRectText:!0,autoColor:a}),i.__symbolOriginalScale=Mg(n),i.hoverStyle=l,i.highDownOnUpdate=f&&o.isAnimationEnabled()?Og:null,Ls(i)},Sg.fadeOut=function(t,e){var n=this.childAt(0);this.silent=n.silent=!0,e&&e.keepLabel||(n.style.text=null),$s(n,{style:{opacity:0},scale:[0,0]},this._seriesModel,this.dataIndex,t)},C(wg,Cn);var Eg=Pg.prototype;function Rg(t,e,n,r){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(r.isIgnore&&r.isIgnore(n))&&!(r.clipShape&&!r.clipShape.contain(e[0],e[1]))&&"none"!==t.getItemVisual(n,"symbol")}function Lg(t){return null==t||B(t)||(t={isIgnore:t}),t||{}}function Ng(t){var e=t.hostModel;return{itemStyle:e.getModel("itemStyle").getItemStyle(["color"]),hoverItemStyle:e.getModel("emphasis.itemStyle").getItemStyle(),symbolRotate:e.get("symbolRotate"),symbolOffset:e.get("symbolOffset"),hoverAnimation:e.get("hoverAnimation"),labelModel:e.getModel("label"),hoverLabelModel:e.getModel("emphasis.label"),cursorStyle:e.get("cursor")}}function Bg(t,e,n){var r,i=t.getBaseAxis(),o=t.getOtherAxis(i),a=function(t,e){var n=0,r=t.scale.getExtent();return"start"===e?n=r[0]:"end"===e?n=r[1]:0<r[0]?n=r[0]:r[1]<0&&(n=r[1]),n}(o,n),s=i.dim,l=o.dim,u=e.mapDimension(l),c=e.mapDimension(s),d="x"===l||"radius"===l?1:0,f=A(t.dimensions,function(t){return e.mapDimension(t)}),h=e.getCalculationInfo("stackResultDimension");return(r|=Xh(e,f[0]))&&(f[0]=h),(r|=Xh(e,f[1]))&&(f[1]=h),{dataDimsForPoint:f,valueStart:a,valueAxisDim:l,baseAxisDim:s,stacked:!!r,valueDim:u,baseDim:c,baseDataOffset:d,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")}}function zg(t,e,n,r){var i=NaN;t.stacked&&(i=n.get(n.getCalculationInfo("stackedOverDimension"),r)),isNaN(i)&&(i=t.valueStart);var o=t.baseDataOffset,a=[];return a[o]=n.get(t.baseDim,r),a[1-o]=i,e.dataToPoint(a)}Eg.updateData=function(t,e){e=Lg(e);var n=this.group,r=t.hostModel,i=this._data,o=this._symbolCtor,a=Ng(t);i||n.removeAll(),t.diff(i).add(function(r){var i=t.getItemLayout(r);if(Rg(t,i,r,e)){var s=new o(t,r,a);s.attr("position",i),t.setItemGraphicEl(r,s),n.add(s)}}).update(function(s,l){var u=i.getItemGraphicEl(l),c=t.getItemLayout(s);Rg(t,c,s,e)?(u?(u.updateData(t,s,a),$s(u,{position:c},r)):(u=new o(t,s)).attr("position",c),n.add(u),t.setItemGraphicEl(s,u)):n.remove(u)}).remove(function(t){var e=i.getItemGraphicEl(t);e&&e.fadeOut(function(){n.remove(e)})}).execute(),this._data=t},Eg.isPersistent=function(){return!0},Eg.updateLayout=function(){var t=this._data;t&&t.eachItemGraphicEl(function(e,n){var r=t.getItemLayout(n);e.attr("position",r)})},Eg.incrementalPrepareUpdate=function(t){this._seriesScope=Ng(t),this._data=null,this.group.removeAll()},Eg.incrementalUpdate=function(t,e,n){function r(t){t.isGroup||(t.incremental=t.useHoverLayer=!0)}n=Lg(n);for(var i=t.start;i<t.end;i++){var o=e.getItemLayout(i);if(Rg(e,o,i,n)){var a=new this._symbolCtor(e,i,this._seriesScope);a.traverse(r),a.attr("position",o),this.group.add(a),e.setItemGraphicEl(i,a)}}},Eg.remove=function(t){var e=this.group,n=this._data;n&&t?n.eachItemGraphicEl(function(t){t.fadeOut(function(){e.remove(t)})}):e.removeAll()};var Vg=_t,Fg=wt,Hg=ut,Wg=ot,jg=[],Gg=[],Ug=[];function qg(t){return isNaN(t[0])||isNaN(t[1])}function Xg(t,e,n,r,i,o,a,s,l,u){return"none"!==u&&u?(function(t,e,n,r,i,o,a,s,l,u,c){for(var d=0,f=n,h=0;h<r;h++){var p=e[f];if(i<=f||f<0)break;if(qg(p)){if(c){f+=o;continue}break}if(f===n)t[0<o?"moveTo":"lineTo"](p[0],p[1]);else if(0<l){var g=e[d],m="y"===u?1:0,v=(p[m]-g[m])*l;Wg(Gg,g),Gg[m]=g[m]+v,Wg(Ug,p),Ug[m]=p[m]-v,t.bezierCurveTo(Gg[0],Gg[1],Ug[0],Ug[1],p[0],p[1])}else t.lineTo(p[0],p[1]);d=f,f+=o}return h}).apply(this,arguments):(function(t,e,n,r,i,o,a,s,l,u,c){for(var d=0,f=n,h=0;h<r;h++){var p=e[f];if(i<=f||f<0)break;if(qg(p)){if(c){f+=o;continue}break}if(f===n)t[0<o?"moveTo":"lineTo"](p[0],p[1]),Wg(Gg,p);else if(0<l){var g=f+o,m=e[g];if(c)for(;m&&qg(e[g]);)m=e[g+=o];var v=.5,y=e[d];if(!(m=e[g])||qg(m))Wg(Ug,p);else{var x,b;if(qg(m)&&!c&&(m=p),ct(jg,m,y),"x"===u||"y"===u){var _="x"===u?0:1;x=Math.abs(p[_]-y[_]),b=Math.abs(p[_]-m[_])}else x=mt(p,y),b=mt(p,m);Hg(Ug,p,jg,-l*(1-(v=b/(b+x))))}Vg(Gg,Gg,s),Fg(Gg,Gg,a),Vg(Ug,Ug,s),Fg(Ug,Ug,a),t.bezierCurveTo(Gg[0],Gg[1],Ug[0],Ug[1],p[0],p[1]),Hg(Gg,p,jg,l*v)}else t.lineTo(p[0],p[1]);d=f,f+=o}return h}).apply(this,arguments)}function Yg(t,e){var n=[1/0,1/0],r=[-1/0,-1/0];if(e)for(var i=0;i<t.length;i++){var o=t[i];o[0]<n[0]&&(n[0]=o[0]),o[1]<n[1]&&(n[1]=o[1]),o[0]>r[0]&&(r[0]=o[0]),o[1]>r[1]&&(r[1]=o[1])}return{min:e?n:r,max:e?r:n}}var $g=ha.extend({type:"ec-polyline",shape:{points:[],smooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},style:{fill:null,stroke:"#000"},brush:Oa(ha.prototype.brush),buildPath:function(t,e){var n=e.points,r=0,i=n.length,o=Yg(n,e.smoothConstraint);if(e.connectNulls){for(;0<i&&qg(n[i-1]);i--);for(;r<i&&qg(n[r]);r++);}for(;r<i;)r+=Xg(t,n,r,i,i,1,o.min,o.max,e.smooth,e.smoothMonotone,e.connectNulls)+1}}),Zg=ha.extend({type:"ec-polygon",shape:{points:[],stackedOnPoints:[],smooth:0,stackedOnSmooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},brush:Oa(ha.prototype.brush),buildPath:function(t,e){var n=e.points,r=e.stackedOnPoints,i=0,o=n.length,a=e.smoothMonotone,s=Yg(n,e.smoothConstraint),l=Yg(r,e.smoothConstraint);if(e.connectNulls){for(;0<o&&qg(n[o-1]);o--);for(;i<o&&qg(n[i]);i++);}for(;i<o;){var u=Xg(t,n,i,o,o,1,s.min,s.max,e.smooth,a,e.connectNulls);Xg(t,r,i+u-1,u,o,-1,l.min,l.max,e.stackedOnSmooth,a,e.connectNulls),i+=u+1,t.closePath()}}});function Kg(t,e,n){var r=t.getArea(),i=t.getBaseAxis().isHorizontal(),o=r.x,a=r.y,s=r.width,l=r.height,u=n.get("lineStyle.width")||2;o-=u/2,a-=u/2,s+=u,l+=u,o=Math.floor(o),s=Math.round(s);var c=new Ua({shape:{x:o,y:a,width:s,height:l}});return e&&(c.shape[i?"width":"height"]=0,Zs(c,{shape:{width:s,height:l}},n)),c}function Jg(t,e,n){var r=t.getArea(),i=new Ra({shape:{cx:_l(t.cx,1),cy:_l(t.cy,1),r0:_l(r.r0,1),r:_l(r.r,1),startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}});return e&&(i.shape.endAngle=r.startAngle,Zs(i,{shape:{endAngle:r.endAngle}},n)),i}function Qg(t,e,n){return t?"polar"===t.type?Jg(t,e,n):"cartesian2d"===t.type?Kg(t,e,n):null:null}function tm(t,e){if(t.length===e.length){for(var n=0;n<t.length;n++){var r=t[n],i=e[n];if(r[0]!==i[0]||r[1]!==i[1])return}return!0}}function em(t,e){var n=[],r=[],i=[],o=[];return Io(t,n,r),Io(e,i,o),Math.max(Math.abs(n[0]-i[0]),Math.abs(n[1]-i[1]),Math.abs(r[0]-o[0]),Math.abs(r[1]-o[1]))}function nm(t){return"number"==typeof t?t:t?.5:0}function rm(t,e,n){for(var r=e.getBaseAxis(),i="x"===r.dim||"radius"===r.dim?0:1,o=[],a=0;a<t.length-1;a++){var s=t[a+1],l=t[a];o.push(l);var u=[];switch(n){case"end":u[i]=s[i],u[1-i]=l[1-i],o.push(u);break;case"middle":var c=[];u[i]=c[i]=(l[i]+s[i])/2,u[1-i]=l[1-i],c[1-i]=s[1-i],o.push(u),o.push(c);break;default:u[i]=l[i],u[1-i]=s[1-i],o.push(u)}}return t[a]&&o.push(t[a]),o}function im(t,e,n){if("cartesian2d"!==t.type)return Jg(t,e,n);var r=t.getBaseAxis().isHorizontal(),i=Kg(t,e,n);if(!n.get("clip",!0)){var o=i.shape,a=Math.max(o.width,o.height);r?(o.y-=a,o.height+=2*a):(o.x-=a,o.width+=2*a)}return i}function om(t,e,n){return{seriesType:t,performRawSeries:!0,reset:function(t,r,i){var o=t.getData(),a=t.get("symbol"),s=t.get("symbolSize"),l=t.get("symbolKeepAspect"),u=t.get("symbolRotate"),c=L(a),d=L(s),f=L(u),h=c||d||f,p=!c&&a?a:e;if(o.setVisual({legendSymbol:n||p,symbol:p,symbolSize:d?null:s,symbolKeepAspect:l,symbolRotate:u}),!r.isSeriesFiltered(t))return{dataEach:o.hasItemOption||h?function(e,n){if(h){var r=t.getRawValue(n),i=t.getDataParams(n);c&&e.setItemVisual(n,"symbol",a(r,i)),d&&e.setItemVisual(n,"symbolSize",s(r,i)),f&&e.setItemVisual(n,"symbolRotate",u(r,i))}if(e.hasItemOption){var o=e.getItemModel(n),l=o.getShallow("symbol",!0),p=o.getShallow("symbolSize",!0),g=o.getShallow("symbolRotate",!0),m=o.getShallow("symbolKeepAspect",!0);null!=l&&e.setItemVisual(n,"symbol",l),null!=p&&e.setItemVisual(n,"symbolSize",p),null!=g&&e.setItemVisual(n,"symbolRotate",g),null!=m&&e.setItemVisual(n,"symbolKeepAspect",m)}}:null}}}}function am(t){return{seriesType:t,plan:Qc(),reset:function(t){var e=t.getData(),n=t.coordinateSystem,r=t.pipelineContext.large;if(n){var i=A(n.dimensions,function(t){return e.mapDimension(t)}).slice(0,2),o=i.length,a=e.getCalculationInfo("stackResultDimension");return Xh(e,i[0])&&(i[0]=a),Xh(e,i[1])&&(i[1]=a),o&&{progress:function(t,e){for(var a=r&&new Float32Array((t.end-t.start)*o),s=t.start,l=0,u=[],c=[];s<t.end;s++){var d;if(1===o){var f=e.get(i[0],s);d=!isNaN(f)&&n.dataToPoint(f,null,c)}else{f=u[0]=e.get(i[0],s);var h=u[1]=e.get(i[1],s);d=!isNaN(f)&&!isNaN(h)&&n.dataToPoint(u,null,c)}r?(a[l++]=d?d[0]:NaN,a[l++]=d?d[1]:NaN):e.setItemLayout(s,d&&d.slice()||[NaN,NaN])}r&&e.setLayout("symbolPoints",a)}}}}}}function sm(t,e){return Math.round(t.length/2)}nd.extend({type:"line",init:function(){var t=new Cn,e=new Pg;this.group.add(e.group),this._symbolDraw=e,this._lineGroup=t},render:function(t,e,n){var r=t.coordinateSystem,i=this.group,o=t.getData(),a=t.getModel("lineStyle"),s=t.getModel("areaStyle"),l=o.mapArray(o.getItemLayout),u="polar"===r.type,c=this._coordSys,d=this._symbolDraw,f=this._polyline,h=this._polygon,p=this._lineGroup,g=t.get("animation"),m=!s.isEmpty(),v=s.get("origin"),y=function(t,e,n){if(!n.valueDim)return[];for(var r=[],i=0,o=e.count();i<o;i++)r.push(zg(n,t,e,i));return r}(r,o,Bg(r,o,v)),x=t.get("showSymbol"),_=x&&!u&&function(t,e,n){var r=t.get("showAllSymbol"),i="auto"===r;if(!r||i){var o=n.getAxesByScale("ordinal")[0];if(o&&(!i||!function(t,e){var n=t.getExtent(),r=Math.abs(n[1]-n[0])/t.scale.count();isNaN(r)&&(r=0);for(var i=e.count(),o=Math.max(1,Math.round(i/5)),a=0;a<i;a+=o)if(1.5*wg.getSymbolSize(e,a)[t.isHorizontal()?1:0]>r)return!1;return!0}(o,e))){var a=e.mapDimension(o.dim),s={};return k(o.getViewLabels(),function(t){s[t.tickValue]=1}),function(t){return!s.hasOwnProperty(e.get(a,t))}}}}(t,o,r),w=this._data;w&&w.eachItemGraphicEl(function(t,e){t.__temp&&(i.remove(t),w.setItemGraphicEl(e,null))}),x||d.remove(),i.add(p);var S,C=!u&&t.get("step");r&&r.getArea&&t.get("clip",!0)&&(null!=(S=r.getArea()).width?(S.x-=.1,S.y-=.1,S.width+=.2,S.height+=.2):S.r0&&(S.r0-=.5,S.r1+=.5)),this._clipShapeForSymbol=S,f&&c.type===r.type&&C===this._step?(m&&!h?h=this._newPolygon(l,y,r,g):h&&!m&&(p.remove(h),h=this._polygon=null),p.setClipPath(im(r,!1,t)),x&&d.updateData(o,{isIgnore:_,clipShape:S}),o.eachItemGraphicEl(function(t){t.stopAnimation(!0)}),tm(this._stackedOnPoints,y)&&tm(this._points,l)||(g?this._updateAnimation(o,y,r,n,C,v):(C&&(l=rm(l,r,C),y=rm(y,r,C)),f.setShape({points:l}),h&&h.setShape({points:l,stackedOnPoints:y})))):(x&&d.updateData(o,{isIgnore:_,clipShape:S}),C&&(l=rm(l,r,C),y=rm(y,r,C)),f=this._newPolyline(l,r,g),m&&(h=this._newPolygon(l,y,r,g)),p.setClipPath(im(r,!0,t)));var M=function(t,e){var n=t.getVisual("visualMeta");if(n&&n.length&&t.count()&&"cartesian2d"===e.type){for(var r,i,o=n.length-1;0<=o;o--){var a=t.getDimensionInfo(t.dimensions[n[o].dimension]);if("x"===(r=a&&a.coordDim)||"y"===r){i=n[o];break}}if(i){var s=e.getAxis(r),l=A(i.stops,function(t){return{coord:s.toGlobalCoord(s.dataToCoord(t.value)),color:t.color}}),u=l.length,c=i.outerColors.slice();u&&l[0].coord>l[u-1].coord&&(l.reverse(),c.reverse());var d=l[0].coord-10,f=l[u-1].coord+10,h=f-d;if(h<.001)return"transparent";k(l,function(t){t.offset=(t.coord-d)/h}),l.push({offset:u?l[u-1].offset:.5,color:c[1]||"transparent"}),l.unshift({offset:u?l[0].offset:.5,color:c[0]||"transparent"});var p=new ts(0,0,0,0,l,!0);return p[r]=d,p[r+"2"]=f,p}}}(o,r)||o.getVisual("color");f.useStyle(b(a.getLineStyle(),{fill:"none",stroke:M,lineJoin:"bevel"}));var T=t.get("smooth");if(T=nm(t.get("smooth")),f.setShape({smooth:T,smoothMonotone:t.get("smoothMonotone"),connectNulls:t.get("connectNulls")}),h){var I=o.getCalculationInfo("stackedOnSeries"),D=0;h.useStyle(b(s.getAreaStyle(),{fill:M,opacity:.7,lineJoin:"bevel"})),I&&(D=nm(I.get("smooth"))),h.setShape({smooth:T,stackedOnSmooth:D,smoothMonotone:t.get("smoothMonotone"),connectNulls:t.get("connectNulls")})}this._data=o,this._coordSys=r,this._stackedOnPoints=y,this._points=l,this._step=C,this._valueOrigin=v},dispose:function(){},highlight:function(t,e,n,r){var i=t.getData(),o=Ri(i,r);if(!(o instanceof Array)&&null!=o&&0<=o){var a=i.getItemGraphicEl(o);if(!a){var s=i.getItemLayout(o);if(!s)return;if(this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(s[0],s[1]))return;(a=new wg(i,o)).position=s,a.setZ(t.get("zlevel"),t.get("z")),a.ignore=isNaN(s[0])||isNaN(s[1]),a.__temp=!0,i.setItemGraphicEl(o,a),a.stopSymbolAnimation(!0),this.group.add(a)}a.highlight()}else nd.prototype.highlight.call(this,t,e,n,r)},downplay:function(t,e,n,r){var i=t.getData(),o=Ri(i,r);if(null!=o&&0<=o){var a=i.getItemGraphicEl(o);a&&(a.__temp?(i.setItemGraphicEl(o,null),this.group.remove(a)):a.downplay())}else nd.prototype.downplay.call(this,t,e,n,r)},_newPolyline:function(t){var e=this._polyline;return e&&this._lineGroup.remove(e),e=new $g({shape:{points:t},silent:!0,z2:10}),this._lineGroup.add(e),this._polyline=e},_newPolygon:function(t,e){var n=this._polygon;return n&&this._lineGroup.remove(n),n=new Zg({shape:{points:t,stackedOnPoints:e},silent:!0}),this._lineGroup.add(n),this._polygon=n},_updateAnimation:function(t,e,n,r,i,o){var a=this._polyline,s=this._polygon,l=t.hostModel,u=function(t,e,n,r,i,o,a,s){for(var l=function(t,e){var n=[];return e.diff(t).add(function(t){n.push({cmd:"+",idx:t})}).update(function(t,e){n.push({cmd:"=",idx:e,idx1:t})}).remove(function(t){n.push({cmd:"-",idx:t})}).execute(),n}(t,e),u=[],c=[],d=[],f=[],h=[],p=[],g=[],m=Bg(i,e,a),v=Bg(o,t,s),y=0;y<l.length;y++){var x=l[y],b=!0;switch(x.cmd){case"=":var _=t.getItemLayout(x.idx),w=e.getItemLayout(x.idx1);(isNaN(_[0])||isNaN(_[1]))&&(_=w.slice()),u.push(_),c.push(w),d.push(n[x.idx]),f.push(r[x.idx1]),g.push(e.getRawIndex(x.idx1));break;case"+":var S=x.idx;u.push(i.dataToPoint([e.get(m.dataDimsForPoint[0],S),e.get(m.dataDimsForPoint[1],S)])),c.push(e.getItemLayout(S).slice()),d.push(zg(m,i,e,S)),f.push(r[S]),g.push(e.getRawIndex(S));break;case"-":var C=t.getRawIndex(S=x.idx);C!==S?(u.push(t.getItemLayout(S)),c.push(o.dataToPoint([t.get(v.dataDimsForPoint[0],S),t.get(v.dataDimsForPoint[1],S)])),d.push(n[S]),f.push(zg(v,o,t,S)),g.push(C)):b=!1}b&&(h.push(x),p.push(p.length))}p.sort(function(t,e){return g[t]-g[e]});var M=[],T=[],k=[],A=[],I=[];for(y=0;y<p.length;y++)M[y]=u[S=p[y]],T[y]=c[S],k[y]=d[S],A[y]=f[S],I[y]=h[S];return{current:M,next:T,stackedOnCurrent:k,stackedOnNext:A,status:I}}(this._data,t,this._stackedOnPoints,e,this._coordSys,n,this._valueOrigin,o),c=u.current,d=u.stackedOnCurrent,f=u.next,h=u.stackedOnNext;if(i&&(c=rm(u.current,n,i),d=rm(u.stackedOnCurrent,n,i),f=rm(u.next,n,i),h=rm(u.stackedOnNext,n,i)),3e3<em(c,f)||s&&3e3<em(d,h))return a.setShape({points:f}),void(s&&s.setShape({points:f,stackedOnPoints:h}));a.shape.__points=u.current,a.shape.points=c,$s(a,{shape:{points:f}},l),s&&(s.setShape({points:c,stackedOnPoints:d}),$s(s,{shape:{points:f,stackedOnPoints:h}},l));for(var p=[],g=u.status,m=0;m<g.length;m++)if("="===g[m].cmd){var v=t.getItemGraphicEl(g[m].idx1);v&&p.push({el:v,ptIdx:m})}a.animators&&a.animators.length&&a.animators[0].during(function(){for(var t=0;t<p.length;t++)p[t].el.attr("position",a.shape.__points[p[t].ptIdx])})},remove:function(t){var e=this.group,n=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),n&&n.eachItemGraphicEl(function(t,r){t.__temp&&(e.remove(t),n.setItemGraphicEl(r,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._data=null}});var lm={average:function(t){for(var e=0,n=0,r=0;r<t.length;r++)isNaN(t[r])||(e+=t[r],n++);return 0===n?NaN:e/n},sum:function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n]||0;return e},max:function(t){for(var e=-1/0,n=0;n<t.length;n++)t[n]>e&&(e=t[n]);return isFinite(e)?e:NaN},min:function(t){for(var e=1/0,n=0;n<t.length;n++)t[n]<e&&(e=t[n]);return isFinite(e)?e:NaN},nearest:function(t){return t[0]}};function um(t){return this._axes[t]}function cm(t){this._axes={},this._dimList=[],this.name=t||""}function dm(t){cm.call(this,t)}function fm(t,e,n,r,i){mg.call(this,t,e,n),this.type=r||"value",this.position=i||"bottom"}cm.prototype={constructor:cm,type:"cartesian",getAxis:function(t){return this._axes[t]},getAxes:function(){return A(this._dimList,um,this)},getAxesByScale:function(t){return t=t.toLowerCase(),D(this.getAxes(),function(e){return e.scale.type===t})},addAxis:function(t){var e=t.dim;this._axes[e]=t,this._dimList.push(e)},dataToCoord:function(t){return this._dataCoordConvert(t,"dataToCoord")},coordToData:function(t){return this._dataCoordConvert(t,"coordToData")},_dataCoordConvert:function(t,e){for(var n=this._dimList,r=t instanceof Array?[]:{},i=0;i<n.length;i++){var o=n[i];r[o]=this._axes[o][e](t[o])}return r}},dm.prototype={constructor:dm,type:"cartesian2d",dimensions:["x","y"],getBaseAxis:function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},containPoint:function(t){var e=this.getAxis("x"),n=this.getAxis("y");return e.contain(e.toLocalCoord(t[0]))&&n.contain(n.toLocalCoord(t[1]))},containData:function(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1])},dataToPoint:function(t,e,n){var r=this.getAxis("x"),i=this.getAxis("y");return(n=n||[])[0]=r.toGlobalCoord(r.dataToCoord(t[0])),n[1]=i.toGlobalCoord(i.dataToCoord(t[1])),n},clampData:function(t,e){var n=this.getAxis("x").scale,r=this.getAxis("y").scale,i=n.getExtent(),o=r.getExtent(),a=n.parse(t[0]),s=r.parse(t[1]);return(e=e||[])[0]=Math.min(Math.max(Math.min(i[0],i[1]),a),Math.max(i[0],i[1])),e[1]=Math.min(Math.max(Math.min(o[0],o[1]),s),Math.max(o[0],o[1])),e},pointToData:function(t,e){var n=this.getAxis("x"),r=this.getAxis("y");return(e=e||[])[0]=n.coordToData(n.toLocalCoord(t[0])),e[1]=r.coordToData(r.toLocalCoord(t[1])),e},getOtherAxis:function(t){return this.getAxis("x"===t.dim?"y":"x")},getArea:function(){var t=this.getAxis("x").getGlobalExtent(),e=this.getAxis("y").getGlobalExtent(),n=Math.min(t[0],t[1]),r=Math.min(e[0],e[1]);return new Sn(n,r,Math.max(t[0],t[1])-n,Math.max(e[0],e[1])-r)}},C(dm,cm),fm.prototype={constructor:fm,index:0,getAxesOnZeroOf:null,model:null,isHorizontal:function(){var t=this.position;return"top"===t||"bottom"===t},getGlobalExtent:function(t){var e=this.getExtent();return e[0]=this.toGlobalCoord(e[0]),e[1]=this.toGlobalCoord(e[1]),t&&e[0]>e[1]&&e.reverse(),e},getOtherAxis:function(){this.grid.getOtherAxis()},pointToData:function(t,e){return this.coordToData(this.toLocalCoord(t["x"===this.dim?0:1]),e)},toLocalCoord:null,toGlobalCoord:null},C(fm,mg);var hm={show:!0,zlevel:0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#333",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},pm={};function gm(t,e,n,r){k(mm,function(i){e.extend({type:t+"Axis."+i,mergeDefaultAndTheme:function(e,r){var o=this.layoutMode,a=o?uu(e):{};v(e,r.getTheme().get(i+"Axis")),v(e,this.getDefaultOption()),e.type=n(t,e),o&&lu(e,a,o)},optionUpdated:function(){"category"===this.option.type&&(this.__ordinalMeta=Kh.createByAxisModel(this))},getCategories:function(t){var e=this.option;if("category"===e.type)return t?e.data:this.__ordinalMeta.categories},getOrdinalMeta:function(){return this.__ordinalMeta},defaultOption:y([{},pm[i+"Axis"],r],!0)})}),gu.registerSubTypeDefaulter(t+"Axis",E(n,t))}pm.categoryAxis=v({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},hm),pm.valueAxis=v({boundaryGap:[0,0],splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#eee",width:1}}},hm),pm.timeAxis=b({scale:!0,min:"dataMin",max:"dataMax"},pm.valueAxis),pm.logAxis=b({scale:!0,logBase:10},pm.valueAxis);var mm=["value","category","time","log"],vm=gu.extend({type:"cartesian2dAxis",axis:null,init:function(){vm.superApply(this,"init",arguments),this.resetRange()},mergeOption:function(){vm.superApply(this,"mergeOption",arguments),this.resetRange()},restoreData:function(){vm.superApply(this,"restoreData",arguments),this.resetRange()},getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid",index:this.option.gridIndex,id:this.option.gridId})[0]}});function ym(t,e){return e.type||(e.data?"category":"value")}v(vm.prototype,qp);var xm={offset:0};function bm(t,e){return t.getCoordSysModel()===e}function _m(t,e,n){this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this._initCartesian(t,e,n),this.model=t}gm("x",vm,ym,xm),gm("y",vm,ym,xm),gu.extend({type:"grid",dependencies:["xAxis","yAxis"],layoutMode:"box",coordinateSystem:null,defaultOption:{show:!1,zlevel:0,z:0,left:"10%",top:60,right:"10%",bottom:60,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"}});var wm=_m.prototype;function Sm(t,e,n,r){n.getAxesOnZeroOf=function(){return i?[i]:[]};var i,o=t[e],a=n.model,s=a.get("axisLine.onZero"),l=a.get("axisLine.onZeroAxisIndex");if(s){if(null!=l)Cm(o[l])&&(i=o[l]);else for(var u in o)if(o.hasOwnProperty(u)&&Cm(o[u])&&!r[c(o[u])]){i=o[u];break}i&&(r[c(i)]=!0)}function c(t){return t.dim+"_"+t.index}}function Cm(t){return t&&"category"!==t.type&&"time"!==t.type&&function(t){var e=t.scale.getExtent(),n=e[0],r=e[1];return!(0<n&&0<r||n<0&&r<0)}(t)}wm.type="grid",wm.axisPointerEnabled=!0,wm.getRect=function(){return this._rect},wm.update=function(t,e){var n=this._axesMap;this._updateScale(t,this.model),k(n.x,function(t){Fp(t.scale,t.model)}),k(n.y,function(t){Fp(t.scale,t.model)});var r={};k(n.x,function(t){Sm(n,"y",t,r)}),k(n.y,function(t){Sm(n,"x",t,r)}),this.resize(this.model,e)},wm.resize=function(t,e,n){var r=au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});this._rect=r;var i=this._axesList;function o(){k(i,function(t){var e=t.isHorizontal(),n=e?[0,r.width]:[0,r.height],i=t.inverse?1:0;t.setExtent(n[i],n[1-i]),function(t,e){var n=t.getExtent(),r=n[0]+n[1];t.toGlobalCoord="x"===t.dim?function(t){return t+e}:function(t){return r-t+e},t.toLocalCoord="x"===t.dim?function(t){return t-e}:function(t){return r-t+e}}(t,e?r.x:r.y)})}o(),!n&&t.get("containLabel")&&(k(i,function(t){if(!t.model.get("axisLabel.inside")){var e=function(t){var e=t.scale;if(t.model.get("axisLabel.show")&&!e.isBlank()){var n,r,i="category"===t.type,o=e.getExtent();r=i?e.count():(n=e.getTicks()).length;var a,s,l,u,c,d,f,h,p=t.getLabelModel(),g=Wp(t),m=1;40<r&&(m=Math.ceil(r/40));for(var v=0;v<r;v+=m){var y=g(n?n[v]:o[0]+v),x=(s=p.getTextRect(y),l=(p.get("rotate")||0)*Math.PI/180,d=(u=s.plain()).height,f=(c=u.width)*Math.abs(Math.cos(l))+Math.abs(d*Math.sin(l)),h=c*Math.abs(Math.sin(l))+Math.abs(d*Math.cos(l)),new Sn(u.x,u.y,f,h));a?a.union(x):a=x}return a}}(t);if(e){var n=t.isHorizontal()?"height":"width",i=t.model.get("axisLabel.margin");r[n]-=e[n]+i,"top"===t.position?r.y+=e.height+i:"left"===t.position&&(r.x+=e.width+i)}}}),o())},wm.getAxis=function(t,e){var n=this._axesMap[t];if(null!=n){if(null==e)for(var r in n)if(n.hasOwnProperty(r))return n[r];return n[e]}},wm.getAxes=function(){return this._axesList.slice()},wm.getCartesian=function(t,e){if(null!=t&&null!=e)return this._coordsMap["x"+t+"y"+e];B(t)&&(e=t.yAxisIndex,t=t.xAxisIndex);for(var n=0,r=this._coordsList;n<r.length;n++)if(r[n].getAxis("x").index===t||r[n].getAxis("y").index===e)return r[n]},wm.getCartesians=function(){return this._coordsList.slice()},wm.convertToPixel=function(t,e,n){var r=this._findConvertTarget(t,e);return r.cartesian?r.cartesian.dataToPoint(n):r.axis?r.axis.toGlobalCoord(r.axis.dataToCoord(n)):null},wm.convertFromPixel=function(t,e,n){var r=this._findConvertTarget(t,e);return r.cartesian?r.cartesian.pointToData(n):r.axis?r.axis.coordToData(r.axis.toLocalCoord(n)):null},wm._findConvertTarget=function(t,e){var n,r,i=e.seriesModel,o=e.xAxisModel||i&&i.getReferringComponents("xAxis")[0],a=e.yAxisModel||i&&i.getReferringComponents("yAxis")[0],s=e.gridModel;return i?S(this._coordsList,n=i.coordinateSystem)<0&&(n=null):o&&a?n=this.getCartesian(o.componentIndex,a.componentIndex):o?r=this.getAxis("x",o.componentIndex):a?r=this.getAxis("y",a.componentIndex):s&&s.coordinateSystem===this&&(n=this._coordsList[0]),{cartesian:n,axis:r}},wm.containPoint=function(t){var e=this._coordsList[0];if(e)return e.containPoint(t)},wm._initCartesian=function(t,e,n){var r={left:!1,right:!1,top:!1,bottom:!1},i={x:{},y:{}},o={x:0,y:0};if(e.eachComponent("xAxis",a("x"),this),e.eachComponent("yAxis",a("y"),this),!o.x||!o.y)return this._axesMap={},void(this._axesList=[]);function a(e){return function(n,a){if(bm(n,t)){var s=n.get("position");"x"===e?"top"!==s&&"bottom"!==s&&(s=r.bottom?"top":"bottom"):"left"!==s&&"right"!==s&&(s=r.left?"right":"left"),r[s]=!0;var l=new fm(e,Hp(n),[0,0],n.get("type"),s);l.onBand="category"===l.type&&n.get("boundaryGap"),l.inverse=n.get("inverse"),(n.axis=l).model=n,l.grid=this,l.index=a,this._axesList.push(l),i[e][a]=l,o[e]++}}}k((this._axesMap=i).x,function(e,n){k(i.y,function(r,i){var o="x"+n+"y"+i,a=new dm(o);a.grid=this,a.model=t,this._coordsMap[o]=a,this._coordsList.push(a),a.addAxis(e),a.addAxis(r)},this)},this)},wm._updateScale=function(t,e){function n(t,e){k(t.mapDimension(e.dim,!0),function(n){e.scale.unionExtentFromData(t,Yh(t,n))})}k(this._axesList,function(t){t.scale.setExtent(1/0,-1/0)}),t.eachSeries(function(t){if(km(t)){var r=Tm(t),i=r[0],o=r[1];if(!bm(i,e)||!bm(o,e))return;var a=this.getCartesian(i.componentIndex,o.componentIndex),s=t.getData(),l=a.getAxis("x"),u=a.getAxis("y");"list"===s.type&&(n(s,l),n(s,u))}},this)},wm.getTooltipAxes=function(t){var e=[],n=[];return k(this.getCartesians(),function(r){var i=null!=t&&"auto"!==t?r.getAxis(t):r.getBaseAxis(),o=r.getOtherAxis(i);S(e,i)<0&&e.push(i),S(n,o)<0&&n.push(o)}),{baseAxes:e,otherAxes:n}};var Mm=["xAxis","yAxis"];function Tm(t){return A(Mm,function(e){return t.getReferringComponents(e)[0]})}function km(t){return"cartesian2d"===t.get("coordinateSystem")}function Am(t,e){this.opt=e,this.axisModel=t,b(e,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0}),this.group=new Cn;var n=new Cn({position:e.position.slice(),rotation:e.rotation});n.updateTransform(),this._transform=n.transform,this._dumbGroup=n}_m.create=function(t,e){var n=[];return t.eachComponent("grid",function(r,i){var o=new _m(r,t,e);o.name="grid_"+i,o.resize(r,e,!0),r.coordinateSystem=o,n.push(o)}),t.eachSeries(function(t){if(km(t)){var e=Tm(t),n=e[0],r=e[1],i=n.getCoordSysModel().coordinateSystem;t.coordinateSystem=i.getCartesian(n.componentIndex,r.componentIndex)}}),n},_m.dimensions=_m.prototype.dimensions=dm.prototype.dimensions,Uu.register("cartesian2d",_m);var Im=Math.PI;Am.prototype={constructor:Am,hasBuilder:function(t){return!!Dm[t]},add:function(t){Dm[t].call(this)},getGroup:function(){return this.group}};var Dm={axisLine:function(){var t=this.opt,e=this.axisModel;if(e.get("axisLine.show")){var n=this.axisModel.axis.getExtent(),r=this._transform,i=[n[0],0],o=[n[1],0];r&&(bt(i,i,r),bt(o,o,r));var a=x({lineCap:"round"},e.getModel("axisLine.lineStyle").getLineStyle());this.group.add(new Xa({anid:"line",subPixelOptimize:!0,shape:{x1:i[0],y1:i[1],x2:o[0],y2:o[1]},style:a,strokeContainThreshold:t.strokeContainThreshold||5,silent:!0,z2:1}));var s=e.get("axisLine.symbol"),l=e.get("axisLine.symbolSize"),u=e.get("axisLine.symbolOffset")||0;if("number"==typeof u&&(u=[u,u]),null!=s){"string"==typeof s&&(s=[s,s]),"string"!=typeof l&&"number"!=typeof l||(l=[l,l]);var c=l[0],d=l[1];k([{rotate:t.rotation+Math.PI/2,offset:u[0],r:0},{rotate:t.rotation-Math.PI/2,offset:u[1],r:Math.sqrt((i[0]-o[0])*(i[0]-o[0])+(i[1]-o[1])*(i[1]-o[1]))}],function(e,n){if("none"!==s[n]&&null!=s[n]){var r=eg(s[n],-c/2,-d/2,c,d,a.stroke,!0),o=e.r+e.offset,l=[i[0]+o*Math.cos(t.rotation),i[1]-o*Math.sin(t.rotation)];r.attr({rotation:e.rotate,position:l,silent:!0,z2:11}),this.group.add(r)}},this)}}},axisTickLabel:function(){var t=this.axisModel,e=this.opt,n=function(t,e,n){var r=e.axis,i=e.getModel("axisTick");if(i.get("show")&&!r.scale.isBlank()){for(var o=i.getModel("lineStyle"),a=n.tickDirection*i.get("length"),s=Bm(r.getTicksCoords(),t._transform,a,b(o.getLineStyle(),{stroke:e.get("axisLine.lineStyle.color")}),"ticks"),l=0;l<s.length;l++)t.group.add(s[l]);return s}}(this,t,e);!function(t,e,n){if(!Up(t.axis)){var r=t.get("axisLabel.showMinLabel"),i=t.get("axisLabel.showMaxLabel"),o=(e=e||[])[0],a=e[1],s=e[e.length-1],l=e[e.length-2],u=(n=n||[])[0],c=n[1],d=n[n.length-1],f=n[n.length-2];!1===r?(Rm(o),Rm(u)):Lm(o,a)&&(r?(Rm(a),Rm(c)):(Rm(o),Rm(u))),!1===i?(Rm(s),Rm(d)):Lm(l,s)&&(i?(Rm(l),Rm(f)):(Rm(s),Rm(d)))}}(t,function(t,e,n){var r=e.axis;if(W(n.axisLabelShow,e.get("axisLabel.show"))&&!r.scale.isBlank()){var i=e.getModel("axisLabel"),o=i.get("margin"),a=r.getViewLabels(),s=(W(n.labelRotate,i.get("rotate"))||0)*Im/180,l=Pm(n.rotation,s,n.labelDirection),u=e.getCategories&&e.getCategories(!0),c=[],d=Em(e),f=e.get("triggerEvent");return k(a,function(a,s){var h=a.tickValue,p=a.formattedLabel,g=a.rawLabel,m=i;u&&u[h]&&u[h].textStyle&&(m=new hl(u[h].textStyle,i,e.ecModel));var v=m.getTextColor()||e.get("axisLine.lineStyle.color"),y=[r.dataToCoord(h),n.labelOffset+n.labelDirection*o],x=new Da({anid:"label_"+h,position:y,rotation:l.rotation,silent:d,z2:10});Hs(x.style,m,{text:p,textAlign:m.getShallow("align",!0)||l.textAlign,textVerticalAlign:m.getShallow("verticalAlign",!0)||m.getShallow("baseline",!0)||l.textVerticalAlign,textFill:"function"==typeof v?v("category"===r.type?g:"value"===r.type?h+"":h,s):v}),f&&(x.eventData=Om(e),x.eventData.targetType="axisLabel",x.eventData.value=g),t._dumbGroup.add(x),x.updateTransform(),c.push(x),t.group.add(x),x.decomposeTransform()}),c}}(this,t,e),n),function(t,e,n){var r=e.axis,i=e.getModel("minorTick");if(i.get("show")&&!r.scale.isBlank()){var o=r.getMinorTicksCoords();if(o.length)for(var a=i.getModel("lineStyle"),s=n.tickDirection*i.get("length"),l=b(a.getLineStyle(),b(e.getModel("axisTick").getLineStyle(),{stroke:e.get("axisLine.lineStyle.color")})),u=0;u<o.length;u++)for(var c=Bm(o[u],t._transform,s,l,"minorticks_"+u),d=0;d<c.length;d++)t.group.add(c[d])}}(this,t,e)},axisName:function(){var t=this.opt,e=this.axisModel,n=W(t.axisName,e.get("name"));if(n){var r,i,o=e.get("nameLocation"),a=t.nameDirection,s=e.getModel("nameTextStyle"),l=e.get("nameGap")||0,u=this.axisModel.axis.getExtent(),c=u[0]>u[1]?-1:1,d=["start"===o?u[0]-c*l:"end"===o?u[1]+c*l:(u[0]+u[1])/2,Nm(o)?t.labelOffset+a*l:0],f=e.get("nameRotate");null!=f&&(f=f*Im/180),Nm(o)?r=Pm(t.rotation,null!=f?f:t.rotation,a):(r=function(t,e,n,r){var i,o=Al(n-t.rotation),a=r[0]>r[1],s="start"===e&&!a||"start"!==e&&a;return{rotation:o,textAlign:Il(o-Im/2)?(i=s?"bottom":"top","center"):Il(o-1.5*Im)?(i=s?"top":"bottom","center"):(i="middle",o<1.5*Im&&Im/2<o?s?"left":"right":s?"right":"left"),textVerticalAlign:i}}(t,o,f||0,u),null!=(i=t.axisNameAvailableWidth)&&(i=Math.abs(i/Math.sin(r.rotation)),isFinite(i)||(i=null)));var h=s.getFont(),p=e.get("nameTruncate",!0)||{},g=p.ellipsis,m=W(t.nameTruncateMaxWidth,p.maxWidth,i),v=null!=g&&null!=m?Jl(n,m,h,g,{minChar:2,placeholder:p.placeholder}):n,y=e.get("tooltip",!0),b=e.mainType,_={componentType:b,name:n,$vars:["name"]};_[b+"Index"]=e.componentIndex;var w=new Da({anid:"name",__fullText:n,__truncatedText:v,position:d,rotation:r.rotation,silent:Em(e),z2:1,tooltip:y&&y.show?x({content:n,formatter:function(){return n},formatterParams:_},y):null});Hs(w.style,s,{text:v,textFont:h,textFill:s.getTextColor()||e.get("axisLine.lineStyle.color"),textAlign:s.get("align")||r.textAlign,textVerticalAlign:s.get("verticalAlign")||r.textVerticalAlign}),e.get("triggerEvent")&&(w.eventData=Om(e),w.eventData.targetType="axisName",w.eventData.name=n),this._dumbGroup.add(w),w.updateTransform(),this.group.add(w),w.decomposeTransform()}}},Om=Am.makeAxisEventDataBase=function(t){var e={componentType:t.mainType,componentIndex:t.componentIndex};return e[t.mainType+"Index"]=t.componentIndex,e},Pm=Am.innerTextLayout=function(t,e,n){var r,i=Al(e-t);return{rotation:i,textAlign:Il(i)?(r=0<n?"top":"bottom","center"):Il(i-Im)?(r=0<n?"bottom":"top","center"):(r="middle",0<i&&i<Im?0<n?"right":"left":0<n?"left":"right"),textVerticalAlign:r}},Em=Am.isLabelSilent=function(t){var e=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||e&&e.show)};function Rm(t){t&&(t.ignore=!0)}function Lm(t,e){var n=t&&t.getBoundingRect().clone(),r=e&&e.getBoundingRect().clone();if(n&&r){var i=ie([]);return le(i,i,-t.rotation),n.applyTransform(ae([],i,t.getLocalTransform())),r.applyTransform(ae([],i,e.getLocalTransform())),n.intersect(r)}}function Nm(t){return"middle"===t||"center"===t}function Bm(t,e,n,r,i){for(var o=[],a=[],s=[],l=0;l<t.length;l++){var u=t[l].coord;a[0]=u,s[a[1]=0]=u,s[1]=n,e&&(bt(a,a,e),bt(s,s,e));var c=new Xa({anid:i+"_"+t[l].tickValue,subPixelOptimize:!0,shape:{x1:a[0],y1:a[1],x2:s[0],y2:s[1]},style:r,z2:2,silent:!0});o.push(c)}return o}var zm=k,Vm=E;function Fm(t,e){return"all"===t||R(t)&&0<=S(t,e)||t===e}function Hm(t){var e=(t.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return e&&e.axesInfo[jm(t)]}function Wm(t){return!!t.get("handle.show")}function jm(t){return t.type+"||"+t.id}var Gm=lh({type:"axis",_axisPointer:null,axisPointerClass:null,render:function(t,e,n,r){this.axisPointerClass&&function(t){var e=Hm(t);if(e){var n=e.axisPointerModel,r=e.axis.scale,i=n.option,o=n.get("status"),a=n.get("value");null!=a&&(a=r.parse(a));var s=Wm(n);null==o&&(i.status=s?"show":"hide");var l=r.getExtent().slice();l[0]>l[1]&&l.reverse(),(null==a||a>l[1])&&(a=l[1]),a<l[0]&&(a=l[0]),i.value=a,s&&(i.status=e.axis.scale.isBlank()?"hide":"show")}}(t),Gm.superApply(this,"render",arguments),Um(this,t,0,n,0,!0)},updateAxisPointer:function(t,e,n,r,i){Um(this,t,0,n,0,!1)},remove:function(t,e){var n=this._axisPointer;n&&n.remove(e),Gm.superApply(this,"remove",arguments)},dispose:function(t,e){qm(this,e),Gm.superApply(this,"dispose",arguments)}});function Um(t,e,n,r,i,o){var a=Gm.getAxisPointerClass(t.axisPointerClass);if(a){var s=function(t){var e=Hm(t);return e&&e.axisPointerModel}(e);s?(t._axisPointer||(t._axisPointer=new a)).render(e,s,r,o):qm(t,r)}}function qm(t,e,n){var r=t._axisPointer;r&&r.dispose(e,n),t._axisPointer=null}var Xm=[];function Ym(t,e,n){n=n||{};var r=t.coordinateSystem,i=e.axis,o={},a=i.getAxesOnZeroOf()[0],s=i.position,l=a?"onZero":s,u=i.dim,c=r.getRect(),d=[c.x,c.x+c.width,c.y,c.y+c.height],f={left:0,right:1,top:0,bottom:1,onZero:2},h=e.get("offset")||0,p="x"===u?[d[2]-h,d[3]+h]:[d[0]-h,d[1]+h];if(a){var g=a.toGlobalCoord(a.dataToCoord(0));p[f.onZero]=Math.max(Math.min(g,p[1]),p[0])}o.position=["y"===u?p[f[l]]:d[0],"x"===u?p[f[l]]:d[3]],o.rotation=Math.PI/2*("x"===u?0:1),o.labelDirection=o.tickDirection=o.nameDirection={top:-1,bottom:1,left:-1,right:1}[s],o.labelOffset=a?p[f[s]]-p[f.onZero]:0,e.get("axisTick.inside")&&(o.tickDirection=-o.tickDirection),W(n.labelInside,e.get("axisLabel.inside"))&&(o.labelDirection=-o.labelDirection);var m=e.get("axisLabel.rotate");return o.labelRotate="top"===l?-m:m,o.z2=1,o}function $m(t,e,n,r){var i=n.axis;if(!i.scale.isBlank()){var o=n.getModel("splitArea"),a=o.getModel("areaStyle"),s=a.get("color"),l=r.coordinateSystem.getRect(),u=i.getTicksCoords({tickModel:o,clamp:!0});if(u.length){var c=s.length,d=t.__splitAreaColors,f=Q(),h=0;if(d)for(var p=0;p<u.length;p++){var g=d.get(u[p].tickValue);if(null!=g){h=(g+(c-1)*p)%c;break}}var m=i.toGlobalCoord(u[0].coord),v=a.getAreaStyle();for(s=R(s)?s:[s],p=1;p<u.length;p++){var y,x,_,w,S=i.toGlobalCoord(u[p].coord);m=i.isHorizontal()?(x=l.y,w=l.height,(y=m)+(_=S-y)):(y=l.x,_=l.width,(x=m)+(w=S-x));var C=u[p-1].tickValue;null!=C&&f.set(C,h),e.add(new Ua({anid:null!=C?"area_"+C:null,shape:{x:y,y:x,width:_,height:w},style:b({fill:s[h]},v),silent:!0})),h=(h+1)%c}t.__splitAreaColors=f}}}function Zm(t){t.__splitAreaColors=null}Gm.registerAxisPointerClass=function(t,e){Xm[t]=e},Gm.getAxisPointerClass=function(t){return t&&Xm[t]};var Km=["axisLine","axisTickLabel","axisName"],Jm=["splitArea","splitLine","minorSplitLine"],Qm=Gm.extend({type:"cartesianAxis",axisPointerClass:"CartesianAxisPointer",render:function(t,e,n,r){this.group.removeAll();var i=this._axisGroup;if(this._axisGroup=new Cn,this.group.add(this._axisGroup),t.get("show")){var o=t.getCoordSysModel(),a=Ym(o,t),s=new Am(t,a);k(Km,s.add,s),this._axisGroup.add(s.getGroup()),k(Jm,function(e){t.get(e+".show")&&this["_"+e](t,o)},this),tl(i,this._axisGroup,t),Qm.superCall(this,"render",t,e,n,r)}},remove:function(){Zm(this)},_splitLine:function(t,e){var n=t.axis;if(!n.scale.isBlank()){var r=t.getModel("splitLine"),i=r.getModel("lineStyle"),o=i.get("color");o=R(o)?o:[o];for(var a=e.coordinateSystem.getRect(),s=n.isHorizontal(),l=0,u=n.getTicksCoords({tickModel:r}),c=[],d=[],f=i.getLineStyle(),h=0;h<u.length;h++){var p=n.toGlobalCoord(u[h].coord);s?(c[0]=p,c[1]=a.y,d[0]=p,d[1]=a.y+a.height):(c[0]=a.x,c[1]=p,d[0]=a.x+a.width,d[1]=p);var g=l++%o.length;this._axisGroup.add(new Xa({anid:null!=u[h].tickValue?"line_"+u[h].tickValue:null,subPixelOptimize:!0,shape:{x1:c[0],y1:c[1],x2:d[0],y2:d[1]},style:b({stroke:o[g]},f),silent:!0}))}}},_minorSplitLine:function(t,e){var n=t.axis,r=t.getModel("minorSplitLine").getModel("lineStyle"),i=e.coordinateSystem.getRect(),o=n.isHorizontal(),a=n.getMinorTicksCoords();if(a.length)for(var s=[],l=[],u=r.getLineStyle(),c=0;c<a.length;c++)for(var d=0;d<a[c].length;d++){var f=n.toGlobalCoord(a[c][d].coord);o?(s[0]=f,s[1]=i.y,l[0]=f,l[1]=i.y+i.height):(s[0]=i.x,s[1]=f,l[0]=i.x+i.width,l[1]=f),this._axisGroup.add(new Xa({anid:"minor_line_"+a[c][d].tickValue,subPixelOptimize:!0,shape:{x1:s[0],y1:s[1],x2:l[0],y2:l[1]},style:u,silent:!0}))}},_splitArea:function(t,e){$m(this,this._axisGroup,t,e)}});Qm.extend({type:"xAxis"}),Qm.extend({type:"yAxis"}),lh({type:"grid",render:function(t,e){this.group.removeAll(),t.get("show")&&this.group.add(new Ua({shape:t.coordinateSystem.getRect(),style:b({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}))}}),Qf(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})}),ih(om("line","circle","line")),rh(am("line")),th(ff.PROCESSOR.STATISTIC,{seriesType:"line",modifyOutputEnd:!0,reset:function(t,e,n){var r=t.getData(),i=t.get("sampling"),o=t.coordinateSystem;if("cartesian2d"===o.type&&i){var a,s=o.getBaseAxis(),l=o.getOtherAxis(s),u=s.getExtent(),c=Math.abs(u[1]-u[0]),d=Math.round(r.count()/c);1<d&&("string"==typeof i?a=lm[i]:"function"==typeof i&&(a=i),a&&t.setData(r.downSample(r.mapDimension(l.dim),1/d,a,sm)))}}});var tv=jc.extend({type:"series.__base_bar__",getInitialData:function(t,e){return $h(this.getSource(),this,{useEncodeDefaulter:!0})},getMarkerPosition:function(t){var e=this.coordinateSystem;if(e){var n=e.dataToPoint(e.clampData(t)),r=this.getData(),i=r.getLayout("offset"),o=r.getLayout("size");return n[e.getBaseAxis().isHorizontal()?0:1]+=i+o/2,n}return[NaN,NaN]},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod",itemStyle:{},emphasis:{}}});function ev(t,e,n,r,i,o){Vs(t,e,n.getModel("label"),n.getModel("emphasis.label"),{labelFetcher:i,labelDataIndex:o,defaultText:_g(i.getData(),o),isRectText:!0,autoColor:r}),nv(t),nv(e)}function nv(t,e){"outside"===t.textPosition&&(t.textPosition=e)}tv.extend({type:"series.bar",dependencies:["grid","polar"],brushSelector:"rect",getProgressive:function(){return!!this.get("large")&&this.get("progressive")},getProgressiveThreshold:function(){var t=this.get("progressiveThreshold"),e=this.get("largeThreshold");return t<e&&(t=e),t},defaultOption:{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1}}});var rv=Zi([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["stroke","barBorderColor"],["lineWidth","barBorderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),iv={getBarItemStyle:function(t){var e=rv(this,t);if(this.getBorderLineDash){var n=this.getBorderLineDash();n&&(e.lineDash=n)}return e}},ov=hs({type:"sausage",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},buildPath:function(t,e){var n=e.cx,r=e.cy,i=Math.max(e.r0||0,0),o=Math.max(e.r,0),a=.5*(o-i),s=i+a,l=e.startAngle,u=e.endAngle,c=e.clockwise,d=Math.cos(l),f=Math.sin(l),h=Math.cos(u),p=Math.sin(u);(c?u-l<2*Math.PI:l-u<2*Math.PI)&&(t.moveTo(d*i+n,f*i+r),t.arc(d*s+n,f*s+r,a,-Math.PI+l,l,!c)),t.arc(n,r,o,l,u,!c),t.moveTo(h*o+n,p*o+r),t.arc(h*s+n,p*s+r,a,u-2*Math.PI,u-Math.PI,!c),0!==i&&(t.arc(n,r,i,u,l,c),t.moveTo(d*i+n,p*i+r)),t.closePath()}}),av=["itemStyle","barBorderWidth"],sv=[0,0];x(hl.prototype,iv),ch({type:"bar",render:function(t,e,n){this._updateDrawMode(t);var r=t.get("coordinateSystem");return"cartesian2d"!==r&&"polar"!==r||(this._isLargeDraw?this._renderLarge(t,e,n):this._renderNormal(t,e,n)),this.group},incrementalPrepareRender:function(t,e,n){this._clear(),this._updateDrawMode(t)},incrementalRender:function(t,e,n,r){this._incrementalRenderLarge(t,e)},_updateDrawMode:function(t){var e=t.pipelineContext.large;(null==this._isLargeDraw||e^this._isLargeDraw)&&(this._isLargeDraw=e,this._clear())},_renderNormal:function(t,e,n){var r,i=this.group,o=t.getData(),a=this._data,s=t.coordinateSystem,l=s.getBaseAxis();"cartesian2d"===s.type?r=l.isHorizontal():"polar"===s.type&&(r="angle"===l.dim);var u=t.isAnimationEnabled()?t:null,c=t.get("clip",!0),d=function(t,e){var n=t.getArea&&t.getArea();if("cartesian2d"===t.type){var r=t.getBaseAxis();if("category"!==r.type||!r.onBand){var i=e.getLayout("bandWidth");r.isHorizontal()?(n.x-=i,n.width+=2*i):(n.y-=i,n.height+=2*i)}}return n}(s,o);function f(t){var e=pv[s.type](o,t),n=function(t,e,n){return new("polar"===t.type?Ra:Ua)({shape:bv(e,n,t),silent:!0,z2:0})}(s,r,e);return n.useStyle(g.getBarItemStyle()),"cartesian2d"===s.type&&n.setShape("r",m),v[t]=n}i.removeClipPath();var h=t.get("roundCap",!0),p=t.get("showBackground",!0),g=t.getModel("backgroundStyle"),m=g.get("barBorderRadius")||0,v=[],y=this._backgroundEls||[];o.diff(a).add(function(e){var n=o.getItemModel(e),a=pv[s.type](o,e,n);if(p&&f(e),o.hasValue(e)){if(c&&cv[s.type](d,a))return void i.remove(l);var l=dv[s.type](e,a,r,u,!1,h);o.setItemGraphicEl(e,l),i.add(l),mv(l,o,e,n,a,t,0,"polar"===s.type)}}).update(function(e,n){var l=o.getItemModel(e),x=pv[s.type](o,e,l);if(p){var b;0===y.length?b=f(n):((b=y[n]).useStyle(g.getBarItemStyle()),"cartesian2d"===s.type&&b.setShape("r",m),v[e]=b);var _=pv[s.type](o,e);$s(b,{shape:bv(r,_,s)},u,e)}var w=a.getItemGraphicEl(n);if(o.hasValue(e)){if(c&&cv[s.type](d,x))return void i.remove(w);w?$s(w,{shape:x},u,e):w=dv[s.type](e,x,r,u,!0,h),o.setItemGraphicEl(e,w),i.add(w),mv(w,o,e,l,x,t,0,"polar"===s.type)}else i.remove(w)}).remove(function(t){var e=a.getItemGraphicEl(t);"cartesian2d"===s.type?e&&fv(t,u,e):e&&hv(t,u,e)}).execute();var x=this._backgroundGroup||(this._backgroundGroup=new Cn);x.removeAll();for(var b=0;b<v.length;++b)x.add(v[b]);i.add(x),this._backgroundEls=v,this._data=o},_renderLarge:function(t,e,n){this._clear(),yv(t,this.group);var r=t.get("clip",!0)?Qg(t.coordinateSystem,!1,t):null;r?this.group.setClipPath(r):this.group.removeClipPath()},_incrementalRenderLarge:function(t,e){this._removeBackground(),yv(e,this.group,!0)},dispose:et,remove:function(t){this._clear(t)},_clear:function(t){var e=this.group,n=this._data;t&&t.get("animation")&&n&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],n.eachItemGraphicEl(function(e){"sector"===e.type?hv(e.dataIndex,t,e):fv(e.dataIndex,t,e)})):e.removeAll(),this._data=null},_removeBackground:function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null}});var lv=Math.max,uv=Math.min,cv={cartesian2d:function(t,e){var n=e.width<0?-1:1,r=e.height<0?-1:1;n<0&&(e.x+=e.width,e.width=-e.width),r<0&&(e.y+=e.height,e.height=-e.height);var i=lv(e.x,t.x),o=uv(e.x+e.width,t.x+t.width),a=lv(e.y,t.y),s=uv(e.y+e.height,t.y+t.height);e.x=i,e.y=a,e.width=o-i,e.height=s-a;var l=e.width<0||e.height<0;return n<0&&(e.x+=e.width,e.width=-e.width),r<0&&(e.y+=e.height,e.height=-e.height),l},polar:function(t,e){var n=e.r0<=e.r?1:-1;if(n<0){var r=e.r;e.r=e.r0,e.r0=r}r=uv(e.r,t.r);var i=lv(e.r0,t.r0),o=(e.r=r)-(e.r0=i)<0;return n<0&&(r=e.r,e.r=e.r0,e.r0=r),o}},dv={cartesian2d:function(t,e,n,r,i){var o=new Ua({shape:x({},e),z2:1});if(o.name="item",r){var a=n?"height":"width",s={};o.shape[a]=0,s[a]=e[a],al[i?"updateProps":"initProps"](o,{shape:s},r,t)}return o},polar:function(t,e,n,r,i,o){var a=new(!n&&o?ov:Ra)({shape:b({clockwise:e.startAngle<e.endAngle},e),z2:1});if(a.name="item",r){var s=n?"r":"endAngle",l={};a.shape[s]=n?0:e.startAngle,l[s]=e[s],al[i?"updateProps":"initProps"](a,{shape:l},r,t)}return a}};function fv(t,e,n){n.style.text=null,$s(n,{shape:{width:0}},e,t,function(){n.parent&&n.parent.remove(n)})}function hv(t,e,n){n.style.text=null,$s(n,{shape:{r:n.shape.r0}},e,t,function(){n.parent&&n.parent.remove(n)})}var pv={cartesian2d:function(t,e,n){var r=t.getItemLayout(e),i=n?function(t,e){var n=t.get(av)||0,r=isNaN(e.width)?Number.MAX_VALUE:Math.abs(e.width),i=isNaN(e.height)?Number.MAX_VALUE:Math.abs(e.height);return Math.min(n,r,i)}(n,r):0,o=0<r.width?1:-1,a=0<r.height?1:-1;return{x:r.x+o*i/2,y:r.y+a*i/2,width:r.width-o*i,height:r.height-a*i}},polar:function(t,e,n){var r=t.getItemLayout(e);return{cx:r.cx,cy:r.cy,r0:r.r0,r:r.r,startAngle:r.startAngle,endAngle:r.endAngle}}};function gv(t){return null!=t.startAngle&&null!=t.endAngle&&t.startAngle===t.endAngle}function mv(t,e,n,r,i,o,a,s){var l=e.getItemVisual(n,"color"),u=e.getItemVisual(n,"opacity"),c=e.getVisual("borderColor"),d=r.getModel("itemStyle"),f=r.getModel("emphasis.itemStyle").getBarItemStyle();s||t.setShape("r",d.get("barBorderRadius")||0),t.useStyle(b({stroke:gv(i)?"none":c,fill:gv(i)?"none":l,opacity:u},d.getBarItemStyle()));var h=r.getShallow("cursor");h&&t.attr("cursor",h),s||ev(t.style,f,r,l,o,n),gv(i)&&(f.fill=f.stroke="none"),Ls(t,f)}var vv=ha.extend({type:"largeBar",shape:{points:[]},buildPath:function(t,e){for(var n=e.points,r=this.__startPoint,i=this.__baseDimIdx,o=0;o<n.length;o+=2)r[i]=n[o+i],t.moveTo(r[0],r[1]),t.lineTo(n[o],n[o+1])}});function yv(t,e,n){var r=t.getData(),i=[],o=r.getLayout("valueAxisHorizontal")?1:0;i[1-o]=r.getLayout("valueAxisStart");var a=r.getLayout("largeDataIndices"),s=r.getLayout("barWidth"),l=t.getModel("backgroundStyle");if(t.get("showBackground",!0)){var u=r.getLayout("largeBackgroundPoints"),c=[];c[1-o]=r.getLayout("backgroundStart");var d=new vv({shape:{points:u},incremental:!!n,__startPoint:c,__baseDimIdx:o,__largeDataIndices:a,__barWidth:s,silent:!0,z2:0});!function(t,e,n){var r=e.get("borderColor")||e.get("color"),i=e.getItemStyle(["color","borderColor"]);t.useStyle(i),t.style.fill=null,t.style.stroke=r,t.style.lineWidth=n.getLayout("barWidth")}(d,l,r),e.add(d)}var f=new vv({shape:{points:r.getLayout("largePoints")},incremental:!!n,__startPoint:i,__baseDimIdx:o,__largeDataIndices:a,__barWidth:s});e.add(f),function(t,e,n){var r=n.getVisual("borderColor")||n.getVisual("color"),i=e.getModel("itemStyle").getItemStyle(["color","borderColor"]);t.useStyle(i),t.style.fill=null,t.style.stroke=r,t.style.lineWidth=n.getLayout("barWidth")}(f,t,r),f.seriesIndex=t.seriesIndex,t.get("silent")||(f.on("mousedown",xv),f.on("mousemove",xv))}var xv=fd(function(t){var e=function(t,e,n){var r=t.__baseDimIdx,i=1-r,o=t.shape.points,a=t.__largeDataIndices,s=Math.abs(t.__barWidth/2),l=t.__startPoint[i];sv[0]=e,sv[1]=n;for(var u=sv[r],c=sv[1-r],d=u-s,f=u+s,h=0,p=o.length/2;h<p;h++){var g=2*h,m=o[g+r],v=o[g+i];if(d<=m&&m<=f&&(l<=v?l<=c&&c<=v:v<=c&&c<=l))return a[h]}return-1}(this,t.offsetX,t.offsetY);this.dataIndex=0<=e?e:null},30,!1);function bv(t,e,n){var r,i="polar"===n.type;return r=i?n.getArea():n.grid.getRect(),i?{cx:r.cx,cy:r.cy,r0:t?r.r0:e.r0,r:t?r.r:e.r,startAngle:t?e.startAngle:0,endAngle:t?e.endAngle:2*Math.PI}:{x:t?e.x:r.x,y:t?r.y:e.y,width:t?e.width:r.width,height:t?r.height:e.height}}function _v(t,e,n){e=R(e)&&{coordDimensions:e}||x({},e);var r=t.getSource(),i=Wh(r,e),o=new Ah(i,t);return o.initData(r,n),o}rh(ff.VISUAL.LAYOUT,E(vp,"bar")),rh(ff.VISUAL.PROGRESSIVE_LAYOUT,yp),ih({seriesType:"bar",reset:function(t){t.getData().setVisual("legendSymbol","roundRect")}});var wv={updateSelectedMap:function(t){this._targetList=R(t)?t.slice():[],this._selectTargetMap=I(t||[],function(t,e){return t.set(e.name,e),t},Q())},select:function(t,e){var n=null!=e?this._targetList[e]:this._selectTargetMap.get(t);"single"===this.get("selectedMode")&&this._selectTargetMap.each(function(t){t.selected=!1}),n&&(n.selected=!0)},unSelect:function(t,e){var n=null!=e?this._targetList[e]:this._selectTargetMap.get(t);n&&(n.selected=!1)},toggleSelected:function(t,e){var n=null!=e?this._targetList[e]:this._selectTargetMap.get(t);if(null!=n)return this[n.selected?"unSelect":"select"](t,e),n.selected},isSelected:function(t,e){var n=null!=e?this._targetList[e]:this._selectTargetMap.get(t);return n&&n.selected}};function Sv(t,e){this.getAllNames=function(){var t=e();return t.mapArray(t.getName)},this.containName=function(t){return 0<=e().indexOfName(t)},this.indexOfName=function(e){return t().indexOfName(e)},this.getItemVisual=function(e,n){return t().getItemVisual(e,n)}}var Cv=uh({type:"series.pie",init:function(t){Cv.superApply(this,"init",arguments),this.legendVisualProvider=new Sv(P(this.getData,this),P(this.getRawData,this)),this.updateSelectedMap(this._createSelectableList()),this._defaultLabelLine(t)},mergeOption:function(t){Cv.superCall(this,"mergeOption",t),this.updateSelectedMap(this._createSelectableList())},getInitialData:function(t,e){return _v(this,{coordDimensions:["value"],encodeDefaulter:E(Lu,this)})},_createSelectableList:function(){for(var t=this.getRawData(),e=t.mapDimension("value"),n=[],r=0,i=t.count();r<i;r++)n.push({name:t.getName(r),value:t.get(e,r),selected:Tc(t,r,"selected")});return n},getDataParams:function(t){var e=this.getData(),n=Cv.superCall(this,"getDataParams",t),r=[];return e.each(e.mapDimension("value"),function(t){r.push(t)}),n.percent=Tl(r,t,e.hostModel.get("percentPrecision")),n.$vars.push("percent"),n},_defaultLabelLine:function(t){ki(t,"labelLine",["show"]);var e=t.labelLine,n=t.emphasis.labelLine;e.show=e.show&&t.label.show,n.show=n.show&&t.emphasis.label.show},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,hoverOffset:10,avoidLabelOverlap:!0,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:!1,show:!0,position:"outer",alignTo:"none",margin:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1},animationType:"expansion",animationTypeUpdate:"transition",animationEasing:"cubicOut"}});function Mv(t,e,n,r){var i=e.getData(),o=i.getName(this.dataIndex),a=e.get("selectedOffset");r.dispatchAction({type:"pieToggleSelect",from:t,name:o,seriesId:e.id}),i.each(function(t){Tv(i.getItemGraphicEl(t),i.getItemLayout(t),e.isSelected(i.getName(t)),a,n)})}function Tv(t,e,n,r,i){var o=(e.startAngle+e.endAngle)/2,a=n?r:0,s=[Math.cos(o)*a,Math.sin(o)*a];i?t.animate().when(200,{position:s}).start("bounceOut"):t.attr("position",s)}function kv(t,e){Cn.call(this);var n=new Ra({z2:2}),r=new Va,i=new Da;this.add(n),this.add(r),this.add(i),this.updateData(t,e,!0)}M(Cv,wv);var Av=kv.prototype;function Iv(t,e){k(e,function(e){e.update="updateView",eh(e,function(n,r){var i={};return r.eachComponent({mainType:"series",subType:t,query:n},function(t){t[e.method]&&t[e.method](n.name,n.dataIndex);var r=t.getData();r.each(function(e){var n=r.getName(e);i[n]=t.isSelected(n)||!1})}),{name:n.name,selected:i,seriesId:n.seriesId}})})}function Dv(t){return{getTargetSeries:function(e){var n={},r=Q();return e.eachSeriesByType(t,function(t){t.__paletteScope=n,r.set(t.uid,t)}),r},reset:function(t,e){var n=t.getRawData(),r={},i=t.getData();i.each(function(t){var e=i.getRawIndex(t);r[e]=t}),n.each(function(e){var o,a=r[e],s=null!=a&&i.getItemVisual(a,"color",!0),l=null!=a&&i.getItemVisual(a,"borderColor",!0);if(s&&l||(o=n.getItemModel(e)),!s){var u=o.get("itemStyle.color")||t.getColorFromPalette(n.getName(e)||e+"",t.__paletteScope,n.count());null!=a&&i.setItemVisual(a,"color",u)}if(!l){var c=o.get("itemStyle.borderColor");null!=a&&i.setItemVisual(a,"borderColor",c)}})}}}Av.updateData=function(t,e,n){var r=this.childAt(0),i=this.childAt(1),o=this.childAt(2),a=t.hostModel,s=t.getItemModel(e),l=t.getItemLayout(e),u=x({},l);u.label=null;var c=a.getShallow("animationTypeUpdate");n?(r.setShape(u),"scale"===a.getShallow("animationType")?(r.shape.r=l.r0,Zs(r,{shape:{r:l.r}},a,e)):(r.shape.endAngle=l.startAngle,$s(r,{shape:{endAngle:l.endAngle}},a,e))):"expansion"===c?r.setShape(u):$s(r,{shape:u},a,e);var d=t.getItemVisual(e,"color");r.useStyle(b({lineJoin:"bevel",fill:d},s.getModel("itemStyle").getItemStyle())),r.hoverStyle=s.getModel("emphasis.itemStyle").getItemStyle();var f=s.getShallow("cursor");f&&r.attr("cursor",f),Tv(this,t.getItemLayout(e),a.isSelected(t.getName(e)),a.get("selectedOffset"),a.get("animation")),this._updateLabel(t,e,!n&&"transition"===c),this.highDownOnUpdate=a.get("silent")?null:function(t,e){var n=a.isAnimationEnabled()&&s.get("hoverAnimation");"emphasis"===e?(i.ignore=i.hoverIgnore,o.ignore=o.hoverIgnore,n&&(r.stopAnimation(!0),r.animateTo({shape:{r:l.r+a.get("hoverOffset")}},300,"elasticOut"))):(i.ignore=i.normalIgnore,o.ignore=o.normalIgnore,n&&(r.stopAnimation(!0),r.animateTo({shape:{r:l.r}},300,"elasticOut")))},Ls(this)},Av._updateLabel=function(t,e,n){var r=this.childAt(1),i=this.childAt(2),o=t.hostModel,a=t.getItemModel(e),s=t.getItemLayout(e).label,l=t.getItemVisual(e,"color");if(!s||isNaN(s.x)||isNaN(s.y))i.ignore=i.normalIgnore=i.hoverIgnore=r.ignore=r.normalIgnore=r.hoverIgnore=!0;else{var u={points:s.linePoints||[[s.x,s.y],[s.x,s.y],[s.x,s.y]]},c={x:s.x,y:s.y};n?($s(r,{shape:u},o,e),$s(i,{style:c},o,e)):(r.attr({shape:u}),i.attr({style:c})),i.attr({rotation:s.rotation,origin:[s.x,s.y],z2:10});var d=a.getModel("label"),f=a.getModel("emphasis.label"),h=a.getModel("labelLine"),p=a.getModel("emphasis.labelLine");l=t.getItemVisual(e,"color"),Vs(i.style,i.hoverStyle={},d,f,{labelFetcher:t.hostModel,labelDataIndex:e,defaultText:s.text,autoColor:l,useInsideStyle:!!s.inside},{textAlign:s.textAlign,textVerticalAlign:s.verticalAlign,opacity:t.getItemVisual(e,"opacity")}),i.ignore=i.normalIgnore=!d.get("show"),i.hoverIgnore=!f.get("show"),r.ignore=r.normalIgnore=!h.get("show"),r.hoverIgnore=!p.get("show"),r.setStyle({stroke:l,opacity:t.getItemVisual(e,"opacity")}),r.setStyle(h.getModel("lineStyle").getLineStyle()),r.hoverStyle=p.getModel("lineStyle").getLineStyle();var g=h.get("smooth");g&&!0===g&&(g=.4),r.setShape({smooth:g})}},C(kv,Cn),nd.extend({type:"pie",init:function(){var t=new Cn;this._sectorGroup=t},render:function(t,e,n,r){if(!r||r.from!==this.uid){var i=t.getData(),o=this._data,a=this.group,s=e.get("animation"),l=!o,u=t.get("animationType"),c=t.get("animationTypeUpdate"),d=E(Mv,this.uid,t,s,n),f=t.get("selectedMode");if(i.diff(o).add(function(t){var e=new kv(i,t);l&&"scale"!==u&&e.eachChild(function(t){t.stopAnimation(!0)}),f&&e.on("click",d),i.setItemGraphicEl(t,e),a.add(e)}).update(function(t,e){var n=o.getItemGraphicEl(e);l||"transition"===c||n.eachChild(function(t){t.stopAnimation(!0)}),n.updateData(i,t),n.off("click"),f&&n.on("click",d),a.add(n),i.setItemGraphicEl(t,n)}).remove(function(t){var e=o.getItemGraphicEl(t);a.remove(e)}).execute(),s&&0<i.count()&&(l?"scale"!==u:"transition"!==c)){for(var h=i.getItemLayout(0),p=1;isNaN(h.startAngle)&&p<i.count();++p)h=i.getItemLayout(p);var g=Math.max(n.getWidth(),n.getHeight())/2,m=P(a.removeClipPath,a);a.setClipPath(this._createClipPath(h.cx,h.cy,g,h.startAngle,h.clockwise,m,t,l))}else a.removeClipPath();this._data=i}},dispose:function(){},_createClipPath:function(t,e,n,r,i,o,a,s){var l=new Ra({shape:{cx:t,cy:e,r0:0,r:n,startAngle:r,endAngle:r,clockwise:i}});return(s?Zs:$s)(l,{shape:{endAngle:r+(i?1:-1)*Math.PI*2}},a,o),l},containPoint:function(t,e){var n=e.getData().getItemLayout(0);if(n){var r=t[0]-n.cx,i=t[1]-n.cy,o=Math.sqrt(r*r+i*i);return o<=n.r&&o>=n.r0}}});var Ov=Math.PI/180;function Pv(t,e,n,r,i,o,a,s,l,u){function c(e,n,r){for(var i=e;i<n&&!(t[i].y+r>l+a);i++)if(t[i].y+=r,e<i&&i+1<n&&t[i+1].y>t[i].y+t[i].height)return void d(i,r/2);d(n-1,r/2)}function d(e,n){for(var r=e;0<=r&&!(t[r].y-n<l)&&(t[r].y-=n,!(0<r&&t[r].y>t[r-1].y+t[r-1].height));r--);}function f(t,e,n,r,i,o){for(var a=e?Number.MAX_VALUE:0,s=0,l=t.length;s<l;s++)if("none"===t[s].labelAlignTo){var u=Math.abs(t[s].y-r),c=t[s].len,d=t[s].len2,f=u<i+c?Math.sqrt((i+c+d)*(i+c+d)-u*u):Math.abs(t[s].x-n);e&&a<=f&&(f=a-10),!e&&f<=a&&(f=a+10),t[s].x=n+f*o,a=f}}t.sort(function(t,e){return t.y-e.y});for(var h,p=0,g=t.length,m=[],v=[],y=0;y<g;y++)"outer"===t[y].position&&"labelLine"===t[y].labelAlignTo&&(t[y].linePoints[1][0]+=t[y].x-u,t[y].x=u),(h=t[y].y-p)<0&&c(y,g,-h),p=t[y].y+t[y].height;for(a-p<0&&d(g-1,p-a),y=0;y<g;y++)t[y].y>=n?v.push(t[y]):m.push(t[y]);f(m,!1,e,n,r,i),f(v,!0,e,n,r,i)}function Ev(t){return"center"===t.position}var Rv=2*Math.PI,Lv=Math.PI/180;function Nv(t){return{seriesType:t,reset:function(t,e){var n=e.findComponents({mainType:"legend"});if(n&&n.length){var r=t.getData();r.filterSelf(function(t){for(var e=r.getName(t),i=0;i<n.length;i++)if(!n[i].isSelected(e))return!1;return!0})}}}}Iv("pie",[{type:"pieToggleSelect",event:"pieselectchanged",method:"toggleSelected"},{type:"pieSelect",event:"pieselected",method:"select"},{type:"pieUnSelect",event:"pieunselected",method:"unSelect"}]),ih(Dv("pie")),rh(E(function(t,e,n,r){e.eachSeriesByType(t,function(t){var e=t.getData(),r=e.mapDimension("value"),i=function(t,e){return au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}(t,n),o=t.get("center"),a=t.get("radius");R(a)||(a=[0,a]),R(o)||(o=[o,o]);var s=bl(i.width,n.getWidth()),l=bl(i.height,n.getHeight()),u=Math.min(s,l),c=bl(o[0],s)+i.x,d=bl(o[1],l)+i.y,f=bl(a[0],u/2),h=bl(a[1],u/2),p=-t.get("startAngle")*Lv,g=t.get("minAngle")*Lv,m=0;e.each(r,function(t){isNaN(t)||m++});var v=e.getSum(r),y=Math.PI/(v||m)*2,x=t.get("clockwise"),b=t.get("roseType"),_=t.get("stillShowZeroSum"),w=e.getDataExtent(r);w[0]=0;var S=Rv,C=0,M=p,T=x?1:-1;if(e.each(r,function(t,n){var r;if(isNaN(t))e.setItemLayout(n,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:x,cx:c,cy:d,r0:f,r:b?NaN:h,viewRect:i});else{(r="area"!==b?0===v&&_?y:t*y:Rv/m)<g?S-=r=g:C+=t;var o=M+T*r;e.setItemLayout(n,{angle:r,startAngle:M,endAngle:o,clockwise:x,cx:c,cy:d,r0:f,r:b?xl(t,w,[f,h]):h,viewRect:i}),M=o}}),S<Rv&&m)if(S<=.001){var k=Rv/m;e.each(r,function(t,n){if(!isNaN(t)){var r=e.getItemLayout(n);r.angle=k,r.startAngle=p+T*n*k,r.endAngle=p+T*(n+1)*k}})}else y=S/C,M=p,e.each(r,function(t,n){if(!isNaN(t)){var r=e.getItemLayout(n),i=r.angle===g?g:t*y;r.startAngle=M,r.endAngle=M+T*i,M+=T*i}});!function(t,e,n,r,i,o){var a,s,l=t.getData(),u=[],c=!1,d=(t.get("minShowLabelAngle")||0)*Ov;l.each(function(r){var o=l.getItemLayout(r),f=l.getItemModel(r),h=f.getModel("label"),p=h.get("position")||f.get("emphasis.label.position"),g=h.get("distanceToLabelLine"),m=h.get("alignTo"),v=bl(h.get("margin"),n),y=h.get("bleedMargin"),x=h.getFont(),b=f.getModel("labelLine"),_=b.get("length");_=bl(_,n);var w=b.get("length2");if(w=bl(w,n),!(o.angle<d)){var S,C,M,T,k=(o.startAngle+o.endAngle)/2,A=Math.cos(k),I=Math.sin(k);a=o.cx,s=o.cy;var D,O=t.getFormattedLabel(r,"normal")||l.getName(r),P=ir(O,x,T,"top"),E="inside"===p||"inner"===p;if("center"===p)S=o.cx,C=o.cy,T="center";else{var R=(E?(o.r+o.r0)/2*A:o.r*A)+a,L=(E?(o.r+o.r0)/2*I:o.r*I)+s;if(S=R+3*A,C=L+3*I,!E){var N=R+A*(_+e-o.r),B=L+I*(_+e-o.r),z=N+(A<0?-1:1)*w;S="edge"===m?A<0?i+v:i+n-v:z+(A<0?-g:g),M=[[R,L],[N,B],[z,C=B]]}T=E?"center":"edge"===m?0<A?"right":"left":0<A?"left":"right"}var V=h.get("rotate");D="number"==typeof V?V*(Math.PI/180):V?A<0?-k+Math.PI:-k:0,c=!!D,o.label={x:S,y:C,position:p,height:P.height,len:_,len2:w,linePoints:M,textAlign:T,verticalAlign:"middle",rotation:D,inside:E,labelDistance:g,labelAlignTo:m,labelMargin:v,bleedMargin:y,textRect:P,text:O,font:x},E||u.push(o.label)}}),!c&&t.get("avoidLabelOverlap")&&function(t,e,n,r,i,o,a,s){for(var l=[],u=[],c=Number.MAX_VALUE,d=-Number.MAX_VALUE,f=0;f<t.length;f++)Ev(t[f])||(t[f].x<e?(c=Math.min(c,t[f].x),l.push(t[f])):(d=Math.max(d,t[f].x),u.push(t[f])));for(Pv(u,e,n,r,1,0,o,0,s,d),Pv(l,e,n,r,-1,0,o,0,s,c),f=0;f<t.length;f++){var h=t[f];if(!Ev(h)){var p=h.linePoints;if(p){var g,m="edge"===h.labelAlignTo,v=h.textRect.width;(g=m?h.x<e?p[2][0]-h.labelDistance-a-h.labelMargin:a+i-h.labelMargin-p[2][0]-h.labelDistance:h.x<e?h.x-a-h.bleedMargin:a+i-h.x-h.bleedMargin)<h.textRect.width&&(h.text=lr(h.text,g,h.font),"edge"===h.labelAlignTo&&(v=rr(h.text,h.font)));var y=p[1][0]-p[2][0];m?p[2][0]=h.x<e?a+h.labelMargin+v+h.labelDistance:a+i-h.labelMargin-v-h.labelDistance:(p[2][0]=h.x<e?h.x+h.labelDistance:h.x-h.labelDistance,p[1][0]=p[2][0]+y),p[1][1]=p[2][1]=h.y}}}}(u,a,s,e,n,r,i,o)}(t,h,i.width,i.height,i.x,i.y)})},"pie")),th(Nv("pie")),jc.extend({type:"series.scatter",dependencies:["grid","polar","geo","singleAxis","calendar"],getInitialData:function(t,e){return $h(this.getSource(),this,{useEncodeDefaulter:!0})},brushSelector:"point",getProgressive:function(){var t=this.option.progressive;return null==t?this.option.large?5e3:this.get("progressive"):t},getProgressiveThreshold:function(){var t=this.option.progressiveThreshold;return null==t?this.option.large?1e4:this.get("progressiveThreshold"):t},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},clip:!0}});var Bv=hs({shape:{points:null},symbolProxy:null,softClipShape:null,buildPath:function(t,e){var n=e.points,r=e.size,i=this.symbolProxy,o=i.shape;if(!((t.getContext?t.getContext():t)&&r[0]<4))for(var a=0;a<n.length;){var s=n[a++],l=n[a++];isNaN(s)||isNaN(l)||this.softClipShape&&!this.softClipShape.contain(s,l)||(o.x=s-r[0]/2,o.y=l-r[1]/2,o.width=r[0],o.height=r[1],i.buildPath(t,o,!0))}},afterBrush:function(t){var e=this.shape,n=e.points,r=e.size;if(r[0]<4){this.setTransform(t);for(var i=0;i<n.length;){var o=n[i++],a=n[i++];isNaN(o)||isNaN(a)||this.softClipShape&&!this.softClipShape.contain(o,a)||t.fillRect(o-r[0]/2,a-r[1]/2,r[0],r[1])}this.restoreTransform(t)}},findDataIndex:function(t,e){for(var n=this.shape,r=n.points,i=n.size,o=Math.max(i[0],4),a=Math.max(i[1],4),s=r.length/2-1;0<=s;s--){var l=2*s,u=r[l]-o/2,c=r[1+l]-a/2;if(u<=t&&c<=e&&t<=u+o&&e<=c+a)return s}return-1}});function zv(){this.group=new Cn}var Vv=zv.prototype;function Fv(t,e,n){mg.call(this,t,e,n),this.type="value",this.angle=0,this.name=""}function Hv(t,e,n){this._model=t,this.dimensions=[],this._indicatorAxes=A(t.getIndicatorModels(),function(t,e){var n="indicator_"+e,r=new Fv(n,"log"===t.get("axisType")?new Bp:new lp);return r.name=t.get("name"),(r.model=t).axis=r,this.dimensions.push(n),r},this),this.resize(t,n)}Vv.isPersistent=function(){return!this._incremental},Vv.updateData=function(t,e){this.group.removeAll();var n=new Bv({rectHover:!0,cursor:"default"});n.setShape({points:t.getLayout("symbolPoints")}),this._setCommon(n,t,!1,e),this.group.add(n),this._incremental=null},Vv.updateLayout=function(t){if(!this._incremental){var e=t.getLayout("symbolPoints");this.group.eachChild(function(t){null!=t.startIndex&&(e=new Float32Array(e.buffer,4*t.startIndex*2,2*(t.endIndex-t.startIndex))),t.setShape("points",e)})}},Vv.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clearIncremental(),2e6<t.count()?(this._incremental||(this._incremental=new ns({silent:!0})),this.group.add(this._incremental)):this._incremental=null},Vv.incrementalUpdate=function(t,e,n){var r;this._incremental?(r=new Bv,this._incremental.addDisplayable(r,!0)):((r=new Bv({rectHover:!0,cursor:"default",startIndex:t.start,endIndex:t.end})).incremental=!0,this.group.add(r)),r.setShape({points:e.getLayout("symbolPoints")}),this._setCommon(r,e,!!this._incremental,n)},Vv._setCommon=function(t,e,n,r){var i=e.hostModel;r=r||{};var o=e.getVisual("symbolSize");t.setShape("size",o instanceof Array?o:[o,o]),t.softClipShape=r.clipShape||null,t.symbolProxy=eg(e.getVisual("symbol"),0,0,0,0),t.setColor=t.symbolProxy.setColor;var a=t.shape.size[0]<4;t.useStyle(i.getModel("itemStyle").getItemStyle(a?["color","shadowBlur","shadowColor"]:["color"]));var s=e.getVisual("color");s&&t.setColor(s),n||(t.seriesIndex=i.seriesIndex,t.on("mousemove",function(e){t.dataIndex=null;var n=t.findDataIndex(e.offsetX,e.offsetY);0<=n&&(t.dataIndex=n+(t.startIndex||0))}))},Vv.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},Vv._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles()},ch({type:"scatter",render:function(t,e,n){var r=t.getData();this._updateSymbolDraw(r,t).updateData(r,{clipShape:this._getClipShape(t)}),this._finished=!0},incrementalPrepareRender:function(t,e,n){var r=t.getData();this._updateSymbolDraw(r,t).incrementalPrepareUpdate(r),this._finished=!1},incrementalRender:function(t,e,n){this._symbolDraw.incrementalUpdate(t,e.getData(),{clipShape:this._getClipShape(e)}),this._finished=t.end===e.getData().count()},updateTransform:function(t,e,n){var r=t.getData();if(this.group.dirty(),!this._finished||1e4<r.count()||!this._symbolDraw.isPersistent())return{update:!0};var i=am().reset(t);i.progress&&i.progress({start:0,end:r.count()},r),this._symbolDraw.updateLayout(r)},_getClipShape:function(t){var e=t.coordinateSystem,n=e&&e.getArea&&e.getArea();return t.get("clip",!0)?n:null},_updateSymbolDraw:function(t,e){var n=this._symbolDraw,r=e.pipelineContext.large;return n&&r===this._isLargeDraw||(n&&n.remove(),n=this._symbolDraw=r?new zv:new Pg,this._isLargeDraw=r,this.group.removeAll()),this.group.add(n.group),n},remove:function(t,e){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},dispose:function(){}}),ih(om("scatter","circle")),rh(am("scatter")),C(Fv,mg),Hv.prototype.getIndicatorAxes=function(){return this._indicatorAxes},Hv.prototype.dataToPoint=function(t,e){return this.coordToPoint(this._indicatorAxes[e].dataToCoord(t),e)},Hv.prototype.coordToPoint=function(t,e){var n=this._indicatorAxes[e].angle;return[this.cx+t*Math.cos(n),this.cy-t*Math.sin(n)]},Hv.prototype.pointToData=function(t){var e=t[0]-this.cx,n=t[1]-this.cy,r=Math.sqrt(e*e+n*n);e/=r,n/=r;for(var i,o=Math.atan2(-n,e),a=1/0,s=-1,l=0;l<this._indicatorAxes.length;l++){var u=this._indicatorAxes[l],c=Math.abs(o-u.angle);c<a&&(i=u,s=l,a=c)}return[s,+(i&&i.coordToData(r))]},Hv.prototype.resize=function(t,e){var n=t.get("center"),r=e.getWidth(),i=e.getHeight(),o=Math.min(r,i)/2;this.cx=bl(n[0],r),this.cy=bl(n[1],i),this.startAngle=t.get("startAngle")*Math.PI/180;var a=t.get("radius");"string"!=typeof a&&"number"!=typeof a||(a=[0,a]),this.r0=bl(a[0],o),this.r=bl(a[1],o),k(this._indicatorAxes,function(t,e){t.setExtent(this.r0,this.r);var n=this.startAngle+e*Math.PI*2/this._indicatorAxes.length;n=Math.atan2(Math.sin(n),Math.cos(n)),t.angle=n},this)},Hv.prototype.update=function(t,e){var n=this._indicatorAxes,r=this._model;k(n,function(t){t.scale.setExtent(1/0,-1/0)}),t.eachSeriesByType("radar",function(e,i){if("radar"===e.get("coordinateSystem")&&t.getComponent("radar",e.get("radarIndex"))===r){var o=e.getData();k(n,function(t){t.scale.unionExtentFromData(o,o.mapDimension(t.dim))})}},this);var i=r.get("splitNumber");function o(t){var e=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),n=t/e;return 2===n?n=5:n*=2,n*e}k(n,function(t,e){var n=Vp(t.scale,t.model).extent;Fp(t.scale,t.model);var r=t.model,a=t.scale,s=r.getMin(),l=r.getMax(),u=a.getInterval();if(null!=s&&null!=l)a.setExtent(+s,+l),a.setInterval((l-s)/i);else if(null!=s)for(;a.setExtent(+s,d=s+u*i),a.setInterval(u),u=o(u),d<n[1]&&isFinite(d)&&isFinite(n[1]););else if(null!=l)for(;a.setExtent(f=l-u*i,+l),a.setInterval(u),u=o(u),f>n[0]&&isFinite(f)&&isFinite(n[0]););else{var c=a.getTicks().length-1;i<c&&(u=o(u));var d,f=_l((d=Math.ceil(n[1]/u)*u)-u*i);a.setExtent(f,d),a.setInterval(u)}})},Hv.dimensions=[],Hv.create=function(t,e){var n=[];return t.eachComponent("radar",function(r){var i=new Hv(r,t,e);n.push(i),r.coordinateSystem=i}),t.eachSeriesByType("radar",function(t){"radar"===t.get("coordinateSystem")&&(t.coordinateSystem=n[t.get("radarIndex")||0])}),n},Uu.register("radar",Hv);var Wv=pm.valueAxis;function jv(t,e){return b({show:e},t)}sh({type:"radar",optionUpdated:function(){var t=this.get("boundaryGap"),e=this.get("splitNumber"),n=this.get("scale"),r=this.get("axisLine"),i=this.get("axisTick"),o=this.get("axisType"),a=this.get("axisLabel"),s=this.get("name"),l=this.get("name.show"),u=this.get("name.formatter"),c=this.get("nameGap"),d=this.get("triggerEvent"),f=A(this.get("indicator")||[],function(f){null!=f.max&&0<f.max&&!f.min?f.min=0:null!=f.min&&f.min<0&&!f.max&&(f.max=0);var h=s;if(null!=f.color&&(h=b({color:f.color},s)),f=v(m(f),{boundaryGap:t,splitNumber:e,scale:n,axisLine:r,axisTick:i,axisType:o,axisLabel:a,name:f.text,nameLocation:"end",nameGap:c,nameTextStyle:h,triggerEvent:d},!1),l||(f.name=""),"string"==typeof u){var p=f.name;f.name=u.replace("{value}",null!=p?p:"")}else"function"==typeof u&&(f.name=u(f.name,f));var g=x(new hl(f,null,this.ecModel),qp);return g.mainType="radar",g.componentIndex=this.componentIndex,g},this);this.getIndicatorModels=function(){return f}},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"75%",startAngle:90,name:{show:!0},boundaryGap:[0,0],splitNumber:5,nameGap:15,scale:!1,shape:"polygon",axisLine:v({lineStyle:{color:"#bbb"}},Wv.axisLine),axisLabel:jv(Wv.axisLabel,!1),axisTick:jv(Wv.axisTick,!1),axisType:"interval",splitLine:jv(Wv.splitLine,!0),splitArea:jv(Wv.splitArea,!0),indicator:[]}});var Gv=["axisLine","axisTickLabel","axisName"];lh({type:"radar",render:function(t,e,n){this.group.removeAll(),this._buildAxes(t),this._buildSplitLineAndArea(t)},_buildAxes:function(t){var e=t.coordinateSystem;k(A(e.getIndicatorAxes(),function(t){return new Am(t.model,{position:[e.cx,e.cy],rotation:t.angle,labelDirection:-1,tickDirection:-1,nameDirection:1})}),function(t){k(Gv,t.add,t),this.group.add(t.getGroup())},this)},_buildSplitLineAndArea:function(t){var e=t.coordinateSystem,n=e.getIndicatorAxes();if(n.length){var r=t.get("shape"),i=t.getModel("splitLine"),o=t.getModel("splitArea"),a=i.getModel("lineStyle"),s=o.getModel("areaStyle"),l=i.get("show"),u=o.get("show"),c=a.get("color"),d=s.get("color");c=R(c)?c:[c],d=R(d)?d:[d];var f=[],h=[];if("circle"===r)for(var p=n[0].getTicksCoords(),g=e.cx,m=e.cy,v=0;v<p.length;v++)l&&f[T(f,c,v)].push(new Pa({shape:{cx:g,cy:m,r:p[v].coord}})),u&&v<p.length-1&&h[T(h,d,v)].push(new La({shape:{cx:g,cy:m,r0:p[v].coord,r:p[v+1].coord}}));else{var y,x=A(n,function(t,n){var r=t.getTicksCoords();return y=null==y?r.length-1:Math.min(r.length-1,y),A(r,function(t){return e.coordToPoint(t.coord,n)})}),_=[];for(v=0;v<=y;v++){for(var w=[],S=0;S<n.length;S++)w.push(x[S][v]);w[0]&&w.push(w[0].slice()),l&&f[T(f,c,v)].push(new Va({shape:{points:w}})),u&&_&&h[T(h,d,v-1)].push(new za({shape:{points:w.concat(_)}})),_=w.slice().reverse()}}var C=a.getLineStyle(),M=s.getAreaStyle();k(h,function(t,e){this.group.add(xs(t,{style:b({stroke:"none",fill:d[e%d.length]},M),silent:!0}))},this),k(f,function(t,e){this.group.add(xs(t,{style:b({fill:"none",stroke:c[e%c.length]},C),silent:!0}))},this)}function T(t,e,n){var r=n%e.length;return t[r]=t[r]||[],r}}});var Uv=jc.extend({type:"series.radar",dependencies:["radar"],init:function(t){Uv.superApply(this,"init",arguments),this.legendVisualProvider=new Sv(P(this.getData,this),P(this.getRawData,this))},getInitialData:function(t,e){return _v(this,{generateCoord:"indicator_",generateCoordCount:1/0})},formatTooltip:function(t,e,n,r){var i=this.getData(),o=this.coordinateSystem.getIndicatorAxes(),a=this.getData().getName(t),s="html"===r?"<br/>":"\n";return jl(""===a?this.name:a)+s+A(o,function(e,n){var r=i.get(i.mapDimension(e.dim),t);return jl(e.name+" : "+r)}).join(s)},getTooltipPosition:function(t){if(null!=t)for(var e=this.getData(),n=this.coordinateSystem,r=e.getValues(A(n.dimensions,function(t){return e.mapDimension(t)}),t,!0),i=0,o=r.length;i<o;i++)if(!isNaN(r[i])){var a=n.getIndicatorAxes();return n.coordToPoint(a[i].dataToCoord(r[i]),i)}},defaultOption:{zlevel:0,z:2,coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid"},label:{position:"top"},symbol:"emptyCircle",symbolSize:4}});function qv(t){return!isNaN(t[0])&&!isNaN(t[1])}function Xv(t){return[t.cx,t.cy]}ch({type:"radar",render:function(t,e,n){var r=t.coordinateSystem,i=this.group,o=t.getData(),a=this._data;function s(t,e){var n=t.getItemVisual(e,"symbol")||"circle",r=t.getItemVisual(e,"color");if("none"!==n){var i=function(t){return R(t)||(t=[+t,+t]),t}(t.getItemVisual(e,"symbolSize")),o=eg(n,-1,-1,2,2,r),a=t.getItemVisual(e,"symbolRotate")||0;return o.attr({style:{strokeNoScale:!0},z2:100,scale:[i[0]/2,i[1]/2],rotation:a*Math.PI/180||0}),o}}function l(e,n,r,i,o,a){r.removeAll();for(var l=0;l<n.length-1;l++){var u=s(i,o);u&&(e[u.__dimIdx=l]?(u.attr("position",e[l]),al[a?"initProps":"updateProps"](u,{position:n[l]},t,o)):u.attr("position",n[l]),r.add(u))}}function u(t){return A(t,function(t){return[r.cx,r.cy]})}o.diff(a).add(function(e){var n=o.getItemLayout(e);if(n){var r=new za,i=new Va,a={shape:{points:n}};r.shape.points=u(n),i.shape.points=u(n),Zs(r,a,t,e),Zs(i,a,t,e);var s=new Cn,c=new Cn;s.add(i),s.add(r),s.add(c),l(i.shape.points,n,c,o,e,!0),o.setItemGraphicEl(e,s)}}).update(function(e,n){var r=a.getItemGraphicEl(n),i=r.childAt(0),s=r.childAt(1),u=r.childAt(2),c={shape:{points:o.getItemLayout(e)}};c.shape.points&&(l(i.shape.points,c.shape.points,u,o,e,!1),$s(i,c,t),$s(s,c,t),o.setItemGraphicEl(e,r))}).remove(function(t){i.remove(a.getItemGraphicEl(t))}).execute(),o.eachItemGraphicEl(function(t,e){var n=o.getItemModel(e),r=t.childAt(0),a=t.childAt(1),s=t.childAt(2),l=o.getItemVisual(e,"color");i.add(t),r.useStyle(b(n.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:l})),r.hoverStyle=n.getModel("emphasis.lineStyle").getLineStyle();var u=n.getModel("areaStyle"),c=n.getModel("emphasis.areaStyle"),d=u.isEmpty()&&u.parentModel.isEmpty(),f=c.isEmpty()&&c.parentModel.isEmpty();f=f&&d,a.ignore=d,a.useStyle(b(u.getAreaStyle(),{fill:l,opacity:.7})),a.hoverStyle=c.getAreaStyle();var h=n.getModel("itemStyle").getItemStyle(["color"]),p=n.getModel("emphasis.itemStyle").getItemStyle(),g=n.getModel("label"),v=n.getModel("emphasis.label");s.eachChild(function(t){t.setStyle(h),t.hoverStyle=m(p);var n=o.get(o.dimensions[t.__dimIdx],e);null!=n&&!isNaN(n)||(n=""),Vs(t.style,t.hoverStyle,g,v,{labelFetcher:o.hostModel,labelDataIndex:e,labelDimIndex:t.__dimIdx,defaultText:n,autoColor:l,isRectText:!0})}),t.highDownOnUpdate=function(t,e){a.attr("ignore","emphasis"===e?f:d)},Ls(t)}),this._data=o},remove:function(){this.group.removeAll(),this._data=null},dispose:function(){}}),ih(Dv("radar")),ih(om("radar","circle")),rh(function(t){t.eachSeriesByType("radar",function(t){var e=t.getData(),n=[],r=t.coordinateSystem;if(r){var i=r.getIndicatorAxes();k(i,function(t,o){e.each(e.mapDimension(i[o].dim),function(t,e){n[e]=n[e]||[];var i=r.dataToPoint(t,o);n[e][o]=qv(i)?i:Xv(r)})}),e.each(function(t){var i=O(n[t],function(t){return qv(t)})||Xv(r);n[t].push(i.slice()),e.setItemLayout(t,n[t])})}})}),th(Nv("radar")),Qf(function(t){var e=t.polar;if(e){R(e)||(e=[e]);var n=[];k(e,function(e,r){e.indicator?(e.type&&!e.shape&&(e.shape=e.type),t.radar=t.radar||[],R(t.radar)||(t.radar=[t.radar]),t.radar.push(e)):n.push(e)}),t.polar=n}k(t.series,function(t){t&&"radar"===t.type&&t.polarIndex&&(t.radarIndex=t.polarIndex)})});for(var Yv=[126,25],$v=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],Zv=0;Zv<$v.length;Zv++)for(var Kv=0;Kv<$v[Zv].length;Kv++)$v[Zv][Kv][0]/=10.5,$v[Zv][Kv][1]/=-14,$v[Zv][Kv][0]+=Yv[0],$v[Zv][Kv][1]+=Yv[1];var Jv={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]},Qv={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]},ty=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]],ey=Li(),ny={load:function(t,e,n){var r=ey(e).parsed;if(r)return r;var i,o=e.specialAreas||{},a=e.geoJSON;try{i=a?sg(a,n):[]}catch(e){throw new Error("Invalid geoJson format\n"+e.message)}return function(t,e){"china"===t&&e.push(new og("南海诸岛",A($v,function(t){return{type:"polygon",exterior:t}}),Yv))}(t,i),k(i,function(e){var n=e.name;!function(t,e){if("china"===t){var n=Jv[e.name];if(n){var r=e.center;r[0]+=n[0]/10.5,r[1]+=-n[1]/14}}}(t,e),function(t,e){if("world"===t){var n=Qv[e.name];if(n){var r=e.center;r[0]=n[0],r[1]=n[1]}}}(t,e),function(t,e){"china"===t&&"台湾"===e.name&&e.geometries.push({type:"polygon",exterior:ty[0]})}(t,e);var r=o[n];r&&e.transformTo(r.left,r.top,r.width,r.height)}),ey(e).parsed={regions:i,boundingRect:function(t){for(var e,n=0;n<t.length;n++){var r=t[n].getBoundingRect();(e=e||r.clone()).union(r)}return e}(i)}}},ry=Li();function iy(t,e){var n,r,i=t.svgXML;try{X(null!=(r=(n=i&&function(t,e){return(new Ud).parse(t,{ignoreViewBox:!0,ignoreRootClip:!0})}(i)||{}).root))}catch(t){throw new Error("Invalid svg format\n"+t.message)}var o=n.width,a=n.height,s=n.viewBoxRect;if(e||(e=null==o||null==a?r.getBoundingRect():new Sn(0,0,0,0),null!=o&&(e.width=o),null!=a&&(e.height=a)),s){var l=nf(s,e.width,e.height),u=r;(r=new Cn).add(u),u.scale=l.scale,u.position=l.position}return r.setClipPath(new Ua({shape:e.plain()})),{root:r,boundingRect:e}}var oy={geoJSON:ny,svg:{load:function(t,e){var n=ry(e).originRoot;if(n)return{root:n,boundingRect:ry(e).boundingRect};var r=iy(e);return ry(e).originRoot=r.root,ry(e).boundingRect=r.boundingRect,r},makeGraphic:function(t,e,n){var r=ry(e),i=r.rootMap||(r.rootMap=Q()),o=i.get(n);if(o)return o;var a=r.originRoot;return o=r.originRootHostKey?iy(e,r.boundingRect).root:(r.originRootHostKey=n,a),i.set(n,o)},removeGraphic:function(t,e,n){var r=ry(e),i=r.rootMap;i&&i.removeKey(n),n===r.originRootHostKey&&(r.originRootHostKey=null)}}},ay={load:function(t,e,n){var r,i=[],o=Q(),a=Q();return k(ly(t),function(s){var l=oy[s.type].load(t,s,n);k(l.regions,function(t){var n=t.name;e&&e.hasOwnProperty(n)&&(t=t.cloneShallow(n=e[n])),i.push(t),o.set(n,t),a.set(n,t.center)});var u=l.boundingRect;u&&(r?r.union(u):r=u.clone())}),{regions:i,regionsMap:o,nameCoordMap:a,boundingRect:r||new Sn(0,0,0,0)}},makeGraphic:sy("makeGraphic"),removeGraphic:sy("removeGraphic")};function sy(t){return function(e,n){var r=ly(e),i=[];return k(r,function(r){var o=oy[r.type][t];o&&i.push(o(e,r,n))}),i}}function ly(t){return of(t)||[]}M(jc.extend({type:"series.map",dependencies:["geo"],layoutMode:"box",needsDrawMap:!1,seriesGroup:[],getInitialData:function(t){for(var e=_v(this,{coordDimensions:["value"],encodeDefaulter:E(Lu,this)}),n=e.mapDimension("value"),r=Q(),i=[],o=[],a=0,s=e.count();a<s;a++){var l=e.getName(a);r.set(l,!0),i.push({name:l,value:e.get(n,a),selected:Tc(e,a,"selected")})}return k(ay.load(this.getMapType(),this.option.nameMap,this.option.nameProperty).regions,function(t){var e=t.name;r.get(e)||(i.push({name:e}),o.push(e))}),this.updateSelectedMap(i),e.appendValues([],o),e},getHostGeoModel:function(){var t=this.option.geoIndex;return null!=t?this.dependentModels.geo[t]:null},getMapType:function(){return(this.getHostGeoModel()||this).option.map},getRawValue:function(t){var e=this.getData();return e.get(e.mapDimension("value"),t)},getRegionModel:function(t){var e=this.getData();return e.getItemModel(e.indexOfName(t))},formatTooltip:function(t,e,n,r){for(var i=this.getData(),o=zl(this.getRawValue(t)),a=i.getName(t),s=this.seriesGroup,l=[],u=0;u<s.length;u++){var c=s[u].originalData.indexOfName(a),d=i.mapDimension("value");isNaN(s[u].originalData.get(d,c))||l.push(jl(s[u].name))}var f="html"===r?"<br/>":"\n";return l.join(", ")+f+jl(a+" : "+o)},getTooltipPosition:function(t){if(null!=t){var e=this.getData().getName(t),n=this.coordinateSystem,r=n.getRegion(e);return r&&n.dataToPoint(r.center)}},setZoom:function(t){this.option.zoom=t},setCenter:function(t){this.option.center=t},defaultOption:{zlevel:0,z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:.75,showLegendSymbol:!0,dataRangeHoverLink:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}},nameProperty:"name"}}),wv);var uy="\0_ec_interaction_mutex";function cy(t,e){return!!dy(t)[e]}function dy(t){return t[uy]||(t[uy]={})}function fy(t){this._zr=t,this._opt={};var e=P,n=e(hy,this),r=e(py,this),i=e(gy,this),o=e(my,this),a=e(vy,this);kt.call(this),this.setPointerChecker=function(t){this.pointerChecker=t},this.enable=function(e,s){this.disable(),this._opt=b(m(s)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),null==e&&(e=!0),!0!==e&&"move"!==e&&"pan"!==e||(t.on("mousedown",n),t.on("mousemove",r),t.on("mouseup",i)),!0!==e&&"scale"!==e&&"zoom"!==e||(t.on("mousewheel",o),t.on("pinch",a))},this.disable=function(){t.off("mousedown",n),t.off("mousemove",r),t.off("mouseup",i),t.off("mousewheel",o),t.off("pinch",a)},this.dispose=this.disable,this.isDragging=function(){return this._dragging},this.isPinching=function(){return this._pinching}}function hy(t){if(!(Ut(t)||t.target&&t.target.draggable)){var e=t.offsetX,n=t.offsetY;this.pointerChecker&&this.pointerChecker(t,e,n)&&(this._x=e,this._y=n,this._dragging=!0)}}function py(t){if(this._dragging&&by("moveOnMouseMove",t,this._opt)&&"pinch"!==t.gestureEvent&&!cy(this._zr,"globalPan")){var e=t.offsetX,n=t.offsetY,r=this._x,i=this._y,o=e-r,a=n-i;this._x=e,this._y=n,this._opt.preventDefaultMouseMove&&Gt(t.event),xy(this,"pan","moveOnMouseMove",t,{dx:o,dy:a,oldX:r,oldY:i,newX:e,newY:n})}}function gy(t){Ut(t)||(this._dragging=!1)}function my(t){var e=by("zoomOnMouseWheel",t,this._opt),n=by("moveOnMouseWheel",t,this._opt),r=t.wheelDelta,i=Math.abs(r),o=t.offsetX,a=t.offsetY;if(0!==r&&(e||n)){if(e){var s=3<i?1.4:1<i?1.2:1.1;yy(this,"zoom","zoomOnMouseWheel",t,{scale:0<r?s:1/s,originX:o,originY:a})}if(n){var l=Math.abs(r);yy(this,"scrollMove","moveOnMouseWheel",t,{scrollDelta:(0<r?1:-1)*(3<l?.4:1<l?.15:.05),originX:o,originY:a})}}}function vy(t){cy(this._zr,"globalPan")||yy(this,"zoom",null,t,{scale:1<t.pinchScale?1.1:1/1.1,originX:t.pinchX,originY:t.pinchY})}function yy(t,e,n,r,i){t.pointerChecker&&t.pointerChecker(r,i.originX,i.originY)&&(Gt(r.event),xy(t,e,n,r,i))}function xy(t,e,n,r,i){i.isAvailableBehavior=P(by,null,n,r),t.trigger(e,i)}function by(t,e,n){var r=n[t];return!t||r&&(!N(r)||e.event[r+"Key"])}function _y(t,e,n){var r=t.target,i=r.position;i[0]+=e,i[1]+=n,r.dirty()}function wy(t,e,n,r){var i=t.target,o=t.zoomLimit,a=i.position,s=i.scale,l=t.zoom=t.zoom||1;if(l*=e,o){var u=o.min||0;l=Math.max(Math.min(o.max||1/0,l),u)}var c=l/t.zoom;t.zoom=l,a[0]-=(n-a[0])*(c-1),a[1]-=(r-a[1])*(c-1),s[0]*=c,s[1]*=c,i.dirty()}eh({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},function(){}),M(fy,kt);var Sy={axisPointer:1,tooltip:1,brush:1};function Cy(t,e,n){var r=e.getComponentByElement(t.topTarget),i=r&&r.coordinateSystem;return r&&r!==n&&!Sy[r.mainType]&&i&&i.model!==n}function My(t){var e=t.getItemStyle(),n=t.get("areaColor");return null!=n&&(e.fill=n),e}function Ty(t,e){e.eachChild(function(e){k(e.__regions,function(n){e.trigger(t.isSelected(n.name)?"emphasis":"normal")})})}function ky(t,e){var n=new Cn;this.uid=vl("ec_map_draw"),this._controller=new fy(t.getZr()),this._controllerHost={target:e?n:null},this.group=n,this._updateGroup=e,n.add(this._regionsGroup=new Cn),n.add(this._backgroundGroup=new Cn)}ky.prototype={constructor:ky,draw:function(t,e,n,r,i){var o="geo"===t.mainType,a=t.getData&&t.getData();o&&e.eachComponent({mainType:"series",subType:"map"},function(e){a||e.getHostGeoModel()!==t||(a=e.getData())});var s=t.coordinateSystem;this._updateBackground(s);var l,u=this._regionsGroup,c=this.group,d=s.getTransformInfo(),f=!u.childAt(0)||i;if(f)c.transform=d.roamTransform,c.decomposeTransform(),c.dirty();else{var h=new ge;h.transform=d.roamTransform,h.decomposeTransform(),l=h.scale,$s(c,{scale:h.scale,position:h.position},t)}var p=d.rawScale,g=d.rawPosition;u.removeAll();var m=["itemStyle"],v=["emphasis","itemStyle"],y=["label"],x=["emphasis","label"],b=Q();k(s.regions,function(e){var n=b.get(e.name)||b.set(e.name,new Cn),r=new Qa({segmentIgnoreThreshold:1,shape:{paths:[]}});n.add(r);var i,s=(R=t.getRegionModel(e.name)||t).getModel(m),d=R.getModel(v),h=My(s),_=My(d),w=R.getModel(y),S=R.getModel(x);if(a){i=a.indexOfName(e.name);var C=a.getItemVisual(i,"color",!0);C&&(h.fill=C)}function M(t){return[t[0]*p[0]+g[0],t[1]*p[1]+g[1]]}k(e.geometries,function(t){if("polygon"===t.type){for(var e=[],n=0;n<t.exterior.length;++n)e.push(M(t.exterior[n]));for(r.shape.paths.push(new za({segmentIgnoreThreshold:1,shape:{points:e}})),n=0;n<(t.interiors?t.interiors.length:0);++n){for(var i=t.interiors[n],o=(e=[],0);o<i.length;++o)e.push(M(i[o]));r.shape.paths.push(new za({segmentIgnoreThreshold:1,shape:{points:e}}))}}}),r.setStyle(h),r.style.strokeNoScale=!0,r.culling=!0;var T=w.get("show"),A=S.get("show"),I=a&&isNaN(a.get(a.mapDimension("value"),i)),D=a&&a.getItemLayout(i);if(o||I&&(T||A)||D&&D.showLabel){var O,P=o?e.name:i;(!a||0<=i)&&(O=t);var E=new Da({position:M(e.center.slice()),scale:[1/c.scale[0],1/c.scale[1]],z2:10,silent:!0});Vs(E.style,E.hoverStyle={},w,S,{labelFetcher:O,labelDataIndex:P,defaultText:e.name,useInsideStyle:!1},{textAlign:"center",textVerticalAlign:"middle"}),f||$s(E,{scale:[1/l[0],1/l[1]]},t),n.add(E)}if(a)a.setItemGraphicEl(i,n);else{var R=t.getRegionModel(e.name);r.eventData={componentType:"geo",componentIndex:t.componentIndex,geoIndex:t.componentIndex,name:e.name,region:R&&R.option||{}}}(n.__regions||(n.__regions=[])).push(e),n.highDownSilentOnTouch=!!t.get("selectedMode"),Ls(n,_),u.add(n)}),this._updateController(t,e,n),function(t,e,n,r,i){n.off("click"),n.off("mousedown"),e.get("selectedMode")&&(n.on("mousedown",function(){t._mouseDownFlag=!0}),n.on("click",function(o){if(t._mouseDownFlag){t._mouseDownFlag=!1;for(var a=o.target;!a.__regions;)a=a.parent;if(a){var s={type:("geo"===e.mainType?"geo":"map")+"ToggleSelect",batch:A(a.__regions,function(t){return{name:t.name,from:i.uid}})};s[e.mainType+"Id"]=e.id,r.dispatchAction(s),Ty(e,n)}}}))}(this,t,u,n,r),Ty(t,u)},remove:function(){this._regionsGroup.removeAll(),this._backgroundGroup.removeAll(),this._controller.dispose(),this._mapName&&ay.removeGraphic(this._mapName,this.uid),this._mapName=null,this._controllerHost={}},_updateBackground:function(t){var e=t.map;this._mapName!==e&&k(ay.makeGraphic(e,this.uid),function(t){this._backgroundGroup.add(t)},this),this._mapName=e},_updateController:function(t,e,n){var r=t.coordinateSystem,i=this._controller,o=this._controllerHost;o.zoomLimit=t.get("scaleLimit"),o.zoom=r.getZoom(),i.enable(t.get("roam")||!1);var a=t.mainType;function s(){var e={type:"geoRoam",componentType:a};return e[a+"Id"]=t.id,e}i.off("pan").on("pan",function(t){this._mouseDownFlag=!1,_y(o,t.dx,t.dy),n.dispatchAction(x(s(),{dx:t.dx,dy:t.dy}))},this),i.off("zoom").on("zoom",function(t){if(this._mouseDownFlag=!1,wy(o,t.scale,t.originX,t.originY),n.dispatchAction(x(s(),{zoom:t.scale,originX:t.originX,originY:t.originY})),this._updateGroup){var e=this.group.scale;this._regionsGroup.traverse(function(t){"text"===t.type&&t.attr("scale",[1/e[0],1/e[1]])})}},this),i.setPointerChecker(function(e,i,o){return r.getViewRectAfterRoam().contain(i,o)&&!Cy(e,n,t)})}};var Ay="__seriesMapHighDown",Iy="__seriesMapCallKey";function Dy(t){var e=this[Ay];e&&e.recordVersion===this[Iy]&&Oy(e,t)}function Oy(t,e){var n=t.circle,r=t.labelModel,i=t.hoverLabelModel,o=t.emphasisText,a=t.normalText;e?(n.style.extendFrom(Hs({},i,{text:i.get("show")?o:null},{isRectText:!0,useInsideStyle:!1},!0)),n.__mapOriginalZ2=n.z2,n.z2+=1):(Hs(n.style,r,{text:r.get("show")?a:null,textPosition:r.getShallow("position")||"bottom"},{isRectText:!0,useInsideStyle:!1}),n.dirty(!1),null!=n.__mapOriginalZ2&&(n.z2=n.__mapOriginalZ2,n.__mapOriginalZ2=null))}function Py(t,e,n){var r=t.getZoom(),i=t.getCenter(),o=e.zoom,a=t.dataToPoint(i);if(null!=e.dx&&null!=e.dy&&(a[0]-=e.dx,a[1]-=e.dy,i=t.pointToData(a),t.setCenter(i)),null!=o){if(n){var s=n.min||0;o=Math.max(Math.min(r*o,n.max||1/0),s)/r}t.scale[0]*=o,t.scale[1]*=o;var l=t.position,u=(e.originY-l[1])*(o-1);l[0]-=(e.originX-l[0])*(o-1),l[1]-=u,t.updateTransform(),i=t.pointToData(a),t.setCenter(i),t.setZoom(o*r)}return{center:t.getCenter(),zoom:t.getZoom()}}ch({type:"map",render:function(t,e,n,r){if(!r||"mapToggleSelect"!==r.type||r.from!==this.uid){var i=this.group;if(i.removeAll(),!t.getHostGeoModel()){if(r&&"geoRoam"===r.type&&"series"===r.componentType&&r.seriesId===t.id)(o=this._mapDraw)&&i.add(o.group);else if(t.needsDrawMap){var o=this._mapDraw||new ky(n,!0);i.add(o.group),o.draw(t,e,n,this,r),this._mapDraw=o}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;t.get("showLegendSymbol")&&e.getComponent("legend")&&this._renderSymbols(t,e,n)}}},remove:function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},dispose:function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},_renderSymbols:function(t,e,n){var r=t.originalData,i=this.group;r.each(r.mapDimension("value"),function(e,n){if(!isNaN(e)){var o=r.getItemLayout(n);if(o&&o.point){var a=o.point,s=o.offset,l=new Pa({style:{fill:t.getData().getVisual("color")},shape:{cx:a[0]+9*s,cy:a[1],r:3},silent:!0,z2:8+(s?0:2)});if(!s){var u=t.mainSeries.getData(),c=r.getName(n),d=u.indexOfName(c),f=r.getItemModel(n),h=f.getModel("label"),p=f.getModel("emphasis.label"),g=u.getItemGraphicEl(d),m=j(t.getFormattedLabel(d,"normal"),c),v=j(t.getFormattedLabel(d,"emphasis"),m),y=g[Ay],b=Math.random();if(!y){y=g[Ay]={};var _=E(Dy,!0),w=E(Dy,!1);g.on("mouseover",_).on("mouseout",w).on("emphasis",_).on("normal",w)}x(y,{recordVersion:g[Iy]=b,circle:l,labelModel:h,hoverLabelModel:p,emphasisText:v,normalText:m}),Oy(y,!1)}i.add(l)}}})}}),eh({type:"geoRoam",event:"geoRoam",update:"updateTransform"},function(t,e){var n=t.componentType||"series";e.eachComponent({mainType:n,query:t},function(e){var r=e.coordinateSystem;if("geo"===r.type){var i=Py(r,t,e.get("scaleLimit"));e.setCenter&&e.setCenter(i.center),e.setZoom&&e.setZoom(i.zoom),"series"===n&&k(e.seriesGroup,function(t){t.setCenter(i.center),t.setZoom(i.zoom)})}})});var Ey=bt;function Ry(){ge.call(this)}function Ly(t){this.name=t,ge.call(this),this._roamTransformable=new Ry,this._rawTransformable=new Ry}function Ny(t,e,n,r){var i=n.seriesModel,o=i?i.coordinateSystem:null;return o===this?o[t](r):null}function By(t,e,n,r){Ly.call(this,t),this.map=e;var i=ay.load(e,n);this._nameCoordMap=i.nameCoordMap,this._regionsMap=i.regionsMap,this._invertLongitute=null==r||r,this.regions=i.regions,this._rect=i.boundingRect}function zy(t,e,n,r){var i=n.geoModel,o=n.seriesModel,a=i?i.coordinateSystem:o?o.coordinateSystem||(o.getReferringComponents("geo")[0]||{}).coordinateSystem:null;return a===this?a[t](r):null}function Vy(t,e){var n=t.get("boundingCoords");if(null!=n){var r=n[0],i=n[1];isNaN(r[0])||isNaN(r[1])||isNaN(i[0])||isNaN(i[1])||this.setBoundingRect(r[0],r[1],i[0]-r[0],i[1]-r[1])}var o,a=this.getBoundingRect(),s=t.get("layoutCenter"),l=t.get("layoutSize"),u=e.getWidth(),c=e.getHeight(),d=a.width/a.height*this.aspectScale,f=!1;if(s&&l&&(s=[bl(s[0],u),bl(s[1],c)],l=bl(l,Math.min(u,c)),isNaN(s[0])||isNaN(s[1])||isNaN(l)||(f=!0)),f){var h={};1<d?(h.width=l,h.height=l/d):(h.height=l,h.width=l*d),h.y=s[1]-h.height/2,h.x=s[0]-h.width/2}else(o=t.getBoxLayoutParams()).aspect=d,h=au(o,{width:u,height:c});this.setViewRect(h.x,h.y,h.width,h.height),this.setCenter(t.get("center")),this.setZoom(t.get("zoom"))}function Fy(t,e){k(e.get("geoCoord"),function(e,n){t.addGeoCoord(n,e)})}M(Ry,ge),Ly.prototype={constructor:Ly,type:"view",dimensions:["x","y"],setBoundingRect:function(t,e,n,r){return this._rect=new Sn(t,e,n,r),this._rect},getBoundingRect:function(){return this._rect},setViewRect:function(t,e,n,r){this.transformTo(t,e,n,r),this._viewRect=new Sn(t,e,n,r)},transformTo:function(t,e,n,r){var i=this.getBoundingRect(),o=this._rawTransformable;o.transform=i.calculateTransform(new Sn(t,e,n,r)),o.decomposeTransform(),this._updateTransform()},setCenter:function(t){t&&(this._center=t,this._updateCenterAndZoom())},setZoom:function(t){t=t||1;var e=this.zoomLimit;e&&(null!=e.max&&(t=Math.min(e.max,t)),null!=e.min&&(t=Math.max(e.min,t))),this._zoom=t,this._updateCenterAndZoom()},getDefaultCenter:function(){var t=this.getBoundingRect();return[t.x+t.width/2,t.y+t.height/2]},getCenter:function(){return this._center||this.getDefaultCenter()},getZoom:function(){return this._zoom||1},getRoamTransform:function(){return this._roamTransformable.getLocalTransform()},_updateCenterAndZoom:function(){var t=this._rawTransformable.getLocalTransform(),e=this._roamTransformable,n=this.getDefaultCenter(),r=this.getCenter(),i=this.getZoom();r=bt([],r,t),n=bt([],n,t),e.origin=r,e.position=[n[0]-r[0],n[1]-r[1]],e.scale=[i,i],this._updateTransform()},_updateTransform:function(){var t=this._rawTransformable;(t.parent=this._roamTransformable).updateTransform(),t.updateTransform(),oe(this.transform||(this.transform=[]),t.transform||re()),this._rawTransform=t.getLocalTransform(),this.invTransform=this.invTransform||[],ce(this.invTransform,this.transform),this.decomposeTransform()},getTransformInfo:function(){var t=this._roamTransformable.transform,e=this._rawTransformable;return{roamTransform:t?U(t):re(),rawScale:U(e.scale),rawPosition:U(e.position)}},getViewRect:function(){return this._viewRect},getViewRectAfterRoam:function(){var t=this.getBoundingRect().clone();return t.applyTransform(this.transform),t},dataToPoint:function(t,e,n){var r=e?this._rawTransform:this.transform;return n=n||[],r?Ey(n,t,r):ot(n,t)},pointToData:function(t){var e=this.invTransform;return e?Ey([],t,e):[t[0],t[1]]},convertToPixel:E(Ny,"dataToPoint"),convertFromPixel:E(Ny,"pointToData"),containPoint:function(t){return this.getViewRectAfterRoam().contain(t[0],t[1])}},M(Ly,ge),By.prototype={constructor:By,type:"geo",dimensions:["lng","lat"],containCoord:function(t){for(var e=this.regions,n=0;n<e.length;n++)if(e[n].contain(t))return!0;return!1},transformTo:function(t,e,n,r){var i=this.getBoundingRect(),o=this._invertLongitute;i=i.clone(),o&&(i.y=-i.y-i.height);var a=this._rawTransformable;if(a.transform=i.calculateTransform(new Sn(t,e,n,r)),a.decomposeTransform(),o){var s=a.scale;s[1]=-s[1]}a.updateTransform(),this._updateTransform()},getRegion:function(t){return this._regionsMap.get(t)},getRegionByCoord:function(t){for(var e=this.regions,n=0;n<e.length;n++)if(e[n].contain(t))return e[n]},addGeoCoord:function(t,e){this._nameCoordMap.set(t,e)},getGeoCoord:function(t){return this._nameCoordMap.get(t)},getBoundingRect:function(){return this._rect},dataToPoint:function(t,e,n){if("string"==typeof t&&(t=this.getGeoCoord(t)),t)return Ly.prototype.dataToPoint.call(this,t,e,n)},convertToPixel:E(zy,"dataToPoint"),convertFromPixel:E(zy,"pointToData")},M(By,Ly);var Hy={dimensions:By.prototype.dimensions,create:function(t,e){var n=[];t.eachComponent("geo",function(t,r){var i=t.get("map"),o=t.get("aspectScale"),a=!0,s=of(i);s&&s[0]&&"svg"===s[0].type?(null==o&&(o=1),a=!1):null==o&&(o=.75);var l=new By(i+r,i,t.get("nameMap"),a);l.aspectScale=o,l.zoomLimit=t.get("scaleLimit"),n.push(l),Fy(l,t),(t.coordinateSystem=l).model=t,l.resize=Vy,l.resize(t,e)}),t.eachSeries(function(t){if("geo"===t.get("coordinateSystem")){var e=t.get("geoIndex")||0;t.coordinateSystem=n[e]}});var r={};return t.eachSeriesByType("map",function(t){if(!t.getHostGeoModel()){var e=t.getMapType();r[e]=r[e]||[],r[e].push(t)}}),k(r,function(t,r){var i=new By(r,r,y(A(t,function(t){return t.get("nameMap")})));i.zoomLimit=W.apply(null,A(t,function(t){return t.get("scaleLimit")})),n.push(i),i.resize=Vy,i.aspectScale=t[0].get("aspectScale"),i.resize(t[0],e),k(t,function(t){Fy(t.coordinateSystem=i,t)})}),n},getFilledRegions:function(t,e,n){for(var r=(t||[]).slice(),i=Q(),o=0;o<r.length;o++)i.set(r[o].name,r[o]);return k(ay.load(e,n).regions,function(t){var e=t.name;i.get(e)||r.push({name:e})}),r}};nh("geo",Hy),rh(function(t){var e={};t.eachSeriesByType("map",function(n){var r=n.getMapType();if(!n.getHostGeoModel()&&!e[r]){var i={};k(n.seriesGroup,function(e){var n=e.coordinateSystem,r=e.originalData;e.get("showLegendSymbol")&&t.getComponent("legend")&&r.each(r.mapDimension("value"),function(t,e){var o=r.getName(e),a=n.getRegion(o);if(a&&!isNaN(t)){var s=i[o]||0,l=n.dataToPoint(a.center);i[o]=s+1,r.setItemLayout(e,{point:l,offset:s})}})});var o=n.getData();o.each(function(t){var e=o.getName(t),n=o.getItemLayout(t)||{};n.showLabel=!i[e],o.setItemLayout(t,n)}),e[r]=!0}})}),ih(function(t){t.eachSeriesByType("map",function(t){var e=t.get("color"),n=t.getModel("itemStyle"),r=n.get("areaColor"),i=n.get("color")||e[t.seriesIndex%e.length];t.getData().setVisual({areaColor:r,color:i})})}),th(ff.PROCESSOR.STATISTIC,function(t){var e={};t.eachSeriesByType("map",function(t){var n=t.getHostGeoModel(),r=n?"o"+n.id:"i"+t.getMapType();(e[r]=e[r]||[]).push(t)}),k(e,function(t,e){for(var n=function(t,e){var n={};return k(t,function(t){t.each(t.mapDimension("value"),function(e,r){var i="ec-"+t.getName(r);n[i]=n[i]||[],isNaN(e)||n[i].push(e)})}),t[0].map(t[0].mapDimension("value"),function(r,i){for(var o="ec-"+t[0].getName(i),a=0,s=1/0,l=-1/0,u=n[o].length,c=0;c<u;c++)s=Math.min(s,n[o][c]),l=Math.max(l,n[o][c]),a+=n[o][c];return 0===u?NaN:"min"===e?s:"max"===e?l:"average"===e?a/u:a})}(A(t,function(t){return t.getData()}),t[0].get("mapValueCalculation")),r=0;r<t.length;r++)t[r].originalData=t[r].getData();for(r=0;r<t.length;r++)(t[r].seriesGroup=t)[r].needsDrawMap=0===r&&!t[r].getHostGeoModel(),t[r].setData(n.cloneShallow()),t[r].mainSeries=t[0]})}),Qf(function(t){var e=[];k(t.series,function(t){t&&"map"===t.type&&(e.push(t),t.map=t.map||t.mapType,b(t,t.mapLocation))})}),Iv("map",[{type:"mapToggleSelect",event:"mapselectchanged",method:"toggleSelected"},{type:"mapSelect",event:"mapselected",method:"select"},{type:"mapUnSelect",event:"mapunselected",method:"unSelect"}]);var Wy=k,jy="\0__link_datas",Gy="\0__link_mainData";function Uy(t){var e=t.mainData,n=t.datas;n||(n={main:e},t.datasAttr={main:"data"}),t.datas=t.mainData=null,Zy(e,n,t),Wy(n,function(n){Wy(e.TRANSFERABLE_METHODS,function(e){n.wrapMethod(e,E(qy,t))})}),e.wrapMethod("cloneShallow",E(Yy,t)),Wy(e.CHANGABLE_METHODS,function(n){e.wrapMethod(n,E(Xy,t))}),X(n[e.dataType]===e)}function qy(t,e){if(function(t){return t[Gy]===t}(this)){var n=x({},this[jy]);Zy(n[this.dataType]=e,n,t)}else Ky(e,this.dataType,this[Gy],t);return e}function Xy(t,e){return t.struct&&t.struct.update(this),e}function Yy(t,e){return Wy(e[jy],function(n,r){n!==e&&Ky(n.cloneShallow(),r,e,t)}),e}function $y(t){var e=this[Gy];return null==t||null==e?e:e[jy][t]}function Zy(t,e,n){t[jy]={},Wy(e,function(e,r){Ky(e,r,t,n)})}function Ky(t,e,n,r){(n[jy][e]=t)[Gy]=n,t.dataType=e,r.struct&&(t[r.structAttr]=r.struct,r.struct[r.datasAttr[e]]=t),t.getLinkedData=$y}function Jy(t,e){this.name=t||"",this.depth=0,this.height=0,this.parentNode=null,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.hostTree=e}function Qy(t){this._nodes=[],this.hostModel=t}function tx(t,e){var n=t.isExpand?t.children:[],r=t.parentNode.children,i=t.hierNode.i?r[t.hierNode.i-1]:null;if(n.length){!function(t){for(var e=t.children,n=e.length,r=0,i=0;0<=--n;){var o=e[n];o.hierNode.prelim+=r,o.hierNode.modifier+=r,r+=o.hierNode.shift+(i+=o.hierNode.change)}}(t);var o=(n[0].hierNode.prelim+n[n.length-1].hierNode.prelim)/2;i?(t.hierNode.prelim=i.hierNode.prelim+e(t,i),t.hierNode.modifier=t.hierNode.prelim-o):t.hierNode.prelim=o}else i&&(t.hierNode.prelim=i.hierNode.prelim+e(t,i));t.parentNode.hierNode.defaultAncestor=function(t,e,n,r){if(e){for(var i=t,o=t,a=o.parentNode.children[0],s=e,l=i.hierNode.modifier,u=o.hierNode.modifier,c=a.hierNode.modifier,d=s.hierNode.modifier;s=ix(s),o=ox(o),s&&o;){i=ix(i),a=ox(a),i.hierNode.ancestor=t;var f=s.hierNode.prelim+d-o.hierNode.prelim-u+r(s,o);0<f&&(ax((h=s).hierNode.ancestor.parentNode===t.parentNode?h.hierNode.ancestor:n,t,f),u+=f,l+=f),d+=s.hierNode.modifier,u+=o.hierNode.modifier,l+=i.hierNode.modifier,c+=a.hierNode.modifier}s&&!ix(i)&&(i.hierNode.thread=s,i.hierNode.modifier+=d-l),o&&!ox(a)&&(a.hierNode.thread=o,a.hierNode.modifier+=u-c,n=t)}var h;return n}(t,i,t.parentNode.hierNode.defaultAncestor||r[0],e)}function ex(t){t.setLayout({x:t.hierNode.prelim+t.parentNode.hierNode.modifier},!0),t.hierNode.modifier+=t.parentNode.hierNode.modifier}function nx(t){return arguments.length?t:sx}function rx(t,e){var n={};return t-=Math.PI/2,n.x=e*Math.cos(t),n.y=e*Math.sin(t),n}function ix(t){var e=t.children;return e.length&&t.isExpand?e[e.length-1]:t.hierNode.thread}function ox(t){var e=t.children;return e.length&&t.isExpand?e[0]:t.hierNode.thread}function ax(t,e,n){var r=n/(e.hierNode.i-t.hierNode.i);e.hierNode.change-=r,e.hierNode.shift+=n,e.hierNode.modifier+=n,e.hierNode.prelim+=n,t.hierNode.change+=r}function sx(t,e){return t.parentNode===e.parentNode?1:2}Jy.prototype={constructor:Jy,isRemoved:function(){return this.dataIndex<0},eachNode:function(t,e,n){"function"==typeof t&&(n=e,e=t,t=null),N(t=t||{})&&(t={order:t});var r,i=t.order||"preorder",o=this[t.attr||"children"];"preorder"===i&&(r=e.call(n,this));for(var a=0;!r&&a<o.length;a++)o[a].eachNode(t,e,n);"postorder"===i&&e.call(n,this)},updateDepthAndHeight:function(t){var e=0;this.depth=t;for(var n=0;n<this.children.length;n++){var r=this.children[n];r.updateDepthAndHeight(t+1),r.height>e&&(e=r.height)}this.height=e+1},getNodeById:function(t){if(this.getId()===t)return this;for(var e=0,n=this.children,r=n.length;e<r;e++){var i=n[e].getNodeById(t);if(i)return i}},contains:function(t){if(t===this)return!0;for(var e=0,n=this.children,r=n.length;e<r;e++){var i=n[e].contains(t);if(i)return i}},getAncestors:function(t){for(var e=[],n=t?this:this.parentNode;n;)e.push(n),n=n.parentNode;return e.reverse(),e},getValue:function(t){var e=this.hostTree.data;return e.get(e.getDimension(t||"value"),this.dataIndex)},setLayout:function(t,e){0<=this.dataIndex&&this.hostTree.data.setItemLayout(this.dataIndex,t,e)},getLayout:function(){return this.hostTree.data.getItemLayout(this.dataIndex)},getModel:function(t){if(!(this.dataIndex<0))return this.hostTree.data.getItemModel(this.dataIndex).getModel(t)},setVisual:function(t,e){0<=this.dataIndex&&this.hostTree.data.setItemVisual(this.dataIndex,t,e)},getVisual:function(t,e){return this.hostTree.data.getItemVisual(this.dataIndex,t,e)},getRawIndex:function(){return this.hostTree.data.getRawIndex(this.dataIndex)},getId:function(){return this.hostTree.data.getId(this.dataIndex)},isAncestorOf:function(t){for(var e=t.parentNode;e;){if(e===this)return!0;e=e.parentNode}return!1},isDescendantOf:function(t){return t!==this&&t.isAncestorOf(this)}},Qy.prototype={constructor:Qy,type:"tree",eachNode:function(t,e,n){this.root.eachNode(t,e,n)},getNodeByDataIndex:function(t){var e=this.data.getRawIndex(t);return this._nodes[e]},getNodeByName:function(t){return this.root.getNodeByName(t)},update:function(){for(var t=this.data,e=this._nodes,n=0,r=e.length;n<r;n++)e[n].dataIndex=-1;for(n=0,r=t.count();n<r;n++)e[t.getRawIndex(n)].dataIndex=n},clearLayouts:function(){this.data.clearItemLayouts()}},Qy.createTree=function(t,e,n){var r=new Qy(e),i=[],o=1;!function t(e,n){var a=e.value;o=Math.max(o,R(a)?a.length:1),i.push(e);var s=new Jy(e.name,r);n?function(t,e){t.parentNode!==e&&(e.children.push(t),t.parentNode=e)}(s,n):r.root=s,r._nodes.push(s);var l=e.children;if(l)for(var u=0;u<l.length;u++)t(l[u],s)}(t),r.root.updateDepthAndHeight(0);var a=Wh(i,{coordDimensions:["value"],dimensionsCount:o}),s=new Ah(a,e);return s.initData(i),n&&n(s),Uy({mainData:s,struct:r,structAttr:"tree"}),r.update(),r},jc.extend({type:"series.tree",layoutInfo:null,layoutMode:"box",getInitialData:function(t){var e={name:t.name,children:t.data},n=new hl(t.leaves||{},this,this.ecModel),r=Qy.createTree(e,this,function(t){t.wrapMethod("getItemModel",function(t,e){var i=r.getNodeByDataIndex(e);return i.children.length&&i.isExpand||(t.parentModel=n),t})}),i=0;r.eachNode("preorder",function(t){t.depth>i&&(i=t.depth)});var o=t.expandAndCollapse&&0<=t.initialTreeDepth?t.initialTreeDepth:i;return r.root.eachNode("preorder",function(t){var e=t.hostTree.data.getRawDataItem(t.dataIndex);t.isExpand=e&&null!=e.collapsed?!e.collapsed:t.depth<=o}),r.data},getOrient:function(){var t=this.get("orient");return"horizontal"===t?t="LR":"vertical"===t&&(t="TB"),t},setZoom:function(t){this.option.zoom=t},setCenter:function(t){this.option.center=t},formatTooltip:function(t){for(var e=this.getData().tree,n=e.root.children[0],r=e.getNodeByDataIndex(t),i=r.getValue(),o=r.name;r&&r!==n;)o=r.parentNode.name+"."+o,r=r.parentNode;return jl(o+(isNaN(i)||null==i?"":" : "+i))},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",edgeShape:"curve",edgeForkPosition:"50%",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderColor:"#c23531",borderWidth:1.5},label:{show:!0,color:"#555"},leaves:{label:{show:!0}},animationEasing:"linear",animationDuration:700,animationDurationUpdate:1e3}});var lx=hs({shape:{parentPoint:[],childPoints:[],orient:"",forkPosition:""},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.childPoints,r=n.length,i=e.parentPoint,o=n[0],a=n[r-1];if(1===r)return t.moveTo(i[0],i[1]),void t.lineTo(o[0],o[1]);var s=e.orient,l="TB"===s||"BT"===s?0:1,u=1-l,c=bl(e.forkPosition,1),d=[];d[l]=i[l],d[u]=i[u]+(a[u]-i[u])*c,t.moveTo(i[0],i[1]),t.lineTo(d[0],d[1]),t.moveTo(o[0],o[1]),d[l]=o[l],t.lineTo(d[0],d[1]),d[l]=a[l],t.lineTo(d[0],d[1]),t.lineTo(a[0],a[1]);for(var f=1;f<r-1;f++){var h=n[f];t.moveTo(h[0],h[1]),d[l]=h[l],t.lineTo(d[0],d[1])}}});function ux(t,e){var n=t.getItemLayout(e);return n&&!isNaN(n.x)&&!isNaN(n.y)&&"none"!==t.getItemVisual(e,"symbol")}function cx(t,e,n){return n.itemModel=e,n.itemStyle=e.getModel("itemStyle").getItemStyle(),n.hoverItemStyle=e.getModel("emphasis.itemStyle").getItemStyle(),n.lineStyle=e.getModel("lineStyle").getLineStyle(),n.labelModel=e.getModel("label"),n.hoverLabelModel=e.getModel("emphasis.label"),n.symbolInnerColor=!1===t.isExpand&&0!==t.children.length?n.itemStyle.fill:"#fff",n}function dx(t,e,n,r,i,o){var a=!n,s=t.tree.getNodeByDataIndex(e),l=s.getModel(),u=(o=cx(s,l,o),t.tree.root),c=s.parentNode===u?s:s.parentNode||s,d=t.getItemGraphicEl(c.dataIndex),f=c.getLayout(),h=d?{x:d.position[0],y:d.position[1],rawX:d.__radialOldRawX,rawY:d.__radialOldRawY}:f,p=s.getLayout();a?(n=new wg(t,e,o)).attr("position",[h.x,h.y]):n.updateData(t,e,o),n.__radialOldRawX=n.__radialRawX,n.__radialOldRawY=n.__radialRawY,n.__radialRawX=p.rawX,n.__radialRawY=p.rawY,r.add(n),t.setItemGraphicEl(e,n),$s(n,{position:[p.x,p.y]},i);var g=n.getSymbolPath();if("radial"===o.layout){var m,v,y=u.children[0],x=y.getLayout(),_=y.children.length;if(p.x===x.x&&!0===s.isExpand){var w={};w.x=(y.children[0].getLayout().x+y.children[_-1].getLayout().x)/2,w.y=(y.children[0].getLayout().y+y.children[_-1].getLayout().y)/2,(m=Math.atan2(w.y-x.y,w.x-x.x))<0&&(m=2*Math.PI+m),(v=w.x<x.x)&&(m-=Math.PI)}else(m=Math.atan2(p.y-x.y,p.x-x.x))<0&&(m=2*Math.PI+m),0===s.children.length||0!==s.children.length&&!1===s.isExpand?(v=p.x<x.x)&&(m-=Math.PI):(v=p.x>x.x)||(m-=Math.PI);var S=v?"left":"right",C=o.labelModel.get("rotate"),M=C*(Math.PI/180);g.setStyle({textPosition:o.labelModel.get("position")||S,textRotation:null==C?-m:M,textOrigin:"center",verticalAlign:"middle"})}!function(t,e,n,r,i,o,a,s,l){var u=l.edgeShape,c=r.__edge;if("curve"===u)e.parentNode&&e.parentNode!==n&&$s(c=c||(r.__edge=new Ka({shape:hx(l,i,i),style:b({opacity:0,strokeNoScale:!0},l.lineStyle)})),{shape:hx(l,o,a),style:b({opacity:1},l.lineStyle)},t);else if("polyline"===u&&"orthogonal"===l.layout&&e!==n&&e.children&&0!==e.children.length&&!0===e.isExpand){for(var d=e.children,f=[],h=0;h<d.length;h++){var p=d[h].getLayout();f.push([p.x,p.y])}$s(c=c||(r.__edge=new lx({shape:{parentPoint:[a.x,a.y],childPoints:[[a.x,a.y]],orient:l.orient,forkPosition:l.edgeForkPosition},style:b({opacity:0,strokeNoScale:!0},l.lineStyle)})),{shape:{parentPoint:[a.x,a.y],childPoints:f},style:b({opacity:1},l.lineStyle)},t)}s.add(c)}(i,s,u,n,h,f,p,r,o)}function fx(t,e,n,r,i,o){for(var a,s,l=t.tree.getNodeByDataIndex(e),u=t.tree.root,c=l.getModel(),d=(o=cx(l,c,o),l.parentNode===u?l:l.parentNode||l);null==(a=d.getLayout());)d=d.parentNode===u?d:d.parentNode||d;$s(n,{position:[a.x+1,a.y+1]},i,function(){r.remove(n),t.setItemGraphicEl(e,null)}),n.fadeOut(null,{keepLabel:!0});var f=t.getItemGraphicEl(d.dataIndex).__edge,h=n.__edge||(!1===d.isExpand||1===d.children.length?f:void 0);s=o.edgeShape,h&&("curve"===s?$s(h,{shape:hx(o,a,a),style:{opacity:0}},i,function(){r.remove(h)}):"polyline"===s&&"orthogonal"===o.layout&&$s(h,{shape:{parentPoint:[a.x,a.y],childPoints:[[a.x,a.y]]},style:{opacity:0}},i,function(){r.remove(h)}))}function hx(t,e,n){var r,i,o,a,s,l,u,c,d=t.orient;if("radial"!==t.layout)return s=e.x,u=e.y,l=n.x,c=n.y,"LR"!==d&&"RL"!==d||(r=s+(l-s)*t.curvature,i=u,o=l+(s-l)*t.curvature,a=c),"TB"!==d&&"BT"!==d||(r=s,i=u+(c-u)*t.curvature,o=l,a=c+(u-c)*t.curvature),{x1:s,y1:u,x2:l,y2:c,cpx1:r,cpy1:i,cpx2:o,cpy2:a};l=n.rawX,c=n.rawY;var f=rx(s=e.rawX,u=e.rawY),h=rx(s,u+(c-u)*t.curvature),p=rx(l,c+(u-c)*t.curvature),g=rx(l,c);return{x1:f.x,y1:f.y,x2:g.x,y2:g.y,cpx1:h.x,cpy1:h.y,cpx2:p.x,cpy2:p.y}}function px(t,e){for(var n,r=[t];n=r.pop();)if(e(n),n.isExpand){var i=n.children;if(i.length)for(var o=i.length-1;0<=o;o--)r.push(i[o])}}function gx(t,e,n){if(t&&0<=S(e,t.type)){var r=n.getData().tree.root,i=t.targetNode;if("string"==typeof i&&(i=r.getNodeById(i)),i&&r.contains(i))return{node:i};var o=t.targetNodeId;if(null!=o&&(i=r.getNodeById(o)))return{node:i}}}function mx(t){for(var e=[];t;)(t=t.parentNode)&&e.push(t);return e.reverse()}function vx(t,e){return 0<=S(mx(t),e)}function yx(t,e){for(var n=[];t;){var r=t.dataIndex;n.push({name:t.name,dataIndex:r,value:e.getRawValue(r)}),t=t.parentNode}return n.reverse(),n}function xx(t){this.group=new Cn,t.add(this.group)}function bx(t,e,n,r,i,o){var a=[[i?t:t-5,e],[t+n,e],[t+n,e+r],[i?t:t-5,e+r]];return o||a.splice(2,0,[t+n+5,e+r/2]),i||a.push([t,e+r/2]),a}function _x(t){var e=Ox(t);return e.stroke=e.fill=e.lineWidth=null,e}ch({type:"tree",init:function(t,e){this._mainGroup=new Cn,this._controller=new fy(e.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},render:function(t,e,n,r){var i=t.getData(),o=t.layoutInfo,a=this._mainGroup,s=t.get("layout");a.attr("position","radial"===s?[o.x+o.width/2,o.y+o.height/2]:[o.x,o.y]),this._updateViewCoordSys(t,o,s),this._updateController(t,e,n);var l=this._data,u={expandAndCollapse:t.get("expandAndCollapse"),layout:s,edgeShape:t.get("edgeShape"),edgeForkPosition:t.get("edgeForkPosition"),orient:t.getOrient(),curvature:t.get("lineStyle.curveness"),symbolRotate:t.get("symbolRotate"),symbolOffset:t.get("symbolOffset"),hoverAnimation:t.get("hoverAnimation"),useNameLabel:!0,fadeIn:!0};i.diff(l).add(function(e){ux(i,e)&&dx(i,e,null,a,t,u)}).update(function(e,n){var r=l.getItemGraphicEl(n);ux(i,e)?dx(i,e,r,a,t,u):r&&fx(l,n,r,a,t,u)}).remove(function(e){var n=l.getItemGraphicEl(e);n&&fx(l,e,n,a,t,u)}).execute(),this._nodeScaleRatio=t.get("nodeScaleRatio"),this._updateNodeAndLinkScale(t),!0===u.expandAndCollapse&&i.eachItemGraphicEl(function(e,r){e.off("click").on("click",function(){n.dispatchAction({type:"treeExpandAndCollapse",seriesId:t.id,dataIndex:r})})}),this._data=i},_updateViewCoordSys:function(t){var e=t.getData(),n=[];e.each(function(t){var r=e.getItemLayout(t);!r||isNaN(r.x)||isNaN(r.y)||n.push([+r.x,+r.y])});var r=[],i=[];Io(n,r,i);var o=this._min,a=this._max;i[0]-r[0]==0&&(r[0]=o?o[0]:r[0]-1,i[0]=a?a[0]:i[0]+1),i[1]-r[1]==0&&(r[1]=o?o[1]:r[1]-1,i[1]=a?a[1]:i[1]+1);var s=t.coordinateSystem=new Ly;s.zoomLimit=t.get("scaleLimit"),s.setBoundingRect(r[0],r[1],i[0]-r[0],i[1]-r[1]),s.setCenter(t.get("center")),s.setZoom(t.get("zoom")),this.group.attr({position:s.position,scale:s.scale}),this._viewCoordSys=s,this._min=r,this._max=i},_updateController:function(t,e,n){var r=this._controller,i=this._controllerHost,o=this.group;r.setPointerChecker(function(e,r,i){var a=o.getBoundingRect();return a.applyTransform(o.transform),a.contain(r,i)&&!Cy(e,n,t)}),r.enable(t.get("roam")),i.zoomLimit=t.get("scaleLimit"),i.zoom=t.coordinateSystem.getZoom(),r.off("pan").off("zoom").on("pan",function(e){_y(i,e.dx,e.dy),n.dispatchAction({seriesId:t.id,type:"treeRoam",dx:e.dx,dy:e.dy})},this).on("zoom",function(e){wy(i,e.scale,e.originX,e.originY),n.dispatchAction({seriesId:t.id,type:"treeRoam",zoom:e.scale,originX:e.originX,originY:e.originY}),this._updateNodeAndLinkScale(t)},this)},_updateNodeAndLinkScale:function(t){var e=t.getData(),n=this._getNodeGlobalScale(t),r=[n,n];e.eachItemGraphicEl(function(t,e){t.attr("scale",r)})},_getNodeGlobalScale:function(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var n=this._nodeScaleRatio,r=e.scale,i=r&&r[0]||1;return((e.getZoom()-1)*n+1)/i},dispose:function(){this._controller&&this._controller.dispose(),this._controllerHost={}},remove:function(){this._mainGroup.removeAll(),this._data=null}}),eh({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(t,e){e.eachComponent({mainType:"series",subType:"tree",query:t},function(e){var n=t.dataIndex,r=e.getData().tree.getNodeByDataIndex(n);r.isExpand=!r.isExpand})}),eh({type:"treeRoam",event:"treeRoam",update:"none"},function(t,e){e.eachComponent({mainType:"series",subType:"tree",query:t},function(e){var n=Py(e.coordinateSystem,t);e.setCenter&&e.setCenter(n.center),e.setZoom&&e.setZoom(n.zoom)})}),ih(om("tree","circle")),rh(function(t,e){t.eachSeriesByType("tree",function(t){!function(t,e){var n=function(t,e){return au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}(t,e);t.layoutInfo=n;var r=t.get("layout"),i=0,o=0,a=null;a="radial"===r?(i=2*Math.PI,o=Math.min(n.height,n.width)/2,nx(function(t,e){return(t.parentNode===e.parentNode?1:2)/t.depth})):(i=n.width,o=n.height,nx());var s=t.getData().tree.root,l=s.children[0];if(l){!function(t){t.hierNode={defaultAncestor:null,ancestor:t,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var e,n,r=[t];e=r.pop();)if(n=e.children,e.isExpand&&n.length)for(var i=n.length-1;0<=i;i--){var o=n[i];o.hierNode={defaultAncestor:null,ancestor:o,prelim:0,modifier:0,change:0,shift:0,i:i,thread:null},r.push(o)}}(s),function(t,e,n){for(var r,i=[t],o=[];r=i.pop();)if(o.push(r),r.isExpand){var a=r.children;if(a.length)for(var s=0;s<a.length;s++)i.push(a[s])}for(;r=o.pop();)e(r,n)}(l,tx,a),s.hierNode.modifier=-l.hierNode.prelim,px(l,ex);var u=l,c=l,d=l;px(l,function(t){var e=t.getLayout().x;e<u.getLayout().x&&(u=t),e>c.getLayout().x&&(c=t),t.depth>d.depth&&(d=t)});var f=u===c?1:a(u,c)/2,h=f-u.getLayout().x,p=0,g=0,m=0,v=0;if("radial"===r)p=i/(c.getLayout().x+f+h),g=o/(d.depth-1||1),px(l,function(t){var e=rx(m=(t.getLayout().x+h)*p,v=(t.depth-1)*g);t.setLayout({x:e.x,y:e.y,rawX:m,rawY:v},!0)});else{var y=t.getOrient();"RL"===y||"LR"===y?(g=o/(c.getLayout().x+f+h),p=i/(d.depth-1||1),px(l,function(t){v=(t.getLayout().x+h)*g,t.setLayout({x:m="LR"===y?(t.depth-1)*p:i-(t.depth-1)*p,y:v},!0)})):"TB"!==y&&"BT"!==y||(p=i/(c.getLayout().x+f+h),g=o/(d.depth-1||1),px(l,function(t){m=(t.getLayout().x+h)*p,t.setLayout({x:m,y:v="TB"===y?(t.depth-1)*g:o-(t.depth-1)*g},!0)}))}}}(t,e)})}),jc.extend({type:"series.treemap",layoutMode:"box",dependencies:["grid","polar"],preventUsingHoverLayer:!0,_viewRoot:null,defaultOption:{progressive:0,left:"center",top:"middle",right:null,bottom:null,width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.1024,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",borderColor:"rgba(255,255,255,0.7)",borderWidth:1,shadowColor:"rgba(150,150,150,1)",shadowBlur:3,shadowOffsetX:0,shadowOffsetY:0,textStyle:{color:"#fff"}},emphasis:{textStyle:{}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",ellipsis:!0},upperLabel:{show:!1,position:[0,"50%"],height:20,color:"#fff",ellipsis:!0,verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],color:"#fff",ellipsis:!0,verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},getInitialData:function(t,e){var n={name:t.name,children:t.data};!function t(e){var n=0;k(e.children,function(e){t(e);var r=e.value;R(r)&&(r=r[0]),n+=r});var r=e.value;R(r)&&(r=r[0]),null!=r&&!isNaN(r)||(r=n),r<0&&(r=0),R(e.value)?e.value[0]=r:e.value=r}(n);var r=t.levels||[],i=new hl({itemStyle:this.designatedVisualItemStyle={}},this,e),o=A((r=t.levels=function(t,e){var n,r=e.get("color");if(r)return k(t=t||[],function(t){var e=new hl(t),r=e.get("color");(e.get("itemStyle.color")||r&&"none"!==r)&&(n=!0)}),n||((t[0]||(t[0]={})).color=r.slice()),t}(r,e))||[],function(t){return new hl(t,i,e)},this),a=Qy.createTree(n,this,function(t){t.wrapMethod("getItemModel",function(t,e){var n=a.getNodeByDataIndex(e);return t.parentModel=o[n.depth]||i,t})});return a.data},optionUpdated:function(){this.resetViewRoot()},formatTooltip:function(t){var e=this.getData(),n=this.getRawValue(t),r=R(n)?zl(n[0]):zl(n);return jl(e.getName(t)+": "+r)},getDataParams:function(t){var e=jc.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(t);return e.treePathInfo=yx(n,this),e},setLayoutInfo:function(t){this.layoutInfo=this.layoutInfo||{},x(this.layoutInfo,t)},mapIdToIndex:function(t){var e=this._idIndexMap;e||(e=this._idIndexMap=Q(),this._idIndexMapCount=0);var n=e.get(t);return null==n&&e.set(t,n=this._idIndexMapCount++),n},getViewRoot:function(){return this._viewRoot},resetViewRoot:function(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this._viewRoot=e)}}),xx.prototype={constructor:xx,render:function(t,e,n,r){var i=t.getModel("breadcrumb"),o=this.group;if(o.removeAll(),i.get("show")&&n){var a=i.getModel("itemStyle"),s=a.getModel("textStyle"),l={pos:{left:i.get("left"),right:i.get("right"),top:i.get("top"),bottom:i.get("bottom")},box:{width:e.getWidth(),height:e.getHeight()},emptyItemWidth:i.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(n,l,s),this._renderContent(t,l,a,s,r),su(o,l.pos,l.box)}},_prepare:function(t,e,n){for(var r=t;r;r=r.parentNode){var i=r.getModel().get("name"),o=n.getTextRect(i),a=Math.max(o.width+16,e.emptyItemWidth);e.totalWidth+=a+8,e.renderList.push({node:r,text:i,width:a})}},_renderContent:function(t,e,n,r,i){for(var o,a,s=0,l=e.emptyItemWidth,u=t.get("breadcrumb.height"),c=function(t,e,n){var r=e.width,i=e.height,o=bl(t.x,r),a=bl(t.y,i),s=bl(t.x2,r),l=bl(t.y2,i);return(isNaN(o)||isNaN(parseFloat(t.x)))&&(o=0),(isNaN(s)||isNaN(parseFloat(t.x2)))&&(s=r),(isNaN(a)||isNaN(parseFloat(t.y)))&&(a=0),(isNaN(l)||isNaN(parseFloat(t.y2)))&&(l=i),n=Fl(n||0),{width:Math.max(s-o-n[1]-n[3],0),height:Math.max(l-a-n[0]-n[2],0)}}(e.pos,e.box),d=e.totalWidth,f=e.renderList,h=f.length-1;0<=h;h--){var p=f[h],g=p.node,m=p.width,v=p.text;d>c.width&&(d-=m-l,m=l,v=null);var y=new za({shape:{points:bx(s,0,m,u,h===f.length-1,0===h)},style:b(n.getItemStyle(),{lineJoin:"bevel",text:v,textFill:r.getTextColor(),textFont:r.getFont()}),z:10,onclick:E(i,g)});this.group.add(y),y.eventData={componentType:"series",componentSubType:"treemap",componentIndex:(o=t).componentIndex,seriesIndex:o.componentIndex,seriesName:o.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:(a=g)&&a.dataIndex,name:a&&a.name},treePathInfo:a&&yx(a,o)},s+=m+8}},remove:function(){this.group.removeAll()}};var Sx=P,Cx=Cn,Mx=Ua,Tx=k,kx=["label"],Ax=["emphasis","label"],Ix=["upperLabel"],Dx=["emphasis","upperLabel"],Ox=Zi([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]);function Px(t,e,n,r,i,o,a,s,l,u){if(a){var c=a.getLayout(),d=t.getData();if(d.setItemGraphicEl(a.dataIndex,null),c&&c.isInView){var f=c.width,h=c.height,p=c.borderWidth,g=c.invisible,v=a.getRawIndex(),y=s&&s.getRawIndex(),b=a.viewChildren,_=c.upperHeight,w=b&&b.length,S=a.getModel("itemStyle"),C=a.getModel("emphasis.itemStyle"),M=P("nodeGroup",Cx);if(M){if(l.add(M),M.attr("position",[c.x||0,c.y||0]),M.__tmNodeWidth=f,M.__tmNodeHeight=h,c.isAboveViewRoot)return M;var T=a.getModel(),k=P("background",Mx,u,1);if(k&&function(e,n,r){if(n.dataIndex=a.dataIndex,n.seriesIndex=t.seriesIndex,n.setShape({x:0,y:0,width:f,height:h}),g)I(n);else{n.invisible=!1;var i=a.getVisual("borderColor",!0),o=C.get("borderColor"),s=_x(S);s.fill=i;var l=Ox(C);if(l.fill=o,r){var u=f-2*p;D(s,l,i,u,_,{x:p,y:0,width:u,height:_})}else s.text=l.text=null;n.setStyle(s),Is(n,l)}e.add(n)}(M,k,w&&c.upperLabelHeight),w)Bs(M)&&Ns(M,!1),k&&(Ns(k,!0),d.setItemGraphicEl(a.dataIndex,k));else{var A=P("content",Mx,u,2);A&&function(e,n){n.dataIndex=a.dataIndex,n.seriesIndex=t.seriesIndex;var r=Math.max(f-2*p,0),i=Math.max(h-2*p,0);if(n.culling=!0,n.setShape({x:p,y:p,width:r,height:i}),g)I(n);else{n.invisible=!1;var o=a.getVisual("color",!0),s=_x(S);s.fill=o;var l=Ox(C);D(s,l,o,r,i),n.setStyle(s),Is(n,l)}e.add(n)}(M,A),k&&Bs(k)&&Ns(k,!1),Ns(M,!0),d.setItemGraphicEl(a.dataIndex,M)}return M}}}function I(t){t.invisible||o.push(t)}function D(e,n,r,i,o,s){var l=T.get("name"),u=T.getModel(s?Ix:kx),d=T.getModel(s?Dx:Ax),f=u.getShallow("show");Vs(e,n,u,d,{defaultText:f?l:null,autoColor:r,isRectText:!0,labelFetcher:t,labelDataIndex:a.dataIndex,labelProp:s?"upperLabel":"label"}),O(e,s,c),O(n,s,c),s&&(e.textRect=m(s)),e.truncate=f&&u.get("ellipsis")?{outerWidth:i,outerHeight:o,minChar:2}:null}function O(e,n,r){var i=e.text;if(!n&&r.isLeafRoot&&null!=i){var o=t.get("drillDownIcon",!0);e.text=o?o+" "+i:i}}function P(t,o,s,l){var u=null!=y&&n[t][y],c=i[t];return u?(n[t][y]=null,function(t,e,n){(t[v]={}).old="nodeGroup"===n?e.position.slice():x({},e.shape)}(c,u,t)):g||((u=new o({z:function(t,e){var n=10*t+e;return(n-1)/n}(s,l)})).__tmDepth=s,function(t,e,n){var o=t[v]={},s=a.parentNode;if(s&&(!r||"drillDown"===r.direction)){var l=0,u=0,c=i.background[s.getRawIndex()];!r&&c&&c.old&&(l=c.old.width,u=c.old.height),o.old="nodeGroup"===n?[0,u]:{x:l,y:u,width:0,height:0}}o.fadein="nodeGroup"!==n}(c,0,u.__tmStorageName=t)),e[t][v]=u}}ch({type:"treemap",init:function(t,e){this._storage={nodeGroup:[],background:[],content:[]},this._state="ready"},render:function(t,e,n,r){if(!(S(e.findComponents({mainType:"series",subType:"treemap",query:r}),t)<0)){this.seriesModel=t,this.api=n,this.ecModel=e;var i=gx(r,["treemapZoomToNode","treemapRootToNode"],t),o=r&&r.type,a=t.layoutInfo,s=!this._oldTree,l=this._storage,u="treemapRootToNode"===o&&i&&l?{rootNodeGroup:l.nodeGroup[i.node.getRawIndex()],direction:r.direction}:null,c=this._giveContainerGroup(a),d=this._doRender(c,t,u);s||o&&"treemapZoomToNode"!==o&&"treemapRootToNode"!==o?d.renderFinally():this._doAnimation(c,d,t,u),this._resetController(n),this._renderBreadcrumb(t,n,i)}},_giveContainerGroup:function(t){var e=this._containerGroup;return e||(e=this._containerGroup=new Cx,this._initEvents(e),this.group.add(e)),e.attr("position",[t.x,t.y]),e},_doRender:function(t,e,n){var r=e.getData().tree,i=this._oldTree,o={nodeGroup:[],background:[],content:[]},a={nodeGroup:[],background:[],content:[]},s=this._storage,l=[],u=E(Px,e,a,s,n,o,l);!function t(e,n,r,i,o){function a(t){return t.getId()}function s(a,s){var l=null!=a?e[a]:null,c=null!=s?n[s]:null,d=u(l,c,r,o);d&&t(l&&l.viewChildren||[],c&&c.viewChildren||[],d,i,o+1)}i?Tx(n=e,function(t,e){t.isRemoved()||s(e,e)}):new fh(n,e,a,a).add(s).update(s).remove(E(s,null)).execute()}(r.root?[r.root]:[],i&&i.root?[i.root]:[],t,r===i||!i,0);var c,d,f=(d={nodeGroup:[],background:[],content:[]},(c=s)&&Tx(c,function(t,e){var n=d[e];Tx(t,function(t){t&&(n.push(t),t.__tmWillDelete=1)})}),d);return this._oldTree=r,this._storage=a,{lastsForAnimation:o,willDeleteEls:f,renderFinally:function(){Tx(f,function(t){Tx(t,function(t){t.parent&&t.parent.remove(t)})}),Tx(l,function(t){t.invisible=!0,t.dirty()})}}},_doAnimation:function(t,e,n,r){if(n.get("animation")){var i=n.get("animationDurationUpdate"),o=n.get("animationEasing"),a=function(){var t,e=[],n={};return{add:function(t,r,i,o,a){return N(o)&&(a=o,o=0),!n[t.id]&&(n[t.id]=1,e.push({el:t,target:r,time:i,delay:o,easing:a}),!0)},done:function(e){return t=e,this},start:function(){for(var r=e.length,i=0,o=e.length;i<o;i++){var a=e[i];a.el.animateTo(a.target,a.time,a.delay,a.easing,s)}return this;function s(){--r||(e.length=0,n={},t&&t())}}}}();Tx(e.willDeleteEls,function(t,e){Tx(t,function(t,n){if(!t.invisible){var s,l=t.parent;if(r&&"drillDown"===r.direction)s=l===r.rootNodeGroup?{shape:{x:0,y:0,width:l.__tmNodeWidth,height:l.__tmNodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var u=0,c=0;l.__tmWillDelete||(u=l.__tmNodeWidth/2,c=l.__tmNodeHeight/2),s="nodeGroup"===e?{position:[u,c],style:{opacity:0}}:{shape:{x:u,y:c,width:0,height:0},style:{opacity:0}}}s&&a.add(t,s,i,o)}})}),Tx(this._storage,function(t,n){Tx(t,function(t,r){var s=e.lastsForAnimation[n][r],l={};s&&("nodeGroup"===n?s.old&&(l.position=t.position.slice(),t.attr("position",s.old)):(s.old&&(l.shape=x({},t.shape),t.setShape(s.old)),s.fadein?(t.setStyle("opacity",0),l.style={opacity:1}):1!==t.style.opacity&&(l.style={opacity:1})),a.add(t,l,i,o))})},this),this._state="animating",a.done(Sx(function(){this._state="ready",e.renderFinally()},this)).start()}},_resetController:function(t){var e=this._controller;e||((e=this._controller=new fy(t.getZr())).enable(this.seriesModel.get("roam")),e.on("pan",Sx(this._onPan,this)),e.on("zoom",Sx(this._onZoom,this)));var n=new Sn(0,0,t.getWidth(),t.getHeight());e.setPointerChecker(function(t,e,r){return n.contain(e,r)})},_clearController:function(){var t=this._controller;t&&(t.dispose(),t=null)},_onPan:function(t){if("animating"!==this._state&&(3<Math.abs(t.dx)||3<Math.abs(t.dy))){var e=this.seriesModel.getData().tree.root;if(!e)return;var n=e.getLayout();if(!n)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:n.x+t.dx,y:n.y+t.dy,width:n.width,height:n.height}})}},_onZoom:function(t){var e=t.originX,n=t.originY;if("animating"!==this._state){var r=this.seriesModel.getData().tree.root;if(!r)return;var i=r.getLayout();if(!i)return;var o=new Sn(i.x,i.y,i.width,i.height),a=this.seriesModel.layoutInfo;e-=a.x,n-=a.y;var s=re();se(s,s,[-e,-n]),ue(s,s,[t.scale,t.scale]),se(s,s,[e,n]),o.applyTransform(s),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:o.x,y:o.y,width:o.width,height:o.height}})}},_initEvents:function(t){t.on("click",function(t){if("ready"===this._state){var e=this.seriesModel.get("nodeClick",!0);if(e){var n=this.findTarget(t.offsetX,t.offsetY);if(n){var r=n.node;if(r.getLayout().isLeafRoot)this._rootToNode(n);else if("zoomToNode"===e)this._zoomToNode(n);else if("link"===e){var i=r.hostTree.data.getItemModel(r.dataIndex),o=i.get("link",!0),a=i.get("target",!0)||"blank";o&&Ql(o,a)}}}}},this)},_renderBreadcrumb:function(t,e,n){n=n||(n=null!=t.get("leafDepth",!0)?{node:t.getViewRoot()}:this.findTarget(e.getWidth()/2,e.getHeight()/2))||{node:t.getData().tree.root},(this._breadcrumb||(this._breadcrumb=new xx(this.group))).render(t,e,n.node,Sx(function(e){"animating"!==this._state&&(vx(t.getViewRoot(),e)?this._rootToNode({node:e}):this._zoomToNode({node:e}))},this))},remove:function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage={nodeGroup:[],background:[],content:[]},this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},dispose:function(){this._clearController()},_zoomToNode:function(t){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node})},_rootToNode:function(t){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node})},findTarget:function(t,e){var n;return this.seriesModel.getViewRoot().eachNode({attr:"viewChildren",order:"preorder"},function(r){var i=this._storage.background[r.getRawIndex()];if(i){var o=i.transformCoordToLocal(t,e),a=i.shape;if(!(a.x<=o[0]&&o[0]<=a.x+a.width&&a.y<=o[1]&&o[1]<=a.y+a.height))return!1;n={node:r,offsetX:o[0],offsetY:o[1]}}},this),n}});for(var Ex=function(){},Rx=["treemapZoomToNode","treemapRender","treemapMove"],Lx=0;Lx<Rx.length;Lx++)eh({type:Rx[Lx],update:"updateView"},Ex);eh({type:"treemapRootToNode",update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"treemap",query:t},function(e,n){var r=gx(t,["treemapZoomToNode","treemapRootToNode"],e);if(r){var i=e.getViewRoot();i&&(t.direction=vx(i,r.node)?"rollUp":"drillDown"),e.resetViewRoot(r.node)}})});var Nx=k,Bx=B,zx=function(t){var e=t.mappingMethod,n=t.type,r=this.option=m(t);this.type=n,this.mappingMethod=e,this._normalizeData=$x[e];var i=Vx[n];this.applyVisual=i.applyVisual,this.getColorMapper=i.getColorMapper,this._doMap=i._doMap[e],"piecewise"===e?(Fx(r),function(t){var e=t.pieceList;t.hasSpecialVisual=!1,k(e,function(e,n){e.originIndex=n,null!=e.visual&&(t.hasSpecialVisual=!0)})}(r)):"category"===e?r.categories?function(t){var e=t.categories,n=t.visual,r=t.categoryMap={};if(Nx(e,function(t,e){r[t]=e}),!R(n)){var i=[];B(n)?Nx(n,function(t,e){var n=r[e];i[null!=n?n:-1]=t}):i[-1]=n,n=Yx(t,i)}for(var o=e.length-1;0<=o;o--)null==n[o]&&(delete r[e[o]],e.pop())}(r):Fx(r,!0):(X("linear"!==e||r.dataExtent),Fx(r))};zx.prototype={constructor:zx,mapValueToVisual:function(t){var e=this._normalizeData(t);return this._doMap(e,t)},getNormalizer:function(){return P(this._normalizeData,this)}};var Vx=zx.visualHandlers={color:{applyVisual:jx("color"),getColorMapper:function(){var t=this.option;return P("category"===t.mappingMethod?function(t,e){return e||(t=this._normalizeData(t)),Gx.call(this,t)}:function(e,n,r){var i=!!r;return n||(e=this._normalizeData(e)),r=je(e,t.parsedVisual,r),i?r:Xe(r,"rgba")},this)},_doMap:{linear:function(t){return Xe(je(t,this.option.parsedVisual),"rgba")},category:Gx,piecewise:function(t,e){var n=Xx.call(this,e);return null==n&&(n=Xe(je(t,this.option.parsedVisual),"rgba")),n},fixed:Ux}},colorHue:Hx(function(t,e){return Ue(t,e)}),colorSaturation:Hx(function(t,e){return Ue(t,null,e)}),colorLightness:Hx(function(t,e){return Ue(t,null,null,e)}),colorAlpha:Hx(function(t,e){return qe(t,e)}),opacity:{applyVisual:jx("opacity"),_doMap:qx([0,1])},liftZ:{applyVisual:jx("liftZ"),_doMap:{linear:Ux,category:Ux,piecewise:Ux,fixed:Ux}},symbol:{applyVisual:function(t,e,n){var r=this.mapValueToVisual(t);if(N(r))n("symbol",r);else if(Bx(r))for(var i in r)r.hasOwnProperty(i)&&n(i,r[i])},_doMap:{linear:Wx,category:Gx,piecewise:function(t,e){var n=Xx.call(this,e);return null==n&&(n=Wx.call(this,t)),n},fixed:Ux}},symbolSize:{applyVisual:jx("symbolSize"),_doMap:qx([0,1])}};function Fx(t,e){var n=t.visual,r=[];B(n)?Nx(n,function(t){r.push(t)}):null!=n&&r.push(n),e||1!==r.length||{color:1,symbol:1}.hasOwnProperty(t.type)||(r[1]=r[0]),Yx(t,r)}function Hx(t){return{applyVisual:function(e,n,r){e=this.mapValueToVisual(e),r("color",t(n("color"),e))},_doMap:qx([0,1])}}function Wx(t){var e=this.option.visual;return e[Math.round(xl(t,[0,1],[0,e.length-1],!0))]||{}}function jx(t){return function(e,n,r){r(t,this.mapValueToVisual(e))}}function Gx(t){var e=this.option.visual;return e[this.option.loop&&-1!==t?t%e.length:t]}function Ux(){return this.option.visual[0]}function qx(t){return{linear:function(e){return xl(e,t,this.option.visual,!0)},category:Gx,piecewise:function(e,n){var r=Xx.call(this,n);return null==r&&(r=xl(e,t,this.option.visual,!0)),r},fixed:Ux}}function Xx(t){var e=this.option,n=e.pieceList;if(e.hasSpecialVisual){var r=n[zx.findPieceIndex(t,n)];if(r&&r.visual)return r.visual[this.type]}}function Yx(t,e){return t.visual=e,"color"===t.type&&(t.parsedVisual=A(e,function(t){return Ve(t)})),e}var $x={linear:function(t){return xl(t,this.option.dataExtent,[0,1],!0)},piecewise:function(t){var e=this.option.pieceList,n=zx.findPieceIndex(t,e,!0);if(null!=n)return xl(n,[0,e.length-1],[0,1],!0)},category:function(t){var e=this.option.categories?this.option.categoryMap[t]:t;return null==e?-1:e},fixed:et};function Zx(t,e,n){return t?e<=n:e<n}zx.listVisualTypes=function(){var t=[];return k(Vx,function(e,n){t.push(n)}),t},zx.addVisualHandler=function(t,e){Vx[t]=e},zx.isValidType=function(t){return Vx.hasOwnProperty(t)},zx.eachVisual=function(t,e,n){B(t)?k(t,e,n):e.call(n,t)},zx.mapVisual=function(t,e,n){var r,i=R(t)?[]:B(t)?{}:(r=!0,null);return zx.eachVisual(t,function(t,o){var a=e.call(n,t,o);r?i=a:i[o]=a}),i},zx.retrieveVisuals=function(t){var e,n={};return t&&Nx(Vx,function(r,i){t.hasOwnProperty(i)&&(n[i]=t[i],e=!0)}),e?n:null},zx.prepareVisualTypes=function(t){if(Bx(t)){var e=[];Nx(t,function(t,n){e.push(n)}),t=e}else{if(!R(t))return[];t=t.slice()}return t.sort(function(t,e){return"color"===e&&"color"!==t&&0===t.indexOf("color")?1:-1}),t},zx.dependsOn=function(t,e){return"color"===e?!(!t||0!==t.indexOf(e)):t===e},zx.findPieceIndex=function(t,e,n){for(var r,i=1/0,o=0,a=e.length;o<a;o++){var s=e[o].value;if(null!=s){if(s===t||"string"==typeof s&&s===t+"")return o;n&&d(s,o)}}for(o=0,a=e.length;o<a;o++){var l=e[o],u=l.interval,c=l.close;if(u){if(u[0]===-1/0){if(Zx(c[1],t,u[1]))return o}else if(u[1]===1/0){if(Zx(c[0],u[0],t))return o}else if(Zx(c[0],u[0],t)&&Zx(c[1],t,u[1]))return o;n&&d(u[0],o),n&&d(u[1],o)}}if(n)return t===1/0?e.length-1:t===-1/0?0:r;function d(e,n){var o=Math.abs(e-t);o<i&&(i=o,r=n)}};var Kx=R,Jx={seriesType:"treemap",reset:function(t,e,n,r){var i=t.getData().tree.root;i.isRemoved()||function t(e,n,r,i){var o=e.getModel(),a=e.getLayout();if(a&&!a.invisible&&a.isInView){var s,l,u=e.getModel("itemStyle"),c=function(t,e,n){var r=x({},e),i=n.designatedVisualItemStyle;return k(["color","colorAlpha","colorSaturation"],function(n){i[n]=e[n];var o=t.get(n);(i[n]=null)!=o&&(r[n]=o)}),r}(u,n,i),d=u.get("borderColor"),f=u.get("borderColorSaturation");null!=f&&(d=null!=(l=s=Qx(c))?Ue(l,null,null,f):null),e.setVisual("borderColor",d);var h=e.viewChildren;if(h&&h.length){var p=function(t,e,n,r,i,o){if(o&&o.length){var a=eb(e,"color")||null!=i.color&&"none"!==i.color&&(eb(e,"colorAlpha")||eb(e,"colorSaturation"));if(a){var s=e.get("visualMin"),l=e.get("visualMax"),u=n.dataExtent.slice();null!=s&&s<u[0]&&(u[0]=s),null!=l&&l>u[1]&&(u[1]=l);var c=e.get("colorMappingBy"),d={type:a.name,dataExtent:u,visual:a.range};"color"!==d.type||"index"!==c&&"id"!==c?d.mappingMethod="linear":(d.mappingMethod="category",d.loop=!0);var f=new zx(d);return f.__drColorMappingBy=c,f}}}(0,o,a,0,c,h);k(h,function(e,n){if(e.depth>=r.length||e===r[e.depth]){var a=function(t,e,n,r,i,o){var a=x({},e);if(i){var s=i.type,l="color"===s&&i.__drColorMappingBy,u="index"===l?r:"id"===l?o.mapIdToIndex(n.getId()):n.getValue(t.get("visualDimension"));a[s]=i.mapValueToVisual(u)}return a}(o,c,e,n,p,i);t(e,a,r,i)}})}else s=Qx(c),e.setVisual("color",s)}}(i,{},t.getViewRoot().getAncestors(),t)}};function Qx(t){var e=tb(t,"color");if(e){var n=tb(t,"colorAlpha"),r=tb(t,"colorSaturation");return r&&(e=Ue(e,null,null,r)),n&&(e=qe(e,n)),e}}function tb(t,e){var n=t[e];if(null!=n&&"none"!==n)return n}function eb(t,e){var n=t.get(e);return Kx(n)&&n.length?{name:e,range:n}:null}var nb=Math.max,rb=Math.min,ib=W,ob=k,ab=["itemStyle","borderWidth"],sb=["itemStyle","gapWidth"],lb=["upperLabel","show"],ub=["upperLabel","height"],cb={seriesType:"treemap",reset:function(t,e,n,r){var i=n.getWidth(),o=n.getHeight(),a=t.option,s=au(t.getBoxLayoutParams(),{width:n.getWidth(),height:n.getHeight()}),l=a.size||[],u=bl(ib(s.width,l[0]),i),c=bl(ib(s.height,l[1]),o),d=r&&r.type,f=gx(r,["treemapZoomToNode","treemapRootToNode"],t),h="treemapRender"===d||"treemapMove"===d?r.rootRect:null,p=t.getViewRoot(),g=mx(p);if("treemapMove"!==d){var m="treemapZoomToNode"===d?function(t,e,n,r,i){var o,a=(e||{}).node,s=[r,i];if(!a||a===n)return s;for(var l=r*i,u=l*t.option.zoomToNodeRatio;o=a.parentNode;){for(var c=0,d=o.children,f=0,h=d.length;f<h;f++)c+=d[f].getValue();var p=a.getValue();if(0===p)return s;u*=c/p;var g=o.getModel(),m=g.get(ab);u+=4*m*m+(3*m+Math.max(m,pb(g)))*Math.pow(u,.5),kl<u&&(u=kl),a=o}u<l&&(u=l);var v=Math.pow(u/l,.5);return[r*v,i*v]}(t,f,p,u,c):h?[h.width,h.height]:[u,c],v=a.sort;v&&"asc"!==v&&"desc"!==v&&(v="desc");var y={squareRatio:a.squareRatio,sort:v,leafDepth:a.leafDepth};p.hostTree.clearLayouts();var b={x:0,y:0,width:m[0],height:m[1],area:m[0]*m[1]};p.setLayout(b),function t(e,n,r,i){var o,a;if(!e.isRemoved()){var s=e.getLayout();o=s.width,a=s.height;var l=(p=e.getModel()).get(ab),u=p.get(sb)/2,c=pb(p),d=Math.max(l,c),f=l-u,h=d-u,p=e.getModel();e.setLayout({borderWidth:l,upperHeight:d,upperLabelHeight:c},!0);var g=(o=nb(o-2*f,0))*(a=nb(a-f-h,0)),m=db(e,p,g,n,r,i);if(m.length){var v={x:f,y:h,width:o,height:a},y=rb(o,a),x=1/0,b=[];b.area=0;for(var _=0,w=m.length;_<w;){var S=m[_];b.push(S),b.area+=S.getLayout().area;var C=fb(b,y,n.squareRatio);x=C<=x?(_++,C):(b.area-=b.pop().getLayout().area,hb(b,y,v,u,!1),y=rb(v.width,v.height),b.length=b.area=0,1/0)}if(b.length&&hb(b,y,v,u,!0),!r){var M=p.get("childrenVisibleMin");null!=M&&g<M&&(r=!0)}for(_=0,w=m.length;_<w;_++)t(m[_],n,r,i+1)}}}(p,y,!1,0),b=p.getLayout(),ob(g,function(t,e){var n=(g[e+1]||p).getValue();t.setLayout(x({dataExtent:[n,n],borderWidth:0,upperHeight:0},b))})}var _=t.getData().tree.root;_.setLayout(function(t,e,n){if(e)return{x:e.x,y:e.y};var r={x:0,y:0};if(!n)return r;var i=n.node,o=i.getLayout();if(!o)return r;for(var a=[o.width/2,o.height/2],s=i;s;){var l=s.getLayout();a[0]+=l.x,a[1]+=l.y,s=s.parentNode}return{x:t.width/2-a[0],y:t.height/2-a[1]}}(s,h,f),!0),t.setLayoutInfo(s),function t(e,n,r,i,o){var a=e.getLayout(),s=r[o],l=s&&s===e;if(!(s&&!l||o===r.length&&e!==i)){e.setLayout({isInView:!0,invisible:!l&&!n.intersect(a),isAboveViewRoot:l},!0);var u=new Sn(n.x-a.x,n.y-a.y,n.width,n.height);ob(e.viewChildren||[],function(e){t(e,u,r,i,o+1)})}}(_,new Sn(-s.x,-s.y,i,o),g,p,0)}};function db(t,e,n,r,i,o){var a=t.children||[],s=r.sort;"asc"!==s&&"desc"!==s&&(s=null);var l=null!=r.leafDepth&&r.leafDepth<=o;if(i&&!l)return t.viewChildren=[];!function(t,e){e&&t.sort(function(t,n){var r="asc"===e?t.getValue()-n.getValue():n.getValue()-t.getValue();return 0==r?"asc"===e?t.dataIndex-n.dataIndex:n.dataIndex-t.dataIndex:r})}(a=D(a,function(t){return!t.isRemoved()}),s);var u=function(t,e,n){for(var r=0,i=0,o=e.length;i<o;i++)r+=e[i].getValue();var a=t.get("visualDimension");if(e&&e.length)if("value"===a&&n)s=[e[e.length-1].getValue(),e[0].getValue()],"asc"===n&&s.reverse();else{var s=[1/0,-1/0];ob(e,function(t){var e=t.getValue(a);e<s[0]&&(s[0]=e),e>s[1]&&(s[1]=e)})}else s=[NaN,NaN];return{sum:r,dataExtent:s}}(e,a,s);if(0===u.sum)return t.viewChildren=[];if(u.sum=function(t,e,n,r,i){if(!r)return n;for(var o=t.get("visibleMin"),a=i.length,s=a,l=a-1;0<=l;l--){var u=i["asc"===r?a-l-1:l].getValue();u/n*e<o&&(s=l,n-=u)}return i.splice("asc"===r?0:s,a-s),n}(e,n,u.sum,s,a),0===u.sum)return t.viewChildren=[];for(var c=0,d=a.length;c<d;c++){var f=a[c].getValue()/u.sum*n;a[c].setLayout({area:f})}return l&&(a.length&&t.setLayout({isLeafRoot:!0},!0),a.length=0),t.viewChildren=a,t.setLayout({dataExtent:u.dataExtent},!0),a}function fb(t,e,n){for(var r,i=0,o=1/0,a=0,s=t.length;a<s;a++)(r=t[a].getLayout().area)&&(r<o&&(o=r),i<r&&(i=r));var l=t.area*t.area,u=e*e*n;return l?nb(u*i/l,l/(u*o)):1/0}function hb(t,e,n,r,i){var o=e===n.width?0:1,a=1-o,s=["x","y"],l=["width","height"],u=n[s[o]],c=e?t.area/e:0;(i||c>n[l[a]])&&(c=n[l[a]]);for(var d=0,f=t.length;d<f;d++){var h=t[d],p={},g=c?h.getLayout().area/c:0,m=p[l[a]]=nb(c-2*r,0),v=n[s[o]]+n[l[o]]-u,y=d===f-1||v<g?v:g,x=p[l[o]]=nb(y-2*r,0);p[s[a]]=n[s[a]]+rb(r,m/2),p[s[o]]=u+rb(r,x/2),u+=y,h.setLayout(p,!0)}n[s[a]]+=c,n[l[a]]-=c}function pb(t){return t.get(lb)?t.get(ub):0}function gb(t){return"_EC_"+t}function mb(t){this._directed=t||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={}}ih(Jx),rh(cb);var vb=mb.prototype;function yb(t,e){this.id=null==t?"":t,this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=null==e?-1:e}function xb(t,e,n){this.node1=t,this.node2=e,this.dataIndex=null==n?-1:n}function bb(t,e){return{getValue:function(n){var r=this[t][e];return r.get(r.getDimension(n||"value"),this.dataIndex)},setVisual:function(n,r){0<=this.dataIndex&&this[t][e].setItemVisual(this.dataIndex,n,r)},getVisual:function(n,r){return this[t][e].getItemVisual(this.dataIndex,n,r)},setLayout:function(n,r){0<=this.dataIndex&&this[t][e].setItemLayout(this.dataIndex,n,r)},getLayout:function(){return this[t][e].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[t][e].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[t][e].getRawIndex(this.dataIndex)}}}function _b(t,e,n,r,i){for(var o=new mb(r),a=0;a<t.length;a++)o.addNode(W(t[a].id,t[a].name,a),a);var s=[],l=[],u=0;for(a=0;a<e.length;a++){var c=e[a],d=c.source,f=c.target;o.addEdge(d,f,u)&&(l.push(c),s.push(W(c.id,d+" > "+f)),u++)}var h,p=n.get("coordinateSystem");if("cartesian2d"===p||"polar"===p)h=$h(t,n);else{var g=Uu.get(p),m=g&&"view"!==g.type&&g.dimensions||[];S(m,"value")<0&&m.concat(["value"]);var v=Wh(t,{coordDimensions:m});(h=new Ah(v,n)).initData(t)}var y=new Ah(["value"],n);return y.initData(l,s),i&&i(h,y),Uy({mainData:h,struct:o,structAttr:"graph",datas:{node:h,edge:y},datasAttr:{node:"data",edge:"edgeData"}}),o.update(),o}vb.type="graph",vb.isDirected=function(){return this._directed},vb.addNode=function(t,e){var n=this._nodesMap;if(!n[gb(t=null==t?""+e:""+t)]){var r=new yb(t,e);return(r.hostGraph=this).nodes.push(r),n[gb(t)]=r}},vb.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e]},vb.getNodeById=function(t){return this._nodesMap[gb(t)]},vb.addEdge=function(t,e,n){var r=this._nodesMap,i=this._edgesMap;if("number"==typeof t&&(t=this.nodes[t]),"number"==typeof e&&(e=this.nodes[e]),yb.isInstance(t)||(t=r[gb(t)]),yb.isInstance(e)||(e=r[gb(e)]),t&&e){var o=t.id+"-"+e.id,a=new xb(t,e,n);return(a.hostGraph=this)._directed&&(t.outEdges.push(a),e.inEdges.push(a)),t.edges.push(a),t!==e&&e.edges.push(a),this.edges.push(a),i[o]=a}},vb.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e]},vb.getEdge=function(t,e){yb.isInstance(t)&&(t=t.id),yb.isInstance(e)&&(e=e.id);var n=this._edgesMap;return this._directed?n[t+"-"+e]:n[t+"-"+e]||n[e+"-"+t]},vb.eachNode=function(t,e){for(var n=this.nodes,r=n.length,i=0;i<r;i++)0<=n[i].dataIndex&&t.call(e,n[i],i)},vb.eachEdge=function(t,e){for(var n=this.edges,r=n.length,i=0;i<r;i++)0<=n[i].dataIndex&&0<=n[i].node1.dataIndex&&0<=n[i].node2.dataIndex&&t.call(e,n[i],i)},vb.breadthFirstTraverse=function(t,e,n,r){if(yb.isInstance(e)||(e=this._nodesMap[gb(e)]),e){for(var i="out"===n?"outEdges":"in"===n?"inEdges":"edges",o=0;o<this.nodes.length;o++)this.nodes[o].__visited=!1;if(!t.call(r,e,null))for(var a=[e];a.length;){var s=a.shift(),l=s[i];for(o=0;o<l.length;o++){var u=l[o],c=u.node1===s?u.node2:u.node1;if(!c.__visited){if(t.call(r,c,s))return;a.push(c),c.__visited=!0}}}}},vb.update=function(){for(var t=this.data,e=this.edgeData,n=this.nodes,r=this.edges,i=0,o=n.length;i<o;i++)n[i].dataIndex=-1;for(i=0,o=t.count();i<o;i++)n[t.getRawIndex(i)].dataIndex=i;for(e.filterSelf(function(t){var n=r[e.getRawIndex(t)];return 0<=n.node1.dataIndex&&0<=n.node2.dataIndex}),i=0,o=r.length;i<o;i++)r[i].dataIndex=-1;for(i=0,o=e.count();i<o;i++)r[e.getRawIndex(i)].dataIndex=i},vb.clone=function(){for(var t=new mb(this._directed),e=this.nodes,n=this.edges,r=0;r<e.length;r++)t.addNode(e[r].id,e[r].dataIndex);for(r=0;r<n.length;r++){var i=n[r];t.addEdge(i.node1.id,i.node2.id,i.dataIndex)}return t},yb.prototype={constructor:yb,degree:function(){return this.edges.length},inDegree:function(){return this.inEdges.length},outDegree:function(){return this.outEdges.length},getModel:function(t){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(t)}},xb.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(t)},M(yb,bb("hostGraph","data")),M(xb,bb("hostGraph","edgeData")),mb.Node=yb,mb.Edge=xb,qi(yb),qi(xb);var wb="--\x3e",Sb=function(t){return t.get("autoCurveness")||null},Cb=function(t,e){var n=Sb(t),r=20,i=[];if("number"==typeof n)r=n;else if(R(n))return void(t.__curvenessList=n);r<e&&(r=e);var o=r%2?r+2:r+3;i=[];for(var a=0;a<o;a++)i.push((a%2?a+1:a)/10*(a%2?-1:1));t.__curvenessList=i},Mb=function(t,e,n){var r=[t.id,t.dataIndex].join("."),i=[e.id,e.dataIndex].join(".");return[n.uid,r,i].join(wb)},Tb=function(t){var e=t.split(wb);return[e[0],e[2],e[1]].join(wb)},kb=function(t,e){var n=e.__edgeMap;return n[t]?n[t].length:0};function Ab(t,e,n,r){var i=Sb(e),o=R(i);if(!i)return null;var a=function(t,e){var n=Mb(t.node1,t.node2,e);return e.__edgeMap[n]}(t,e);if(!a)return null;for(var s=-1,l=0;l<a.length;l++)if(a[l]===n){s=l;break}var u=function(t,e){return kb(Mb(t.node1,t.node2,e),e)+kb(Mb(t.node2,t.node1,e),e)}(t,e);Cb(e,u),t.lineStyle=t.lineStyle||{};var c=Mb(t.node1,t.node2,e),d=e.__curvenessList,f=o||u%2?0:1;if(a.isForward)return d[f+s];var h=Tb(c),p=kb(h,e),g=d[s+p+f];return r?o?i&&0===i[0]?(p+f)%2?g:-g:((p%2?0:1)+f)%2?g:-g:(p+f)%2?g:-g:d[s+p+f]}var Ib=uh({type:"series.graph",init:function(t){Ib.superApply(this,"init",arguments);var e=this;function n(){return e._categoriesData}this.legendVisualProvider=new Sv(n,n),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData()},mergeOption:function(t){Ib.superApply(this,"mergeOption",arguments),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData()},mergeDefaultAndTheme:function(t){Ib.superApply(this,"mergeDefaultAndTheme",arguments),ki(t,["edgeLabel"],["show"])},getInitialData:function(t,e){var n=t.edges||t.links||[],r=t.data||t.nodes||[],i=this;if(r&&n){!function(t){Sb(t)&&(t.__curvenessList=[],t.__edgeMap={},Cb(t))}(this);var o=_b(r,n,this,!0,function(t,n){t.wrapMethod("getItemModel",function(t){var e=i._categoriesModels[t.getShallow("category")];return e&&(e.parentModel=t.parentModel,t.parentModel=e),t});var r=i.getModel("edgeLabel"),o=new hl({label:r.option},r.parentModel,e),a=i.getModel("emphasis.edgeLabel"),s=new hl({emphasis:{label:a.option}},a.parentModel,e);function l(t){return(t=this.parsePath(t))&&"label"===t[0]?o:t&&"emphasis"===t[0]&&"label"===t[1]?s:this.parentModel}n.wrapMethod("getItemModel",function(t){return t.customizeGetParent(l),t})});return k(o.edges,function(t){!function(t,e,n,r){if(Sb(n)){var i=Mb(t,e,n),o=n.__edgeMap,a=o[Tb(i)];o[i]&&!a?o[i].isForward=!0:a&&o[i]&&(a.isForward=!0,o[i].isForward=!1),o[i]=o[i]||[],o[i].push(r)}}(t.node1,t.node2,this,t.dataIndex)},this),o.data}},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(t,e,n){if("edge"!==n)return Ib.superApply(this,"formatTooltip",arguments);var r=this.getData(),i=this.getDataParams(t,n),o=r.graph.getEdgeByIndex(t),a=r.getName(o.node1.dataIndex),s=r.getName(o.node2.dataIndex),l=[];return null!=a&&l.push(a),null!=s&&l.push(s),l=jl(l.join(" > ")),i.value&&(l+=" : "+jl(i.value)),l},_updateCategoriesData:function(){var t=A(this.option.categories||[],function(t){return null!=t.value?t:x({value:0},t)}),e=new Ah(["value"],this);e.initData(t),this._categoriesData=e,this._categoriesModels=e.mapArray(function(t){return e.getItemModel(t,!0)})},setZoom:function(t){this.option.zoom=t},setCenter:function(t){this.option.center=t},isAnimationEnabled:function(){return Ib.superCall(this,"isAnimationEnabled")&&!("force"===this.get("layout")&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",legendHoverLink:!0,hoverAnimation:!0,layout:null,focusNodeAdjacency:!1,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{label:{show:!0}}}}),Db=Xa.prototype,Ob=Ka.prototype;function Pb(t){return isNaN(+t.cpx1)||isNaN(+t.cpy1)}var Eb=hs({type:"ec-line",style:{stroke:"#000",fill:null},shape:{x1:0,y1:0,x2:0,y2:0,percent:1,cpx1:null,cpy1:null},buildPath:function(t,e){this[Pb(e)?"_buildPathLine":"_buildPathCurve"](t,e)},_buildPathLine:Db.buildPath,_buildPathCurve:Ob.buildPath,pointAt:function(t){return this[Pb(this.shape)?"_pointAtLine":"_pointAtCurve"](t)},_pointAtLine:Db.pointAt,_pointAtCurve:Ob.pointAt,tangentAt:function(t){var e=this.shape,n=Pb(e)?[e.x2-e.x1,e.y2-e.y1]:this._tangentAtCurve(t);return pt(n,n)},_tangentAtCurve:Ob.tangentAt}),Rb=["fromSymbol","toSymbol"];function Lb(t){return"_"+t+"Type"}function Nb(t,e,n){var r=e.getItemVisual(n,t);if(r&&"none"!==r){var i=e.getItemVisual(n,"color"),o=e.getItemVisual(n,t+"Size"),a=e.getItemVisual(n,t+"Rotate");R(o)||(o=[o,o]);var s=eg(r,-o[0]/2,-o[1]/2,o[0],o[1],i);return s.__specifiedRotation=null==a||isNaN(a)?void 0:+a*Math.PI/180||0,s.name=t,s}}function Bb(t,e){t.x1=e[0][0],t.y1=e[0][1],t.x2=e[1][0],t.y2=e[1][1],t.percent=1;var n=e[2];n?(t.cpx1=n[0],t.cpy1=n[1]):(t.cpx1=NaN,t.cpy1=NaN)}function zb(t,e,n){Cn.call(this),this._createLine(t,e,n)}var Vb=zb.prototype;function Fb(t){this._ctor=t||zb,this.group=new Cn}Vb.beforeUpdate=function(){var t=this.childOfName("fromSymbol"),e=this.childOfName("toSymbol"),n=this.childOfName("label");if(t||e||!n.ignore){for(var r=1,i=this.parent;i;)i.scale&&(r/=i.scale[0]),i=i.parent;var o=this.childOfName("line");if(this.__dirty||o.__dirty){var a,s=o.shape.percent,l=o.pointAt(0),u=o.pointAt(s),c=ct([],u,l);if(pt(c,c),t){if(t.attr("position",l),null==(a=t.__specifiedRotation)){var d=o.tangentAt(0);t.attr("rotation",Math.PI/2-Math.atan2(d[1],d[0]))}else t.attr("rotation",a);t.attr("scale",[r*s,r*s])}if(e&&(e.attr("position",u),null==(a=e.__specifiedRotation)?(d=o.tangentAt(1),e.attr("rotation",-Math.PI/2-Math.atan2(d[1],d[0]))):e.attr("rotation",a),e.attr("scale",[r*s,r*s])),!n.ignore){var f,h,p,g;n.attr("position",u);var m=n.__labelDistance,v=m[0]*r,y=m[1]*r,x=s/2,b=[(d=o.tangentAt(x))[1],-d[0]],_=o.pointAt(x);0<b[1]&&(b[0]=-b[0],b[1]=-b[1]);var w,S=d[0]<0?-1:1;if("start"!==n.__position&&"end"!==n.__position){var C=-Math.atan2(d[1],d[0]);u[0]<l[0]&&(C=Math.PI+C),n.attr("rotation",C)}switch(n.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":w=-y,p="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":w=y,p="top";break;default:w=0,p="middle"}switch(n.__position){case"end":f=[c[0]*v+u[0],c[1]*y+u[1]],h=.8<c[0]?"left":c[0]<-.8?"right":"center",p=.8<c[1]?"top":c[1]<-.8?"bottom":"middle";break;case"start":f=[-c[0]*v+l[0],-c[1]*y+l[1]],h=.8<c[0]?"right":c[0]<-.8?"left":"center",p=.8<c[1]?"bottom":c[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":f=[v*S+l[0],l[1]+w],h=d[0]<0?"right":"left",g=[-v*S,-w];break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":f=[_[0],_[1]+w],h="center",g=[0,-w];break;case"insideEndTop":case"insideEnd":case"insideEndBottom":f=[-v*S+u[0],u[1]+w],h=0<=d[0]?"right":"left",g=[v*S,-w]}n.attr({style:{textVerticalAlign:n.__verticalAlign||p,textAlign:n.__textAlign||h},position:f,scale:[r,r],origin:g})}}}},Vb._createLine=function(t,e,n){var r=t.hostModel,i=function(t){var e=new Eb({name:"line",subPixelOptimize:!0});return Bb(e.shape,t),e}(t.getItemLayout(e));i.shape.percent=0,Zs(i,{shape:{percent:1}},r,e),this.add(i);var o=new Da({name:"label",lineLabelOriginalOpacity:1});this.add(o),k(Rb,function(n){var r=Nb(n,t,e);this.add(r),this[Lb(n)]=t.getItemVisual(e,n)},this),this._updateCommonStl(t,e,n)},Vb.updateData=function(t,e,n){var r=t.hostModel,i=this.childOfName("line"),o=t.getItemLayout(e),a={shape:{}};Bb(a.shape,o),$s(i,a,r,e),k(Rb,function(n){var r=t.getItemVisual(e,n),i=Lb(n);if(this[i]!==r){this.remove(this.childOfName(n));var o=Nb(n,t,e);this.add(o)}this[i]=r},this),this._updateCommonStl(t,e,n)},Vb._updateCommonStl=function(t,e,n){var r=t.hostModel,i=this.childOfName("line"),o=n&&n.lineStyle,a=n&&n.hoverLineStyle,s=n&&n.labelModel,l=n&&n.hoverLabelModel;if(!n||t.hasItemOption){var u=t.getItemModel(e);o=u.getModel("lineStyle").getLineStyle(),a=u.getModel("emphasis.lineStyle").getLineStyle(),s=u.getModel("label"),l=u.getModel("emphasis.label")}var c=t.getItemVisual(e,"color"),d=G(t.getItemVisual(e,"opacity"),o.opacity,1);i.useStyle(b({strokeNoScale:!0,fill:"none",stroke:c,opacity:d},o)),i.hoverStyle=a,k(Rb,function(t){var e=this.childOfName(t);e&&(e.setColor(c),e.setStyle({opacity:d}))},this);var f,h,p=s.getShallow("show"),g=l.getShallow("show"),m=this.childOfName("label");if((p||g)&&(f=c||"#000",null==(h=r.getFormattedLabel(e,"normal",t.dataType)))){var v=r.getRawValue(e);h=null==v?t.getName(e):isFinite(v)?_l(v):v}var y=p?h:null,x=g?j(r.getFormattedLabel(e,"emphasis",t.dataType),h):null,_=m.style;if(null!=y||null!=x){Hs(m.style,s,{text:y},{autoColor:f}),m.__textAlign=_.textAlign,m.__verticalAlign=_.textVerticalAlign,m.__position=s.get("position")||"middle";var w=s.get("distance");R(w)||(w=[w,w]),m.__labelDistance=w}m.hoverStyle=null!=x?{text:x,textFill:l.getTextColor(!0),fontStyle:l.getShallow("fontStyle"),fontWeight:l.getShallow("fontWeight"),fontSize:l.getShallow("fontSize"),fontFamily:l.getShallow("fontFamily")}:{text:null},m.ignore=!p&&!g,Ls(this)},Vb.highlight=function(){this.trigger("emphasis")},Vb.downplay=function(){this.trigger("normal")},Vb.updateLayout=function(t,e){this.setLinePoints(t.getItemLayout(e))},Vb.setLinePoints=function(t){var e=this.childOfName("line");Bb(e.shape,t),e.dirty()},C(zb,Cn);var Hb=Fb.prototype;function Wb(t){var e=t.hostModel;return{lineStyle:e.getModel("lineStyle").getLineStyle(),hoverLineStyle:e.getModel("emphasis.lineStyle").getLineStyle(),labelModel:e.getModel("label"),hoverLabelModel:e.getModel("emphasis.label")}}function jb(t){return isNaN(t[0])||isNaN(t[1])}function Gb(t){return!jb(t[0])&&!jb(t[1])}function Ub(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var n=t.option.nodeScaleRatio,r=e.scale,i=r&&r[0]||1;return((e.getZoom()-1)*n+1)/i}function qb(t){var e=t.getVisual("symbolSize");return e instanceof Array&&(e=(e[0]+e[1])/2),+e}Hb.isPersistent=function(){return!0},Hb.updateData=function(t){var e=this,n=e.group,r=e._lineData;e._lineData=t,r||n.removeAll();var i=Wb(t);t.diff(r).add(function(n){!function(t,e,n,r){if(Gb(e.getItemLayout(n))){var i=new t._ctor(e,n,r);e.setItemGraphicEl(n,i),t.group.add(i)}}(e,t,n,i)}).update(function(n,o){!function(t,e,n,r,i,o){var a=e.getItemGraphicEl(r);if(!Gb(n.getItemLayout(i)))return t.group.remove(a);a?a.updateData(n,i,o):a=new t._ctor(n,i,o),n.setItemGraphicEl(i,a),t.group.add(a)}(e,r,t,o,n,i)}).remove(function(t){n.remove(r.getItemGraphicEl(t))}).execute()},Hb.updateLayout=function(){var t=this._lineData;t&&t.eachItemGraphicEl(function(e,n){e.updateLayout(t,n)},this)},Hb.incrementalPrepareUpdate=function(t){this._seriesScope=Wb(t),this._lineData=null,this.group.removeAll()},Hb.incrementalUpdate=function(t,e){function n(t){t.isGroup||function(t){return t.animators&&0<t.animators.length}(t)||(t.incremental=t.useHoverLayer=!0)}for(var r=t.start;r<t.end;r++)if(Gb(e.getItemLayout(r))){var i=new this._ctor(e,r,this._seriesScope);i.traverse(n),this.group.add(i),e.setItemGraphicEl(r,i)}},Hb.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},Hb._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles()};var Xb=[],Yb=[],$b=[],Zb=vo,Kb=yt,Jb=Math.abs;function Qb(t,e,n){for(var r,i=t[0],o=t[1],a=t[2],s=1/0,l=n*n,u=.1,c=.1;c<=.9;c+=.1)Xb[0]=Zb(i[0],o[0],a[0],c),Xb[1]=Zb(i[1],o[1],a[1],c),(h=Jb(Kb(Xb,e)-l))<s&&(s=h,r=c);for(var d=0;d<32;d++){var f=r+u;Yb[0]=Zb(i[0],o[0],a[0],r),Yb[1]=Zb(i[1],o[1],a[1],r),$b[0]=Zb(i[0],o[0],a[0],f),$b[1]=Zb(i[1],o[1],a[1],f);var h=Kb(Yb,e)-l;if(Jb(h)<.01)break;var p=Kb($b,e)-l;u/=2,h<0?0<=p?r+=u:r-=u:0<=p?r-=u:r+=u}return r}function t_(t,e){var n=[],r=bo,i=[[],[],[]],o=[[],[]],a=[];e/=2,t.eachEdge(function(t,s){var l=t.getLayout(),u=t.getVisual("fromSymbol"),c=t.getVisual("toSymbol");l.__original||(l.__original=[at(l[0]),at(l[1])],l[2]&&l.__original.push(at(l[2])));var d=l.__original;if(null!=l[2]){if(ot(i[0],d[0]),ot(i[1],d[2]),ot(i[2],d[1]),u&&"none"!==u){var f=qb(t.node1),h=Qb(i,d[0],f*e);r(i[0][0],i[1][0],i[2][0],h,n),i[0][0]=n[3],i[1][0]=n[4],r(i[0][1],i[1][1],i[2][1],h,n),i[0][1]=n[3],i[1][1]=n[4]}c&&"none"!==c&&(f=qb(t.node2),h=Qb(i,d[1],f*e),r(i[0][0],i[1][0],i[2][0],h,n),i[1][0]=n[1],i[2][0]=n[2],r(i[0][1],i[1][1],i[2][1],h,n),i[1][1]=n[1],i[2][1]=n[2]),ot(l[0],i[0]),ot(l[1],i[2]),ot(l[2],i[1])}else ot(o[0],d[0]),ot(o[1],d[1]),ct(a,o[1],o[0]),pt(a,a),u&&"none"!==u&&(f=qb(t.node1),ut(o[0],o[0],a,f*e)),c&&"none"!==c&&(f=qb(t.node2),ut(o[1],o[1],a,-f*e)),ot(l[0],o[0]),ot(l[1],o[1])})}var e_="__focusNodeAdjacency",n_="__unfocusNodeAdjacency",r_=["itemStyle","opacity"],i_=["lineStyle","opacity"];function o_(t,e){var n=t.getVisual("opacity");return null!=n?n:t.getModel().get(e)}function a_(t,e,n){var r=t.getGraphicEl(),i=o_(t,e);null!=n&&(null==i&&(i=1),i*=n),r.downplay&&r.downplay(),r.traverse(function(t){if(!t.isGroup){var e=t.lineLabelOriginalOpacity;null!=e&&null==n||(e=i),t.setStyle("opacity",e)}})}function s_(t,e){var n=o_(t,e),r=t.getGraphicEl();r.traverse(function(t){t.isGroup||t.setStyle("opacity",n)}),r.highlight&&r.highlight()}function l_(t){return t instanceof Array||(t=[t,t]),t}function u_(t){var e=t.coordinateSystem;if(!e||"view"===e.type){var n=t.getGraph();n.eachNode(function(t){var e=t.getModel();t.setLayout([+e.get("x"),+e.get("y")])}),c_(n,t)}}function c_(t,e){t.eachEdge(function(t,n){var r=G(t.getModel().get("lineStyle.curveness"),-Ab(t,e,n,!0),0),i=at(t.node1.getLayout()),o=at(t.node2.getLayout()),a=[i,o];+r&&a.push([(i[0]+o[0])/2-(i[1]-o[1])*r,(i[1]+o[1])/2-(o[0]-i[0])*r]),t.setLayout(a)})}ch({type:"graph",init:function(t,e){var n=new Pg,r=new Fb,i=this.group;this._controller=new fy(e.getZr()),this._controllerHost={target:i},i.add(n.group),i.add(r.group),this._symbolDraw=n,this._lineDraw=r,this._firstRender=!0},render:function(t,e,n){var r=this,i=t.coordinateSystem;this._model=t;var o=this._symbolDraw,a=this._lineDraw,s=this.group;if("view"===i.type){var l={position:i.position,scale:i.scale};this._firstRender?s.attr(l):$s(s,l,t)}t_(t.getGraph(),Ub(t));var u=t.getData();o.updateData(u);var c=t.getEdgeData();a.updateData(c),this._updateNodeAndLinkScale(),this._updateController(t,e,n),clearTimeout(this._layoutTimeout);var d=t.forceLayout,f=t.get("force.layoutAnimation");d&&this._startForceLayoutIteration(d,f),u.eachItemGraphicEl(function(e,i){var o=u.getItemModel(i);e.off("drag").off("dragend");var a=o.get("draggable");a&&e.on("drag",function(){d&&(d.warmUp(),this._layouting||this._startForceLayoutIteration(d,f),d.setFixed(i),u.setItemLayout(i,e.position))},this).on("dragend",function(){d&&d.setUnfixed(i)},this),e.setDraggable(a&&d),e[e_]&&e.off("mouseover",e[e_]),e[n_]&&e.off("mouseout",e[n_]),o.get("focusNodeAdjacency")&&(e.on("mouseover",e[e_]=function(){r._clearTimer(),n.dispatchAction({type:"focusNodeAdjacency",seriesId:t.id,dataIndex:e.dataIndex})}),e.on("mouseout",e[n_]=function(){r._dispatchUnfocus(n)}))},this),u.graph.eachEdge(function(e){var i=e.getGraphicEl();i[e_]&&i.off("mouseover",i[e_]),i[n_]&&i.off("mouseout",i[n_]),e.getModel().get("focusNodeAdjacency")&&(i.on("mouseover",i[e_]=function(){r._clearTimer(),n.dispatchAction({type:"focusNodeAdjacency",seriesId:t.id,edgeDataIndex:e.dataIndex})}),i.on("mouseout",i[n_]=function(){r._dispatchUnfocus(n)}))});var h="circular"===t.get("layout")&&t.get("circular.rotateLabel"),p=u.getLayout("cx"),g=u.getLayout("cy");u.eachItemGraphicEl(function(t,e){var n=u.getItemModel(e).get("label.rotate")||0,r=t.getSymbolPath();if(h){var i=u.getItemLayout(e),o=Math.atan2(i[1]-g,i[0]-p);o<0&&(o=2*Math.PI+o);var a=i[0]<p;a&&(o-=Math.PI);var s=a?"left":"right";Fs(r,{textRotation:-o,textPosition:s,textOrigin:"center"},{textPosition:s})}else Fs(r,{textRotation:n*=Math.PI/180})}),this._firstRender=!1},dispose:function(){this._controller&&this._controller.dispose(),this._controllerHost={},this._clearTimer()},_dispatchUnfocus:function(t,e){var n=this;this._clearTimer(),this._unfocusDelayTimer=setTimeout(function(){n._unfocusDelayTimer=null,t.dispatchAction({type:"unfocusNodeAdjacency",seriesId:n._model.id})},500)},_clearTimer:function(){this._unfocusDelayTimer&&(clearTimeout(this._unfocusDelayTimer),this._unfocusDelayTimer=null)},focusNodeAdjacency:function(t,e,n,r){var i=t.getData().graph,o=r.edgeDataIndex,a=i.getNodeByIndex(r.dataIndex),s=i.getEdgeByIndex(o);(a||s)&&(i.eachNode(function(t){a_(t,r_,.1)}),i.eachEdge(function(t){a_(t,i_,.1)}),a&&(s_(a,r_),k(a.edges,function(t){t.dataIndex<0||(s_(t,i_),s_(t.node1,r_),s_(t.node2,r_))})),s&&(s_(s,i_),s_(s.node1,r_),s_(s.node2,r_)))},unfocusNodeAdjacency:function(t,e,n,r){var i=t.getData().graph;i.eachNode(function(t){a_(t,r_)}),i.eachEdge(function(t){a_(t,i_)})},_startForceLayoutIteration:function(t,e){var n=this;!function r(){t.step(function(t){n.updateLayout(n._model),(n._layouting=!t)&&(e?n._layoutTimeout=setTimeout(r,16):r())})}()},_updateController:function(t,e,n){var r=this._controller,i=this._controllerHost,o=this.group;r.setPointerChecker(function(e,r,i){var a=o.getBoundingRect();return a.applyTransform(o.transform),a.contain(r,i)&&!Cy(e,n,t)}),"view"===t.coordinateSystem.type?(r.enable(t.get("roam")),i.zoomLimit=t.get("scaleLimit"),i.zoom=t.coordinateSystem.getZoom(),r.off("pan").off("zoom").on("pan",function(e){_y(i,e.dx,e.dy),n.dispatchAction({seriesId:t.id,type:"graphRoam",dx:e.dx,dy:e.dy})}).on("zoom",function(e){wy(i,e.scale,e.originX,e.originY),n.dispatchAction({seriesId:t.id,type:"graphRoam",zoom:e.scale,originX:e.originX,originY:e.originY}),this._updateNodeAndLinkScale(),t_(t.getGraph(),Ub(t)),this._lineDraw.updateLayout()},this)):r.disable()},_updateNodeAndLinkScale:function(){var t=this._model,e=t.getData(),n=Ub(t),r=[n,n];e.eachItemGraphicEl(function(t,e){t.attr("scale",r)})},updateLayout:function(t){t_(t.getGraph(),Ub(t)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},remove:function(t,e){this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()}}),eh({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},function(){}),eh({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},function(){}),eh({type:"graphRoam",event:"graphRoam",update:"none"},function(t,e){e.eachComponent({mainType:"series",query:t},function(e){var n=Py(e.coordinateSystem,t);e.setCenter&&e.setCenter(n.center),e.setZoom&&e.setZoom(n.zoom)})});var d_=Math.PI,f_=[];function h_(t,e){var n=t.coordinateSystem;if(!n||"view"===n.type){var r=n.getBoundingRect(),i=t.getData(),o=i.graph,a=r.width/2+r.x,s=r.height/2+r.y,l=Math.min(r.width,r.height)/2,u=i.count();i.setLayout({cx:a,cy:s}),u&&(p_[e](t,n,o,i,l,a,s,u),o.eachEdge(function(e,n){var r,i=G(e.getModel().get("lineStyle.curveness"),Ab(e,t,n),0),o=at(e.node1.getLayout()),l=at(e.node2.getLayout());+i&&(r=[a*(i*=3)+(o[0]+l[0])/2*(1-i),s*i+(o[1]+l[1])/2*(1-i)]),e.setLayout([o,l,r])}))}}var p_={value:function(t,e,n,r,i,o,a,s){var l=0,u=r.getSum("value"),c=2*Math.PI/(u||s);n.eachNode(function(t){var e=t.getValue("value"),n=c*(u?e:1)/2;l+=n,t.setLayout([i*Math.cos(l)+o,i*Math.sin(l)+a]),l+=n})},symbolSize:function(t,e,n,r,i,o,a,s){var l=0;f_.length=s;var u=Ub(t);n.eachNode(function(t){var e=qb(t);isNaN(e)&&(e=2),e<0&&(e=0),e*=u;var n=Math.asin(e/2/i);isNaN(n)&&(n=d_/2),f_[t.dataIndex]=n,l+=2*n});var c=(2*d_-l)/s/2,d=0;n.eachNode(function(t){var e=c+f_[t.dataIndex];d+=e,t.setLayout([i*Math.cos(d)+o,i*Math.sin(d)+a]),d+=e})}},g_=ut;th(function(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.eachSeriesByType("graph",function(t){var n=t.getCategoriesData(),r=t.getGraph().data,i=n.mapArray(n.getName);r.filterSelf(function(t){var n=r.getItemModel(t).getShallow("category");if(null!=n){"number"==typeof n&&(n=i[n]);for(var o=0;o<e.length;o++)if(!e[o].isSelected(n))return!1}return!0})},this)}),ih(om("graph","circle",null)),ih(function(t){var e={};t.eachSeriesByType("graph",function(t){var n=t.getCategoriesData(),r=t.getData(),i={};n.each(function(r){var o=n.getName(r);i["ec-"+o]=r;var a=n.getItemModel(r),s=a.get("itemStyle.color")||t.getColorFromPalette(o,e);n.setItemVisual(r,"color",s);for(var l=["opacity","symbol","symbolSize","symbolKeepAspect"],u=0;u<l.length;u++){var c=a.getShallow(l[u],!0);null!=c&&n.setItemVisual(r,l[u],c)}}),n.count()&&r.each(function(t){var e=r.getItemModel(t).getShallow("category");if(null!=e){"string"==typeof e&&(e=i["ec-"+e]);for(var o=["color","opacity","symbol","symbolSize","symbolKeepAspect"],a=0;a<o.length;a++)null==r.getItemVisual(t,o[a],!0)&&r.setItemVisual(t,o[a],n.getItemVisual(e,o[a]))}})})}),ih(function(t){t.eachSeriesByType("graph",function(t){var e=t.getGraph(),n=t.getEdgeData(),r=l_(t.get("edgeSymbol")),i=l_(t.get("edgeSymbolSize")),o="lineStyle.color".split("."),a="lineStyle.opacity".split(".");n.setVisual("fromSymbol",r&&r[0]),n.setVisual("toSymbol",r&&r[1]),n.setVisual("fromSymbolSize",i&&i[0]),n.setVisual("toSymbolSize",i&&i[1]),n.setVisual("color",t.get(o)),n.setVisual("opacity",t.get(a)),n.each(function(t){var r=n.getItemModel(t),i=e.getEdgeByIndex(t),s=l_(r.getShallow("symbol",!0)),l=l_(r.getShallow("symbolSize",!0)),u=r.get(o),c=r.get(a);switch(u){case"source":u=i.node1.getVisual("color");break;case"target":u=i.node2.getVisual("color")}s[0]&&i.setVisual("fromSymbol",s[0]),s[1]&&i.setVisual("toSymbol",s[1]),l[0]&&i.setVisual("fromSymbolSize",l[0]),l[1]&&i.setVisual("toSymbolSize",l[1]),i.setVisual("color",u),i.setVisual("opacity",c)})})}),rh(function(t,e){t.eachSeriesByType("graph",function(t){var e=t.get("layout"),n=t.coordinateSystem;if(n&&"view"!==n.type){var r=t.getData(),i=[];k(n.dimensions,function(t){i=i.concat(r.mapDimension(t,!0))});for(var o=0;o<r.count();o++){for(var a=[],s=!1,l=0;l<i.length;l++){var u=r.get(i[l],o);isNaN(u)||(s=!0),a.push(u)}r.setItemLayout(o,s?n.dataToPoint(a):[NaN,NaN])}c_(r.graph,t)}else e&&"none"!==e||u_(t)})}),rh(ff.VISUAL.POST_CHART_LAYOUT,function(t){t.eachSeriesByType("graph",function(t){"circular"===t.get("layout")&&h_(t,"symbolSize")})}),rh(function(t){t.eachSeriesByType("graph",function(t){if(!(d=t.coordinateSystem)||"view"===d.type)if("force"===t.get("layout")){var e=t.preservedPoints||{},n=t.getGraph(),r=n.data,i=n.edgeData,o=t.getModel("force"),a=o.get("initLayout");t.preservedPoints?r.each(function(t){var n=r.getId(t);r.setItemLayout(t,e[n]||[NaN,NaN])}):a&&"none"!==a?"circular"===a&&h_(t,"value"):u_(t);var s=r.getDataExtent("value"),l=i.getDataExtent("value"),u=o.get("repulsion"),c=o.get("edgeLength");R(u)||(u=[u,u]),R(c)||(c=[c,c]),c=[c[1],c[0]];var d,f=r.mapArray("value",function(t,e){var n=r.getItemLayout(e),i=xl(t,s,u);return isNaN(i)&&(i=(u[0]+u[1])/2),{w:i,rep:i,fixed:r.getItemModel(e).get("fixed"),p:!n||isNaN(n[0])||isNaN(n[1])?null:n}}),h=i.mapArray("value",function(e,r){var i=n.getEdgeByIndex(r),o=xl(e,l,c);isNaN(o)&&(o=(c[0]+c[1])/2);var a=i.getModel(),s=G(a.get("lineStyle.curveness"),-Ab(i,t,r,!0),0);return{n1:f[i.node1.dataIndex],n2:f[i.node2.dataIndex],d:o,curveness:s,ignoreForceLayout:a.get("ignoreForceLayout")}}),p=(d=t.coordinateSystem).getBoundingRect(),g=function(t,e,n){for(var r=n.rect,i=r.width,o=r.height,a=[r.x+i/2,r.y+o/2],s=null==n.gravity?.1:n.gravity,l=0;l<t.length;l++){var u=t[l];u.p||(u.p=it(i*(Math.random()-.5)+a[0],o*(Math.random()-.5)+a[1])),u.pp=at(u.p),u.edges=null}var c=null==n.friction?.6:n.friction,d=c;return{warmUp:function(){d=.8*c},setFixed:function(e){t[e].fixed=!0},setUnfixed:function(e){t[e].fixed=!1},step:function(n){for(var r=[],i=t.length,o=0;o<e.length;o++){var l=e[o];if(!l.ignoreForceLayout){var u=l.n1;ct(r,(p=l.n2).p,u.p);var c=dt(r)-l.d,f=p.w/(u.w+p.w);isNaN(f)&&(f=0),pt(r,r),u.fixed||g_(u.p,u.p,r,f*c*d),p.fixed||g_(p.p,p.p,r,-(1-f)*c*d)}}for(o=0;o<i;o++)(v=t[o]).fixed||(ct(r,a,v.p),g_(v.p,v.p,r,s*d));for(o=0;o<i;o++){u=t[o];for(var h=o+1;h<i;h++){var p;ct(r,(p=t[h]).p,u.p),0===(c=dt(r))&&(st(r,Math.random()-.5,Math.random()-.5),c=1);var g=(u.rep+p.rep)/c/c;u.fixed||g_(u.pp,u.pp,r,g),p.fixed||g_(p.pp,p.pp,r,-g)}}var m=[];for(o=0;o<i;o++){var v;(v=t[o]).fixed||(ct(m,v.p,v.pp),g_(v.p,v.p,m,d),ot(v.pp,v.p))}d*=.992,n&&n(t,e,d<.01)}}}(f,h,{rect:p,gravity:o.get("gravity"),friction:o.get("friction")}),m=g.step;g.step=function(t){for(var i=0,o=f.length;i<o;i++)f[i].fixed&&ot(f[i].p,n.getNodeByIndex(i).getLayout());m(function(i,o,a){for(var s=0,l=i.length;s<l;s++)i[s].fixed||n.getNodeByIndex(s).setLayout(i[s].p),e[r.getId(s)]=i[s].p;for(s=0,l=o.length;s<l;s++){var u=o[s],c=n.getEdgeByIndex(s),d=u.n1.p,f=u.n2.p,h=c.getLayout();(h=h?h.slice():[])[0]=h[0]||[],h[1]=h[1]||[],ot(h[0],d),ot(h[1],f),+u.curveness&&(h[2]=[(d[0]+f[0])/2-(d[1]-f[1])*u.curveness,(d[1]+f[1])/2-(f[0]-d[0])*u.curveness]),c.setLayout(h)}t&&t(a)})},t.forceLayout=g,t.preservedPoints=e,g.step()}else t.forceLayout=null})}),nh("graphView",{create:function(t,e){var n=[];return t.eachSeriesByType("graph",function(t){var r=t.get("coordinateSystem");if(!r||"view"===r){var i=t.getData(),o=[],a=[];Io(i.mapArray(function(t){var e=i.getItemModel(t);return[+e.get("x"),+e.get("y")]}),o,a),a[0]-o[0]==0&&(a[0]+=1,o[0]-=1),a[1]-o[1]==0&&(a[1]+=1,o[1]-=1);var s=(a[0]-o[0])/(a[1]-o[1]),l=function(t,e,n){var r=t.getBoxLayoutParams();return r.aspect=n,au(r,{width:e.getWidth(),height:e.getHeight()})}(t,e,s);isNaN(s)&&(o=[l.x,l.y],a=[l.x+l.width,l.y+l.height]);var u=a[0]-o[0],c=a[1]-o[1],d=l.width,f=l.height,h=t.coordinateSystem=new Ly;h.zoomLimit=t.get("scaleLimit"),h.setBoundingRect(o[0],o[1],u,c),h.setViewRect(l.x,l.y,d,f),h.setCenter(t.get("center")),h.setZoom(t.get("zoom")),n.push(h)}}),n}}),jc.extend({type:"series.gauge",getInitialData:function(t,e){return _v(this,["value"])},defaultOption:{zlevel:0,z:2,center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,lineStyle:{color:[[.2,"#91c7ae"],[.8,"#63869e"],[1,"#c23531"]],width:30}},splitLine:{show:!0,length:30,lineStyle:{color:"#eee",width:2,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{color:"#eee",width:1,type:"solid"}},axisLabel:{show:!0,distance:5,color:"auto"},pointer:{show:!0,length:"80%",width:8},itemStyle:{color:"auto"},title:{show:!0,offsetCenter:[0,"-40%"],color:"#333",fontSize:15},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"auto",fontSize:30}}});var m_=ha.extend({type:"echartsGaugePointer",shape:{angle:0,width:10,r:10,x:0,y:0},buildPath:function(t,e){var n=Math.cos,r=Math.sin,i=e.r,o=e.width,a=e.angle,s=e.x-n(a)*o*(i/3<=o?1:2),l=e.y-r(a)*o*(i/3<=o?1:2);a=e.angle-Math.PI/2,t.moveTo(s,l),t.lineTo(e.x+n(a)*o,e.y+r(a)*o),t.lineTo(e.x+n(e.angle)*i,e.y+r(e.angle)*i),t.lineTo(e.x-n(a)*o,e.y-r(a)*o),t.lineTo(s,l)}});function v_(t,e){return e&&("string"==typeof e?t=e.replace("{value}",null!=t?t:""):"function"==typeof e&&(t=e(t))),t}var y_=2*Math.PI,x_=(nd.extend({type:"gauge",render:function(t,e,n){this.group.removeAll();var r=t.get("axisLine.lineStyle.color"),i=function(t,e){var n=t.get("center"),r=e.getWidth(),i=e.getHeight(),o=Math.min(r,i);return{cx:bl(n[0],e.getWidth()),cy:bl(n[1],e.getHeight()),r:bl(t.get("radius"),o/2)}}(t,n);this._renderMain(t,e,n,r,i)},dispose:function(){},_renderMain:function(t,e,n,r,i){for(var o=this.group,a=t.getModel("axisLine"),s=a.getModel("lineStyle"),l=t.get("clockwise"),u=-t.get("startAngle")/180*Math.PI,c=((g=-t.get("endAngle")/180*Math.PI)-u)%y_,d=u,f=s.get("width"),h=a.get("show"),p=0;h&&p<r.length;p++){var g,m=Math.min(Math.max(r[p][0],0),1),v=new Ra({shape:{startAngle:d,endAngle:g=u+c*m,cx:i.cx,cy:i.cy,clockwise:l,r0:i.r-f,r:i.r},silent:!0});v.setStyle({fill:r[p][1]}),v.setStyle(s.getLineStyle(["color","borderWidth","borderColor"])),o.add(v),d=g}function y(t){if(t<=0)return r[0][1];for(var e=0;e<r.length;e++)if(r[e][0]>=t&&(0===e?0:r[e-1][0])<t)return r[e][1];return r[e-1][1]}if(!l){var x=u;u=g,g=x}this._renderTicks(t,e,n,y,i,u,g,l),this._renderPointer(t,e,n,y,i,u,g,l),this._renderTitle(t,e,n,y,i),this._renderDetail(t,e,n,y,i)},_renderTicks:function(t,e,n,r,i,o,a,s){for(var l=this.group,u=i.cx,c=i.cy,d=i.r,f=+t.get("min"),h=+t.get("max"),p=t.getModel("splitLine"),g=t.getModel("axisTick"),m=t.getModel("axisLabel"),v=t.get("splitNumber"),y=g.get("splitNumber"),x=bl(p.get("length"),d),b=bl(g.get("length"),d),_=o,w=(a-o)/v,S=w/y,C=p.getModel("lineStyle").getLineStyle(),M=g.getModel("lineStyle").getLineStyle(),T=0;T<=v;T++){var k=Math.cos(_),A=Math.sin(_);if(p.get("show")){var I=new Xa({shape:{x1:k*d+u,y1:A*d+c,x2:k*(d-x)+u,y2:A*(d-x)+c},style:C,silent:!0});"auto"===C.stroke&&I.setStyle({stroke:r(T/v)}),l.add(I)}if(m.get("show")){var D=v_(_l(T/v*(h-f)+f),m.get("formatter")),O=m.get("distance"),P=r(T/v);l.add(new Da({style:Hs({},m,{text:D,x:k*(d-x-O)+u,y:A*(d-x-O)+c,textVerticalAlign:A<-.4?"top":.4<A?"bottom":"middle",textAlign:k<-.4?"left":.4<k?"right":"center"},{autoColor:P}),silent:!0}))}if(g.get("show")&&T!==v){for(var E=0;E<=y;E++){k=Math.cos(_),A=Math.sin(_);var R=new Xa({shape:{x1:k*d+u,y1:A*d+c,x2:k*(d-b)+u,y2:A*(d-b)+c},silent:!0,style:M});"auto"===M.stroke&&R.setStyle({stroke:r((T+E/y)/v)}),l.add(R),_+=S}_-=S}else _+=w}},_renderPointer:function(t,e,n,r,i,o,a,s){var l=this.group,u=this._data;if(t.get("pointer.show")){var c=[+t.get("min"),+t.get("max")],d=[o,a],f=t.getData(),h=f.mapDimension("value");f.diff(u).add(function(e){var n=new m_({shape:{angle:o}});Zs(n,{shape:{angle:xl(f.get(h,e),c,d,!0)}},t),l.add(n),f.setItemGraphicEl(e,n)}).update(function(e,n){var r=u.getItemGraphicEl(n);$s(r,{shape:{angle:xl(f.get(h,e),c,d,!0)}},t),l.add(r),f.setItemGraphicEl(e,r)}).remove(function(t){var e=u.getItemGraphicEl(t);l.remove(e)}).execute(),f.eachItemGraphicEl(function(t,e){var n=f.getItemModel(e),o=n.getModel("pointer");t.setShape({x:i.cx,y:i.cy,width:bl(o.get("width"),i.r),r:bl(o.get("length"),i.r)}),t.useStyle(n.getModel("itemStyle").getItemStyle()),"auto"===t.style.fill&&t.setStyle("fill",r(xl(f.get(h,e),c,[0,1],!0))),Ls(t,n.getModel("emphasis.itemStyle").getItemStyle())}),this._data=f}else u&&u.eachItemGraphicEl(function(t){l.remove(t)})},_renderTitle:function(t,e,n,r,i){var o=t.getData(),a=o.mapDimension("value"),s=t.getModel("title");if(s.get("show")){var l=s.get("offsetCenter"),u=i.cx+bl(l[0],i.r),c=i.cy+bl(l[1],i.r),d=+t.get("min"),f=+t.get("max"),h=r(xl(t.getData().get(a,0),[d,f],[0,1],!0));this.group.add(new Da({silent:!0,style:Hs({},s,{x:u,y:c,text:o.getName(0),textAlign:"center",textVerticalAlign:"middle"},{autoColor:h,forceRich:!0})}))}},_renderDetail:function(t,e,n,r,i){var o=t.getModel("detail"),a=+t.get("min"),s=+t.get("max");if(o.get("show")){var l=o.get("offsetCenter"),u=i.cx+bl(l[0],i.r),c=i.cy+bl(l[1],i.r),d=bl(o.get("width"),i.r),f=bl(o.get("height"),i.r),h=t.getData(),p=h.get(h.mapDimension("value"),0),g=r(xl(p,[a,s],[0,1],!0));this.group.add(new Da({silent:!0,style:Hs({},o,{x:u,y:c,text:v_(p,o.get("formatter")),textWidth:isNaN(d)?null:d,textHeight:isNaN(f)?null:f,textAlign:"center",textVerticalAlign:"middle"},{autoColor:g,forceRich:!0})}))}}}),uh({type:"series.funnel",init:function(t){x_.superApply(this,"init",arguments),this.legendVisualProvider=new Sv(P(this.getData,this),P(this.getRawData,this)),this._defaultLabelLine(t)},getInitialData:function(t,e){return _v(this,{coordDimensions:["value"],encodeDefaulter:E(Lu,this)})},_defaultLabelLine:function(t){ki(t,"labelLine",["show"]);var e=t.labelLine,n=t.emphasis.labelLine;e.show=e.show&&t.label.show,n.show=n.show&&t.emphasis.label.show},getDataParams:function(t){var e=this.getData(),n=x_.superCall(this,"getDataParams",t),r=e.mapDimension("value"),i=e.getSum(r);return n.percent=i?+(e.get(r,t)/i*100).toFixed(2):0,n.$vars.push("percent"),n},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",orient:"vertical",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{show:!0}}}}));function b_(t,e){Cn.call(this);var n=new za,r=new Va,i=new Da;this.add(n),this.add(r),this.add(i),this.highDownOnUpdate=function(t,e){"emphasis"===e?(r.ignore=r.hoverIgnore,i.ignore=i.hoverIgnore):(r.ignore=r.normalIgnore,i.ignore=i.normalIgnore)},this.updateData(t,e,!0)}var __=b_.prototype,w_=["itemStyle","opacity"];function S_(t,e,n,r,i){mg.call(this,t,e,n),this.type=r||"value",this.axisIndex=i}function C_(t,e,n,r,i,o){t=t||0;var a=n[1]-n[0];if(null!=i&&(i=T_(i,[0,a])),null!=o&&(o=Math.max(o,null!=i?i:0)),"all"===r){var s=Math.abs(e[1]-e[0]);i=o=T_(s=T_(s,[0,a]),[i,o]),r=0}e[0]=T_(e[0],n),e[1]=T_(e[1],n);var l=M_(e,r);e[r]+=t;var u=i||0,c=n.slice();l.sign<0?c[0]+=u:c[1]-=u,e[r]=T_(e[r],c);var d=M_(e,r);return null!=i&&(d.sign!==l.sign||d.span<i)&&(e[1-r]=e[r]+l.sign*i),d=M_(e,r),null!=o&&d.span>o&&(e[1-r]=e[r]+d.sign*o),e}function M_(t,e){var n=t[e]-t[1-e];return{span:Math.abs(n),sign:0<n?-1:n<0?1:e?-1:1}}function T_(t,e){return Math.min(null!=e[1]?e[1]:1/0,Math.max(null!=e[0]?e[0]:-1/0,t))}__.updateData=function(t,e,n){var r=this.childAt(0),i=t.hostModel,o=t.getItemModel(e),a=t.getItemLayout(e),s=t.getItemModel(e).get(w_);s=null==s?1:s,r.useStyle({}),n?(r.setShape({points:a.points}),r.setStyle({opacity:0}),Zs(r,{style:{opacity:s}},i,e)):$s(r,{style:{opacity:s},shape:{points:a.points}},i,e);var l=o.getModel("itemStyle"),u=t.getItemVisual(e,"color");r.setStyle(b({lineJoin:"round",fill:u},l.getItemStyle(["opacity"]))),r.hoverStyle=l.getModel("emphasis").getItemStyle(),this._updateLabel(t,e),Ls(this)},__._updateLabel=function(t,e){var n=this.childAt(1),r=this.childAt(2),i=t.hostModel,o=t.getItemModel(e),a=t.getItemLayout(e).label,s=t.getItemVisual(e,"color");$s(n,{shape:{points:a.linePoints||a.linePoints}},i,e),$s(r,{style:{x:a.x,y:a.y}},i,e),r.attr({rotation:a.rotation,origin:[a.x,a.y],z2:10});var l=o.getModel("label"),u=o.getModel("emphasis.label"),c=o.getModel("labelLine"),d=o.getModel("emphasis.labelLine");s=t.getItemVisual(e,"color"),Vs(r.style,r.hoverStyle={},l,u,{labelFetcher:t.hostModel,labelDataIndex:e,defaultText:t.getName(e),autoColor:s,useInsideStyle:!!a.inside},{textAlign:a.textAlign,textVerticalAlign:a.verticalAlign}),r.ignore=r.normalIgnore=!l.get("show"),r.hoverIgnore=!u.get("show"),n.ignore=n.normalIgnore=!c.get("show"),n.hoverIgnore=!d.get("show"),n.setStyle({stroke:s}),n.setStyle(c.getModel("lineStyle").getLineStyle()),n.hoverStyle=d.getModel("lineStyle").getLineStyle()},C(b_,Cn),nd.extend({type:"funnel",render:function(t,e,n){var r=t.getData(),i=this._data,o=this.group;r.diff(i).add(function(t){var e=new b_(r,t);r.setItemGraphicEl(t,e),o.add(e)}).update(function(t,e){var n=i.getItemGraphicEl(e);n.updateData(r,t),o.add(n),r.setItemGraphicEl(t,n)}).remove(function(t){var e=i.getItemGraphicEl(t);o.remove(e)}).execute(),this._data=r},remove:function(){this.group.removeAll(),this._data=null},dispose:function(){}}),ih(Dv("funnel")),rh(function(t,e,n){t.eachSeriesByType("funnel",function(t){var n=t.getData(),r=n.mapDimension("value"),i=t.get("sort"),o=function(t,e){return au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}(t,e),a=function(t,e){for(var n=t.mapDimension("value"),r=t.mapArray(n,function(t){return t}),i=[],o="ascending"===e,a=0,s=t.count();a<s;a++)i[a]=a;return"function"==typeof e?i.sort(e):"none"!==e&&i.sort(function(t,e){return o?r[t]-r[e]:r[e]-r[t]}),i}(n,i),s=t.get("orient"),l=o.width,u=o.height,c=o.x,d=o.y,f="horizontal"===s?[bl(t.get("minSize"),u),bl(t.get("maxSize"),u)]:[bl(t.get("minSize"),l),bl(t.get("maxSize"),l)],h=n.getDataExtent(r),p=t.get("min"),g=t.get("max");function m(t,e){if("horizontal"===s){var i,o=xl(n.get(r,t)||0,[p,g],f,!0);switch(v){case"top":i=d;break;case"center":i=d+(u-o)/2;break;case"bottom":i=d+(u-o)}return[[e,i],[e,i+o]]}var a,h=xl(n.get(r,t)||0,[p,g],f,!0);switch(v){case"left":a=c;break;case"center":a=c+(l-h)/2;break;case"right":a=c+l-h}return[[a,e],[a+h,e]]}null==p&&(p=Math.min(h[0],0)),null==g&&(g=h[1]);var v=t.get("funnelAlign"),y=t.get("gap"),x=(("horizontal"===s?l:u)-y*(n.count()-1))/n.count();"ascending"===i&&(x=-x,y=-y,"horizontal"===s?c+=l:d+=u,a=a.reverse());for(var b=0;b<a.length;b++){var _=a[b],w=a[b+1],S=n.getItemModel(_);if("horizontal"===s){var C=S.get("itemStyle.width");null==C?C=x:(C=bl(C,l),"ascending"===i&&(C=-C));var M=m(_,c),T=m(w,c+C);c+=C+y,n.setItemLayout(_,{points:M.concat(T.slice().reverse())})}else{var k=S.get("itemStyle.height");null==k?k=x:(k=bl(k,u),"ascending"===i&&(k=-k)),M=m(_,"horizontal"===s?c:d),T=m(w,"horizontal"===s?c+C:d+k),d+=k+y,n.setItemLayout(_,{points:M.concat(T.slice().reverse())})}}!function(t){t.each(function(e){var n,r,i,o,a=t.getItemModel(e),s=a.getModel("label").get("position"),l=a.get("orient"),u=a.getModel("labelLine"),c=t.getItemLayout(e),d=c.points,f="inner"===s||"inside"===s||"center"===s||"insideLeft"===s||"insideRight"===s;if(f)n="insideLeft"===s?(r=(d[0][0]+d[3][0])/2+5,i=(d[0][1]+d[3][1])/2,"left"):"insideRight"===s?(r=(d[1][0]+d[2][0])/2-5,i=(d[1][1]+d[2][1])/2,"right"):(r=(d[0][0]+d[1][0]+d[2][0]+d[3][0])/4,i=(d[0][1]+d[1][1]+d[2][1]+d[3][1])/4,"center"),o=[[r,i],[r,i]];else{var h,p,g,m,v=u.get("length");n="left"===s?(p=(d[3][1]+d[0][1])/2,r=(g=(h=(d[3][0]+d[0][0])/2)-v)-5,"right"):"right"===s?(p=(d[1][1]+d[2][1])/2,r=(g=(h=(d[1][0]+d[2][0])/2)+v)+5,"left"):"top"===s?(h=(d[3][0]+d[0][0])/2,i=(m=(p=(d[3][1]+d[0][1])/2)-v)-5,"center"):"bottom"===s?(h=(d[1][0]+d[2][0])/2,i=(m=(p=(d[1][1]+d[2][1])/2)+v)+5,"center"):"rightTop"===s?(h="horizontal"===l?d[3][0]:d[1][0],p="horizontal"===l?d[3][1]:d[1][1],"horizontal"===l?(i=(m=p-v)-5,"center"):(r=(g=h+v)+5,"top")):"rightBottom"===s?(h=d[2][0],p=d[2][1],"horizontal"===l?(i=(m=p+v)+5,"center"):(r=(g=h+v)+5,"bottom")):"leftTop"===s?(h=d[0][0],p="horizontal"===l?d[0][1]:d[1][1],"horizontal"===l?(i=(m=p-v)-5,"center"):(r=(g=h-v)-5,"right")):"leftBottom"===s?(h="horizontal"===l?d[1][0]:d[3][0],p="horizontal"===l?d[1][1]:d[2][1],"horizontal"===l?(i=(m=p+v)+5,"center"):(r=(g=h-v)-5,"right")):(h=(d[1][0]+d[2][0])/2,p=(d[1][1]+d[2][1])/2,"horizontal"===l?(i=(m=p+v)+5,"center"):(r=(g=h+v)+5,"left")),"horizontal"===l?r=g=h:i=m=p,o=[[h,p],[g,m]]}c.label={linePoints:o,x:r,y:i,verticalAlign:"middle",textAlign:n,inside:f}})}(n)})}),th(Nv("funnel")),S_.prototype={constructor:S_,model:null,isHorizontal:function(){return"horizontal"!==this.coordinateSystem.getModel().get("layout")}},C(S_,mg);var k_=k,A_=Math.min,I_=Math.max,D_=Math.floor,O_=Math.ceil,P_=_l,E_=Math.PI;function R_(t,e,n){this._axesMap=Q(),this._axesLayout={},this.dimensions=t.dimensions,this._model=t,this._init(t,e,n)}function L_(t,e){return A_(I_(t,e[0]),e[1])}R_.prototype={type:"parallel",constructor:R_,_init:function(t,e,n){var r=t.parallelAxisIndex;k_(t.dimensions,function(t,n){var i=r[n],o=e.getComponent("parallelAxis",i),a=this._axesMap.set(t,new S_(t,Hp(o),[0,0],o.get("type"),i));a.onBand="category"===a.type&&o.get("boundaryGap"),a.inverse=o.get("inverse"),(o.axis=a).model=o,a.coordinateSystem=o.coordinateSystem=this},this)},update:function(t,e){this._updateAxesFromSeries(this._model,t)},containPoint:function(t){var e=this._makeLayoutInfo(),n=e.axisBase,r=e.layoutBase,i=e.pixelDimIndex,o=t[1-i],a=t[i];return n<=o&&o<=n+e.axisLength&&r<=a&&a<=r+e.layoutLength},getModel:function(){return this._model},_updateAxesFromSeries:function(t,e){e.eachSeries(function(n){if(t.contains(n,e)){var r=n.getData();k_(this.dimensions,function(t){var e=this._axesMap.get(t);e.scale.unionExtentFromData(r,r.mapDimension(t)),Fp(e.scale,e.model)},this)}},this)},resize:function(t,e){this._rect=au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),this._layoutAxes()},getRect:function(){return this._rect},_makeLayoutInfo:function(){var t,e=this._model,n=this._rect,r=["x","y"],i=["width","height"],o=e.get("layout"),a="horizontal"===o?0:1,s=n[i[a]],l=[0,s],u=this.dimensions.length,c=L_(e.get("axisExpandWidth"),l),d=L_(e.get("axisExpandCount")||0,[0,u]),f=e.get("axisExpandable")&&3<u&&d<u&&1<d&&0<c&&0<s,h=e.get("axisExpandWindow");h?(t=L_(h[1]-h[0],l),h[1]=h[0]+t):(t=L_(c*(d-1),l),(h=[c*(e.get("axisExpandCenter")||D_(u/2))-t/2])[1]=h[0]+t);var p=(s-t)/(u-d);p<3&&(p=0);var g=[D_(P_(h[0]/c,1))+1,O_(P_(h[1]/c,1))-1];return{layout:o,pixelDimIndex:a,layoutBase:n[r[a]],layoutLength:s,axisBase:n[r[1-a]],axisLength:n[i[1-a]],axisExpandable:f,axisExpandWidth:c,axisCollapseWidth:p,axisExpandWindow:h,axisCount:u,winInnerIndices:g,axisExpandWindow0Pos:p/c*h[0]}},_layoutAxes:function(){var t=this._rect,e=this._axesMap,n=this.dimensions,r=this._makeLayoutInfo(),i=r.layout;e.each(function(t){var e=[0,r.axisLength],n=t.inverse?1:0;t.setExtent(e[n],e[1-n])}),k_(n,function(e,n){var o=(r.axisExpandable?function(t,e){var n,r,i=e.axisExpandWidth,o=e.axisCollapseWidth,a=e.winInnerIndices,s=o,l=!1;return t<a[0]?(n=t*o,r=o):t<=a[1]?(n=e.axisExpandWindow0Pos+t*i-e.axisExpandWindow[0],s=i,l=!0):(n=e.layoutLength-(e.axisCount-1-t)*o,r=o),{position:n,axisNameAvailableWidth:s,axisLabelShow:l,nameTruncateMaxWidth:r}}:function(t,e){var n=e.layoutLength/(e.axisCount-1);return{position:n*t,axisNameAvailableWidth:n,axisLabelShow:!0}})(n,r),a={horizontal:{x:o.position,y:r.axisLength},vertical:{x:0,y:o.position}},s=[a[i].x+t.x,a[i].y+t.y],l={horizontal:E_/2,vertical:0}[i],u=re();le(u,u,l),se(u,u,s),this._axesLayout[e]={position:s,rotation:l,transform:u,axisNameAvailableWidth:o.axisNameAvailableWidth,axisLabelShow:o.axisLabelShow,nameTruncateMaxWidth:o.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},getAxis:function(t){return this._axesMap.get(t)},dataToPoint:function(t,e){return this.axisCoordToPoint(this._axesMap.get(e).dataToCoord(t),e)},eachActiveState:function(t,e,n,r){null==n&&(n=0),null==r&&(r=t.count());var i=this._axesMap,o=this.dimensions,a=[],s=[];k(o,function(e){a.push(t.mapDimension(e)),s.push(i.get(e).model)});for(var l=this.hasAxisBrushed(),u=n;u<r;u++){var c;if(l){c="active";for(var d=t.getValues(a,u),f=0,h=o.length;f<h;f++)if("inactive"===s[f].getActiveState(d[f])){c="inactive";break}}else c="normal";e(c,u)}},hasAxisBrushed:function(){for(var t=this.dimensions,e=this._axesMap,n=!1,r=0,i=t.length;r<i;r++)"normal"!==e.get(t[r]).model.getActiveState()&&(n=!0);return n},axisCoordToPoint:function(t,e){return Js([t,0],this._axesLayout[e].transform)},getAxisLayout:function(t){return m(this._axesLayout[t])},getSlidedAxisExpandWindow:function(t){var e=this._makeLayoutInfo(),n=e.pixelDimIndex,r=e.axisExpandWindow.slice(),i=r[1]-r[0],o=[0,e.axisExpandWidth*(e.axisCount-1)];if(!this.containPoint(t))return{behavior:"none",axisExpandWindow:r};var a,s=t[n]-e.layoutBase-e.axisExpandWindow0Pos,l="slide",u=e.axisCollapseWidth,c=this._model.get("axisExpandSlideTriggerArea"),d=null!=c[0];return u?(d&&u&&s<i*c[0]?(l="jump",a=s-i*c[2]):d&&u&&s>i*(1-c[0])?(l="jump",a=s-i*(1-c[2])):0<=(a=s-i*c[1])&&(a=s-i*(1-c[1]))<=0&&(a=0),(a*=e.axisExpandWidth/u)?C_(a,r,o,"all"):l="none"):((r=[I_(0,o[1]*s/(i=r[1]-r[0])-i/2)])[1]=A_(o[1],r[0]+i),r[0]=r[1]-i),{axisExpandWindow:r,behavior:l}}},Uu.register("parallel",{create:function(t,e){var n=[];return t.eachComponent("parallel",function(r,i){var o=new R_(r,t,e);o.name="parallel_"+i,o.resize(r,e),(r.coordinateSystem=o).model=r,n.push(o)}),t.eachSeries(function(e){if("parallel"===e.get("coordinateSystem")){var n=t.queryComponents({mainType:"parallel",index:e.get("parallelIndex"),id:e.get("parallelId")})[0];e.coordinateSystem=n.coordinateSystem}}),n}});var N_=gu.extend({type:"baseParallelAxis",axis:null,activeIntervals:[],getAreaSelectStyle:function(){return Zi([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},setActiveIntervals:function(t){var e=this.activeIntervals=m(t);if(e)for(var n=e.length-1;0<=n;n--)wl(e[n])},getActiveState:function(t){var e=this.activeIntervals;if(!e.length)return"normal";if(null==t||isNaN(t))return"inactive";if(1===e.length){var n=e[0];if(n[0]<=t&&t<=n[1])return"active"}else for(var r=0,i=e.length;r<i;r++)if(e[r][0]<=t&&t<=e[r][1])return"active";return"inactive"}});v(N_.prototype,qp),gm("parallel",N_,function(t,e){return e.type||(e.data?"category":"value")},{type:"value",dim:null,areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10}),gu.extend({type:"parallel",dependencies:["parallelAxis"],coordinateSystem:null,dimensions:null,parallelAxisIndex:null,layoutMode:"box",defaultOption:{zlevel:0,z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},init:function(){gu.prototype.init.apply(this,arguments),this.mergeOption({})},mergeOption:function(t){t&&v(this.option,t,!0),this._initDimensions()},contains:function(t,e){var n=t.get("parallelIndex");return null!=n&&e.getComponent("parallel",n)===this},setAxisExpand:function(t){k(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(e){t.hasOwnProperty(e)&&(this.option[e]=t[e])},this)},_initDimensions:function(){var t=this.dimensions=[],e=this.parallelAxisIndex=[];k(D(this.dependentModels.parallelAxis,function(t){return(t.get("parallelIndex")||0)===this.componentIndex},this),function(n){t.push("dim"+n.get("dim")),e.push(n.componentIndex)})}}),eh({type:"axisAreaSelect",event:"axisAreaSelected"},function(t,e){e.eachComponent({mainType:"parallelAxis",query:t},function(e){e.axis.model.setActiveIntervals(t.intervals)})}),eh("parallelAxisExpand",function(t,e){e.eachComponent({mainType:"parallel",query:t},function(e){e.setAxisExpand(t)})});var B_=E,z_=k,V_=A,F_=Math.min,H_=Math.max,W_=Math.pow,j_={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},G_={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},U_={brushStyle:{lineWidth:2,stroke:"rgba(0,0,0,0.3)",fill:"rgba(0,0,0,0.1)"},transformable:!0,brushMode:"single",removeOnClick:!1},q_=0;function X_(t){kt.call(this),this._zr=t,this.group=new Cn,this._track=[],this._covers=[],this._uid="brushController_"+q_++,this._handlers={},z_(xw,function(t,e){this._handlers[e]=P(t,this)},this)}function Y_(t,e){var n=_w[e.brushType].createCover(t,e);return n.__brushOption=e,K_(n,e),t.group.add(n),n}function $_(t,e){var n=Q_(e);return n.endCreating&&(n.endCreating(t,e),K_(e,e.__brushOption)),e}function Z_(t,e){var n=e.__brushOption;Q_(e).updateCoverShape(t,e,n.range,n)}function K_(t,e){var n=e.z;null==n&&(n=1e4),t.traverse(function(t){t.z=n,t.z2=n})}function J_(t,e){Q_(e).updateCommon(t,e),Z_(t,e)}function Q_(t){return _w[t.__brushOption.brushType]}function tw(t,e,n){var r,i=t._panels;if(!i)return!0;var o=t._transform;return z_(i,function(t){t.isTargetByCursor(e,n,o)&&(r=t)}),r}function ew(t,e){var n=t._panels;if(!n)return!0;var r=e.__brushOption.panelId;return null==r||n[r]}function nw(t){var e=t._covers,n=e.length;return z_(e,function(e){t.group.remove(e)},t),e.length=0,!!n}function rw(t,e){var n=V_(t._covers,function(t){var e=t.__brushOption,n=m(e.range);return{brushType:e.brushType,panelId:e.panelId,range:n}});t.trigger("brush",n,{isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick})}function iw(t){var e=t.length-1;return e<0&&(e=0),[t[0],t[e]]}function ow(t,e,n,r){var i=new Cn;return i.add(new Ua({name:"main",style:uw(n),silent:!0,draggable:!0,cursor:"move",drift:B_(t,e,i,"nswe"),ondragend:B_(rw,e,{isEnd:!0})})),z_(r,function(n){i.add(new Ua({name:n,style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:B_(t,e,i,n),ondragend:B_(rw,e,{isEnd:!0})}))}),i}function aw(t,e,n,r){var i=r.brushStyle.lineWidth||0,o=H_(i,6),a=n[0][0],s=n[1][0],l=a-i/2,u=s-i/2,c=n[0][1],d=n[1][1],f=c-o+i/2,h=d-o+i/2,p=c-a,g=d-s,m=p+i,v=g+i;lw(t,e,"main",a,s,p,g),r.transformable&&(lw(t,e,"w",l,u,o,v),lw(t,e,"e",f,u,o,v),lw(t,e,"n",l,u,m,o),lw(t,e,"s",l,h,m,o),lw(t,e,"nw",l,u,o,o),lw(t,e,"ne",f,u,o,o),lw(t,e,"sw",l,h,o,o),lw(t,e,"se",f,h,o,o))}function sw(t,e){var n=e.__brushOption,r=n.transformable,i=e.childAt(0);i.useStyle(uw(n)),i.attr({silent:!r,cursor:r?"move":"default"}),z_(["w","e","n","s","se","sw","ne","nw"],function(n){var i=e.childOfName(n),o=function t(e,n){return 1<n.length?("e"!==(r=[t(e,(n=n.split(""))[0]),t(e,n[1])])[0]&&"w"!==r[0]||r.reverse(),r.join("")):{left:"w",right:"e",top:"n",bottom:"s"}[r=Qs({w:"left",e:"right",n:"top",s:"bottom"}[n],Ks(e.group))];var r}(t,n);i&&i.attr({silent:!r,invisible:!r,cursor:r?G_[o]+"-resize":null})})}function lw(t,e,n,r,i,o,a){var s=e.childOfName(n);s&&s.setShape(function(t){var e=F_(t[0][0],t[1][0]),n=F_(t[0][1],t[1][1]);return{x:e,y:n,width:H_(t[0][0],t[1][0])-e,height:H_(t[0][1],t[1][1])-n}}(pw(t,e,[[r,i],[r+o,i+a]])))}function uw(t){return b({strokeNoScale:!0},t.brushStyle)}function cw(t,e,n,r){var i=[F_(t,n),F_(e,r)],o=[H_(t,n),H_(e,r)];return[[i[0],o[0]],[i[1],o[1]]]}function dw(t,e,n,r,i,o,a,s){var l=r.__brushOption,u=t(l.range),c=hw(n,o,a);z_(i.split(""),function(t){var e=j_[t];u[e[0]][e[1]]+=c[e[0]]}),l.range=e(cw(u[0][0],u[1][0],u[0][1],u[1][1])),J_(n,r),rw(n,{isEnd:!1})}function fw(t,e,n,r,i){var o=e.__brushOption.range,a=hw(t,n,r);z_(o,function(t){t[0]+=a[0],t[1]+=a[1]}),J_(t,e),rw(t,{isEnd:!1})}function hw(t,e,n){var r=t.group,i=r.transformCoordToLocal(e,n),o=r.transformCoordToLocal(0,0);return[i[0]-o[0],i[1]-o[1]]}function pw(t,e,n){var r=ew(t,e);return r&&!0!==r?r.clipPath(n,t._transform):m(n)}function gw(t){var e=t.event;e.preventDefault&&e.preventDefault()}function mw(t,e,n){return t.childOfName("main").contain(e,n)}function vw(t,e,n,r){var i,o=t._creatingCover,a=t._creatingPanel,s=t._brushOption;if(t._track.push(n.slice()),function(t){var e=t._track;if(!e.length)return!1;var n=e[e.length-1],r=e[0],i=n[0]-r[0],o=n[1]-r[1];return 6<W_(i*i+o*o,.5)}(t)||o){if(a&&!o){"single"===s.brushMode&&nw(t);var l=m(s);l.brushType=yw(l.brushType,a),l.panelId=!0===a?null:a.panelId,o=t._creatingCover=Y_(t,l),t._covers.push(o)}if(o){var u=_w[yw(t._brushType,a)];o.__brushOption.range=u.getCreatingRange(pw(t,o,t._track)),r&&($_(t,o),u.updateCommon(t,o)),Z_(t,o),i={isEnd:r}}}else r&&"single"===s.brushMode&&s.removeOnClick&&tw(t,e,n)&&nw(t)&&(i={isEnd:r,removeOnClick:!0});return i}function yw(t,e){return"auto"===t?e.defaultBrushType:t}X_.prototype={constructor:X_,enableBrush:function(t){return this._brushType&&function(t){var e=t._zr;(function(t,e,n){var r=dy(t);r[e]===n&&(r[e]=null)})(e,"globalPan",t._uid),function(t,e){z_(e,function(e,n){t.off(n,e)})}(e,t._handlers),t._brushType=t._brushOption=null}(this),t.brushType&&function(t,e){var n=t._zr;t._enableGlobalPan||function(t,e,n){dy(t).globalPan=n}(n,0,t._uid),function(t,e){z_(e,function(e,n){t.on(n,e)})}(n,t._handlers),t._brushType=e.brushType,t._brushOption=v(m(U_),e,!0)}(this,t),this},setPanels:function(t){if(t&&t.length){var e=this._panels={};k(t,function(t){e[t.panelId]=m(t)})}else this._panels=null;return this},mount:function(t){this._enableGlobalPan=(t=t||{}).enableGlobalPan;var e=this.group;return this._zr.add(e),e.attr({position:t.position||[0,0],rotation:t.rotation||0,scale:t.scale||[1,1]}),this._transform=e.getLocalTransform(),this},eachCover:function(t,e){z_(this._covers,t,e)},updateCovers:function(t){t=A(t,function(t){return v(m(U_),t,!0)});var e=this._covers,n=this._covers=[],r=this,i=this._creatingCover;return new fh(e,t,function(t,e){return o(t.__brushOption,e)},o).add(a).update(a).remove(function(t){e[t]!==i&&r.group.remove(e[t])}).execute(),this;function o(t,e){return(null!=t.id?t.id:"\0-brush-index-"+e)+"-"+t.brushType}function a(o,a){var s=t[o];if(null!=a&&e[a]===i)n[o]=e[a];else{var l=n[o]=null!=a?(e[a].__brushOption=s,e[a]):$_(r,Y_(r,s));J_(r,l)}}},unmount:function(){return this.enableBrush(!1),nw(this),this._zr.remove(this.group),this},dispose:function(){this.unmount(),this.off()}},M(X_,kt);var xw={mousedown:function(t){if(this._dragging)bw(this,t);else if(!t.target||!t.target.draggable){gw(t);var e=this.group.transformCoordToLocal(t.offsetX,t.offsetY);this._creatingCover=null,(this._creatingPanel=tw(this,t,e))&&(this._dragging=!0,this._track=[e.slice()])}},mousemove:function(t){var e=this.group.transformCoordToLocal(t.offsetX,t.offsetY);if(function(t,e,n){if(t._brushType&&!function(t,e,n){var r=t._zr;return e<0||e>r.getWidth()||void 0>r.getHeight()}(t,e)){var r=t._zr,i=t._covers,o=tw(t,e,n);if(!t._dragging)for(var a=0;a<i.length;a++){var s=i[a].__brushOption;if(o&&(!0===o||s.panelId===o.panelId)&&_w[s.brushType].contain(i[a],n[0],n[1]))return}o&&r.setCursorStyle("crosshair")}}(this,t,e),this._dragging){gw(t);var n=vw(this,t,e,!1);n&&rw(this,n)}},mouseup:function(t){bw(this,t)}};function bw(t,e){if(t._dragging){gw(e);var n=t.group.transformCoordToLocal(e.offsetX,e.offsetY),r=vw(t,e,n,!0);t._dragging=!1,t._track=[],t._creatingCover=null,r&&rw(t,r)}}var _w={lineX:ww(0),lineY:ww(1),rect:{createCover:function(t,e){return ow(B_(dw,function(t){return t},function(t){return t}),t,e,["w","e","n","s","se","sw","ne","nw"])},getCreatingRange:function(t){var e=iw(t);return cw(e[1][0],e[1][1],e[0][0],e[0][1])},updateCoverShape:function(t,e,n,r){aw(t,e,n,r)},updateCommon:sw,contain:mw},polygon:{createCover:function(t,e){var n=new Cn;return n.add(new Va({name:"main",style:uw(e),silent:!0})),n},getCreatingRange:function(t){return t},endCreating:function(t,e){e.remove(e.childAt(0)),e.add(new za({name:"main",draggable:!0,drift:B_(fw,t,e),ondragend:B_(rw,t,{isEnd:!0})}))},updateCoverShape:function(t,e,n,r){e.childAt(0).setShape({points:pw(t,e,n)})},updateCommon:sw,contain:mw}};function ww(t){return{createCover:function(e,n){return ow(B_(dw,function(e){var n=[e,[0,100]];return t&&n.reverse(),n},function(e){return e[t]}),e,n,[["w","e"],["n","s"]][t])},getCreatingRange:function(e){var n=iw(e);return[F_(n[0][t],n[1][t]),H_(n[0][t],n[1][t])]},updateCoverShape:function(e,n,r,i){var o,a=ew(e,n);if(!0!==a&&a.getLinearBrushOtherExtent)o=a.getLinearBrushOtherExtent(t,e._transform);else{var s=e._zr;o=[0,[s.getWidth(),s.getHeight()][1-t]]}var l=[r,o];t&&l.reverse(),aw(e,n,l,i)},updateCommon:sw,contain:mw}}function Sw(t){return t=Tw(t),function(e,n){return el(e,t)}}function Cw(t,e){return t=Tw(t),function(n){var r=null!=e?e:n,i=r?t.x:t.y;return[i,i+((r?t.width:t.height)||0)]}}function Mw(t,e,n){return t=Tw(t),function(r,i,o){return t.contain(i[0],i[1])&&!Cy(r,e,n)}}function Tw(t){return Sn.create(t)}var kw=["axisLine","axisTickLabel","axisName"],Aw=lh({type:"parallelAxis",init:function(t,e){Aw.superApply(this,"init",arguments),(this._brushController=new X_(e.getZr())).on("brush",P(this._onBrush,this))},render:function(t,e,n,r){if(!function(t,e,n){return n&&"axisAreaSelect"===n.type&&e.findComponents({mainType:"parallelAxis",query:n})[0]===t}(t,e,r)){this.axisModel=t,this.api=n,this.group.removeAll();var i=this._axisGroup;if(this._axisGroup=new Cn,this.group.add(this._axisGroup),t.get("show")){var o=function(t,e){return e.getComponent("parallel",t.get("parallelIndex"))}(t,e),a=o.coordinateSystem,s=t.getAreaSelectStyle(),l=s.width,u=x({strokeContainThreshold:l},a.getAxisLayout(t.axis.dim)),c=new Am(t,u);k(kw,c.add,c),this._axisGroup.add(c.getGroup()),this._refreshBrushController(u,s,t,o,l,n),tl(i,this._axisGroup,r&&!1===r.animation?null:t)}}},_refreshBrushController:function(t,e,n,r,i,o){var a=n.axis.getExtent(),s=a[1]-a[0],l=Math.min(30,.1*Math.abs(s)),u=Sn.create({x:a[0],y:-i/2,width:s,height:i});u.x-=l,u.width+=2*l,this._brushController.mount({enableGlobalPan:!0,rotation:t.rotation,position:t.position}).setPanels([{panelId:"pl",clipPath:Sw(u),isTargetByCursor:Mw(u,o,r),getLinearBrushOtherExtent:Cw(u,0)}]).enableBrush({brushType:"lineX",brushStyle:e,removeOnClick:!0}).updateCovers(function(t){var e=t.axis;return A(t.activeIntervals,function(t){return{brushType:"lineX",panelId:"pl",range:[e.dataToCoord(t[0],!0),e.dataToCoord(t[1],!0)]}})}(n))},_onBrush:function(t,e){var n=this.axisModel,r=n.axis,i=A(t,function(t){return[r.coordToData(t.range[0],!0),r.coordToData(t.range[1],!0)]});!n.option.realtime!==e.isEnd&&!e.removeOnClick||this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:n.id,intervals:i})},dispose:function(){this._brushController.dispose()}});lh({type:"parallel",render:function(t,e,n){this._model=t,this._api=n,this._handlers||(this._handlers={},k(Iw,function(t,e){n.getZr().on(e,this._handlers[e]=P(t,this))},this)),hd(this,"_throttledDispatchExpand",t.get("axisExpandRate"),"fixRate")},dispose:function(t,e){k(this._handlers,function(t,n){e.getZr().off(n,t)}),this._handlers=null},_throttledDispatchExpand:function(t){this._dispatchExpand(t)},_dispatchExpand:function(t){t&&this._api.dispatchAction(x({type:"parallelAxisExpand"},t))}});var Iw={mousedown:function(t){Dw(this,"click")&&(this._mouseDownPoint=[t.offsetX,t.offsetY])},mouseup:function(t){var e=this._mouseDownPoint;if(Dw(this,"click")&&e){var n=[t.offsetX,t.offsetY];if(5<Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))return;var r=this._model.coordinateSystem.getSlidedAxisExpandWindow([t.offsetX,t.offsetY]);"none"!==r.behavior&&this._dispatchExpand({axisExpandWindow:r.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(t){if(!this._mouseDownPoint&&Dw(this,"mousemove")){var e=this._model,n=e.coordinateSystem.getSlidedAxisExpandWindow([t.offsetX,t.offsetY]),r=n.behavior;"jump"===r&&this._throttledDispatchExpand.debounceNextCall(e.get("axisExpandDebounce")),this._throttledDispatchExpand("none"===r?null:{axisExpandWindow:n.axisExpandWindow,animation:"jump"===r&&null})}}};function Dw(t,e){var n=t._model;return n.get("axisExpandable")&&n.get("axisExpandTriggerOn")===e}function Ow(t,e,n,r){for(var i,o=[],a=0;a<n.length;a++){var s=n[a],l=t.get(t.mapDimension(s),e);i=l,("category"===r.getAxis(s).type?null==i:null==i||isNaN(i))||o.push(r.dataToPoint(l,s))}return o}function Pw(t,e,n,r,i){var o=Ow(t,n,r,i),a=new Va({shape:{points:o},silent:!0,z2:10});return e.add(a),t.setItemGraphicEl(n,a),a}function Ew(t){var e=t.get("smooth",!0);return!0===e&&(e=.3),{lineStyle:t.getModel("lineStyle").getLineStyle(),smooth:null!=e?e:.3}}function Rw(t,e,n,r){var i=r.lineStyle;e.hasItemOption&&(i=e.getItemModel(n).getModel("lineStyle").getLineStyle()),t.useStyle(i);var o=t.style;o.fill=null,o.stroke=e.getItemVisual(n,"color"),o.opacity=e.getItemVisual(n,"opacity"),r.smooth&&(t.shape.smooth=r.smooth)}Qf(function(t){!function(t){if(!t.parallel){var e=!1;k(t.series,function(t){t&&"parallel"===t.type&&(e=!0)}),e&&(t.parallel=[{}])}}(t),function(t){k(Ti(t.parallelAxis),function(e){if(B(e)){var n=e.parallelIndex||0,r=Ti(t.parallel)[n];r&&r.parallelAxisDefault&&v(e,r.parallelAxisDefault,!1)}})}(t)}),jc.extend({type:"series.parallel",dependencies:["parallel"],visualColorAccessPath:"lineStyle.color",getInitialData:function(t,e){var n=this.getSource();return function(t,e){if(!t.encodeDefine){var n=e.ecModel.getComponent("parallel",e.get("parallelIndex"));if(n){var r=t.encodeDefine=Q();k(n.dimensions,function(t){var e=function(t){return+t.replace("dim","")}(t);r.set(t,e)})}}}(n,this),$h(n,this)},getRawIndicesByActiveState:function(t){var e=this.coordinateSystem,n=this.getData(),r=[];return e.eachActiveState(n,function(e,i){t===e&&r.push(n.getRawIndex(i))}),r},defaultOption:{zlevel:0,z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"}}),nd.extend({type:"parallel",init:function(){this._dataGroup=new Cn,this.group.add(this._dataGroup)},render:function(t,e,n,r){var i=this._dataGroup,o=t.getData(),a=this._data,s=t.coordinateSystem,l=s.dimensions,u=Ew(t);if(o.diff(a).add(function(t){Rw(Pw(o,i,t,l,s),o,t,u)}).update(function(e,n){var i=a.getItemGraphicEl(n),c=Ow(o,e,l,s);o.setItemGraphicEl(e,i),$s(i,{shape:{points:c}},r&&!1===r.animation?null:t,e),Rw(i,o,e,u)}).remove(function(t){var e=a.getItemGraphicEl(t);i.remove(e)}).execute(),!this._initialized){this._initialized=!0;var c=function(t,e,n){var r=t.model,i=t.getRect(),o=new Ua({shape:{x:i.x,y:i.y,width:i.width,height:i.height}}),a="horizontal"===r.get("layout")?"width":"height";return o.setShape(a,0),Zs(o,{shape:{width:i.width,height:i.height}},e,n),o}(s,t,function(){setTimeout(function(){i.removeClipPath()})});i.setClipPath(c)}this._data=o},incrementalPrepareRender:function(t,e,n){this._initialized=!0,this._data=null,this._dataGroup.removeAll()},incrementalRender:function(t,e,n){for(var r=e.getData(),i=e.coordinateSystem,o=i.dimensions,a=Ew(e),s=t.start;s<t.end;s++){var l=Pw(r,this._dataGroup,s,o,i);l.incremental=!0,Rw(l,r,s,a)}},dispose:function(){},remove:function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null}});var Lw=["lineStyle","normal","opacity"];ih({seriesType:"parallel",reset:function(t,e,n){var r=t.getModel("itemStyle"),i=t.getModel("lineStyle"),o=e.get("color"),a=i.get("color")||r.get("color")||o[t.seriesIndex%o.length],s=t.get("inactiveOpacity"),l=t.get("activeOpacity"),u=t.getModel("lineStyle").getLineStyle(),c=t.coordinateSystem,d=t.getData(),f={normal:u.opacity,active:l,inactive:s};return d.setVisual("color",a),{progress:function(t,e){c.eachActiveState(e,function(t,n){var r=f[t];if("normal"===t&&e.hasItemOption){var i=e.getItemModel(n).get(Lw,!0);null!=i&&(r=i)}e.setItemVisual(n,"opacity",r)},t.start,t.end)}}}});var Nw=jc.extend({type:"series.sankey",layoutInfo:null,levelModels:null,getInitialData:function(t,e){for(var n=t.edges||t.links,r=t.data||t.nodes,i=t.levels,o=this.levelModels={},a=0;a<i.length;a++)null!=i[a].depth&&0<=i[a].depth&&(o[i[a].depth]=new hl(i[a],this,e));if(r&&n)return _b(r,n,this,!0,function(t,e){t.wrapMethod("getItemModel",function(t,e){return t.customizeGetParent(function(t){var n=this.parentModel,r=n.getData().getItemLayout(e).depth;return n.levelModels[r]||this.parentModel}),t}),e.wrapMethod("getItemModel",function(t,e){return t.customizeGetParent(function(t){var n=this.parentModel,r=n.getGraph().getEdgeByIndex(e).node1.getLayout().depth;return n.levelModels[r]||this.parentModel}),t})}).data},setNodePosition:function(t,e){var n=this.option.data[t];n.localX=e[0],n.localY=e[1]},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},formatTooltip:function(t,e,n){if("edge"===n){var r=this.getDataParams(t,n),i=r.data,o=i.source+" -- "+i.target;return r.value&&(o+=" : "+r.value),jl(o)}if("node"!==n)return Nw.superCall(this,"formatTooltip",t,e);var a=this.getGraph().getNodeByIndex(t).getLayout().value,s=this.getDataParams(t,n).data.name;return a&&(o=s+" : "+a),jl(o)},optionUpdated:function(){var t=this.option;!0===t.focusNodeAdjacency&&(t.focusNodeAdjacency="allEdges")},getDataParams:function(t,e){var n=Nw.superCall(this,"getDataParams",t,e);if(null==n.value&&"node"===e){var r=this.getGraph().getNodeByIndex(t).getLayout().value;n.value=r}return n},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",layout:null,left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,focusNodeAdjacency:!1,layoutIterations:32,label:{show:!0,position:"right",color:"#000",fontSize:12},levels:[],nodeAlign:"justify",itemStyle:{borderWidth:1,borderColor:"#333"},lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},animationEasing:"linear",animationDuration:1e3}}),Bw=["itemStyle","opacity"],zw=["emphasis","itemStyle","opacity"],Vw=["lineStyle","opacity"],Fw=["emphasis","lineStyle","opacity"];function Hw(t,e){return t.getVisual("opacity")||t.getModel().get(e)}function Ww(t,e,n){var r=t.getGraphicEl(),i=Hw(t,e);null!=n&&(null==i&&(i=1),i*=n),r.downplay&&r.downplay(),r.traverse(function(t){"group"!==t.type&&t.setStyle("opacity",i)})}function jw(t,e){var n=Hw(t,e),r=t.getGraphicEl();r.traverse(function(t){"group"!==t.type&&t.setStyle("opacity",n)}),r.highlight&&r.highlight()}var Gw=hs({shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,cpx2:0,cpy2:0,extent:0,orient:""},buildPath:function(t,e){var n=e.extent;t.moveTo(e.x1,e.y1),t.bezierCurveTo(e.cpx1,e.cpy1,e.cpx2,e.cpy2,e.x2,e.y2),"vertical"===e.orient?(t.lineTo(e.x2+n,e.y2),t.bezierCurveTo(e.cpx2+n,e.cpy2,e.cpx1+n,e.cpy1,e.x1+n,e.y1)):(t.lineTo(e.x2,e.y2+n),t.bezierCurveTo(e.cpx2,e.cpy2+n,e.cpx1,e.cpy1+n,e.x1,e.y1+n)),t.closePath()},highlight:function(){this.trigger("emphasis")},downplay:function(){this.trigger("normal")}});function Uw(t){var e=t.hostGraph.data.getRawDataItem(t.dataIndex);return null!=e.depth&&0<=e.depth}function qw(t,e,n,r,i){var o="vertical"===i?"x":"y";k(t,function(t){var a,s,l;t.sort(function(t,e){return t.getLayout()[o]-e.getLayout()[o]});for(var u=0,c=t.length,d="vertical"===i?"dx":"dy",f=0;f<c;f++)0<(l=u-(s=t[f]).getLayout()[o])&&(a=s.getLayout()[o]+l,s.setLayout("vertical"===i?{x:a}:{y:a},!0)),u=s.getLayout()[o]+s.getLayout()[d]+e;if(0<(l=u-e-("vertical"===i?r:n)))for(a=s.getLayout()[o]-l,s.setLayout("vertical"===i?{x:a}:{y:a},!0),u=a,f=c-2;0<=f;--f)0<(l=(s=t[f]).getLayout()[o]+s.getLayout()[d]+e-u)&&(a=s.getLayout()[o]-l,s.setLayout("vertical"===i?{x:a}:{y:a},!0)),u=s.getLayout()[o]})}function Xw(t,e,n){k(t.slice().reverse(),function(t){k(t,function(t){if(t.outEdges.length){var r=tS(t.outEdges,Yw,n)/tS(t.outEdges,Qw,n);if(isNaN(r)){var i=t.outEdges.length;r=i?tS(t.outEdges,$w,n)/i:0}if("vertical"===n){var o=t.getLayout().x+(r-Jw(t,n))*e;t.setLayout({x:o},!0)}else{var a=t.getLayout().y+(r-Jw(t,n))*e;t.setLayout({y:a},!0)}}})})}function Yw(t,e){return Jw(t.node2,e)*t.getValue()}function $w(t,e){return Jw(t.node2,e)}function Zw(t,e){return Jw(t.node1,e)*t.getValue()}function Kw(t,e){return Jw(t.node1,e)}function Jw(t,e){return"vertical"===e?t.getLayout().x+t.getLayout().dx/2:t.getLayout().y+t.getLayout().dy/2}function Qw(t){return t.getValue()}function tS(t,e,n){for(var r=0,i=t.length,o=-1;++o<i;){var a=+e.call(t,t[o],n);isNaN(a)||(r+=a)}return r}function eS(t,e,n){k(t,function(t){k(t,function(t){if(t.inEdges.length){var r=tS(t.inEdges,Zw,n)/tS(t.inEdges,Qw,n);if(isNaN(r)){var i=t.inEdges.length;r=i?tS(t.inEdges,Kw,n)/i:0}if("vertical"===n){var o=t.getLayout().x+(r-Jw(t,n))*e;t.setLayout({x:o},!0)}else{var a=t.getLayout().y+(r-Jw(t,n))*e;t.setLayout({y:a},!0)}}})})}ch({type:"sankey",_model:null,_focusAdjacencyDisabled:!1,render:function(t,e,n){var r=this,i=t.getGraph(),o=this.group,a=t.layoutInfo,s=a.width,l=a.height,u=t.getData(),c=t.getData("edge"),d=t.get("orient");this._model=t,o.removeAll(),o.attr("position",[a.x,a.y]),i.eachEdge(function(e){var n=new Gw;n.dataIndex=e.dataIndex,n.seriesIndex=t.seriesIndex,n.dataType="edge";var r,i,a,u,f,h,p,g,m=e.getModel("lineStyle"),v=m.get("curveness"),y=e.node1.getLayout(),x=e.node1.getModel(),b=x.get("localX"),_=x.get("localY"),w=e.node2.getLayout(),S=e.node2.getModel(),C=S.get("localX"),M=S.get("localY"),T=e.getLayout();switch(n.shape.extent=Math.max(1,T.dy),g="vertical"===(n.shape.orient=d)?(f=r=(null!=b?b*s:y.x)+T.sy,h=(i=(null!=_?_*l:y.y)+y.dy)*(1-v)+(u=null!=M?M*l:w.y)*v,p=a=(null!=C?C*s:w.x)+T.ty,i*v+u*(1-v)):(f=(r=(null!=b?b*s:y.x)+y.dx)*(1-v)+(a=null!=C?C*s:w.x)*v,h=i=(null!=_?_*l:y.y)+T.sy,p=r*v+a*(1-v),u=(null!=M?M*l:w.y)+T.ty),n.setShape({x1:r,y1:i,x2:a,y2:u,cpx1:f,cpy1:h,cpx2:p,cpy2:g}),n.setStyle(m.getItemStyle()),n.style.fill){case"source":n.style.fill=e.node1.getVisual("color");break;case"target":n.style.fill=e.node2.getVisual("color")}Ls(n,e.getModel("emphasis.lineStyle").getItemStyle()),o.add(n),c.setItemGraphicEl(e.dataIndex,n)}),i.eachNode(function(e){var n=e.getLayout(),r=e.getModel(),i=r.get("localX"),a=r.get("localY"),c=r.getModel("label"),d=r.getModel("emphasis.label"),f=new Ua({shape:{x:null!=i?i*s:n.x,y:null!=a?a*l:n.y,width:n.dx,height:n.dy},style:r.getModel("itemStyle").getItemStyle()}),h=e.getModel("emphasis.itemStyle").getItemStyle();Vs(f.style,h,c,d,{labelFetcher:t,labelDataIndex:e.dataIndex,defaultText:e.id,isRectText:!0}),f.setStyle("fill",e.getVisual("color")),Ls(f,h),o.add(f),u.setItemGraphicEl(e.dataIndex,f),f.dataType="node"}),u.eachItemGraphicEl(function(e,i){var o=u.getItemModel(i);o.get("draggable")&&(e.drift=function(e,o){r._focusAdjacencyDisabled=!0,this.shape.x+=e,this.shape.y+=o,this.dirty(),n.dispatchAction({type:"dragNode",seriesId:t.id,dataIndex:u.getRawIndex(i),localX:this.shape.x/s,localY:this.shape.y/l})},e.ondragend=function(){r._focusAdjacencyDisabled=!1},e.draggable=!0,e.cursor="move"),e.highlight=function(){this.trigger("emphasis")},e.downplay=function(){this.trigger("normal")},e.focusNodeAdjHandler&&e.off("mouseover",e.focusNodeAdjHandler),e.unfocusNodeAdjHandler&&e.off("mouseout",e.unfocusNodeAdjHandler),o.get("focusNodeAdjacency")&&(e.on("mouseover",e.focusNodeAdjHandler=function(){r._focusAdjacencyDisabled||(r._clearTimer(),n.dispatchAction({type:"focusNodeAdjacency",seriesId:t.id,dataIndex:e.dataIndex}))}),e.on("mouseout",e.unfocusNodeAdjHandler=function(){r._focusAdjacencyDisabled||r._dispatchUnfocus(n)}))}),c.eachItemGraphicEl(function(e,i){var o=c.getItemModel(i);e.focusNodeAdjHandler&&e.off("mouseover",e.focusNodeAdjHandler),e.unfocusNodeAdjHandler&&e.off("mouseout",e.unfocusNodeAdjHandler),o.get("focusNodeAdjacency")&&(e.on("mouseover",e.focusNodeAdjHandler=function(){r._focusAdjacencyDisabled||(r._clearTimer(),n.dispatchAction({type:"focusNodeAdjacency",seriesId:t.id,edgeDataIndex:e.dataIndex}))}),e.on("mouseout",e.unfocusNodeAdjHandler=function(){r._focusAdjacencyDisabled||r._dispatchUnfocus(n)}))}),!this._data&&t.get("animation")&&o.setClipPath(function(t,e,n){var r=new Ua({shape:{x:t.x-10,y:t.y-10,width:0,height:t.height+20}});return Zs(r,{shape:{width:t.width+20}},e,function(){o.removeClipPath()}),r}(o.getBoundingRect(),t)),this._data=t.getData()},dispose:function(){this._clearTimer()},_dispatchUnfocus:function(t){var e=this;this._clearTimer(),this._unfocusDelayTimer=setTimeout(function(){e._unfocusDelayTimer=null,t.dispatchAction({type:"unfocusNodeAdjacency",seriesId:e._model.id})},500)},_clearTimer:function(){this._unfocusDelayTimer&&(clearTimeout(this._unfocusDelayTimer),this._unfocusDelayTimer=null)},focusNodeAdjacency:function(t,e,n,r){var i=t.getData(),o=i.graph,a=r.dataIndex,s=i.getItemModel(a),l=r.edgeDataIndex;if(null!=a||null!=l){var u=o.getNodeByIndex(a),c=o.getEdgeByIndex(l);if(o.eachNode(function(t){Ww(t,Bw,.1)}),o.eachEdge(function(t){Ww(t,Vw,.1)}),u){jw(u,zw);var d=s.get("focusNodeAdjacency");"outEdges"===d?k(u.outEdges,function(t){t.dataIndex<0||(jw(t,Fw),jw(t.node2,zw))}):"inEdges"===d?k(u.inEdges,function(t){t.dataIndex<0||(jw(t,Fw),jw(t.node1,zw))}):"allEdges"===d&&k(u.edges,function(t){t.dataIndex<0||(jw(t,Fw),t.node1!==u&&jw(t.node1,zw),t.node2!==u&&jw(t.node2,zw))})}c&&(jw(c,Fw),jw(c.node1,zw),jw(c.node2,zw))}},unfocusNodeAdjacency:function(t,e,n,r){var i=t.getGraph();i.eachNode(function(t){Ww(t,Bw)}),i.eachEdge(function(t){Ww(t,Vw)})}}),eh({type:"dragNode",event:"dragnode",update:"update"},function(t,e){e.eachComponent({mainType:"series",subType:"sankey",query:t},function(e){e.setNodePosition(t.dataIndex,[t.localX,t.localY])})}),rh(function(t,e,n){t.eachSeriesByType("sankey",function(t){var n=t.get("nodeWidth"),r=t.get("nodeGap"),i=function(t,e){return au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}(t,e),o=(t.layoutInfo=i).width,a=i.height,s=t.getGraph(),l=s.nodes,u=s.edges;!function(t){k(t,function(t){var e=tS(t.outEdges,Qw),n=tS(t.inEdges,Qw),r=t.getValue()||0,i=Math.max(e,n,r);t.setLayout({value:i},!0)})}(l),function(t,e,n,r,i,o,a,s,l){(function(t,e,n,r,i,o,a){for(var s=[],l=[],u=[],c=[],d=0,f=0;f<e.length;f++)s[f]=1;for(f=0;f<t.length;f++)l[f]=t[f].inEdges.length,0===l[f]&&u.push(t[f]);for(var h=-1;u.length;){for(var p=0;p<u.length;p++){var g=u[p],m=g.hostGraph.data.getRawDataItem(g.dataIndex),v=null!=m.depth&&0<=m.depth;v&&m.depth>h&&(h=m.depth),g.setLayout({depth:v?m.depth:d},!0),g.setLayout("vertical"===o?{dy:n}:{dx:n},!0);for(var y=0;y<g.outEdges.length;y++){var x=g.outEdges[y];s[e.indexOf(x)]=0;var b=x.node2;0==--l[t.indexOf(b)]&&c.indexOf(b)<0&&c.push(b)}}++d,u=c,c=[]}for(f=0;f<s.length;f++)if(1===s[f])throw new Error("Sankey is a DAG, the original data has cycle!");var _=d-1<h?h:d-1;a&&"left"!==a&&function(t,e,n,r){if("right"===e){for(var i=[],o=t,a=0;o.length;){for(var s=0;s<o.length;s++){var l=o[s];l.setLayout({skNodeHeight:a},!0);for(var u=0;u<l.inEdges.length;u++){var c=l.inEdges[u];i.indexOf(c.node1)<0&&i.push(c.node1)}}o=i,i=[],++a}k(t,function(t){Uw(t)||t.setLayout({depth:Math.max(0,r-t.getLayout().skNodeHeight)},!0)})}else"justify"===e&&function(t,e){k(t,function(t){Uw(t)||t.outEdges.length||t.setLayout({depth:e},!0)})}(t,r)}(t,a,0,_),function(t,e,n){k(t,function(t){var r=t.getLayout().depth*e;t.setLayout("vertical"===n?{y:r}:{x:r},!0)})}(t,"vertical"===o?(i-n)/_:(r-n)/_,o)})(t,e,n,i,o,s,l),function(t,e,n,r,i,o,a){var s=function(t,e){var n=[],r="vertical"===e?"y":"x",i=Hi(t,function(t){return t.getLayout()[r]});return i.keys.sort(function(t,e){return t-e}),k(i.keys,function(t){n.push(i.buckets.get(t))}),n}(t,a);(function(t,e,n,r,i,o){var a=1/0;k(t,function(t){var e=t.length,s=0;k(t,function(t){s+=t.getLayout().value});var l="vertical"===o?(r-(e-1)*i)/s:(n-(e-1)*i)/s;l<a&&(a=l)}),k(t,function(t){k(t,function(t,e){var n=t.getLayout().value*a;"vertical"===o?(t.setLayout({x:e},!0),t.setLayout({dx:n},!0)):(t.setLayout({y:e},!0),t.setLayout({dy:n},!0))})}),k(e,function(t){var e=+t.getValue()*a;t.setLayout({dy:e},!0)})})(s,e,n,r,i,a),qw(s,i,n,r,a);for(var l=1;0<o;o--)Xw(s,l*=.99,a),qw(s,i,n,r,a),eS(s,l,a),qw(s,i,n,r,a)}(t,e,o,i,r,a,s),function(t,e){var n="vertical"===e?"x":"y";k(t,function(t){t.outEdges.sort(function(t,e){return t.node2.getLayout()[n]-e.node2.getLayout()[n]}),t.inEdges.sort(function(t,e){return t.node1.getLayout()[n]-e.node1.getLayout()[n]})}),k(t,function(t){var e=0,n=0;k(t.outEdges,function(t){t.setLayout({sy:e},!0),e+=t.getLayout().dy}),k(t.inEdges,function(t){t.setLayout({ty:n},!0),n+=t.getLayout().dy})})}(t,s)}(l,u,n,r,o,a,0!==D(l,function(t){return 0===t.getLayout().value}).length?0:t.get("layoutIterations"),t.get("orient"),t.get("nodeAlign"))})}),ih(function(t,e){t.eachSeriesByType("sankey",function(t){var e=t.getGraph().nodes;if(e.length){var n=1/0,r=-1/0;k(e,function(t){var e=t.getLayout().value;e<n&&(n=e),r<e&&(r=e)}),k(e,function(e){var i=new zx({type:"color",mappingMethod:"linear",dataExtent:[n,r],visual:t.get("color")}).mapValueToVisual(e.getLayout().value),o=e.getModel().get("itemStyle.color");e.setVisual("color",null!=o?o:i)})}})});var nS={_baseAxisDim:null,getInitialData:function(t,e){var n,r,i=e.getComponent("xAxis",this.get("xAxisIndex")),o=e.getComponent("yAxis",this.get("yAxisIndex")),a=i.get("type"),s=o.get("type");"category"===a?(t.layout="horizontal",n=i.getOrdinalMeta(),r=!0):"category"===s?(t.layout="vertical",n=o.getOrdinalMeta(),r=!0):t.layout=t.layout||"horizontal";var l=["x","y"],u="horizontal"===t.layout?0:1,c=this._baseAxisDim=l[u],d=l[1-u],f=[i,o],h=f[u].get("type"),p=f[1-u].get("type"),g=t.data;if(g&&r){var m=[];k(g,function(t,e){var n;t.value&&R(t.value)?(n=t.value.slice(),t.value.unshift(e)):R(t)?(n=t.slice(),t.unshift(e)):n=t,m.push(n)}),t.data=m}var v=this.defaultValueDimensions,y=[{name:c,type:mh(h),ordinalMeta:n,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:d,type:mh(p),dimsDef:v.slice()}];return _v(this,{coordDimensions:y,dimensionsCount:v.length+1,encodeDefaulter:E(Ru,y,this)})},getBaseAxis:function(){var t=this._baseAxisDim;return this.ecModel.getComponent(t+"Axis",this.get(t+"AxisIndex")).axis}};M(jc.extend({type:"series.boxplot",dependencies:["xAxis","yAxis","grid"],defaultValueDimensions:[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:2,shadowOffsetY:2,shadowColor:"rgba(0,0,0,0.4)"}},animationEasing:"elasticOut",animationDuration:800}}),nS,!0);var rS=["itemStyle"],iS=["emphasis","itemStyle"],oS=(nd.extend({type:"boxplot",render:function(t,e,n){var r=t.getData(),i=this.group,o=this._data;this._data||i.removeAll();var a="horizontal"===t.get("layout")?1:0;r.diff(o).add(function(t){if(r.hasValue(t)){var e=aS(r.getItemLayout(t),r,t,a,!0);r.setItemGraphicEl(t,e),i.add(e)}}).update(function(t,e){var n=o.getItemGraphicEl(e);if(r.hasValue(t)){var s=r.getItemLayout(t);n?sS(s,n,r,t):n=aS(s,r,t,a),i.add(n),r.setItemGraphicEl(t,n)}else i.remove(n)}).remove(function(t){var e=o.getItemGraphicEl(t);e&&i.remove(e)}).execute(),this._data=r},remove:function(t){var e=this.group,n=this._data;this._data=null,n&&n.eachItemGraphicEl(function(t){t&&e.remove(t)})},dispose:et}),ha.extend({type:"boxplotBoxPath",shape:{},buildPath:function(t,e){var n=e.points,r=0;for(t.moveTo(n[r][0],n[r][1]),r++;r<4;r++)t.lineTo(n[r][0],n[r][1]);for(t.closePath();r<n.length;r++)t.moveTo(n[r][0],n[r][1]),r++,t.lineTo(n[r][0],n[r][1])}}));function aS(t,e,n,r,i){var o=t.ends,a=new oS({shape:{points:i?function(t,e,n){return A(t,function(t){return(t=t.slice())[e]=n.initBaseline,t})}(o,r,t):o}});return sS(t,a,e,n,i),a}function sS(t,e,n,r,i){(0,al[i?"initProps":"updateProps"])(e,{shape:{points:t.ends}},n.hostModel,r);var o=n.getItemModel(r),a=o.getModel(rS),s=n.getItemVisual(r,"color"),l=a.getItemStyle(["borderColor"]);l.stroke=s,l.strokeNoScale=!0,e.useStyle(l),e.z2=100,Ls(e,o.getModel(iS).getItemStyle())}var lS=["itemStyle","borderColor"],uS=k;ih(function(t,e){var n=t.get("color");t.eachRawSeriesByType("boxplot",function(e){var r=n[e.seriesIndex%n.length],i=e.getData();i.setVisual({legendSymbol:"roundRect",color:e.get(lS)||r}),t.isSeriesFiltered(e)||i.each(function(t){var e=i.getItemModel(t);i.setItemVisual(t,{color:e.get(lS,!0)})})})}),rh(function(t){var e=function(t){var e=[],n=[];return t.eachSeriesByType("boxplot",function(t){var r=t.getBaseAxis(),i=S(n,r);i<0&&(n[i=n.length]=r,e[i]={axis:r,seriesModels:[]}),e[i].seriesModels.push(t)}),e}(t);uS(e,function(t){var e=t.seriesModels;e.length&&(function(t){var e,n,r=t.axis,i=t.seriesModels,o=i.length,a=t.boxWidthList=[],s=t.boxOffsetList=[],l=[];if("category"===r.type)n=r.getBandWidth();else{var u=0;uS(i,function(t){u=Math.max(u,t.getData().count())}),e=r.getExtent(),Math.abs(e[1]-e[0])}uS(i,function(t){var e=t.get("boxWidth");R(e)||(e=[e,e]),l.push([bl(e[0],n)||0,bl(e[1],n)||0])});var c=.8*n-2,d=c/o*.3,f=(c-d*(o-1))/o,h=f/2-c/2;uS(i,function(t,e){s.push(h),h+=d+f,a.push(Math.min(Math.max(f,l[e][0]),l[e][1]))})}(t),uS(e,function(e,n){!function(t,e,n){var r=t.coordinateSystem,i=t.getData(),o=n/2,a="horizontal"===t.get("layout")?0:1,s=1-a,l=["x","y"],u=i.mapDimension(l[a]),c=i.mapDimension(l[s],!0);if(!(null==u||c.length<5))for(var d=0;d<i.count();d++){var f=i.get(u,d),h=x(f,c[2],d),p=x(f,c[0],d),g=x(f,c[1],d),m=x(f,c[3],d),v=x(f,c[4],d),y=[];b(y,g,0),b(y,m,1),y.push(p,g,v,m),_(y,p),_(y,v),_(y,h),i.setItemLayout(d,{initBaseline:h[s],ends:y})}function x(t,n,o){var l,u=i.get(n,o),c=[];return c[a]=t,c[s]=u,isNaN(t)||isNaN(u)?l=[NaN,NaN]:(l=r.dataToPoint(c))[a]+=e,l}function b(t,e,n){var r=e.slice(),i=e.slice();r[a]+=o,i[a]-=o,n?t.push(r,i):t.push(i,r)}function _(t,e){var n=e.slice(),r=e.slice();n[a]-=o,r[a]+=o,t.push(n,r)}}(e,t.boxOffsetList[n],t.boxWidthList[n])}))})}),M(jc.extend({type:"series.candlestick",dependencies:["xAxis","yAxis","grid"],defaultValueDimensions:[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,clip:!0,itemStyle:{color:"#c23531",color0:"#314656",borderWidth:1,borderColor:"#c23531",borderColor0:"#314656"},emphasis:{itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationUpdate:!1,animationEasing:"linear",animationDuration:300},getShadowDim:function(){return"open"},brushSelector:function(t,e,n){var r=e.getItemLayout(t);return r&&n.rect(r.brushRect)}}),nS,!0);var cS=["itemStyle"],dS=["emphasis","itemStyle"],fS=["color","color0","borderColor","borderColor0"],hS=(nd.extend({type:"candlestick",render:function(t,e,n){this.group.removeClipPath(),this._updateDrawMode(t),this._isLargeDraw?this._renderLarge(t):this._renderNormal(t)},incrementalPrepareRender:function(t,e,n){this._clear(),this._updateDrawMode(t)},incrementalRender:function(t,e,n,r){this._isLargeDraw?this._incrementalRenderLarge(t,e):this._incrementalRenderNormal(t,e)},_updateDrawMode:function(t){var e=t.pipelineContext.large;(null==this._isLargeDraw||e^this._isLargeDraw)&&(this._isLargeDraw=e,this._clear())},_renderNormal:function(t){var e=t.getData(),n=this._data,r=this.group,i=e.getLayout("isSimpleBox"),o=t.get("clip",!0),a=t.coordinateSystem,s=a.getArea&&a.getArea();this._data||r.removeAll(),e.diff(n).add(function(n){if(e.hasValue(n)){var a,l=e.getItemLayout(n);if(o&&gS(s,l))return;Zs(a=pS(l,0,!0),{shape:{points:l.ends}},t,n),mS(a,e,n,i),r.add(a),e.setItemGraphicEl(n,a)}}).update(function(a,l){var u=n.getItemGraphicEl(l);if(e.hasValue(a)){var c=e.getItemLayout(a);o&&gS(s,c)?r.remove(u):(u?$s(u,{shape:{points:c.ends}},t,a):u=pS(c),mS(u,e,a,i),r.add(u),e.setItemGraphicEl(a,u))}else r.remove(u)}).remove(function(t){var e=n.getItemGraphicEl(t);e&&r.remove(e)}).execute(),this._data=e},_renderLarge:function(t){this._clear(),yS(t,this.group);var e=t.get("clip",!0)?Qg(t.coordinateSystem,!1,t):null;e?this.group.setClipPath(e):this.group.removeClipPath()},_incrementalRenderNormal:function(t,e){for(var n,r=e.getData(),i=r.getLayout("isSimpleBox");null!=(n=t.next());){var o;mS(o=pS(r.getItemLayout(n)),r,n,i),o.incremental=!0,this.group.add(o)}},_incrementalRenderLarge:function(t,e){yS(e,this.group,!0)},remove:function(t){this._clear()},_clear:function(){this.group.removeAll(),this._data=null},dispose:et}),ha.extend({type:"normalCandlestickBox",shape:{},buildPath:function(t,e){var n=e.points;this.__simpleBox?(t.moveTo(n[4][0],n[4][1]),t.lineTo(n[6][0],n[6][1])):(t.moveTo(n[0][0],n[0][1]),t.lineTo(n[1][0],n[1][1]),t.lineTo(n[2][0],n[2][1]),t.lineTo(n[3][0],n[3][1]),t.closePath(),t.moveTo(n[4][0],n[4][1]),t.lineTo(n[5][0],n[5][1]),t.moveTo(n[6][0],n[6][1]),t.lineTo(n[7][0],n[7][1]))}}));function pS(t,e,n){var r=t.ends;return new hS({shape:{points:n?function(t,e){return A(t,function(t){return(t=t.slice())[1]=e.initBaseline,t})}(r,t):r},z2:100})}function gS(t,e){for(var n=!0,r=0;r<e.ends.length;r++)if(t.contain(e.ends[r][0],e.ends[r][1])){n=!1;break}return n}function mS(t,e,n,r){var i=e.getItemModel(n),o=i.getModel(cS),a=e.getItemVisual(n,"color"),s=e.getItemVisual(n,"borderColor")||a,l=o.getItemStyle(fS);t.useStyle(l),t.style.strokeNoScale=!0,t.style.fill=a,t.style.stroke=s,t.__simpleBox=r,Ls(t,i.getModel(dS).getItemStyle())}var vS=ha.extend({type:"largeCandlestickBox",shape:{},buildPath:function(t,e){for(var n=e.points,r=0;r<n.length;)if(this.__sign===n[r++]){var i=n[r++];t.moveTo(i,n[r++]),t.lineTo(i,n[r++])}else r+=3}});function yS(t,e,n){var r=t.getData(),i=r.getLayout("largePoints"),o=new vS({shape:{points:i},__sign:1});e.add(o);var a=new vS({shape:{points:i},__sign:-1});e.add(a),xS(1,o,t,r),xS(-1,a,t,r),n&&(o.incremental=!0,a.incremental=!0)}function xS(t,e,n,r){var i=0<t?"P":"N",o=r.getVisual("borderColor"+i)||r.getVisual("color"+i),a=n.getModel(cS).getItemStyle(fS);e.useStyle(a),e.style.fill=null,e.style.stroke=o}var bS=["itemStyle","borderColor"],_S=["itemStyle","borderColor0"],wS=["itemStyle","color"],SS=["itemStyle","color0"],CS={seriesType:"candlestick",plan:Qc(),performRawSeries:!0,reset:function(t,e){if(t.getData().setVisual({legendSymbol:"roundRect",colorP:n(1,t),colorN:n(-1,t),borderColorP:r(1,t),borderColorN:r(-1,t)}),!e.isSeriesFiltered(t))return!t.pipelineContext.large&&{progress:function(t,e){for(var i;null!=(i=t.next());){var o=e.getItemModel(i),a=e.getItemLayout(i).sign;e.setItemVisual(i,{color:n(a,o),borderColor:r(a,o)})}}};function n(t,e){return e.get(0<t?wS:SS)}function r(t,e){return e.get(0<t?bS:_S)}}},MS="undefined"!=typeof Float32Array?Float32Array:Array,TS={seriesType:"candlestick",plan:Qc(),reset:function(t){var e=t.coordinateSystem,n=t.getData(),r=function(t,e){var n,r=t.getBaseAxis(),i="category"===r.type?r.getBandWidth():(n=r.getExtent(),Math.abs(n[1]-n[0])/e.count()),o=bl(j(t.get("barMaxWidth"),i),i),a=bl(j(t.get("barMinWidth"),1),i),s=t.get("barWidth");return null!=s?bl(s,i):Math.max(Math.min(i/2,o),a)}(t,n),i=["x","y"],o=n.mapDimension(i[0]),a=n.mapDimension(i[1],!0),s=a[0],l=a[1],u=a[2],c=a[3];if(n.setLayout({candleWidth:r,isSimpleBox:r<=1.3}),!(null==o||a.length<4))return{progress:t.pipelineContext.large?function(t,n){for(var r,i,a=new MS(4*t.count),d=0,f=[],h=[];null!=(i=t.next());){var p=n.get(o,i),g=n.get(s,i),m=n.get(l,i),v=n.get(u,i),y=n.get(c,i);isNaN(p)||isNaN(v)||isNaN(y)?(a[d++]=NaN,d+=3):(a[d++]=kS(n,i,g,m,l),f[0]=p,f[1]=v,r=e.dataToPoint(f,null,h),a[d++]=r?r[0]:NaN,a[d++]=r?r[1]:NaN,f[1]=y,r=e.dataToPoint(f,null,h),a[d++]=r?r[1]:NaN)}n.setLayout("largePoints",a)}:function(t,n){for(var i;null!=(i=t.next());){var a=n.get(o,i),d=n.get(s,i),f=n.get(l,i),h=n.get(u,i),p=n.get(c,i),g=Math.min(d,f),m=Math.max(d,f),v=w(g,a),y=w(m,a),x=w(h,a),b=w(p,a),_=[];S(_,y,0),S(_,v,1),_.push(M(b),M(y),M(x),M(v)),n.setItemLayout(i,{sign:kS(n,i,d,f,l),initBaseline:f<d?y[1]:v[1],ends:_,brushRect:C(h,p,a)})}function w(t,n){var r=[];return r[0]=n,r[1]=t,isNaN(n)||isNaN(t)?[NaN,NaN]:e.dataToPoint(r)}function S(t,e,n){var i=e.slice(),o=e.slice();i[0]=_s(i[0]+r/2,1,!1),o[0]=_s(o[0]-r/2,1,!0),n?t.push(i,o):t.push(o,i)}function C(t,e,n){var i=w(t,n),o=w(e,n);return i[0]-=r/2,o[0]-=r/2,{x:i[0],y:i[1],width:r,height:o[1]-i[1]}}function M(t){return t[0]=_s(t[0],1),t}}}}};function kS(t,e,n,r,i){return r<n?-1:n<r?1:0<e?t.get(i,e-1)<=r?1:-1:1}function AS(t,e){var n=e.rippleEffectColor||e.color;t.eachChild(function(t){t.attr({z:e.z,zlevel:e.zlevel,style:{stroke:"stroke"===e.brushType?n:null,fill:"fill"===e.brushType?n:null}})})}function IS(t,e){Cn.call(this);var n=new wg(t,e),r=new Cn;this.add(n),this.add(r),r.beforeUpdate=function(){this.attr(n.getScale())},this.updateData(t,e)}Qf(function(t){t&&R(t.series)&&k(t.series,function(t){B(t)&&"k"===t.type&&(t.type="candlestick")})}),ih(CS),rh(TS),jc.extend({type:"series.effectScatter",dependencies:["grid","polar"],getInitialData:function(t,e){return $h(this.getSource(),this,{useEncodeDefaulter:!0})},brushSelector:"point",defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",rippleEffect:{period:4,scale:2.5,brushType:"fill"},symbolSize:10}});var DS=IS.prototype;DS.stopEffectAnimation=function(){this.childAt(1).removeAll()},DS.startEffectAnimation=function(t){for(var e=t.symbolType,n=t.color,r=this.childAt(1),i=0;i<3;i++){var o=eg(e,-1,-1,2,2,n);o.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scale:[.5,.5]});var a=-i/3*t.period+t.effectOffset;o.animate("",!0).when(t.period,{scale:[t.rippleScale/2,t.rippleScale/2]}).delay(a).start(),o.animateStyle(!0).when(t.period,{opacity:0}).delay(a).start(),r.add(o)}AS(r,t)},DS.updateEffectAnimation=function(t){for(var e=this._effectCfg,n=this.childAt(1),r=["symbolType","period","rippleScale"],i=0;i<r.length;i++){var o=r[i];if(e[o]!==t[o])return this.stopEffectAnimation(),void this.startEffectAnimation(t)}AS(n,t)},DS.highlight=function(){this.trigger("emphasis")},DS.downplay=function(){this.trigger("normal")},DS.updateData=function(t,e){var n=t.hostModel;this.childAt(0).updateData(t,e);var r=this.childAt(1),i=t.getItemModel(e),o=t.getItemVisual(e,"symbol"),a=function(t){return R(t)||(t=[+t,+t]),t}(t.getItemVisual(e,"symbolSize")),s=t.getItemVisual(e,"color");r.attr("scale",a),r.traverse(function(t){t.attr({fill:s})});var l=i.getShallow("symbolOffset");if(l){var u=r.position;u[0]=bl(l[0],a[0]),u[1]=bl(l[1],a[1])}var c=t.getItemVisual(e,"symbolRotate");r.rotation=(c||0)*Math.PI/180||0;var d={};if(d.showEffectOn=n.get("showEffectOn"),d.rippleScale=i.get("rippleEffect.scale"),d.brushType=i.get("rippleEffect.brushType"),d.period=1e3*i.get("rippleEffect.period"),d.effectOffset=e/t.count(),d.z=i.getShallow("z")||0,d.zlevel=i.getShallow("zlevel")||0,d.symbolType=o,d.color=s,d.rippleEffectColor=i.get("rippleEffect.color"),this.off("mouseover").off("mouseout").off("emphasis").off("normal"),"render"===d.showEffectOn)this._effectCfg?this.updateEffectAnimation(d):this.startEffectAnimation(d),this._effectCfg=d;else{this._effectCfg=null,this.stopEffectAnimation();var f=this.childAt(0),h=function(){f.highlight(),"render"!==d.showEffectOn&&this.startEffectAnimation(d)},p=function(){f.downplay(),"render"!==d.showEffectOn&&this.stopEffectAnimation()};this.on("mouseover",h,this).on("mouseout",p,this).on("emphasis",h,this).on("normal",p,this)}this._effectCfg=d},DS.fadeOut=function(t){this.off("mouseover").off("mouseout").off("emphasis").off("normal"),t&&t()},C(IS,Cn),ch({type:"effectScatter",init:function(){this._symbolDraw=new Pg(IS)},render:function(t,e,n){var r=t.getData(),i=this._symbolDraw;i.updateData(r),this.group.add(i.group)},updateTransform:function(t,e,n){var r=t.getData();this.group.dirty();var i=am().reset(t);i.progress&&i.progress({start:0,end:r.count()},r),this._symbolDraw.updateLayout(r)},_updateGroupTransform:function(t){var e=t.coordinateSystem;e&&e.getRoamTransform&&(this.group.transform=de(e.getRoamTransform()),this.group.decomposeTransform())},remove:function(t,e){this._symbolDraw&&this._symbolDraw.remove(e)},dispose:function(){}}),ih(om("effectScatter","circle")),rh(am("effectScatter"));var OS="undefined"==typeof Uint32Array?Array:Uint32Array,PS="undefined"==typeof Float64Array?Array:Float64Array;function ES(t){var e=t.data;e&&e[0]&&e[0][0]&&e[0][0].coord&&(t.data=A(e,function(t){var e={coords:[t[0].coord,t[1].coord]};return t[0].name&&(e.fromName=t[0].name),t[1].name&&(e.toName=t[1].name),y([e,t[0],t[1]])}))}var RS=jc.extend({type:"series.lines",dependencies:["grid","polar"],visualColorAccessPath:"lineStyle.color",init:function(t){t.data=t.data||[],ES(t);var e=this._processFlatCoordsArray(t.data);this._flatCoords=e.flatCoords,this._flatCoordsOffset=e.flatCoordsOffset,e.flatCoords&&(t.data=new Float32Array(e.count)),RS.superApply(this,"init",arguments)},mergeOption:function(t){if(ES(t),t.data){var e=this._processFlatCoordsArray(t.data);this._flatCoords=e.flatCoords,this._flatCoordsOffset=e.flatCoordsOffset,e.flatCoords&&(t.data=new Float32Array(e.count))}RS.superApply(this,"mergeOption",arguments)},appendData:function(t){var e=this._processFlatCoordsArray(t.data);e.flatCoords&&(this._flatCoords?(this._flatCoords=tt(this._flatCoords,e.flatCoords),this._flatCoordsOffset=tt(this._flatCoordsOffset,e.flatCoordsOffset)):(this._flatCoords=e.flatCoords,this._flatCoordsOffset=e.flatCoordsOffset),t.data=new Float32Array(e.count)),this.getRawData().appendData(t.data)},_getCoordsFromItemModel:function(t){var e=this.getData().getItemModel(t);return e.option instanceof Array?e.option:e.getShallow("coords")},getLineCoordsCount:function(t){return this._flatCoordsOffset?this._flatCoordsOffset[2*t+1]:this._getCoordsFromItemModel(t).length},getLineCoords:function(t,e){if(this._flatCoordsOffset){for(var n=this._flatCoordsOffset[2*t],r=this._flatCoordsOffset[2*t+1],i=0;i<r;i++)e[i]=e[i]||[],e[i][0]=this._flatCoords[n+2*i],e[i][1]=this._flatCoords[n+2*i+1];return r}var o=this._getCoordsFromItemModel(t);for(i=0;i<o.length;i++)e[i]=e[i]||[],e[i][0]=o[i][0],e[i][1]=o[i][1];return o.length},_processFlatCoordsArray:function(t){var e=0;if(this._flatCoords&&(e=this._flatCoords.length),"number"!=typeof t[0])return{flatCoordsOffset:null,flatCoords:null,count:t.length};for(var n=t.length,r=new OS(n),i=new PS(n),o=0,a=0,s=0,l=0;l<n;){s++;var u=t[l++];r[a++]=o+e,r[a++]=u;for(var c=0;c<u;c++){var d=t[l++],f=t[l++];i[o++]=d,i[o++]=f}}return{flatCoordsOffset:new Uint32Array(r.buffer,0,a),flatCoords:i,count:s}},getInitialData:function(t,e){var n=new Ah(["value"],this);return n.hasItemOption=!1,n.initData(t.data,[],function(t,e,r,i){if(t instanceof Array)return NaN;n.hasItemOption=!0;var o=t.value;return null!=o?o instanceof Array?o[i]:o:void 0}),n},formatTooltip:function(t){var e=this.getData().getItemModel(t),n=e.get("name");if(n)return n;var r=e.get("fromName"),i=e.get("toName"),o=[];return null!=r&&o.push(r),null!=i&&o.push(i),jl(o.join(" > "))},preventIncremental:function(){return!!this.get("effect.show")},getProgressive:function(){var t=this.option.progressive;return null==t?this.option.large?1e4:this.get("progressive"):t},getProgressiveThreshold:function(){var t=this.option.progressiveThreshold;return null==t?this.option.large?2e4:this.get("progressiveThreshold"):t},defaultOption:{coordinateSystem:"geo",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}}});function LS(t,e,n){Cn.call(this),this.add(this.createLine(t,e,n)),this._updateEffectSymbol(t,e)}var NS=LS.prototype;function BS(t,e,n){Cn.call(this),this._createPolyline(t,e,n)}NS.createLine=function(t,e,n){return new zb(t,e,n)},NS._updateEffectSymbol=function(t,e){var n=t.getItemModel(e).getModel("effect"),r=n.get("symbolSize"),i=n.get("symbol");R(r)||(r=[r,r]);var o=n.get("color")||t.getItemVisual(e,"color"),a=this.childAt(1);this._symbolType!==i&&(this.remove(a),(a=eg(i,-.5,-.5,1,1,o)).z2=100,a.culling=!0,this.add(a)),a&&(a.setStyle("shadowColor",o),a.setStyle(n.getItemStyle(["color"])),a.attr("scale",r),a.setColor(o),a.attr("scale",r),this._symbolType=i,this._symbolScale=r,this._updateEffectAnimation(t,n,e))},NS._updateEffectAnimation=function(t,e,n){var r=this.childAt(1);if(r){var i=this,o=t.getItemLayout(n),a=1e3*e.get("period"),s=e.get("loop"),l=e.get("constantSpeed"),u=W(e.get("delay"),function(e){return e/t.count()*a/3}),c="function"==typeof u;if(r.ignore=!0,this.updateAnimationPoints(r,o),0<l&&(a=this.getLineLength(r)/l*1e3),a!==this._period||s!==this._loop){r.stopAnimation();var d=u;c&&(d=u(n)),0<r.__t&&(d=-a*r.__t),r.__t=0;var f=r.animate("",s).when(a,{__t:1}).delay(d).during(function(){i.updateSymbolPosition(r)});s||f.done(function(){i.remove(r)}),f.start()}this._period=a,this._loop=s}},NS.getLineLength=function(t){return mt(t.__p1,t.__cp1)+mt(t.__cp1,t.__p2)},NS.updateAnimationPoints=function(t,e){t.__p1=e[0],t.__p2=e[1],t.__cp1=e[2]||[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]},NS.updateData=function(t,e,n){this.childAt(0).updateData(t,e,n),this._updateEffectSymbol(t,e)},NS.updateSymbolPosition=function(t){var e=t.__p1,n=t.__p2,r=t.__cp1,i=t.__t,o=t.position,a=[o[0],o[1]],s=vo,l=yo;o[0]=s(e[0],r[0],n[0],i),o[1]=s(e[1],r[1],n[1],i);var u=l(e[0],r[0],n[0],i),c=l(e[1],r[1],n[1],i);if(t.rotation=-Math.atan2(c,u)-Math.PI/2,"line"===this._symbolType||"rect"===this._symbolType||"roundRect"===this._symbolType)if(void 0!==t.__lastT&&t.__lastT<t.__t){var d=1.05*mt(a,o);t.attr("scale",[t.scale[0],d]),1===i&&(o[0]=a[0]+(o[0]-a[0])/2,o[1]=a[1]+(o[1]-a[1])/2)}else 1===t.__lastT?(d=2*mt(e,o),t.attr("scale",[t.scale[0],d])):t.attr("scale",this._symbolScale);t.__lastT=t.__t,t.ignore=!1},NS.updateLayout=function(t,e){this.childAt(0).updateLayout(t,e);var n=t.getItemModel(e).getModel("effect");this._updateEffectAnimation(t,n,e)},C(LS,Cn);var zS=BS.prototype;function VS(t,e,n){LS.call(this,t,e,n),this._lastFrame=0,this._lastFramePercent=0}zS._createPolyline=function(t,e,n){var r=t.getItemLayout(e),i=new Va({shape:{points:r}});this.add(i),this._updateCommonStl(t,e,n)},zS.updateData=function(t,e,n){var r=t.hostModel;$s(this.childAt(0),{shape:{points:t.getItemLayout(e)}},r,e),this._updateCommonStl(t,e,n)},zS._updateCommonStl=function(t,e,n){var r=this.childAt(0),i=t.getItemModel(e),o=t.getItemVisual(e,"color"),a=n&&n.lineStyle,s=n&&n.hoverLineStyle;n&&!t.hasItemOption||(a=i.getModel("lineStyle").getLineStyle(),s=i.getModel("emphasis.lineStyle").getLineStyle()),r.useStyle(b({strokeNoScale:!0,fill:"none",stroke:o},a)),r.hoverStyle=s,Ls(this)},zS.updateLayout=function(t,e){this.childAt(0).setShape("points",t.getItemLayout(e))},C(BS,Cn);var FS=VS.prototype;FS.createLine=function(t,e,n){return new BS(t,e,n)},FS.updateAnimationPoints=function(t,e){this._points=e;for(var n=[0],r=0,i=1;i<e.length;i++)r+=mt(e[i-1],e[i]),n.push(r);if(0!==r){for(i=0;i<n.length;i++)n[i]/=r;this._offsets=n,this._length=r}},FS.getLineLength=function(t){return this._length},FS.updateSymbolPosition=function(t){var e=t.__t,n=this._points,r=this._offsets,i=n.length;if(r){var o=this._lastFrame;if(e<this._lastFramePercent){for(a=Math.min(o+1,i-1);0<=a&&!(r[a]<=e);a--);a=Math.min(a,i-2)}else{for(var a=o;a<i&&!(r[a]>e);a++);a=Math.min(a-1,i-2)}xt(t.position,n[a],n[a+1],(e-r[a])/(r[a+1]-r[a])),t.rotation=-Math.atan2(n[a+1][1]-n[a][1],n[a+1][0]-n[a][0])-Math.PI/2,this._lastFrame=a,this._lastFramePercent=e,t.ignore=!1}},C(VS,LS);var HS=hs({shape:{polyline:!1,curveness:0,segs:[]},buildPath:function(t,e){var n=e.segs,r=e.curveness;if(e.polyline)for(var i=0;i<n.length;){var o=n[i++];if(0<o){t.moveTo(n[i++],n[i++]);for(var a=1;a<o;a++)t.lineTo(n[i++],n[i++])}}else for(i=0;i<n.length;){var s=n[i++],l=n[i++],u=n[i++],c=n[i++];t.moveTo(s,l),0<r?t.quadraticCurveTo((s+u)/2-(l-c)*r,(l+c)/2-(u-s)*r,u,c):t.lineTo(u,c)}},findDataIndex:function(t,e){var n=this.shape,r=n.segs,i=n.curveness;if(n.polyline)for(var o=0,a=0;a<r.length;){var s=r[a++];if(0<s)for(var l=r[a++],u=r[a++],c=1;c<s;c++)if(Yo(l,u,d=r[a++],f=r[a++]))return o;o++}else for(o=0,a=0;a<r.length;){l=r[a++],u=r[a++];var d=r[a++],f=r[a++];if(0<i){if(Zo(l,u,(l+d)/2-(u-f)*i,(u+f)/2-(d-l)*i,d,f))return o}else if(Yo(l,u,d,f))return o;o++}return-1}});function WS(){this.group=new Cn}var jS=WS.prototype;jS.isPersistent=function(){return!this._incremental},jS.updateData=function(t){this.group.removeAll();var e=new HS({rectHover:!0,cursor:"default"});e.setShape({segs:t.getLayout("linesPoints")}),this._setCommon(e,t),this.group.add(e),this._incremental=null},jS.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clearIncremental(),5e5<t.count()?(this._incremental||(this._incremental=new ns({silent:!0})),this.group.add(this._incremental)):this._incremental=null},jS.incrementalUpdate=function(t,e){var n=new HS;n.setShape({segs:e.getLayout("linesPoints")}),this._setCommon(n,e,!!this._incremental),this._incremental?this._incremental.addDisplayable(n,!0):(n.rectHover=!0,n.cursor="default",n.__startIndex=t.start,this.group.add(n))},jS.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},jS._setCommon=function(t,e,n){var r=e.hostModel;t.setShape({polyline:r.get("polyline"),curveness:r.get("lineStyle.curveness")}),t.useStyle(r.getModel("lineStyle").getLineStyle()),t.style.strokeNoScale=!0;var i=e.getVisual("color");i&&t.setStyle("stroke",i),t.setStyle("fill"),n||(t.seriesIndex=r.seriesIndex,t.on("mousemove",function(e){t.dataIndex=null;var n=t.findDataIndex(e.offsetX,e.offsetY);0<n&&(t.dataIndex=n+t.__startIndex)}))},jS._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles()};var GS={seriesType:"lines",plan:Qc(),reset:function(t){var e=t.coordinateSystem,n=t.get("polyline"),r=t.pipelineContext.large;return{progress:function(i,o){var a=[];if(r){var s,l=i.end-i.start;if(n){for(var u=0,c=i.start;c<i.end;c++)u+=t.getLineCoordsCount(c);s=new Float32Array(l+2*u)}else s=new Float32Array(4*l);var d=0,f=[];for(c=i.start;c<i.end;c++){var h=t.getLineCoords(c,a);n&&(s[d++]=h);for(var p=0;p<h;p++)f=e.dataToPoint(a[p],!1,f),s[d++]=f[0],s[d++]=f[1]}o.setLayout("linesPoints",s)}else for(c=i.start;c<i.end;c++){var g=o.getItemModel(c),m=(h=t.getLineCoords(c,a),[]);if(n)for(var v=0;v<h;v++)m.push(e.dataToPoint(a[v]));else{m[0]=e.dataToPoint(a[0]),m[1]=e.dataToPoint(a[1]);var y=g.get("lineStyle.curveness");+y&&(m[2]=[(m[0][0]+m[1][0])/2-(m[0][1]-m[1][1])*y,(m[0][1]+m[1][1])/2-(m[1][0]-m[0][0])*y])}o.setItemLayout(c,m)}}}}};function US(t){return t instanceof Array||(t=[t,t]),t}ch({type:"lines",init:function(){},render:function(t,e,n){var r=t.getData(),i=this._updateLineDraw(r,t),o=t.get("zlevel"),a=t.get("effect.trailLength"),s=n.getZr(),l="svg"===s.painter.getType();l||s.painter.getLayer(o).clear(!0),null==this._lastZlevel||l||s.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(t)&&a&&(l||s.configLayer(o,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(a/10+.9,1),0)})),i.updateData(r);var u=t.get("clip",!0)&&Qg(t.coordinateSystem,!1,t);u?this.group.setClipPath(u):this.group.removeClipPath(),this._lastZlevel=o,this._finished=!0},incrementalPrepareRender:function(t,e,n){var r=t.getData();this._updateLineDraw(r,t).incrementalPrepareUpdate(r),this._clearLayer(n),this._finished=!1},incrementalRender:function(t,e,n){this._lineDraw.incrementalUpdate(t,e.getData()),this._finished=t.end===e.getData().count()},updateTransform:function(t,e,n){var r=t.getData(),i=t.pipelineContext;if(!this._finished||i.large||i.progressiveRender)return{update:!0};var o=GS.reset(t);o.progress&&o.progress({start:0,end:r.count()},r),this._lineDraw.updateLayout(),this._clearLayer(n)},_updateLineDraw:function(t,e){var n=this._lineDraw,r=this._showEffect(e),i=!!e.get("polyline"),o=e.pipelineContext.large;return n&&r===this._hasEffet&&i===this._isPolyline&&o===this._isLargeDraw||(n&&n.remove(),n=this._lineDraw=o?new WS:new Fb(i?r?VS:BS:r?LS:zb),this._hasEffet=r,this._isPolyline=i,this._isLargeDraw=o,this.group.removeAll()),this.group.add(n.group),n},_showEffect:function(t){return!!t.get("effect.show")},_clearLayer:function(t){var e=t.getZr();"svg"===e.painter.getType()||null==this._lastZlevel||e.painter.getLayer(this._lastZlevel).clear(!0)},remove:function(t,e){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(e)},dispose:function(){}});var qS="lineStyle.opacity".split("."),XS={seriesType:"lines",reset:function(t,e,n){var r=US(t.get("symbol")),i=US(t.get("symbolSize")),o=t.getData();return o.setVisual("fromSymbol",r&&r[0]),o.setVisual("toSymbol",r&&r[1]),o.setVisual("fromSymbolSize",i&&i[0]),o.setVisual("toSymbolSize",i&&i[1]),o.setVisual("opacity",t.get(qS)),{dataEach:o.hasItemOption?function(t,e){var n=t.getItemModel(e),r=US(n.getShallow("symbol",!0)),i=US(n.getShallow("symbolSize",!0)),o=n.get(qS);r[0]&&t.setItemVisual(e,"fromSymbol",r[0]),r[1]&&t.setItemVisual(e,"toSymbol",r[1]),i[0]&&t.setItemVisual(e,"fromSymbolSize",i[0]),i[1]&&t.setItemVisual(e,"toSymbolSize",i[1]),t.setItemVisual(e,"opacity",o)}:null}}};function YS(){var t=_();this.canvas=t,this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={}}rh(GS),ih(XS),jc.extend({type:"series.heatmap",getInitialData:function(t,e){return $h(this.getSource(),this,{generateCoord:"value"})},preventIncremental:function(){var t=Uu.get(this.get("coordinateSystem"));if(t&&t.dimensions)return"lng"===t.dimensions[0]&&"lat"===t.dimensions[1]},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0}}),YS.prototype={update:function(t,e,n,r,i,o){var a=this._getBrush(),s=this._getGradient(t,i,"inRange"),l=this._getGradient(t,i,"outOfRange"),u=this.pointSize+this.blurSize,c=this.canvas,d=c.getContext("2d"),f=t.length;c.width=e,c.height=n;for(var h=0;h<f;++h){var p=t[h],g=p[0],m=p[1],v=r(p[2]);d.globalAlpha=v,d.drawImage(a,g-u,m-u)}if(!c.width||!c.height)return c;for(var y=d.getImageData(0,0,c.width,c.height),x=y.data,b=0,_=x.length,w=this.minOpacity,S=this.maxOpacity-w;b<_;){v=x[b+3]/256;var C=4*Math.floor(255*v);if(0<v){var M=o(v)?s:l;0<v&&(v=v*S+w),x[b++]=M[C],x[b++]=M[1+C],x[b++]=M[2+C],x[b++]=M[3+C]*v*256}else b+=4}return d.putImageData(y,0,0),c},_getBrush:function(){var t=this._brushCanvas||(this._brushCanvas=_()),e=this.pointSize+this.blurSize,n=2*e;t.width=n,t.height=n;var r=t.getContext("2d");return r.clearRect(0,0,n,n),r.shadowOffsetX=n,r.shadowBlur=this.blurSize,r.shadowColor="#000",r.beginPath(),r.arc(-e,e,this.pointSize,0,2*Math.PI,!0),r.closePath(),r.fill(),t},_getGradient:function(t,e,n){for(var r=this._gradientPixels,i=r[n]||(r[n]=new Uint8ClampedArray(1024)),o=[0,0,0,0],a=0,s=0;s<256;s++)e[n](s/255,!0,o),i[a++]=o[0],i[a++]=o[1],i[a++]=o[2],i[a++]=o[3];return i}},ch({type:"heatmap",render:function(t,e,n){var r;e.eachComponent("visualMap",function(e){e.eachTargetSeries(function(n){n===t&&(r=e)})}),this.group.removeAll(),this._incrementalDisplayable=null;var i=t.coordinateSystem;"cartesian2d"===i.type||"calendar"===i.type?this._renderOnCartesianAndCalendar(t,n,0,t.getData().count()):function(t){var e=t.dimensions;return"lng"===e[0]&&"lat"===e[1]}(i)&&this._renderOnGeo(i,t,r,n)},incrementalPrepareRender:function(t,e,n){this.group.removeAll()},incrementalRender:function(t,e,n,r){e.coordinateSystem&&this._renderOnCartesianAndCalendar(e,r,t.start,t.end,!0)},_renderOnCartesianAndCalendar:function(t,e,n,r,i){var o,a,s=t.coordinateSystem;if("cartesian2d"===s.type){var l=s.getAxis("x"),u=s.getAxis("y");o=l.getBandWidth(),a=u.getBandWidth()}for(var c=this.group,d=t.getData(),f="emphasis.itemStyle",h="emphasis.label",p=t.getModel("itemStyle").getItemStyle(["color"]),g=t.getModel(f).getItemStyle(),m=t.getModel("label"),v=t.getModel(h),y=s.type,b="cartesian2d"===y?[d.mapDimension("x"),d.mapDimension("y"),d.mapDimension("value")]:[d.mapDimension("time"),d.mapDimension("value")],_=n;_<r;_++){var w;if("cartesian2d"===y){if(isNaN(d.get(b[2],_)))continue;var S=s.dataToPoint([d.get(b[0],_),d.get(b[1],_)]);w=new Ua({shape:{x:Math.floor(Math.round(S[0])-o/2),y:Math.floor(Math.round(S[1])-a/2),width:Math.ceil(o),height:Math.ceil(a)},style:{fill:d.getItemVisual(_,"color"),opacity:d.getItemVisual(_,"opacity")}})}else{if(isNaN(d.get(b[1],_)))continue;w=new Ua({z2:1,shape:s.dataToRect([d.get(b[0],_)]).contentShape,style:{fill:d.getItemVisual(_,"color"),opacity:d.getItemVisual(_,"opacity")}})}var C=d.getItemModel(_);d.hasItemOption&&(p=C.getModel("itemStyle").getItemStyle(["color"]),g=C.getModel(f).getItemStyle(),m=C.getModel("label"),v=C.getModel(h));var M=t.getRawValue(_),T="-";M&&null!=M[2]&&(T=M[2]),Vs(p,g,m,v,{labelFetcher:t,labelDataIndex:_,defaultText:T,isRectText:!0}),w.setStyle(p),Ls(w,d.hasItemOption?g:x({},g)),(w.incremental=i)&&(w.useHoverLayer=!0),c.add(w),d.setItemGraphicEl(_,w)}},_renderOnGeo:function(t,e,n,r){var i=n.targetVisuals.inRange,o=n.targetVisuals.outOfRange,a=e.getData(),s=this._hmLayer||this._hmLayer||new YS;s.blurSize=e.get("blurSize"),s.pointSize=e.get("pointSize"),s.minOpacity=e.get("minOpacity"),s.maxOpacity=e.get("maxOpacity");var l=t.getViewRect().clone(),u=t.getRoamTransform();l.applyTransform(u);var c=Math.max(l.x,0),d=Math.max(l.y,0),f=Math.min(l.width+l.x,r.getWidth()),h=Math.min(l.height+l.y,r.getHeight()),p=f-c,g=h-d,m=[a.mapDimension("lng"),a.mapDimension("lat"),a.mapDimension("value")],v=a.mapArray(m,function(e,n,r){var i=t.dataToPoint([e,n]);return i[0]-=c,i[1]-=d,i.push(r),i}),y=n.getExtent(),x="visualMap.continuous"===n.type?function(t,e){var n=t[1]-t[0];return e=[(e[0]-t[0])/n,(e[1]-t[0])/n],function(t){return t>=e[0]&&t<=e[1]}}(y,n.option.range):function(t,e,n){var r=t[1]-t[0],i=(e=A(e,function(e){return{interval:[(e.interval[0]-t[0])/r,(e.interval[1]-t[0])/r]}})).length,o=0;return function(t){for(var r=o;r<i;r++)if((a=e[r].interval)[0]<=t&&t<=a[1]){o=r;break}if(r===i)for(r=o-1;0<=r;r--){var a;if((a=e[r].interval)[0]<=t&&t<=a[1]){o=r;break}}return 0<=r&&r<i&&n[r]}}(y,n.getPieceList(),n.option.selected);s.update(v,p,g,i.color.getNormalizer(),{inRange:i.color.getColorMapper(),outOfRange:o.color.getColorMapper()},x);var b=new Wr({style:{width:p,height:g,x:c,y:d,image:s.canvas},silent:!0});this.group.add(b)},dispose:function(){}});var $S=tv.extend({type:"series.pictorialBar",dependencies:["grid"],defaultOption:{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",progressive:0,hoverAnimation:!1},getInitialData:function(t){return t.stack=null,$S.superApply(this,"getInitialData",arguments)}}),ZS=["itemStyle","borderWidth"],KS=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],JS=new Pa;function QS(t,e,n,r){var i=t.getItemLayout(e),o=n.get("symbolRepeat"),a=n.get("symbolClip"),s=n.get("symbolPosition")||"start",l=(n.get("symbolRotate")||0)*Math.PI/180||0,u=n.get("symbolPatternSize")||2,c=n.isAnimationEnabled(),d={dataIndex:e,layout:i,itemModel:n,symbolType:t.getItemVisual(e,"symbol")||"circle",color:t.getItemVisual(e,"color"),symbolClip:a,symbolRepeat:o,symbolRepeatDirection:n.get("symbolRepeatDirection"),symbolPatternSize:u,rotation:l,animationModel:c?n:null,hoverAnimation:c&&n.get("hoverAnimation"),z2:n.getShallow("z",!0)||0};!function(t,e,n,r,i){var o,a=r.valueDim,s=t.get("symbolBoundingData"),l=r.coordSys.getOtherAxis(r.coordSys.getBaseAxis()),u=l.toGlobalCoord(l.dataToCoord(0)),c=1-+(n[a.wh]<=0);if(R(s)){var d=[tC(l,s[0])-u,tC(l,s[1])-u];d[1]<d[0]&&d.reverse(),o=d[c]}else o=null!=s?tC(l,s)-u:e?r.coordSysExtent[a.index][c]-u:n[a.wh];i.boundingLength=o,e&&(i.repeatCutLength=n[a.wh]),i.pxSign=0<o?1:o<0?-1:0}(n,o,i,r,d),function(t,e,n,r,i,o,a,s,l,u){var c=l.valueDim,d=l.categoryDim,f=Math.abs(n[d.wh]),h=t.getItemVisual(e,"symbolSize");(h=R(h)?h.slice():(null==h&&(h="100%"),[h,h]))[d.index]=bl(h[d.index],f),h[c.index]=bl(h[c.index],r?f:Math.abs(o)),u.symbolSize=h,(u.symbolScale=[h[0]/s,h[1]/s])[c.index]*=(l.isHorizontal?-1:1)*a}(t,e,i,o,0,d.boundingLength,d.pxSign,u,r,d),function(t,e,n,r,i){var o=t.get(ZS)||0;o&&(JS.attr({scale:e.slice(),rotation:n}),JS.updateTransform(),o/=JS.getLineScale(),o*=e[r.valueDim.index]),i.valueLineWidth=o}(n,d.symbolScale,l,r,d);var f=d.symbolSize,h=n.get("symbolOffset");return R(h)&&(h=[bl(h[0],f[0]),bl(h[1],f[1])]),function(t,e,n,r,i,o,a,s,l,u,c,d){var f=c.categoryDim,h=c.valueDim,p=d.pxSign,g=Math.max(e[h.index]+s,0),m=g;if(r){var v=Math.abs(l),y=W(t.get("symbolMargin"),"15%")+"",b=!1;y.lastIndexOf("!")===y.length-1&&(b=!0,y=y.slice(0,y.length-1)),y=bl(y,e[h.index]);var _=Math.max(g+2*y,0),w=b?0:2*y,S=Nl(r),C=S?r:mC((v+w)/_);_=g+2*(y=(v-C*g)/2/(b?C:C-1)),w=b?0:2*y,S||"fixed"===r||(C=u?mC((Math.abs(u)+w)/_):0),m=C*_-w,d.repeatTimes=C,d.symbolMargin=y}var M=p*(m/2),T=d.pathPosition=[];T[f.index]=n[f.wh]/2,T[h.index]="start"===a?M:"end"===a?l-M:l/2,o&&(T[0]+=o[0],T[1]+=o[1]);var k=d.bundlePosition=[];k[f.index]=n[f.xy],k[h.index]=n[h.xy];var A=d.barRectShape=x({},n);A[h.wh]=p*Math.max(Math.abs(n[h.wh]),Math.abs(T[h.index]+M)),A[f.wh]=n[f.wh];var I=d.clipShape={};I[f.xy]=-n[f.xy],I[f.wh]=c.ecSize[f.wh],I[h.xy]=0,I[h.wh]=n[h.wh]}(n,f,i,o,0,h,s,d.valueLineWidth,d.boundingLength,d.repeatCutLength,r,d),d}function tC(t,e){return t.toGlobalCoord(t.dataToCoord(t.scale.parse(e)))}function eC(t){var e=t.symbolPatternSize,n=eg(t.symbolType,-e/2,-e/2,e,e,t.color);return n.attr({culling:!0}),"image"!==n.type&&n.setStyle({strokeNoScale:!0}),n}function nC(t,e,n,r){var i=t.__pictorialBundle,o=n.pathPosition,a=e.valueDim,s=n.repeatTimes||0,l=0,u=n.symbolSize[e.valueDim.index]+n.valueLineWidth+2*n.symbolMargin;for(hC(t,function(t){t.__pictorialAnimationIndex=l,t.__pictorialRepeatTimes=s,l<s?pC(t,null,f(l),n,r):pC(t,null,{scale:[0,0]},n,r,function(){i.remove(t)}),uC(t,n),l++});l<s;l++){var c=eC(n);c.__pictorialAnimationIndex=l,c.__pictorialRepeatTimes=s,i.add(c);var d=f(l);pC(c,{position:d.position,scale:[0,0]},{scale:d.scale,rotation:d.rotation},n,r),c.on("mouseover",h).on("mouseout",p),uC(c,n)}function f(t){var e=o.slice(),r=n.pxSign,i=t;return("start"===n.symbolRepeatDirection?0<r:r<0)&&(i=s-1-t),e[a.index]=u*(i-s/2+.5)+o[a.index],{position:e,scale:n.symbolScale.slice(),rotation:n.rotation}}function h(){hC(t,function(t){t.trigger("emphasis")})}function p(){hC(t,function(t){t.trigger("normal")})}}function rC(t,e,n,r){var i=t.__pictorialBundle,o=t.__pictorialMainPath;o?pC(o,null,{position:n.pathPosition.slice(),scale:n.symbolScale.slice(),rotation:n.rotation},n,r):(o=t.__pictorialMainPath=eC(n),i.add(o),pC(o,{position:n.pathPosition.slice(),scale:[0,0],rotation:n.rotation},{scale:n.symbolScale.slice()},n,r),o.on("mouseover",function(){this.trigger("emphasis")}).on("mouseout",function(){this.trigger("normal")})),uC(o,n)}function iC(t,e,n){var r=x({},e.barRectShape),i=t.__pictorialBarRect;i?pC(i,null,{shape:r},e,n):(i=t.__pictorialBarRect=new Ua({z2:2,shape:r,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}}),t.add(i))}function oC(t,e,n,r){if(n.symbolClip){var i=t.__pictorialClipPath,o=x({},n.clipShape),a=e.valueDim,s=n.animationModel,l=n.dataIndex;if(i)$s(i,{shape:o},s,l);else{o[a.wh]=0,i=new Ua({shape:o}),t.__pictorialBundle.setClipPath(i),t.__pictorialClipPath=i;var u={};u[a.wh]=n.clipShape[a.wh],al[r?"updateProps":"initProps"](i,{shape:u},s,l)}}}function aC(t,e){var n=t.getItemModel(e);return n.getAnimationDelayParams=sC,n.isAnimationEnabled=lC,n}function sC(t){return{index:t.__pictorialAnimationIndex,count:t.__pictorialRepeatTimes}}function lC(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function uC(t,e){t.off("emphasis").off("normal");var n=e.symbolScale.slice();e.hoverAnimation&&t.on("emphasis",function(){this.animateTo({scale:[1.1*n[0],1.1*n[1]]},400,"elasticOut")}).on("normal",function(){this.animateTo({scale:n.slice()},400,"elasticOut")})}function cC(t,e,n,r){var i=new Cn,o=new Cn;return i.add(o),(i.__pictorialBundle=o).attr("position",n.bundlePosition.slice()),n.symbolRepeat?nC(i,e,n):rC(i,0,n),iC(i,n,r),oC(i,e,n,r),i.__pictorialShapeStr=fC(t,n),i.__pictorialSymbolMeta=n,i}function dC(t,e,n,r){var i=r.__pictorialBarRect;i&&(i.style.text=null);var o=[];hC(r,function(t){o.push(t)}),r.__pictorialMainPath&&o.push(r.__pictorialMainPath),r.__pictorialClipPath&&(n=null),k(o,function(t){$s(t,{scale:[0,0]},n,e,function(){r.parent&&r.parent.remove(r)})}),t.setItemGraphicEl(e,null)}function fC(t,e){return[t.getItemVisual(e.dataIndex,"symbol")||"none",!!e.symbolRepeat,!!e.symbolClip].join(":")}function hC(t,e,n){k(t.__pictorialBundle.children(),function(r){r!==t.__pictorialBarRect&&e.call(n,r)})}function pC(t,e,n,r,i,o){e&&t.attr(e),r.symbolClip&&!i?n&&t.attr(n):n&&al[i?"updateProps":"initProps"](t,n,r.animationModel,r.dataIndex,o)}function gC(t,e,n){var r=n.color,i=n.dataIndex,o=n.itemModel,a=o.getModel("itemStyle").getItemStyle(["color"]),s=o.getModel("emphasis.itemStyle").getItemStyle(),l=o.getShallow("cursor");hC(t,function(t){t.setColor(r),t.setStyle(b({fill:r,opacity:n.opacity},a)),Ls(t,s),l&&(t.cursor=l),t.z2=n.z2});var u={},c=t.__pictorialBarRect;ev(c.style,u,o,r,e.seriesModel,i),Ls(c,u)}function mC(t){var e=Math.round(t);return Math.abs(t-e)<1e-4?e:Math.ceil(t)}function vC(t,e,n,r,i){mg.call(this,t,e,n),this.type=r||"value",this.position=i||"bottom",this.orient=null}function yC(t,e,n){this.dimension="single",this.dimensions=["single"],this._axis=null,this._init(t,e,n),this.model=t}function xC(t,e){e=e||{};var n=t.axis,r={},i=n.position,o=n.orient,a=t.coordinateSystem.getRect(),s=[a.x,a.x+a.width,a.y,a.y+a.height],l={horizontal:{top:s[2],bottom:s[3]},vertical:{left:s[0],right:s[1]}};r.position=["vertical"===o?l.vertical[i]:s[0],"horizontal"===o?l.horizontal[i]:s[3]],r.rotation=Math.PI/2*{horizontal:0,vertical:1}[o],r.labelDirection=r.tickDirection=r.nameDirection={top:-1,bottom:1,right:1,left:-1}[i],t.get("axisTick.inside")&&(r.tickDirection=-r.tickDirection),W(e.labelInside,t.get("axisLabel.inside"))&&(r.labelDirection=-r.labelDirection);var u=e.rotate;return null==u&&(u=t.get("axisLabel.rotate")),r.labelRotation="top"===i?-u:u,r.z2=1,r}ch({type:"pictorialBar",render:function(t,e,n){var r=this.group,i=t.getData(),o=this._data,a=t.coordinateSystem,s=!!a.getBaseAxis().isHorizontal(),l=a.grid.getRect(),u={ecSize:{width:n.getWidth(),height:n.getHeight()},seriesModel:t,coordSys:a,coordSysExtent:[[l.x,l.x+l.width],[l.y,l.y+l.height]],isHorizontal:s,valueDim:KS[+s],categoryDim:KS[1-s]};return i.diff(o).add(function(t){if(i.hasValue(t)){var e=aC(i,t),n=QS(i,t,e,u),o=cC(i,u,n);i.setItemGraphicEl(t,o),r.add(o),gC(o,u,n)}}).update(function(t,e){var n=o.getItemGraphicEl(e);if(i.hasValue(t)){var a=aC(i,t),s=QS(i,t,a,u),l=fC(i,s);n&&l!==n.__pictorialShapeStr&&(r.remove(n),i.setItemGraphicEl(t,null),n=null),n?function(t,e,n){var r=n.animationModel,i=n.dataIndex;$s(t.__pictorialBundle,{position:n.bundlePosition.slice()},r,i),n.symbolRepeat?nC(t,e,n,!0):rC(t,0,n,!0),iC(t,n,!0),oC(t,e,n,!0)}(n,u,s):n=cC(i,u,s,!0),i.setItemGraphicEl(t,n),n.__pictorialSymbolMeta=s,r.add(n),gC(n,u,s)}else r.remove(n)}).remove(function(t){var e=o.getItemGraphicEl(t);e&&dC(o,t,e.__pictorialSymbolMeta.animationModel,e)}).execute(),this._data=i,this.group},dispose:et,remove:function(t,e){var n=this.group,r=this._data;t.get("animation")?r&&r.eachItemGraphicEl(function(e){dC(r,e.dataIndex,t,e)}):n.removeAll()}}),rh(E(vp,"pictorialBar")),ih(om("pictorialBar","roundRect")),vC.prototype={constructor:vC,model:null,isHorizontal:function(){var t=this.position;return"top"===t||"bottom"===t},pointToData:function(t,e){return this.coordinateSystem.pointToData(t,e)[0]},toGlobalCoord:null,toLocalCoord:null},C(vC,mg),Uu.register("single",{create:function(t,e){var n=[];return t.eachComponent("singleAxis",function(r,i){var o=new yC(r,t,e);o.name="single_"+i,o.resize(r,e),r.coordinateSystem=o,n.push(o)}),t.eachSeries(function(e){if("singleAxis"===e.get("coordinateSystem")){var n=t.queryComponents({mainType:"singleAxis",index:e.get("singleAxisIndex"),id:e.get("singleAxisId")})[0];e.coordinateSystem=n&&n.coordinateSystem}}),n},dimensions:(yC.prototype={type:"singleAxis",axisPointerEnabled:!0,constructor:yC,_init:function(t,e,n){var r=new vC(this.dimension,Hp(t),[0,0],t.get("type"),t.get("position"));r.onBand="category"===r.type&&t.get("boundaryGap"),r.inverse=t.get("inverse"),r.orient=t.get("orient"),(t.axis=r).model=t,(r.coordinateSystem=this)._axis=r},update:function(t,e){t.eachSeries(function(t){if(t.coordinateSystem===this){var e=t.getData();k(e.mapDimension(this.dimension,!0),function(t){this._axis.scale.unionExtentFromData(e,t)},this),Fp(this._axis.scale,this._axis.model)}},this)},resize:function(t,e){this._rect=au({left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")},{width:e.getWidth(),height:e.getHeight()}),this._adjustAxis()},getRect:function(){return this._rect},_adjustAxis:function(){var t=this._rect,e=this._axis,n=e.isHorizontal(),r=n?[0,t.width]:[0,t.height],i=e.reverse?1:0;e.setExtent(r[i],r[1-i]),this._updateAxisTransform(e,n?t.x:t.y)},_updateAxisTransform:function(t,e){var n=t.getExtent(),r=n[0]+n[1],i=t.isHorizontal();t.toGlobalCoord=i?function(t){return t+e}:function(t){return r-t+e},t.toLocalCoord=i?function(t){return t-e}:function(t){return r-t+e}},getAxis:function(){return this._axis},getBaseAxis:function(){return this._axis},getAxes:function(){return[this._axis]},getTooltipAxes:function(){return{baseAxes:[this.getAxis()]}},containPoint:function(t){var e=this.getRect(),n=this.getAxis();return"horizontal"===n.orient?n.contain(n.toLocalCoord(t[0]))&&t[1]>=e.y&&t[1]<=e.y+e.height:n.contain(n.toLocalCoord(t[1]))&&t[0]>=e.y&&t[0]<=e.y+e.height},pointToData:function(t){var e=this.getAxis();return[e.coordToData(e.toLocalCoord(t["horizontal"===e.orient?0:1]))]},dataToPoint:function(t){var e=this.getAxis(),n=this.getRect(),r=[],i="horizontal"===e.orient?0:1;return t instanceof Array&&(t=t[0]),r[i]=e.toGlobalCoord(e.dataToCoord(+t)),r[1-i]=0==i?n.y+n.height/2:n.x+n.width/2,r}}).dimensions});var bC=["axisLine","axisTickLabel","axisName"],_C=["splitArea","splitLine"],wC=Gm.extend({type:"singleAxis",axisPointerClass:"SingleAxisPointer",render:function(t,e,n,r){var i=this.group;i.removeAll();var o=this._axisGroup;this._axisGroup=new Cn;var a=xC(t),s=new Am(t,a);k(bC,s.add,s),i.add(this._axisGroup),i.add(s.getGroup()),k(_C,function(e){t.get(e+".show")&&this["_"+e](t)},this),tl(o,this._axisGroup,t),wC.superCall(this,"render",t,e,n,r)},remove:function(){Zm(this)},_splitLine:function(t){var e=t.axis;if(!e.scale.isBlank()){var n=t.getModel("splitLine"),r=n.getModel("lineStyle"),i=r.get("width"),o=r.get("color");o=o instanceof Array?o:[o];for(var a=t.coordinateSystem.getRect(),s=e.isHorizontal(),l=[],u=0,c=e.getTicksCoords({tickModel:n}),d=[],f=[],h=0;h<c.length;++h){var p=e.toGlobalCoord(c[h].coord);s?(d[0]=p,d[1]=a.y,f[0]=p,f[1]=a.y+a.height):(d[0]=a.x,d[1]=p,f[0]=a.x+a.width,f[1]=p);var g=u++%o.length;l[g]=l[g]||[],l[g].push(new Xa({subPixelOptimize:!0,shape:{x1:d[0],y1:d[1],x2:f[0],y2:f[1]},style:{lineWidth:i},silent:!0}))}for(h=0;h<l.length;++h)this.group.add(xs(l[h],{style:{stroke:o[h%o.length],lineDash:r.getLineDash(i),lineWidth:i},silent:!0}))}},_splitArea:function(t){$m(this,this._axisGroup,t,t)}}),SC=gu.extend({type:"singleAxis",layoutMode:"box",axis:null,coordinateSystem:null,getCoordSysModel:function(){return this}});function CC(t,e){var n,r=[],i=t.seriesIndex;if(null==i||!(n=e.getSeriesByIndex(i)))return{point:[]};var o=n.getData(),a=Ri(o,t);if(null==a||a<0||R(a))return{point:[]};var s=o.getItemGraphicEl(a),l=n.coordinateSystem;if(n.getTooltipPosition)r=n.getTooltipPosition(a)||[];else if(l&&l.dataToPoint)r=l.dataToPoint(o.getValues(A(l.dimensions,function(t){return o.mapDimension(t)}),a,!0))||[];else if(s){var u=s.getBoundingRect().clone();u.applyTransform(s.transform),r=[u.x+u.width/2,u.y+u.height/2]}return{point:r,el:s}}v(SC.prototype,qp),gm("single",SC,function(t,e){return e.type||(e.data?"category":"value")},{left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}});var MC=k,TC=E,kC=Li();function AC(t,e,n,r,i){var o=t.axis;if(!o.scale.isBlank()&&o.containData(e))if(t.involveSeries){var a=function(t,e){var n=e.axis,r=n.dim,i=t,o=[],a=Number.MAX_VALUE,s=-1;return MC(e.seriesModels,function(e,l){var u,c,d=e.getData().mapDimension(r,!0);if(e.getAxisTooltipData){var f=e.getAxisTooltipData(d,t,n);c=f.dataIndices,u=f.nestestValue}else{if(!(c=e.getData().indicesOfNearest(d[0],t,"category"===n.type?.5:null)).length)return;u=e.getData().get(d[0],c[0])}if(null!=u&&isFinite(u)){var h=t-u,p=Math.abs(h);p<=a&&((p<a||0<=h&&s<0)&&(a=p,s=h,i=u,o.length=0),MC(c,function(t){o.push({seriesIndex:e.seriesIndex,dataIndexInside:t,dataIndex:e.getData().getRawIndex(t)})}))}}),{payloadBatch:o,snapToValue:i}}(e,t),s=a.payloadBatch,l=a.snapToValue;s[0]&&null==i.seriesIndex&&x(i,s[0]),!r&&t.snap&&o.containData(l)&&null!=l&&(e=l),n.showPointer(t,e,s,i),n.showTooltip(t,a,l)}else n.showPointer(t,e)}function IC(t,e,n,r){t[e.key]={value:n,payloadBatch:r}}function DC(t,e,n,r){var i=n.payloadBatch,o=e.axis,a=o.model,s=e.axisPointerModel;if(e.triggerTooltip&&i.length){var l=e.coordSys.model,u=jm(l),c=t.map[u];c||(c=t.map[u]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},t.list.push(c)),c.dataByAxis.push({axisDim:o.dim,axisIndex:a.componentIndex,axisType:a.type,axisId:a.id,value:r,valueLabelOpt:{precision:s.get("label.precision"),formatter:s.get("label.formatter")},seriesDataIndices:i.slice()})}}function OC(t){var e=t.axis.model,n={},r=n.axisDim=t.axis.dim;return n.axisIndex=n[r+"AxisIndex"]=e.componentIndex,n.axisName=n[r+"AxisName"]=e.name,n.axisId=n[r+"AxisId"]=e.id,n}function PC(t){return!t||null==t[0]||isNaN(t[0])||null==t[1]||isNaN(t[1])}sh({type:"axisPointer",coordSysAxesInfo:null,defaultOption:{show:"auto",triggerOn:null,zlevel:0,z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#aaa",width:1,type:"solid"},shadowStyle:{color:"rgba(150,150,150,0.3)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,shadowBlur:3,shadowColor:"#aaa"},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}}});var EC=Li(),RC=k;function LC(t,e,n){if(!i.node){var r=e.getZr();EC(r).records||(EC(r).records={}),function(t,e){function n(n,r){t.on(n,function(n){var i=function(t){var e={showTip:[],hideTip:[]},n=function(r){var i=e[r.type];i?i.push(r):(r.dispatchAction=n,t.dispatchAction(r))};return{dispatchAction:n,pendings:e}}(e);RC(EC(t).records,function(t){t&&r(t,n,i.dispatchAction)}),function(t,e){var n,r=t.showTip.length,i=t.hideTip.length;r?n=t.showTip[r-1]:i&&(n=t.hideTip[i-1]),n&&(n.dispatchAction=null,e.dispatchAction(n))}(i.pendings,e)})}EC(t).initialized||(EC(t).initialized=!0,n("click",E(BC,"click")),n("mousemove",E(BC,"mousemove")),n("globalout",NC))}(r,e),(EC(r).records[t]||(EC(r).records[t]={})).handler=n}}function NC(t,e,n){t.handler("leave",null,n)}function BC(t,e,n,r){e.handler(t,n,r)}function zC(t,e){if(!i.node){var n=e.getZr();(EC(n).records||{})[t]&&(EC(n).records[t]=null)}}var VC=lh({type:"axisPointer",render:function(t,e,n){var r=e.getComponent("tooltip"),i=t.get("triggerOn")||r&&r.get("triggerOn")||"mousemove|click";LC("axisPointer",n,function(t,e,n){"none"!==i&&("leave"===t||0<=i.indexOf(t))&&n({type:"updateAxisPointer",currTrigger:t,x:e&&e.offsetX,y:e&&e.offsetY})})},remove:function(t,e){zC(e.getZr(),"axisPointer"),VC.superApply(this._model,"remove",arguments)},dispose:function(t,e){zC("axisPointer",e),VC.superApply(this._model,"dispose",arguments)}}),FC=Li(),HC=m,WC=P;function jC(){}function GC(t,e,n,r){!function t(e,n){if(B(e)&&B(n)){var r=!0;return k(n,function(n,i){r=r&&t(e[i],n)}),!!r}return e===n}(FC(n).lastProp,r)&&(FC(n).lastProp=r,e?$s(n,r,t):(n.stopAnimation(),n.attr(r)))}function UC(t,e){t[e.get("label.show")?"show":"hide"]()}function qC(t){return{position:t.position.slice(),rotation:t.rotation||0}}function XC(t,e,n){var r=e.get("z"),i=e.get("zlevel");t&&t.traverse(function(t){"group"!==t.type&&(null!=r&&(t.z=r),null!=i&&(t.zlevel=i),t.silent=n)})}function YC(t){var e,n=t.get("type"),r=t.getModel(n+"Style");return"line"===n?(e=r.getLineStyle()).fill=null:"shadow"===n&&((e=r.getAreaStyle()).stroke=null),e}function $C(t,e,n,r,i){var o=ZC(n.get("value"),e.axis,e.ecModel,n.get("seriesDataIndices"),{precision:n.get("label.precision"),formatter:n.get("label.formatter")}),a=n.getModel("label"),s=Fl(a.get("padding")||0),l=a.getFont(),u=ir(o,l),c=i.position,d=u.width+s[1]+s[3],f=u.height+s[0]+s[2],h=i.align;"right"===h&&(c[0]-=d),"center"===h&&(c[0]-=d/2);var p=i.verticalAlign;"bottom"===p&&(c[1]-=f),"middle"===p&&(c[1]-=f/2),function(t,e,n,r){var i=r.getWidth(),o=r.getHeight();t[0]=Math.min(t[0]+e,i)-e,t[1]=Math.min(t[1]+n,o)-n,t[0]=Math.max(t[0],0),t[1]=Math.max(t[1],0)}(c,d,f,r);var g=a.get("backgroundColor");g&&"auto"!==g||(g=e.get("axisLine.lineStyle.color")),t.label={shape:{x:0,y:0,width:d,height:f,r:a.get("borderRadius")},position:c.slice(),style:{text:o,textFont:l,textFill:a.getTextColor(),textPosition:"inside",textPadding:s,fill:g,stroke:a.get("borderColor")||"transparent",lineWidth:a.get("borderWidth")||0,shadowBlur:a.get("shadowBlur"),shadowColor:a.get("shadowColor"),shadowOffsetX:a.get("shadowOffsetX"),shadowOffsetY:a.get("shadowOffsetY")},z2:10}}function ZC(t,e,n,r,i){t=e.scale.parse(t);var o=e.scale.getLabel(t,{precision:i.precision}),a=i.formatter;if(a){var s={value:jp(e,t),axisDimension:e.dim,axisIndex:e.index,seriesData:[]};k(r,function(t){var e=n.getSeriesByIndex(t.seriesIndex),r=e&&e.getDataParams(t.dataIndexInside);r&&s.seriesData.push(r)}),N(a)?o=a.replace("{value}",o):L(a)&&(o=a(s))}return o}function KC(t,e,n){var r=re();return le(r,r,n.rotation),se(r,r,n.position),Js([t.dataToCoord(e),(n.labelOffset||0)+(n.labelDirection||1)*(n.labelMargin||0)],r)}function JC(t,e,n,r,i,o){var a=Am.innerTextLayout(n.rotation,0,n.labelDirection);n.labelMargin=i.get("label.margin"),$C(e,r,i,o,{position:KC(r.axis,t,n),align:a.textAlign,verticalAlign:a.textVerticalAlign})}function QC(t,e,n){return{x1:t[n=n||0],y1:t[1-n],x2:e[n],y2:e[1-n]}}function tM(t,e,n){return{x:t[n=n||0],y:t[1-n],width:e[n],height:e[1-n]}}function eM(t,e,n,r,i,o){return{cx:t,cy:e,r0:n,r:r,startAngle:i,endAngle:o,clockwise:!0}}Gi((jC.prototype={_group:null,_lastGraphicKey:null,_handle:null,_dragging:!1,_lastValue:null,_lastStatus:null,_payloadInfo:null,animationThreshold:15,render:function(t,e,n,r){var i=e.get("value"),o=e.get("status");if(this._axisModel=t,this._axisPointerModel=e,this._api=n,r||this._lastValue!==i||this._lastStatus!==o){this._lastValue=i,this._lastStatus=o;var a=this._group,s=this._handle;if(!o||"hide"===o)return a&&a.hide(),void(s&&s.hide());a&&a.show(),s&&s.show();var l={};this.makeElOption(l,i,t,e,n);var u=l.graphicKey;u!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=u;var c=this._moveAnimation=this.determineAnimation(t,e);if(a){var d=E(GC,e,c);this.updatePointerEl(a,l,d,e),this.updateLabelEl(a,l,d,e)}else a=this._group=new Cn,this.createPointerEl(a,l,t,e),this.createLabelEl(a,l,t,e),n.getZr().add(a);XC(a,e,!0),this._renderHandle(i)}},remove:function(t){this.clear(t)},dispose:function(t){this.clear(t)},determineAnimation:function(t,e){var n=e.get("animation"),r=t.axis,i="category"===r.type,o=e.get("snap");if(!o&&!i)return!1;if("auto"!==n&&null!=n)return!0===n;var a=this.animationThreshold;if(i&&r.getBandWidth()>a)return!0;if(o){var s=Hm(t).seriesDataCount,l=r.getExtent();return Math.abs(l[0]-l[1])/s>a}return!1},makeElOption:function(t,e,n,r,i){},createPointerEl:function(t,e,n,r){var i=e.pointer;if(i){var o=FC(t).pointerEl=new al[i.type](HC(e.pointer));t.add(o)}},createLabelEl:function(t,e,n,r){if(e.label){var i=FC(t).labelEl=new Ua(HC(e.label));t.add(i),UC(i,r)}},updatePointerEl:function(t,e,n){var r=FC(t).pointerEl;r&&e.pointer&&(r.setStyle(e.pointer.style),n(r,{shape:e.pointer.shape}))},updateLabelEl:function(t,e,n,r){var i=FC(t).labelEl;i&&(i.setStyle(e.label.style),n(i,{shape:e.label.shape,position:e.label.position}),UC(i,r))},_renderHandle:function(t){if(!this._dragging&&this.updateHandleTransform){var e,n=this._axisPointerModel,r=this._api.getZr(),i=this._handle,o=n.getModel("handle"),a=n.get("status");if(!o.get("show")||!a||"hide"===a)return i&&r.remove(i),void(this._handle=null);this._handle||(e=!0,i=this._handle=nl(o.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(t){Gt(t.event)},onmousedown:WC(this._onHandleDragMove,this,0,0),drift:WC(this._onHandleDragMove,this),ondragend:WC(this._onHandleDragEnd,this)}),r.add(i)),XC(i,n,!1),i.setStyle(o.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var s=o.get("size");R(s)||(s=[s,s]),i.attr("scale",[s[0]/2,s[1]/2]),hd(this,"_doDispatchAxisPointer",o.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,e)}},_moveHandleToValue:function(t,e){GC(this._axisPointerModel,!e&&this._moveAnimation,this._handle,qC(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)))},_onHandleDragMove:function(t,e){var n=this._handle;if(n){this._dragging=!0;var r=this.updateHandleTransform(qC(n),[t,e],this._axisModel,this._axisPointerModel);this._payloadInfo=r,n.stopAnimation(),n.attr(qC(r)),FC(n).lastProp=null,this._doDispatchAxisPointer()}},_doDispatchAxisPointer:function(){if(this._handle){var t=this._payloadInfo,e=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:e.axis.dim,axisIndex:e.componentIndex}]})}},_onHandleDragEnd:function(t){if(this._dragging=!1,this._handle){var e=this._axisPointerModel.get("value");this._moveHandleToValue(e),this._api.dispatchAction({type:"hideTip"})}},getHandleTransform:null,updateHandleTransform:null,clear:function(t){this._lastValue=null,this._lastStatus=null;var e=t.getZr(),n=this._group,r=this._handle;e&&n&&(this._lastGraphicKey=null,n&&e.remove(n),r&&e.remove(r),this._group=null,this._handle=null,this._payloadInfo=null)},doClear:function(){},buildLabel:function(t,e,n){return{x:t[n=n||0],y:t[1-n],width:e[n],height:e[1-n]}}}).constructor=jC);var nM=jC.extend({makeElOption:function(t,e,n,r,i){var o=n.axis,a=o.grid,s=r.get("type"),l=rM(a,o).getOtherAxis(o).getGlobalExtent(),u=o.toGlobalCoord(o.dataToCoord(e,!0));if(s&&"none"!==s){var c=YC(r),d=iM[s](o,u,l);d.style=c,t.graphicKey=d.type,t.pointer=d}JC(e,t,Ym(a.model,n),n,r,i)},getHandleTransform:function(t,e,n){var r=Ym(e.axis.grid.model,e,{labelInside:!1});return r.labelMargin=n.get("handle.margin"),{position:KC(e.axis,t,r),rotation:r.rotation+(r.labelDirection<0?Math.PI:0)}},updateHandleTransform:function(t,e,n,r){var i=n.axis,o=i.grid,a=i.getGlobalExtent(!0),s=rM(o,i).getOtherAxis(i).getGlobalExtent(),l="x"===i.dim?0:1,u=t.position;u[l]+=e[l],u[l]=Math.min(a[1],u[l]),u[l]=Math.max(a[0],u[l]);var c=(s[1]+s[0])/2,d=[c,c];return d[l]=u[l],{position:u,rotation:t.rotation,cursorPoint:d,tooltipOption:[{verticalAlign:"middle"},{align:"center"}][l]}}});function rM(t,e){var n={};return n[e.dim+"AxisIndex"]=e.index,t.getCartesian(n)}var iM={line:function(t,e,n){return{type:"Line",subPixelOptimize:!0,shape:QC([e,n[0]],[e,n[1]],oM(t))}},shadow:function(t,e,n){var r=Math.max(1,t.getBandWidth());return{type:"Rect",shape:tM([e-r/2,n[0]],[r,n[1]-n[0]],oM(t))}}};function oM(t){return"x"===t.dim?0:1}Gm.registerAxisPointerClass("CartesianAxisPointer",nM),Qf(function(t){if(t){t.axisPointer&&0!==t.axisPointer.length||(t.axisPointer={});var e=t.axisPointer.link;e&&!R(e)&&(t.axisPointer.link=[e])}}),th(ff.PROCESSOR.STATISTIC,function(t,e){t.getComponent("axisPointer").coordSysAxesInfo=function(t,e){var n={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(t,e,n){var r=e.getComponent("tooltip"),i=e.getComponent("axisPointer"),o=i.get("link",!0)||[],a=[];zm(n.getCoordinateSystems(),function(n){if(n.axisPointerEnabled){var s=jm(n.model),l=t.coordSysAxesInfo[s]={},u=(t.coordSysMap[s]=n).model.getModel("tooltip",r);if(zm(n.getAxes(),Vm(h,!1,null)),n.getTooltipAxes&&r&&u.get("show")){var c="axis"===u.get("trigger"),d="cross"===u.get("axisPointer.type"),f=n.getTooltipAxes(u.get("axisPointer.axis"));(c||d)&&zm(f.baseAxes,Vm(h,!d||"cross",c)),d&&zm(f.otherAxes,Vm(h,"cross",!1))}}function h(r,s,c){var d=c.model.getModel("axisPointer",i),f=d.get("show");if(f&&("auto"!==f||r||Wm(d))){null==s&&(s=d.get("triggerTooltip"));var h=(d=r?function(t,e,n,r,i,o){var a=e.getModel("axisPointer"),s={};zm(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],function(t){s[t]=m(a.get(t))}),s.snap="category"!==t.type&&!!o,"cross"===a.get("type")&&(s.type="line");var l=s.label||(s.label={});if(null==l.show&&(l.show=!1),"cross"===i){var u=a.get("label.show");if(l.show=null==u||u,!o){var c=s.lineStyle=a.get("crossStyle");c&&b(l,c.textStyle)}}return t.model.getModel("axisPointer",new hl(s,n,r))}(c,u,i,e,r,s):d).get("snap"),p=jm(c.model),g=s||h||"category"===c.type,v=t.axesInfo[p]={key:p,axis:c,coordSys:n,axisPointerModel:d,triggerTooltip:s,involveSeries:g,snap:h,useHandle:Wm(d),seriesModels:[]};l[p]=v,t.seriesInvolved|=g;var y=function(t,e){for(var n=e.model,r=e.dim,i=0;i<t.length;i++){var o=t[i]||{};if(Fm(o[r+"AxisId"],n.id)||Fm(o[r+"AxisIndex"],n.componentIndex)||Fm(o[r+"AxisName"],n.name))return i}}(o,c);if(null!=y){var x=a[y]||(a[y]={axesInfo:{}});x.axesInfo[p]=v,x.mapper=o[y].mapper,v.linkGroup=x}}}})}(n,t,e),n.seriesInvolved&&function(t,e){e.eachSeries(function(e){var n=e.coordinateSystem,r=e.get("tooltip.trigger",!0),i=e.get("tooltip.show",!0);n&&"none"!==r&&!1!==r&&"item"!==r&&!1!==i&&!1!==e.get("axisPointer.show",!0)&&zm(t.coordSysAxesInfo[jm(n.model)],function(t){var r=t.axis;n.getAxis(r.dim)===r&&(t.seriesModels.push(e),null==t.seriesDataCount&&(t.seriesDataCount=0),t.seriesDataCount+=e.getData().count())})},this)}(n,t),n}(t,e)}),eh({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},function(t,e,n){var r=t.currTrigger,i=[t.x,t.y],o=t,a=t.dispatchAction||P(n.dispatchAction,n),s=e.getComponent("axisPointer").coordSysAxesInfo;if(s){PC(i)&&(i=CC({seriesIndex:o.seriesIndex,dataIndex:o.dataIndex},e).point);var l=PC(i),u=o.axesInfo,c=s.axesInfo,d="leave"===r||PC(i),f={},h={},p={list:[],map:{}},g={showPointer:TC(IC,h),showTooltip:TC(DC,p)};MC(s.coordSysMap,function(t,e){var n=l||t.containPoint(i);MC(s.coordSysAxesInfo[e],function(t,e){var r=t.axis,o=function(t,e){for(var n=0;n<(t||[]).length;n++){var r=t[n];if(e.axis.dim===r.axisDim&&e.axis.model.componentIndex===r.axisIndex)return r}}(u,t);if(!d&&n&&(!u||o)){var a=o&&o.value;null!=a||l||(a=r.pointToData(i)),null!=a&&AC(t,a,g,!1,f)}})});var m={};return MC(c,function(t,e){var n=t.linkGroup;n&&!h[e]&&MC(n.axesInfo,function(e,r){var i=h[r];if(e!==t&&i){var o=i.value;n.mapper&&(o=t.axis.scale.parse(n.mapper(o,OC(e),OC(t)))),m[t.key]=o}})}),MC(m,function(t,e){AC(c[e],t,g,!0,f)}),function(t,e,n){var r=n.axesInfo=[];MC(e,function(e,n){var i=e.axisPointerModel.option,o=t[n];o?(e.useHandle||(i.status="show"),i.value=o.value,i.seriesDataIndices=(o.payloadBatch||[]).slice()):e.useHandle||(i.status="hide"),"show"===i.status&&r.push({axisDim:e.axis.dim,axisIndex:e.axis.model.componentIndex,value:i.value})})}(h,c,f),function(t,e,n,r){if(PC(e)||!t.list.length)return r({type:"hideTip"});var i=((t.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};r({type:"showTip",escapeConnect:!0,x:e[0],y:e[1],tooltipOption:n.tooltipOption,position:n.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:t.list})}(p,i,t,a),function(t,e,n){var r=n.getZr(),i="axisPointerLastHighlights",o=kC(r)[i]||{},a=kC(r)[i]={};MC(t,function(t,e){var n=t.axisPointerModel.option;"show"===n.status&&MC(n.seriesDataIndices,function(t){a[t.seriesIndex+" | "+t.dataIndex]=t})});var s=[],l=[];k(o,function(t,e){a[e]||l.push(t)}),k(a,function(t,e){o[e]||s.push(t)}),l.length&&n.dispatchAction({type:"downplay",escapeConnect:!0,batch:l}),s.length&&n.dispatchAction({type:"highlight",escapeConnect:!0,batch:s})}(c,0,n),f}});var aM=["x","y"],sM=["width","height"],lM=jC.extend({makeElOption:function(t,e,n,r,i){var o=n.axis,a=o.coordinateSystem,s=dM(a,1-cM(o)),l=a.dataToPoint(e)[0],u=r.get("type");if(u&&"none"!==u){var c=YC(r),d=uM[u](o,l,s);d.style=c,t.graphicKey=d.type,t.pointer=d}JC(e,t,xC(n),n,r,i)},getHandleTransform:function(t,e,n){var r=xC(e,{labelInside:!1});return r.labelMargin=n.get("handle.margin"),{position:KC(e.axis,t,r),rotation:r.rotation+(r.labelDirection<0?Math.PI:0)}},updateHandleTransform:function(t,e,n,r){var i=n.axis,o=i.coordinateSystem,a=cM(i),s=dM(o,a),l=t.position;l[a]+=e[a],l[a]=Math.min(s[1],l[a]),l[a]=Math.max(s[0],l[a]);var u=dM(o,1-a),c=(u[1]+u[0])/2,d=[c,c];return d[a]=l[a],{position:l,rotation:t.rotation,cursorPoint:d,tooltipOption:{verticalAlign:"middle"}}}}),uM={line:function(t,e,n){return{type:"Line",subPixelOptimize:!0,shape:QC([e,n[0]],[e,n[1]],cM(t))}},shadow:function(t,e,n){var r=t.getBandWidth();return{type:"Rect",shape:tM([e-r/2,n[0]],[r,n[1]-n[0]],cM(t))}}};function cM(t){return t.isHorizontal()?0:1}function dM(t,e){var n=t.getRect();return[n[aM[e]],n[aM[e]]+n[sM[e]]]}Gm.registerAxisPointerClass("SingleAxisPointer",lM),lh({type:"single"});var fM=jc.extend({type:"series.themeRiver",dependencies:["singleAxis"],nameMap:null,init:function(t){fM.superApply(this,"init",arguments),this.legendVisualProvider=new Sv(P(this.getData,this),P(this.getRawData,this))},fixData:function(t){var e=t.length,n={},r=Hi(t,function(t){return n.hasOwnProperty(t[0])||(n[t[0]]=-1),t[2]}),i=[];r.buckets.each(function(t,e){i.push({name:e,dataList:t})});for(var o=i.length,a=0;a<o;++a){for(var s=i[a].name,l=0;l<i[a].dataList.length;++l)n[u=i[a].dataList[l][0]]=a;for(var u in n)n.hasOwnProperty(u)&&n[u]!==a&&(n[u]=a,t[e]=[],t[e][0]=u,t[e][1]=0,t[e][2]=s,e++)}return t},getInitialData:function(t,e){for(var n=e.queryComponents({mainType:"singleAxis",index:this.get("singleAxisIndex"),id:this.get("singleAxisId")})[0].get("type"),r=D(t.data,function(t){return void 0!==t[2]}),i=this.fixData(r||[]),o=[],a=this.nameMap=Q(),s=0,l=0;l<i.length;++l)o.push(i[l][2]),a.get(i[l][2])||(a.set(i[l][2],s),s++);var u=Wh(i,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:mh(n)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}),c=new Ah(u,this);return c.initData(i),c},getLayerSeries:function(){for(var t=this.getData(),e=t.count(),n=[],r=0;r<e;++r)n[r]=r;var i=t.mapDimension("single"),o=Hi(n,function(e){return t.get("name",e)}),a=[];return o.buckets.each(function(e,n){e.sort(function(e,n){return t.get(i,e)-t.get(i,n)}),a.push({name:n,indices:e})}),a},getAxisTooltipData:function(t,e,n){R(t)||(t=t?[t]:[]);for(var r,i=this.getData(),o=this.getLayerSeries(),a=[],s=o.length,l=0;l<s;++l){for(var u=Number.MAX_VALUE,c=-1,d=o[l].indices.length,f=0;f<d;++f){var h=i.get(t[0],o[l].indices[f]),p=Math.abs(h-e);p<=u&&(r=h,u=p,c=o[l].indices[f])}a.push(c)}return{dataIndices:a,nestestValue:r}},formatTooltip:function(t){var e=this.getData(),n=e.getName(t),r=e.get(e.mapDimension("value"),t);return!isNaN(r)&&null!=r||(r="-"),jl(n+" : "+r)},defaultOption:{zlevel:0,z:2,coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",color:"#000",fontSize:11},emphasis:{label:{show:!0}}}});function hM(t,e,n){if(t.count())for(var r,i=e.coordinateSystem,o=e.getLayerSeries(),a=t.mapDimension("single"),s=t.mapDimension("value"),l=A(o,function(e){return A(e.indices,function(e){var n=i.dataToPoint(t.get(a,e));return n[1]=t.get(s,e),n})}),u=function(t){for(var e=t.length,n=t[0].length,r=[],i=[],o=0,a={},s=0;s<n;++s){for(var l=0,u=0;l<e;++l)u+=t[l][s][1];o<u&&(o=u),r.push(u)}for(var c=0;c<n;++c)i[c]=(o-r[c])/2;for(var d=o=0;d<n;++d){var f=r[d]+i[d];o<f&&(o=f)}return a.y0=i,a.max=o,a}(l),c=u.y0,d=n/u.max,f=o.length,h=o[0].indices.length,p=0;p<h;++p){t.setItemLayout(o[0].indices[p],{layerIndex:0,x:l[0][p][0],y0:r=c[p]*d,y:l[0][p][1]*d});for(var g=1;g<f;++g)t.setItemLayout(o[g].indices[p],{layerIndex:g,x:l[g][p][0],y0:r+=l[g-1][p][1]*d,y:l[g][p][1]*d})}}ch({type:"themeRiver",init:function(){this._layers=[]},render:function(t,e,n){var r=t.getData(),i=this.group,o=t.getLayerSeries(),a=r.getLayout("layoutInfo");function s(t){return t.name}i.attr("position",[0,a.rect.y+a.boundaryGap[0]]);var l=new fh(this._layersSeries||[],o,s,s),u={};function c(e,n,a){var s=this._layers;if("remove"!==e){for(var l,c,d,f=[],h=[],p=o[n].indices,g=0;g<p.length;g++){var m=r.getItemLayout(p[g]),v=m.x,y=m.y0,b=m.y;f.push([v,y]),h.push([v,y+b]),l=r.getItemVisual(p[g],"color")}var _=r.getItemLayout(p[0]),w=r.getItemModel(p[g-1]),S=w.getModel("label"),C=S.get("margin");if("add"===e){var M=u[n]=new Cn;c=new Zg({shape:{points:f,stackedOnPoints:h,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),d=new Da({style:{x:_.x-C,y:_.y0+_.y/2}}),M.add(c),M.add(d),i.add(M),c.setClipPath(function(t,e,n){var r=new Ua({shape:{x:t.x-10,y:t.y-10,width:0,height:t.height+20}});return Zs(r,{shape:{width:t.width+20,height:t.height+20}},e,function(){c.removeClipPath()}),r}(c.getBoundingRect(),t))}else c=(M=s[a]).childAt(0),d=M.childAt(1),i.add(M),u[n]=M,$s(c,{shape:{points:f,stackedOnPoints:h}},t),$s(d,{style:{x:_.x-C,y:_.y0+_.y/2}},t);var T=w.getModel("emphasis.itemStyle"),k=w.getModel("itemStyle");Hs(d.style,S,{text:S.get("show")?t.getFormattedLabel(p[g-1],"normal")||r.getName(p[g-1]):null,textVerticalAlign:"middle"}),c.setStyle(x({fill:l},k.getItemStyle(["color"]))),Ls(c,T.getItemStyle())}else i.remove(s[n])}l.add(P(c,this,"add")).update(P(c,this,"update")).remove(P(c,this,"remove")).execute(),this._layersSeries=o,this._layers=u},dispose:function(){}}),rh(function(t,e){t.eachSeriesByType("themeRiver",function(t){var e=t.getData(),n=t.coordinateSystem,r={},i=n.getRect();r.rect=i;var o=t.get("boundaryGap"),a=n.getAxis();r.boundaryGap=o,"horizontal"===a.orient?(o[0]=bl(o[0],i.height),o[1]=bl(o[1],i.height),hM(e,t,i.height-o[0]-o[1])):(o[0]=bl(o[0],i.width),o[1]=bl(o[1],i.width),hM(e,t,i.width-o[0]-o[1])),e.setLayout("layoutInfo",r)})}),ih(function(t){t.eachSeriesByType("themeRiver",function(t){var e=t.getData(),n=t.getRawData(),r=t.get("color"),i=Q();e.each(function(t){i.set(e.getRawIndex(t),t)}),n.each(function(o){var a=n.getName(o),s=r[(t.nameMap.get(a)-1)%r.length];n.setItemVisual(o,"color",s);var l=i.get(o);null!=l&&e.setItemVisual(l,"color",s)})})}),th(Nv("themeRiver")),jc.extend({type:"series.sunburst",_viewRoot:null,getInitialData:function(t,e){var n={name:t.name,children:t.data};!function t(e){var n=0;k(e.children,function(e){t(e);var r=e.value;R(r)&&(r=r[0]),n+=r});var r=e.value;R(r)&&(r=r[0]),null!=r&&!isNaN(r)||(r=n),r<0&&(r=0),R(e.value)?e.value[0]=r:e.value=r}(n);var r=A(t.levels||[],function(t){return new hl(t,this,e)},this),i=Qy.createTree(n,this,function(t){t.wrapMethod("getItemModel",function(t,e){var n=i.getNodeByDataIndex(e),o=r[n.depth];return o&&(t.parentModel=o),t})});return i.data},optionUpdated:function(){this.resetViewRoot()},getDataParams:function(t){var e=jc.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(t);return e.treePathInfo=yx(n,this),e},defaultOption:{zlevel:0,z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,percentPrecision:2,stillShowZeroSum:!0,highlightPolicy:"descendant",nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},highlight:{itemStyle:{opacity:1}},downplay:{itemStyle:{opacity:.5},label:{opacity:.6}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicOut",data:[],levels:[],sort:"desc"},getViewRoot:function(){return this._viewRoot},resetViewRoot:function(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this._viewRoot=e)}});var pM="none";function gM(t,e,n){Cn.call(this);var r=new Ra({z2:2});r.seriesIndex=e.seriesIndex;var i=new Da({z2:4,silent:t.getModel("label").get("silent")});function o(){i.ignore=i.hoverIgnore}function a(){i.ignore=i.normalIgnore}this.add(r),this.add(i),this.updateData(!0,t,"normal",e,n),this.on("emphasis",o).on("normal",a).on("mouseover",o).on("mouseout",a)}var mM=gM.prototype;mM.updateData=function(t,e,n,r,i){(this.node=e).piece=this,r=r||this._seriesModel,i=i||this._ecModel;var o=this.childAt(0);o.dataIndex=e.dataIndex;var a=e.getModel(),s=e.getLayout(),l=x({},s);l.label=null;var u=function(t,e,n){var r=t.getVisual("color"),i=t.getVisual("visualMeta");i&&0!==i.length||(r=null);var o=t.getModel("itemStyle").get("color");if(o)return o;if(r)return r;if(0===t.depth)return n.option.color[0];var a=n.option.color.length;return n.option.color[function(t){for(var e=t;1<e.depth;)e=e.parentNode;return S(t.getAncestors()[0].children,e)}(t)%a]}(e,0,i);!function(t,e,n){e.getData().setItemVisual(t.dataIndex,"color",n)}(e,r,u);var c,d=a.getModel("itemStyle").getItemStyle();c=b({lineJoin:"bevel",fill:(c="normal"===n?d:v(a.getModel(n+".itemStyle").getItemStyle(),d)).fill||u},c),t?(o.setShape(l),o.shape.r=s.r0,$s(o,{shape:{r:s.r}},r,e.dataIndex),o.useStyle(c)):"object"==typeof c.fill&&c.fill.type||"object"==typeof o.style.fill&&o.style.fill.type?($s(o,{shape:l},r),o.useStyle(c)):$s(o,{shape:l,style:c},r),this._updateLabel(r,u,n);var f=a.getShallow("cursor");if(f&&o.attr("cursor",f),t){var h=r.getShallow("highlightPolicy");this._initEvents(o,e,r,h)}this._seriesModel=r||this._seriesModel,this._ecModel=i||this._ecModel,Ls(this)},mM.onEmphasis=function(t){var e=this;this.node.hostTree.root.eachNode(function(n){n.piece&&(e.node===n?n.piece.updateData(!1,n,"emphasis"):function(t,e,n){return n!==pM&&("self"===n?t===e:"ancestor"===n?t===e||t.isAncestorOf(e):t===e||t.isDescendantOf(e))}(n,e.node,t)?n.piece.childAt(0).trigger("highlight"):t!==pM&&n.piece.childAt(0).trigger("downplay"))})},mM.onNormal=function(){this.node.hostTree.root.eachNode(function(t){t.piece&&t.piece.updateData(!1,t,"normal")})},mM.onHighlight=function(){this.updateData(!1,this.node,"highlight")},mM.onDownplay=function(){this.updateData(!1,this.node,"downplay")},mM._updateLabel=function(t,e,n){var r=this.node.getModel(),i=r.getModel("label"),o="normal"===n||"emphasis"===n?i:r.getModel(n+".label"),a=r.getModel("emphasis.label"),s=o.get("formatter")?n:"normal",l=W(t.getFormattedLabel(this.node.dataIndex,s,null,null,"label"),this.node.name);!1===_("show")&&(l="");var u=this.node.getLayout(),c=o.get("minAngle");null==c&&(c=i.get("minAngle")),null!=(c=c/180*Math.PI)&&Math.abs(u.endAngle-u.startAngle)<c&&(l="");var d=this.childAt(1);Vs(d.style,d.hoverStyle||{},i,a,{defaultText:o.getShallow("show")?l:null,autoColor:e,useInsideStyle:!0});var f,h=(u.startAngle+u.endAngle)/2,p=Math.cos(h),g=Math.sin(h),m=_("position"),v=_("distance")||0,y=_("align");"outside"===m?(f=u.r+v,y=h>Math.PI/2?"right":"left"):y&&"center"!==y?"left"===y?(f=u.r0+v,h>Math.PI/2&&(y="right")):"right"===y&&(f=u.r-v,h>Math.PI/2&&(y="left")):(f=(u.r+u.r0)/2,y="center"),d.attr("style",{text:l,textAlign:y,textVerticalAlign:_("verticalAlign")||"middle",opacity:_("opacity")}),d.attr("position",[f*p+u.cx,f*g+u.cy]);var x=_("rotate"),b=0;function _(t){var e=o.get(t);return null==e?i.get(t):e}"radial"===x?(b=-h)<-Math.PI/2&&(b+=Math.PI):"tangential"===x?(b=Math.PI/2-h)>Math.PI/2?b-=Math.PI:b<-Math.PI/2&&(b+=Math.PI):"number"==typeof x&&(b=x*Math.PI/180),d.attr("rotation",b)},mM._initEvents=function(t,e,n,r){function i(){a.onEmphasis(r)}function o(){a.onNormal()}t.off("mouseover").off("mouseout").off("emphasis").off("normal");var a=this;n.isAnimationEnabled()&&t.on("mouseover",i).on("mouseout",o).on("emphasis",i).on("normal",o).on("downplay",function(){a.onDownplay()}).on("highlight",function(){a.onHighlight()})},C(gM,Cn),nd.extend({type:"sunburst",init:function(){},render:function(t,e,n,r){var i=this;this.seriesModel=t,this.api=n,this.ecModel=e;var o=t.getData(),a=o.tree.root,s=t.getViewRoot(),l=this.group,u=t.get("renderLabelForZeroData"),c=[];if(s.eachNode(function(t){c.push(t)}),function(n,r){function i(t){return t.getId()}function s(i,s){!function(n,r){if(u||!n||n.getValue()||(n=null),n!==a&&r!==a)if(r&&r.piece)n?(r.piece.updateData(!1,n,"normal",t,e),o.setItemGraphicEl(n.dataIndex,r.piece)):function(t){t&&t.piece&&(l.remove(t.piece),t.piece=null)}(r);else if(n){var i=new gM(n,t,e);l.add(i),o.setItemGraphicEl(n.dataIndex,i)}}(null==i?null:n[i],null==s?null:r[s])}0===n.length&&0===r.length||new fh(r,n,i,i).add(s).update(s).remove(E(s,null)).execute()}(c,this._oldChildren||[]),function(n,r){if(0<r.depth){i.virtualPiece?i.virtualPiece.updateData(!1,n,"normal",t,e):(i.virtualPiece=new gM(n,t,e),l.add(i.virtualPiece)),r.piece._onclickEvent&&r.piece.off("click",r.piece._onclickEvent);var o=function(t){i._rootToNode(r.parentNode)};r.piece._onclickEvent=o,i.virtualPiece.on("click",o)}else i.virtualPiece&&(l.remove(i.virtualPiece),i.virtualPiece=null)}(a,s),r&&r.highlight&&r.highlight.piece){var d=t.getShallow("highlightPolicy");r.highlight.piece.onEmphasis(d)}else if(r&&r.unhighlight){var f=this.virtualPiece;!f&&a.children.length&&(f=a.children[0].piece),f&&f.onNormal()}this._initEvents(),this._oldChildren=c},dispose:function(){},_initEvents:function(){function t(t){var n=!1;e.seriesModel.getViewRoot().eachNode(function(r){if(!n&&r.piece&&r.piece.childAt(0)===t.target){var i=r.getModel().get("nodeClick");if("rootToNode"===i)e._rootToNode(r);else if("link"===i){var o=r.getModel(),a=o.get("link");a&&Ql(a,o.get("target",!0)||"_blank")}n=!0}})}var e=this;this.group._onclickEvent&&this.group.off("click",this.group._onclickEvent),this.group.on("click",t),this.group._onclickEvent=t},_rootToNode:function(t){t!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:"sunburstRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t})},containPoint:function(t,e){var n=e.getData().getItemLayout(0);if(n){var r=t[0]-n.cx,i=t[1]-n.cy,o=Math.sqrt(r*r+i*i);return o<=n.r&&o>=n.r0}}});var vM="sunburstRootToNode";eh({type:vM,update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"sunburst",query:t},function(e,n){var r=gx(t,[vM],e);if(r){var i=e.getViewRoot();i&&(t.direction=vx(i,r.node)?"rollUp":"drillDown"),e.resetViewRoot(r.node)}})});var yM="sunburstHighlight";eh({type:yM,update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"sunburst",query:t},function(e,n){var r=gx(t,[yM],e);r&&(t.highlight=r.node)})}),eh({type:"sunburstUnhighlight",update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"sunburst",query:t},function(e,n){t.unhighlight=!0})});var xM=Math.PI/180;function bM(t,e){return e=e||[0,0],A(["x","y"],function(n,r){var i=this.getAxis(n),o=e[r],a=t[r]/2;return"category"===i.type?i.getBandWidth():Math.abs(i.dataToCoord(o-a)-i.dataToCoord(o+a))},this)}function _M(t,e){return e=e||[0,0],A([0,1],function(n){var r=e[n],i=t[n]/2,o=[],a=[];return o[n]=r-i,a[n]=r+i,o[1-n]=a[1-n]=e[1-n],Math.abs(this.dataToPoint(o)[n]-this.dataToPoint(a)[n])},this)}function wM(t,e){var n=this.getAxis(),r=e instanceof Array?e[0]:e,i=(t instanceof Array?t[0]:t)/2;return"category"===n.type?n.getBandWidth():Math.abs(n.dataToCoord(r-i)-n.dataToCoord(r+i))}function SM(t,e){return A(["Radius","Angle"],function(n,r){var i=this["get"+n+"Axis"](),o=e[r],a=t[r]/2,s="dataTo"+n,l="category"===i.type?i.getBandWidth():Math.abs(i[s](o-a)-i[s](o+a));return"Angle"===n&&(l=l*Math.PI/180),l},this)}ih(E(Dv,"sunburst")),rh(E(function(t,e,n,r){e.eachSeriesByType(t,function(t){var e=t.get("center"),r=t.get("radius");R(r)||(r=[0,r]),R(e)||(e=[e,e]);var i=n.getWidth(),o=n.getHeight(),a=Math.min(i,o),s=bl(e[0],i),l=bl(e[1],o),u=bl(r[0],a/2),c=bl(r[1],a/2),d=-t.get("startAngle")*xM,f=t.get("minAngle")*xM,h=t.getData().tree.root,p=t.getViewRoot(),g=p.depth,m=t.get("sort");null!=m&&function t(e,n){var r=e.children||[];e.children=function(t,e){if("function"==typeof e)return t.sort(e);var n="asc"===e;return t.sort(function(t,e){var r=(t.getValue()-e.getValue())*(n?1:-1);return 0==r?(t.dataIndex-e.dataIndex)*(n?-1:1):r})}(r,n),r.length&&k(e.children,function(e){t(e,n)})}(p,m);var v=0;k(p.children,function(t){isNaN(t.getValue())||v++});var y=p.getValue(),x=Math.PI/(y||v)*2,b=0<p.depth,_=(c-u)/(p.height-(b?-1:1)||1),w=t.get("clockwise"),S=t.get("stillShowZeroSum"),C=w?1:-1,M=function(t,e){if(t){var n=e;if(t!==h){var r=t.getValue(),i=0===y&&S?x:r*x;i<f&&(i=f),n=e+C*i;var o=t.depth-g-(b?-1:1),c=u+_*o,d=u+_*(1+o),p=t.getModel();null!=p.get("r0")&&(c=bl(p.get("r0"),a/2)),null!=p.get("r")&&(d=bl(p.get("r"),a/2)),t.setLayout({angle:i,startAngle:e,endAngle:n,clockwise:w,cx:s,cy:l,r0:c,r:d})}if(t.children&&t.children.length){var m=0;k(t.children,function(t){m+=M(t,e+m)})}return n-e}};if(b){var T=2*Math.PI;h.setLayout({angle:T,startAngle:d,endAngle:d+T,clockwise:w,cx:s,cy:l,r0:u,r:u+_})}M(p,d)})},"sunburst")),th(E(Nv,"sunburst"));var CM=ss,MM=["itemStyle"],TM=["emphasis","itemStyle"],kM=["label"],AM=["emphasis","label"],IM={cartesian2d:function(t){var e=t.grid.getRect();return{coordSys:{type:"cartesian2d",x:e.x,y:e.y,width:e.width,height:e.height},api:{coord:function(e){return t.dataToPoint(e)},size:P(bM,t)}}},geo:function(t){var e=t.getBoundingRect();return{coordSys:{type:"geo",x:e.x,y:e.y,width:e.width,height:e.height,zoom:t.getZoom()},api:{coord:function(e){return t.dataToPoint(e)},size:P(_M,t)}}},singleAxis:function(t){var e=t.getRect();return{coordSys:{type:"singleAxis",x:e.x,y:e.y,width:e.width,height:e.height},api:{coord:function(e){return t.dataToPoint(e)},size:P(wM,t)}}},polar:function(t){var e=t.getRadiusAxis(),n=t.getAngleAxis(),r=e.getExtent();return r[0]>r[1]&&r.reverse(),{coordSys:{type:"polar",cx:t.cx,cy:t.cy,r:r[1],r0:r[0]},api:{coord:P(function(r){var i=e.dataToRadius(r[0]),o=n.dataToAngle(r[1]),a=t.coordToPoint([i,o]);return a.push(i,o*Math.PI/180),a}),size:P(SM,t)}}},calendar:function(t){var e=t.getRect(),n=t.getRangeInfo();return{coordSys:{type:"calendar",x:e.x,y:e.y,width:e.width,height:e.height,cellWidth:t.getCellWidth(),cellHeight:t.getCellHeight(),rangeInfo:{start:n.start,end:n.end,weeks:n.weeks,dayCount:n.allDay}},api:{coord:function(e,n){return t.dataToPoint(e,n)}}}}};function DM(t,e,n,r,i){null==n[t]||i||(e[t]=n[t],n[t]=r[t])}function OM(t,e,n,r){var i=t.get("renderItem"),o=t.coordinateSystem,a={};o&&(a=o.prepareCustoms?o.prepareCustoms():IM[o.type](o));var s,l,u,c,d,f=b({getWidth:r.getWidth,getHeight:r.getHeight,getZr:r.getZr,getDevicePixelRatio:r.getDevicePixelRatio,value:function(t,n){return null==n&&(n=s),e.get(e.getDimension(t||0),n)},style:function(n,r){null==r&&(r=s),g(r);var i=l.getModel(MM).getItemStyle();null!=d&&(i.fill=d);var o=e.getItemVisual(r,"opacity");null!=o&&(i.opacity=o);var a=n?NM(n,u):u;return Hs(i,a,null,{autoColor:d,isRectText:!0}),i.text=a.getShallow("show")?j(t.getFormattedLabel(r,"normal"),_g(e,r)):null,n&&BM(i,n),i},styleEmphasis:function(n,r){null==r&&(r=s),g(r);var i=l.getModel(TM).getItemStyle(),o=n?NM(n,c):c;return Hs(i,o,null,{isRectText:!0},!0),i.text=o.getShallow("show")?G(t.getFormattedLabel(r,"emphasis"),t.getFormattedLabel(r,"normal"),_g(e,r)):null,n&&BM(i,n),i},visual:function(t,n){return null==n&&(n=s),e.getItemVisual(n,t)},barLayout:function(t){if(o.getBaseAxis)return function(t){var e=[],n=t.axis;if("category"===n.type){for(var r=n.getBandWidth(),i=0;i<t.count;i++)e.push(b({bandWidth:r,axisKey:"axis0",stackId:up+i},t));var o=gp(e),a=[];for(i=0;i<t.count;i++){var s=o.axis0[up+i];s.offsetCenter=s.offset+s.width/2,a.push(s)}return a}}(b({axis:o.getBaseAxis()},t))},currentSeriesIndices:function(){return n.getCurrentSeriesIndices()},font:function(t){return Xs(t,n)}},a.api||{}),h={context:{},seriesId:t.id,seriesName:t.name,seriesIndex:t.seriesIndex,coordSys:a.coordSys,dataInsideLength:e.count(),encode:function(t){var e={};return k(t.dimensions,function(n,r){var i=t.getDimensionInfo(n);if(!i.isExtraCoord){var o=i.coordDim;(e[o]=e[o]||[])[i.coordDimIndex]=r}}),e}(t.getData())},p=!0;return function(t,n){return s=t,p=!0,i&&i(b({dataIndexInside:t,dataIndex:e.getRawIndex(t),actionType:n?n.type:null},h),f)};function g(t){null==t&&(t=s),p&&(l=e.getItemModel(t),u=l.getModel(kM),c=l.getModel(AM),d=e.getItemVisual(t,"color"),p=!1)}}function PM(t,e,n,r,i,o){return(t=EM(t,e,n,r,i,o,!0))&&o.setItemGraphicEl(e,t),t}function EM(t,e,n,r,i,o,a){var s=!n,l=(n=n||{}).type,u=n.shape,c=n.style;if(t&&(s||null!=l&&l!==t.__customGraphicType||"path"===l&&function(t){return t&&(t.hasOwnProperty("pathData")||t.hasOwnProperty("d"))}(u)&&VM(u)!==t.__customPathData||"image"===l&&FM(c,"image")&&c.image!==t.__customImagePath||"text"===l&&FM(u,"text")&&c.text!==t.__customText)&&(i.remove(t),t=null),!s){var d=!t;return function(t,e,n,r,i,o,a){var s={},l=n.style||{};if(n.shape&&(s.shape=m(n.shape)),n.position&&(s.position=n.position.slice()),n.scale&&(s.scale=n.scale.slice()),n.origin&&(s.origin=n.origin.slice()),n.rotation&&(s.rotation=n.rotation),"image"===t.type&&n.style){var u=s.style={};k(["x","y","width","height"],function(e){DM(e,u,l,t.style,o)})}if("text"===t.type&&n.style&&(u=s.style={},k(["x","y"],function(e){DM(e,u,l,t.style,o)}),!l.hasOwnProperty("textFill")&&l.fill&&(l.textFill=l.fill),!l.hasOwnProperty("textStroke")&&l.stroke&&(l.textStroke=l.stroke)),"group"!==t.type&&(t.useStyle(l),o)){t.style.opacity=0;var c=l.opacity;null==c&&(c=1),Zs(t,{style:{opacity:c}},r,e)}o?t.attr(s):$s(t,s,r,e),n.hasOwnProperty("z2")&&t.attr("z2",n.z2||0),n.hasOwnProperty("silent")&&t.attr("silent",n.silent),n.hasOwnProperty("invisible")&&t.attr("invisible",n.invisible),n.hasOwnProperty("ignore")&&t.attr("ignore",n.ignore),n.hasOwnProperty("info")&&t.attr("info",n.info);var d=n.styleEmphasis;Is(t,d),a&&Ns(t,!1!==d)}(t=t||function(t){var e,n=t.type;if("path"===n){var r=t.shape,i=null!=r.width&&null!=r.height?{x:r.x||0,y:r.y||0,width:r.width,height:r.height}:null,o=VM(r);(e=ms(o,null,i,r.layout||"center")).__customPathData=o}else if("image"===n)(e=new Wr({})).__customImagePath=t.style.image;else if("text"===n)(e=new Da({})).__customText=t.style.text;else if("group"===n)e=new Cn;else{if("compoundPath"===n)throw new Error('"compoundPath" is not supported yet.');e=new(gs(n))}return e.__customGraphicType=n,e.name=t.name,e}(n),e,n,r,0,d,a),"group"===l&&function(t,e,n,r,i){var o=n.children,a=o?o.length:0,s=n.$mergeChildren,l="byName"===s||n.diffChildrenByName,u=!1===s;if(a||l||u){if(l)return function(t){new fh(t.oldChildren,t.newChildren,RM,RM,t).add(LM).update(LM).remove(zM).execute()}({oldChildren:t.children()||[],newChildren:o||[],dataIndex:e,animatableModel:r,group:t,data:i});u&&t.removeAll();for(var c=0;c<a;c++)o[c]&&EM(t.childAt(c),e,o[c],r,t,i)}}(t,e,n,r,o),i.add(t),t}}function RM(t,e){var n=t&&t.name;return null!=n?n:"e\0\0"+e}function LM(t,e){var n=this.context;EM(null!=e?n.oldChildren[e]:null,n.dataIndex,null!=t?n.newChildren[t]:null,n.animatableModel,n.group,n.data)}function NM(t,e){var n=new hl({},e);return k(CM,function(e,r){t.hasOwnProperty(e)&&(n.option[r]=t[e])}),n}function BM(t,e){for(var n in e)!e.hasOwnProperty(n)&&CM.hasOwnProperty(n)||(t[n]=e[n])}function zM(t){var e=this.context,n=e.oldChildren[t];n&&e.group.remove(n)}function VM(t){return t&&(t.pathData||t.d)}function FM(t,e){return t&&t.hasOwnProperty(e)}function HM(t){return t.get("stack")||"__ec_stack_"+t.seriesIndex}function WM(t,e){return e.dim+t.model.componentIndex}function jM(t,e){mg.call(this,"radius",t,e),this.type="category"}jc.extend({type:"series.custom",dependencies:["grid","polar","geo","singleAxis","calendar"],defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,useTransform:!0,clip:!1},getInitialData:function(t,e){return $h(this.getSource(),this)},getDataParams:function(t,e,n){var r=jc.prototype.getDataParams.apply(this,arguments);return n&&(r.info=n.info),r}}),nd.extend({type:"custom",_data:null,render:function(t,e,n,r){var i=this._data,o=t.getData(),a=this.group,s=OM(t,o,e,n);o.diff(i).add(function(e){PM(null,e,s(e,r),t,a,o)}).update(function(e,n){PM(i.getItemGraphicEl(n),e,s(e,r),t,a,o)}).remove(function(t){var e=i.getItemGraphicEl(t);e&&a.remove(e)}).execute();var l=t.get("clip",!0)?Qg(t.coordinateSystem,!1,t):null;l?a.setClipPath(l):a.removeClipPath(),this._data=o},incrementalPrepareRender:function(t,e,n){this.group.removeAll(),this._data=null},incrementalRender:function(t,e,n,r,i){var o=e.getData(),a=OM(e,o,n,r);function s(t){t.isGroup||(t.incremental=!0,t.useHoverLayer=!0)}for(var l=t.start;l<t.end;l++)PM(null,l,a(l,i),e,this.group,o).traverse(s)},dispose:et,filterForExposedEvent:function(t,e,n,r){var i=e.element;if(null==i||n.name===i)return!0;for(;(n=n.parent)&&n!==this.group;)if(n.name===i)return!0;return!1}}),jM.prototype={constructor:jM,pointToData:function(t,e){return this.polar.pointToData(t,e)["radius"===this.dim?0:1]},dataToRadius:mg.prototype.dataToCoord,radiusToData:mg.prototype.coordToData},C(jM,mg);var GM=Li();function UM(t,e){mg.call(this,"angle",t,e=e||[0,360]),this.type="category"}function qM(t){this.name=t||"",this.cx=0,this.cy=0,this._radiusAxis=new jM,this._angleAxis=new UM,this._radiusAxis.polar=this._angleAxis.polar=this}UM.prototype={constructor:UM,pointToData:function(t,e){return this.polar.pointToData(t,e)["radius"===this.dim?0:1]},dataToAngle:mg.prototype.dataToCoord,angleToData:mg.prototype.coordToData,calculateCategoryInterval:function(){var t=this.getLabelModel(),e=this.scale,n=e.getExtent(),r=e.count();if(n[1]-n[0]<1)return 0;var i=n[0],o=this.dataToCoord(i+1)-this.dataToCoord(i),a=Math.abs(o),s=ir(i,t.getFont(),"center","top"),l=Math.max(s.height,7)/a;isNaN(l)&&(l=1/0);var u=Math.max(0,Math.floor(l)),c=GM(this.model),d=c.lastAutoInterval,f=c.lastTickCount;return null!=d&&null!=f&&Math.abs(d-u)<=1&&Math.abs(f-r)<=1&&u<d?u=d:(c.lastTickCount=r,c.lastAutoInterval=u),u}},C(UM,mg),qM.prototype={type:"polar",axisPointerEnabled:!0,constructor:qM,dimensions:["radius","angle"],model:null,containPoint:function(t){var e=this.pointToCoord(t);return this._radiusAxis.contain(e[0])&&this._angleAxis.contain(e[1])},containData:function(t){return this._radiusAxis.containData(t[0])&&this._angleAxis.containData(t[1])},getAxis:function(t){return this["_"+t+"Axis"]},getAxes:function(){return[this._radiusAxis,this._angleAxis]},getAxesByScale:function(t){var e=[],n=this._angleAxis,r=this._radiusAxis;return n.scale.type===t&&e.push(n),r.scale.type===t&&e.push(r),e},getAngleAxis:function(){return this._angleAxis},getRadiusAxis:function(){return this._radiusAxis},getOtherAxis:function(t){var e=this._angleAxis;return t===e?this._radiusAxis:e},getBaseAxis:function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},getTooltipAxes:function(t){var e=null!=t&&"auto"!==t?this.getAxis(t):this.getBaseAxis();return{baseAxes:[e],otherAxes:[this.getOtherAxis(e)]}},dataToPoint:function(t,e){return this.coordToPoint([this._radiusAxis.dataToRadius(t[0],e),this._angleAxis.dataToAngle(t[1],e)])},pointToData:function(t,e){var n=this.pointToCoord(t);return[this._radiusAxis.radiusToData(n[0],e),this._angleAxis.angleToData(n[1],e)]},pointToCoord:function(t){var e=t[0]-this.cx,n=t[1]-this.cy,r=this.getAngleAxis(),i=r.getExtent(),o=Math.min(i[0],i[1]),a=Math.max(i[0],i[1]);r.inverse?o=a-360:a=o+360;var s=Math.sqrt(e*e+n*n);e/=s,n/=s;for(var l=Math.atan2(-n,e)/Math.PI*180,u=l<o?1:-1;l<o||a<l;)l+=360*u;return[s,l]},coordToPoint:function(t){var e=t[0],n=t[1]/180*Math.PI;return[Math.cos(n)*e+this.cx,-Math.sin(n)*e+this.cy]},getArea:function(){var t=this.getAngleAxis(),e=this.getRadiusAxis().getExtent().slice();e[0]>e[1]&&e.reverse();var n=t.getExtent(),r=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:e[0],r:e[1],startAngle:-n[0]*r,endAngle:-n[1]*r,clockwise:t.inverse,contain:function(t,e){var n=t-this.cx,r=e-this.cy,i=n*n+r*r,o=this.r,a=this.r0;return i<=o*o&&a*a<=i}}}};var XM=gu.extend({type:"polarAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"polar",index:this.option.polarIndex,id:this.option.polarId})[0]}});function YM(t,e){return e.type||(e.data?"category":"value")}function $M(t,e){var n=this,r=n.getAngleAxis(),i=n.getRadiusAxis();if(r.scale.setExtent(1/0,-1/0),i.scale.setExtent(1/0,-1/0),t.eachSeries(function(t){if(t.coordinateSystem===n){var e=t.getData();k(e.mapDimension("radius",!0),function(t){i.scale.unionExtentFromData(e,Yh(e,t))}),k(e.mapDimension("angle",!0),function(t){r.scale.unionExtentFromData(e,Yh(e,t))})}}),Fp(r.scale,r.model),Fp(i.scale,i.model),"category"===r.type&&!r.onBand){var o=r.getExtent(),a=360/r.scale.count();r.inverse?o[1]+=a:o[1]-=a,r.setExtent(o[0],o[1])}}function ZM(t,e){if(t.type=e.get("type"),t.scale=Hp(e),t.onBand=e.get("boundaryGap")&&"category"===t.type,t.inverse=e.get("inverse"),"angleAxis"===e.mainType){t.inverse^=e.get("clockwise");var n=e.get("startAngle");t.setExtent(n,n+(t.inverse?-360:360))}(e.axis=t).model=e}v(XM.prototype,qp),gm("angle",XM,YM,{startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:!1}}),gm("radius",XM,YM,{splitNumber:5}),sh({type:"polar",dependencies:["polarAxis","angleAxis"],coordinateSystem:null,findAxisModel:function(t){var e;return this.ecModel.eachComponent(t,function(t){t.getCoordSysModel()===this&&(e=t)},this),e},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"80%"}}),Uu.register("polar",{dimensions:qM.prototype.dimensions,create:function(t,e){var n=[];return t.eachComponent("polar",function(t,r){var i=new qM(r);i.update=$M;var o=i.getRadiusAxis(),a=i.getAngleAxis(),s=t.findAxisModel("radiusAxis"),l=t.findAxisModel("angleAxis");ZM(o,s),ZM(a,l),function(t,e,n){var r=e.get("center"),i=n.getWidth(),o=n.getHeight();t.cx=bl(r[0],i),t.cy=bl(r[1],o);var a=t.getRadiusAxis(),s=Math.min(i,o)/2,l=e.get("radius");null==l?l=[0,"100%"]:R(l)||(l=[0,l]),l=[bl(l[0],s),bl(l[1],s)],a.inverse?a.setExtent(l[1],l[0]):a.setExtent(l[0],l[1])}(i,t,e),n.push(i),(t.coordinateSystem=i).model=t}),t.eachSeries(function(e){if("polar"===e.get("coordinateSystem")){var n=t.queryComponents({mainType:"polar",index:e.get("polarIndex"),id:e.get("polarId")})[0];e.coordinateSystem=n.coordinateSystem}}),n}});var KM=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function JM(t,e,n){e[1]>e[0]&&(e=e.slice().reverse());var r=t.coordToPoint([e[0],n]),i=t.coordToPoint([e[1],n]);return{x1:r[0],y1:r[1],x2:i[0],y2:i[1]}}function QM(t){return t.getRadiusAxis().inverse?0:1}function tT(t){var e=t[0],n=t[t.length-1];e&&n&&Math.abs(Math.abs(e.coord-n.coord)-360)<1e-4&&t.pop()}Gm.extend({type:"angleAxis",axisPointerClass:"PolarAxisPointer",render:function(t,e){if(this.group.removeAll(),t.get("show")){var n=t.axis,r=n.polar,i=r.getRadiusAxis().getExtent(),o=n.getTicksCoords(),a=n.getMinorTicksCoords(),s=A(n.getViewLabels(),function(t){return(t=m(t)).coord=n.dataToCoord(t.tickValue),t});tT(s),tT(o),k(KM,function(e){!t.get(e+".show")||n.scale.isBlank()&&"axisLine"!==e||this["_"+e](t,r,o,a,i,s)},this)}},_axisLine:function(t,e,n,r,i){var o,a=t.getModel("axisLine.lineStyle"),s=QM(e),l=s?0:1;(o=0===i[l]?new Pa({shape:{cx:e.cx,cy:e.cy,r:i[s]},style:a.getLineStyle(),z2:1,silent:!0}):new La({shape:{cx:e.cx,cy:e.cy,r:i[s],r0:i[l]},style:a.getLineStyle(),z2:1,silent:!0})).style.fill=null,this.group.add(o)},_axisTick:function(t,e,n,r,i){var o=t.getModel("axisTick"),a=(o.get("inside")?-1:1)*o.get("length"),s=i[QM(e)],l=A(n,function(t){return new Xa({shape:JM(e,[s,s+a],t.coord)})});this.group.add(xs(l,{style:b(o.getModel("lineStyle").getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")})}))},_minorTick:function(t,e,n,r,i){if(r.length){for(var o=t.getModel("axisTick"),a=t.getModel("minorTick"),s=(o.get("inside")?-1:1)*a.get("length"),l=i[QM(e)],u=[],c=0;c<r.length;c++)for(var d=0;d<r[c].length;d++)u.push(new Xa({shape:JM(e,[l,l+s],r[c][d].coord)}));this.group.add(xs(u,{style:b(a.getModel("lineStyle").getLineStyle(),b(o.getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")}))}))}},_axisLabel:function(t,e,n,r,i,o){var a=t.getCategories(!0),s=t.getModel("axisLabel"),l=s.get("margin"),u=t.get("triggerEvent");k(o,function(n,r){var o=s,c=n.tickValue,d=i[QM(e)],f=e.coordToPoint([d+l,n.coord]),h=e.cx,p=e.cy,g=Math.abs(f[0]-h)/d<.3?"center":f[0]>h?"left":"right",m=Math.abs(f[1]-p)/d<.3?"middle":f[1]>p?"top":"bottom";a&&a[c]&&a[c].textStyle&&(o=new hl(a[c].textStyle,s,s.ecModel));var v=new Da({silent:Am.isLabelSilent(t)});this.group.add(v),Hs(v.style,o,{x:f[0],y:f[1],textFill:o.getTextColor()||t.get("axisLine.lineStyle.color"),text:n.formattedLabel,textAlign:g,textVerticalAlign:m}),u&&(v.eventData=Am.makeAxisEventDataBase(t),v.eventData.targetType="axisLabel",v.eventData.value=n.rawLabel)},this)},_splitLine:function(t,e,n,r,i){var o=t.getModel("splitLine").getModel("lineStyle"),a=o.get("color"),s=0;a=a instanceof Array?a:[a];for(var l=[],u=0;u<n.length;u++){var c=s++%a.length;l[c]=l[c]||[],l[c].push(new Xa({shape:JM(e,i,n[u].coord)}))}for(u=0;u<l.length;u++)this.group.add(xs(l[u],{style:b({stroke:a[u%a.length]},o.getLineStyle()),silent:!0,z:t.get("z")}))},_minorSplitLine:function(t,e,n,r,i){if(r.length){for(var o=t.getModel("minorSplitLine").getModel("lineStyle"),a=[],s=0;s<r.length;s++)for(var l=0;l<r[s].length;l++)a.push(new Xa({shape:JM(e,i,r[s][l].coord)}));this.group.add(xs(a,{style:o.getLineStyle(),silent:!0,z:t.get("z")}))}},_splitArea:function(t,e,n,r,i){if(n.length){var o=t.getModel("splitArea").getModel("areaStyle"),a=o.get("color"),s=0;a=a instanceof Array?a:[a];for(var l=[],u=Math.PI/180,c=-n[0].coord*u,d=Math.min(i[0],i[1]),f=Math.max(i[0],i[1]),h=t.get("clockwise"),p=1;p<n.length;p++){var g=s++%a.length;l[g]=l[g]||[],l[g].push(new Ra({shape:{cx:e.cx,cy:e.cy,r0:d,r:f,startAngle:c,endAngle:-n[p].coord*u,clockwise:h},silent:!0})),c=-n[p].coord*u}for(p=0;p<l.length;p++)this.group.add(xs(l[p],{style:b({fill:a[p%a.length]},o.getAreaStyle()),silent:!0}))}}});var eT=["axisLine","axisTickLabel","axisName"],nT=["splitLine","splitArea","minorSplitLine"];Gm.extend({type:"radiusAxis",axisPointerClass:"PolarAxisPointer",render:function(t,e){if(this.group.removeAll(),t.get("show")){var n=t.axis,r=n.polar,i=r.getAngleAxis(),o=n.getTicksCoords(),a=n.getMinorTicksCoords(),s=i.getExtent()[0],l=n.getExtent(),u=function(t,e,n){return{position:[t.cx,t.cy],rotation:n/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:e.getModel("axisLabel").get("rotate"),z2:1}}(r,t,s),c=new Am(t,u);k(eT,c.add,c),this.group.add(c.getGroup()),k(nT,function(e){t.get(e+".show")&&!n.scale.isBlank()&&this["_"+e](t,r,s,l,o,a)},this)}},_splitLine:function(t,e,n,r,i){var o=t.getModel("splitLine").getModel("lineStyle"),a=o.get("color"),s=0;a=a instanceof Array?a:[a];for(var l=[],u=0;u<i.length;u++){var c=s++%a.length;l[c]=l[c]||[],l[c].push(new Pa({shape:{cx:e.cx,cy:e.cy,r:i[u].coord}}))}for(u=0;u<l.length;u++)this.group.add(xs(l[u],{style:b({stroke:a[u%a.length],fill:null},o.getLineStyle()),silent:!0}))},_minorSplitLine:function(t,e,n,r,i,o){if(o.length){for(var a=t.getModel("minorSplitLine").getModel("lineStyle"),s=[],l=0;l<o.length;l++)for(var u=0;u<o[l].length;u++)s.push(new Pa({shape:{cx:e.cx,cy:e.cy,r:o[l][u].coord}}));this.group.add(xs(s,{style:b({fill:null},a.getLineStyle()),silent:!0}))}},_splitArea:function(t,e,n,r,i){if(i.length){var o=t.getModel("splitArea").getModel("areaStyle"),a=o.get("color"),s=0;a=a instanceof Array?a:[a];for(var l=[],u=i[0].coord,c=1;c<i.length;c++){var d=s++%a.length;l[d]=l[d]||[],l[d].push(new Ra({shape:{cx:e.cx,cy:e.cy,r0:u,r:i[c].coord,startAngle:0,endAngle:2*Math.PI},silent:!0})),u=i[c].coord}for(c=0;c<l.length;c++)this.group.add(xs(l[c],{style:b({fill:a[c%a.length]},o.getAreaStyle()),silent:!0}))}}});var rT=jC.extend({makeElOption:function(t,e,n,r,i){var o=n.axis;"angle"===o.dim&&(this.animationThreshold=Math.PI/18);var a,s=o.polar,l=s.getOtherAxis(o).getExtent();a=o["dataTo"+Kl(o.dim)](e);var u=r.get("type");if(u&&"none"!==u){var c=YC(r),d=iT[u](o,s,a,l,c);d.style=c,t.graphicKey=d.type,t.pointer=d}var f=r.get("label.margin");$C(t,n,r,i,function(t,e,n,r,i){var o=e.axis,a=o.dataToCoord(t),s=r.getAngleAxis().getExtent()[0];s=s/180*Math.PI;var l,u,c,d=r.getRadiusAxis().getExtent();if("radius"===o.dim){var f=re();le(f,f,s),se(f,f,[r.cx,r.cy]),l=Js([a,-i],f);var h=e.getModel("axisLabel").get("rotate")||0,p=Am.innerTextLayout(s,h*Math.PI/180,-1);u=p.textAlign,c=p.textVerticalAlign}else{var g=d[1];l=r.coordToPoint([g+i,a]);var m=r.cx,v=r.cy;u=Math.abs(l[0]-m)/g<.3?"center":l[0]>m?"left":"right",c=Math.abs(l[1]-v)/g<.3?"middle":l[1]>v?"top":"bottom"}return{position:l,align:u,verticalAlign:c}}(e,n,0,s,f))}}),iT={line:function(t,e,n,r,i){return"angle"===t.dim?{type:"Line",shape:QC(e.coordToPoint([r[0],n]),e.coordToPoint([r[1],n]))}:{type:"Circle",shape:{cx:e.cx,cy:e.cy,r:n}}},shadow:function(t,e,n,r,i){var o=Math.max(1,t.getBandWidth()),a=Math.PI/180;return"angle"===t.dim?{type:"Sector",shape:eM(e.cx,e.cy,r[0],r[1],(-n-o/2)*a,(o/2-n)*a)}:{type:"Sector",shape:eM(e.cx,e.cy,n-o/2,n+o/2,0,2*Math.PI)}}};function oT(t,e){e.update="updateView",eh(e,function(e,n){var r={};return n.eachComponent({mainType:"geo",query:e},function(n){n[t](e.name),k(n.coordinateSystem.regions,function(t){r[t.name]=n.isSelected(t.name)||!1})}),{selected:r,name:e.name}})}function aT(t,e,n){this._model=t}function sT(t,e,n,r){var i=n.calendarModel,o=n.seriesModel,a=i?i.coordinateSystem:o?o.coordinateSystem:null;return a===this?a[t](r):null}Gm.registerAxisPointerClass("PolarAxisPointer",rT),rh(E(function(t,e,n){var r={},i=function(t){var e={};k(t,function(t,n){var r=t.getData(),i=t.coordinateSystem,o=i.getBaseAxis(),a=WM(i,o),s=o.getExtent(),l="category"===o.type?o.getBandWidth():Math.abs(s[1]-s[0])/r.count(),u=e[a]||{bandWidth:l,remainedWidth:l,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},c=u.stacks;e[a]=u;var d=HM(t);c[d]||u.autoWidthCount++,c[d]=c[d]||{width:0,maxWidth:0};var f=bl(t.get("barWidth"),l),h=bl(t.get("barMaxWidth"),l),p=t.get("barGap"),g=t.get("barCategoryGap");f&&!c[d].width&&(f=Math.min(u.remainedWidth,f),c[d].width=f,u.remainedWidth-=f),h&&(c[d].maxWidth=h),null!=p&&(u.gap=p),null!=g&&(u.categoryGap=g)});var n={};return k(e,function(t,e){n[e]={};var r=t.stacks,i=bl(t.categoryGap,t.bandWidth),o=bl(t.gap,1),a=t.remainedWidth,s=t.autoWidthCount,l=(a-i)/(s+(s-1)*o);l=Math.max(l,0),k(r,function(t,e){var n=t.maxWidth;n&&n<l&&(n=Math.min(n,a),t.width&&(n=Math.min(n,t.width)),a-=n,t.width=n,s--)}),l=(a-i)/(s+(s-1)*o),l=Math.max(l,0);var u,c=0;k(r,function(t,e){t.width||(t.width=l),c+=(u=t).width*(1+o)}),u&&(c-=u.width*o);var d=-c/2;k(r,function(t,r){n[e][r]=n[e][r]||{offset:d,width:t.width},d+=t.width*(1+o)})}),n}(D(e.getSeriesByType(t),function(t){return!e.isSeriesFiltered(t)&&t.coordinateSystem&&"polar"===t.coordinateSystem.type}));e.eachSeriesByType(t,function(t){if("polar"===t.coordinateSystem.type){var e=t.getData(),n=t.coordinateSystem,o=n.getBaseAxis(),a=WM(n,o),s=HM(t),l=i[a][s],u=l.offset,c=l.width,d=n.getOtherAxis(o),f=t.coordinateSystem.cx,h=t.coordinateSystem.cy,p=t.get("barMinHeight")||0,g=t.get("barMinAngle")||0;r[s]=r[s]||[];for(var m=e.mapDimension(d.dim),v=e.mapDimension(o.dim),y=Xh(e,m),x="radius"!==o.dim||!t.get("roundCap",!0),b="radius"===d.dim?d.dataToRadius(0):d.dataToAngle(0),_=0,w=e.count();_<w;_++){var S,C,M,T,k=e.get(m,_),A=e.get(v,_),I=0<=k?"p":"n",D=b;if(y&&(r[s][A]||(r[s][A]={p:b,n:b}),D=r[s][A][I]),"radius"===d.dim){var O=d.dataToRadius(k)-b,P=o.dataToAngle(A);Math.abs(O)<p&&(O=(O<0?-1:1)*p),C=(S=D)+O,T=(M=P-u)-c,y&&(r[s][A][I]=C)}else{var E=d.dataToAngle(k,x)-b,R=o.dataToRadius(A);Math.abs(E)<g&&(E=(E<0?-1:1)*g),C=(S=R+u)+c,T=(M=D)+E,y&&(r[s][A][I]=T)}e.setItemLayout(_,{cx:f,cy:h,r0:S,r:C,startAngle:-M*Math.PI/180,endAngle:-T*Math.PI/180})}}},this)},"bar")),lh({type:"polar"}),M(gu.extend({type:"geo",coordinateSystem:null,layoutMode:"box",init:function(t){gu.prototype.init.apply(this,arguments),ki(t,"label",["show"])},optionUpdated:function(){var t=this.option,e=this;t.regions=Hy.getFilledRegions(t.regions,t.map,t.nameMap),this._optionModelMap=I(t.regions||[],function(t,n){return n.name&&t.set(n.name,new hl(n,e)),t},Q()),this.updateSelectedMap(t.regions)},defaultOption:{zlevel:0,z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",color:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},getRegionModel:function(t){return this._optionModelMap.get(t)||new hl(null,this,this.ecModel)},getFormattedLabel:function(t,e){e=e||"normal";var n=this.getRegionModel(t).get(("normal"===e?"":e+".")+"label.formatter"),r={name:t};return"function"==typeof n?(r.status=e,n(r)):"string"==typeof n?n.replace("{a}",null!=t?t:""):void 0},setZoom:function(t){this.option.zoom=t},setCenter:function(t){this.option.center=t}}),wv),lh({type:"geo",init:function(t,e){var n=new ky(e,!0);this._mapDraw=n,this.group.add(n.group)},render:function(t,e,n,r){if(!r||"geoToggleSelect"!==r.type||r.from!==this.uid){var i=this._mapDraw;t.get("show")?i.draw(t,e,n,this,r):this._mapDraw.group.removeAll(),this.group.silent=t.get("silent")}},dispose:function(){this._mapDraw&&this._mapDraw.remove()}}),oT("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),oT("select",{type:"geoSelect",event:"geoselected"}),oT("unSelect",{type:"geoUnSelect",event:"geounselected"}),aT.prototype={constructor:aT,type:"calendar",dimensions:["time","value"],getDimensionsInfo:function(){return[{name:"time",type:"time"},"value"]},getRangeInfo:function(){return this._rangeInfo},getModel:function(){return this._model},getRect:function(){return this._rect},getCellWidth:function(){return this._sw},getCellHeight:function(){return this._sh},getOrient:function(){return this._orient},getFirstDayOfWeek:function(){return this._firstDayOfWeek},getDateInfo:function(t){var e=(t=Ol(t)).getFullYear(),n=t.getMonth()+1;n=n<10?"0"+n:n;var r=t.getDate();r=r<10?"0"+r:r;var i=t.getDay();return{y:e,m:n,d:r,day:i=Math.abs((i+7-this.getFirstDayOfWeek())%7),time:t.getTime(),formatedDate:e+"-"+n+"-"+r,date:t}},getNextNDay:function(t,e){return 0===(e=e||0)||(t=new Date(this.getDateInfo(t).time)).setDate(t.getDate()+e),this.getDateInfo(t)},update:function(t,e){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var n=this._rangeInfo.weeks||1,r=["width","height"],i=this._model.get("cellSize").slice(),o=this._model.getBoxLayoutParams(),a="horizontal"===this._orient?[n,7]:[7,n];k([0,1],function(t){u(i,t)&&(o[r[t]]=i[t]*a[t])});var s={width:e.getWidth(),height:e.getHeight()},l=this._rect=au(o,s);function u(t,e){return null!=t[e]&&"auto"!==t[e]}k([0,1],function(t){u(i,t)||(i[t]=l[r[t]]/a[t])}),this._sw=i[0],this._sh=i[1]},dataToPoint:function(t,e){R(t)&&(t=t[0]),null==e&&(e=!0);var n=this.getDateInfo(t),r=this._rangeInfo;if(e&&!(n.time>=r.start.time&&n.time<r.end.time+864e5))return[NaN,NaN];var i=n.day,o=this._getRangeInfo([r.start.time,n.formatedDate]).nthWeek;return"vertical"===this._orient?[this._rect.x+i*this._sw+this._sw/2,this._rect.y+o*this._sh+this._sh/2]:[this._rect.x+o*this._sw+this._sw/2,this._rect.y+i*this._sh+this._sh/2]},pointToData:function(t){var e=this.pointToDate(t);return e&&e.time},dataToRect:function(t,e){var n=this.dataToPoint(t,e);return{contentShape:{x:n[0]-(this._sw-this._lineWidth)/2,y:n[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:n,tl:[n[0]-this._sw/2,n[1]-this._sh/2],tr:[n[0]+this._sw/2,n[1]-this._sh/2],br:[n[0]+this._sw/2,n[1]+this._sh/2],bl:[n[0]-this._sw/2,n[1]+this._sh/2]}},pointToDate:function(t){var e=Math.floor((t[0]-this._rect.x)/this._sw)+1,n=Math.floor((t[1]-this._rect.y)/this._sh)+1,r=this._rangeInfo.range;return"vertical"===this._orient?this._getDateByWeeksAndDay(n,e-1,r):this._getDateByWeeksAndDay(e,n-1,r)},convertToPixel:E(sT,"dataToPoint"),convertFromPixel:E(sT,"pointToData"),_initRangeOption:function(){var t=this._model.get("range"),e=t;if(R(e)&&1===e.length&&(e=e[0]),/^\d{4}$/.test(e)&&(t=[e+"-01-01",e+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(e)){var n=this.getDateInfo(e),r=n.date;r.setMonth(r.getMonth()+1);var i=this.getNextNDay(r,-1);t=[n.formatedDate,i.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(e)&&(t=[e,e]);var o=this._getRangeInfo(t);return o.start.time>o.end.time&&t.reverse(),t},_getRangeInfo:function(t){var e;(t=[this.getDateInfo(t[0]),this.getDateInfo(t[1])])[0].time>t[1].time&&(e=!0,t.reverse());var n=Math.floor(t[1].time/864e5)-Math.floor(t[0].time/864e5)+1,r=new Date(t[0].time),i=r.getDate(),o=t[1].date.getDate();r.setDate(i+n-1);var a=r.getDate();if(a!==o)for(var s=0<r.getTime()-t[1].time?1:-1;(a=r.getDate())!==o&&0<(r.getTime()-t[1].time)*s;)n-=s,r.setDate(a-s);var l=Math.floor((n+t[0].day+6)/7),u=e?1-l:l-1;return e&&t.reverse(),{range:[t[0].formatedDate,t[1].formatedDate],start:t[0],end:t[1],allDay:n,weeks:l,nthWeek:u,fweek:t[0].day,lweek:t[1].day}},_getDateByWeeksAndDay:function(t,e,n){var r=this._getRangeInfo(n);if(t>r.weeks||0===t&&e<r.fweek||t===r.weeks&&e>r.lweek)return!1;var i=7*(t-1)-r.fweek+e,o=new Date(r.start.time);return o.setDate(r.start.d+i),this.getDateInfo(o)}},aT.dimensions=aT.prototype.dimensions,aT.getDimensionsInfo=aT.prototype.getDimensionsInfo,aT.create=function(t,e){var n=[];return t.eachComponent("calendar",function(r){var i=new aT(r,t,e);n.push(i),r.coordinateSystem=i}),t.eachSeries(function(t){"calendar"===t.get("coordinateSystem")&&(t.coordinateSystem=n[t.get("calendarIndex")||0])}),n},Uu.register("calendar",aT);var lT=gu.extend({type:"calendar",coordinateSystem:null,defaultOption:{zlevel:0,z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",nameMap:"en",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",nameMap:"en",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},init:function(t,e,n,r){var i=uu(t);lT.superApply(this,"init",arguments),uT(t,i)},mergeOption:function(t,e){lT.superApply(this,"mergeOption",arguments),uT(this.option,t)}});function uT(t,e){var n=t.cellSize;R(n)?1===n.length&&(n[1]=n[0]):n=t.cellSize=[n,n];var r=A([0,1],function(t){return function(t,e){return null!=t[ru[e][0]]||null!=t[ru[e][1]]&&null!=t[ru[e][2]]}(e,t)&&(n[t]="auto"),null!=n[t]&&"auto"!==n[t]});lu(t,e,{type:"box",ignoreSize:r})}var cT={EN:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],CN:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},dT={EN:["S","M","T","W","T","F","S"],CN:["日","一","二","三","四","五","六"]};lh({type:"calendar",_tlpoints:null,_blpoints:null,_firstDayOfMonth:null,_firstDayPoints:null,render:function(t,e,n){var r=this.group;r.removeAll();var i=t.coordinateSystem,o=i.getRangeInfo(),a=i.getOrient();this._renderDayRect(t,o,r),this._renderLines(t,o,a,r),this._renderYearText(t,o,a,r),this._renderMonthText(t,a,r),this._renderWeekText(t,o,a,r)},_renderDayRect:function(t,e,n){for(var r=t.coordinateSystem,i=t.getModel("itemStyle").getItemStyle(),o=r.getCellWidth(),a=r.getCellHeight(),s=e.start.time;s<=e.end.time;s=r.getNextNDay(s,1).time){var l=r.dataToRect([s],!1).tl,u=new Ua({shape:{x:l[0],y:l[1],width:o,height:a},cursor:"default",style:i});n.add(u)}},_renderLines:function(t,e,n,r){var i=this,o=t.coordinateSystem,a=t.getModel("splitLine.lineStyle").getLineStyle(),s=t.get("splitLine.show"),l=a.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var u=e.start,c=0;u.time<=e.end.time;c++){f(u.formatedDate),0===c&&(u=o.getDateInfo(e.start.y+"-"+e.start.m));var d=u.date;d.setMonth(d.getMonth()+1),u=o.getDateInfo(d)}function f(e){i._firstDayOfMonth.push(o.getDateInfo(e)),i._firstDayPoints.push(o.dataToRect([e],!1).tl);var l=i._getLinePointsOfOneWeek(t,e,n);i._tlpoints.push(l[0]),i._blpoints.push(l[l.length-1]),s&&i._drawSplitline(l,a,r)}f(o.getNextNDay(e.end.time,1).formatedDate),s&&this._drawSplitline(i._getEdgesPoints(i._tlpoints,l,n),a,r),s&&this._drawSplitline(i._getEdgesPoints(i._blpoints,l,n),a,r)},_getEdgesPoints:function(t,e,n){var r=[t[0].slice(),t[t.length-1].slice()],i="horizontal"===n?0:1;return r[0][i]=r[0][i]-e/2,r[1][i]=r[1][i]+e/2,r},_drawSplitline:function(t,e,n){var r=new Va({z2:20,shape:{points:t},style:e});n.add(r)},_getLinePointsOfOneWeek:function(t,e,n){var r=t.coordinateSystem;e=r.getDateInfo(e);for(var i=[],o=0;o<7;o++){var a=r.getNextNDay(e.time,o),s=r.dataToRect([a.time],!1);i[2*a.day]=s.tl,i[2*a.day+1]=s["horizontal"===n?"bl":"tr"]}return i},_formatterLabel:function(t,e){return"string"==typeof t&&t?Xl(t,e):"function"==typeof t?t(e):e.nameMap},_yearTextPositionControl:function(t,e,n,r,i){e=e.slice();var o=["center","bottom"];"bottom"===r?(e[1]+=i,o=["center","top"]):"left"===r?e[0]-=i:"right"===r?(e[0]+=i,o=["center","top"]):e[1]-=i;var a=0;return"left"!==r&&"right"!==r||(a=Math.PI/2),{rotation:a,position:e,style:{textAlign:o[0],textVerticalAlign:o[1]}}},_renderYearText:function(t,e,n,r){var i=t.getModel("yearLabel");if(i.get("show")){var o=i.get("margin"),a=i.get("position");a=a||("horizontal"!==n?"top":"left");var s=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],l=(s[0][0]+s[1][0])/2,u=(s[0][1]+s[1][1])/2,c="horizontal"===n?0:1,d={top:[l,s[c][1]],bottom:[l,s[1-c][1]],left:[s[1-c][0],u],right:[s[c][0],u]},f=e.start.y;+e.end.y>+e.start.y&&(f=f+"-"+e.end.y);var h=i.get("formatter"),p=this._formatterLabel(h,{start:e.start.y,end:e.end.y,nameMap:f}),g=new Da({z2:30});Hs(g.style,i,{text:p}),g.attr(this._yearTextPositionControl(g,d[a],n,a,o)),r.add(g)}},_monthTextPositionControl:function(t,e,n,r,i){var o="left",a="top",s=t[0],l=t[1];return"horizontal"===n?(l+=i,e&&(o="center"),"start"===r&&(a="bottom")):(s+=i,e&&(a="middle"),"start"===r&&(o="right")),{x:s,y:l,textAlign:o,textVerticalAlign:a}},_renderMonthText:function(t,e,n){var r=t.getModel("monthLabel");if(r.get("show")){var i=r.get("nameMap"),o=r.get("margin"),a=r.get("position"),s=r.get("align"),l=[this._tlpoints,this._blpoints];N(i)&&(i=cT[i.toUpperCase()]||[]);var u="start"===a?0:1,c="horizontal"===e?0:1;o="start"===a?-o:o;for(var d="center"===s,f=0;f<l[u].length-1;f++){var h=l[u][f].slice(),p=this._firstDayOfMonth[f];d&&(h[c]=(this._firstDayPoints[f][c]+l[0][f+1][c])/2);var g=r.get("formatter"),m=i[+p.m-1],v={yyyy:p.y,yy:(p.y+"").slice(2),MM:p.m,M:+p.m,nameMap:m},y=this._formatterLabel(g,v),b=new Da({z2:30});x(Hs(b.style,r,{text:y}),this._monthTextPositionControl(h,d,e,a,o)),n.add(b)}}},_weekTextPositionControl:function(t,e,n,r,i){var o="center",a="middle",s=t[0],l=t[1],u="start"===n;return"horizontal"===e?(s=s+r+(u?1:-1)*i[0]/2,o=u?"right":"left"):(l=l+r+(u?1:-1)*i[1]/2,a=u?"bottom":"top"),{x:s,y:l,textAlign:o,textVerticalAlign:a}},_renderWeekText:function(t,e,n,r){var i=t.getModel("dayLabel");if(i.get("show")){var o=t.coordinateSystem,a=i.get("position"),s=i.get("nameMap"),l=i.get("margin"),u=o.getFirstDayOfWeek();N(s)&&(s=dT[s.toUpperCase()]||[]);var c=o.getNextNDay(e.end.time,7-e.lweek).time,d=[o.getCellWidth(),o.getCellHeight()];l=bl(l,d["horizontal"===n?0:1]),"start"===a&&(c=o.getNextNDay(e.start.time,-(7+e.fweek)).time,l=-l);for(var f=0;f<7;f++){var h,p=o.getNextNDay(c,f),g=o.dataToRect([p.time],!1).center;h=Math.abs((f+u)%7);var m=new Da({z2:30});x(Hs(m.style,i,{text:s[h]}),this._weekTextPositionControl(g,n,a,l,d)),r.add(m)}}}});var fT={path:null,compoundPath:null,group:Cn,image:Wr,text:Da};Qf(function(t){var e=t.graphic;R(e)?t.graphic=e[0]&&e[0].elements?[t.graphic[0]]:[{elements:e}]:e&&!e.elements&&(t.graphic=[{elements:[e]}])});var hT=sh({type:"graphic",defaultOption:{elements:[],parentId:null},_elOptionsToUpdate:null,mergeOption:function(t){var e=this.option.elements;this.option.elements=null,hT.superApply(this,"mergeOption",arguments),this.option.elements=e},optionUpdated:function(t,e){var n=this.option,r=(e?n:t).elements,i=n.elements=e?[]:n.elements,o=[];this._flatten(r,o);var a=Di(i,o);Oi(a);var s=this._elOptionsToUpdate=[];k(a,function(t,e){var n=t.option;n&&(s.push(n),function(t,e){var n=t.exist;if(e.id=t.keyInfo.id,!e.type&&n&&(e.type=n.type),null==e.parentId){var r=e.parentOption;r?e.parentId=r.id:n&&(e.parentId=n.parentId)}e.parentOption=null}(t,n),function(t,e,n){var r=x({},n),i=t[e],o=n.$action||"merge";"merge"===o?i?(v(i,r,!0),lu(i,r,{ignoreSize:!0}),cu(n,i)):t[e]=r:"replace"===o?t[e]=r:"remove"===o&&i&&(t[e]=null)}(i,e,n),function(t,e){t&&(t.hv=e.hv=[mT(e,["left","right"]),mT(e,["top","bottom"])],"group"===t.type&&(null==t.width&&(t.width=e.width=0),null==t.height&&(t.height=e.height=0)))}(i[e],n))},this);for(var l=i.length-1;0<=l;l--)null==i[l]?i.splice(l,1):delete i[l].$action},_flatten:function(t,e,n){k(t,function(t){if(t){n&&(t.parentOption=n),e.push(t);var r=t.children;"group"===t.type&&r&&this._flatten(r,e,t),delete t.children}},this)},useElOptionsToUpdate:function(){var t=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,t}});function pT(t,e,n,r){var i=n.type,o=new(fT.hasOwnProperty(i)?fT[i]:gs(i))(n);e.add(o),r.set(t,o),o.__ecGraphicId=t}function gT(t,e){var n=t&&t.parent;n&&("group"===t.type&&t.traverse(function(t){gT(t,e)}),e.removeKey(t.__ecGraphicId),n.remove(t))}function mT(t,e){var n;return k(e,function(e){null!=t[e]&&"auto"!==t[e]&&(n=!0)}),n}lh({type:"graphic",init:function(t,e){this._elMap=Q()},render:function(t,e,n){t!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=t,this._updateElements(t),this._relocate(t,n)},_updateElements:function(t){var e=t.useElOptionsToUpdate();if(e){var n=this._elMap,r=this.group;k(e,function(e){var i=e.$action,o=e.id,a=n.get(o),s=e.parentId,l=null!=s?n.get(s):r,u=e.style;"text"===e.type&&u&&(e.hv&&e.hv[1]&&(u.textVerticalAlign=u.textBaseline=null),!u.hasOwnProperty("textFill")&&u.fill&&(u.textFill=u.fill),!u.hasOwnProperty("textStroke")&&u.stroke&&(u.textStroke=u.stroke));var c=function(t){return t=x({},t),k(["id","parentId","$action","hv","bounding"].concat(nu),function(e){delete t[e]}),t}(e);i&&"merge"!==i?"replace"===i?(gT(a,n),pT(o,l,c,n)):"remove"===i&&gT(a,n):a?a.attr(c):pT(o,l,c,n);var d=n.get(o);d&&(d.__ecGraphicWidthOption=e.width,d.__ecGraphicHeightOption=e.height,function(t,e){var n=t.eventData;t.silent||t.ignore||n||(n=t.eventData={componentType:"graphic",componentIndex:e.componentIndex,name:t.name}),n&&(n.info=t.info)}(d,t))})}},_relocate:function(t,e){for(var n=t.option.elements,r=this.group,i=this._elMap,o=e.getWidth(),a=e.getHeight(),s=0;s<n.length;s++){var l=n[s];if((c=i.get(l.id))&&c.isGroup){var u=(d=c.parent)===r;c.__ecGraphicWidth=bl(c.__ecGraphicWidthOption,u?o:d.__ecGraphicWidth)||0,c.__ecGraphicHeight=bl(c.__ecGraphicHeightOption,u?a:d.__ecGraphicHeight)||0}}for(s=n.length-1;0<=s;s--){var c,d;(c=i.get((l=n[s]).id))&&su(c,l,(d=c.parent)===r?{width:o,height:a}:{width:d.__ecGraphicWidth,height:d.__ecGraphicHeight},null,{hv:l.hv,boundingMode:l.bounding})}},_clear:function(){var t=this._elMap;t.each(function(e){gT(e,t)}),this._elMap=Q()},dispose:function(){this._clear()}});var vT={};function yT(t,e){vT[t]=e}function xT(t){return vT[t]}var bT=sh({type:"toolbox",layoutMode:{type:"box",ignoreSize:!0},optionUpdated:function(){bT.superApply(this,"optionUpdated",arguments),k(this.option.feature,function(t,e){var n=xT(e);n&&v(t,n.defaultOption)})},defaultOption:{show:!0,z:6,zlevel:0,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1}}});function _T(t,e){var n=Fl(e.get("padding")),r=e.getItemStyle(["color","opacity"]);return r.fill=e.get("backgroundColor"),new Ua({shape:{x:t.x-n[3],y:t.y-n[0],width:t.width+n[1]+n[3],height:t.height+n[0]+n[2],r:e.get("borderRadius")},style:r,silent:!0,z2:-1})}lh({type:"toolbox",render:function(t,e,n,r){var i=this.group;if(i.removeAll(),t.get("show")){var o=+t.get("itemSize"),a=t.get("feature")||{},s=this._features||(this._features={}),l=[];k(a,function(t,e){l.push(e)}),new fh(this._featureNames||[],l).add(u).update(u).remove(E(u,null)).execute(),this._featureNames=l,function(t,e,n){var r=e.getBoxLayoutParams(),i=e.get("padding"),o={width:n.getWidth(),height:n.getHeight()},a=au(r,o,i);ou(e.get("orient"),t,e.get("itemGap"),a.width,a.height),su(t,r,o,i)}(i,t,n),i.add(_T(i.getBoundingRect(),t)),i.eachChild(function(t){var e=t.__title,r=t.hoverStyle;if(r&&e){var a=ir(e,mr(r)),s=t.position[0]+i.position[0],l=!1;t.position[1]+i.position[1]+o+a.height>n.getHeight()&&(r.textPosition="top",l=!0);var u=l?-5-a.height:o+8;s+a.width/2>n.getWidth()?(r.textPosition=["100%",u],r.textAlign="right"):s-a.width/2<0&&(r.textPosition=[0,u],r.textAlign="left")}})}function u(u,c){var d,f=l[u],h=l[c],p=a[f],g=new hl(p,t,t.ecModel);if(r&&null!=r.newTitle&&r.featureName===f&&(p.title=r.newTitle),f&&!h){if(function(t){return 0===t.indexOf("my")}(f))d={model:g,onclick:g.option.onclick,featureName:f};else{var m=xT(f);if(!m)return;d=new m(g,e,n)}s[f]=d}else{if(!(d=s[h]))return;d.model=g,d.ecModel=e,d.api=n}f||!h?g.get("show")&&!d.unusable?(function(r,a,s){var l=r.getModel("iconStyle"),u=r.getModel("emphasis.iconStyle"),c=a.getIcons?a.getIcons():r.get("icon"),d=r.get("title")||{};if("string"==typeof c){var f=c,h=d;d={},(c={})[s]=f,d[s]=h}var p=r.iconPaths={};k(c,function(s,c){var f=nl(s,{},{x:-o/2,y:-o/2,width:o,height:o});f.setStyle(l.getItemStyle()),f.hoverStyle=u.getItemStyle(),f.setStyle({text:d[c],textAlign:u.get("textAlign"),textBorderRadius:u.get("textBorderRadius"),textPadding:u.get("textPadding"),textFill:null});var h=t.getModel("tooltip");h&&h.get("show")&&f.attr("tooltip",x({content:d[c],formatter:h.get("formatter",!0)||function(){return d[c]},formatterParams:{componentType:"toolbox",name:c,title:d[c],$vars:["name","title"]},position:h.get("position",!0)||"bottom"},h.option)),Ls(f),t.get("showTitle")&&(f.__title=d[c],f.on("mouseover",function(){var e=u.getItemStyle(),n="vertical"===t.get("orient")?null==t.get("right")?"right":"left":null==t.get("bottom")?"bottom":"top";f.setStyle({textFill:u.get("textFill")||e.fill||e.stroke||"#000",textBackgroundColor:u.get("textBackgroundColor"),textPosition:u.get("textPosition")||n})}).on("mouseout",function(){f.setStyle({textFill:null,textBackgroundColor:null})})),f.trigger(r.get("iconStatus."+c)||"normal"),i.add(f),f.on("click",P(a.onclick,a,e,n,c)),p[c]=f})}(g,d,f),g.setIconStatus=function(t,e){var n=this.option,r=this.iconPaths;n.iconStatus=n.iconStatus||{},n.iconStatus[t]=e,r[t]&&r[t].trigger(e)},d.render&&d.render(g,e,n,r)):d.remove&&d.remove(e,n):d.dispose&&d.dispose(e,n)}},updateView:function(t,e,n,r){k(this._features,function(t){t.updateView&&t.updateView(t.model,e,n,r)})},remove:function(t,e){k(this._features,function(n){n.remove&&n.remove(t,e)}),this.group.removeAll()},dispose:function(t,e){k(this._features,function(n){n.dispose&&n.dispose(t,e)})}});var wT=md.toolbox.saveAsImage;function ST(t){this.model=t}ST.defaultOption={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:wT.title,type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],pixelRatio:1,lang:wT.lang.slice()},ST.prototype.unusable=!i.canvasSupported,ST.prototype.onclick=function(t,e){var n=this.model,r=n.get("name")||t.get("title.0.text")||"echarts",o="svg"===e.getZr().painter.getType()?"svg":n.get("type",!0)||"png",a=e.getConnectedDataURL({type:o,backgroundColor:n.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",connectedBackgroundColor:n.get("connectedBackgroundColor"),excludeComponents:n.get("excludeComponents"),pixelRatio:n.get("pixelRatio")});if("function"!=typeof MouseEvent||i.browser.ie||i.browser.edge)if(window.navigator.msSaveOrOpenBlob){for(var s=atob(a.split(",")[1]),l=s.length,u=new Uint8Array(l);l--;)u[l]=s.charCodeAt(l);var c=new Blob([u]);window.navigator.msSaveOrOpenBlob(c,r+"."+o)}else{var d=n.get("lang"),f='<body style="margin:0;"><img src="'+a+'" style="max-width:100%;" title="'+(d&&d[0]||"")+'" /></body>';window.open().document.write(f)}else{var h=document.createElement("a");h.download=r+"."+o,h.target="_blank",h.href=a;var p=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});h.dispatchEvent(p)}},yT("saveAsImage",ST);var CT=md.toolbox.magicType,MT="__ec_magicType_stack__";function TT(t){this.model=t}TT.defaultOption={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:m(CT.title),option:{},seriesIndex:{}};var kT=TT.prototype;kT.getIcons=function(){var t=this.model,e=t.get("icon"),n={};return k(t.get("type"),function(t){e[t]&&(n[t]=e[t])}),n};var AT={line:function(t,e,n,r){if("bar"===t)return v({id:e,type:"line",data:n.get("data"),stack:n.get("stack"),markPoint:n.get("markPoint"),markLine:n.get("markLine")},r.get("option.line")||{},!0)},bar:function(t,e,n,r){if("line"===t)return v({id:e,type:"bar",data:n.get("data"),stack:n.get("stack"),markPoint:n.get("markPoint"),markLine:n.get("markLine")},r.get("option.bar")||{},!0)},stack:function(t,e,n,r){var i=n.get("stack")===MT;if("line"===t||"bar"===t)return r.setIconStatus("stack",i?"normal":"emphasis"),v({id:e,stack:i?"":MT},r.get("option.stack")||{},!0)}},IT=[["line","bar"],["stack"]];kT.onclick=function(t,e,n){var r=this.model,i=r.get("seriesIndex."+n);if(AT[n]){var o,a={series:[]};k(IT,function(t){0<=S(t,n)&&k(t,function(t){r.setIconStatus(t,"normal")})}),r.setIconStatus(n,"emphasis"),t.eachComponent({mainType:"series",query:null==i?null:{seriesIndex:i}},function(e){var i=AT[n](e.subType,e.id,e,r);i&&(b(i,e.option),a.series.push(i));var o=e.coordinateSystem;if(o&&"cartesian2d"===o.type&&("line"===n||"bar"===n)){var s=o.getAxesByScale("ordinal")[0];if(s){var l=s.dim+"Axis",u=t.queryComponents({mainType:l,index:e.get(name+"Index"),id:e.get(name+"Id")})[0].componentIndex;a[l]=a[l]||[];for(var c=0;c<=u;c++)a[l][u]=a[l][u]||{};a[l][u].boundaryGap="bar"===n}}}),"stack"===n&&(o=a.series&&a.series[0]&&a.series[0].stack===MT?v({stack:CT.title.tiled},CT.title):m(CT.title)),e.dispatchAction({type:"changeMagicType",currentType:n,newOption:a,newTitle:o,featureName:"magicType"})}},eh({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(t,e){e.mergeOption(t.newOption)}),yT("magicType",TT);var DT=md.toolbox.dataView,OT=new Array(60).join("-"),PT="\t";function ET(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var RT=new RegExp("[\t]+","g");function LT(t){this._dom=null,this.model=t}LT.defaultOption={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:m(DT.title),lang:m(DT.lang),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"},LT.prototype.onclick=function(t,e){var n=e.getDom(),r=this.model;this._dom&&n.removeChild(this._dom);var i=document.createElement("div");i.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",i.style.backgroundColor=r.get("backgroundColor")||"#fff";var o=document.createElement("h4"),a=r.get("lang")||[];o.innerHTML=a[0]||r.get("title"),o.style.cssText="margin: 10px 20px;",o.style.color=r.get("textColor");var s=document.createElement("div"),l=document.createElement("textarea");s.style.cssText="display:block;width:100%;overflow:auto;";var u=r.get("optionToContent"),c=r.get("contentToOption"),d=function(t){var e=function(t){var e={},n=[],r=[];return t.eachRawSeries(function(t){var i=t.coordinateSystem;if(!i||"cartesian2d"!==i.type&&"polar"!==i.type)n.push(t);else{var o=i.getBaseAxis();if("category"===o.type){var a=o.dim+"_"+o.index;e[a]||(e[a]={categoryAxis:o,valueAxis:i.getOtherAxis(o),series:[]},r.push({axisDim:o.dim,axisIndex:o.index})),e[a].series.push(t)}else n.push(t)}}),{seriesGroupByCategoryAxis:e,other:n,meta:r}}(t);return{value:D([function(t){var e=[];return k(t,function(t,n){var r=t.categoryAxis,i=t.valueAxis.dim,o=[" "].concat(A(t.series,function(t){return t.name})),a=[r.model.getCategories()];k(t.series,function(t){var e=t.getRawData();a.push(t.getRawData().mapArray(e.mapDimension(i),function(t){return t}))});for(var s=[o.join(PT)],l=0;l<a[0].length;l++){for(var u=[],c=0;c<a.length;c++)u.push(a[c][l]);s.push(u.join(PT))}e.push(s.join("\n"))}),e.join("\n\n"+OT+"\n\n")}(e.seriesGroupByCategoryAxis),function(t){return A(t,function(t){var e=t.getRawData(),n=[t.name],r=[];return e.each(e.dimensions,function(){for(var t=arguments.length,i=e.getName(arguments[t-1]),o=0;o<t-1;o++)r[o]=arguments[o];n.push((i?i+PT:"")+r.join(PT))}),n.join("\n")}).join("\n\n"+OT+"\n\n")}(e.other)],function(t){return t.replace(/[\n\t\s]/g,"")}).join("\n\n"+OT+"\n\n"),meta:e.meta}}(t);if("function"==typeof u){var f=u(e.getOption());"string"==typeof f?s.innerHTML=f:F(f)&&s.appendChild(f)}else s.appendChild(l),l.readOnly=r.get("readOnly"),l.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",l.style.color=r.get("textColor"),l.style.borderColor=r.get("textareaBorderColor"),l.style.backgroundColor=r.get("textareaColor"),l.value=d.value;var h=d.meta,p=document.createElement("div");p.style.cssText="position:absolute;bottom:0;left:0;right:0;";var g="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",m=document.createElement("div"),v=document.createElement("div");g+=";background-color:"+r.get("buttonColor"),g+=";color:"+r.get("buttonTextColor");var y=this;function x(){n.removeChild(i),y._dom=null}jt(m,"click",x),jt(v,"click",function(){var t;try{t="function"==typeof c?c(s,e.getOption()):function(t,e){var n=t.split(new RegExp("\n*"+OT+"\n*","g")),r={series:[]};return k(n,function(t,n){if(function(t){if(0<=t.slice(0,t.indexOf("\n")).indexOf(PT))return!0}(t)){var i=function(t){for(var e=t.split(/\n+/g),n=[],r=A(ET(e.shift()).split(RT),function(t){return{name:t,data:[]}}),i=0;i<e.length;i++){var o=ET(e[i]).split(RT);n.push(o.shift());for(var a=0;a<o.length;a++)r[a]&&(r[a].data[i]=o[a])}return{series:r,categories:n}}(t),o=e[n],a=o.axisDim+"Axis";o&&(r[a]=r[a]||[],r[a][o.axisIndex]={data:i.categories},r.series=r.series.concat(i.series))}else i=function(t){for(var e=t.split(/\n+/g),n=ET(e.shift()),r=[],i=0;i<e.length;i++){var o=ET(e[i]);if(o){var a,s=o.split(RT),l="",u=!1;a=isNaN(s[0])?(u=!0,l=s[0],s=s.slice(1),r[i]={name:l,value:[]},r[i].value):r[i]=[];for(var c=0;c<s.length;c++)a.push(+s[c]);1===a.length&&(u?r[i].value=a[0]:r[i]=a[0])}}return{name:n,data:r}}(t),r.series.push(i)}),r}(l.value,h)}catch(t){throw x(),new Error("Data view format error "+t)}t&&e.dispatchAction({type:"changeDataView",newOption:t}),x()}),m.innerHTML=a[1],v.innerHTML=a[2],v.style.cssText=g,m.style.cssText=g,r.get("readOnly")||p.appendChild(v),p.appendChild(m),i.appendChild(o),i.appendChild(s),i.appendChild(p),s.style.height=n.clientHeight-80+"px",n.appendChild(i),this._dom=i},LT.prototype.remove=function(t,e){this._dom&&e.getDom().removeChild(this._dom)},LT.prototype.dispose=function(t,e){this.remove(t,e)},yT("dataView",LT),eh({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(t,e){var n=[];k(t.newOption.series,function(t){var r=e.getSeriesByName(t.name)[0];if(r){var i=r.get("data");n.push({name:t.name,data:function(t,e){return A(t,function(t,n){var r=e&&e[n];if(!B(r)||R(r))return t;B(t)&&!R(t)||(t={value:t});var i=null!=r.name&&null==t.name;return t=b(t,r),i&&delete t.name,t})}(t.data,i)})}else n.push(x({type:"scatter"},t))}),e.mergeOption(b({series:n},t.newOption))});var NT=k,BT=S,zT=E,VT=["dataToPoint","pointToData"],FT=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"];function HT(t,e,n){var r=this._targetInfoList=[],i={},o=GT(e,t);NT(UT,function(t,e){n&&n.include&&!(0<=BT(n.include,e))||t(o,r,i)})}var WT=HT.prototype;function jT(t){return t[0]>t[1]&&t.reverse(),t}function GT(t,e){return Bi(t,e,{includeMainTypes:FT})}WT.setOutputRanges=function(t,e){this.matchOutputRanges(t,e,function(t,e,n){if((t.coordRanges||(t.coordRanges=[])).push(e),!t.coordRange){t.coordRange=e;var r=YT[t.brushType](0,n,e);t.__rangeOffset={offset:ZT[t.brushType](r.values,t.range,[1,1]),xyMinMax:r.xyMinMax}}})},WT.matchOutputRanges=function(t,e,n){NT(t,function(t){var r=this.findTargetInfo(t,e);r&&!0!==r&&k(r.coordSyses,function(r){var i=YT[t.brushType](1,r,t.range);n(t,i.values,r,e)})},this)},WT.setInputRanges=function(t,e){NT(t,function(t){var n=this.findTargetInfo(t,e);if(t.range=t.range||[],n&&!0!==n){t.panelId=n.panelId;var r=YT[t.brushType](0,n.coordSys,t.coordRange),i=t.__rangeOffset;t.range=i?ZT[t.brushType](r.values,i.offset,function(t,e){var n=JT(t),r=JT(e),i=[n[0]/r[0],n[1]/r[1]];return isNaN(i[0])&&(i[0]=1),isNaN(i[1])&&(i[1]=1),i}(r.xyMinMax,i.xyMinMax)):r.values}},this)},WT.makePanelOpts=function(t,e){return A(this._targetInfoList,function(n){var r=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:e&&e(n),clipPath:Sw(r),isTargetByCursor:Mw(r,t,n.coordSysModel),getLinearBrushOtherExtent:Cw(r)}})},WT.controlSeries=function(t,e,n){var r=this.findTargetInfo(t,n);return!0===r||r&&0<=BT(r.coordSyses,e.coordinateSystem)},WT.findTargetInfo=function(t,e){for(var n=this._targetInfoList,r=GT(e,t),i=0;i<n.length;i++){var o=n[i],a=t.panelId;if(a){if(o.panelId===a)return o}else for(i=0;i<qT.length;i++)if(qT[i](r,o))return o}return!0};var UT={grid:function(t,e){var n=t.xAxisModels,r=t.yAxisModels,i=t.gridModels,o=Q(),a={},s={};(n||r||i)&&(NT(n,function(t){var e=t.axis.grid.model;o.set(e.id,e),a[e.id]=!0}),NT(r,function(t){var e=t.axis.grid.model;o.set(e.id,e),s[e.id]=!0}),NT(i,function(t){o.set(t.id,t),a[t.id]=!0,s[t.id]=!0}),o.each(function(t){var i=[];NT(t.coordinateSystem.getCartesians(),function(t,e){(0<=BT(n,t.getAxis("x").model)||0<=BT(r,t.getAxis("y").model))&&i.push(t)}),e.push({panelId:"grid--"+t.id,gridModel:t,coordSysModel:t,coordSys:i[0],coordSyses:i,getPanelRect:XT.grid,xAxisDeclared:a[t.id],yAxisDeclared:s[t.id]})}))},geo:function(t,e){NT(t.geoModels,function(t){var n=t.coordinateSystem;e.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:n,coordSyses:[n],getPanelRect:XT.geo})})}},qT=[function(t,e){var n=t.xAxisModel,r=t.yAxisModel,i=t.gridModel;return!i&&n&&(i=n.axis.grid.model),!i&&r&&(i=r.axis.grid.model),i&&i===e.gridModel},function(t,e){var n=t.geoModel;return n&&n===e.geoModel}],XT={grid:function(){return this.coordSys.grid.getRect().clone()},geo:function(){var t=this.coordSys,e=t.getBoundingRect().clone();return e.applyTransform(Ks(t)),e}},YT={lineX:zT($T,0),lineY:zT($T,1),rect:function(t,e,n){var r=e[VT[t]]([n[0][0],n[1][0]]),i=e[VT[t]]([n[0][1],n[1][1]]),o=[jT([r[0],i[0]]),jT([r[1],i[1]])];return{values:o,xyMinMax:o}},polygon:function(t,e,n){var r=[[1/0,-1/0],[1/0,-1/0]];return{values:A(n,function(n){var i=e[VT[t]](n);return r[0][0]=Math.min(r[0][0],i[0]),r[1][0]=Math.min(r[1][0],i[1]),r[0][1]=Math.max(r[0][1],i[0]),r[1][1]=Math.max(r[1][1],i[1]),i}),xyMinMax:r}}};function $T(t,e,n,r){var i=n.getAxis(["x","y"][t]),o=jT(A([0,1],function(t){return e?i.coordToData(i.toLocalCoord(r[t])):i.toGlobalCoord(i.dataToCoord(r[t]))})),a=[];return a[t]=o,a[1-t]=[NaN,NaN],{values:o,xyMinMax:a}}var ZT={lineX:zT(KT,0),lineY:zT(KT,1),rect:function(t,e,n){return[[t[0][0]-n[0]*e[0][0],t[0][1]-n[0]*e[0][1]],[t[1][0]-n[1]*e[1][0],t[1][1]-n[1]*e[1][1]]]},polygon:function(t,e,n){return A(t,function(t,r){return[t[0]-n[0]*e[r][0],t[1]-n[1]*e[r][1]]})}};function KT(t,e,n,r){return[e[0]-r[t]*n[0],e[1]-r[t]*n[1]]}function JT(t){return t?[t[0][1]-t[0][0],t[1][1]-t[1][0]]:[NaN,NaN]}var QT=k,tk="\0_ec_hist_store";function ek(t){return t[tk]||(t[tk]=[{}])}gu.registerSubTypeDefaulter("dataZoom",function(){return"slider"});var nk,rk,ik,ok,ak=["cartesian2d","polar","singleAxis"],sk=(rk=["axisIndex","axis","index","id"],ik=A(nk=(nk=["x","y","z","radius","angle","single"]).slice(),Kl),ok=A(rk=(rk||[]).slice(),Kl),function(t,e){k(nk,function(n,r){for(var i={name:n,capital:ik[r]},o=0;o<rk.length;o++)i[rk[o]]=n+ok[o];t.call(e,i)})});function lk(t,e,n,r){this._dimName=t,this._axisIndex=e,this.ecModel=r,this._dataZoomModel=n}var uk=k,ck=wl;function dk(t,e){var n=t.getAxisModel(),r=t._percentWindow,i=t._valueWindow;if(r){var o=Ml(i,[0,500]);o=Math.min(o,20);var a=e||0===r[0]&&100===r[1];n.setRange(a?null:+i[0].toFixed(o),a?null:+i[1].toFixed(o))}}lk.prototype={constructor:lk,hostedBy:function(t){return this._dataZoomModel===t},getDataValueWindow:function(){return this._valueWindow.slice()},getDataPercentWindow:function(){return this._percentWindow.slice()},getTargetSeriesModels:function(){var t=[],e=this.ecModel;return e.eachSeries(function(n){if(function(t){return 0<=S(ak,t)}(n.get("coordinateSystem"))){var r=this._dimName,i=e.queryComponents({mainType:r+"Axis",index:n.get(r+"AxisIndex"),id:n.get(r+"AxisId")})[0];this._axisIndex===(i&&i.componentIndex)&&t.push(n)}},this),t},getAxisModel:function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},getOtherAxisModel:function(){var t,e,n,r=this._dimName,i=this.ecModel,o=this.getAxisModel();return t="x"===r||"y"===r?(e="gridIndex","x"===r?"y":"x"):(e="polarIndex","angle"===r?"radius":"angle"),i.eachComponent(t+"Axis",function(t){(t.get(e)||0)===(o.get(e)||0)&&(n=t)}),n},getMinMaxSpan:function(){return m(this._minMaxSpan)},calculateDataWindow:function(t){var e,n=this._dataExtent,r=this.getAxisModel().axis.scale,i=this._dataZoomModel.getRangePropMode(),o=[0,100],a=[],s=[];uk(["start","end"],function(l,u){var c=t[l],d=t[l+"Value"];"percent"===i[u]?(null==c&&(c=o[u]),d=r.parse(xl(c,o,n))):(e=!0,c=xl(d=null==d?n[u]:r.parse(d),n,o)),s[u]=d,a[u]=c}),ck(s),ck(a);var l=this._minMaxSpan;function u(t,e,n,i,o){var a=o?"Span":"ValueSpan";C_(0,t,n,"all",l["min"+a],l["max"+a]);for(var s=0;s<2;s++)e[s]=xl(t[s],n,i,!0),o&&(e[s]=r.parse(e[s]))}return e?u(s,a,n,o,!1):u(a,s,o,n,!0),{valueWindow:s,percentWindow:a}},reset:function(t){if(t===this._dataZoomModel){var e=this.getTargetSeriesModels();this._dataExtent=function(t,e,n){var r=[1/0,-1/0];return uk(n,function(t){var n=t.getData();n&&uk(n.mapDimension(e,!0),function(t){var e=n.getApproximateExtent(t);e[0]<r[0]&&(r[0]=e[0]),e[1]>r[1]&&(r[1]=e[1])})}),r[1]<r[0]&&(r=[NaN,NaN]),function(t,e){var n=t.getAxisModel(),r=n.getMin(!0),i="category"===n.get("type"),o=i&&n.getCategories().length;null!=r&&"dataMin"!==r&&"function"!=typeof r?e[0]=r:i&&(e[0]=0<o?0:NaN);var a=n.getMax(!0);null!=a&&"dataMax"!==a&&"function"!=typeof a?e[1]=a:i&&(e[1]=0<o?o-1:NaN),n.get("scale",!0)||(0<e[0]&&(e[0]=0),e[1]<0&&(e[1]=0))}(t,r),r}(this,this._dimName,e),function(t){var e=t._minMaxSpan={},n=t._dataZoomModel,r=t._dataExtent;uk(["min","max"],function(i){var o=n.get(i+"Span"),a=n.get(i+"ValueSpan");null!=a&&(a=t.getAxisModel().axis.scale.parse(a)),null!=a?o=xl(r[0]+a,r,[0,100],!0):null!=o&&(a=xl(o,[0,100],r,!0)-r[0]),e[i+"Span"]=o,e[i+"ValueSpan"]=a})}(this);var n=this.calculateDataWindow(t.settledOption);this._valueWindow=n.valueWindow,this._percentWindow=n.percentWindow,dk(this)}},restore:function(t){t===this._dataZoomModel&&(this._valueWindow=this._percentWindow=null,dk(this,!0))},filterData:function(t,e){if(t===this._dataZoomModel){var n=this._dimName,r=this.getTargetSeriesModels(),i=t.get("filterMode"),o=this._valueWindow;"none"!==i&&uk(r,function(t){var e=t.getData(),r=e.mapDimension(n,!0);r.length&&("weakFilter"===i?e.filterSelf(function(t){for(var n,i,a,s=0;s<r.length;s++){var l=e.get(r[s],t),u=!isNaN(l),c=l<o[0],d=l>o[1];if(u&&!c&&!d)return!0;u&&(a=!0),c&&(n=!0),d&&(i=!0)}return a&&n&&i}):uk(r,function(n){if("empty"===i)t.setData(e=e.map(n,function(t){return function(t){return t>=o[0]&&t<=o[1]}(t)?t:NaN}));else{var r={};r[n]=o,e.selectRange(r)}}),uk(r,function(t){e.setApproximateExtent(o,t)}))})}}};var fk=k,hk=sk,pk=sh({type:"dataZoom",dependencies:["xAxis","yAxis","zAxis","radiusAxis","angleAxis","singleAxis","series"],defaultOption:{zlevel:0,z:4,orient:null,xAxisIndex:null,yAxisIndex:null,filterMode:"filter",throttle:null,start:0,end:100,startValue:null,endValue:null,minSpan:null,maxSpan:null,minValueSpan:null,maxValueSpan:null,rangeMode:null},init:function(t,e,n){this._dataIntervalByAxis={},this._dataInfo={},this._axisProxies={},this._autoThrottle=!0,this._rangePropMode=["percent","percent"];var r=gk(t);this.settledOption=r,this.mergeDefaultAndTheme(t,n),this.doInit(r)},mergeOption:function(t){var e=gk(t);v(this.option,t,!0),v(this.settledOption,e,!0),this.doInit(e)},doInit:function(t){var e=this.option;i.canvasSupported||(e.realtime=!1),this._setDefaultThrottle(t),mk(this,t);var n=this.settledOption;fk([["start","startValue"],["end","endValue"]],function(t,r){"value"===this._rangePropMode[r]&&(e[t[0]]=n[t[0]]=null)},this),this.textStyleModel=this.getModel("textStyle"),this._resetTarget(),this._giveAxisProxies()},_giveAxisProxies:function(){var t=this._axisProxies;this.eachTargetAxis(function(e,n,r,i){var o=this.dependentModels[e.axis][n],a=o.__dzAxisProxy||(o.__dzAxisProxy=new lk(e.name,n,this,i));t[e.name+"_"+n]=a},this)},_resetTarget:function(){var t=this.option,e=this._judgeAutoMode();hk(function(e){var n=e.axisIndex;t[n]=Ti(t[n])},this),"axisIndex"===e?this._autoSetAxisIndex():"orient"===e&&this._autoSetOrient()},_judgeAutoMode:function(){var t=this.option,e=!1;hk(function(n){null!=t[n.axisIndex]&&(e=!0)},this);var n=t.orient;return null==n&&e?"orient":e?void 0:(null==n&&(t.orient="horizontal"),"axisIndex")},_autoSetAxisIndex:function(){var t=!0,e=this.get("orient",!0),n=this.option,r=this.dependentModels;if(t){var i="vertical"===e?"y":"x";r[i+"Axis"].length?(n[i+"AxisIndex"]=[0],t=!1):fk(r.singleAxis,function(r){t&&r.get("orient",!0)===e&&(n.singleAxisIndex=[r.componentIndex],t=!1)})}t&&hk(function(e){if(t){var r=[],i=this.dependentModels[e.axis];if(i.length&&!r.length)for(var o=0,a=i.length;o<a;o++)"category"===i[o].get("type")&&r.push(o);(n[e.axisIndex]=r).length&&(t=!1)}},this),t&&this.ecModel.eachSeries(function(t){this._isSeriesHasAllAxesTypeOf(t,"value")&&hk(function(e){var r=n[e.axisIndex],i=t.get(e.axisIndex),o=t.get(e.axisId);S(r,i=t.ecModel.queryComponents({mainType:e.axis,index:i,id:o})[0].componentIndex)<0&&r.push(i)})},this)},_autoSetOrient:function(){var t;this.eachTargetAxis(function(e){t=t||e.name},this),this.option.orient="y"===t?"vertical":"horizontal"},_isSeriesHasAllAxesTypeOf:function(t,e){var n=!0;return hk(function(r){var i=t.get(r.axisIndex),o=this.dependentModels[r.axis][i];o&&o.get("type")===e||(n=!1)},this),n},_setDefaultThrottle:function(t){if(t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var e=this.ecModel.option;this.option.throttle=e.animation&&0<e.animationDurationUpdate?100:20}},getFirstTargetAxisModel:function(){var t;return hk(function(e){if(null==t){var n=this.get(e.axisIndex);n.length&&(t=this.dependentModels[e.axis][n[0]])}},this),t},eachTargetAxis:function(t,e){var n=this.ecModel;hk(function(r){fk(this.get(r.axisIndex),function(i){t.call(e,r,i,this,n)},this)},this)},getAxisProxy:function(t,e){return this._axisProxies[t+"_"+e]},getAxisModel:function(t,e){var n=this.getAxisProxy(t,e);return n&&n.getAxisModel()},setRawRange:function(t){var e=this.option,n=this.settledOption;fk([["start","startValue"],["end","endValue"]],function(r){null==t[r[0]]&&null==t[r[1]]||(e[r[0]]=n[r[0]]=t[r[0]],e[r[1]]=n[r[1]]=t[r[1]])},this),mk(this,t)},setCalculatedRange:function(t){var e=this.option;fk(["start","startValue","end","endValue"],function(n){e[n]=t[n]})},getPercentRange:function(){var t=this.findRepresentativeAxisProxy();if(t)return t.getDataPercentWindow()},getValueRange:function(t,e){if(null!=t||null!=e)return this.getAxisProxy(t,e).getDataValueWindow();var n=this.findRepresentativeAxisProxy();return n?n.getDataValueWindow():void 0},findRepresentativeAxisProxy:function(t){if(t)return t.__dzAxisProxy;var e=this._axisProxies;for(var n in e)if(e.hasOwnProperty(n)&&e[n].hostedBy(this))return e[n];for(var n in e)if(e.hasOwnProperty(n)&&!e[n].hostedBy(this))return e[n]},getRangePropMode:function(){return this._rangePropMode.slice()}});function gk(t){var e={};return fk(["start","end","startValue","endValue","throttle"],function(n){t.hasOwnProperty(n)&&(e[n]=t[n])}),e}function mk(t,e){var n=t._rangePropMode,r=t.get("rangeMode");fk([["start","startValue"],["end","endValue"]],function(t,i){var o=null!=e[t[0]],a=null!=e[t[1]];o&&!a?n[i]="percent":!o&&a?n[i]="value":r?n[i]=r[i]:o&&(n[i]="percent")})}var vk=Kc.extend({type:"dataZoom",render:function(t,e,n,r){this.dataZoomModel=t,this.ecModel=e,this.api=n},getTargetCoordInfo:function(){var t=this.ecModel,e={};return this.dataZoomModel.eachTargetAxis(function(n,r){var i=t.getComponent(n.axis,r);if(i){var o=i.getCoordSysModel();o&&function(t,e,n,r){for(var i,o=0;o<n.length;o++)if(n[o].model===t){i=n[o];break}i||n.push(i={model:t,axisModels:[],coordIndex:r}),i.axisModels.push(e)}(o,i,e[o.mainType]||(e[o.mainType]=[]),o.componentIndex)}},this),e}});pk.extend({type:"dataZoom.select"}),vk.extend({type:"dataZoom.select"}),th({getTargetSeries:function(t){var e=Q();return t.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(t,n,r){k(r.getAxisProxy(t.name,n).getTargetSeriesModels(),function(t){e.set(t.uid,t)})})}),e},modifyOutputEnd:!0,overallReset:function(t,e){t.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(t,n,r){r.getAxisProxy(t.name,n).reset(r,e)}),t.eachTargetAxis(function(t,n,r){r.getAxisProxy(t.name,n).filterData(r,e)})}),t.eachComponent("dataZoom",function(t){var e=t.findRepresentativeAxisProxy(),n=e.getDataPercentWindow(),r=e.getDataValueWindow();t.setCalculatedRange({start:n[0],end:n[1],startValue:r[0],endValue:r[1]})})}}),eh("dataZoom",function(t,e){var n=function(t,e,n){return function(i){var o,a={nodes:[],records:{}};if(e(function(t){a.records[t.name]={}}),!i)return a;for(r(i,a);o=!1,t(s),o;);function s(t){!function(t,e){return 0<=S(e.nodes,t)}(t,a)&&function(t,r){var i=!1;return e(function(e){k(n(t,e)||[],function(t){r.records[e.name][t]&&(i=!0)})}),i}(t,a)&&(r(t,a),o=!0)}return a};function r(t,r){r.nodes.push(t),e(function(e){k(n(t,e)||[],function(t){r.records[e.name][t]=!0})})}}(P(e.eachComponent,e,"dataZoom"),sk,function(t,e){return t.get(e.axisIndex)}),r=[];e.eachComponent({mainType:"dataZoom",query:t},function(t,e){r.push.apply(r,n(t).nodes)}),k(r,function(e,n){e.setRawRange({start:t.start,end:t.end,startValue:t.startValue,endValue:t.endValue})})});var yk=k;function xk(t,e,n){(this._brushController=new X_(n.getZr())).on("brush",P(this._onBrush,this)).mount()}xk.defaultOption={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:m(md.toolbox.dataZoom.title),brushStyle:{borderWidth:0,color:"rgba(0,0,0,0.2)"}};var bk=xk.prototype;bk.render=function(t,e,n,r){this.model=t,this.ecModel=e,this.api=n,function(t,e,n,r,i){var o=n._isZoomActive;r&&"takeGlobalCursor"===r.type&&(o="dataZoomSelect"===r.key&&r.dataZoomSelectActive),n._isZoomActive=o,t.setIconStatus("zoom",o?"emphasis":"normal");var a=new HT(wk(t.option),e,{include:["grid"]});n._brushController.setPanels(a.makePanelOpts(i,function(t){return t.xAxisDeclared&&!t.yAxisDeclared?"lineX":!t.xAxisDeclared&&t.yAxisDeclared?"lineY":"rect"})).enableBrush(!!o&&{brushType:"auto",brushStyle:t.getModel("brushStyle").getItemStyle()})}(t,e,this,r,n),function(t,e){t.setIconStatus("back",1<function(t){return ek(t).length}(e)?"emphasis":"normal")}(t,e)},bk.onclick=function(t,e,n){_k[n].call(this)},bk.remove=function(t,e){this._brushController.unmount()},bk.dispose=function(t,e){this._brushController.dispose()};var _k={zoom:function(){this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!this._isZoomActive})},back:function(){this._dispatchZoomAction(function(t){var e=ek(t),n=e[e.length-1];1<e.length&&e.pop();var r={};return QT(n,function(t,n){for(var i=e.length-1;0<=i;i--)if(t=e[i][n]){r[n]=t;break}}),r}(this.ecModel))}};function wk(t){var e={};return k(["xAxisIndex","yAxisIndex"],function(n){e[n]=t[n],null==e[n]&&(e[n]="all"),!1!==e[n]&&"none"!==e[n]||(e[n]=[])}),e}function Sk(t){this.model=t}bk._onBrush=function(t,e){if(e.isEnd&&t.length){var n={},r=this.ecModel;this._brushController.updateCovers([]),new HT(wk(this.model.option),r,{include:["grid"]}).matchOutputRanges(t,r,function(t,e,n){if("cartesian2d"===n.type){var r=t.brushType;"rect"===r?(i("x",n,e[0]),i("y",n,e[1])):i({lineX:"x",lineY:"y"}[r],n,e)}}),function(t,e){var n=ek(t);QT(e,function(e,r){for(var i=n.length-1;0<=i&&!n[i][r];i--);if(i<0){var o=t.queryComponents({mainType:"dataZoom",subType:"select",id:r})[0];if(o){var a=o.getPercentRange();n[0][r]={dataZoomId:r,start:a[0],end:a[1]}}}}),n.push(e)}(r,n),this._dispatchZoomAction(n)}function i(t,e,i){var o=e.getAxis(t),a=o.model,s=function(t,e,n){var r;return n.eachComponent({mainType:"dataZoom",subType:"select"},function(n){n.getAxisModel(t,e.componentIndex)&&(r=n)}),r}(t,a,r),l=s.findRepresentativeAxisProxy(a).getMinMaxSpan();null==l.minValueSpan&&null==l.maxValueSpan||(i=C_(0,i.slice(),o.scale.getExtent(),0,l.minValueSpan,l.maxValueSpan)),s&&(n[s.id]={dataZoomId:s.id,startValue:i[0],endValue:i[1]})}},bk._dispatchZoomAction=function(t){var e=[];yk(t,function(t,n){e.push(m(t))}),e.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:e})},yT("dataZoom",xk),Qf(function(t){if(t){var e=t.dataZoom||(t.dataZoom=[]);R(e)||(t.dataZoom=e=[e]);var n=t.toolbox;if(n&&(R(n)&&(n=n[0]),n&&n.feature)){var r=n.feature.dataZoom;i("xAxis",r),i("yAxis",r)}}function i(n,r){if(r){var i=n+"Index",o=r[i];null==o||"all"===o||R(o)||(o=!1===o||"none"===o?[]:[o]),function(a,s){var l=t[a];R(l)||(l=l?[l]:[]),yk(l,function(t,a){if(null==o||"all"===o||-1!==S(o,a)){var s={type:"select",$fromToolbox:!0,filterMode:r.filterMode||"filter",id:"\0_ec_\0toolbox-dataZoom_"+n+a};s[i]=a,e.push(s)}})}(n)}}}),Sk.defaultOption={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:md.toolbox.restore.title},Sk.prototype.onclick=function(t,e,n){!function(t){t[tk]=null}(t),e.dispatchAction({type:"restore",from:this.uid})},yT("restore",Sk),eh({type:"restore",event:"restore",update:"prepareAndUpdate"},function(t,e){e.resetOption("recreate")}),sh({type:"tooltip",dependencies:["axisPointer"],defaultOption:{zlevel:0,z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:!1,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderRadius:4,borderWidth:0,padding:5,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#fff",fontSize:14}}});var Ck=k,Mk=Vl,Tk=["","-webkit-","-moz-","-o-"];function kk(t,e,n,r,i){var o=e&&e.painter;if(n){var a=o&&o.getViewportRoot();a&&function(t,e,n,r,i){Rt(Et,e,r,i,!0)&&Rt(t,n,Et[0],Et[1])}(t,a,document.body,r,i)}else{t[0]=r,t[1]=i;var s=o&&o.getViewportRootOffset();s&&(t[0]+=s.offsetLeft,t[1]+=s.offsetTop)}t[2]=t[0]/e.getWidth(),t[3]=t[1]/e.getHeight()}function Ak(t,e,n){if(i.wxa)return null;var r=document.createElement("div");r.domBelongToZr=!0,this.el=r;var o=this._zr=e.getZr(),a=this._appendToBody=n&&n.appendToBody;this._styleCoord=[0,0,0,0],kk(this._styleCoord,o,a,e.getWidth()/2,e.getHeight()/2),a?document.body.appendChild(r):t.appendChild(r),this._container=t,this._show=!1;var s=this;r.onmouseenter=function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0},r.onmousemove=function(t){if(t=t||window.event,!s._enterable){var e=o.handler;Wt(o.painter.getViewportRoot(),t,!0),e.dispatch("mousemove",t)}},r.onmouseleave=function(){s._enterable&&s._show&&s.hideLater(s._hideDelay),s._inContent=!1}}function Ik(t,e,n,r){t[0]=n,t[1]=r,t[2]=t[0]/e.getWidth(),t[3]=t[1]/e.getHeight()}function Dk(t){var e=this._zr=t.getZr();this._styleCoord=[0,0,0,0],Ik(this._styleCoord,e,t.getWidth()/2,t.getHeight()/2),this._show=!1}Ak.prototype={constructor:Ak,_enterable:!0,update:function(t){var e=this._container,n=e.currentStyle||document.defaultView.getComputedStyle(e),r=e.style;"absolute"!==r.position&&"absolute"!==n.position&&(r.position="relative"),t.get("alwaysShowContent")&&this._moveTooltipIfResized()},_moveTooltipIfResized:function(){var t=this._styleCoord[3],e=this._styleCoord[2]*this._zr.getWidth(),n=t*this._zr.getHeight();this.moveTo(e,n)},show:function(t){clearTimeout(this._hideTimeout);var e=this.el,n=this._styleCoord;e.style.cssText="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+function(t){var e=[],n=t.get("transitionDuration"),r=t.get("backgroundColor"),o=t.getModel("textStyle"),a=t.get("padding");return n&&e.push(function(t){var e="cubic-bezier(0.23, 1, 0.32, 1)",n="left "+t+"s "+e+",top "+t+"s "+e;return A(Tk,function(t){return t+"transition:"+n}).join(";")}(n)),r&&(i.canvasSupported?e.push("background-Color:"+r):(e.push("background-Color:#"+We(r)),e.push("filter:alpha(opacity=70)"))),Ck(["width","color","radius"],function(n){var r="border-"+n,i=Mk(r),o=t.get(i);null!=o&&e.push(r+":"+o+("color"===n?"":"px"))}),e.push(function(t){var e=[],n=t.get("fontSize"),r=t.getTextColor();r&&e.push("color:"+r),e.push("font:"+t.getFont());var i=t.get("lineHeight");null==i&&(i=Math.round(3*n/2)),n&&e.push("line-height:"+i+"px");var o=t.get("textShadowColor"),a=t.get("textShadowBlur")||0,s=t.get("textShadowOffsetX")||0,l=t.get("textShadowOffsetY")||0;return a&&e.push("text-shadow:"+s+"px "+l+"px "+a+"px "+o),Ck(["decoration","align"],function(n){var r=t.get(n);r&&e.push("text-"+n+":"+r)}),e.join(";")}(o)),null!=a&&e.push("padding:"+Fl(a).join("px ")+"px"),e.join(";")+";"}(t)+";left:"+n[0]+"px;top:"+n[1]+"px;"+(t.get("extraCssText")||""),e.style.display=e.innerHTML?"block":"none",e.style.pointerEvents=this._enterable?"auto":"none",this._show=!0},setContent:function(t){this.el.innerHTML=null==t?"":t},setEnterable:function(t){this._enterable=t},getSize:function(){var t=this.el;return[t.clientWidth,t.clientHeight]},moveTo:function(t,e){var n=this._styleCoord;kk(n,this._zr,this._appendToBody,t,e);var r=this.el.style;r.left=n[0]+"px",r.top=n[1]+"px"},hide:function(){this.el.style.display="none",this._show=!1},hideLater:function(t){!this._show||this._inContent&&this._enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(P(this.hide,this),t)):this.hide())},isShow:function(){return this._show},dispose:function(){this.el.parentNode.removeChild(this.el)},getOuterSize:function(){var t=this.el.clientWidth,e=this.el.clientHeight;if(document.defaultView&&document.defaultView.getComputedStyle){var n=document.defaultView.getComputedStyle(this.el);n&&(t+=parseInt(n.borderLeftWidth,10)+parseInt(n.borderRightWidth,10),e+=parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10))}return{width:t,height:e}}},Dk.prototype={constructor:Dk,_enterable:!0,update:function(t){t.get("alwaysShowContent")&&this._moveTooltipIfResized()},_moveTooltipIfResized:function(){var t=this._styleCoord[3],e=this._styleCoord[2]*this._zr.getWidth(),n=t*this._zr.getHeight();this.moveTo(e,n)},show:function(t){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.attr("show",!0),this._show=!0},setContent:function(t,e,n){this.el&&this._zr.remove(this.el);for(var r={},i=t,o="{marker",a=i.indexOf(o);0<=a;){var s=i.indexOf("|}"),l=i.substr(a+o.length,s-a-o.length);r["marker"+l]=-1<l.indexOf("sub")?{textWidth:4,textHeight:4,textBorderRadius:2,textBackgroundColor:e[l],textOffset:[3,0]}:{textWidth:10,textHeight:10,textBorderRadius:5,textBackgroundColor:e[l]},a=(i=i.substr(s+1)).indexOf("{marker")}var u=n.getModel("textStyle"),c=u.get("fontSize"),d=n.get("textLineHeight");null==d&&(d=Math.round(3*c/2)),this.el=new Da({style:Hs({},u,{rich:r,text:t,textBackgroundColor:n.get("backgroundColor"),textBorderRadius:n.get("borderRadius"),textFill:n.get("textStyle.color"),textPadding:n.get("padding"),textLineHeight:d}),z:n.get("z")}),this._zr.add(this.el);var f=this;this.el.on("mouseover",function(){f._enterable&&(clearTimeout(f._hideTimeout),f._show=!0),f._inContent=!0}),this.el.on("mouseout",function(){f._enterable&&f._show&&f.hideLater(f._hideDelay),f._inContent=!1})},setEnterable:function(t){this._enterable=t},getSize:function(){var t=this.el.getBoundingRect();return[t.width,t.height]},moveTo:function(t,e){if(this.el){var n=this._styleCoord;Ik(n,this._zr,t,e),this.el.attr("position",[n[0],n[1]])}},hide:function(){this.el&&this.el.hide(),this._show=!1},hideLater:function(t){!this._show||this._inContent&&this._enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(P(this.hide,this),t)):this.hide())},isShow:function(){return this._show},dispose:function(){clearTimeout(this._hideTimeout),this.el&&this._zr.remove(this.el)},getOuterSize:function(){var t=this.getSize();return{width:t[0],height:t[1]}}};var Ok=P,Pk=k,Ek=bl,Rk=new Ua({shape:{x:-1,y:-1,width:2,height:2}});function Lk(t){for(var e=t.pop();t.length;){var n=t.pop();n&&(hl.isInstance(n)&&(n=n.get("tooltip",!0)),"string"==typeof n&&(n={formatter:n}),e=new hl(n,e,e.ecModel))}return e}function Nk(t,e){return t.dispatchAction||P(e.dispatchAction,e)}function Bk(t){return"center"===t||"middle"===t}lh({type:"tooltip",init:function(t,e){if(!i.node){var n,r=t.getComponent("tooltip"),o=r.get("renderMode");this._renderMode=Fi(o),"html"===this._renderMode?(n=new Ak(e.getDom(),e,{appendToBody:r.get("appendToBody",!0)}),this._newLine="<br/>"):(n=new Dk(e),this._newLine="\n"),this._tooltipContent=n}},render:function(t,e,n){if(!i.node){this.group.removeAll(),this._tooltipModel=t,this._ecModel=e,this._api=n,this._lastDataByCoordSys=null,this._alwaysShowContent=t.get("alwaysShowContent");var r=this._tooltipContent;r.update(t),r.setEnterable(t.get("enterable")),this._initGlobalListener(),this._keepShow()}},_initGlobalListener:function(){var t=this._tooltipModel.get("triggerOn");LC("itemTooltip",this._api,Ok(function(e,n,r){"none"!==t&&(0<=t.indexOf(e)?this._tryShow(n,r):"leave"===e&&this._hide(r))},this))},_keepShow:function(){var t=this._tooltipModel,e=this._ecModel,n=this._api;if(null!=this._lastX&&null!=this._lastY&&"none"!==t.get("triggerOn")){var r=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){n.isDisposed()||r.manuallyShowTip(t,e,n,{x:r._lastX,y:r._lastY})})}},manuallyShowTip:function(t,e,n,r){if(r.from!==this.uid&&!i.node){var o=Nk(r,n);this._ticket="";var a=r.dataByCoordSys;if(r.tooltip&&null!=r.x&&null!=r.y){var s=Rk;s.position=[r.x,r.y],s.update(),s.tooltip=r.tooltip,this._tryShow({offsetX:r.x,offsetY:r.y,target:s},o)}else if(a)this._tryShow({offsetX:r.x,offsetY:r.y,position:r.position,dataByCoordSys:r.dataByCoordSys,tooltipOption:r.tooltipOption},o);else if(null!=r.seriesIndex){if(this._manuallyAxisShowTip(t,e,n,r))return;var l=CC(r,e),u=l.point[0],c=l.point[1];null!=u&&null!=c&&this._tryShow({offsetX:u,offsetY:c,position:r.position,target:l.el},o)}else null!=r.x&&null!=r.y&&(n.dispatchAction({type:"updateAxisPointer",x:r.x,y:r.y}),this._tryShow({offsetX:r.x,offsetY:r.y,position:r.position,target:n.getZr().findHover(r.x,r.y).target},o))}},manuallyHideTip:function(t,e,n,r){!this._alwaysShowContent&&this._tooltipModel&&this._tooltipContent.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=null,r.from!==this.uid&&this._hide(Nk(r,n))},_manuallyAxisShowTip:function(t,e,n,r){var i=r.seriesIndex,o=r.dataIndex,a=e.getComponent("axisPointer").coordSysAxesInfo;if(null!=i&&null!=o&&null!=a){var s=e.getSeriesByIndex(i);if(s&&"axis"===(t=Lk([s.getData().getItemModel(o),s,(s.coordinateSystem||{}).model,t])).get("trigger"))return n.dispatchAction({type:"updateAxisPointer",seriesIndex:i,dataIndex:o,position:r.position}),!0}},_tryShow:function(t,e){var n=t.target;if(this._tooltipModel){this._lastX=t.offsetX,this._lastY=t.offsetY;var r=t.dataByCoordSys;r&&r.length?this._showAxisTooltip(r,t):n&&null!=n.dataIndex?(this._lastDataByCoordSys=null,this._showSeriesItemTooltip(t,n,e)):n&&n.tooltip?(this._lastDataByCoordSys=null,this._showComponentItemTooltip(t,n,e)):(this._lastDataByCoordSys=null,this._hide(e))}},_showOrMove:function(t,e){var n=t.get("showDelay");e=P(e,this),clearTimeout(this._showTimout),0<n?this._showTimout=setTimeout(e,n):e()},_showAxisTooltip:function(t,e){var n=this._ecModel,r=[e.offsetX,e.offsetY],i=[],o=[],a=Lk([e.tooltipOption,this._tooltipModel]),s=this._renderMode,l=this._newLine,u={};Pk(t,function(t){Pk(t.dataByAxis,function(t){var e=n.getComponent(t.axisDim+"Axis",t.axisIndex),r=t.value,a=[];if(e&&null!=r){var c=ZC(r,e.axis,n,t.seriesDataIndices,t.valueLabelOpt);k(t.seriesDataIndices,function(i){var l=n.getSeriesByIndex(i.seriesIndex),d=i.dataIndexInside,f=l&&l.getDataParams(d);if(f.axisDim=t.axisDim,f.axisIndex=t.axisIndex,f.axisType=t.axisType,f.axisId=t.axisId,f.axisValue=jp(e.axis,r),f.axisValueLabel=c,f){o.push(f);var h,p=l.formatTooltip(d,!0,null,s);B(p)?(h=p.html,v(u,p.markers)):h=p,a.push(h)}});var d=c;i.push("html"!==s?a.join(l):(d?jl(d)+l:"")+a.join(l))}})},this),i.reverse(),i=i.join(this._newLine+this._newLine);var c=e.position;this._showOrMove(a,function(){this._updateContentNotChangedOnAxis(t)?this._updatePosition(a,c,r[0],r[1],this._tooltipContent,o):this._showTooltipContent(a,i,o,Math.random(),r[0],r[1],c,void 0,u)})},_showSeriesItemTooltip:function(t,e,n){var r=e.seriesIndex,i=this._ecModel.getSeriesByIndex(r),o=e.dataModel||i,a=e.dataIndex,s=e.dataType,l=o.getData(s),u=Lk([l.getItemModel(a),o,i&&(i.coordinateSystem||{}).model,this._tooltipModel]),c=u.get("trigger");if(null==c||"item"===c){var d,f,h=o.getDataParams(a,s),p=o.formatTooltip(a,!1,s,this._renderMode);f=B(p)?(d=p.html,p.markers):(d=p,null);var g="item_"+o.name+"_"+a;this._showOrMove(u,function(){this._showTooltipContent(u,d,h,g,t.offsetX,t.offsetY,t.position,t.target,f)}),n({type:"showTip",dataIndexInside:a,dataIndex:l.getRawIndex(a),seriesIndex:r,from:this.uid})}},_showComponentItemTooltip:function(t,e,n){var r=e.tooltip;"string"==typeof r&&(r={content:r,formatter:r});var i=new hl(r,this._tooltipModel,this._ecModel),o=i.get("content"),a=Math.random();this._showOrMove(i,function(){this._showTooltipContent(i,o,i.get("formatterParams")||{},a,t.offsetX,t.offsetY,t.position,e)}),n({type:"showTip",from:this.uid})},_showTooltipContent:function(t,e,n,r,i,o,a,s,l){if(this._ticket="",t.get("showContent")&&t.get("show")){var u=this._tooltipContent,c=t.get("formatter");a=a||t.get("position");var d=e;if(c&&"string"==typeof c)d=ql(c,n,!0);else if("function"==typeof c){var f=Ok(function(e,r){e===this._ticket&&(u.setContent(r,l,t),this._updatePosition(t,a,i,o,u,n,s))},this);this._ticket=r,d=c(n,r,f)}u.setContent(d,l,t),u.show(t),this._updatePosition(t,a,i,o,u,n,s)}},_updatePosition:function(t,e,n,r,i,o,a){var s=this._api.getWidth(),l=this._api.getHeight();e=e||t.get("position");var u=i.getSize(),c=t.get("align"),d=t.get("verticalAlign"),f=a&&a.getBoundingRect().clone();if(a&&f.applyTransform(a.transform),"function"==typeof e&&(e=e([n,r],o,i.el,f,{viewSize:[s,l],contentSize:u.slice()})),R(e))n=Ek(e[0],s),r=Ek(e[1],l);else if(B(e)){e.width=u[0],e.height=u[1];var h=au(e,{width:s,height:l});n=h.x,r=h.y,d=c=null}else if("string"==typeof e&&a)n=(p=function(t,e,n){var r=n[0],i=n[1],o=0,a=0,s=e.width,l=e.height;switch(t){case"inside":o=e.x+s/2-r/2,a=e.y+l/2-i/2;break;case"top":o=e.x+s/2-r/2,a=e.y-i-5;break;case"bottom":o=e.x+s/2-r/2,a=e.y+l+5;break;case"left":o=e.x-r-5,a=e.y+l/2-i/2;break;case"right":o=e.x+s+5,a=e.y+l/2-i/2}return[o,a]}(e,f,u))[0],r=p[1];else{var p;n=(p=function(t,e,n,r,i,o,a){var s=n.getOuterSize(),l=s.width,u=s.height;return null!=o&&(r<t+l+o?t-=l+o:t+=o),null!=a&&(i<e+u+a?e-=u+a:e+=a),[t,e]}(n,r,i,s,l,c?null:20,d?null:20))[0],r=p[1]}c&&(n-=Bk(c)?u[0]/2:"right"===c?u[0]:0),d&&(r-=Bk(d)?u[1]/2:"bottom"===d?u[1]:0),t.get("confine")&&(n=(p=function(t,e,n,r,i){var o=n.getOuterSize(),a=o.width,s=o.height;return t=Math.min(t+a,r)-a,e=Math.min(e+s,i)-s,[t=Math.max(t,0),e=Math.max(e,0)]}(n,r,i,s,l))[0],r=p[1]),i.moveTo(n,r)},_updateContentNotChangedOnAxis:function(t){var e=this._lastDataByCoordSys,n=!!e&&e.length===t.length;return n&&Pk(e,function(e,r){var i=e.dataByAxis||{},o=(t[r]||{}).dataByAxis||[];(n&=i.length===o.length)&&Pk(i,function(t,e){var r=o[e]||{},i=t.seriesDataIndices||[],a=r.seriesDataIndices||[];(n&=t.value===r.value&&t.axisType===r.axisType&&t.axisId===r.axisId&&i.length===a.length)&&Pk(i,function(t,e){var r=a[e];n&=t.seriesIndex===r.seriesIndex&&t.dataIndex===r.dataIndex})})}),this._lastDataByCoordSys=t,!!n},_hide:function(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid})},dispose:function(t,e){i.node||(this._tooltipContent.dispose(),zC("itemTooltip",e))}}),eh({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},function(){}),eh({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},function(){});var zk=["rect","polygon","keep","clear"],Vk=k;function Fk(t){if(t)for(var e in t)if(t.hasOwnProperty(e))return!0}function Hk(t,e,n){var r={};return Vk(e,function(e){var i=r[e]=function(){function t(){}return t.prototype.__hidden=t.prototype,new t}();Vk(t[e],function(t,r){if(zx.isValidType(r)){var o={type:r,visual:t};n&&n(o,e),i[r]=new zx(o),"opacity"===r&&((o=m(o)).type="colorAlpha",i.__hidden.__alphaForOpacity=new zx(o))}})}),r}function Wk(t,e,n){var r;k(n,function(t){e.hasOwnProperty(t)&&Fk(e[t])&&(r=!0)}),r&&k(n,function(n){e.hasOwnProperty(n)&&Fk(e[n])?t[n]=m(e[n]):delete t[n]})}var jk={lineX:Gk(0),lineY:Gk(1),rect:{point:function(t,e,n){return t&&n.boundingRect.contain(t[0],t[1])},rect:function(t,e,n){return t&&n.boundingRect.intersect(t)}},polygon:{point:function(t,e,n){return t&&n.boundingRect.contain(t[0],t[1])&&ig(n.range,t[0],t[1])},rect:function(t,e,n){var r=n.range;if(!t||r.length<=1)return!1;var i=t.x,o=t.y,a=t.width,s=t.height,l=r[0];return!!(ig(r,i,o)||ig(r,i+a,o)||ig(r,i,o+s)||ig(r,i+a,o+s)||Sn.create(t).contain(l[0],l[1])||rl(i,o,i+a,o,r)||rl(i,o,i,o+s,r)||rl(i+a,o,i+a,o+s,r)||rl(i,o+s,i+a,o+s,r))||void 0}}};function Gk(t){var e=["x","y"],n=["width","height"];return{point:function(e,n,r){if(e)return Uk(e[t],r.range)},rect:function(r,i,o){if(r){var a=o.range,s=[r[e[t]],r[e[t]]+r[n[t]]];return s[1]<s[0]&&s.reverse(),Uk(s[0],a)||Uk(s[1],a)||Uk(a[0],s)||Uk(a[1],s)}}}}function Uk(t,e){return e[0]<=t&&t<=e[1]}var qk=["inBrush","outOfBrush"],Xk="__ecBrushSelect",Yk="__ecInBrushSelectEvent",$k=ff.VISUAL.BRUSH;function Zk(t){t.eachComponent({mainType:"brush"},function(e){(e.brushTargetManager=new HT(e.option,t)).setInputRanges(e.areas,t)})}function Kk(t,e){if(!t.isDisposed()){var n=t.getZr();n[Yk]=!0,t.dispatchAction({type:"brushSelect",batch:e}),n[Yk]=!1}}function Jk(t,e,n,r){for(var i=0,o=e.length;i<o;i++){var a=e[i];if(t[a.brushType](r,n,a.selectors,a))return!0}}function Qk(t){var e=t.brushSelector;if(N(e)){var n=[];return k(jk,function(t,r){n[r]=function(n,r,i,o){var a=r.getItemLayout(n);return t[e](a,i,o)}}),n}if(L(e)){var r={};return k(jk,function(t,n){r[n]=e}),r}return e}rh($k,function(t,e,n){t.eachComponent({mainType:"brush"},function(t){n&&"takeGlobalCursor"===n.type&&t.setBrushOption("brush"===n.key?n.brushOption:{brushType:!1})}),Zk(t)}),ih($k,function(t,e,n){var r,i,o=[];t.eachComponent({mainType:"brush"},function(e,n){var a={brushId:e.id,brushIndex:n,brushName:e.name,areas:m(e.areas),selected:[]};o.push(a);var s=e.option,l=s.brushLink,u=[],c=[],d=[],f=0;n||(r=s.throttleType,i=s.throttleDelay);var h=A(e.areas,function(t){return function(t){var e=t.selectors={};return k(jk[t.brushType],function(n,r){e[r]=function(r){return n(r,e,t)}}),t}(b({boundingRect:tA[t.brushType](t)},t))}),p=Hk(e.option,qk,function(t){t.mappingMethod="fixed"});function g(t){return"all"===l||u[t]}function v(t){return!!t.length}R(l)&&k(l,function(t){u[t]=1}),t.eachSeries(function(n,r){var i=d[r]=[];"parallel"===n.subType?function(t,e){var n=t.coordinateSystem;f|=n.hasAxisBrushed(),g(e)&&n.eachActiveState(t.getData(),function(t,e){"active"===t&&(c[e]=1)})}(n,r):function(n,r,i){var o=Qk(n);if(o&&!function(t,e){var n=t.option.seriesIndex;return null!=n&&"all"!==n&&(R(n)?S(n,e)<0:e!==n)}(e,r)&&(k(h,function(r){o[r.brushType]&&e.brushTargetManager.controlSeries(r,n,t)&&i.push(r),f|=v(i)}),g(r)&&v(i))){var a=n.getData();a.each(function(t){Jk(o,i,a,t)&&(c[t]=1)})}}(n,r,i)}),t.eachSeries(function(t,e){var n={seriesId:t.id,seriesIndex:e,seriesName:t.name,dataIndex:[]};a.selected.push(n);var r=Qk(t),i=d[e],o=t.getData(),s=g(e)?function(t){return c[t]?(n.dataIndex.push(o.getRawIndex(t)),"inBrush"):"outOfBrush"}:function(t){return Jk(r,i,o,t)?(n.dataIndex.push(o.getRawIndex(t)),"inBrush"):"outOfBrush"};(g(e)?f:v(i))&&function(t,e,n,r,i,o){var a,s={};function l(t){return n.getItemVisual(a,t)}function u(t,e){n.setItemVisual(a,t,e)}k(t,function(t){var n=zx.prepareVisualTypes(e[t]);s[t]=n}),n.each(function(t,i){var o=n.getRawDataItem(a=t);if(!o||!1!==o.visualMap)for(var c=r.call(void 0,t),d=e[c],f=s[c],h=0,p=f.length;h<p;h++){var g=f[h];d[g]&&d[g].applyVisual(t,l,u)}})}(qk,p,o,s)})}),function(t,e,n,r,i){if(i){var o=t.getZr();o[Yk]||(o[Xk]||(o[Xk]=Kk),hd(o,Xk,n,e)(t,r))}}(e,r,i,o,n)});var tA={lineX:et,lineY:et,rect:function(t){return eA(t.range)},polygon:function(t){for(var e,n=t.range,r=0,i=n.length;r<i;r++){var o=n[r];o[0]<(e=e||[[1/0,-1/0],[1/0,-1/0]])[0][0]&&(e[0][0]=o[0]),o[0]>e[0][1]&&(e[0][1]=o[0]),o[1]<e[1][0]&&(e[1][0]=o[1]),o[1]>e[1][1]&&(e[1][1]=o[1])}return e&&eA(e)}};function eA(t){return new Sn(t[0][0],t[1][0],t[0][1]-t[0][0],t[1][1]-t[1][0])}var nA=["#ddd"];function rA(t,e){return v({brushType:t.brushType,brushMode:t.brushMode,transformable:t.transformable,brushStyle:new hl(t.brushStyle).getItemStyle(),removeOnClick:t.removeOnClick,z:t.z},e,!0)}function iA(t,e,n,r){r&&r.$from===t.id||this._brushController.setPanels(t.brushTargetManager.makePanelOpts(n)).enableBrush(t.brushOption).updateCovers(t.areas.slice())}function oA(t,e,n){this.model=t,this.ecModel=e,this.api=n}sh({type:"brush",dependencies:["geo","grid","xAxis","yAxis","parallel","series"],defaultOption:{toolbox:null,brushLink:null,seriesIndex:"all",geoIndex:null,xAxisIndex:null,yAxisIndex:null,brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(120,140,180,0.3)",borderColor:"rgba(120,140,180,0.8)"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},areas:[],brushType:null,brushOption:{},coordInfoList:[],optionUpdated:function(t,e){var n=this.option;e||Wk(n,t,["inBrush","outOfBrush"]);var r=n.inBrush=n.inBrush||{};n.outOfBrush=n.outOfBrush||{color:nA},r.hasOwnProperty("liftZ")||(r.liftZ=5)},setAreas:function(t){t&&(this.areas=A(t,function(t){return rA(this.option,t)},this))},setBrushOption:function(t){this.brushOption=rA(this.option,t),this.brushType=this.brushOption.brushType}}),lh({type:"brush",init:function(t,e){this.ecModel=t,this.api=e,(this._brushController=new X_(e.getZr())).on("brush",P(this._onBrush,this)).mount()},render:function(t){return this.model=t,iA.apply(this,arguments)},updateTransform:function(t,e){return Zk(e),iA.apply(this,arguments)},updateView:iA,dispose:function(){this._brushController.dispose()},_onBrush:function(t,e){var n=this.model.id;this.model.brushTargetManager.setOutputRanges(t,this.ecModel),e.isEnd&&!e.removeOnClick||this.api.dispatchAction({type:"brush",brushId:n,areas:m(t),$from:n}),e.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:n,areas:m(t),$from:n})}}),eh({type:"brush",event:"brush"},function(t,e){e.eachComponent({mainType:"brush",query:t},function(e){e.setAreas(t.areas)})}),eh({type:"brushSelect",event:"brushSelected",update:"none"},function(){}),eh({type:"brushEnd",event:"brushEnd",update:"none"},function(){}),oA.defaultOption={show:!0,type:["rect","polygon","lineX","lineY","keep","clear"],icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:m(md.toolbox.brush.title)};var aA=oA.prototype;function sA(t){var e=t.itemStyle||(t.itemStyle={}),n=e.emphasis||(e.emphasis={}),r=t.label||t.label||{},i=r.normal||(r.normal={}),o={normal:1,emphasis:1};k(r,function(t,e){o[e]||lA(i,e)||(i[e]=t)}),n.label&&!lA(r,"emphasis")&&(r.emphasis=n.label,delete n.label)}function lA(t,e){return t.hasOwnProperty(e)}aA.render=aA.updateView=function(t,e,n){var r,i,o;e.eachComponent({mainType:"brush"},function(t){r=t.brushType,i=t.brushOption.brushMode||"single",o|=t.areas.length}),this._brushType=r,this._brushMode=i,k(t.get("type",!0),function(e){t.setIconStatus(e,("keep"===e?"multiple"===i:"clear"===e?o:e===r)?"emphasis":"normal")})},aA.getIcons=function(){var t=this.model,e=t.get("icon",!0),n={};return k(t.get("type",!0),function(t){e[t]&&(n[t]=e[t])}),n},aA.onclick=function(t,e,n){var r=this._brushType,i=this._brushMode;"clear"===n?(e.dispatchAction({type:"axisAreaSelect",intervals:[]}),e.dispatchAction({type:"brush",command:"clear",areas:[]})):e.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:"keep"===n?r:r!==n&&n,brushMode:"keep"===n?"multiple"===i?"single":"multiple":i}})},yT("brush",oA),Qf(function(t,e){var n=t&&t.brush;if(R(n)||(n=n?[n]:[]),n.length){var r=[];k(n,function(t){var e=t.hasOwnProperty("toolbox")?t.toolbox:[];e instanceof Array&&(r=r.concat(e))});var i=t&&t.toolbox;R(i)&&(i=i[0]),i||(t.toolbox=[i={feature:{}}]);var o=i.feature||(i.feature={}),a=o.brush||(o.brush={}),s=a.type||(a.type=[]);s.push.apply(s,r),function(t){var e={};k(t,function(t){e[t]=1}),t.length=0,k(e,function(e,n){t.push(n)})}(s),e&&!s.length&&s.push.apply(s,zk)}}),sh({type:"title",layoutMode:{type:"box",ignoreSize:!0},defaultOption:{zlevel:0,z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bolder",color:"#333"},subtextStyle:{color:"#aaa"}}}),lh({type:"title",render:function(t,e,n){if(this.group.removeAll(),t.get("show")){var r=this.group,i=t.getModel("textStyle"),o=t.getModel("subtextStyle"),a=t.get("textAlign"),s=j(t.get("textBaseline"),t.get("textVerticalAlign")),l=new Da({style:Hs({},i,{text:t.get("text"),textFill:i.getTextColor()},{disableBox:!0}),z2:10}),u=l.getBoundingRect(),c=t.get("subtext"),d=new Da({style:Hs({},o,{text:c,textFill:o.getTextColor(),y:u.height+t.get("itemGap"),textVerticalAlign:"top"},{disableBox:!0}),z2:10}),f=t.get("link"),h=t.get("sublink"),p=t.get("triggerEvent",!0);l.silent=!f&&!p,d.silent=!h&&!p,f&&l.on("click",function(){Ql(f,"_"+t.get("target"))}),h&&d.on("click",function(){Ql(h,"_"+t.get("subtarget"))}),l.eventData=d.eventData=p?{componentType:"title",componentIndex:t.componentIndex}:null,r.add(l),c&&r.add(d);var g=r.getBoundingRect(),m=t.getBoxLayoutParams();m.width=g.width,m.height=g.height;var v=au(m,{width:n.getWidth(),height:n.getHeight()},t.get("padding"));a||("middle"===(a=t.get("left")||t.get("right"))&&(a="center"),"right"===a?v.x+=v.width:"center"===a&&(v.x+=v.width/2)),s||("center"===(s=t.get("top")||t.get("bottom"))&&(s="middle"),"bottom"===s?v.y+=v.height:"middle"===s&&(v.y+=v.height/2),s=s||"top"),r.attr("position",[v.x,v.y]);var y={textAlign:a,textVerticalAlign:s};l.setStyle(y),d.setStyle(y),g=r.getBoundingRect();var x=v.margin,b=t.getItemStyle(["color","opacity"]);b.fill=t.get("backgroundColor");var _=new Ua({shape:{x:g.x-x[3],y:g.y-x[0],width:g.width+x[1]+x[3],height:g.height+x[0]+x[2],r:t.get("borderRadius")},style:b,subPixelOptimize:!0,silent:!0});r.add(_)}}}),gu.registerSubTypeDefaulter("timeline",function(){return"slider"}),eh({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(t,e){var n=e.getComponent("timeline");return n&&null!=t.currentIndex&&(n.setCurrentIndex(t.currentIndex),!n.get("loop",!0)&&n.isIndexMax()&&n.setPlayState(!1)),e.resetOption("timeline"),b({currentIndex:n.option.currentIndex},t)}),eh({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(t,e){var n=e.getComponent("timeline");n&&null!=t.playState&&n.setPlayState(t.playState)});var uA=gu.extend({type:"timeline",layoutMode:"box",defaultOption:{zlevel:0,z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},init:function(t,e,n){this.mergeDefaultAndTheme(t,n),this._initData()},mergeOption:function(t){uA.superApply(this,"mergeOption",arguments),this._initData()},setCurrentIndex:function(t){null==t&&(t=this.option.currentIndex);var e=this._data.count();this.option.loop?t=(t%e+e)%e:(e<=t&&(t=e-1),t<0&&(t=0)),this.option.currentIndex=t},getCurrentIndex:function(){return this.option.currentIndex},isIndexMax:function(){return this.getCurrentIndex()>=this._data.count()-1},setPlayState:function(t){this.option.autoPlay=!!t},getPlayState:function(){return!!this.option.autoPlay},_initData:function(){var t=this.option,e=t.data||[],n=t.axisType,r=this._names=[];if("category"===n){var i=[];k(e,function(t,e){var n,o=Ii(t);B(t)?(n=m(t)).value=e:n=e,i.push(n),N(o)||null!=o&&!isNaN(o)||(o=""),r.push(o+"")}),e=i}(this._data=new Ah([{name:"value",type:{category:"ordinal",time:"time"}[n]||"number"}],this)).initData(e,r)},getData:function(){return this._data},getCategories:function(){if("category"===this.get("axisType"))return this._names.slice()}});function cA(t,e,n,r){mg.call(this,t,e,n),this.type=r||"value",this.model=null}M(uA.extend({type:"timeline.slider",defaultOption:{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"emptyCircle",symbolSize:10,lineStyle:{show:!0,width:2,color:"#304654"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#304654"},itemStyle:{color:"#304654",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:13,color:"#c23531",borderWidth:5,borderColor:"rgba(194,53,49, 0.5)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:22,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"path://M18.6,50.8l22.5-22.5c0.2-0.2,0.3-0.4,0.3-0.7c0-0.3-0.1-0.5-0.3-0.7L18.7,4.4c-0.1-0.1-0.2-0.3-0.2-0.5 c0-0.4,0.3-0.8,0.8-0.8c0.2,0,0.5,0.1,0.6,0.3l23.5,23.5l0,0c0.2,0.2,0.3,0.4,0.3,0.7c0,0.3-0.1,0.5-0.3,0.7l-0.1,0.1L19.7,52 c-0.1,0.1-0.3,0.2-0.5,0.2c-0.4,0-0.8-0.3-0.8-0.8C18.4,51.2,18.5,51,18.6,50.8z",prevIcon:"path://M43,52.8L20.4,30.3c-0.2-0.2-0.3-0.4-0.3-0.7c0-0.3,0.1-0.5,0.3-0.7L42.9,6.4c0.1-0.1,0.2-0.3,0.2-0.5 c0-0.4-0.3-0.8-0.8-0.8c-0.2,0-0.5,0.1-0.6,0.3L18.3,28.8l0,0c-0.2,0.2-0.3,0.4-0.3,0.7c0,0.3,0.1,0.5,0.3,0.7l0.1,0.1L41.9,54 c0.1,0.1,0.3,0.2,0.5,0.2c0.4,0,0.8-0.3,0.8-0.8C43.2,53.2,43.1,53,43,52.8z",color:"#304654",borderColor:"#304654",borderWidth:1},emphasis:{label:{show:!0,color:"#c23531"},itemStyle:{color:"#c23531"},controlStyle:{color:"#c23531",borderColor:"#c23531",borderWidth:2}},data:[]}}),Ac);var dA=Kc.extend({type:"timeline"});cA.prototype={constructor:cA,getLabelModel:function(){return this.model.getModel("label")},isHorizontal:function(){return"horizontal"===this.model.get("orient")}},C(cA,mg);var fA=P,hA=k,pA=Math.PI;function gA(t,e,n,r,i,o){var a=e.get("color");i?(i.setColor(a),n.add(i),o&&o.onUpdate(i)):((i=eg(t.get("symbol"),-1,-1,2,2,a)).setStyle("strokeNoScale",!0),n.add(i),o&&o.onCreate(i));var s=e.getItemStyle(["color","symbol","symbolSize"]);i.setStyle(s),r=v({rectHover:!0,z2:100},r,!0);var l=t.get("symbolSize");(l=l instanceof Array?l.slice():[+l,+l])[0]/=2,l[1]/=2,r.scale=l;var u=t.get("symbolOffset");if(u){var c=r.position=r.position||[0,0];c[0]+=bl(u[0],l[0]),c[1]+=bl(u[1],l[1])}var d=t.get("symbolRotate");return r.rotation=(d||0)*Math.PI/180||0,i.attr(r),i.updateTransform(),i}function mA(t,e,n,r,i){if(!t.dragging){var o=r.getModel("checkpointStyle"),a=n.dataToCoord(r.getData().get(["value"],e));i||!o.get("animation",!0)?t.attr({position:[a,0]}):(t.stopAnimation(!0),t.animateTo({position:[a,0]},o.get("animationDuration",!0),o.get("animationEasing",!0)))}}dA.extend({type:"timeline.slider",init:function(t,e){this.api=e},render:function(t,e,n,r){if(this.model=t,this.api=n,this.ecModel=e,this.group.removeAll(),t.get("show",!0)){var i=this._layout(t,n),o=this._createGroup("mainGroup"),a=this._createGroup("labelGroup"),s=this._axis=this._createAxis(i,t);t.formatTooltip=function(t){return jl(s.scale.getLabel(t))},hA(["AxisLine","AxisTick","Control","CurrentPointer"],function(e){this["_render"+e](i,o,s,t)},this),this._renderAxisLabel(i,a,s,t),this._position(i,t)}this._doPlayStop()},remove:function(){this._clearTimer(),this.group.removeAll()},dispose:function(){this._clearTimer()},_layout:function(t,e){var n=t.get("label.position"),r=t.get("orient"),i=function(t,e){return au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()},t.get("padding"))}(t,e);null==n||"auto"===n?n="horizontal"===r?i.y+i.height/2<e.getHeight()/2?"-":"+":i.x+i.width/2<e.getWidth()/2?"+":"-":isNaN(n)&&(n={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[r][n]);var o,a,s,l,u={horizontal:"center",vertical:0<=n||"+"===n?"left":"right"},c={horizontal:0<=n||"+"===n?"top":"bottom",vertical:"middle"},d={horizontal:0,vertical:pA/2},f="vertical"===r?i.height:i.width,h=t.getModel("controlStyle"),p=h.get("show",!0),g=p?h.get("itemSize"):0,m=p?h.get("itemGap"):0,v=g+m,y=t.get("label.rotate")||0;y=y*pA/180;var x=h.get("position",!0),b=p&&h.get("showPlayBtn",!0),_=p&&h.get("showPrevBtn",!0),w=0,S=f;return"left"===x||"bottom"===x?(b&&(o=[0,0],w+=v),_&&(a=[w,0],w+=v)):(b&&(o=[S-g,0],S-=v),_&&(a=[0,0],w+=v)),p&&h.get("showNextBtn",!0)&&(s=[S-g,0],S-=v),l=[w,S],t.get("inverse")&&l.reverse(),{viewRect:i,mainLength:f,orient:r,rotation:d[r],labelRotation:y,labelPosOpt:n,labelAlign:t.get("label.align")||u[r],labelBaseline:t.get("label.verticalAlign")||t.get("label.baseline")||c[r],playPosition:o,prevBtnPosition:a,nextBtnPosition:s,axisExtent:l,controlSize:g,controlGap:m}},_position:function(t,e){var n=this._mainGroup,r=this._labelGroup,i=t.viewRect;if("vertical"===t.orient){var o=re(),a=i.x,s=i.y+i.height;se(o,o,[-a,-s]),le(o,o,-pA/2),se(o,o,[a,s]),(i=i.clone()).applyTransform(o)}var l=m(i),u=m(n.getBoundingRect()),c=m(r.getBoundingRect()),d=n.position,f=r.position;f[0]=d[0]=l[0][0];var h,p=t.labelPosOpt;function g(t){var e=t.position;t.origin=[l[0][0]-e[0],l[1][0]-e[1]]}function m(t){return[[t.x,t.x+t.width],[t.y,t.y+t.height]]}function v(t,e,n,r,i){t[r]+=n[r][i]-e[r][i]}isNaN(p)?(v(d,u,l,1,h="+"===p?0:1),v(f,c,l,1,1-h)):(v(d,u,l,1,h=0<=p?0:1),f[1]=d[1]+p),n.attr("position",d),r.attr("position",f),n.rotation=r.rotation=t.rotation,g(n),g(r)},_createAxis:function(t,e){var n=e.getData(),r=e.get("axisType"),i=Hp(e,r);i.getTicks=function(){return n.mapArray(["value"],function(t){return t})};var o=n.getDataExtent("value");i.setExtent(o[0],o[1]),i.niceTicks();var a=new cA("value",i,t.axisExtent,r);return a.model=e,a},_createGroup:function(t){var e=this["_"+t]=new Cn;return this.group.add(e),e},_renderAxisLine:function(t,e,n,r){var i=n.getExtent();r.get("lineStyle.show")&&e.add(new Xa({shape:{x1:i[0],y1:0,x2:i[1],y2:0},style:x({lineCap:"round"},r.getModel("lineStyle").getLineStyle()),silent:!0,z2:1}))},_renderAxisTick:function(t,e,n,r){var i=r.getData(),o=n.scale.getTicks();hA(o,function(t){var o=n.dataToCoord(t),a=i.getItemModel(t),s=a.getModel("itemStyle"),l=a.getModel("emphasis.itemStyle"),u={position:[o,0],onclick:fA(this._changeTimeline,this,t)},c=gA(a,s,e,u);Ls(c,l.getItemStyle()),a.get("tooltip")?(c.dataIndex=t,c.dataModel=r):c.dataIndex=c.dataModel=null},this)},_renderAxisLabel:function(t,e,n,r){if(n.getLabelModel().get("show")){var i=r.getData(),o=n.getViewLabels();hA(o,function(r){var o=r.tickValue,a=i.getItemModel(o),s=a.getModel("label"),l=a.getModel("emphasis.label"),u=n.dataToCoord(r.tickValue),c=new Da({position:[u,0],rotation:t.labelRotation-t.rotation,onclick:fA(this._changeTimeline,this,o),silent:!1});Hs(c.style,s,{text:r.formattedLabel,textAlign:t.labelAlign,textVerticalAlign:t.labelBaseline}),e.add(c),Ls(c,Hs({},l))},this)}},_renderControl:function(t,e,n,r){var i=t.controlSize,o=t.rotation,a=r.getModel("controlStyle").getItemStyle(),s=r.getModel("emphasis.controlStyle").getItemStyle(),l=[0,-i/2,i,i],u=r.getPlayState(),c=r.get("inverse",!0);function d(t,n,u,c){if(t){var d=function(t,e,n,r){var i=r.style,o=nl(t.get(e),r||{},new Sn(n[0],n[1],n[2],n[3]));return i&&o.setStyle(i),o}(r,n,l,{position:t,origin:[i/2,0],rotation:c?-o:0,rectHover:!0,style:a,onclick:u});e.add(d),Ls(d,s)}}d(t.nextBtnPosition,"controlStyle.nextIcon",fA(this._changeTimeline,this,c?"-":"+")),d(t.prevBtnPosition,"controlStyle.prevIcon",fA(this._changeTimeline,this,c?"+":"-")),d(t.playPosition,"controlStyle."+(u?"stopIcon":"playIcon"),fA(this._handlePlayClick,this,!u),!0)},_renderCurrentPointer:function(t,e,n,r){var i=r.getData(),o=r.getCurrentIndex(),a=i.getItemModel(o).getModel("checkpointStyle"),s=this;this._currentPointer=gA(a,a,this._mainGroup,{},this._currentPointer,{onCreate:function(t){t.draggable=!0,t.drift=fA(s._handlePointerDrag,s),t.ondragend=fA(s._handlePointerDragend,s),mA(t,o,n,r,!0)},onUpdate:function(t){mA(t,o,n,r)}})},_handlePlayClick:function(t){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:t,from:this.uid})},_handlePointerDrag:function(t,e,n){this._clearTimer(),this._pointerChangeTimeline([n.offsetX,n.offsetY])},_handlePointerDragend:function(t){this._pointerChangeTimeline([t.offsetX,t.offsetY],!0)},_pointerChangeTimeline:function(t,e){var n=this._toAxisCoord(t)[0],r=wl(this._axis.getExtent().slice());n>r[1]&&(n=r[1]),n<r[0]&&(n=r[0]),this._currentPointer.position[0]=n,this._currentPointer.dirty();var i=this._findNearestTick(n),o=this.model;(e||i!==o.getCurrentIndex()&&o.get("realtime"))&&this._changeTimeline(i)},_doPlayStop:function(){this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(fA(function(){var t=this.model;this._changeTimeline(t.getCurrentIndex()+(t.get("rewind",!0)?-1:1))},this),this.model.get("playInterval")))},_toAxisCoord:function(t){return Js(t,this._mainGroup.getLocalTransform(),!0)},_findNearestTick:function(t){var e,n=this.model.getData(),r=1/0,i=this._axis;return n.each(["value"],function(n,o){var a=i.dataToCoord(n),s=Math.abs(a-t);s<r&&(r=s,e=o)}),e},_clearTimer:function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},_changeTimeline:function(t){var e=this.model.getCurrentIndex();"+"===t?t=e+1:"-"===t&&(t=e-1),this.api.dispatchAction({type:"timelineChange",currentIndex:t,from:this.uid})}}),Qf(function(t){var e=t&&t.timeline;R(e)||(e=e?[e]:[]),k(e,function(t){t&&function(t){var e=t.type,n={number:"value",time:"time"};if(n[e]&&(t.axisType=n[e],delete t.type),sA(t),lA(t,"controlPosition")){var r=t.controlStyle||(t.controlStyle={});lA(r,"position")||(r.position=t.controlPosition),"none"!==r.position||lA(r,"show")||(r.show=!1,delete r.position),delete t.controlPosition}k(t.data||[],function(t){B(t)&&!R(t)&&(!lA(t,"value")&&lA(t,"name")&&(t.value=t.name),sA(t))})}(t)})});var vA=zl,yA=jl;function xA(t){ki(t,"label",["show"])}var bA=sh({type:"marker",dependencies:["series","grid","polar","geo"],init:function(t,e,n){this.mergeDefaultAndTheme(t,n),this._mergeOption(t,n,!1,!0)},isAnimationEnabled:function(){if(i.node)return!1;var t=this.__hostSeries;return this.getShallow("animation")&&t&&t.isAnimationEnabled()},mergeOption:function(t,e){this._mergeOption(t,e,!1,!1)},_mergeOption:function(t,e,n,r){var i=this.constructor,o=this.mainType+"Model";n||e.eachSeries(function(t){var n=t.get(this.mainType,!0),a=t[o];n&&n.data?(a?a._mergeOption(n,e,!0):(r&&xA(n),k(n.data,function(t){t instanceof Array?(xA(t[0]),xA(t[1])):xA(t)}),x(a=new i(n,this,e),{mainType:this.mainType,seriesIndex:t.seriesIndex,name:t.name,createdBySelf:!0}),a.__hostSeries=t),t[o]=a):t[o]=null},this)},formatTooltip:function(t,e,n,r){var i=this.getData(),o=this.getRawValue(t),a=R(o)?A(o,vA).join(", "):vA(o),s=i.getName(t),l=yA(this.name);return null==o&&!s||(l+="html"===r?"<br/>":"\n"),s&&(l+=yA(s),null!=o&&(l+=" : ")),null!=o&&(l+=yA(a)),l},getData:function(){return this._data},setData:function(t){this._data=t}});M(bA,Ac),bA.extend({type:"markPoint",defaultOption:{zlevel:0,z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}}});var _A=S;function wA(t,e,n,r,i,o){var a=[],s=Xh(e,r)?e.getCalculationInfo("stackResultDimension"):r,l=IA(e,s,t),u=e.indicesOfNearest(s,l)[0];a[i]=e.get(n,u),a[o]=e.get(s,u);var c=e.get(r,u),d=Sl(e.get(r,u));return 0<=(d=Math.min(d,20))&&(a[o]=+a[o].toFixed(d)),[a,c]}var SA=E,CA={min:SA(wA,"min"),max:SA(wA,"max"),average:SA(wA,"average")};function MA(t,e){var n=t.getData(),r=t.coordinateSystem;if(e&&!function(t){return!isNaN(parseFloat(t.x))&&!isNaN(parseFloat(t.y))}(e)&&!R(e.coord)&&r){var i=r.dimensions,o=TA(e,n,r,t);if((e=m(e)).type&&CA[e.type]&&o.baseAxis&&o.valueAxis){var a=_A(i,o.baseAxis.dim),s=_A(i,o.valueAxis.dim),l=CA[e.type](n,o.baseDataDim,o.valueDataDim,a,s);e.coord=l[0],e.value=l[1]}else{for(var u=[null!=e.xAxis?e.xAxis:e.radiusAxis,null!=e.yAxis?e.yAxis:e.angleAxis],c=0;c<2;c++)CA[u[c]]&&(u[c]=IA(n,n.mapDimension(i[c]),u[c]));e.coord=u}}return e}function TA(t,e,n,r){var i={};return null!=t.valueIndex||null!=t.valueDim?(i.valueDataDim=null!=t.valueIndex?e.getDimension(t.valueIndex):t.valueDim,i.valueAxis=n.getAxis(function(t,e){var n=t.getData(),r=n.dimensions;e=n.getDimension(e);for(var i=0;i<r.length;i++){var o=n.getDimensionInfo(r[i]);if(o.name===e)return o.coordDim}}(r,i.valueDataDim)),i.baseAxis=n.getOtherAxis(i.valueAxis),i.baseDataDim=e.mapDimension(i.baseAxis.dim)):(i.baseAxis=r.getBaseAxis(),i.valueAxis=n.getOtherAxis(i.baseAxis),i.baseDataDim=e.mapDimension(i.baseAxis.dim),i.valueDataDim=e.mapDimension(i.valueAxis.dim)),i}function kA(t,e){return!(t&&t.containData&&e.coord&&!function(t){return!(isNaN(parseFloat(t.x))&&isNaN(parseFloat(t.y)))}(e))||t.containData(e.coord)}function AA(t,e,n,r){return r<2?t.coord&&t.coord[r]:t.value}function IA(t,e,n){if("average"!==n)return"median"===n?t.getMedian(e):t.getDataExtent(e,!0)["max"===n?1:0];var r=0,i=0;return t.each(e,function(t,e){isNaN(t)||(r+=t,i++)}),r/i}var DA=lh({type:"marker",init:function(){this.markerGroupMap=Q()},render:function(t,e,n){var r=this.markerGroupMap;r.each(function(t){t.__keep=!1});var i=this.type+"Model";e.eachSeries(function(t){var r=t[i];r&&this.renderSeries(t,r,e,n)},this),r.each(function(t){t.__keep||this.group.remove(t.group)},this)},renderSeries:function(){}});function OA(t,e,n){var r=e.coordinateSystem;t.each(function(i){var o,a=t.getItemModel(i),s=bl(a.get("x"),n.getWidth()),l=bl(a.get("y"),n.getHeight());if(isNaN(s)||isNaN(l)){if(e.getMarkerPosition)o=e.getMarkerPosition(t.getValues(t.dimensions,i));else if(r){var u=t.get(r.dimensions[0],i),c=t.get(r.dimensions[1],i);o=r.dataToPoint([u,c])}}else o=[s,l];isNaN(s)||(o[0]=s),isNaN(l)||(o[1]=l),t.setItemLayout(i,o)})}function PA(t,e,n,r){var i=t.getData(),o=r.type;if(!R(r)&&("min"===o||"max"===o||"average"===o||"median"===o||null!=r.xAxis||null!=r.yAxis)){var a,s;if(null!=r.yAxis||null!=r.xAxis)a=e.getAxis(null!=r.yAxis?"y":"x"),s=W(r.yAxis,r.xAxis);else{var l=TA(r,i,e,t);a=l.valueAxis,s=IA(i,Yh(i,l.valueDataDim),o)}var u="x"===a.dim?0:1,c=1-u,d=m(r),f={};d.type=null,d.coord=[],f.coord=[],d.coord[c]=-1/0,f.coord[c]=1/0;var h=n.get("precision");0<=h&&"number"==typeof s&&(s=+s.toFixed(Math.min(h,20))),d.coord[u]=f.coord[u]=s,r=[d,f,{type:o,valueIndex:r.valueIndex,value:s}]}return(r=[MA(t,r[0]),MA(t,r[1]),x({},r[2])])[2].type=r[2].type||"",v(r[2],r[0]),v(r[2],r[1]),r}function EA(t){return!isNaN(t)&&!isFinite(t)}function RA(t,e,n,r){var i=1-t,o=r.dimensions[t];return EA(e[i])&&EA(n[i])&&e[t]===n[t]&&r.getAxis(o).containData(e[t])}function LA(t,e){if("cartesian2d"===t.type){var n=e[0].coord,r=e[1].coord;if(n&&r&&(RA(1,n,r,t)||RA(0,n,r,t)))return!0}return kA(t,e[0])&&kA(t,e[1])}function NA(t,e,n,r,i){var o,a=r.coordinateSystem,s=t.getItemModel(e),l=bl(s.get("x"),i.getWidth()),u=bl(s.get("y"),i.getHeight());if(isNaN(l)||isNaN(u)){if(r.getMarkerPosition)o=r.getMarkerPosition(t.getValues(t.dimensions,e));else{var c=a.dimensions,d=t.get(c[0],e),f=t.get(c[1],e);o=a.dataToPoint([d,f])}if("cartesian2d"===a.type){var h=a.getAxis("x"),p=a.getAxis("y");EA(t.get((c=a.dimensions)[0],e))?o[0]=h.toGlobalCoord(h.getExtent()[n?0:1]):EA(t.get(c[1],e))&&(o[1]=p.toGlobalCoord(p.getExtent()[n?0:1]))}isNaN(l)||(o[0]=l),isNaN(u)||(o[1]=u)}else o=[l,u];t.setItemLayout(e,o)}function BA(t,e,n,r){var i=MA(t,r[0]),o=MA(t,r[1]),a=W,s=i.coord,l=o.coord;s[0]=a(s[0],-1/0),s[1]=a(s[1],-1/0),l[0]=a(l[0],1/0),l[1]=a(l[1],1/0);var u=y([{},i,o]);return u.coord=[i.coord,o.coord],u.x0=i.x,u.y0=i.y,u.x1=o.x,u.y1=o.y,u}function zA(t){return!isNaN(t)&&!isFinite(t)}function VA(t,e,n){var r=1-t;return zA(e[r])&&zA(n[r])}function FA(t,e){var n=e.coord[0],r=e.coord[1];return!("cartesian2d"!==t.type||!n||!r||!VA(1,n,r)&&!VA(0,n,r))||kA(t,{coord:n,x:e.x0,y:e.y0})||kA(t,{coord:r,x:e.x1,y:e.y1})}function HA(t,e,n,r,i){var o,a=r.coordinateSystem,s=t.getItemModel(e),l=bl(s.get(n[0]),i.getWidth()),u=bl(s.get(n[1]),i.getHeight());if(isNaN(l)||isNaN(u)){if(r.getMarkerPosition)o=r.getMarkerPosition(t.getValues(n,e));else{var c=[h=t.get(n[0],e),p=t.get(n[1],e)];a.clampData&&a.clampData(c,c),o=a.dataToPoint(c,!0)}if("cartesian2d"===a.type){var d=a.getAxis("x"),f=a.getAxis("y"),h=t.get(n[0],e),p=t.get(n[1],e);zA(h)?o[0]=d.toGlobalCoord(d.getExtent()["x0"===n[0]?0:1]):zA(p)&&(o[1]=f.toGlobalCoord(f.getExtent()["y0"===n[1]?0:1]))}isNaN(l)||(o[0]=l),isNaN(u)||(o[1]=u)}else o=[l,u];return o}DA.extend({type:"markPoint",updateTransform:function(t,e,n){e.eachSeries(function(t){var e=t.markPointModel;e&&(OA(e.getData(),t,n),this.markerGroupMap.get(t.id).updateLayout(e))},this)},renderSeries:function(t,e,n,r){var i=t.coordinateSystem,o=t.id,a=t.getData(),s=this.markerGroupMap,l=s.get(o)||s.set(o,new Pg),u=function(t,e,n){var r;r=t?A(t&&t.dimensions,function(t){return b({name:t},e.getData().getDimensionInfo(e.getData().mapDimension(t))||{})}):[{name:"value",type:"float"}];var i=new Ah(r,n),o=A(n.get("data"),E(MA,e));return t&&(o=D(o,E(kA,t))),i.initData(o,null,t?AA:function(t){return t.value}),i}(i,t,e);e.setData(u),OA(e.getData(),t,r),u.each(function(t){var n=u.getItemModel(t),r=n.getShallow("symbol"),i=n.getShallow("symbolSize"),o=n.getShallow("symbolRotate"),s=L(r),l=L(i),c=L(o);if(s||l||c){var d=e.getRawValue(t),f=e.getDataParams(t);s&&(r=r(d,f)),l&&(i=i(d,f)),c&&(o=o(d,f))}u.setItemVisual(t,{symbol:r,symbolSize:i,symbolRotate:o,color:n.get("itemStyle.color")||a.getVisual("color")})}),l.updateData(u),this.group.add(l.group),u.eachItemGraphicEl(function(t){t.traverse(function(t){t.dataModel=e})}),l.__keep=!0,l.group.silent=e.get("silent")||t.get("silent")}}),Qf(function(t){t.markPoint=t.markPoint||{}}),bA.extend({type:"markLine",defaultOption:{zlevel:0,z:5,symbol:["circle","arrow"],symbolSize:[8,16],precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end",distance:5},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"}}),DA.extend({type:"markLine",updateTransform:function(t,e,n){e.eachSeries(function(t){var e=t.markLineModel;if(e){var r=e.getData(),i=e.__from,o=e.__to;i.each(function(e){NA(i,e,!0,t,n),NA(o,e,!1,t,n)}),r.each(function(t){r.setItemLayout(t,[i.getItemLayout(t),o.getItemLayout(t)])}),this.markerGroupMap.get(t.id).updateLayout()}},this)},renderSeries:function(t,e,n,r){var i=t.coordinateSystem,o=t.id,a=t.getData(),s=this.markerGroupMap,l=s.get(o)||s.set(o,new Fb);this.group.add(l.group);var u=function(t,e,n){var r;r=t?A(t&&t.dimensions,function(t){return b({name:t},e.getData().getDimensionInfo(e.getData().mapDimension(t))||{})}):[{name:"value",type:"float"}];var i=new Ah(r,n),o=new Ah(r,n),a=new Ah([],n),s=A(n.get("data"),E(PA,e,t,n));t&&(s=D(s,E(LA,t)));var l=t?AA:function(t){return t.value};return i.initData(A(s,function(t){return t[0]}),null,l),o.initData(A(s,function(t){return t[1]}),null,l),a.initData(A(s,function(t){return t[2]})),a.hasItemOption=!0,{from:i,to:o,line:a}}(i,t,e),c=u.from,d=u.to,f=u.line;e.__from=c,e.__to=d,e.setData(f);var h=e.get("symbol"),p=e.get("symbolSize");function g(e,n,i){var o=e.getItemModel(n);NA(e,n,i,t,r),e.setItemVisual(n,{symbolRotate:o.get("symbolRotate"),symbolSize:o.get("symbolSize")||p[i?0:1],symbol:o.get("symbol",!0)||h[i?0:1],color:o.get("itemStyle.color")||a.getVisual("color")})}R(h)||(h=[h,h]),"number"==typeof p&&(p=[p,p]),u.from.each(function(t){g(c,t,!0),g(d,t,!1)}),f.each(function(t){var e=f.getItemModel(t).get("lineStyle.color");f.setItemVisual(t,{color:e||c.getItemVisual(t,"color")}),f.setItemLayout(t,[c.getItemLayout(t),d.getItemLayout(t)]),f.setItemVisual(t,{fromSymbolRotate:c.getItemVisual(t,"symbolRotate"),fromSymbolSize:c.getItemVisual(t,"symbolSize"),fromSymbol:c.getItemVisual(t,"symbol"),toSymbolRotate:d.getItemVisual(t,"symbolRotate"),toSymbolSize:d.getItemVisual(t,"symbolSize"),toSymbol:d.getItemVisual(t,"symbol")})}),l.updateData(f),u.line.eachItemGraphicEl(function(t,n){t.traverse(function(t){t.dataModel=e})}),l.__keep=!0,l.group.silent=e.get("silent")||t.get("silent")}}),Qf(function(t){t.markLine=t.markLine||{}}),bA.extend({type:"markArea",defaultOption:{zlevel:0,z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}}});var WA=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]];DA.extend({type:"markArea",updateTransform:function(t,e,n){e.eachSeries(function(t){var e=t.markAreaModel;if(e){var r=e.getData();r.each(function(e){var i=A(WA,function(i){return HA(r,e,i,t,n)});r.setItemLayout(e,i),r.getItemGraphicEl(e).setShape("points",i)})}},this)},renderSeries:function(t,e,n,r){var i=t.coordinateSystem,o=t.id,a=t.getData(),s=this.markerGroupMap,l=s.get(o)||s.set(o,{group:new Cn});this.group.add(l.group),l.__keep=!0;var u=function(t,e,n){var r,i;i=t?(r=A(t&&t.dimensions,function(t){var n=e.getData();return b({name:t},n.getDimensionInfo(n.mapDimension(t))||{})}),new Ah(A(["x0","y0","x1","y1"],function(t,e){return{name:t,type:r[e%2].type}}),n)):new Ah(r=[{name:"value",type:"float"}],n);var o=A(n.get("data"),E(BA,e,t,n));return t&&(o=D(o,E(FA,t))),i.initData(o,null,t?function(t,e,n,r){return t.coord[Math.floor(r/2)][r%2]}:function(t){return t.value}),i.hasItemOption=!0,i}(i,t,e);e.setData(u),u.each(function(e){var n=A(WA,function(n){return HA(u,e,n,t,r)}),o=!0;k(WA,function(t){if(o){var n=u.get(t[0],e),r=u.get(t[1],e);(zA(n)||i.getAxis("x").containData(n))&&(zA(r)||i.getAxis("y").containData(r))&&(o=!1)}}),u.setItemLayout(e,{points:n,allClipped:o}),u.setItemVisual(e,{color:a.getVisual("color")})}),u.diff(l.__data).add(function(t){var e=u.getItemLayout(t);if(!e.allClipped){var n=new za({shape:{points:e.points}});u.setItemGraphicEl(t,n),l.group.add(n)}}).update(function(t,n){var r=l.__data.getItemGraphicEl(n),i=u.getItemLayout(t);i.allClipped?r&&l.group.remove(r):(r?$s(r,{shape:{points:i.points}},e,t):r=new za({shape:{points:i.points}}),u.setItemGraphicEl(t,r),l.group.add(r))}).remove(function(t){var e=l.__data.getItemGraphicEl(t);l.group.remove(e)}).execute(),u.eachItemGraphicEl(function(t,n){var r=u.getItemModel(n),i=r.getModel("label"),o=r.getModel("emphasis.label"),a=u.getItemVisual(n,"color");t.useStyle(b(r.getModel("itemStyle").getItemStyle(),{fill:qe(a,.4),stroke:a})),t.hoverStyle=r.getModel("emphasis.itemStyle").getItemStyle(),Vs(t.style,t.hoverStyle,i,o,{labelFetcher:e,labelDataIndex:n,defaultText:u.getName(n)||"",isRectText:!0,autoColor:a}),Ls(t,{}),t.dataModel=e}),l.__data=u,l.group.silent=e.get("silent")||t.get("silent")}}),Qf(function(t){t.markArea=t.markArea||{}});var jA=md.legend.selector,GA={all:{type:"all",title:m(jA.all)},inverse:{type:"inverse",title:m(jA.inverse)}},UA=sh({type:"legend.plain",dependencies:["series"],layoutMode:{type:"box",ignoreSize:!0},init:function(t,e,n){this.mergeDefaultAndTheme(t,n),t.selected=t.selected||{},this._updateSelector(t)},mergeOption:function(t){UA.superCall(this,"mergeOption",t),this._updateSelector(t)},_updateSelector:function(t){var e=t.selector;!0===e&&(e=t.selector=["all","inverse"]),R(e)&&k(e,function(t,n){N(t)&&(t={type:t}),e[n]=v(t,GA[t.type])})},optionUpdated:function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&"single"===this.get("selectedMode")){for(var e=!1,n=0;n<t.length;n++){var r=t[n].get("name");if(this.isSelected(r)){this.select(r),e=!0;break}}e||this.select(t[0].get("name"))}},_updateData:function(t){var e=[],n=[];t.eachRawSeries(function(r){var i;if(n.push(r.name),r.legendVisualProvider){var o=r.legendVisualProvider.getAllNames();t.isSeriesFiltered(r)||(n=n.concat(o)),o.length?e=e.concat(o):i=!0}else i=!0;i&&Pi(r)&&e.push(r.name)}),this._availableNames=n;var r=A(this.get("data")||e,function(t){return"string"!=typeof t&&"number"!=typeof t||(t={name:t}),new hl(t,this,this.ecModel)},this);this._data=r},getData:function(){return this._data},select:function(t){var e=this.option.selected;"single"===this.get("selectedMode")&&k(this._data,function(t){e[t.get("name")]=!1}),e[t]=!0},unSelect:function(t){"single"!==this.get("selectedMode")&&(this.option.selected[t]=!1)},toggleSelected:function(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t)},allSelect:function(){var t=this.option.selected;k(this._data,function(e){t[e.get("name",!0)]=!0})},inverseSelect:function(){var t=this.option.selected;k(this._data,function(e){var n=e.get("name",!0);t.hasOwnProperty(n)||(t[n]=!0),t[n]=!t[n]})},isSelected:function(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&0<=S(this._availableNames,t)},getOrient:function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},defaultOption:{zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",itemStyle:{borderWidth:0},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:" sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}}});function qA(t,e,n){var r,i={},o="toggleSelected"===t;return n.eachComponent("legend",function(n){o&&null!=r?n[r?"select":"unSelect"](e.name):"allSelect"===t||"inverseSelect"===t?n[t]():(n[t](e.name),r=n.isSelected(e.name)),k(n.getData(),function(t){var e=t.get("name");if("\n"!==e&&""!==e){var r=n.isSelected(e);i[e]=i.hasOwnProperty(e)?i[e]&&r:r}})}),"allSelect"===t||"inverseSelect"===t?{selected:i}:{name:e.name,selected:i}}eh("legendToggleSelect","legendselectchanged",E(qA,"toggleSelected")),eh("legendAllSelect","legendselectall",E(qA,"allSelect")),eh("legendInverseSelect","legendinverseselect",E(qA,"inverseSelect")),eh("legendSelect","legendselected",E(qA,"select")),eh("legendUnSelect","legendunselected",E(qA,"unSelect"));var XA=E,YA=k,$A=Cn,ZA=lh({type:"legend.plain",newlineDisabled:!1,init:function(){this.group.add(this._contentGroup=new $A),this.group.add(this._selectorGroup=new $A),this._isFirstRender=!0},getContentGroup:function(){return this._contentGroup},getSelectorGroup:function(){return this._selectorGroup},render:function(t,e,n){var r=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),t.get("show",!0)){var i=t.get("align"),o=t.get("orient");i&&"auto"!==i||(i="right"===t.get("left")&&"vertical"===o?"right":"left");var a=t.get("selector",!0),s=t.get("selectorPosition",!0);!a||s&&"auto"!==s||(s="horizontal"===o?"end":"start"),this.renderInner(i,t,e,n,a,o,s);var l=t.getBoxLayoutParams(),u={width:n.getWidth(),height:n.getHeight()},c=t.get("padding"),d=au(l,u,c),f=this.layoutInner(t,i,d,r,a,s),h=au(b({width:f.width,height:f.height},l),u,c);this.group.attr("position",[h.x-f.x,h.y-f.y]),this.group.add(this._backgroundEl=_T(f,t))}},resetInner:function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},renderInner:function(t,e,n,r,i,o,a){var s=this.getContentGroup(),l=Q(),u=e.get("selectedMode"),c=[];n.eachRawSeries(function(t){t.get("legendHoverLink")||c.push(t.id)}),YA(e.getData(),function(i,o){var a=i.get("name");if(this.newlineDisabled||""!==a&&"\n"!==a){var d=n.getSeriesByName(a)[0];if(!l.get(a))if(d){var f=d.getData(),h=f.getVisual("color"),p=f.getVisual("borderColor");"function"==typeof h&&(h=h(d.getDataParams(0))),"function"==typeof p&&(p=p(d.getDataParams(0)));var g=f.getVisual("legendSymbol")||"roundRect",m=f.getVisual("symbol");this._createItem(a,o,i,e,g,m,t,h,p,u).on("click",XA(JA,a,null,r,c)).on("mouseover",XA(QA,d.name,null,r,c)).on("mouseout",XA(tI,d.name,null,r,c)),l.set(a,!0)}else n.eachRawSeries(function(n){if(!l.get(a)&&n.legendVisualProvider){var s=n.legendVisualProvider;if(!s.containName(a))return;var d=s.indexOfName(a),f=s.getItemVisual(d,"color"),h=s.getItemVisual(d,"borderColor");this._createItem(a,o,i,e,"roundRect",null,t,f,h,u).on("click",XA(JA,null,a,r,c)).on("mouseover",XA(QA,null,a,r,c)).on("mouseout",XA(tI,null,a,r,c)),l.set(a,!0)}},this)}else s.add(new $A({newline:!0}))},this),i&&this._createSelector(i,e,r,o,a)},_createSelector:function(t,e,n,r,i){var o=this.getSelectorGroup();YA(t,function(t){!function(t){var r=t.type,i=new Da({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){n.dispatchAction({type:"all"===r?"legendAllSelect":"legendInverseSelect"})}});o.add(i);var a=e.getModel("selectorLabel"),s=e.getModel("emphasis.selectorLabel");Vs(i.style,i.hoverStyle={},a,s,{defaultText:t.title,isRectText:!1}),Ls(i)}(t)})},_createItem:function(t,e,n,r,i,o,a,s,l,u){var c=r.get("itemWidth"),d=r.get("itemHeight"),f=r.get("inactiveColor"),h=r.get("inactiveBorderColor"),p=r.get("symbolKeepAspect"),g=r.getModel("itemStyle"),m=r.isSelected(t),v=new $A,y=n.getModel("textStyle"),b=n.get("icon"),_=n.getModel("tooltip"),w=_.parentModel,S=eg(i=b||i,0,0,c,d,m?s:f,null==p||p);if(v.add(KA(S,i,g,l,h,m)),!b&&o&&(o!==i||"none"===o)){var C=.8*d;"none"===o&&(o="circle");var M=eg(o,(c-C)/2,(d-C)/2,C,C,m?s:f,null==p||p);v.add(KA(M,o,g,l,h,m))}var T="left"===a?c+5:-5,k=a,A=r.get("formatter"),I=t;"string"==typeof A&&A?I=A.replace("{name}",null!=t?t:""):"function"==typeof A&&(I=A(t)),v.add(new Da({style:Hs({},y,{text:I,x:T,y:d/2,textFill:m?y.getTextColor():f,textAlign:k,textVerticalAlign:"middle"})}));var D=new Ua({shape:v.getBoundingRect(),invisible:!0,tooltip:_.get("show")?x({content:t,formatter:w.get("formatter",!0)||function(){return t},formatterParams:{componentType:"legend",legendIndex:r.componentIndex,name:t,$vars:["name"]}},_.option):null});return v.add(D),v.eachChild(function(t){t.silent=!0}),D.silent=!u,this.getContentGroup().add(v),Ls(v),v.__legendDataIndex=e,v},layoutInner:function(t,e,n,r,i,o){var a=this.getContentGroup(),s=this.getSelectorGroup();ou(t.get("orient"),a,t.get("itemGap"),n.width,n.height);var l=a.getBoundingRect(),u=[-l.x,-l.y];if(i){ou("horizontal",s,t.get("selectorItemGap",!0));var c=s.getBoundingRect(),d=[-c.x,-c.y],f=t.get("selectorButtonGap",!0),h=t.getOrient().index,p=0===h?"width":"height",g=0===h?"height":"width",m=0===h?"y":"x";"end"===o?d[h]+=l[p]+f:u[h]+=c[p]+f,d[1-h]+=l[g]/2-c[g]/2,s.attr("position",d),a.attr("position",u);var v={x:0,y:0};return v[p]=l[p]+f+c[p],v[g]=Math.max(l[g],c[g]),v[m]=Math.min(0,c[m]+d[1-h]),v}return a.attr("position",u),this.group.getBoundingRect()},remove:function(){this.getContentGroup().removeAll(),this._isFirstRender=!0}});function KA(t,e,n,r,i,o){var a;return"line"!==e&&e.indexOf("empty")<0?(a=n.getItemStyle(),t.style.stroke=r,o||(a.stroke=i)):a=n.getItemStyle(["borderWidth","borderColor"]),t.setStyle(a)}function JA(t,e,n,r){tI(t,e,n,r),n.dispatchAction({type:"legendToggleSelect",name:null!=t?t:e}),QA(t,e,n,r)}function QA(t,e,n,r){var i=n.getZr().storage.getDisplayList()[0];i&&i.useHoverLayer||n.dispatchAction({type:"highlight",seriesName:t,name:e,excludeSeriesId:r})}function tI(t,e,n,r){var i=n.getZr().storage.getDisplayList()[0];i&&i.useHoverLayer||n.dispatchAction({type:"downplay",seriesName:t,name:e,excludeSeriesId:r})}th(ff.PROCESSOR.SERIES_FILTER,function(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.filterSeries(function(t){for(var n=0;n<e.length;n++)if(!e[n].isSelected(t.name))return!1;return!0})}),gu.registerSubTypeDefaulter("legend",function(){return"plain"});var eI=UA.extend({type:"legend.scroll",setScrollDataIndex:function(t){this.option.scrollDataIndex=t},defaultOption:{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800},init:function(t,e,n,r){var i=uu(t);eI.superCall(this,"init",t,e,n,r),nI(this,t,i)},mergeOption:function(t,e){eI.superCall(this,"mergeOption",t,e),nI(this,this.option,t)}});function nI(t,e,n){var r=[1,1];r[t.getOrient().index]=0,lu(e,n,{type:"box",ignoreSize:r})}var rI=Cn,iI=["width","height"],oI=["x","y"],aI=ZA.extend({type:"legend.scroll",newlineDisabled:!0,init:function(){aI.superCall(this,"init"),this._currentIndex=0,this.group.add(this._containerGroup=new rI),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new rI)},resetInner:function(){aI.superCall(this,"resetInner"),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},renderInner:function(t,e,n,r,i,o,a){var s=this;aI.superCall(this,"renderInner",t,e,n,r,i,o,a);var l=this._controllerGroup,u=e.get("pageIconSize",!0);R(u)||(u=[u,u]),d("pagePrev",0);var c=e.getModel("pageTextStyle");function d(t,n){var i=t+"DataIndex",o=nl(e.get("pageIcons",!0)[e.getOrient().name][n],{onclick:P(s._pageGo,s,i,e,r)},{x:-u[0]/2,y:-u[1]/2,width:u[0],height:u[1]});o.name=t,l.add(o)}l.add(new Da({name:"pageText",style:{textFill:c.getTextColor(),font:c.getFont(),textVerticalAlign:"middle",textAlign:"center"},silent:!0})),d("pageNext",1)},layoutInner:function(t,e,n,r,i,o){var a=this.getSelectorGroup(),s=t.getOrient().index,l=iI[s],u=oI[s],c=iI[1-s],d=oI[1-s];i&&ou("horizontal",a,t.get("selectorItemGap",!0));var f=t.get("selectorButtonGap",!0),h=a.getBoundingRect(),p=[-h.x,-h.y],g=m(n);i&&(g[l]=n[l]-h[l]-f);var v=this._layoutContentAndController(t,r,g,s,l,c,d);if(i){if("end"===o)p[s]+=v[l]+f;else{var y=h[l]+f;p[s]-=y,v[u]-=y}v[l]+=h[l]+f,p[1-s]+=v[d]+v[c]/2-h[c]/2,v[c]=Math.max(v[c],h[c]),v[d]=Math.min(v[d],h[d]+p[1-s]),a.attr("position",p)}return v},_layoutContentAndController:function(t,e,n,r,i,o,a){var s=this.getContentGroup(),l=this._containerGroup,u=this._controllerGroup;ou(t.get("orient"),s,t.get("itemGap"),r?n.width:null,r?null:n.height),ou("horizontal",u,t.get("pageButtonItemGap",!0));var c=s.getBoundingRect(),d=u.getBoundingRect(),f=this._showController=c[i]>n[i],h=[-c.x,-c.y];e||(h[r]=s.position[r]);var p=[0,0],g=[-d.x,-d.y],m=j(t.get("pageButtonGap",!0),t.get("itemGap",!0));f&&("end"===t.get("pageButtonPosition",!0)?g[r]+=n[i]-d[i]:p[r]+=d[i]+m),g[1-r]+=c[o]/2-d[o]/2,s.attr("position",h),l.attr("position",p),u.attr("position",g);var v={x:0,y:0};if(v[i]=f?n[i]:c[i],v[o]=Math.max(c[o],d[o]),v[a]=Math.min(0,d[a]+g[1-r]),l.__rectSize=n[i],f){var y={x:0,y:0};y[i]=Math.max(n[i]-d[i]-m,0),y[o]=v[o],l.setClipPath(new Ua({shape:y})),l.__rectSize=y[i]}else u.eachChild(function(t){t.attr({invisible:!0,silent:!0})});var x=this._getPageInfo(t);return null!=x.pageIndex&&$s(s,{position:x.contentPosition},f&&t),this._updatePageInfoView(t,x),v},_pageGo:function(t,e,n){var r=this._getPageInfo(e)[t];null!=r&&n.dispatchAction({type:"legendScroll",scrollDataIndex:r,legendId:e.id})},_updatePageInfoView:function(t,e){var n=this._controllerGroup;k(["pagePrev","pageNext"],function(r){var i=null!=e[r+"DataIndex"],o=n.childOfName(r);o&&(o.setStyle("fill",t.get(i?"pageIconColor":"pageIconInactiveColor",!0)),o.cursor=i?"pointer":"default")});var r=n.childOfName("pageText"),i=t.get("pageFormatter"),o=e.pageIndex,a=null!=o?o+1:0,s=e.pageCount;r&&i&&r.setStyle("text",N(i)?i.replace("{current}",a).replace("{total}",s):i({current:a,total:s}))},_getPageInfo:function(t){var e=t.get("scrollDataIndex",!0),n=this.getContentGroup(),r=this._containerGroup.__rectSize,i=t.getOrient().index,o=iI[i],a=oI[i],s=this._findTargetItemIndex(e),l=n.children(),u=l[s],c=l.length,d=c?1:0,f={contentPosition:n.position.slice(),pageCount:d,pageIndex:d-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!u)return f;var h=y(u);f.contentPosition[i]=-h.s;for(var p=s+1,g=h,m=h,v=null;p<=c;++p)(!(v=y(l[p]))&&m.e>g.s+r||v&&!x(v,g.s))&&(g=m.i>g.i?m:v)&&(null==f.pageNextDataIndex&&(f.pageNextDataIndex=g.i),++f.pageCount),m=v;for(p=s-1,g=h,m=h,v=null;-1<=p;--p)(v=y(l[p]))&&x(m,v.s)||!(g.i<m.i)||(m=g,null==f.pagePrevDataIndex&&(f.pagePrevDataIndex=g.i),++f.pageCount,++f.pageIndex),g=v;return f;function y(t){if(t){var e=t.getBoundingRect(),n=e[a]+t.position[i];return{s:n,e:n+e[o],i:t.__legendDataIndex}}}function x(t,e){return t.e>=e&&t.s<=e+r}},_findTargetItemIndex:function(t){return this._showController?(this.getContentGroup().eachChild(function(r,i){var o=r.__legendDataIndex;null==n&&null!=o&&(n=i),o===t&&(e=i)}),null!=e?e:n):0;var e,n}});eh("legendScroll","legendscroll",function(t,e){var n=t.scrollDataIndex;null!=n&&e.eachComponent({mainType:"legend",subType:"scroll",query:t},function(t){t.setScrollDataIndex(n)})}),pk.extend({type:"dataZoom.slider",layoutMode:"box",defaultOption:{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#2f4554",width:.5,opacity:.3},areaStyle:{color:"rgba(47,69,84,0.3)",opacity:.3}},borderColor:"#ddd",fillerColor:"rgba(167,183,204,0.4)",handleIcon:"M8.2,13.6V3.9H6.3v9.7H3.1v14.9h3.3v9.7h1.8v-9.7h3.3V13.6H8.2z M9.7,24.4H4.8v-1.4h4.9V24.4z M9.7,19.1H4.8v-1.4h4.9V19.1z",handleSize:"100%",handleStyle:{color:"#a7b7cc"},labelPrecision:null,labelFormatter:null,showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#333"}}});var sI=Ua,lI=xl,uI=wl,cI=P,dI=k,fI="horizontal",hI="vertical",pI=["line","bar","candlestick","scatter"],gI=vk.extend({type:"dataZoom.slider",init:function(t,e){this._displayables={},this.api=e},render:function(t,e,n,r){gI.superApply(this,"render",arguments),hd(this,"_dispatchZoomAction",this.dataZoomModel.get("throttle"),"fixRate"),this._orient=t.get("orient"),!1!==this.dataZoomModel.get("show")?(r&&"dataZoom"===r.type&&r.from===this.uid||this._buildView(),this._updateView()):this.group.removeAll()},remove:function(){gI.superApply(this,"remove",arguments),pd(this,"_dispatchZoomAction")},dispose:function(){gI.superApply(this,"dispose",arguments),pd(this,"_dispatchZoomAction")},_buildView:function(){var t=this.group;t.removeAll(),this._resetLocation(),this._resetInterval();var e=this._displayables.barGroup=new Cn;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),t.add(e),this._positionGroup()},_resetLocation:function(){var t=this.dataZoomModel,e=this.api,n=this._findCoordRect(),r={width:e.getWidth(),height:e.getHeight()},i=this._orient===fI?{right:r.width-n.x-n.width,top:r.height-30-7,width:n.width,height:30}:{right:7,top:n.y,width:30,height:n.height},o=uu(t.option);k(["right","top","width","height"],function(t){"ph"===o[t]&&(o[t]=i[t])});var a=au(o,r,t.padding);this._location={x:a.x,y:a.y},this._size=[a.width,a.height],this._orient===hI&&this._size.reverse()},_positionGroup:function(){var t=this.group,e=this._location,n=this._orient,r=this.dataZoomModel.getFirstTargetAxisModel(),i=r&&r.get("inverse"),o=this._displayables.barGroup,a=(this._dataShadowInfo||{}).otherAxisInverse;o.attr(n!==fI||i?n===fI&&i?{scale:a?[-1,1]:[-1,-1]}:n!==hI||i?{scale:a?[-1,-1]:[-1,1],rotation:Math.PI/2}:{scale:a?[1,-1]:[1,1],rotation:Math.PI/2}:{scale:a?[1,1]:[1,-1]});var s=t.getBoundingRect([o]);t.attr("position",[e.x-s.x,e.y-s.y])},_getViewExtent:function(){return[0,this._size[0]]},_renderBackground:function(){var t=this._size,e=this._displayables.barGroup;e.add(new sI({silent:!0,shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:this.dataZoomModel.get("backgroundColor")},z2:-40})),e.add(new sI({shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:"transparent"},z2:0,onclick:P(this._onClickPanelClick,this)}))},_renderDataShadow:function(){var t=this._dataShadowInfo=this._prepareDataShadowInfo();if(t){var e=this._size,n=t.series,r=n.getRawData(),i=n.getShadowDim?n.getShadowDim():t.otherDim;if(null!=i){var o=r.getDataExtent(i),a=.3*(o[1]-o[0]);o=[o[0]-a,o[1]+a];var s,l=[0,e[1]],u=[[e[0],0],[0,0]],c=[],d=e[0]/(r.count()-1),f=0,h=Math.round(r.count()/e[0]);r.each([i],function(t,e){if(0<h&&e%h)f+=d;else{var n=null==t||isNaN(t)||""===t,r=n?0:lI(t,o,l,!0);n&&!s&&e?(u.push([u[u.length-1][0],0]),c.push([c[c.length-1][0],0])):!n&&s&&(u.push([f,0]),c.push([f,0])),u.push([f,r]),c.push([f,r]),f+=d,s=n}});var p=this.dataZoomModel;this._displayables.barGroup.add(new za({shape:{points:u},style:b({fill:p.get("dataBackgroundColor")},p.getModel("dataBackground.areaStyle").getAreaStyle()),silent:!0,z2:-20})),this._displayables.barGroup.add(new Va({shape:{points:c},style:p.getModel("dataBackground.lineStyle").getLineStyle(),silent:!0,z2:-19}))}}},_prepareDataShadowInfo:function(){var t=this.dataZoomModel,e=t.get("showDataShadow");if(!1!==e){var n,r=this.ecModel;return t.eachTargetAxis(function(i,o){k(t.getAxisProxy(i.name,o).getTargetSeriesModels(),function(t){if(!(n||!0!==e&&S(pI,t.get("type"))<0)){var a,s=r.getComponent(i.axis,o).axis,l=function(t){return{x:"y",y:"x",radius:"angle",angle:"radius"}[t]}(i.name),u=t.coordinateSystem;null!=l&&u.getOtherAxis&&(a=u.getOtherAxis(s).inverse),l=t.getData().mapDimension(l),n={thisAxis:s,series:t,thisDim:i.name,otherDim:l,otherAxisInverse:a}}},this)},this),n}},_renderHandle:function(){var t=this._displayables,e=t.handles=[],n=t.handleLabels=[],r=this._displayables.barGroup,i=this._size,o=this.dataZoomModel;r.add(t.filler=new sI({draggable:!0,cursor:mI(this._orient),drift:cI(this._onDragMove,this,"all"),ondragstart:cI(this._showDataInfo,this,!0),ondragend:cI(this._onDragEnd,this),onmouseover:cI(this._showDataInfo,this,!0),onmouseout:cI(this._showDataInfo,this,!1),style:{fill:o.get("fillerColor"),textPosition:"inside"}})),r.add(new sI({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:i[0],height:i[1]},style:{stroke:o.get("dataBackgroundColor")||o.get("borderColor"),lineWidth:1,fill:"rgba(0,0,0,0)"}})),dI([0,1],function(t){var i=nl(o.get("handleIcon"),{cursor:mI(this._orient),draggable:!0,drift:cI(this._onDragMove,this,t),ondragend:cI(this._onDragEnd,this),onmouseover:cI(this._showDataInfo,this,!0),onmouseout:cI(this._showDataInfo,this,!1)},{x:-1,y:0,width:2,height:2}),a=i.getBoundingRect();this._handleHeight=bl(o.get("handleSize"),this._size[1]),this._handleWidth=a.width/a.height*this._handleHeight,i.setStyle(o.getModel("handleStyle").getItemStyle());var s=o.get("handleColor");null!=s&&(i.style.fill=s),r.add(e[t]=i);var l=o.textStyleModel;this.group.add(n[t]=new Da({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textVerticalAlign:"middle",textAlign:"center",textFill:l.getTextColor(),textFont:l.getFont()},z2:10}))},this)},_resetInterval:function(){var t=this._range=this.dataZoomModel.getPercentRange(),e=this._getViewExtent();this._handleEnds=[lI(t[0],[0,100],e,!0),lI(t[1],[0,100],e,!0)]},_updateInterval:function(t,e){var n=this.dataZoomModel,r=this._handleEnds,i=this._getViewExtent(),o=n.findRepresentativeAxisProxy().getMinMaxSpan(),a=[0,100];C_(e,r,i,n.get("zoomLock")?"all":t,null!=o.minSpan?lI(o.minSpan,a,i,!0):null,null!=o.maxSpan?lI(o.maxSpan,a,i,!0):null);var s=this._range,l=this._range=uI([lI(r[0],i,a,!0),lI(r[1],i,a,!0)]);return!s||s[0]!==l[0]||s[1]!==l[1]},_updateView:function(t){var e=this._displayables,n=this._handleEnds,r=uI(n.slice()),i=this._size;dI([0,1],function(t){var r=this._handleHeight;e.handles[t].attr({scale:[r/2,r/2],position:[n[t],i[1]/2-r/2]})},this),e.filler.setShape({x:r[0],y:0,width:r[1]-r[0],height:i[1]}),this._updateDataInfo(t)},_updateDataInfo:function(t){var e=this.dataZoomModel,n=this._displayables,r=n.handleLabels,i=this._orient,o=["",""];if(e.get("showDetail")){var a=e.findRepresentativeAxisProxy();if(a){var s=a.getAxisModel().axis,l=this._range,u=t?a.calculateDataWindow({start:l[0],end:l[1]}).valueWindow:a.getDataValueWindow();o=[this._formatLabel(u[0],s),this._formatLabel(u[1],s)]}}var c=uI(this._handleEnds.slice());function d(t){var e=Ks(n.handles[t].parent,this.group),a=Qs(0===t?"right":"left",e),s=this._handleWidth/2+5,l=Js([c[t]+(0===t?-s:s),this._size[1]/2],e);r[t].setStyle({x:l[0],y:l[1],textVerticalAlign:i===fI?"middle":a,textAlign:i===fI?a:"center",text:o[t]})}d.call(this,0),d.call(this,1)},_formatLabel:function(t,e){var n=this.dataZoomModel,r=n.get("labelFormatter"),i=n.get("labelPrecision");null!=i&&"auto"!==i||(i=e.getPixelPrecision());var o=null==t||isNaN(t)?"":"category"===e.type||"time"===e.type?e.scale.getLabel(Math.round(t)):t.toFixed(Math.min(i,20));return L(r)?r(t,o):N(r)?r.replace("{value}",o):o},_showDataInfo:function(t){var e=this._displayables.handleLabels;e[0].attr("invisible",!(t=this._dragging||t)),e[1].attr("invisible",!t)},_onDragMove:function(t,e,n,r){this._dragging=!0,Gt(r.event);var i=Js([e,n],this._displayables.barGroup.getLocalTransform(),!0),o=this._updateInterval(t,i[0]),a=this.dataZoomModel.get("realtime");this._updateView(!a),o&&a&&this._dispatchZoomAction()},_onDragEnd:function(){this._dragging=!1,this._showDataInfo(!1),this.dataZoomModel.get("realtime")||this._dispatchZoomAction()},_onClickPanelClick:function(t){var e=this._size,n=this._displayables.barGroup.transformCoordToLocal(t.offsetX,t.offsetY);if(!(n[0]<0||n[0]>e[0]||n[1]<0||n[1]>e[1])){var r=this._handleEnds,i=this._updateInterval("all",n[0]-(r[0]+r[1])/2);this._updateView(),i&&this._dispatchZoomAction()}},_dispatchZoomAction:function(){var t=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,start:t[0],end:t[1]})},_findCoordRect:function(){var t;if(dI(this.getTargetCoordInfo(),function(e){if(!t&&e.length){var n=e[0].model.coordinateSystem;t=n.getRect&&n.getRect()}}),!t){var e=this.api.getWidth(),n=this.api.getHeight();t={x:.2*e,y:.2*n,width:.6*e,height:.6*n}}return t}});function mI(t){return"vertical"===t?"ns-resize":"ew-resize"}pk.extend({type:"dataZoom.inside",defaultOption:{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}});var vI="\0_ec_dataZoom_roams";function yI(t,e){var n=bI(t),r=e.dataZoomId,i=e.coordId;k(n,function(t,n){var o=t.dataZoomInfos;o[r]&&S(e.allCoordIds,i)<0&&(delete o[r],t.count--)}),_I(n);var o=n[i];o||((o=n[i]={coordId:i,dataZoomInfos:{},count:0}).controller=function(t,e){var n=new fy(t.getZr());return k(["pan","zoom","scrollMove"],function(t){n.on(t,function(n){var r=[];k(e.dataZoomInfos,function(i){if(n.isAvailableBehavior(i.dataZoomModel.option)){var o=(i.getRange||{})[t],a=o&&o(e.controller,n);!i.dataZoomModel.get("disabled",!0)&&a&&r.push({dataZoomId:i.dataZoomId,start:a[0],end:a[1]})}}),r.length&&e.dispatchAction(r)})}),n}(t,o),o.dispatchAction=E(wI,t)),o.dataZoomInfos[r]||o.count++,o.dataZoomInfos[r]=e;var a=function(t){var e,n={type_true:2,type_move:1,type_false:0,type_undefined:-1},r=!0;return k(t,function(t){var i=t.dataZoomModel,o=!i.get("disabled",!0)&&(!i.get("zoomLock",!0)||"move");n["type_"+e]<n["type_"+o]&&(e=o),r&=i.get("preventDefaultMouseMove",!0)}),{controlType:e,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!r}}}(o.dataZoomInfos);o.controller.enable(a.controlType,a.opt),o.controller.setPointerChecker(e.containsPoint),hd(o,"dispatchAction",e.dataZoomModel.get("throttle",!0),"fixRate")}function xI(t){return t.type+"\0_"+t.id}function bI(t){var e=t.getZr();return e[vI]||(e[vI]={})}function _I(t){k(t,function(e,n){e.count||(e.controller.dispose(),delete t[n])})}function wI(t,e){t.dispatchAction({type:"dataZoom",batch:e})}var SI=P,CI=vk.extend({type:"dataZoom.inside",init:function(t,e){},render:function(t,e,n,r){CI.superApply(this,"render",arguments),this._range=t.getPercentRange(),k(this.getTargetCoordInfo(),function(e,r){var i=A(e,function(t){return xI(t.model)});k(e,function(e){var o=e.model,a={};k(["pan","zoom","scrollMove"],function(t){a[t]=SI(MI[t],this,e,r)},this),yI(n,{coordId:xI(o),allCoordIds:i,containsPoint:function(t,e,n){return o.coordinateSystem.containPoint([e,n])},dataZoomId:t.id,dataZoomModel:t,getRange:a})},this)},this)},dispose:function(){!function(t,e){var n=bI(t);k(n,function(t){t.controller.dispose();var n=t.dataZoomInfos;n[e]&&(delete n[e],t.count--)}),_I(n)}(this.api,this.dataZoomModel.id),CI.superApply(this,"dispose",arguments),this._range=null}}),MI={zoom:function(t,e,n,r){var i=this._range,o=i.slice(),a=t.axisModels[0];if(a){var s=AI[e](null,[r.originX,r.originY],a,n,t),l=(0<s.signal?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(o[1]-o[0])+o[0],u=Math.max(1/r.scale,0);o[0]=(o[0]-l)*u+l,o[1]=(o[1]-l)*u+l;var c=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return C_(0,o,[0,100],0,c.minSpan,c.maxSpan),this._range=o,i[0]!==o[0]||i[1]!==o[1]?o:void 0}},pan:TI(function(t,e,n,r,i,o){var a=AI[r]([o.oldX,o.oldY],[o.newX,o.newY],e,i,n);return a.signal*(t[1]-t[0])*a.pixel/a.pixelLength}),scrollMove:TI(function(t,e,n,r,i,o){return AI[r]([0,0],[o.scrollDelta,o.scrollDelta],e,i,n).signal*(t[1]-t[0])*o.scrollDelta})};function TI(t){return function(e,n,r,i){var o=this._range,a=o.slice(),s=e.axisModels[0];if(s)return C_(t(a,s,e,n,r,i),a,[0,100],"all"),this._range=a,o[0]!==a[0]||o[1]!==a[1]?a:void 0}}function kI(t){var e=t&&t.visualMap;R(e)||(e=e?[e]:[]),II(e,function(t){if(t){DI(t,"splitList")&&!DI(t,"pieces")&&(t.pieces=t.splitList,delete t.splitList);var e=t.pieces;e&&R(e)&&II(e,function(t){B(t)&&(DI(t,"start")&&!DI(t,"min")&&(t.min=t.start),DI(t,"end")&&!DI(t,"max")&&(t.max=t.end))})}})}var AI={grid:function(t,e,n,r,i){var o=n.axis,a={},s=i.model.coordinateSystem.getRect();return t=t||[0,0],"x"===o.dim?(a.pixel=e[0]-t[0],a.pixelLength=s.width,a.pixelStart=s.x,a.signal=o.inverse?1:-1):(a.pixel=e[1]-t[1],a.pixelLength=s.height,a.pixelStart=s.y,a.signal=o.inverse?-1:1),a},polar:function(t,e,n,r,i){var o=n.axis,a={},s=i.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),u=s.getAngleAxis().getExtent();return t=t?s.pointToCoord(t):[0,0],e=s.pointToCoord(e),"radiusAxis"===n.mainType?(a.pixel=e[0]-t[0],a.pixelLength=l[1]-l[0],a.pixelStart=l[0],a.signal=o.inverse?1:-1):(a.pixel=e[1]-t[1],a.pixelLength=u[1]-u[0],a.pixelStart=u[0],a.signal=o.inverse?-1:1),a},singleAxis:function(t,e,n,r,i){var o=n.axis,a=i.model.coordinateSystem.getRect(),s={};return t=t||[0,0],"horizontal"===o.orient?(s.pixel=e[0]-t[0],s.pixelLength=a.width,s.pixelStart=a.x,s.signal=o.inverse?1:-1):(s.pixel=e[1]-t[1],s.pixelLength=a.height,s.pixelStart=a.y,s.signal=o.inverse?-1:1),s}},II=k;function DI(t,e){return t&&t.hasOwnProperty&&t.hasOwnProperty(e)}gu.registerSubTypeDefaulter("visualMap",function(t){return t.categories||(t.pieces?0<t.pieces.length:0<t.splitNumber)&&!t.calculable?"piecewise":"continuous"});var OI=ff.VISUAL.COMPONENT;function PI(t,e,n,r){for(var i=e.targetVisuals[r],o=zx.prepareVisualTypes(i),a={color:t.getData().getVisual("color")},s=0,l=o.length;s<l;s++){var u=o[s],c=i["opacity"===u?"__alphaForOpacity":u];c&&c.applyVisual(n,d,f)}return a.color;function d(t){return a[t]}function f(t,e){a[t]=e}}ih(OI,{createOnAllSeries:!0,reset:function(t,e){var n=[];return e.eachComponent("visualMap",function(e){var r=t.pipelineContext;!e.isTargetSeries(t)||r&&r.large||n.push(function(t,e,n,r){var i={};return k(t,function(t){var n=zx.prepareVisualTypes(e[t]);i[t]=n}),{progress:function(t,o){function a(t){return o.getItemVisual(l,t)}function s(t,e){o.setItemVisual(l,t,e)}var l;for(null!=r&&(r=o.getDimension(r));null!=(l=t.next());){var u=o.getRawDataItem(l);if(!u||!1!==u.visualMap)for(var c=null!=r?o.get(r,l,!0):l,d=n(c),f=e[d],h=i[d],p=0,g=h.length;p<g;p++){var m=h[p];f[m]&&f[m].applyVisual(c,a,s)}}}}}(e.stateList,e.targetVisuals,P(e.getValueState,e),e.getDataDimension(t.getData())))}),n}}),ih(OI,{createOnAllSeries:!0,reset:function(t,e){var n=t.getData(),r=[];e.eachComponent("visualMap",function(e){if(e.isTargetSeries(t)){var i=e.getVisualMeta(P(PI,null,t,e))||{stops:[],outerColors:[]},o=e.getDataDimension(n),a=n.getDimensionInfo(o);null!=a&&(i.dimension=a.index,r.push(i))}}),t.getData().setVisual("visualMeta",r)}});var EI=function(t,e,n){var r=m((RI[t]||{})[e]);return n&&R(r)?r[r.length-1]:r},RI={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},LI=zx.mapVisual,NI=zx.eachVisual,BI=R,zI=k,VI=wl,FI=xl,HI=sh({type:"visualMap",dependencies:["series"],stateList:["inRange","outOfRange"],replacableOptionKeys:["inRange","outOfRange","target","controller","color"],dataBound:[-1/0,1/0],layoutMode:{type:"box",ignoreSize:!0},defaultOption:{show:!0,zlevel:0,z:4,seriesIndex:"all",min:0,max:200,dimension:null,inRange:null,outOfRange:null,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,color:null,formatter:null,text:null,textStyle:{color:"#333"}},init:function(t,e,n){this.targetVisuals={},this.controllerVisuals={},this.mergeDefaultAndTheme(t,n)},optionUpdated:function(t,e){var n=this.option;i.canvasSupported||(n.realtime=!1),e||Wk(n,t,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},resetVisual:function(t){var e=this.stateList;t=P(t,this),this.controllerVisuals=Hk(this.option.controller,e,t),this.targetVisuals=Hk(this.option.target,e,t)},getTargetSeriesIndices:function(){var t=this.option.seriesIndex,e=[];return null==t||"all"===t?this.ecModel.eachSeries(function(t,n){e.push(n)}):e=Ti(t),e},eachTargetSeries:function(t,e){k(this.getTargetSeriesIndices(),function(n){t.call(e,this.ecModel.getSeriesByIndex(n))},this)},isTargetSeries:function(t){var e=!1;return this.eachTargetSeries(function(n){n===t&&(e=!0)}),e},formatValueText:function(t,e,n){var r,i,o=this.option,a=o.precision,s=this.dataBound,l=o.formatter;return n=n||["<",">"],R(t)&&(t=t.slice(),r=!0),i=e?t:r?[u(t[0]),u(t[1])]:u(t),N(l)?l.replace("{value}",r?i[0]:i).replace("{value2}",r?i[1]:i):L(l)?r?l(t[0],t[1]):l(t):r?t[0]===s[0]?n[0]+" "+i[1]:t[1]===s[1]?n[1]+" "+i[0]:i[0]+" - "+i[1]:i;function u(t){return t===s[0]?"min":t===s[1]?"max":(+t).toFixed(Math.min(a,20))}},resetExtent:function(){var t=this.option,e=VI([t.min,t.max]);this._dataExtent=e},getDataDimension:function(t){var e=this.option.dimension;if(null!=e||t.dimensions.length){if(null!=e)return t.getDimension(e);for(var n=t.dimensions,r=n.length-1;0<=r;r--){var i=n[r];if(!t.getDimensionInfo(i).isCalculationCoord)return i}}},getExtent:function(){return this._dataExtent.slice()},completeVisualOption:function(){var t=this.ecModel,e=this.option,n={inRange:e.inRange,outOfRange:e.outOfRange},r=e.target||(e.target={}),i=e.controller||(e.controller={});v(r,n),v(i,n);var o=this.isCategory();function a(n){BI(e.color)&&!n.inRange&&(n.inRange={color:e.color.slice().reverse()}),n.inRange=n.inRange||{color:t.get("gradientColor")},zI(this.stateList,function(t){var e=n[t];if(N(e)){var r=EI(e,"active",o);r?(n[t]={},n[t][e]=r):delete n[t]}},this)}a.call(this,r),a.call(this,i),(function(t,e,n){var r=t[e],i=t[n];r&&!i&&(i=t[n]={},zI(r,function(t,e){if(zx.isValidType(e)){var n=EI(e,"inactive",o);null!=n&&(i[e]=n,"color"!==e||i.hasOwnProperty("opacity")||i.hasOwnProperty("colorAlpha")||(i.opacity=[0,0]))}}))}).call(this,r,"inRange","outOfRange"),(function(t){var e=(t.inRange||{}).symbol||(t.outOfRange||{}).symbol,n=(t.inRange||{}).symbolSize||(t.outOfRange||{}).symbolSize,r=this.get("inactiveColor");zI(this.stateList,function(i){var a=this.itemSize,s=t[i];null==(s=s||(t[i]={color:o?r:[r]})).symbol&&(s.symbol=e&&m(e)||(o?"roundRect":["roundRect"])),null==s.symbolSize&&(s.symbolSize=n&&m(n)||(o?a[0]:[a[0],a[0]])),s.symbol=LI(s.symbol,function(t){return"none"===t||"square"===t?"roundRect":t});var l=s.symbolSize;if(null!=l){var u=-1/0;NI(l,function(t){u<t&&(u=t)}),s.symbolSize=LI(l,function(t){return FI(t,[0,u],[0,a[0]],!0)})}},this)}).call(this,i)},resetItemSize:function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},isCategory:function(){return!!this.option.categories},setSelected:et,getValueState:et,getVisualMeta:et}),WI=[20,140],jI=HI.extend({type:"visualMap.continuous",defaultOption:{align:"auto",calculable:!1,range:null,realtime:!0,itemHeight:null,itemWidth:null,hoverLink:!0,hoverLinkDataSize:null,hoverLinkOnHandle:null},optionUpdated:function(t,e){jI.superApply(this,"optionUpdated",arguments),this.resetExtent(),this.resetVisual(function(t){t.mappingMethod="linear",t.dataExtent=this.getExtent()}),this._resetRange()},resetItemSize:function(){jI.superApply(this,"resetItemSize",arguments);var t=this.itemSize;"horizontal"===this._orient&&t.reverse(),null!=t[0]&&!isNaN(t[0])||(t[0]=WI[0]),null!=t[1]&&!isNaN(t[1])||(t[1]=WI[1])},_resetRange:function(){var t=this.getExtent(),e=this.option.range;!e||e.auto?(t.auto=1,this.option.range=t):R(e)&&(e[0]>e[1]&&e.reverse(),e[0]=Math.max(e[0],t[0]),e[1]=Math.min(e[1],t[1]))},completeVisualOption:function(){HI.prototype.completeVisualOption.apply(this,arguments),k(this.stateList,function(t){var e=this.option.controller[t].symbolSize;e&&e[0]!==e[1]&&(e[0]=0)},this)},setSelected:function(t){this.option.range=t.slice(),this._resetRange()},getSelected:function(){var t=this.getExtent(),e=wl((this.get("range")||[]).slice());return e[0]>t[1]&&(e[0]=t[1]),e[1]>t[1]&&(e[1]=t[1]),e[0]<t[0]&&(e[0]=t[0]),e[1]<t[0]&&(e[1]=t[0]),e},getValueState:function(t){var e=this.option.range,n=this.getExtent();return(e[0]<=n[0]||e[0]<=t)&&(e[1]>=n[1]||t<=e[1])?"inRange":"outOfRange"},findTargetDataIndices:function(t){var e=[];return this.eachTargetSeries(function(n){var r=[],i=n.getData();i.each(this.getDataDimension(i),function(e,n){t[0]<=e&&e<=t[1]&&r.push(n)},this),e.push({seriesId:n.id,dataIndex:r})},this),e},getVisualMeta:function(t){var e=GI(0,0,this.getExtent()),n=GI(0,0,this.option.range.slice()),r=[];function i(e,n){r.push({value:e,color:t(e,n)})}for(var o=0,a=0,s=n.length,l=e.length;a<l&&(!n.length||e[a]<=n[0]);a++)e[a]<n[o]&&i(e[a],"outOfRange");for(var u=1;o<s;o++,u=0)u&&r.length&&i(n[o],"outOfRange"),i(n[o],"inRange");for(u=1;a<l;a++)(!n.length||n[n.length-1]<e[a])&&(u&&(r.length&&i(r[r.length-1].value,"outOfRange"),u=0),i(e[a],"outOfRange"));var c=r.length;return{stops:r,outerColors:[c?r[0].color:"transparent",c?r[c-1].color:"transparent"]}}});function GI(t,e,n){if(n[0]===n[1])return n.slice();for(var r=(n[1]-n[0])/200,i=n[0],o=[],a=0;a<=200&&i<n[1];a++)o.push(i),i+=r;return o.push(n[1]),o}var UI=lh({type:"visualMap",autoPositionValues:{left:1,right:1,top:1,bottom:1},init:function(t,e){this.ecModel=t,this.api=e},render:function(t,e,n,r){!1!==(this.visualMapModel=t).get("show")?this.doRender.apply(this,arguments):this.group.removeAll()},renderBackground:function(t){var e=this.visualMapModel,n=Fl(e.get("padding")||0),r=t.getBoundingRect();t.add(new Ua({z2:-1,silent:!0,shape:{x:r.x-n[3],y:r.y-n[0],width:r.width+n[3]+n[1],height:r.height+n[0]+n[2]},style:{fill:e.get("backgroundColor"),stroke:e.get("borderColor"),lineWidth:e.get("borderWidth")}}))},getControllerVisual:function(t,e,n){var r=(n=n||{}).forceState,i=this.visualMapModel,o={};if("symbol"===e&&(o.symbol=i.get("itemSymbol")),"color"===e){var a=i.get("contentColor");o.color=a}function s(t){return o[t]}function l(t,e){o[t]=e}var u=i.controllerVisuals[r||i.getValueState(t)];return k(zx.prepareVisualTypes(u),function(r){var i=u[r];n.convertOpacityToAlpha&&"opacity"===r&&(r="colorAlpha",i=u.__alphaForOpacity),zx.dependsOn(r,e)&&i&&i.applyVisual(t,s,l)}),o[e]},positionGroup:function(t){var e=this.api;su(t,this.visualMapModel.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})},doRender:et});function qI(t,e,n){var r=t.option,i=r.align;if(null!=i&&"auto"!==i)return i;for(var o={width:e.getWidth(),height:e.getHeight()},a="horizontal"===r.orient?1:0,s=[["left","right","width"],["top","bottom","height"]],l=s[a],u=[0,null,10],c={},d=0;d<3;d++)c[s[1-a][d]]=u[d],c[l[d]]=2===d?n[0]:r[l[d]];var f=[["x","width",3],["y","height",0]][a],h=au(c,o,r.padding);return l[(h.margin[f[2]]||0)+h[f[0]]+.5*h[f[1]]<.5*o[f[1]]?0:1]}function XI(t,e){return k(t||[],function(t){null!=t.dataIndex&&(t.dataIndexInside=t.dataIndex,t.dataIndex=null),t.highlightKey="visualMap"+(e?e.componentIndex:"")}),t}var YI=xl,$I=k,ZI=Math.min,KI=Math.max,JI=UI.extend({type:"visualMap.continuous",init:function(){JI.superApply(this,"init",arguments),this._shapes={},this._dataInterval=[],this._handleEnds=[],this._hoverLinkDataIndices=[]},doRender:function(t,e,n,r){r&&"selectDataRange"===r.type&&r.from===this.uid||this._buildView()},_buildView:function(){this.group.removeAll();var t=this.visualMapModel,e=this.group;this._orient=t.get("orient"),this._useHandle=t.get("calculable"),this._resetInterval(),this._renderBar(e);var n=t.get("text");this._renderEndsText(e,n,0),this._renderEndsText(e,n,1),this._updateView(!0),this.renderBackground(e),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(e)},_renderEndsText:function(t,e,n){if(e){var r=e[1-n];r=null!=r?r+"":"";var i=this.visualMapModel,o=i.get("textGap"),a=i.itemSize,s=this._shapes.barGroup,l=this._applyTransform([a[0]/2,0===n?-o:a[1]+o],s),u=this._applyTransform(0===n?"bottom":"top",s),c=this._orient,d=this.visualMapModel.textStyleModel;this.group.add(new Da({style:{x:l[0],y:l[1],textVerticalAlign:"horizontal"===c?"middle":u,textAlign:"horizontal"===c?u:"center",text:r,textFont:d.getFont(),textFill:d.getTextColor()}}))}},_renderBar:function(t){var e=this.visualMapModel,n=this._shapes,r=e.itemSize,i=this._orient,o=this._useHandle,a=qI(e,this.api,r),s=n.barGroup=this._createBarGroup(a);s.add(n.outOfRange=QI()),s.add(n.inRange=QI(null,o?eD(this._orient):null,P(this._dragHandle,this,"all",!1),P(this._dragHandle,this,"all",!0)));var l=e.textStyleModel.getTextRect("国"),u=KI(l.width,l.height);o&&(n.handleThumbs=[],n.handleLabels=[],n.handleLabelPoints=[],this._createHandle(s,0,r,u,i,a),this._createHandle(s,1,r,u,i,a)),this._createIndicator(s,r,u,i),t.add(s)},_createHandle:function(t,e,n,r,i){var o=P(this._dragHandle,this,e,!1),a=P(this._dragHandle,this,e,!0),s=QI(function(t,e){return 0===t?[[0,0],[e,0],[e,-e]]:[[0,0],[e,0],[e,e]]}(e,r),eD(this._orient),o,a);s.position[0]=n[0],t.add(s);var l=this.visualMapModel.textStyleModel,u=new Da({draggable:!0,drift:o,onmousemove:function(t){Gt(t.event)},ondragend:a,style:{x:0,y:0,text:"",textFont:l.getFont(),textFill:l.getTextColor()}});this.group.add(u);var c=["horizontal"===i?r/2:1.5*r,"horizontal"===i?0===e?-1.5*r:1.5*r:0===e?-r/2:r/2],d=this._shapes;d.handleThumbs[e]=s,d.handleLabelPoints[e]=c,d.handleLabels[e]=u},_createIndicator:function(t,e,n,r){var i=QI([[0,0]],"move");i.position[0]=e[0],i.attr({invisible:!0,silent:!0}),t.add(i);var o=this.visualMapModel.textStyleModel,a=new Da({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textFont:o.getFont(),textFill:o.getTextColor()}});this.group.add(a);var s=["horizontal"===r?n/2:9,0],l=this._shapes;l.indicator=i,l.indicatorLabel=a,l.indicatorLabelPoint=s},_dragHandle:function(t,e,n,r){if(this._useHandle){if(this._dragging=!e,!e){var i=this._applyTransform([n,r],this._shapes.barGroup,!0);this._updateInterval(t,i[1]),this._updateView()}e===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),e?this._hovering||this._clearHoverLinkToSeries():tD(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[t],!1)}},_resetInterval:function(){var t=this.visualMapModel,e=this._dataInterval=t.getSelected(),n=t.getExtent(),r=[0,t.itemSize[1]];this._handleEnds=[YI(e[0],n,r,!0),YI(e[1],n,r,!0)]},_updateInterval:function(t,e){var n=this.visualMapModel,r=this._handleEnds,i=[0,n.itemSize[1]];C_(e=e||0,r,i,t,0);var o=n.getExtent();this._dataInterval=[YI(r[0],i,o,!0),YI(r[1],i,o,!0)]},_updateView:function(t){var e=this.visualMapModel,n=e.getExtent(),r=this._shapes,i=[0,e.itemSize[1]],o=t?i:this._handleEnds,a=this._createBarVisual(this._dataInterval,n,o,"inRange"),s=this._createBarVisual(n,n,i,"outOfRange");r.inRange.setStyle({fill:a.barColor,opacity:a.opacity}).setShape("points",a.barPoints),r.outOfRange.setStyle({fill:s.barColor,opacity:s.opacity}).setShape("points",s.barPoints),this._updateHandle(o,a)},_createBarVisual:function(t,e,n,r){var i={forceState:r,convertOpacityToAlpha:!0},o=this._makeColorGradient(t,i),a=[this.getControllerVisual(t[0],"symbolSize",i),this.getControllerVisual(t[1],"symbolSize",i)],s=this._createBarPoints(n,a);return{barColor:new ts(0,0,0,1,o),barPoints:s,handlesColor:[o[0].color,o[o.length-1].color]}},_makeColorGradient:function(t,e){var n=[],r=(t[1]-t[0])/100;n.push({color:this.getControllerVisual(t[0],"color",e),offset:0});for(var i=1;i<100;i++){var o=t[0]+r*i;if(o>t[1])break;n.push({color:this.getControllerVisual(o,"color",e),offset:i/100})}return n.push({color:this.getControllerVisual(t[1],"color",e),offset:1}),n},_createBarPoints:function(t,e){var n=this.visualMapModel.itemSize;return[[n[0]-e[0],t[0]],[n[0],t[0]],[n[0],t[1]],[n[0]-e[1],t[1]]]},_createBarGroup:function(t){var e=this._orient,n=this.visualMapModel.get("inverse");return new Cn("horizontal"!==e||n?"horizontal"===e&&n?{scale:"bottom"===t?[-1,1]:[1,1],rotation:-Math.PI/2}:"vertical"!==e||n?{scale:"left"===t?[1,1]:[-1,1]}:{scale:"left"===t?[1,-1]:[-1,-1]}:{scale:"bottom"===t?[1,1]:[-1,1],rotation:Math.PI/2})},_updateHandle:function(t,e){if(this._useHandle){var n=this._shapes,r=this.visualMapModel,i=n.handleThumbs,o=n.handleLabels;$I([0,1],function(a){var s=i[a];s.setStyle("fill",e.handlesColor[a]),s.position[1]=t[a];var l=Js(n.handleLabelPoints[a],Ks(s,this.group));o[a].setStyle({x:l[0],y:l[1],text:r.formatValueText(this._dataInterval[a]),textVerticalAlign:"middle",textAlign:this._applyTransform("horizontal"===this._orient?0===a?"bottom":"top":"left",n.barGroup)})},this)}},_showIndicator:function(t,e,n,r){var i=this.visualMapModel,o=i.getExtent(),a=i.itemSize,s=YI(t,o,[0,a[1]],!0),l=this._shapes,u=l.indicator;if(u){u.position[1]=s,u.attr("invisible",!1),u.setShape("points",function(t,e,n,r){return t?[[0,-ZI(e,KI(n,0))],[6,0],[0,ZI(e,KI(r-n,0))]]:[[0,0],[5,-5],[5,5]]}(!!n,r,s,a[1]));var c=this.getControllerVisual(t,"color",{convertOpacityToAlpha:!0});u.setStyle("fill",c);var d=Js(l.indicatorLabelPoint,Ks(u,this.group)),f=l.indicatorLabel;f.attr("invisible",!1);var h=this._applyTransform("left",l.barGroup),p=this._orient;f.setStyle({text:(n||"")+i.formatValueText(e),textVerticalAlign:"horizontal"===p?h:"middle",textAlign:"horizontal"===p?"center":h,x:d[0],y:d[1]})}},_enableHoverLinkToSeries:function(){var t=this;this._shapes.barGroup.on("mousemove",function(e){if(t._hovering=!0,!t._dragging){var n=t.visualMapModel.itemSize,r=t._applyTransform([e.offsetX,e.offsetY],t._shapes.barGroup,!0,!0);r[1]=ZI(KI(0,r[1]),n[1]),t._doHoverLinkToSeries(r[1],0<=r[0]&&r[0]<=n[0])}}).on("mouseout",function(){t._hovering=!1,t._dragging||t._clearHoverLinkToSeries()})},_enableHoverLinkFromSeries:function(){var t=this.api.getZr();this.visualMapModel.option.hoverLink?(t.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),t.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},_doHoverLinkToSeries:function(t,e){var n=this.visualMapModel;if(n.option.hoverLink){var r=[0,n.itemSize[1]],i=n.getExtent();t=ZI(KI(r[0],t),r[1]);var o=function(t,e,n){var r=6,i=t.get("hoverLinkDataSize");return i&&(r=YI(i,e,n,!0)/2),r}(n,i,r),a=[t-o,t+o],s=YI(t,r,i,!0),l=[YI(a[0],r,i,!0),YI(a[1],r,i,!0)];a[0]<r[0]&&(l[0]=-1/0),r[1]<a[1]&&(l[1]=1/0),e&&(l[0]===-1/0?this._showIndicator(s,l[1],"< ",o):l[1]===1/0?this._showIndicator(s,l[0],"> ",o):this._showIndicator(s,s,"≈ ",o));var u=this._hoverLinkDataIndices,c=[];(e||tD(n))&&(c=this._hoverLinkDataIndices=n.findTargetDataIndices(l));var d=function(t,e){var n={},r={};return i(t||[],n),i(e||[],r,n),[o(n),o(r)];function i(t,e,n){for(var r=0,i=t.length;r<i;r++)for(var o=t[r].seriesId,a=Ti(t[r].dataIndex),s=n&&n[o],l=0,u=a.length;l<u;l++){var c=a[l];s&&s[c]?s[c]=null:(e[o]||(e[o]={}))[c]=1}}function o(t,e){var n=[];for(var r in t)if(t.hasOwnProperty(r)&&null!=t[r])if(e)n.push(+r);else{var i=o(t[r],!0);i.length&&n.push({seriesId:r,dataIndex:i})}return n}}(u,c);this._dispatchHighDown("downplay",XI(d[0],n)),this._dispatchHighDown("highlight",XI(d[1],n))}},_hoverLinkFromSeriesMouseOver:function(t){var e=t.target,n=this.visualMapModel;if(e&&null!=e.dataIndex){var r=this.ecModel.getSeriesByIndex(e.seriesIndex);if(n.isTargetSeries(r)){var i=r.getData(e.dataType),o=i.get(n.getDataDimension(i),e.dataIndex,!0);isNaN(o)||this._showIndicator(o,o)}}},_hideIndicator:function(){var t=this._shapes;t.indicator&&t.indicator.attr("invisible",!0),t.indicatorLabel&&t.indicatorLabel.attr("invisible",!0)},_clearHoverLinkToSeries:function(){this._hideIndicator();var t=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",XI(t,this.visualMapModel)),t.length=0},_clearHoverLinkFromSeries:function(){this._hideIndicator();var t=this.api.getZr();t.off("mouseover",this._hoverLinkFromSeriesMouseOver),t.off("mouseout",this._hideIndicator)},_applyTransform:function(t,e,n,r){var i=Ks(e,r?null:this.group);return al[R(t)?"applyTransform":"transformDirection"](t,i,n)},_dispatchHighDown:function(t,e){e&&e.length&&this.api.dispatchAction({type:t,batch:e})},dispose:function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},remove:function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()}});function QI(t,e,n,r){return new za({shape:{points:t},draggable:!!n,cursor:e,drift:n,onmousemove:function(t){Gt(t.event)},ondragend:r})}function tD(t){var e=t.get("hoverLinkOnHandle");return!!(null==e?t.get("realtime"):e)}function eD(t){return"vertical"===t?"ns-resize":"ew-resize"}eh({type:"selectDataRange",event:"dataRangeSelected",update:"update"},function(t,e){e.eachComponent({mainType:"visualMap",query:t},function(e){e.setSelected(t.selected)})}),Qf(kI);var nD=HI.extend({type:"visualMap.piecewise",defaultOption:{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieceList:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0,showLabel:null},optionUpdated:function(t,e){nD.superApply(this,"optionUpdated",arguments),this._pieceList=[],this.resetExtent();var n=this._mode=this._determineMode();rD[this._mode].call(this),this._resetSelected(t,e);var r=this.option.categories;this.resetVisual(function(t,e){"categories"===n?(t.mappingMethod="category",t.categories=m(r)):(t.dataExtent=this.getExtent(),t.mappingMethod="piecewise",t.pieceList=A(this._pieceList,function(t){return t=m(t),"inRange"!==e&&(t.visual=null),t}))})},completeVisualOption:function(){var t=this.option,e={},n=zx.listVisualTypes(),r=this.isCategory();function i(t,e,n){return t&&t[e]&&(B(t[e])?t[e].hasOwnProperty(n):t[e]===n)}k(t.pieces,function(t){k(n,function(n){t.hasOwnProperty(n)&&(e[n]=1)})}),k(e,function(e,n){var o=0;k(this.stateList,function(e){o|=i(t,e,n)||i(t.target,e,n)},this),o||k(this.stateList,function(e){(t[e]||(t[e]={}))[n]=EI(n,"inRange"===e?"active":"inactive",r)})},this),HI.prototype.completeVisualOption.apply(this,arguments)},_resetSelected:function(t,e){var n=this.option,r=this._pieceList,i=(e?n:t).selected||{};if(n.selected=i,k(r,function(t,e){var n=this.getSelectedMapKey(t);i.hasOwnProperty(n)||(i[n]=!0)},this),"single"===n.selectedMode){var o=!1;k(r,function(t,e){var n=this.getSelectedMapKey(t);i[n]&&(o?i[n]=!1:o=!0)},this)}},getSelectedMapKey:function(t){return"categories"===this._mode?t.value+"":t.index+""},getPieceList:function(){return this._pieceList},_determineMode:function(){var t=this.option;return t.pieces&&0<t.pieces.length?"pieces":this.option.categories?"categories":"splitNumber"},setSelected:function(t){this.option.selected=m(t)},getValueState:function(t){var e=zx.findPieceIndex(t,this._pieceList);return null!=e&&this.option.selected[this.getSelectedMapKey(this._pieceList[e])]?"inRange":"outOfRange"},findTargetDataIndices:function(t){var e=[];return this.eachTargetSeries(function(n){var r=[],i=n.getData();i.each(this.getDataDimension(i),function(e,n){zx.findPieceIndex(e,this._pieceList)===t&&r.push(n)},this),e.push({seriesId:n.id,dataIndex:r})},this),e},getRepresentValue:function(t){var e;if(this.isCategory())e=t.value;else if(null!=t.value)e=t.value;else{var n=t.interval||[];e=n[0]===-1/0&&n[1]===1/0?0:(n[0]+n[1])/2}return e},getVisualMeta:function(t){if(!this.isCategory()){var e=[],n=[],r=this,i=this._pieceList.slice();if(i.length){var o=i[0].interval[0];o!==-1/0&&i.unshift({interval:[-1/0,o]}),(o=i[i.length-1].interval[1])!==1/0&&i.push({interval:[o,1/0]})}else i.push({interval:[-1/0,1/0]});var a=-1/0;return k(i,function(t){var e=t.interval;e&&(e[0]>a&&s([a,e[0]],"outOfRange"),s(e.slice()),a=e[1])},this),{stops:e,outerColors:n}}function s(i,o){var a=r.getRepresentValue({interval:i});o=o||r.getValueState(a);var s=t(a,o);i[0]===-1/0?n[0]=s:i[1]===1/0?n[1]=s:e.push({value:i[0],color:s},{value:i[1],color:s})}}}),rD={splitNumber:function(){var t=this.option,e=this._pieceList,n=Math.min(t.precision,20),r=this.getExtent(),i=t.splitNumber;i=Math.max(parseInt(i,10),1),t.splitNumber=i;for(var o=(r[1]-r[0])/i;+o.toFixed(n)!==o&&n<5;)n++;t.precision=n,o=+o.toFixed(n),t.minOpen&&e.push({interval:[-1/0,r[0]],close:[0,0]});for(var a=0,s=r[0];a<i;s+=o,a++)e.push({interval:[s,a===i-1?r[1]:s+o],close:[1,1]});t.maxOpen&&e.push({interval:[r[1],1/0],close:[0,0]}),Ll(e),k(e,function(t,e){t.index=e,t.text=this.formatValueText(t.interval)},this)},categories:function(){var t=this.option;k(t.categories,function(t){this._pieceList.push({text:this.formatValueText(t,!0),value:t})},this),iD(t,this._pieceList)},pieces:function(){var t=this.option,e=this._pieceList;k(t.pieces,function(t,n){B(t)||(t={value:t});var r={text:"",index:n};if(null!=t.label&&(r.text=t.label),t.hasOwnProperty("value")){var i=r.value=t.value;r.interval=[i,i],r.close=[1,1]}else{for(var o=r.interval=[],a=r.close=[0,0],s=[1,0,1],l=[-1/0,1/0],u=[],c=0;c<2;c++){for(var d=[["gte","gt","min"],["lte","lt","max"]][c],f=0;f<3&&null==o[c];f++)o[c]=t[d[f]],a[c]=s[f],u[c]=2===f;null==o[c]&&(o[c]=l[c])}u[0]&&o[1]===1/0&&(a[0]=0),u[1]&&o[0]===-1/0&&(a[1]=0),o[0]===o[1]&&a[0]&&a[1]&&(r.value=o[0])}r.visual=zx.retrieveVisuals(t),e.push(r)},this),iD(t,e),Ll(e),k(e,function(t){var e=t.close;t.text=t.text||this.formatValueText(null!=t.value?t.value:t.interval,!1,[["<","≤"][e[1]],[">","≥"][e[0]]])},this)}};function iD(t,e){var n=t.inverse;("vertical"===t.orient?!n:n)&&e.reverse()}UI.extend({type:"visualMap.piecewise",doRender:function(){var t=this.group;t.removeAll();var e=this.visualMapModel,n=e.get("textGap"),r=e.textStyleModel,i=r.getFont(),o=r.getTextColor(),a=this._getItemAlign(),s=e.itemSize,l=this._getViewData(),u=l.endsText,c=W(e.get("showLabel",!0),!u);u&&this._renderEndsText(t,u[0],s,c,a),k(l.viewPieceList,function(r){var l=r.piece,u=new Cn;u.onclick=P(this._onItemClick,this,l),this._enableHoverLink(u,r.indexInModelPieceList);var d=e.getRepresentValue(l);if(this._createItemSymbol(u,d,[0,0,s[0],s[1]]),c){var f=this.visualMapModel.getValueState(d);u.add(new Da({style:{x:"right"===a?-n:s[0]+n,y:s[1]/2,text:l.text,textVerticalAlign:"middle",textAlign:a,textFont:i,textFill:o,opacity:"outOfRange"===f?.5:1}}))}t.add(u)},this),u&&this._renderEndsText(t,u[1],s,c,a),ou(e.get("orient"),t,e.get("itemGap")),this.renderBackground(t),this.positionGroup(t)},_enableHoverLink:function(t,e){function n(t){var n=this.visualMapModel;n.option.hoverLink&&this.api.dispatchAction({type:t,batch:XI(n.findTargetDataIndices(e),n)})}t.on("mouseover",P(n,this,"highlight")).on("mouseout",P(n,this,"downplay"))},_getItemAlign:function(){var t=this.visualMapModel,e=t.option;if("vertical"===e.orient)return qI(t,this.api,t.itemSize);var n=e.align;return n&&"auto"!==n||(n="left"),n},_renderEndsText:function(t,e,n,r,i){if(e){var o=new Cn,a=this.visualMapModel.textStyleModel;o.add(new Da({style:{x:r?"right"===i?n[0]:0:n[0]/2,y:n[1]/2,textVerticalAlign:"middle",textAlign:r?i:"center",text:e,textFont:a.getFont(),textFill:a.getTextColor()}})),t.add(o)}},_getViewData:function(){var t=this.visualMapModel,e=A(t.getPieceList(),function(t,e){return{piece:t,indexInModelPieceList:e}}),n=t.get("text"),r=t.get("orient"),i=t.get("inverse");return("horizontal"===r?i:!i)?e.reverse():n=n&&n.slice().reverse(),{viewPieceList:e,endsText:n}},_createItemSymbol:function(t,e,n){t.add(eg(this.getControllerVisual(e,"symbol"),n[0],n[1],n[2],n[3],this.getControllerVisual(e,"color")))},_onItemClick:function(t){var e=this.visualMapModel,n=e.option,r=m(n.selected),i=e.getSelectedMapKey(t);"single"===n.selectedMode?(r[i]=!0,k(r,function(t,e){r[e]=e===i})):r[i]=!r[i],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:r})}}),Qf(kI);var oD,aD="urn:schemas-microsoft-com:vml",sD="undefined"==typeof window?null:window,lD=!1,uD=sD&&sD.document;function cD(t){return oD(t)}if(uD&&!i.canvasSupported)try{uD.namespaces.zrvml||uD.namespaces.add("zrvml",aD),oD=function(t){return uD.createElement("<zrvml:"+t+' class="zrvml">')}}catch(t){oD=function(t){return uD.createElement("<"+t+' xmlns="'+aD+'" class="zrvml">')}}var dD=Xo.CMD,fD=Math.round,hD=Math.sqrt,pD=Math.abs,gD=Math.cos,mD=Math.sin,vD=Math.max;if(!i.canvasSupported){var yD=",",xD="progid:DXImageTransform.Microsoft",bD=21600,_D=bD/2,wD=function(t){t.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",t.coordsize=bD+","+bD,t.coordorigin="0,0"},SD=function(t,e,n){return"rgb("+[t,e,n].join(",")+")"},CD=function(t,e){e&&t&&e.parentNode!==t&&t.appendChild(e)},MD=function(t,e){e&&t&&e.parentNode===t&&t.removeChild(e)},TD=function(t,e,n){return 1e5*(parseFloat(t)||0)+1e3*(parseFloat(e)||0)+n},kD=Nr,AD=function(t,e,n){var r=Ve(e);n=+n,isNaN(n)&&(n=1),r&&(t.color=SD(r[0],r[1],r[2]),t.opacity=n*r[3])},ID=function(t,e,n,r){var i="fill"===e,o=t.getElementsByTagName(e)[0];null!=n[e]&&"none"!==n[e]&&(i||!i&&n.lineWidth)?(t[i?"filled":"stroked"]="true",n[e]instanceof Za&&MD(t,o),o=o||cD(e),i?function(t,e,n){var r,i=e.fill;if(null!=i)if(i instanceof Za){var o,a=0,s=[0,0],l=0,u=1,c=n.getBoundingRect(),d=c.width,f=c.height;if("linear"===i.type){o="gradient";var h=n.transform,p=[i.x*d,i.y*f],g=[i.x2*d,i.y2*f];h&&(bt(p,p,h),bt(g,g,h)),(a=180*Math.atan2(g[0]-p[0],g[1]-p[1])/Math.PI)<0&&(a+=360),a<1e-6&&(a=0)}else{o="gradientradial";var m=n.scale,v=d,y=f;s=[((p=[i.x*d,i.y*f])[0]-c.x)/v,(p[1]-c.y)/y],(h=n.transform)&&bt(p,p,h);var x=vD(v/=m[0]*bD,y/=m[1]*bD);u=2*i.r/x-(l=0/x)}var b=i.colorStops.slice();b.sort(function(t,e){return t.offset-e.offset});for(var _=b.length,w=[],S=[],C=0;C<_;C++){var M=b[C],T=(r=Ve(M.color),[SD(r[0],r[1],r[2]),r[3]]);S.push(M.offset*u+l+" "+T[0]),0!==C&&C!==_-1||w.push(T)}if(2<=_){var k=w[0][0],A=w[1][0],I=w[0][1]*e.opacity,D=w[1][1]*e.opacity;t.type=o,t.method="none",t.focus="100%",t.angle=a,t.color=k,t.color2=A,t.colors=S.join(","),t.opacity=D,t.opacity2=I}"radial"===o&&(t.focusposition=s.join(","))}else AD(t,i,e.opacity)}(o,n,r):function(t,e){e.lineDash&&(t.dashstyle=e.lineDash.join(" ")),null==e.stroke||e.stroke instanceof Za||AD(t,e.stroke,e.opacity)}(o,n),CD(t,o)):(t[i?"filled":"stroked"]="false",MD(t,o))},DD=[[],[],[]];ha.prototype.brushVML=function(t){var e=this.style,n=this._vmlEl;n||(n=cD("shape"),wD(n),this._vmlEl=n),ID(n,"fill",e,this),ID(n,"stroke",e,this);var r=this.transform,i=null!=r,o=n.getElementsByTagName("stroke")[0];if(o){var a=e.lineWidth;i&&!e.strokeNoScale&&(a*=hD(pD(r[0]*r[3]-r[1]*r[2]))),o.weight=a+"px"}var s=this.path||(this.path=new Xo);this.__dirtyPath&&(s.beginPath(),s.subPixelOptimize=!1,this.buildPath(s,this.shape),s.toStatic(),this.__dirtyPath=!1),n.path=function(t,e){var n,r,i,o,a,s,l=dD.M,u=dD.C,c=dD.L,d=dD.A,f=dD.Q,h=[],p=t.data,g=t.len();for(o=0;o<g;){switch(r="",n=0,i=p[o++]){case l:r=" m ",n=1,a=p[o++],s=p[o++],DD[0][0]=a,DD[0][1]=s;break;case c:r=" l ",n=1,a=p[o++],s=p[o++],DD[0][0]=a,DD[0][1]=s;break;case f:case u:r=" c ",n=3;var m,v,y=p[o++],x=p[o++],b=p[o++],_=p[o++];i===f?(b=((m=b)+2*y)/3,_=((v=_)+2*x)/3,y=(a+2*y)/3,x=(s+2*x)/3):(m=p[o++],v=p[o++]),DD[0][0]=y,DD[0][1]=x,DD[1][0]=b,DD[1][1]=_,a=DD[2][0]=m,s=DD[2][1]=v;break;case d:var w=0,S=0,C=1,M=1,T=0;e&&(w=e[4],S=e[5],C=hD(e[0]*e[0]+e[1]*e[1]),M=hD(e[2]*e[2]+e[3]*e[3]),T=Math.atan2(-e[1]/M,e[0]/C));var k=p[o++],A=p[o++],I=p[o++],D=p[o++],O=p[o++]+T,P=p[o++]+O+T;o++;var E=p[o++],R=k+gD(O)*I,L=A+mD(O)*D,N=(y=k+gD(P)*I,x=A+mD(P)*D,E?" wa ":" at ");Math.abs(R-y)<1e-4&&(.01<Math.abs(P-O)?E&&(R+=.0125):Math.abs(L-A)<1e-4?E&&R<k||!E&&k<R?x-=.0125:x+=.0125:E&&L<A||!E&&A<L?y+=.0125:y-=.0125),h.push(N,fD(((k-I)*C+w)*bD-_D),yD,fD(((A-D)*M+S)*bD-_D),yD,fD(((k+I)*C+w)*bD-_D),yD,fD(((A+D)*M+S)*bD-_D),yD,fD((R*C+w)*bD-_D),yD,fD((L*M+S)*bD-_D),yD,fD((y*C+w)*bD-_D),yD,fD((x*M+S)*bD-_D)),a=y,s=x;break;case dD.R:var B=DD[0],z=DD[1];B[0]=p[o++],B[1]=p[o++],z[0]=B[0]+p[o++],z[1]=B[1]+p[o++],e&&(bt(B,B,e),bt(z,z,e)),B[0]=fD(B[0]*bD-_D),z[0]=fD(z[0]*bD-_D),B[1]=fD(B[1]*bD-_D),z[1]=fD(z[1]*bD-_D),h.push(" m ",B[0],yD,B[1]," l ",z[0],yD,B[1]," l ",z[0],yD,z[1]," l ",B[0],yD,z[1]);break;case dD.Z:h.push(" x ")}if(0<n){h.push(r);for(var V=0;V<n;V++){var F=DD[V];e&&bt(F,F,e),h.push(fD(F[0]*bD-_D),yD,fD(F[1]*bD-_D),V<n-1?yD:"")}}}return h.join("")}(s,this.transform),n.style.zIndex=TD(this.zlevel,this.z,this.z2),CD(t,n),null!=e.text?this.drawRectText(t,this.getBoundingRect()):this.removeRectText(t)},ha.prototype.onRemove=function(t){MD(t,this._vmlEl),this.removeRectText(t)},ha.prototype.onAdd=function(t){CD(t,this._vmlEl),this.appendRectText(t)},Wr.prototype.brushVML=function(t){var e,n,r=this.style,i=r.image;if(function(t){return"object"==typeof t&&t.tagName&&"IMG"===t.tagName.toUpperCase()}(i)){var o=i.src;if(o===this._imageSrc)e=this._imageWidth,n=this._imageHeight;else{var a=i.runtimeStyle,s=a.width,l=a.height;a.width="auto",a.height="auto",e=i.width,n=i.height,a.width=s,a.height=l,this._imageSrc=o,this._imageWidth=e,this._imageHeight=n}i=o}else i===this._imageSrc&&(e=this._imageWidth,n=this._imageHeight);if(i){var u=r.x||0,c=r.y||0,d=r.width,f=r.height,h=r.sWidth,p=r.sHeight,g=r.sx||0,m=r.sy||0,v=h&&p,y=this._vmlEl;y||(y=uD.createElement("div"),wD(y),this._vmlEl=y);var x,b=y.style,_=!1,w=1,S=1;if(this.transform&&(w=hD((x=this.transform)[0]*x[0]+x[1]*x[1]),S=hD(x[2]*x[2]+x[3]*x[3]),_=x[1]||x[2]),_){var C=[u,c],M=[u+d,c],T=[u,c+f],k=[u+d,c+f];bt(C,C,x),bt(M,M,x),bt(T,T,x),bt(k,k,x);var A=vD(C[0],M[0],T[0],k[0]),I=vD(C[1],M[1],T[1],k[1]),D=[];D.push("M11=",x[0]/w,yD,"M12=",x[2]/S,yD,"M21=",x[1]/w,yD,"M22=",x[3]/S,yD,"Dx=",fD(u*w+x[4]),yD,"Dy=",fD(c*S+x[5])),b.padding="0 "+fD(A)+"px "+fD(I)+"px 0",b.filter=xD+".Matrix("+D.join("")+", SizingMethod=clip)"}else x&&(u=u*w+x[4],c=c*S+x[5]),b.filter="",b.left=fD(u)+"px",b.top=fD(c)+"px";var O=this._imageEl,P=this._cropEl;O||(O=uD.createElement("div"),this._imageEl=O);var E=O.style;if(v){if(e&&n)E.width=fD(w*e*d/h)+"px",E.height=fD(S*n*f/p)+"px";else{var R=new Image,L=this;R.onload=function(){R.onload=null,n=R.height,E.width=fD(w*(e=R.width)*d/h)+"px",E.height=fD(S*n*f/p)+"px",L._imageWidth=e,L._imageHeight=n,L._imageSrc=i},R.src=i}P||((P=uD.createElement("div")).style.overflow="hidden",this._cropEl=P);var N=P.style;N.width=fD((d+g*d/h)*w),N.height=fD((f+m*f/p)*S),N.filter=xD+".Matrix(Dx="+-g*d/h*w+",Dy="+-m*f/p*S+")",P.parentNode||y.appendChild(P),O.parentNode!==P&&P.appendChild(O)}else E.width=fD(w*d)+"px",E.height=fD(S*f)+"px",y.appendChild(O),P&&P.parentNode&&(y.removeChild(P),this._cropEl=null);var B="",z=r.opacity;z<1&&(B+=".Alpha(opacity="+fD(100*z)+") "),E.filter=B+=xD+".AlphaImageLoader(src="+i+", SizingMethod=scale)",y.style.zIndex=TD(this.zlevel,this.z,this.z2),CD(t,y),null!=r.text&&this.drawRectText(t,this.getBoundingRect())}},Wr.prototype.onRemove=function(t){MD(t,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(t)},Wr.prototype.onAdd=function(t){CD(t,this._vmlEl),this.appendRectText(t)};var OD,PD="normal",ED={},RD=0,LD=document.createElement("div");nr.measureText=function(t,e){var n=uD;OD||((OD=n.createElement("div")).style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",uD.body.appendChild(OD));try{OD.style.font=e}catch(t){}return OD.innerHTML="",OD.appendChild(n.createTextNode(t)),{width:OD.offsetWidth}};for(var ND=new Sn,BD=function(t,e,n,r){var i=this.style;this.__dirty&&Cr(i);var o=i.text;if(null!=o&&(o+=""),o){if(i.rich){var a=pr(o,i);o=[];for(var s=0;s<a.lines.length;s++){for(var l=a.lines[s].tokens,u=[],c=0;c<l.length;c++)u.push(l[c].text);o.push(u.join(""))}o=o.join("\n")}var d,f,h=i.textAlign,p=i.textVerticalAlign,g=function(t){var e=ED[t];if(!e){100<RD&&(RD=0,ED={});var n,r=LD.style;try{r.font=t,n=r.fontFamily.split(",")[0]}catch(t){}e={style:r.fontStyle||PD,variant:r.fontVariant||PD,weight:r.fontWeight||PD,size:0|parseFloat(r.fontSize||12),family:n||"Microsoft YaHei"},ED[t]=e,RD++}return e}(i.font),m=g.style+" "+g.variant+" "+g.weight+" "+g.size+'px "'+g.family+'"';n=n||ir(o,m,h,p,i.textPadding,i.textLineHeight);var v=this.transform;if(v&&!r&&(ND.copy(e),ND.applyTransform(v),e=ND),r)d=e.x,f=e.y;else{var y=i.textPosition;if(y instanceof Array)d=e.x+kD(y[0],e.width),f=e.y+kD(y[1],e.height),h=h||"left";else{var x=this.calculateTextPosition?this.calculateTextPosition({},i,e):sr({},i,e);d=x.x,f=x.y,h=h||x.textAlign,p=p||x.textVerticalAlign}}d=or(d,n.width,h),f=ar(f,n.height,p),f+=n.height/2;var b,_,w,S=cD,C=this._textVmlEl;C?_=(b=(w=C.firstChild).nextSibling).nextSibling:(C=S("line"),b=S("path"),_=S("textpath"),w=S("skew"),_.style["v-text-align"]="left",wD(C),b.textpathok=!0,_.on=!0,C.from="0 0",C.to="1000 0.05",CD(C,w),CD(C,b),CD(C,_),this._textVmlEl=C);var M=[d,f],T=C.style;v&&r?(bt(M,M,v),w.on=!0,w.matrix=v[0].toFixed(3)+yD+v[2].toFixed(3)+yD+v[1].toFixed(3)+yD+v[3].toFixed(3)+",0,0",w.offset=(fD(M[0])||0)+","+(fD(M[1])||0),w.origin="0 0",T.left="0px",T.top="0px"):(w.on=!1,T.left=fD(d)+"px",T.top=fD(f)+"px"),_.string=function(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}(o);try{_.style.font=m}catch(t){}ID(C,"fill",{fill:i.textFill,opacity:i.opacity},this),ID(C,"stroke",{stroke:i.textStroke,opacity:i.opacity,lineDash:i.lineDash||null},this),C.style.zIndex=TD(this.zlevel,this.z,this.z2),CD(t,C)}},zD=function(t){MD(t,this._textVmlEl),this._textVmlEl=null},VD=function(t){CD(t,this._textVmlEl)},FD=[Vr,Hr,Wr,ha,Da],HD=0;HD<FD.length;HD++){var WD=FD[HD].prototype;WD.drawRectText=BD,WD.removeRectText=zD,WD.appendRectText=VD}Da.prototype.brushVML=function(t){var e=this.style;null!=e.text?this.drawRectText(t,{x:e.x||0,y:e.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(t)},Da.prototype.onRemove=function(t){this.removeRectText(t)},Da.prototype.onAdd=function(t){this.appendRectText(t)}}function jD(t){return parseInt(t,10)}function GD(t,e){!function(){if(!lD&&uD){lD=!0;var t=uD.styleSheets;t.length<31?uD.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):t[0].addRule(".zrvml","behavior:url(#default#VML)")}}(),this.root=t,this.storage=e;var n=document.createElement("div"),r=document.createElement("div");n.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",r.style.cssText="position:absolute;left:0;top:0;",t.appendChild(n),this._vmlRoot=r,this._vmlViewport=n,this.resize();var i=e.delFromStorage,o=e.addToStorage;e.delFromStorage=function(t){i.call(e,t),t&&t.onRemove&&t.onRemove(r)},e.addToStorage=function(t){t.onAdd&&t.onAdd(r),o.call(e,t)},this._firstPaint=!0}function UD(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}GD.prototype={constructor:GD,getType:function(){return"vml"},getViewportRoot:function(){return this._vmlViewport},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(){var t=this.storage.getDisplayList(!0,!0);this._paintList(t)},_paintList:function(t){for(var e=this._vmlRoot,n=0;n<t.length;n++){var r=t[n];r.invisible||r.ignore?(r.__alreadyNotVisible||r.onRemove(e),r.__alreadyNotVisible=!0):(r.__alreadyNotVisible&&r.onAdd(e),r.__alreadyNotVisible=!1,r.__dirty&&(r.beforeBrush&&r.beforeBrush(),(r.brushVML||r.brush).call(r,e),r.afterBrush&&r.afterBrush())),r.__dirty=!1}this._firstPaint&&(this._vmlViewport.appendChild(e),this._firstPaint=!1)},resize:function(t,e){if(t=null==t?this._getWidth():t,e=null==e?this._getHeight():e,this._width!==t||this._height!==e){this._width=t,this._height=e;var n=this._vmlViewport.style;n.width=t+"px",n.height=e+"px"}},dispose:function(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null},getWidth:function(){return this._width},getHeight:function(){return this._height},clear:function(){this._vmlViewport&&this.root.removeChild(this._vmlViewport)},_getWidth:function(){var t=this.root,e=t.currentStyle;return(t.clientWidth||jD(e.width))-jD(e.paddingLeft)-jD(e.paddingRight)|0},_getHeight:function(){var t=this.root,e=t.currentStyle;return(t.clientHeight||jD(e.height))-jD(e.paddingTop)-jD(e.paddingBottom)|0}},k(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(t){GD.prototype[t]=function(){}}),xi("vml",GD);var qD=Xo.CMD,XD=Array.prototype.join,YD="none",$D=Math.round,ZD=Math.sin,KD=Math.cos,JD=Math.PI,QD=2*Math.PI,tO=180/JD,eO=1e-4;function nO(t){return $D(1e4*t)/1e4}function rO(t){return t<eO&&-eO<t}function iO(t,e){e&&oO(t,"transform","matrix("+XD.call(e,",")+")")}function oO(t,e,n){n&&("linear"===n.type||"radial"===n.type)||t.setAttribute(e,n)}function aO(t,e,n,r){if(function(t,e){var n=e?t.textFill:t.fill;return null!=n&&n!==YD}(e,n)){var i=n?e.textFill:e.fill;oO(t,"fill",i="transparent"===i?YD:i),oO(t,"fill-opacity",null!=e.fillOpacity?e.fillOpacity*e.opacity:e.opacity)}else oO(t,"fill",YD);if(function(t,e){var n=e?t.textStroke:t.stroke;return null!=n&&n!==YD}(e,n)){var o=n?e.textStroke:e.stroke;oO(t,"stroke",o="transparent"===o?YD:o),oO(t,"stroke-width",(n?e.textStrokeWidth:e.lineWidth)/(!n&&e.strokeNoScale?r.getLineScale():1)),oO(t,"paint-order",n?"stroke":"fill"),oO(t,"stroke-opacity",null!=e.strokeOpacity?e.strokeOpacity:e.opacity),e.lineDash?(oO(t,"stroke-dasharray",e.lineDash.join(",")),oO(t,"stroke-dashoffset",$D(e.lineDashOffset||0))):oO(t,"stroke-dasharray",""),e.lineCap&&oO(t,"stroke-linecap",e.lineCap),e.lineJoin&&oO(t,"stroke-linejoin",e.lineJoin),e.miterLimit&&oO(t,"stroke-miterlimit",e.miterLimit)}else oO(t,"stroke",YD)}var sO={brush:function(t){var e=t.style,n=t.__svgEl;n||(n=UD("path"),t.__svgEl=n),t.path||t.createPathProxy();var r=t.path;if(t.__dirtyPath){r.beginPath(),r.subPixelOptimize=!1,t.buildPath(r,t.shape),t.__dirtyPath=!1;var i=function(t){for(var e=[],n=t.data,r=t.len(),i=0;i<r;){var o="",a=0;switch(n[i++]){case qD.M:o="M",a=2;break;case qD.L:o="L",a=2;break;case qD.Q:o="Q",a=4;break;case qD.C:o="C",a=6;break;case qD.A:var s=n[i++],l=n[i++],u=n[i++],c=n[i++],d=n[i++],f=n[i++],h=n[i++],p=n[i++],g=Math.abs(f),m=rO(g-QD)||(p?QD<=f:QD<=-f),v=0<f?f%QD:f%QD+QD,y=!1;y=!!m||!rO(g)&&JD<=v==!!p;var x=nO(s+u*KD(d)),b=nO(l+c*ZD(d));m&&(f=p?QD-1e-4:1e-4-QD,y=!0,9===i&&e.push("M",x,b));var _=nO(s+u*KD(d+f)),w=nO(l+c*ZD(d+f));e.push("A",nO(u),nO(c),$D(h*tO),+y,+p,_,w);break;case qD.Z:o="Z";break;case qD.R:_=nO(n[i++]),w=nO(n[i++]);var S=nO(n[i++]),C=nO(n[i++]);e.push("M",_,w,"L",_+S,w,"L",_+S,w+C,"L",_,w+C,"L",_,w)}o&&e.push(o);for(var M=0;M<a;M++)e.push(nO(n[i++]))}return e.join(" ")}(r);i.indexOf("NaN")<0&&oO(n,"d",i)}aO(n,e,!1,t),iO(n,t.transform),null!=e.text?pO(t,t.getBoundingRect()):mO(t)}},lO={brush:function(t){var e=t.style,n=e.image;if(n instanceof HTMLImageElement&&(n=n.src),n){var r=e.x||0,i=e.y||0,o=e.width,a=e.height,s=t.__svgEl;s||(s=UD("image"),t.__svgEl=s),n!==t.__imageSrc&&(function(t,e,n){t.setAttributeNS("http://www.w3.org/1999/xlink","href",n)}(s,0,n),t.__imageSrc=n),oO(s,"width",o),oO(s,"height",a),oO(s,"x",r),oO(s,"y",i),iO(s,t.transform),null!=e.text?pO(t,t.getBoundingRect()):mO(t)}}},uO={},cO=new Sn,dO={},fO=[],hO={left:"start",right:"end",center:"middle",middle:"middle"},pO=function(t,e){var n=t.style,r=t.transform,i=t instanceof Da||n.transformText;t.__dirty&&Cr(n);var o=n.text;if(null!=o&&(o+=""),zr(o,n)){null==o&&(o=""),!i&&r&&(cO.copy(e),cO.applyTransform(r),e=cO);var a=t.__textSvgEl;a||(a=UD("text"),t.__textSvgEl=a);var s=a.style,l=n.font||er,u=a.__computedFont;l!==a.__styleFont&&(s.font=a.__styleFont=l,u=a.__computedFont=s.font);var c=n.textPadding,d=t.__textCotentBlock;d&&!t.__dirtyText||(d=t.__textCotentBlock=hr(o,u,c,n.textLineHeight,n.truncate));var f=d.outerHeight,h=d.lineHeight;Pr(dO,t,n,e);var p=dO.baseX,g=dO.baseY,m=dO.textAlign||"left",v=dO.textVerticalAlign;!function(t,e,n,r,i,o,a){ie(fO),e&&n&&oe(fO,n);var s=r.textRotation;if(i&&s){var l=r.textOrigin;"center"===l?(o=i.width/2+i.x,a=i.height/2+i.y):l&&(o=l[0]+i.x,a=l[1]+i.y),fO[4]-=o,fO[5]-=a,le(fO,fO,s),fO[4]+=o,fO[5]+=a}iO(t,fO)}(a,i,r,n,e,p,g);var y=p,x=ar(g,f,v);c&&(y=function(t,e,n){return"right"===e?t-n[1]:"center"===e?t+n[3]/2-n[1]/2:t+n[3]}(p,m,c),x+=c[0]),x+=h/2,aO(a,n,!0,t);var b=d.canCacheByTextString,_=t.__tspanList||(t.__tspanList=[]),w=_.length;if(b&&t.__canCacheByTextString&&t.__text===o){if(t.__dirtyText&&w)for(var S=0;S<w;++S)gO(_[S],m,y,x+S*h)}else{t.__text=o,t.__canCacheByTextString=b;var C=d.lines,M=C.length;for(S=0;S<M;S++){var T=_[S],k=C[S];T?T.__zrText!==k&&(T.innerHTML="",T.appendChild(document.createTextNode(k))):(T=_[S]=UD("tspan"),a.appendChild(T),T.appendChild(document.createTextNode(k))),gO(T,m,y,x+S*h)}if(M<w){for(;S<w;S++)a.removeChild(_[S]);_.length=M}}}};function gO(t,e,n,r){oO(t,"dominant-baseline","middle"),oO(t,"text-anchor",hO[e]),oO(t,"x",n),oO(t,"y",r)}function mO(t){t&&t.__textSvgEl&&(t.__textSvgEl.parentNode&&t.__textSvgEl.parentNode.removeChild(t.__textSvgEl),t.__textSvgEl=null,t.__tspanList=[],t.__text=null)}function vO(){}function yO(t,e){for(var n=0,r=e.length,i=0,o=0;n<r;n++){var a=e[n];if(a.removed){for(s=[],l=o;l<o+a.count;l++)s.push(l);a.indices=s,o+=a.count}else{for(var s=[],l=i;l<i+a.count;l++)s.push(l);a.indices=s,i+=a.count,a.added||(o+=a.count)}}return e}uO.drawRectText=pO,uO.brush=function(t){null!=t.style.text?pO(t,!1):mO(t)},vO.prototype={diff:function(t,e,n){this.equals=n=n||function(t,e){return t===e};var r=this;t=t.slice();var i=(e=e.slice()).length,o=t.length,a=1,s=i+o,l=[{newPos:-1,components:[]}],u=this.extractCommon(l[0],e,t,0);if(l[0].newPos+1>=i&&o<=u+1){for(var c=[],d=0;d<e.length;d++)c.push(d);return[{indices:c,count:e.length}]}function f(){for(var n=-1*a;n<=a;n+=2){var s,u=l[n-1],c=l[n+1],d=(c?c.newPos:0)-n;u&&(l[n-1]=void 0);var f=u&&u.newPos+1<i,h=c&&0<=d&&d<o;if(f||h){if(!f||h&&u.newPos<c.newPos?(s={newPos:(p=c).newPos,components:p.components.slice(0)},r.pushComponent(s.components,void 0,!0)):((s=u).newPos++,r.pushComponent(s.components,!0,void 0)),d=r.extractCommon(s,e,t,n),s.newPos+1>=i&&o<=d+1)return yO(0,s.components);l[n]=s}else l[n]=void 0}var p;a++}for(;a<=s;){var h=f();if(h)return h}},pushComponent:function(t,e,n){var r=t[t.length-1];r&&r.added===e&&r.removed===n?t[t.length-1]={count:r.count+1,added:e,removed:n}:t.push({count:1,added:e,removed:n})},extractCommon:function(t,e,n,r){for(var i=e.length,o=n.length,a=t.newPos,s=a-r,l=0;a+1<i&&s+1<o&&this.equals(e[a+1],n[s+1]);)a++,s++,l++;return l&&t.components.push({count:l}),t.newPos=a,s},tokenize:function(t){return t.slice()},join:function(t){return t.slice()}};var xO=new vO;function bO(t,e,n,r,i){this._zrId=t,this._svgRoot=e,this._tagNames="string"==typeof n?[n]:n,this._markLabel=r,this._domName=i||"_dom",this.nextId=0}function _O(t,e){bO.call(this,t,e,["linearGradient","radialGradient"],"__gradient_in_use__")}function wO(t,e){bO.call(this,t,e,"clipPath","__clippath_in_use__")}function SO(t,e){bO.call(this,t,e,["filter"],"__filter_in_use__","_shadowDom")}function CO(t){return t&&(t.shadowBlur||t.shadowOffsetX||t.shadowOffsetY||t.textShadowBlur||t.textShadowOffsetX||t.textShadowOffsetY)}function MO(t){return parseInt(t,10)}function TO(t,e){return e&&t&&e.parentNode!==t}function kO(t,e,n){if(TO(t,e)&&n){var r=n.nextSibling;r?t.insertBefore(e,r):t.appendChild(e)}}function AO(t,e){if(TO(t,e)){var n=t.firstChild;n?t.insertBefore(e,n):t.appendChild(e)}}function IO(t,e){e&&t&&e.parentNode===t&&t.removeChild(e)}function DO(t){return t.__textSvgEl}function OO(t){return t.__svgEl}function PO(t,e,n,r){this.root=t,this.storage=e,this._opts=n=x({},n||{});var i=UD("svg");i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("version","1.1"),i.setAttribute("baseProfile","full"),i.style.cssText="user-select:none;position:absolute;left:0;top:0;";var o=UD("g");i.appendChild(o);var a=UD("g");i.appendChild(a),this.gradientManager=new _O(r,a),this.clipPathManager=new wO(r,a),this.shadowManager=new SO(r,a);var s=document.createElement("div");s.style.cssText="overflow:hidden;position:relative",this._svgDom=i,this._svgRoot=a,this._backgroundRoot=o,this._viewport=s,t.appendChild(s),s.appendChild(i),this.resize(n.width,n.height),this._visibleList=[]}bO.prototype.createElement=UD,bO.prototype.getDefs=function(t){var e=this._svgRoot,n=this._svgRoot.getElementsByTagName("defs");return 0===n.length?t?((n=e.insertBefore(this.createElement("defs"),e.firstChild)).contains||(n.contains=function(t){var e=n.children;if(!e)return!1;for(var r=e.length-1;0<=r;--r)if(e[r]===t)return!0;return!1}),n):null:n[0]},bO.prototype.update=function(t,e){if(t){var n=this.getDefs(!1);if(t[this._domName]&&n.contains(t[this._domName]))"function"==typeof e&&e(t);else{var r=this.add(t);r&&(t[this._domName]=r)}}},bO.prototype.addDom=function(t){this.getDefs(!0).appendChild(t)},bO.prototype.removeDom=function(t){var e=this.getDefs(!1);e&&t[this._domName]&&(e.removeChild(t[this._domName]),t[this._domName]=null)},bO.prototype.getDoms=function(){var t=this.getDefs(!1);if(!t)return[];var e=[];return k(this._tagNames,function(n){var r=t.getElementsByTagName(n);e=e.concat([].slice.call(r))}),e},bO.prototype.markAllUnused=function(){var t=this.getDoms(),e=this;k(t,function(t){t[e._markLabel]="0"})},bO.prototype.markUsed=function(t){t&&(t[this._markLabel]="1")},bO.prototype.removeUnused=function(){var t=this.getDefs(!1);if(t){var e=this.getDoms(),n=this;k(e,function(e){"1"!==e[n._markLabel]&&t.removeChild(e)})}},bO.prototype.getSvgProxy=function(t){return t instanceof ha?sO:t instanceof Wr?lO:t instanceof Da?uO:sO},bO.prototype.getTextSvgElement=function(t){return t.__textSvgEl},bO.prototype.getSvgElement=function(t){return t.__svgEl},C(_O,bO),_O.prototype.addWithoutUpdate=function(t,e){if(e&&e.style){var n=this;k(["fill","stroke"],function(r){if(e.style[r]&&("linear"===e.style[r].type||"radial"===e.style[r].type)){var i,o=e.style[r],a=n.getDefs(!0);o._dom?(i=o._dom,a.contains(o._dom)||n.addDom(i)):i=n.add(o),n.markUsed(e);var s=i.getAttribute("id");t.setAttribute(r,"url(#"+s+")")}})}},_O.prototype.add=function(t){var e;if("linear"===t.type)e=this.createElement("linearGradient");else{if("radial"!==t.type)return null;e=this.createElement("radialGradient")}return t.id=t.id||this.nextId++,e.setAttribute("id","zr"+this._zrId+"-gradient-"+t.id),this.updateDom(t,e),this.addDom(e),e},_O.prototype.update=function(t){var e=this;bO.prototype.update.call(this,t,function(){var n=t.type,r=t._dom.tagName;"linear"===n&&"linearGradient"===r||"radial"===n&&"radialGradient"===r?e.updateDom(t,t._dom):(e.removeDom(t),e.add(t))})},_O.prototype.updateDom=function(t,e){if("linear"===t.type)e.setAttribute("x1",t.x),e.setAttribute("y1",t.y),e.setAttribute("x2",t.x2),e.setAttribute("y2",t.y2);else{if("radial"!==t.type)return;e.setAttribute("cx",t.x),e.setAttribute("cy",t.y),e.setAttribute("r",t.r)}e.setAttribute("gradientUnits",t.global?"userSpaceOnUse":"objectBoundingBox"),e.innerHTML="";for(var n=t.colorStops,r=0,i=n.length;r<i;++r){var o=this.createElement("stop");o.setAttribute("offset",100*n[r].offset+"%");var a=n[r].color;if(-1<a.indexOf("rgba")){var s=Ve(a)[3],l=We(a);o.setAttribute("stop-color","#"+l),o.setAttribute("stop-opacity",s)}else o.setAttribute("stop-color",n[r].color);e.appendChild(o)}t._dom=e},_O.prototype.markUsed=function(t){if(t.style){var e=t.style.fill;e&&e._dom&&bO.prototype.markUsed.call(this,e._dom),(e=t.style.stroke)&&e._dom&&bO.prototype.markUsed.call(this,e._dom)}},C(wO,bO),wO.prototype.update=function(t){var e=this.getSvgElement(t);e&&this.updateDom(e,t.__clipPaths,!1);var n=this.getTextSvgElement(t);n&&this.updateDom(n,t.__clipPaths,!0),this.markUsed(t)},wO.prototype.updateDom=function(t,e,n){if(e&&0<e.length){var r,i,o=this.getDefs(!0),a=e[0],s=n?"_textDom":"_dom";a[s]?(i=a[s].getAttribute("id"),o.contains(r=a[s])||o.appendChild(r)):(i="zr"+this._zrId+"-clip-"+this.nextId,++this.nextId,(r=this.createElement("clipPath")).setAttribute("id",i),o.appendChild(r),a[s]=r);var l=this.getSvgProxy(a);if(a.transform&&a.parent.invTransform&&!n){var u=Array.prototype.slice.call(a.transform);ae(a.transform,a.parent.invTransform,a.transform),l.brush(a),a.transform=u}else l.brush(a);var c=this.getSvgElement(a);r.innerHTML="",r.appendChild(c.cloneNode()),t.setAttribute("clip-path","url(#"+i+")"),1<e.length&&this.updateDom(r,e.slice(1),n)}else t&&t.setAttribute("clip-path","none")},wO.prototype.markUsed=function(t){var e=this;t.__clipPaths&&k(t.__clipPaths,function(t){t._dom&&bO.prototype.markUsed.call(e,t._dom),t._textDom&&bO.prototype.markUsed.call(e,t._textDom)})},C(SO,bO),SO.prototype.addWithoutUpdate=function(t,e){if(e&&CO(e.style)){var n;e._shadowDom?(n=e._shadowDom,this.getDefs(!0).contains(e._shadowDom)||this.addDom(n)):n=this.add(e),this.markUsed(e);var r=n.getAttribute("id");t.style.filter="url(#"+r+")"}},SO.prototype.add=function(t){var e=this.createElement("filter");return t._shadowDomId=t._shadowDomId||this.nextId++,e.setAttribute("id","zr"+this._zrId+"-shadow-"+t._shadowDomId),this.updateDom(t,e),this.addDom(e),e},SO.prototype.update=function(t,e){if(CO(e.style)){var n=this;bO.prototype.update.call(this,e,function(){n.updateDom(e,e._shadowDom)})}else this.remove(t,e)},SO.prototype.remove=function(t,e){null!=e._shadowDomId&&(this.removeDom(t),t.style.filter="")},SO.prototype.updateDom=function(t,e){var n=e.getElementsByTagName("feDropShadow");n=0===n.length?this.createElement("feDropShadow"):n[0];var r,i,o,a,s=t.style,l=t.scale&&t.scale[0]||1,u=t.scale&&t.scale[1]||1;if(s.shadowBlur||s.shadowOffsetX||s.shadowOffsetY)r=s.shadowOffsetX||0,i=s.shadowOffsetY||0,o=s.shadowBlur,a=s.shadowColor;else{if(!s.textShadowBlur)return void this.removeDom(e,s);r=s.textShadowOffsetX||0,i=s.textShadowOffsetY||0,o=s.textShadowBlur,a=s.textShadowColor}n.setAttribute("dx",r/l),n.setAttribute("dy",i/u),n.setAttribute("flood-color",a),n.setAttribute("stdDeviation",o/2/l+" "+o/2/u),e.setAttribute("x","-100%"),e.setAttribute("y","-100%"),e.setAttribute("width",Math.ceil(o/2*200)+"%"),e.setAttribute("height",Math.ceil(o/2*200)+"%"),e.appendChild(n),t._shadowDom=e},SO.prototype.markUsed=function(t){t._shadowDom&&bO.prototype.markUsed.call(this,t._shadowDom)},PO.prototype={constructor:PO,getType:function(){return"svg"},getViewportRoot:function(){return this._viewport},getSvgDom:function(){return this._svgDom},getSvgRoot:function(){return this._svgRoot},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(){var t=this.storage.getDisplayList(!0);this._paintList(t)},setBackgroundColor:function(t){this._backgroundRoot&&this._backgroundNode&&this._backgroundRoot.removeChild(this._backgroundNode);var e=UD("rect");e.setAttribute("width",this.getWidth()),e.setAttribute("height",this.getHeight()),e.setAttribute("x",0),e.setAttribute("y",0),e.setAttribute("id",0),e.style.fill=t,this._backgroundRoot.appendChild(e),this._backgroundNode=e},_paintList:function(t){this.gradientManager.markAllUnused(),this.clipPathManager.markAllUnused(),this.shadowManager.markAllUnused();var e,n,r=this._svgRoot,i=this._visibleList,o=t.length,a=[];for(e=0;e<o;e++){var s=t[e],l=(n=s)instanceof ha?sO:n instanceof Wr?lO:n instanceof Da?uO:sO,u=OO(s)||DO(s);s.invisible||(s.__dirty&&(l&&l.brush(s),this.clipPathManager.update(s),s.style&&(this.gradientManager.update(s.style.fill),this.gradientManager.update(s.style.stroke),this.shadowManager.update(u,s)),s.__dirty=!1),a.push(s))}var c,d=function(t,e,n){return xO.diff(t,e,void 0)}(i,a);for(e=0;e<d.length;e++)if((p=d[e]).removed)for(var f=0;f<p.count;f++){u=OO(s=i[p.indices[f]]);var h=DO(s);IO(r,u),IO(r,h)}for(e=0;e<d.length;e++){var p;if((p=d[e]).added)for(f=0;f<p.count;f++)u=OO(s=a[p.indices[f]]),h=DO(s),c?kO(r,u,c):AO(r,u),u?kO(r,h,u):c?kO(r,h,c):AO(r,h),kO(r,h,u),c=h||u||c,this.gradientManager.addWithoutUpdate(u||h,s),this.shadowManager.addWithoutUpdate(u||h,s),this.clipPathManager.markUsed(s);else if(!p.removed)for(f=0;f<p.count;f++)u=OO(s=a[p.indices[f]]),h=DO(s),u=OO(s),h=DO(s),this.gradientManager.markUsed(s),this.gradientManager.addWithoutUpdate(u||h,s),this.shadowManager.markUsed(s),this.shadowManager.addWithoutUpdate(u||h,s),this.clipPathManager.markUsed(s),h&&kO(r,h,u),c=u||h||c}this.gradientManager.removeUnused(),this.clipPathManager.removeUnused(),this.shadowManager.removeUnused(),this._visibleList=a},_getDefs:function(t){var e,n=this._svgDom;return 0!==(e=n.getElementsByTagName("defs")).length?e[0]:t?((e=n.insertBefore(UD("defs"),n.firstChild)).contains||(e.contains=function(t){var n=e.children;if(!n)return!1;for(var r=n.length-1;0<=r;--r)if(n[r]===t)return!0;return!1}),e):null},resize:function(t,e){var n=this._viewport;n.style.display="none";var r=this._opts;if(null!=t&&(r.width=t),null!=e&&(r.height=e),t=this._getSize(0),e=this._getSize(1),n.style.display="",this._width!==t||this._height!==e){this._width=t,this._height=e;var i=n.style;i.width=t+"px",i.height=e+"px";var o=this._svgDom;o.setAttribute("width",t),o.setAttribute("height",e)}this._backgroundNode&&(this._backgroundNode.setAttribute("width",t),this._backgroundNode.setAttribute("height",e))},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(t){var e=this._opts,n=["width","height"][t],r=["clientWidth","clientHeight"][t],i=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(null!=e[n]&&"auto"!==e[n])return parseFloat(e[n]);var a=this.root,s=document.defaultView.getComputedStyle(a);return(a[r]||MO(s[n])||MO(a.style[n]))-(MO(s[i])||0)-(MO(s[o])||0)|0},dispose:function(){this.root.innerHTML="",this._svgRoot=this._backgroundRoot=this._svgDom=this._backgroundNode=this._viewport=this.storage=null},clear:function(){this._viewport&&this.root.removeChild(this._viewport)},toDataURL:function(){return this.refresh(),"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(this._svgDom.outerHTML.replace(/></g,">\n\r<"))}},k(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","pathToImage"],function(t){PO.prototype[t]=function(){}}),xi("svg",PO),t.version="4.9.0",t.dependencies={zrender:"4.3.2"},t.PRIORITY=ff,t.init=function(t,e,n){var r=Kf(t);if(r)return r;var i=new yf(t,e,n);return i.id="ec_"+qf++,Gf[i.id]=i,Vi(t,Yf,i.id),function(t){var e="__connectUpdateStatus";function n(t,n){for(var r=0;r<t.length;r++)t[r][e]=n}lf(Bf,function(r,i){t._messageCenter.on(i,function(r){if(Uf[t.group]&&0!==t[e]){if(r&&r.escapeConnect)return;var i=t.makeActionFromEvent(r),o=[];lf(Gf,function(e){e!==t&&e.group===t.group&&o.push(e)}),n(o,0),lf(o,function(t){1!==t[e]&&t.dispatchAction(i)}),n(o,2)}})})}(i),i},t.connect=function(t){if(R(t)){var e=t;t=null,lf(e,function(e){null!=e.group&&(t=e.group)}),t=t||"g_"+Xf++,lf(e,function(e){e.group=t})}return Uf[t]=!0,t},t.disConnect=$f,t.disconnect=Zf,t.dispose=function(t){"string"==typeof t?t=Gf[t]:t instanceof yf||(t=Kf(t)),t instanceof yf&&!t.isDisposed()&&t.dispose()},t.getInstanceByDom=Kf,t.getInstanceById=function(t){return Gf[t]},t.registerTheme=Jf,t.registerPreprocessor=Qf,t.registerProcessor=th,t.registerPostUpdate=function(t){Ff.push(t)},t.registerAction=eh,t.registerCoordinateSystem=nh,t.getCoordinateSystemDimensions=function(t){var e=Uu.get(t);if(e)return e.getDimensionsInfo?e.getDimensionsInfo():e.dimensions.slice()},t.registerLayout=rh,t.registerVisual=ih,t.registerLoading=ah,t.extendComponentModel=sh,t.extendComponentView=lh,t.extendSeriesModel=uh,t.extendChartView=ch,t.setCanvasCreator=function(t){g("createCanvas",t)},t.registerMap=function(t,e,n){!function(t,e,n){var r;k(r=R(e)?e:e.svg?[{type:"svg",source:e.svg,specialAreas:e.specialAreas}]:(e.geoJson&&!e.features&&(n=e.specialAreas,e=e.geoJson),[{type:"geoJSON",source:e,specialAreas:n}]),function(t){var e=t.type;"geoJson"===e&&(e=t.type="geoJSON"),(0,af[e])(t)}),rf.set(t,r)}(t,e,n)},t.getMap=function(t){var e=of(t);return e&&e[0]&&{geoJson:e[0].geoJSON,specialAreas:e[0].specialAreas}},t.dataTool={},t.zrender=_i,t.number=Bl,t.format=tu,t.throttle=fd,t.helper=ng,t.matrix=fe,t.vector=St,t.color=Ye,t.parseGeoJSON=sg,t.parseGeoJson=yg,t.util=xg,t.graphic=bg,t.List=Ah,t.Model=hl,t.Axis=mg,t.env=i}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("echarts")):"function"==typeof define&&define.amd?define(["exports","echarts"],e):e(t.bmap={},t.echarts)}(this,function(t,e){"use strict";function n(t,e){this._bmap=t,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=e,this._projection=new BMap.MercatorProjection}function r(t,n){return n=n||[0,0],e.util.map([0,1],function(e){var r=n[e],i=t[e]/2,o=[],a=[];return o[e]=r-i,a[e]=r+i,o[1-e]=a[1-e]=n[1-e],Math.abs(this.dataToPoint(o)[e]-this.dataToPoint(a)[e])},this)}var i;function o(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}n.prototype.dimensions=["lng","lat"],n.prototype.setZoom=function(t){this._zoom=t},n.prototype.setCenter=function(t){this._center=this._projection.lngLatToPoint(new BMap.Point(t[0],t[1]))},n.prototype.setMapOffset=function(t){this._mapOffset=t},n.prototype.getBMap=function(){return this._bmap},n.prototype.dataToPoint=function(t){var e=new BMap.Point(t[0],t[1]),n=this._bmap.pointToOverlayPixel(e),r=this._mapOffset;return[n.x-r[0],n.y-r[1]]},n.prototype.pointToData=function(t){var e=this._mapOffset;return[(t=this._bmap.overlayPixelToPoint({x:t[0]+e[0],y:t[1]+e[1]})).lng,t.lat]},n.prototype.getViewRect=function(){var t=this._api;return new e.graphic.BoundingRect(0,0,t.getWidth(),t.getHeight())},n.prototype.getRoamTransform=function(){return e.matrix.create()},n.prototype.prepareCustoms=function(t){var n=this.getViewRect();return{coordSys:{type:"bmap",x:n.x,y:n.y,width:n.width,height:n.height},api:{coord:e.util.bind(this.dataToPoint,this),size:e.util.bind(r,this)}}},n.dimensions=n.prototype.dimensions,n.create=function(t,e){var r,o=e.getDom();t.eachComponent("bmap",function(t){var a=e.getZr().painter,s=a.getViewportRoot();if("undefined"==typeof BMap)throw new Error("BMap api is not loaded");if(i=i||function(){function t(t){this._root=t}return(t.prototype=new BMap.Overlay).initialize=function(t){return t.getPanes().labelPane.appendChild(this._root),this._root},t.prototype.draw=function(){},t}(),r)throw new Error("Only one bmap component can exist");if(!t.__bmap){var l=o.querySelector(".ec-extension-bmap");l&&(s.style.left="0px",s.style.top="0px",o.removeChild(l)),(l=document.createElement("div")).style.cssText="width:100%;height:100%",l.classList.add("ec-extension-bmap"),o.appendChild(l);var u=t.get("mapOptions")||{};delete u.mapType;var c=t.__bmap=new BMap.Map(l,u),d=new i(s);c.addOverlay(d),a.getViewportRootOffset=function(){return{offsetLeft:0,offsetTop:0}}}c=t.__bmap;var f=t.get("center"),h=t.get("zoom");if(f&&h){var p=c.getCenter(),g=c.getZoom();if(t.centerOrZoomChanged([p.lng,p.lat],g)){var m=new BMap.Point(f[0],f[1]);c.centerAndZoom(m,h)}}(r=new n(c,e)).setMapOffset(t.__mapOffset||[0,0]),r.setZoom(h),r.setCenter(f),t.coordinateSystem=r}),t.eachSeries(function(t){"bmap"===t.get("coordinateSystem")&&(t.coordinateSystem=r)})},e.extendComponentModel({type:"bmap",getBMap:function(){return this.__bmap},setCenterAndZoom:function(t,e){this.option.center=t,this.option.zoom=e},centerOrZoomChanged:function(t,e){var n=this.option;return!(function(t,e){return t&&e&&t[0]===e[0]&&t[1]===e[1]}(t,n.center)&&e===n.zoom)},defaultOption:{center:[104.114129,37.550339],zoom:5,mapStyle:{},mapStyleV2:{},mapOptions:{},roam:!1}}),e.extendComponentView({type:"bmap",render:function(t,n,r){function i(e,n){if(!a){var i=l.parentNode.parentNode.parentNode,o=[-parseInt(i.style.left,10)||0,-parseInt(i.style.top,10)||0];l.style.left=o[0]+"px",l.style.top=o[1]+"px",u.setMapOffset(o),t.__mapOffset=o,r.dispatchAction({type:"bmapRoam"})}}var a=!0,s=t.getBMap(),l=r.getZr().painter.getViewportRoot(),u=t.coordinateSystem;function c(){a||r.dispatchAction({type:"bmapRoam"})}s.removeEventListener("moving",this._oldMoveHandler),s.removeEventListener("moveend",this._oldMoveHandler),s.removeEventListener("zoomend",this._oldZoomEndHandler),s.addEventListener("moving",i),s.addEventListener("moveend",i),s.addEventListener("zoomend",c),this._oldMoveHandler=i,this._oldZoomEndHandler=c;var d=t.get("roam");d&&"scale"!==d?s.enableDragging():s.disableDragging(),d&&"move"!==d?(s.enableScrollWheelZoom(),s.enableDoubleClickZoom(),s.enablePinchToZoom()):(s.disableScrollWheelZoom(),s.disableDoubleClickZoom(),s.disablePinchToZoom());var f=t.__mapStyle,h=t.get("mapStyle")||{},p=JSON.stringify(h);JSON.stringify(f)!==p&&(o(m)||s.setMapStyle(e.util.clone(h)),t.__mapStyle=JSON.parse(p));var g=t.__mapStyle2,m=t.get("mapStyleV2")||{},v=JSON.stringify(m);JSON.stringify(g)!==v&&(o(m)||s.setMapStyleV2(e.util.clone(m)),t.__mapStyle2=JSON.parse(v)),a=!1}}),e.registerCoordinateSystem("bmap",n),e.registerAction({type:"bmapRoam",event:"bmapRoam",update:"updateLayout"},function(t,e){e.eachComponent("bmap",function(t){var e=t.getBMap(),n=e.getCenter();t.setCenterAndZoom([n.lng,n.lat],e.getZoom())})}),t.version="1.0.0"}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Chart=e()}(this,function(){"use strict";const t="undefined"==typeof window?function(t){return t()}:window.requestAnimationFrame;function e(e,n,r){const i=r||(t=>Array.prototype.slice.call(t));let o=!1,a=[];return function(...r){a=i(r),o||(o=!0,t.call(window,()=>{o=!1,e.apply(n,a)}))}}function n(t,e){let n;return function(){return e?(clearTimeout(n),n=setTimeout(t,e)):t(),e}}const r=t=>"start"===t?"left":"end"===t?"right":"center",i=(t,e,n)=>"start"===t?e:"end"===t?n:(e+n)/2,o=(t,e,n,r)=>t===(r?"left":"right")?n:"center"===t?(e+n)/2:e;var a=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,r){const i=e.duration;e.listeners[r].forEach(r=>r({chart:t,initial:e.initial,numSteps:i,currentStep:Math.min(n-e.start,i)}))}_refresh(){const e=this;e._request||(e._running=!0,e._request=t.call(window,()=>{e._update(),e._request=null,e._running&&e._refresh()}))}_update(t=Date.now()){const e=this;let n=0;e._charts.forEach((r,i)=>{if(!r.running||!r.items.length)return;const o=r.items;let a,s=o.length-1,l=!1;for(;s>=0;--s)a=o[s],a._active?(a._total>r.duration&&(r.duration=a._total),a.tick(t),l=!0):(o[s]=o[o.length-1],o.pop());l&&(i.draw(),e._notify(i,r,t,"progress")),o.length||(r.running=!1,e._notify(i,r,t,"complete"),r.initial=!1),n+=o.length}),e._lastDate=t,0===n&&(e._running=!1)}_getAnims(t){const e=this._charts;let n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((t,e)=>Math.max(t,e._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const n=e.items;let r=n.length-1;for(;r>=0;--r)n[r].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}};const s={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},l="0123456789ABCDEF",u=t=>l[15&t],c=t=>l[(240&t)>>4]+l[15&t],d=t=>(240&t)>>4==(15&t);function f(t){return t+.5|0}const h=(t,e,n)=>Math.max(Math.min(t,n),e);function p(t){return h(f(2.55*t),0,255)}function g(t){return h(f(255*t),0,255)}function m(t){return h(f(t/2.55)/100,0,1)}function v(t){return h(f(100*t),0,100)}const y=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,x=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function b(t,e,n){const r=e*Math.min(n,1-n),i=(e,i=(e+t/30)%12)=>n-r*Math.max(Math.min(i-3,9-i,1),-1);return[i(0),i(8),i(4)]}function _(t,e,n){const r=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[r(5),r(3),r(1)]}function w(t,e,n){const r=b(t,1,.5);let i;for(e+n>1&&(i=1/(e+n),e*=i,n*=i),i=0;i<3;i++)r[i]*=1-e-n,r[i]+=e;return r}function S(t){const e=t.r/255,n=t.g/255,r=t.b/255,i=Math.max(e,n,r),o=Math.min(e,n,r),a=(i+o)/2;let s,l,u;return i!==o&&(u=i-o,l=a>.5?u/(2-i-o):u/(i+o),s=i===e?(n-r)/u+(n<r?6:0):i===n?(r-e)/u+2:(e-n)/u+4,s=60*s+.5),[0|s,l||0,a]}function C(t,e,n,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,r)).map(g)}function M(t,e,n){return C(b,t,e,n)}function T(t){return(t%360+360)%360}const k={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},A={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let I;function D(t,e,n){if(t){let r=S(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*n,0===e?360:1)),r=M(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function O(t,e){return t?Object.assign(e||{},t):t}function P(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=g(t[3]))):(e=O(t,{r:0,g:0,b:0,a:1})).a=g(e.a),e}class E{constructor(t){if(t instanceof E)return t;const e=typeof t;let n;var r,i,o;"object"===e?n=P(t):"string"===e&&(o=(r=t).length,"#"===r[0]&&(4===o||5===o?i={r:255&17*s[r[1]],g:255&17*s[r[2]],b:255&17*s[r[3]],a:5===o?17*s[r[4]]:255}:7!==o&&9!==o||(i={r:s[r[1]]<<4|s[r[2]],g:s[r[3]]<<4|s[r[4]],b:s[r[5]]<<4|s[r[6]],a:9===o?s[r[7]]<<4|s[r[8]]:255})),n=i||function(t){I||(I=function(){const t={},e=Object.keys(A),n=Object.keys(k);let r,i,o,a,s;for(r=0;r<e.length;r++){for(a=s=e[r],i=0;i<n.length;i++)o=n[i],s=s.replace(o,k[o]);o=parseInt(A[a],16),t[s]=[o>>16&255,o>>8&255,255&o]}return t}(),I.transparent=[0,0,0,0]);const e=I[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}(t)||function(t){return"r"===t.charAt(0)?function(t){const e=y.exec(t);let n,r,i,o=255;if(e){if(e[7]!==n){const t=+e[7];o=255&(e[8]?p(t):255*t)}return n=+e[1],r=+e[3],i=+e[5],n=255&(e[2]?p(n):n),r=255&(e[4]?p(r):r),i=255&(e[6]?p(i):i),{r:n,g:r,b:i,a:o}}}(t):function(t){const e=x.exec(t);let n,r=255;if(!e)return;e[5]!==n&&(r=e[6]?p(+e[5]):g(+e[5]));const i=T(+e[2]),o=+e[3]/100,a=+e[4]/100;return n="hwb"===e[1]?function(t,e,n){return C(w,t,e,n)}(i,o,a):"hsv"===e[1]?function(t,e,n){return C(_,t,e,n)}(i,o,a):M(i,o,a),{r:n[0],g:n[1],b:n[2],a:r}}(t)}(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=O(this._rgb);return t&&(t.a=m(t.a)),t}set rgb(t){this._rgb=P(t)}rgbString(){return this._valid?(t=this._rgb)&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${m(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`):this._rgb;var t}hexString(){return this._valid?function(t){var e=function(t){return d(t.r)&&d(t.g)&&d(t.b)&&d(t.a)}(t)?u:c;return t?"#"+e(t.r)+e(t.g)+e(t.b)+(t.a<255?e(t.a):""):t}(this._rgb):this._rgb}hslString(){return this._valid?function(t){if(!t)return;const e=S(t),n=e[0],r=v(e[1]),i=v(e[2]);return t.a<255?`hsla(${n}, ${r}%, ${i}%, ${m(t.a)})`:`hsl(${n}, ${r}%, ${i}%)`}(this._rgb):this._rgb}mix(t,e){const n=this;if(t){const r=n.rgb,i=t.rgb;let o;const a=e===o?.5:e,s=2*a-1,l=r.a-i.a,u=((s*l==-1?s:(s+l)/(1+s*l))+1)/2;o=1-u,r.r=255&u*r.r+o*i.r+.5,r.g=255&u*r.g+o*i.g+.5,r.b=255&u*r.b+o*i.b+.5,r.a=a*r.a+(1-a)*i.a,n.rgb=r}return n}clone(){return new E(this.rgb)}alpha(t){return this._rgb.a=g(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=f(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return D(this._rgb,2,t),this}darken(t){return D(this._rgb,2,-t),this}saturate(t){return D(this._rgb,1,t),this}desaturate(t){return D(this._rgb,1,-t),this}rotate(t){return function(t,e){var n=S(t);n[0]=T(n[0]+e),n=M(n),t.r=n[0],t.g=n[1],t.b=n[2]}(this._rgb,t),this}}function R(t){return new E(t)}const L=t=>t instanceof CanvasGradient||t instanceof CanvasPattern;function N(t){return L(t)?t:R(t)}function B(t){return L(t)?t:R(t).saturate(.5).darken(.1).hexString()}function z(){}const V=function(){let t=0;return function(){return t++}}();function F(t){return null==t}function H(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.substr(0,7)&&"Array]"===e.substr(-6)}function W(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}const j=t=>("number"==typeof t||t instanceof Number)&&isFinite(+t);function G(t,e){return j(t)?t:e}function U(t,e){return void 0===t?e:t}const q=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100:t/e,X=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Y(t,e,n){if(t&&"function"==typeof t.call)return t.apply(n,e)}function $(t,e,n,r){let i,o,a;if(H(t))if(o=t.length,r)for(i=o-1;i>=0;i--)e.call(n,t[i],i);else for(i=0;i<o;i++)e.call(n,t[i],i);else if(W(t))for(a=Object.keys(t),o=a.length,i=0;i<o;i++)e.call(n,t[a[i]],a[i])}function Z(t,e){let n,r,i,o;if(!t||!e||t.length!==e.length)return!1;for(n=0,r=t.length;n<r;++n)if(i=t[n],o=e[n],i.datasetIndex!==o.datasetIndex||i.index!==o.index)return!1;return!0}function K(t){if(H(t))return t.map(K);if(W(t)){const e=Object.create(null),n=Object.keys(t),r=n.length;let i=0;for(;i<r;++i)e[n[i]]=K(t[n[i]]);return e}return t}function J(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function Q(t,e,n,r){if(!J(t))return;const i=e[t],o=n[t];W(i)&&W(o)?tt(i,o,r):e[t]=K(o)}function tt(t,e,n){const r=H(e)?e:[e],i=r.length;if(!W(t))return t;const o=(n=n||{}).merger||Q;for(let a=0;a<i;++a){if(!W(e=r[a]))continue;const i=Object.keys(e);for(let r=0,a=i.length;r<a;++r)o(i[r],t,e,n)}return t}function et(t,e){return tt(t,e,{merger:nt})}function nt(t,e,n){if(!J(t))return;const r=e[t],i=n[t];W(r)&&W(i)?et(r,i):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=K(i))}function rt(t,e){const n=t.indexOf(".",e);return-1===n?t.length:n}function it(t,e){if(""===e)return t;let n=0,r=rt(e,n);for(;t&&r>n;)t=t[e.substr(n,r-n)],n=r+1,r=rt(e,n);return t}function ot(t){return t.charAt(0).toUpperCase()+t.slice(1)}const at=t=>void 0!==t,st=t=>"function"==typeof t,lt=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0},ut=Object.create(null),ct=Object.create(null);function dt(t,e){if(!e)return t;const n=e.split(".");for(let r=0,i=n.length;r<i;++r){const e=n[r];t=t[e]||(t[e]=Object.create(null))}return t}function ft(t,e,n){return"string"==typeof e?tt(dt(t,e),n):tt(dt(t,""),e)}var ht=new class{constructor(t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>B(e.backgroundColor),this.hoverBorderColor=(t,e)=>B(e.borderColor),this.hoverColor=(t,e)=>B(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.describe(t)}set(t,e){return ft(this,t,e)}get(t){return dt(this,t)}describe(t,e){return ft(ct,t,e)}override(t,e){return ft(ut,t,e)}route(t,e,n,r){const i=dt(this,t),o=dt(this,n),a="_"+e;Object.defineProperties(i,{[a]:{value:i[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[a],e=o[r];return W(t)?Object.assign({},e,t):U(t,e)},set(t){this[a]=t}}})}}({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});const pt=Math.PI,gt=2*pt,mt=gt+pt,vt=Number.POSITIVE_INFINITY,yt=pt/180,xt=pt/2,bt=pt/4,_t=2*pt/3,wt=Math.log10,St=Math.sign;function Ct(t){const e=Math.round(t);t=kt(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(wt(t))),r=t/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function Mt(t){const e=[],n=Math.sqrt(t);let r;for(r=1;r<n;r++)t%r==0&&(e.push(r),e.push(t/r));return n===(0|n)&&e.push(n),e.sort((t,e)=>t-e).pop(),e}function Tt(t){return!isNaN(parseFloat(t))&&isFinite(t)}function kt(t,e,n){return Math.abs(t-e)<n}function At(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function It(t,e,n){let r,i,o;for(r=0,i=t.length;r<i;r++)o=t[r][n],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function Dt(t){return t*(pt/180)}function Ot(t){return t*(180/pt)}function Pt(t){if(!j(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function Et(t,e){const n=e.x-t.x,r=e.y-t.y,i=Math.sqrt(n*n+r*r);let o=Math.atan2(r,n);return o<-.5*pt&&(o+=gt),{angle:o,distance:i}}function Rt(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Lt(t,e){return(t-e+mt)%gt-pt}function Nt(t){return(t%gt+gt)%gt}function Bt(t,e,n,r){const i=Nt(t),o=Nt(e),a=Nt(n),s=Nt(o-i),l=Nt(a-i),u=Nt(i-o),c=Nt(i-a);return i===o||i===a||r&&o===a||s>l&&u<c}function zt(t,e,n){return Math.max(e,Math.min(n,t))}function Vt(t){return zt(t,-32768,32767)}function Ft(t){return!t||F(t.size)||F(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Ht(t,e,n,r,i){let o=e[i];return o||(o=e[i]=t.measureText(i).width,n.push(i)),o>r&&(r=o),r}function Wt(t,e,n,r){let i=(r=r||{}).data=r.data||{},o=r.garbageCollect=r.garbageCollect||[];r.font!==e&&(i=r.data={},o=r.garbageCollect=[],r.font=e),t.save(),t.font=e;let a=0;const s=n.length;let l,u,c,d,f;for(l=0;l<s;l++)if(d=n[l],null!=d&&!0!==H(d))a=Ht(t,i,o,a,d);else if(H(d))for(u=0,c=d.length;u<c;u++)f=d[u],null==f||H(f)||(a=Ht(t,i,o,a,f));t.restore();const h=o.length/2;if(h>n.length){for(l=0;l<h;l++)delete i[o[l]];o.splice(0,h)}return a}function jt(t,e,n){const r=t.currentDevicePixelRatio,i=0!==n?Math.max(n/2,.5):0;return Math.round((e-i)*r)/r+i}function Gt(t,e){(e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function Ut(t,e,n,r){let i,o,a,s,l;const u=e.pointStyle,c=e.rotation,d=e.radius;let f=(c||0)*yt;if(u&&"object"==typeof u&&(i=u.toString(),"[object HTMLImageElement]"===i||"[object HTMLCanvasElement]"===i))return t.save(),t.translate(n,r),t.rotate(f),t.drawImage(u,-u.width/2,-u.height/2,u.width,u.height),void t.restore();if(!(isNaN(d)||d<=0)){switch(t.beginPath(),u){default:t.arc(n,r,d,0,gt),t.closePath();break;case"triangle":t.moveTo(n+Math.sin(f)*d,r-Math.cos(f)*d),f+=_t,t.lineTo(n+Math.sin(f)*d,r-Math.cos(f)*d),f+=_t,t.lineTo(n+Math.sin(f)*d,r-Math.cos(f)*d),t.closePath();break;case"rectRounded":l=.516*d,s=d-l,o=Math.cos(f+bt)*s,a=Math.sin(f+bt)*s,t.arc(n-o,r-a,l,f-pt,f-xt),t.arc(n+a,r-o,l,f-xt,f),t.arc(n+o,r+a,l,f,f+xt),t.arc(n-a,r+o,l,f+xt,f+pt),t.closePath();break;case"rect":if(!c){s=Math.SQRT1_2*d,t.rect(n-s,r-s,2*s,2*s);break}f+=bt;case"rectRot":o=Math.cos(f)*d,a=Math.sin(f)*d,t.moveTo(n-o,r-a),t.lineTo(n+a,r-o),t.lineTo(n+o,r+a),t.lineTo(n-a,r+o),t.closePath();break;case"crossRot":f+=bt;case"cross":o=Math.cos(f)*d,a=Math.sin(f)*d,t.moveTo(n-o,r-a),t.lineTo(n+o,r+a),t.moveTo(n+a,r-o),t.lineTo(n-a,r+o);break;case"star":o=Math.cos(f)*d,a=Math.sin(f)*d,t.moveTo(n-o,r-a),t.lineTo(n+o,r+a),t.moveTo(n+a,r-o),t.lineTo(n-a,r+o),f+=bt,o=Math.cos(f)*d,a=Math.sin(f)*d,t.moveTo(n-o,r-a),t.lineTo(n+o,r+a),t.moveTo(n+a,r-o),t.lineTo(n-a,r+o);break;case"line":o=Math.cos(f)*d,a=Math.sin(f)*d,t.moveTo(n-o,r-a),t.lineTo(n+o,r+a);break;case"dash":t.moveTo(n,r),t.lineTo(n+Math.cos(f)*d,r+Math.sin(f)*d)}t.fill(),e.borderWidth>0&&t.stroke()}}function qt(t,e,n){return n=n||.5,t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function Xt(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Yt(t){t.restore()}function $t(t,e,n,r,i){if(!e)return t.lineTo(n.x,n.y);if("middle"===i){const r=(e.x+n.x)/2;t.lineTo(r,e.y),t.lineTo(r,n.y)}else"after"===i!=!!r?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function Zt(t,e,n,r){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function Kt(t,e,n,r,i,o={}){const a=H(e)?e:[e],s=o.strokeWidth>0&&""!==o.strokeColor;let l,u;for(t.save(),t.font=i.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),F(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,o),l=0;l<a.length;++l)u=a[l],s&&(o.strokeColor&&(t.strokeStyle=o.strokeColor),F(o.strokeWidth)||(t.lineWidth=o.strokeWidth),t.strokeText(u,n,r,o.maxWidth)),t.fillText(u,n,r,o.maxWidth),Jt(t,n,r,u,o),r+=i.lineHeight;t.restore()}function Jt(t,e,n,r,i){if(i.strikethrough||i.underline){const o=t.measureText(r),a=e-o.actualBoundingBoxLeft,s=e+o.actualBoundingBoxRight,l=n-o.actualBoundingBoxAscent,u=n+o.actualBoundingBoxDescent,c=i.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=i.decorationWidth||2,t.moveTo(a,c),t.lineTo(s,c),t.stroke()}}function Qt(t,e){const{x:n,y:r,w:i,h:o,radius:a}=e;t.arc(n+a.topLeft,r+a.topLeft,a.topLeft,-xt,pt,!0),t.lineTo(n,r+o-a.bottomLeft),t.arc(n+a.bottomLeft,r+o-a.bottomLeft,a.bottomLeft,pt,xt,!0),t.lineTo(n+i-a.bottomRight,r+o),t.arc(n+i-a.bottomRight,r+o-a.bottomRight,a.bottomRight,xt,0,!0),t.lineTo(n+i,r+a.topRight),t.arc(n+i-a.topRight,r+a.topRight,a.topRight,0,-xt,!0),t.lineTo(n+a.topLeft,r)}function te(t,e,n){n=n||(n=>t[n]<e);let r,i=t.length-1,o=0;for(;i-o>1;)r=o+i>>1,n(r)?o=r:i=r;return{lo:o,hi:i}}const ee=(t,e,n)=>te(t,n,r=>t[r][e]<n),ne=(t,e,n)=>te(t,n,r=>t[r][e]>=n);function re(t,e,n){let r=0,i=t.length;for(;r<i&&t[r]<e;)r++;for(;i>r&&t[i-1]>n;)i--;return r>0||i<t.length?t.slice(r,i):t}const ie=["push","pop","shift","splice","unshift"];function oe(t,e){t._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),ie.forEach(e=>{const n="_onData"+ot(e),r=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value(...e){const i=r.apply(this,e);return t._chartjs.listeners.forEach(t=>{"function"==typeof t[n]&&t[n](...e)}),i}})}))}function ae(t,e){const n=t._chartjs;if(!n)return;const r=n.listeners,i=r.indexOf(e);-1!==i&&r.splice(i,1),r.length>0||(ie.forEach(e=>{delete t[e]}),delete t._chartjs)}function se(t){const e=new Set;let n,r;for(n=0,r=t.length;n<r;++n)e.add(t[n]);return e.size===r?t:Array.from(e)}function le(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function ue(t,e,n){let r;return"string"==typeof t?(r=parseInt(t,10),-1!==t.indexOf("%")&&(r=r/100*e.parentNode[n])):r=t,r}const ce=t=>window.getComputedStyle(t,null);function de(t,e){return ce(t).getPropertyValue(e)}const fe=["top","right","bottom","left"];function he(t,e,n){const r={};n=n?"-"+n:"";for(let i=0;i<4;i++){const o=fe[i];r[o]=parseFloat(t[e+"-"+o+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function pe(t,e){const{canvas:n,currentDevicePixelRatio:r}=e,i=ce(n),o="border-box"===i.boxSizing,a=he(i,"padding"),s=he(i,"border","width"),{x:l,y:u,box:c}=function(t,e){const n=t.native||t,r=n.touches,i=r&&r.length?r[0]:n,{offsetX:o,offsetY:a}=i;let s,l,u=!1;if(((t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot))(o,a,n.target))s=o,l=a;else{const t=e.getBoundingClientRect();s=i.clientX-t.left,l=i.clientY-t.top,u=!0}return{x:s,y:l,box:u}}(t,n),d=a.left+(c&&s.left),f=a.top+(c&&s.top);let{width:h,height:p}=e;return o&&(h-=a.width+s.width,p-=a.height+s.height),{x:Math.round((l-d)/h*n.width/r),y:Math.round((u-f)/p*n.height/r)}}const ge=t=>Math.round(10*t)/10;function me(t,e,n,r){const i=ce(t),o=he(i,"margin"),a=ue(i.maxWidth,t,"clientWidth")||vt,s=ue(i.maxHeight,t,"clientHeight")||vt,l=function(t,e,n){let r,i;if(void 0===e||void 0===n){const o=le(t);if(o){const t=o.getBoundingClientRect(),a=ce(o),s=he(a,"border","width"),l=he(a,"padding");e=t.width-l.width-s.width,n=t.height-l.height-s.height,r=ue(a.maxWidth,o,"clientWidth"),i=ue(a.maxHeight,o,"clientHeight")}else e=t.clientWidth,n=t.clientHeight}return{width:e,height:n,maxWidth:r||vt,maxHeight:i||vt}}(t,e,n);let{width:u,height:c}=l;if("content-box"===i.boxSizing){const t=he(i,"border","width"),e=he(i,"padding");u-=e.width+t.width,c-=e.height+t.height}return u=Math.max(0,u-o.width),c=Math.max(0,r?Math.floor(u/r):c-o.height),u=ge(Math.min(u,a,l.maxWidth)),c=ge(Math.min(c,s,l.maxHeight)),u&&!c&&(c=ge(u/2)),{width:u,height:c}}function ve(t,e,n){const r=e||1,i=Math.floor(t.height*r),o=Math.floor(t.width*r);t.height=i/r,t.width=o/r;const a=t.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==r||a.height!==i||a.width!==o)&&(t.currentDevicePixelRatio=r,a.height=i,a.width=o,t.ctx.setTransform(r,0,0,r,0,0),!0)}const ye=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}return t}();function xe(t,e){const n=de(t,e),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function be(t,e){return"native"in t?{x:t.x,y:t.y}:pe(t,e)}function _e(t,e,n,r){const{controller:i,data:o,_sorted:a}=t,s=i._cachedMeta.iScale;if(s&&e===s.axis&&a&&o.length){const t=s._reversePixels?ne:ee;if(!r)return t(o,e,n);if(i._sharedOptions){const r=o[0],i="function"==typeof r.getRange&&r.getRange(e);if(i){const r=t(o,e,n-i),a=t(o,e,n+i);return{lo:r.lo,hi:a.hi}}}}return{lo:0,hi:o.length-1}}function we(t,e,n,r,i){const o=t.getSortedVisibleDatasetMetas(),a=n[e];for(let s=0,l=o.length;s<l;++s){const{index:t,data:n}=o[s],{lo:l,hi:u}=_e(o[s],e,a,i);for(let e=l;e<=u;++e){const i=n[e];i.skip||r(i,t,e)}}}function Se(t,e,n,r){const i=[];return qt(e,t.chartArea,t._minPadding)?(we(t,n,e,function(t,n,o){t.inRange(e.x,e.y,r)&&i.push({element:t,datasetIndex:n,index:o})},!0),i):i}function Ce(t,e,n,r,i){const o=function(t){const e=-1!==t.indexOf("x"),n=-1!==t.indexOf("y");return function(t,r){const i=e?Math.abs(t.x-r.x):0,o=n?Math.abs(t.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}(n);let a=Number.POSITIVE_INFINITY,s=[];return qt(e,t.chartArea,t._minPadding)?(we(t,n,e,function(n,l,u){if(r&&!n.inRange(e.x,e.y,i))return;const c=n.getCenterPoint(i);if(!qt(c,t.chartArea,t._minPadding))return;const d=o(e,c);d<a?(s=[{element:n,datasetIndex:l,index:u}],a=d):d===a&&s.push({element:n,datasetIndex:l,index:u})}),s):s}function Me(t,e,n,r){const i=be(e,t),o=[],a=n.axis,s="x"===a?"inXRange":"inYRange";let l=!1;return function(t,e){const n=t.getSortedVisibleDatasetMetas();let r,i,o;for(let a=0,s=n.length;a<s;++a){({index:r,data:i}=n[a]);for(let t=0,n=i.length;t<n;++t)o=i[t],o.skip||e(o,r,t)}}(t,(t,e,n)=>{t[s](i[a],r)&&o.push({element:t,datasetIndex:e,index:n}),t.inRange(i.x,i.y,r)&&(l=!0)}),n.intersect&&!l?[]:o}var Te={modes:{index(t,e,n,r){const i=be(e,t),o=n.axis||"x",a=n.intersect?Se(t,i,o,r):Ce(t,i,o,!1,r),s=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(t=>{const e=a[0].index,n=t.data[e];n&&!n.skip&&s.push({element:n,datasetIndex:t.index,index:e})}),s):[]},dataset(t,e,n,r){const i=be(e,t),o=n.axis||"xy";let a=n.intersect?Se(t,i,o,r):Ce(t,i,o,!1,r);if(a.length>0){const e=a[0].datasetIndex,n=t.getDatasetMeta(e).data;a=[];for(let t=0;t<n.length;++t)a.push({element:n[t],datasetIndex:e,index:t})}return a},point:(t,e,n,r)=>Se(t,be(e,t),n.axis||"xy",r),nearest:(t,e,n,r)=>Ce(t,be(e,t),n.axis||"xy",n.intersect,r),x:(t,e,n,r)=>(n.axis="x",Me(t,e,n,r)),y:(t,e,n,r)=>(n.axis="y",Me(t,e,n,r))}};const ke=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),Ae=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function Ie(t,e){const n=(""+t).match(ke);if(!n||"normal"===n[1])return 1.2*e;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100}return e*t}function De(t,e){const n={},r=W(e),i=r?Object.keys(e):e,o=W(t)?r?n=>U(t[n],t[e[n]]):e=>t[e]:()=>t;for(const a of i)n[a]=+o(a)||0;return n}function Oe(t){return De(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Pe(t){return De(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Ee(t){const e=Oe(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Re(t,e){let n=U((t=t||{}).size,(e=e||ht.font).size);"string"==typeof n&&(n=parseInt(n,10));let r=U(t.style,e.style);r&&!(""+r).match(Ae)&&(console.warn('Invalid font style specified: "'+r+'"'),r="");const i={family:U(t.family,e.family),lineHeight:Ie(U(t.lineHeight,e.lineHeight),n),size:n,style:r,weight:U(t.weight,e.weight),string:""};return i.string=Ft(i),i}function Le(t,e,n,r){let i,o,a,s=!0;for(i=0,o=t.length;i<o;++i)if(a=t[i],void 0!==a&&(void 0!==e&&"function"==typeof a&&(a=a(e),s=!1),void 0!==n&&H(a)&&(a=a[n%a.length],s=!1),void 0!==a))return r&&!s&&(r.cacheable=!1),a}function Ne(t,e){const{min:n,max:r}=t;return{min:n-Math.abs(X(e,n)),max:r+X(e,r)}}const Be=["left","top","right","bottom"];function ze(t,e){return t.filter(t=>t.pos===e)}function Ve(t,e){return t.filter(t=>-1===Be.indexOf(t.pos)&&t.box.axis===e)}function Fe(t,e){return t.sort((t,n)=>{const r=e?n:t,i=e?t:n;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function He(t,e,n,r){return Math.max(t[n],e[n])+Math.max(t[r],e[r])}function We(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function je(t,e,n){const r=n.box,i=t.maxPadding;W(n.pos)||(n.size&&(t[n.pos]-=n.size),n.size=n.horizontal?r.height:r.width,t[n.pos]+=n.size),r.getPadding&&We(i,r.getPadding());const o=Math.max(0,e.outerWidth-He(i,t,"left","right")),a=Math.max(0,e.outerHeight-He(i,t,"top","bottom")),s=o!==t.w,l=a!==t.h;return t.w=o,t.h=a,n.horizontal?{same:s,other:l}:{same:l,other:s}}function Ge(t,e){const n=e.maxPadding;return function(t){const r={left:0,top:0,right:0,bottom:0};return t.forEach(t=>{r[t]=Math.max(e[t],n[t])}),r}(t?["left","right"]:["top","bottom"])}function Ue(t,e,n){const r=[];let i,o,a,s,l,u;for(i=0,o=t.length,l=0;i<o;++i){a=t[i],s=a.box,s.update(a.width||e.w,a.height||e.h,Ge(a.horizontal,e));const{same:o,other:c}=je(e,n,a);l|=o&&r.length,u=u||c,s.fullSize||r.push(a)}return l&&Ue(r,e,n)||u}function qe(t,e,n){const r=n.padding;let i,o,a,s,l=e.x,u=e.y;for(i=0,o=t.length;i<o;++i)a=t[i],s=a.box,a.horizontal?(s.left=s.fullSize?r.left:e.left,s.right=s.fullSize?n.outerWidth-r.right:e.left+e.w,s.top=u,s.bottom=u+s.height,s.width=s.right-s.left,u=s.bottom):(s.left=l,s.right=l+s.width,s.top=s.fullSize?r.top:e.top,s.bottom=s.fullSize?n.outerHeight-r.bottom:e.top+e.h,s.height=s.bottom-s.top,l=s.right);e.x=l,e.y=u}ht.set("layout",{padding:{top:0,right:0,bottom:0,left:0}});var Xe={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;-1!==n&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,r){if(!t)return;const i=Ee(t.options.layout.padding),o=Math.max(e-i.width,0),a=Math.max(n-i.height,0),s=function(t){const e=function(t){const e=[];let n,r,i;for(n=0,r=(t||[]).length;n<r;++n)i=t[n],e.push({index:n,box:i,pos:i.position,horizontal:i.isHorizontal(),weight:i.weight});return e}(t),n=Fe(e.filter(t=>t.box.fullSize),!0),r=Fe(ze(e,"left"),!0),i=Fe(ze(e,"right")),o=Fe(ze(e,"top"),!0),a=Fe(ze(e,"bottom")),s=Ve(e,"x"),l=Ve(e,"y");return{fullSize:n,leftAndTop:r.concat(o),rightAndBottom:i.concat(l).concat(a).concat(s),chartArea:ze(e,"chartArea"),vertical:r.concat(i).concat(l),horizontal:o.concat(a).concat(s)}}(t.boxes),l=s.vertical,u=s.horizontal;$(t.boxes,t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()});const c=l.reduce((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:n,padding:i,availableWidth:o,availableHeight:a,vBoxMaxWidth:o/2/c,hBoxMaxHeight:a/2}),f=Object.assign({},i);We(f,Ee(r));const h=Object.assign({maxPadding:f,w:o,h:a,x:i.left,y:i.top},i);!function(t,e){let n,r,i;for(n=0,r=t.length;n<r;++n)i=t[n],i.horizontal?(i.width=i.box.fullSize&&e.availableWidth,i.height=e.hBoxMaxHeight):(i.width=e.vBoxMaxWidth,i.height=i.box.fullSize&&e.availableHeight)}(l.concat(u),d),Ue(s.fullSize,h,d),Ue(l,h,d),Ue(u,h,d)&&Ue(l,h,d),function(t){const e=t.maxPadding;function n(n){const r=Math.max(e[n]-t[n],0);return t[n]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}(h),qe(s.leftAndTop,h,d),h.x+=h.w,h.y+=h.h,qe(s.rightAndBottom,h,d),t.chartArea={left:h.left,top:h.top,right:h.left+h.w,bottom:h.top+h.h,height:h.h,width:h.w},$(s.chartArea,e=>{const n=e.box;Object.assign(n,t.chartArea),n.update(h.w,h.h)})}};class Ye{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,r){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,r?Math.floor(e/r):n)}}isAttached(t){return!0}}class $e extends Ye{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}}const Ze={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ke=t=>null===t||""===t,Je=!!ye&&{passive:!0};function Qe(t,e,n){t.canvas.removeEventListener(e,n,Je)}function tn(t,e,n){const r=t.canvas,i=r&&le(r)||r,o=new MutationObserver(t=>{const e=le(i);t.forEach(t=>{for(let r=0;r<t.addedNodes.length;r++){const o=t.addedNodes[r];o!==i&&o!==e||n(t.target)}})});return o.observe(document,{childList:!0,subtree:!0}),o}function en(t,e,n){const r=t.canvas,i=r&&le(r);if(!i)return;const o=new MutationObserver(t=>{t.forEach(t=>{for(let e=0;e<t.removedNodes.length;e++)if(t.removedNodes[e]===r){n();break}})});return o.observe(i,{childList:!0}),o}const nn=new Map;let rn=0;function on(){const t=window.devicePixelRatio;t!==rn&&(rn=t,nn.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function an(t,n,r){const i=t.canvas,o=i&&le(i);if(!o)return;const a=e((t,e)=>{const n=o.clientWidth;r(t,e),n<o.clientWidth&&r()},window),s=new ResizeObserver(t=>{const e=t[0],n=e.contentRect.width,r=e.contentRect.height;0===n&&0===r||a(n,r)});return s.observe(o),function(t,e){nn.size||window.addEventListener("resize",on),nn.set(t,e)}(t,a),s}function sn(t,e,n){n&&n.disconnect(),"resize"===e&&function(t){nn.delete(t),nn.size||window.removeEventListener("resize",on)}(t)}function ln(t,n,r){const i=t.canvas,o=e(e=>{null!==t.ctx&&r(function(t,e){const n=Ze[t.type]||t.type,{x:r,y:i}=pe(t,e);return{type:n,chart:e,native:t,x:void 0!==r?r:null,y:void 0!==i?i:null}}(e,t))},t,t=>{const e=t[0];return[e,e.offsetX,e.offsetY]});return function(t,e,n){t.addEventListener(e,n,Je)}(i,n,o),o}class un extends Ye{acquireContext(t,e){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(function(t,e){const n=t.style,r=t.getAttribute("height"),i=t.getAttribute("width");if(t.$chartjs={initial:{height:r,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Ke(i)){const e=xe(t,"width");void 0!==e&&(t.width=e)}if(Ke(r))if(""===t.style.height)t.height=t.width/(e||2);else{const e=xe(t,"height");void 0!==e&&(t.height=e)}}(t,e),n):null}releaseContext(t){const e=t.canvas;if(!e.$chartjs)return!1;const n=e.$chartjs.initial;["height","width"].forEach(t=>{const r=n[t];F(r)?e.removeAttribute(t):e.setAttribute(t,r)});const r=n.style||{};return Object.keys(r).forEach(t=>{e.style[t]=r[t]}),e.width=e.width,delete e.$chartjs,!0}addEventListener(t,e,n){this.removeEventListener(t,e),(t.$proxies||(t.$proxies={}))[e]=({attach:tn,detach:en,resize:an}[e]||ln)(t,e,n)}removeEventListener(t,e){const n=t.$proxies||(t.$proxies={}),r=n[e];r&&(({attach:sn,detach:sn,resize:sn}[e]||Qe)(t,e,r),n[e]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,r){return me(t,e,n,r)}isAttached(t){const e=le(t);return!(!e||!le(e))}}var cn=Object.freeze({__proto__:null,BasePlatform:Ye,BasicPlatform:$e,DomPlatform:un});const dn=t=>0===t||1===t,fn=(t,e,n)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*gt/n),hn=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*gt/n)+1,pn={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*xt),easeOutSine:t=>Math.sin(t*xt),easeInOutSine:t=>-.5*(Math.cos(pt*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>dn(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>dn(t)?t:fn(t,.075,.3),easeOutElastic:t=>dn(t)?t:hn(t,.075,.3),easeInOutElastic(t){const e=.1125;return dn(t)?t:t<.5?.5*fn(2*t,e,.45):.5+.5*hn(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-pn.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375},easeInOutBounce:t=>t<.5?.5*pn.easeInBounce(2*t):.5*pn.easeOutBounce(2*t-1)+.5},gn="transparent",mn={boolean:(t,e,n)=>n>.5?e:t,color(t,e,n){const r=N(t||gn),i=r.valid&&N(e||gn);return i&&i.valid?i.mix(r,n).hexString():e},number:(t,e,n)=>t+(e-t)*n};class vn{constructor(t,e,n,r){const i=e[n];r=Le([t.to,r,i,t.from]);const o=Le([t.from,i,r]);this._active=!0,this._fn=t.fn||mn[t.type||typeof o],this._easing=pn[t.easing]||pn.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(t,e,n){const r=this;if(r._active){r._notify(!1);const i=r._target[r._prop],o=n-r._start,a=r._duration-o;r._start=n,r._duration=Math.floor(Math.max(a,t.duration)),r._total+=o,r._loop=!!t.loop,r._to=Le([t.to,e,i,t.from]),r._from=Le([t.from,i,e])}}cancel(){const t=this;t._active&&(t.tick(Date.now()),t._active=!1,t._notify(!1))}tick(t){const e=this,n=t-e._start,r=e._duration,i=e._prop,o=e._from,a=e._loop,s=e._to;let l;if(e._active=o!==s&&(a||n<r),!e._active)return e._target[i]=s,void e._notify(!0);n<0?e._target[i]=o:(l=n/r%2,l=a&&l>1?2-l:l,l=e._easing(Math.min(1,Math.max(0,l))),e._target[i]=e._fn(o,s,l))}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,n)=>{t.push({res:e,rej:n})})}_notify(t){const e=t?"res":"rej",n=this._promises||[];for(let r=0;r<n.length;r++)n[r][e]()}}ht.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const yn=Object.keys(ht.animation);ht.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),ht.set("animations",{colors:{type:"color",properties:["color","borderColor","backgroundColor"]},numbers:{type:"number",properties:["x","y","borderWidth","radius","tension"]}}),ht.describe("animations",{_fallback:"animation"}),ht.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}});class xn{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!W(t))return;const e=this._properties;Object.getOwnPropertyNames(t).forEach(n=>{const r=t[n];if(!W(r))return;const i={};for(const t of yn)i[t]=r[t];(H(r.properties)&&r.properties||[n]).forEach(t=>{t!==n&&e.has(t)||e.set(t,i)})})}_animateOptions(t,e){const n=e.options,r=function(t,e){if(!e)return;let n=t.options;if(n)return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n;t.options=e}(t,n);if(!r)return[];const i=this._createAnimations(r,n);return n.$shared&&function(t,e){const n=[],r=Object.keys(e);for(let i=0;i<r.length;i++){const e=t[r[i]];e&&e.active()&&n.push(e.wait())}return Promise.all(n)}(t.options.$animations,n).then(()=>{t.options=n},()=>{}),i}_createAnimations(t,e){const n=this._properties,r=[],i=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let s;for(s=o.length-1;s>=0;--s){const l=o[s];if("$"===l.charAt(0))continue;if("options"===l){r.push(...this._animateOptions(t,e));continue}const u=e[l];let c=i[l];const d=n.get(l);if(c){if(d&&c.active()){c.update(d,u,a);continue}c.cancel()}d&&d.duration?(i[l]=c=new vn(d,t,l,u),r.push(c)):t[l]=u}return r}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const n=this._createAnimations(t,e);return n.length?(a.add(this._chart,n),!0):void 0}}function bn(t,e){const n=t&&t.options||{},r=n.reverse,i=void 0===n.min?e:0,o=void 0===n.max?e:0;return{start:r?o:i,end:r?i:o}}function _n(t,e){const n=[],r=t._getSortedDatasetMetas(e);let i,o;for(i=0,o=r.length;i<o;++i)n.push(r[i].index);return n}function wn(t,e,n,r){const i=t.keys,o="single"===r.mode;let a,s,l,u;if(null!==e){for(a=0,s=i.length;a<s;++a){if(l=+i[a],l===n){if(r.all)continue;break}u=t.values[l],j(u)&&(o||0===e||St(e)===St(u))&&(e+=u)}return e}}function Sn(t,e){const n=t&&t.options.stacked;return n||void 0===n&&void 0!==e.stack}function Cn(t,e,n){const r=t[e]||(t[e]={});return r[n]||(r[n]={})}function Mn(t,e,n){for(const r of e.getMatchingVisibleMetas("bar").reverse()){const e=t[r.index];if(n&&e>0||!n&&e<0)return r.index}return null}function Tn(t,e){const{chart:n,_cachedMeta:r}=t,i=n._stacks||(n._stacks={}),{iScale:o,vScale:a,index:s}=r,l=o.axis,u=a.axis,c=function(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}(o,a,r),d=e.length;let f;for(let h=0;h<d;++h){const t=e[h],{[l]:n,[u]:r}=t;f=(t._stacks||(t._stacks={}))[u]=Cn(i,c,n),f[s]=r,f._top=Mn(f,a,!0),f._bottom=Mn(f,a,!1)}}function kn(t,e){const n=t.scales;return Object.keys(n).filter(t=>n[t].axis===e).shift()}function An(t,e){const n=t.vScale&&t.vScale.axis;if(n){e=e||t._parsed;for(const r of e){const e=r._stacks;if(!e||void 0===e[n]||void 0===e[n][t.index])return;delete e[n][t.index]}}}const In=t=>"reset"===t||"none"===t,Dn=(t,e)=>e?t:Object.assign({},t);class On{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const t=this,e=t._cachedMeta;t.configure(),t.linkScales(),e._stacked=Sn(e.vScale,e),t.addElements()}updateIndex(t){this.index!==t&&An(this._cachedMeta),this.index=t}linkScales(){const t=this,e=t.chart,n=t._cachedMeta,r=t.getDataset(),i=(t,e,n,r)=>"x"===t?e:"r"===t?r:n,o=n.xAxisID=U(r.xAxisID,kn(e,"x")),a=n.yAxisID=U(r.yAxisID,kn(e,"y")),s=n.rAxisID=U(r.rAxisID,kn(e,"r")),l=n.indexAxis,u=n.iAxisID=i(l,o,a,s),c=n.vAxisID=i(l,a,o,s);n.xScale=t.getScaleForId(o),n.yScale=t.getScaleForId(a),n.rScale=t.getScaleForId(s),n.iScale=t.getScaleForId(u),n.vScale=t.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&ae(this._data,this),t._stacked&&An(t)}_dataCheck(){const t=this,e=t.getDataset(),n=e.data||(e.data=[]),r=t._data;if(W(n))t._data=function(t){const e=Object.keys(t),n=new Array(e.length);let r,i,o;for(r=0,i=e.length;r<i;++r)o=e[r],n[r]={x:o,y:t[o]};return n}(n);else if(r!==n){if(r){ae(r,t);const e=t._cachedMeta;An(e),e._parsed=[]}n&&Object.isExtensible(n)&&oe(n,t),t._syncList=[],t._data=n}}addElements(){const t=this,e=t._cachedMeta;t._dataCheck(),t.datasetElementType&&(e.dataset=new t.datasetElementType)}buildOrUpdateElements(t){const e=this,n=e._cachedMeta,r=e.getDataset();let i=!1;e._dataCheck();const o=n._stacked;n._stacked=Sn(n.vScale,n),n.stack!==r.stack&&(i=!0,An(n),n.stack=r.stack),e._resyncElements(t),(i||o!==n._stacked)&&Tn(e,n._parsed)}configure(){const t=this,e=t.chart.config,n=e.datasetScopeKeys(t._type),r=e.getOptionScopes(t.getDataset(),n,!0);t.options=e.createResolver(r,t.getContext()),t._parsing=t.options.parsing}parse(t,e){const n=this,{_cachedMeta:r,_data:i}=n,{iScale:o,_stacked:a}=r,s=o.axis;let l,u,c,d=0===t&&e===i.length||r._sorted,f=t>0&&r._parsed[t-1];if(!1===n._parsing)r._parsed=i,r._sorted=!0,c=i;else{c=H(i[t])?n.parseArrayData(r,i,t,e):W(i[t])?n.parseObjectData(r,i,t,e):n.parsePrimitiveData(r,i,t,e);const o=()=>null===u[s]||f&&u[s]<f[s];for(l=0;l<e;++l)r._parsed[l+t]=u=c[l],d&&(o()&&(d=!1),f=u);r._sorted=d}a&&Tn(n,c)}parsePrimitiveData(t,e,n,r){const{iScale:i,vScale:o}=t,a=i.axis,s=o.axis,l=i.getLabels(),u=i===o,c=new Array(r);let d,f,h;for(d=0,f=r;d<f;++d)h=d+n,c[d]={[a]:u||i.parse(l[h],h),[s]:o.parse(e[h],h)};return c}parseArrayData(t,e,n,r){const{xScale:i,yScale:o}=t,a=new Array(r);let s,l,u,c;for(s=0,l=r;s<l;++s)u=s+n,c=e[u],a[s]={x:i.parse(c[0],u),y:o.parse(c[1],u)};return a}parseObjectData(t,e,n,r){const{xScale:i,yScale:o}=t,{xAxisKey:a="x",yAxisKey:s="y"}=this._parsing,l=new Array(r);let u,c,d,f;for(u=0,c=r;u<c;++u)d=u+n,f=e[d],l[u]={x:i.parse(it(f,a),d),y:o.parse(it(f,s),d)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,n){const r=this._cachedMeta,i=e[t.axis];return wn({keys:_n(this.chart,!0),values:e._stacks[t.axis]},i,r.index,{mode:n})}updateRangeFromParsed(t,e,n,r){const i=n[e.axis];let o=null===i?NaN:i;const a=r&&n._stacks[e.axis];r&&a&&(r.values=a,t.min=Math.min(t.min,o),t.max=Math.max(t.max,o),o=wn(r,i,this._cachedMeta.index,{all:!0})),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const n=this,r=n._cachedMeta,i=r._parsed,o=r._sorted&&t===r.iScale,a=i.length,s=n._getOtherScale(t),l=e&&r._stacked&&{keys:_n(n.chart,!0),values:null},u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=function(t){const{min:e,max:n,minDefined:r,maxDefined:i}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:i?n:Number.POSITIVE_INFINITY}}(s);let f,h,p,g;function m(){return p=i[f],h=p[t.axis],g=p[s.axis],!j(h)||c>g||d<g}for(f=0;f<a&&(m()||(n.updateRangeFromParsed(u,t,p,l),!o));++f);if(o)for(f=a-1;f>=0;--f)if(!m()){n.updateRangeFromParsed(u,t,p,l);break}return u}getAllParsedValues(t){const e=this._cachedMeta._parsed,n=[];let r,i,o;for(r=0,i=e.length;r<i;++r)o=e[r][t.axis],j(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,n=e.iScale,r=e.vScale,i=this.getParsed(t);return{label:n?""+n.getLabelForValue(i[n.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(t){const e=this,n=e._cachedMeta;e.configure(),e._cachedDataOpts={},e.update(t||"default"),n._clip=function(t){let e,n,r,i;return W(t)?(e=t.top,n=t.right,r=t.bottom,i=t.left):e=n=r=i=t,{top:e,right:n,bottom:r,left:i,disabled:!1===t}}(U(e.options.clip,function(t,e,n){if(!1===n)return!1;const r=bn(t,n),i=bn(e,n);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}(n.xScale,n.yScale,e.getMaxOverflow())))}update(t){}draw(){const t=this,e=t._ctx,n=t._cachedMeta,r=n.data||[],i=t.chart.chartArea,o=[],a=t._drawStart||0,s=t._drawCount||r.length-a;let l;for(n.dataset&&n.dataset.draw(e,i,a,s),l=a;l<a+s;++l){const t=r[l];t.active?o.push(t):t.draw(e,i)}for(l=0;l<o.length;++l)o[l].draw(e,i)}getStyle(t,e){const n=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,e,n){const r=this,i=r.getDataset();let o;if(t>=0&&t<r._cachedMeta.data.length){const e=r._cachedMeta.data[t];o=e.$context||(e.$context=function(t,e,n){return Object.assign(Object.create(t),{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}(r.getContext(),t,e)),o.parsed=r.getParsed(t),o.raw=i.data[t],o.index=o.dataIndex=t}else o=r.$context||(r.$context=function(t,e){return Object.assign(Object.create(t),{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(r.chart.getContext(),r.index)),o.dataset=i,o.index=o.datasetIndex=r.index;return o.active=!!e,o.mode=n,o}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",n){const r=this,i="active"===e,o=r._cachedDataOpts,a=t+"-"+e,s=o[a],l=r.enableOptionSharing&&at(n);if(s)return Dn(s,l);const u=r.chart.config,c=u.datasetElementScopeKeys(r._type,t),d=i?[`${t}Hover`,"hover",t,""]:[t,""],f=u.getOptionScopes(r.getDataset(),c),h=Object.keys(ht.elements[t]),p=u.resolveNamedOptions(f,h,()=>r.getContext(n,i),d);return p.$shared&&(p.$shared=l,o[a]=Object.freeze(Dn(p,l))),p}_resolveAnimations(t,e,n){const r=this,i=r.chart,o=r._cachedDataOpts,a=`animation-${e}`,s=o[a];if(s)return s;let l;if(!1!==i.options.animation){const i=r.chart.config,o=i.datasetAnimationScopeKeys(r._type,e),a=i.getOptionScopes(r.getDataset(),o);l=i.createResolver(a,r.getContext(t,n,e))}const u=new xn(i,l&&l.animations);return l&&l._cacheable&&(o[a]=Object.freeze(u)),u}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||In(t)||this.chart._animationsDisabled}updateElement(t,e,n,r){In(r)?Object.assign(t,n):this._resolveAnimations(e,r).update(t,n)}updateSharedOptions(t,e,n){t&&!In(e)&&this._resolveAnimations(void 0,e).update(t,n)}_setStyle(t,e,n,r){t.active=r;const i=this.getStyle(e,r);this._resolveAnimations(e,n,r).update(t,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(t,e,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,e,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this,n=e._data,r=e._cachedMeta.data;for(const[s,l,u]of e._syncList)e[s](l,u);e._syncList=[];const i=r.length,o=n.length,a=Math.min(o,i);a&&e.parse(0,a),o>i?e._insertElements(i,o-i,t):o<i&&e._removeElements(o,i-o)}_insertElements(t,e,n=!0){const r=this,i=r._cachedMeta,o=i.data,a=t+e;let s;const l=t=>{for(t.length+=e,s=t.length-1;s>=a;s--)t[s]=t[s-e]};for(l(o),s=t;s<a;++s)o[s]=new r.dataElementType;r._parsing&&l(i._parsed),r.parse(t,e),n&&r.updateElements(o,t,e,"reset")}updateElements(t,e,n,r){}_removeElements(t,e){const n=this._cachedMeta;if(this._parsing){const r=n._parsed.splice(t,e);n._stacked&&An(n,r)}n.data.splice(t,e)}_onDataPush(){const t=arguments.length;this._syncList.push(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._syncList.push(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._syncList.push(["_removeElements",0,1])}_onDataSplice(t,e){this._syncList.push(["_removeElements",t,e]),this._syncList.push(["_insertElements",t,arguments.length-2])}_onDataUnshift(){this._syncList.push(["_insertElements",0,arguments.length])}}On.defaults={},On.prototype.datasetElementType=null,On.prototype.dataElementType=null;class Pn{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return Tt(this.x)&&Tt(this.y)}getProps(t,e){const n=this,r=this.$animations;if(!e||!r)return n;const i={};return t.forEach(t=>{i[t]=r[t]&&r[t].active()?r[t]._to:n[t]}),i}}Pn.defaults={},Pn.defaultRoutes=void 0;const En=new Map;function Rn(t,e,n){return function(t,e){e=e||{};const n=t+JSON.stringify(e);let r=En.get(n);return r||(r=new Intl.NumberFormat(t,e),En.set(n,r)),r}(e,n).format(t)}const Ln={values:t=>H(t)?t:""+t,numeric(t,e,n){if(0===t)return"0";const r=this.chart.options.locale;let i,o=t;if(n.length>1){const e=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(e<1e-4||e>1e15)&&(i="scientific"),o=function(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}(t,n)}const a=wt(Math.abs(o)),s=Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:i,minimumFractionDigits:s,maximumFractionDigits:s};return Object.assign(l,this.options.ticks.format),Rn(t,r,l)},logarithmic(t,e,n){if(0===t)return"0";const r=t/Math.pow(10,Math.floor(wt(t)));return 1===r||2===r||5===r?Ln.numeric.call(this,t,e,n):""}};var Nn={formatters:Ln};function Bn(t,e,n,r,i){const o=U(r,0),a=Math.min(U(i,t.length),t.length);let s,l,u,c=0;for(n=Math.ceil(n),i&&(s=i-r,n=s/Math.floor(s/n)),u=o;u<0;)c++,u=Math.round(o+c*n);for(l=Math.max(o,0);l<a;l++)l===u&&(e.push(t[l]),c++,u=Math.round(o+c*n))}ht.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Nn.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),ht.route("scale.ticks","color","","color"),ht.route("scale.grid","color","","borderColor"),ht.route("scale.grid","borderColor","","borderColor"),ht.route("scale.title","color","","color"),ht.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t}),ht.describe("scales",{_fallback:"scale"}),ht.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t});const zn=(t,e,n)=>"top"===e||"left"===e?t[e]+n:t[e]-n;function Vn(t,e){const n=[],r=t.length/e,i=t.length;let o=0;for(;o<i;o+=r)n.push(t[Math.floor(o)]);return n}function Fn(t,e,n){const r=t.ticks.length,i=Math.min(e,r-1),o=t._startPixel,a=t._endPixel,s=1e-6;let l,u=t.getPixelForTick(i);if(!(n&&(l=1===r?Math.max(u-o,a-u):0===e?(t.getPixelForTick(1)-u)/2:(u-t.getPixelForTick(i-1))/2,u+=i<e?l:-l,u<o-s||u>a+s)))return u}function Hn(t){return t.drawTicks?t.tickLength:0}function Wn(t,e){if(!t.display)return 0;const n=Re(t.font,e),r=Ee(t.padding);return(H(t.text)?t.text.length:1)*n.lineHeight+r.height}function jn(t,e,n){let i=r(t);return(n&&"right"!==e||!n&&"right"===e)&&(i=(t=>"left"===t?"right":"right"===t?"left":t)(i)),i}class Gn extends Pn{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){const e=this;e.options=t.setContext(e.getContext()),e.axis=t.axis,e._userMin=e.parse(t.min),e._userMax=e.parse(t.max),e._suggestedMin=e.parse(t.suggestedMin),e._suggestedMax=e.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:r}=this;return t=G(t,Number.POSITIVE_INFINITY),e=G(e,Number.NEGATIVE_INFINITY),n=G(n,Number.POSITIVE_INFINITY),r=G(r,Number.NEGATIVE_INFINITY),{min:G(t,n),max:G(e,r),minDefined:j(t),maxDefined:j(e)}}getMinMax(t){const e=this;let n,{min:r,max:i,minDefined:o,maxDefined:a}=e.getUserBounds();if(o&&a)return{min:r,max:i};const s=e.getMatchingVisibleMetas();for(let l=0,u=s.length;l<u;++l)n=s[l].controller.getMinMax(e,t),o||(r=Math.min(r,n.min)),a||(i=Math.max(i,n.max));return{min:G(r,G(i,r)),max:G(i,G(r,i))}}getPadding(){const t=this;return{left:t.paddingLeft||0,top:t.paddingTop||0,right:t.paddingRight||0,bottom:t.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Y(this.options.beforeUpdate,[this])}update(t,e,n){const r=this,i=r.options.ticks,o=i.sampleSize;r.beforeUpdate(),r.maxWidth=t,r.maxHeight=e,r._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),r.ticks=null,r._labelSizes=null,r._gridLineItems=null,r._labelItems=null,r.beforeSetDimensions(),r.setDimensions(),r.afterSetDimensions(),r._maxLength=r.isHorizontal()?r.width+n.left+n.right:r.height+n.top+n.bottom,r._dataLimitsCached||(r.beforeDataLimits(),r.determineDataLimits(),r.afterDataLimits(),r._range=Ne(r,r.options.grace),r._dataLimitsCached=!0),r.beforeBuildTicks(),r.ticks=r.buildTicks()||[],r.afterBuildTicks();const a=o<r.ticks.length;r._convertTicksToLabels(a?Vn(r.ticks,o):r.ticks),r.configure(),r.beforeCalculateLabelRotation(),r.calculateLabelRotation(),r.afterCalculateLabelRotation(),i.display&&(i.autoSkip||"auto"===i.source)&&(r.ticks=function(t,e){const n=t.options.ticks,r=n.maxTicksLimit||function(t){const e=t.options.offset,n=t._tickSize();return Math.floor(Math.min(t._length/n+(e?0:1),t._maxLength/n))}(t),i=n.major.enabled?function(t){const e=[];let n,r;for(n=0,r=t.length;n<r;n++)t[n].major&&e.push(n);return e}(e):[],o=i.length,a=i[0],s=i[o-1],l=[];if(o>r)return function(t,e,n,r){let i,o=0,a=n[0];for(r=Math.ceil(r),i=0;i<t.length;i++)i===a&&(e.push(t[i]),o++,a=n[o*r])}(e,l,i,o/r),l;const u=function(t,e,n){const r=function(t){const e=t.length;let n,r;if(e<2)return!1;for(r=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==r)return!1;return r}(t),i=e.length/n;if(!r)return Math.max(i,1);const o=Mt(r);for(let a=0,s=o.length-1;a<s;a++){const t=o[a];if(t>i)return t}return Math.max(i,1)}(i,e,r);if(o>0){let t,n;const r=o>1?Math.round((s-a)/(o-1)):null;for(Bn(e,l,u,F(r)?0:a-r,a),t=0,n=o-1;t<n;t++)Bn(e,l,u,i[t],i[t+1]);return Bn(e,l,u,s,F(r)?e.length:s+r),l}return Bn(e,l,u),l}(r,r.ticks),r._labelSizes=null),a&&r._convertTicksToLabels(r.ticks),r.beforeFit(),r.fit(),r.afterFit(),r.afterUpdate()}configure(){const t=this;let e,n,r=t.options.reverse;t.isHorizontal()?(e=t.left,n=t.right):(e=t.top,n=t.bottom,r=!r),t._startPixel=e,t._endPixel=n,t._reversePixels=r,t._length=n-e,t._alignToPixels=t.options.alignToPixels}afterUpdate(){Y(this.options.afterUpdate,[this])}beforeSetDimensions(){Y(this.options.beforeSetDimensions,[this])}setDimensions(){const t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0}afterSetDimensions(){Y(this.options.afterSetDimensions,[this])}_callHooks(t){const e=this;e.chart.notifyPlugins(t,e.getContext()),Y(e.options[t],[e])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Y(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this,n=e.options.ticks;let r,i,o;for(r=0,i=t.length;r<i;r++)o=t[r],o.label=Y(n.callback,[o.value,r,t],e)}afterTickToLabelConversion(){Y(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Y(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this,e=t.options,n=e.ticks,r=t.ticks.length,i=n.minRotation||0,o=n.maxRotation;let a,s,l,u=i;if(!t._isVisible()||!n.display||i>=o||r<=1||!t.isHorizontal())return void(t.labelRotation=i);const c=t._getLabelSizes(),d=c.widest.width,f=c.highest.height,h=zt(t.chart.width-d,0,t.maxWidth);a=e.offset?t.maxWidth/r:h/(r-1),d+6>a&&(a=h/(r-(e.offset?.5:1)),s=t.maxHeight-Hn(e.grid)-n.padding-Wn(e.title,t.chart.options.font),l=Math.sqrt(d*d+f*f),u=Ot(Math.min(Math.asin(Math.min((c.highest.height+6)/a,1)),Math.asin(Math.min(s/l,1))-Math.asin(f/l))),u=Math.max(i,Math.min(o,u))),t.labelRotation=u}afterCalculateLabelRotation(){Y(this.options.afterCalculateLabelRotation,[this])}beforeFit(){Y(this.options.beforeFit,[this])}fit(){const t=this,e={width:0,height:0},{chart:n,options:{ticks:r,title:i,grid:o}}=t,a=t._isVisible(),s=t.isHorizontal();if(a){const a=Wn(i,n.options.font);if(s?(e.width=t.maxWidth,e.height=Hn(o)+a):(e.height=t.maxHeight,e.width=Hn(o)+a),r.display&&t.ticks.length){const{first:n,last:i,widest:o,highest:a}=t._getLabelSizes(),l=2*r.padding,u=Dt(t.labelRotation),c=Math.cos(u),d=Math.sin(u);s?e.height=Math.min(t.maxHeight,e.height+(r.mirror?0:d*o.width+c*a.height)+l):e.width=Math.min(t.maxWidth,e.width+(r.mirror?0:c*o.width+d*a.height)+l),t._calculatePadding(n,i,d,c)}}t._handleMargins(),s?(t.width=t._length=n.width-t._margins.left-t._margins.right,t.height=e.height):(t.width=e.width,t.height=t._length=n.height-t._margins.top-t._margins.bottom)}_calculatePadding(t,e,n,r){const i=this,{ticks:{align:o,padding:a},position:s}=i.options,l=0!==i.labelRotation,u="top"!==s&&"x"===i.axis;if(i.isHorizontal()){const s=i.getPixelForTick(0)-i.left,c=i.right-i.getPixelForTick(i.ticks.length-1);let d=0,f=0;l?u?(d=r*t.width,f=n*e.height):(d=n*t.height,f=r*e.width):"start"===o?f=e.width:"end"===o?d=t.width:(d=t.width/2,f=e.width/2),i.paddingLeft=Math.max((d-s+a)*i.width/(i.width-s),0),i.paddingRight=Math.max((f-c+a)*i.width/(i.width-c),0)}else{let n=e.height/2,r=t.height/2;"start"===o?(n=0,r=t.height):"end"===o&&(n=e.height,r=0),i.paddingTop=n+a,i.paddingBottom=r+a}}_handleMargins(){const t=this;t._margins&&(t._margins.left=Math.max(t.paddingLeft,t._margins.left),t._margins.top=Math.max(t.paddingTop,t._margins.top),t._margins.right=Math.max(t.paddingRight,t._margins.right),t._margins.bottom=Math.max(t.paddingBottom,t._margins.bottom))}afterFit(){Y(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){const e=this;let n,r;for(e.beforeTickToLabelConversion(),e.generateTickLabels(t),n=0,r=t.length;n<r;n++)F(t[n].label)&&(t.splice(n,1),r--,n--);e.afterTickToLabelConversion()}_getLabelSizes(){const t=this;let e=t._labelSizes;if(!e){const n=t.options.ticks.sampleSize;let r=t.ticks;n<r.length&&(r=Vn(r,n)),t._labelSizes=e=t._computeLabelSizes(r,r.length)}return e}_computeLabelSizes(t,e){const{ctx:n,_longestTextCache:r}=this,i=[],o=[];let a,s,l,u,c,d,f,h,p,g,m,v=0,y=0;for(a=0;a<e;++a){if(u=t[a].label,c=this._resolveTickFontOptions(a),n.font=d=c.string,f=r[d]=r[d]||{data:{},gc:[]},h=c.lineHeight,p=g=0,F(u)||H(u)){if(H(u))for(s=0,l=u.length;s<l;++s)m=u[s],F(m)||H(m)||(p=Ht(n,f.data,f.gc,p,m),g+=h)}else p=Ht(n,f.data,f.gc,p,u),g=h;i.push(p),o.push(g),v=Math.max(p,v),y=Math.max(g,y)}!function(t,e){$(t,t=>{const n=t.gc,r=n.length/2;let i;if(r>e){for(i=0;i<r;++i)delete t.data[n[i]];n.splice(0,r)}})}(r,e);const x=i.indexOf(v),b=o.indexOf(y),_=t=>({width:i[t]||0,height:o[t]||0});return{first:_(0),last:_(e-1),widest:_(x),highest:_(b),widths:i,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){const e=this;e._reversePixels&&(t=1-t);const n=e._startPixel+t*e._length;return Vt(e._alignToPixels?jt(e.chart,n,0):n)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this,n=e.ticks||[];if(t>=0&&t<n.length){const r=n[t];return r.$context||(r.$context=function(t,e,n){return Object.assign(Object.create(t),{tick:n,index:e,type:"tick"})}(e.getContext(),t,r))}return e.$context||(e.$context=(r=e.chart.getContext(),i=e,Object.assign(Object.create(r),{scale:i,type:"scale"})));var r,i}_tickSize(){const t=this,e=t.options.ticks,n=Dt(t.labelRotation),r=Math.abs(Math.cos(n)),i=Math.abs(Math.sin(n)),o=t._getLabelSizes(),a=e.autoSkipPadding||0,s=o?o.widest.width+a:0,l=o?o.highest.height+a:0;return t.isHorizontal()?l*r>s*i?s/r:l/i:l*i<s*r?l/r:s/i}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this,n=e.axis,r=e.chart,i=e.options,{grid:o,position:a}=i,s=o.offset,l=e.isHorizontal(),u=e.ticks.length+(s?1:0),c=Hn(o),d=[],f=o.setContext(e.getContext()),h=f.drawBorder?f.borderWidth:0,p=h/2,g=function(t){return jt(r,t,h)};let m,v,y,x,b,_,w,S,C,M,T,k;if("top"===a)m=g(e.bottom),_=e.bottom-c,S=m-p,M=g(t.top)+p,k=t.bottom;else if("bottom"===a)m=g(e.top),M=t.top,k=g(t.bottom)-p,_=m+p,S=e.top+c;else if("left"===a)m=g(e.right),b=e.right-c,w=m-p,C=g(t.left)+p,T=t.right;else if("right"===a)m=g(e.left),C=t.left,T=g(t.right)-p,b=m+p,w=e.left+c;else if("x"===n){if("center"===a)m=g((t.top+t.bottom)/2+.5);else if(W(a)){const t=Object.keys(a)[0];m=g(e.chart.scales[t].getPixelForValue(a[t]))}M=t.top,k=t.bottom,_=m+p,S=_+c}else if("y"===n){if("center"===a)m=g((t.left+t.right)/2);else if(W(a)){const t=Object.keys(a)[0];m=g(e.chart.scales[t].getPixelForValue(a[t]))}b=m-p,w=b-c,C=t.left,T=t.right}const A=U(i.ticks.maxTicksLimit,u),I=Math.max(1,Math.ceil(u/A));for(v=0;v<u;v+=I){const t=o.setContext(e.getContext(v)),n=t.lineWidth,i=t.color,a=o.borderDash||[],u=t.borderDashOffset,c=t.tickWidth,f=t.tickColor,h=t.tickBorderDash||[],p=t.tickBorderDashOffset;y=Fn(e,v,s),void 0!==y&&(x=jt(r,y,n),l?b=w=C=T=x:_=S=M=k=x,d.push({tx1:b,ty1:_,tx2:w,ty2:S,x1:C,y1:M,x2:T,y2:k,width:n,color:i,borderDash:a,borderDashOffset:u,tickWidth:c,tickColor:f,tickBorderDash:h,tickBorderDashOffset:p}))}return e._ticksLength=u,e._borderValue=m,d}_computeLabelItems(t){const e=this,n=e.axis,r=e.options,{position:i,ticks:o}=r,a=e.isHorizontal(),s=e.ticks,{align:l,crossAlign:u,padding:c,mirror:d}=o,f=Hn(r.grid),h=f+c,p=d?-c:h,g=-Dt(e.labelRotation),m=[];let v,y,x,b,_,w,S,C,M,T,k,A,I="middle";if("top"===i)w=e.bottom-p,S=e._getXAxisLabelAlignment();else if("bottom"===i)w=e.top+p,S=e._getXAxisLabelAlignment();else if("left"===i){const t=e._getYAxisLabelAlignment(f);S=t.textAlign,_=t.x}else if("right"===i){const t=e._getYAxisLabelAlignment(f);S=t.textAlign,_=t.x}else if("x"===n){if("center"===i)w=(t.top+t.bottom)/2+h;else if(W(i)){const t=Object.keys(i)[0];w=e.chart.scales[t].getPixelForValue(i[t])+h}S=e._getXAxisLabelAlignment()}else if("y"===n){if("center"===i)_=(t.left+t.right)/2-h;else if(W(i)){const t=Object.keys(i)[0];_=e.chart.scales[t].getPixelForValue(i[t])}S=e._getYAxisLabelAlignment(f).textAlign}"y"===n&&("start"===l?I="top":"end"===l&&(I="bottom"));const D=e._getLabelSizes();for(v=0,y=s.length;v<y;++v){x=s[v],b=x.label;const t=o.setContext(e.getContext(v));C=e.getPixelForTick(v)+o.labelOffset,M=e._resolveTickFontOptions(v),T=M.lineHeight,k=H(b)?b.length:1;const n=k/2,r=t.color,l=t.textStrokeColor,c=t.textStrokeWidth;let f;if(a?(_=C,A="top"===i?"near"===u||0!==g?-k*T+T/2:"center"===u?-D.highest.height/2-n*T+T:T/2-D.highest.height:"near"===u||0!==g?T/2:"center"===u?D.highest.height/2-n*T:D.highest.height-k*T,d&&(A*=-1)):(w=C,A=(1-k)*T/2),t.showLabelBackdrop){const e=Ee(t.backdropPadding),n=D.heights[v],r=D.widths[v];let i=w+A-e.top,o=_-e.left;switch(I){case"middle":i-=n/2;break;case"bottom":i-=n}switch(S){case"center":o-=r/2;break;case"right":o-=r}f={left:o,top:i,width:r+e.width,height:n+e.height,color:t.backdropColor}}m.push({rotation:g,label:b,font:M,color:r,strokeColor:l,strokeWidth:c,textOffset:A,textAlign:S,textBaseline:I,translation:[_,w],backdrop:f})}return m}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-Dt(this.labelRotation))return"top"===t?"left":"right";let n="center";return"start"===e.align?n="left":"end"===e.align&&(n="right"),n}_getYAxisLabelAlignment(t){const e=this,{position:n,ticks:{crossAlign:r,mirror:i,padding:o}}=e.options,a=t+o,s=e._getLabelSizes().widest.width;let l,u;return"left"===n?i?(l="left",u=e.right+o):(u=e.right-a,"near"===r?l="right":"center"===r?(l="center",u-=s/2):(l="left",u=e.left)):"right"===n?i?(l="right",u=e.left+o):(u=e.left+a,"near"===r?l="left":"center"===r?(l="center",u+=s/2):(l="right",u=e.right)):l="right",{textAlign:l,x:u}}_computeLabelArea(){const t=this;if(t.options.ticks.mirror)return;const e=t.chart,n=t.options.position;return"left"===n||"right"===n?{top:0,left:t.left,bottom:e.height,right:t.right}:"top"===n||"bottom"===n?{top:t.top,left:0,bottom:t.bottom,right:e.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:n,top:r,width:i,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,r,i,o),t.restore())}getLineWidthForValue(t){const e=this,n=e.options.grid;if(!e._isVisible()||!n.display)return 0;const r=e.ticks.findIndex(e=>e.value===t);return r>=0?n.setContext(e.getContext(r)).lineWidth:0}drawGrid(t){const e=this,n=e.options.grid,r=e.ctx,i=e._gridLineItems||(e._gridLineItems=e._computeGridLineItems(t));let o,a;const s=(t,e,n)=>{n.width&&n.color&&(r.save(),r.lineWidth=n.width,r.strokeStyle=n.color,r.setLineDash(n.borderDash||[]),r.lineDashOffset=n.borderDashOffset,r.beginPath(),r.moveTo(t.x,t.y),r.lineTo(e.x,e.y),r.stroke(),r.restore())};if(n.display)for(o=0,a=i.length;o<a;++o){const t=i[o];n.drawOnChartArea&&s({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),n.drawTicks&&s({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const t=this,{chart:e,ctx:n,options:{grid:r}}=t,i=r.setContext(t.getContext()),o=r.drawBorder?i.borderWidth:0;if(!o)return;const a=r.setContext(t.getContext(0)).lineWidth,s=t._borderValue;let l,u,c,d;t.isHorizontal()?(l=jt(e,t.left,o)-o/2,u=jt(e,t.right,a)+a/2,c=d=s):(c=jt(e,t.top,o)-o/2,d=jt(e,t.bottom,a)+a/2,l=u=s),n.save(),n.lineWidth=i.borderWidth,n.strokeStyle=i.borderColor,n.beginPath(),n.moveTo(l,c),n.lineTo(u,d),n.stroke(),n.restore()}drawLabels(t){const e=this;if(!e.options.ticks.display)return;const n=e.ctx,r=e._computeLabelArea();r&&Xt(n,r);const i=e._labelItems||(e._labelItems=e._computeLabelItems(t));let o,a;for(o=0,a=i.length;o<a;++o){const t=i[o],e=t.font,r=t.label;t.backdrop&&(n.fillStyle=t.backdrop.color,n.fillRect(t.backdrop.left,t.backdrop.top,t.backdrop.width,t.backdrop.height)),Kt(n,r,0,t.textOffset,e,t)}r&&Yt(n)}drawTitle(){const{ctx:t,options:{position:e,title:n,reverse:r}}=this;if(!n.display)return;const o=Re(n.font),a=Ee(n.padding),s=n.align;let l=o.lineHeight/2;"bottom"===e?(l+=a.bottom,H(n.text)&&(l+=o.lineHeight*(n.text.length-1))):l+=a.top;const{titleX:u,titleY:c,maxWidth:d,rotation:f}=function(t,e,n,r){const{top:o,left:a,bottom:s,right:l}=t;let u,c,d,f=0;return t.isHorizontal()?(c=i(r,a,l),d=zn(t,n,e),u=l-a):(c=zn(t,n,e),d=i(r,s,o),f="left"===n?-xt:xt),{titleX:c,titleY:d,maxWidth:u,rotation:f}}(this,l,e,s);Kt(t,n.text,0,0,o,{color:n.color,maxWidth:d,rotation:f,textAlign:jn(s,e,r),textBaseline:"middle",translation:[u,c]})}draw(t){const e=this;e._isVisible()&&(e.drawBackground(),e.drawGrid(t),e.drawBorder(),e.drawTitle(),e.drawLabels(t))}_layers(){const t=this,e=t.options,n=e.ticks&&e.ticks.z||0,r=e.grid&&e.grid.z||0;return t._isVisible()&&t.draw===Gn.prototype.draw?[{z:r,draw(e){t.drawBackground(),t.drawGrid(e),t.drawTitle()}},{z:r+1,draw(){t.drawBorder()}},{z:n,draw(e){t.drawLabels(e)}}]:[{z:n,draw(e){t.draw(e)}}]}getMatchingVisibleMetas(t){const e=this,n=e.chart.getSortedVisibleDatasetMetas(),r=e.axis+"AxisID",i=[];let o,a;for(o=0,a=n.length;o<a;++o){const a=n[o];a[r]!==e.id||t&&a.type!==t||i.push(a)}return i}_resolveTickFontOptions(t){return Re(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this,e=t._resolveTickFontOptions(0).lineHeight;return(t.isHorizontal()?t.width:t.height)/e}}function Un(t,e=[""],n=t,r,i=(()=>t[0])){at(r)||(r=nr("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:n,_fallback:r,_getTarget:i,override:i=>Un([i,...t],e,n,r)};return new Proxy(o,{deleteProperty:(e,n)=>(delete e[n],delete e._keys,delete t[0][n],!0),get:(n,r)=>Zn(n,r,()=>function(t,e,n,r){let i;for(const o of e)if(i=nr(Yn(o,t),n),at(i))return $n(t,i)?tr(n,r,t,i):i}(r,e,t,n)),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>rr(t).includes(e),ownKeys:t=>rr(t),set:(t,e,n)=>((t._storage||(t._storage=i()))[e]=n,delete t[e],delete t._keys,!0)})}function qn(t,e,n,r){const i={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:Xn(t,r),setContext:e=>qn(t,e,n,r),override:i=>qn(t.override(i),e,n,r)};return new Proxy(i,{deleteProperty:(e,n)=>(delete e[n],delete t[n],!0),get:(t,e,n)=>Zn(t,e,()=>function(t,e,n){const{_proxy:r,_context:i,_subProxy:o,_descriptors:a}=t;let s=r[e];return st(s)&&a.isScriptable(e)&&(s=function(t,e,n,r){const{_proxy:i,_context:o,_subProxy:a,_stack:s}=n;if(s.has(t))throw new Error("Recursion detected: "+Array.from(s).join("->")+"->"+t);return s.add(t),e=e(o,a||r),s.delete(t),W(e)&&(e=tr(i._scopes,i,t,e)),e}(e,s,t,n)),H(s)&&s.length&&(s=function(t,e,n,r){const{_proxy:i,_context:o,_subProxy:a,_descriptors:s}=n;if(at(o.index)&&r(t))e=e[o.index%e.length];else if(W(e[0])){const n=e,r=i._scopes.filter(t=>t!==n);e=[];for(const l of n){const n=tr(r,i,t,l);e.push(qn(n,o,a&&a[t],s))}}return e}(e,s,t,a.isIndexable)),$n(e,s)&&(s=qn(s,i,o&&o[e],a)),s}(t,e,n)),getOwnPropertyDescriptor:(e,n)=>e._descriptors.allKeys?Reflect.has(t,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,n),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,n)=>Reflect.has(t,n),ownKeys:()=>Reflect.ownKeys(t),set:(e,n,r)=>(t[n]=r,delete e[n],!0)})}function Xn(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:r=e.indexable,_allKeys:i=e.allKeys}=t;return{allKeys:i,scriptable:n,indexable:r,isScriptable:st(n)?n:()=>n,isIndexable:st(r)?r:()=>r}}const Yn=(t,e)=>t?t+ot(e):e,$n=(t,e)=>W(e)&&"adapters"!==t;function Zn(t,e,n){let r=t[e];return at(r)||(r=n(),at(r)&&(t[e]=r)),r}function Kn(t,e,n){return st(t)?t(e,n):t}const Jn=(t,e)=>!0===t?e:"string"==typeof t?it(e,t):void 0;function Qn(t,e,n,r){for(const i of e){const e=Jn(n,i);if(e){t.add(e);const i=Kn(e._fallback,n,e);if(at(i)&&i!==n&&i!==r)return i}else if(!1===e&&at(r)&&n!==r)return null}return!1}function tr(t,e,n,r){const i=e._rootScopes,o=Kn(e._fallback,n,r),a=[...t,...i],s=new Set;s.add(r);let l=er(s,a,n,o||n);return null!==l&&(!at(o)||o===n||(l=er(s,a,o,l),null!==l))&&Un(Array.from(s),[""],i,o,()=>function(t,e,n){const r=t._getTarget();e in r||(r[e]={});const i=r[e];return H(i)&&W(n)?n:i}(e,n,r))}function er(t,e,n,r){for(;n;)n=Qn(t,e,n,r);return n}function nr(t,e){for(const n of e){if(!n)continue;const e=n[t];if(at(e))return e}}function rr(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const n of t)for(const t of Object.keys(n).filter(t=>!t.startsWith("_")))e.add(t);return Array.from(e)}(t._scopes)),e}const ir=Number.EPSILON||1e-14,or=(t,e)=>e<t.length&&!t[e].skip&&t[e],ar=t=>"x"===t?"y":"x";function sr(t,e,n,r){const i=t.skip?e:t,o=e,a=n.skip?e:n,s=Rt(o,i),l=Rt(a,o);let u=s/(s+l),c=l/(s+l);u=isNaN(u)?0:u,c=isNaN(c)?0:c;const d=r*u,f=r*c;return{previous:{x:o.x-d*(a.x-i.x),y:o.y-d*(a.y-i.y)},next:{x:o.x+f*(a.x-i.x),y:o.y+f*(a.y-i.y)}}}function lr(t,e="x"){const n=ar(e),r=t.length,i=Array(r).fill(0),o=Array(r);let a,s,l,u=or(t,0);for(a=0;a<r;++a)if(s=l,l=u,u=or(t,a+1),l){if(u){const t=u[e]-l[e];i[a]=0!==t?(u[n]-l[n])/t:0}o[a]=s?u?St(i[a-1])!==St(i[a])?0:(i[a-1]+i[a])/2:i[a-1]:i[a]}!function(t,e,n){const r=t.length;let i,o,a,s,l,u=or(t,0);for(let c=0;c<r-1;++c)l=u,u=or(t,c+1),l&&u&&(kt(e[c],0,ir)?n[c]=n[c+1]=0:(i=n[c]/e[c],o=n[c+1]/e[c],s=Math.pow(i,2)+Math.pow(o,2),s<=9||(a=3/Math.sqrt(s),n[c]=i*a*e[c],n[c+1]=o*a*e[c])))}(t,i,o),function(t,e,n="x"){const r=ar(n),i=t.length;let o,a,s,l=or(t,0);for(let u=0;u<i;++u){if(a=s,s=l,l=or(t,u+1),!s)continue;const i=s[n],c=s[r];a&&(o=(i-a[n])/3,s[`cp1${n}`]=i-o,s[`cp1${r}`]=c-o*e[u]),l&&(o=(l[n]-i)/3,s[`cp2${n}`]=i+o,s[`cp2${r}`]=c+o*e[u])}}(t,o,e)}function ur(t,e,n){return Math.max(Math.min(t,n),e)}function cr(t,e,n,r,i){let o,a,s,l;if(e.spanGaps&&(t=t.filter(t=>!t.skip)),"monotone"===e.cubicInterpolationMode)lr(t,i);else{let n=r?t[t.length-1]:t[0];for(o=0,a=t.length;o<a;++o)s=t[o],l=sr(n,s,t[Math.min(o+1,a-(r?0:1))%a],e.tension),s.cp1x=l.previous.x,s.cp1y=l.previous.y,s.cp2x=l.next.x,s.cp2y=l.next.y,n=s}e.capBezierPoints&&function(t,e){let n,r,i,o,a,s=qt(t[0],e);for(n=0,r=t.length;n<r;++n)a=o,o=s,s=n<r-1&&qt(t[n+1],e),o&&(i=t[n],a&&(i.cp1x=ur(i.cp1x,e.left,e.right),i.cp1y=ur(i.cp1y,e.top,e.bottom)),s&&(i.cp2x=ur(i.cp2x,e.left,e.right),i.cp2y=ur(i.cp2y,e.top,e.bottom)))}(t,n)}function dr(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function fr(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:"middle"===r?n<.5?t.y:e.y:"after"===r?n<1?t.y:e.y:n>0?e.y:t.y}}function hr(t,e,n,r){const i={x:t.cp2x,y:t.cp2y},o={x:e.cp1x,y:e.cp1y},a=dr(t,i,n),s=dr(i,o,n),l=dr(o,e,n),u=dr(a,s,n),c=dr(s,l,n);return dr(u,c,n)}function pr(t,e,n){return t?function(t,e){return{x:n=>t+t+e-n,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,n):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function gr(t,e){let n,r;"ltr"!==e&&"rtl"!==e||(n=t.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=r)}function mr(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function vr(t){return"angle"===t?{between:Bt,compare:Lt,normalize:Nt}:{between:(t,e,n)=>t>=Math.min(e,n)&&t<=Math.max(n,e),compare:(t,e)=>t-e,normalize:t=>t}}function yr({start:t,end:e,count:n,loop:r,style:i}){return{start:t%n,end:e%n,loop:r&&(e-t+1)%n==0,style:i}}function xr(t,e,n){if(!n)return[t];const{property:r,start:i,end:o}=n,a=e.length,{compare:s,between:l,normalize:u}=vr(r),{start:c,end:d,loop:f,style:h}=function(t,e,n){const{property:r,start:i,end:o}=n,{between:a,normalize:s}=vr(r),l=e.length;let u,c,{start:d,end:f,loop:h}=t;if(h){for(d+=l,f+=l,u=0,c=l;u<c&&a(s(e[d%l][r]),i,o);++u)d--,f--;d%=l,f%=l}return f<d&&(f+=l),{start:d,end:f,loop:h,style:t.style}}(t,e,n),p=[];let g,m,v,y=!1,x=null;for(let b=c,_=c;b<=d;++b)m=e[b%a],m.skip||(g=u(m[r]),g!==v&&(y=l(g,i,o),null===x&&(y||l(i,v,g)&&0!==s(i,v))&&(x=0===s(g,i)?b:_),null!==x&&(!y||0===s(o,g)||l(o,v,g))&&(p.push(yr({start:x,end:b,loop:f,count:a,style:h})),x=null),_=b,v=g));return null!==x&&p.push(yr({start:x,end:d,loop:f,count:a,style:h})),p}function br(t,e){const n=[],r=t.segments;for(let i=0;i<r.length;i++){const o=xr(r[i],t.points,e);o.length&&n.push(...o)}return n}function _r(t,e){const n=t.points,r=t.options.spanGaps,i=n.length;if(!i)return[];const o=!!t._loop,{start:a,end:s}=function(t,e,n,r){let i=0,o=e-1;if(n&&!r)for(;i<e&&!t[i].skip;)i++;for(;i<e&&t[i].skip;)i++;for(i%=e,n&&(o+=i);o>i&&t[o%e].skip;)o--;return o%=e,{start:i,end:o}}(n,i,o,r);return function(t,e,n){return n&&n.setContext&&e?function(t,e,n){const r=e.length,i=[];let o=t[0].start,a=o;for(const s of t){let t,l,u=e[o%r];for(a=o+1;a<=s.end;a++){const c=e[a%r];l=wr(n.setContext({type:"segment",p0:u,p1:c})),Sr(l,t)&&(i.push({start:o,end:a-1,loop:s.loop,style:t}),t=l,o=a-1),u=c,t=l}o<a-1&&(i.push({start:o,end:a-1,loop:s.loop,style:l}),o=a-1)}return i}(t,e,n):t}(!0===r?[{start:a,end:s,loop:o}]:function(t,e,n,r){const i=t.length,o=[];let a,s=e,l=t[e];for(a=e+1;a<=n;++a){const n=t[a%i];n.skip||n.stop?l.skip||(o.push({start:e%i,end:(a-1)%i,loop:r=!1}),e=s=n.stop?a:null):(s=a,l.skip&&(e=a)),l=n}return null!==s&&o.push({start:e%i,end:s%i,loop:r}),o}(n,a,s<a?s+i:s,!!t._fullLoop&&0===a&&s===i-1),n,e)}function wr(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Sr(t,e){return e&&JSON.stringify(t)!==JSON.stringify(e)}var Cr=Object.freeze({__proto__:null,easingEffects:pn,color:N,getHoverColor:B,noop:z,uid:V,isNullOrUndef:F,isArray:H,isObject:W,isFinite:j,finiteOrDefault:G,valueOrDefault:U,toPercentage:q,toDimension:X,callback:Y,each:$,_elementsEqual:Z,clone:K,_merger:Q,merge:tt,mergeIf:et,_mergerIf:nt,_deprecated:function(t,e,n,r){void 0!==e&&console.warn(t+': "'+n+'" is deprecated. Please use "'+r+'" instead')},resolveObjectKey:it,_capitalize:ot,defined:at,isFunction:st,setsEqual:lt,toFontString:Ft,_measureText:Ht,_longestText:Wt,_alignPixel:jt,clearCanvas:Gt,drawPoint:Ut,_isPointInArea:qt,clipArea:Xt,unclipArea:Yt,_steppedLineTo:$t,_bezierCurveTo:Zt,renderText:Kt,addRoundedRectPath:Qt,_lookup:te,_lookupByKey:ee,_rlookupByKey:ne,_filterBetween:re,listenArrayEvents:oe,unlistenArrayEvents:ae,_arrayUnique:se,_createResolver:Un,_attachContext:qn,_descriptors:Xn,splineCurve:sr,splineCurveMonotone:lr,_updateBezierControlPoints:cr,_getParentNode:le,getStyle:de,getRelativePosition:pe,getMaximumSize:me,retinaScale:ve,supportsEventListenerOptions:ye,readUsedSize:xe,fontString:function(t,e,n){return e+" "+t+"px "+n},requestAnimFrame:t,throttled:e,debounce:n,_toLeftRightCenter:r,_alignStartEnd:i,_textX:o,_pointInLine:dr,_steppedInterpolation:fr,_bezierInterpolation:hr,formatNumber:Rn,toLineHeight:Ie,_readValueToProps:De,toTRBL:Oe,toTRBLCorners:Pe,toPadding:Ee,toFont:Re,resolve:Le,_addGrace:Ne,PI:pt,TAU:gt,PITAU:mt,INFINITY:vt,RAD_PER_DEG:yt,HALF_PI:xt,QUARTER_PI:bt,TWO_THIRDS_PI:_t,log10:wt,sign:St,niceNum:Ct,_factorize:Mt,isNumber:Tt,almostEquals:kt,almostWhole:At,_setMinAndMaxByKey:It,toRadians:Dt,toDegrees:Ot,_decimalPlaces:Pt,getAngleFromPoint:Et,distanceBetweenPoints:Rt,_angleDiff:Lt,_normalizeAngle:Nt,_angleBetween:Bt,_limitValue:zt,_int16Range:Vt,getRtlAdapter:pr,overrideTextDirection:gr,restoreTextDirection:mr,_boundSegment:xr,_boundSegments:br,_computeSegments:_r});class Mr{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=this,n=Object.getPrototypeOf(t);let r;(function(t){return"id"in t&&"defaults"in t})(n)&&(r=e.register(n));const i=e.items,o=t.id,a=e.scope+"."+o;if(!o)throw new Error("class does not have id: "+t);return o in i||(i[o]=t,function(t,e,n){const r=tt(Object.create(null),[n?ht.get(n):{},ht.get(e),t.defaults]);ht.set(e,r),t.defaultRoutes&&function(t,e){Object.keys(e).forEach(n=>{const r=n.split("."),i=r.pop(),o=[t].concat(r).join("."),a=e[n].split("."),s=a.pop(),l=a.join(".");ht.route(o,i,l,s)})}(e,t.defaultRoutes),t.descriptors&&ht.describe(e,t.descriptors)}(t,a,r),e.override&&ht.override(t.id,t.overrides)),a}get(t){return this.items[t]}unregister(t){const e=this.items,n=t.id,r=this.scope;n in e&&delete e[n],r&&n in ht[r]&&(delete ht[r][n],this.override&&delete ut[n])}}var Tr=new class{constructor(){this.controllers=new Mr(On,"datasets",!0),this.elements=new Mr(Pn,"elements"),this.plugins=new Mr(Object,"plugins"),this.scales=new Mr(Gn,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,n){const r=this;[...e].forEach(e=>{const i=n||r._getRegistryForType(e);n||i.isForType(e)||i===r.plugins&&e.id?r._exec(t,i,e):$(e,e=>{const i=n||r._getRegistryForType(e);r._exec(t,i,e)})})}_exec(t,e,n){const r=ot(t);Y(n["before"+r],[],n),e[t](n),Y(n["after"+r],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){const r=e.get(t);if(void 0===r)throw new Error('"'+t+'" is not a registered '+n+".");return r}};class kr{constructor(){this._init=[]}notify(t,e,n,r){const i=this;"beforeInit"===e&&(i._init=i._createDescriptors(t,!0),i._notify(i._init,t,"install"));const o=r?i._descriptors(t).filter(r):i._descriptors(t),a=i._notify(o,t,e,n);return"destroy"===e&&(i._notify(o,t,"stop"),i._notify(i._init,t,"uninstall")),a}_notify(t,e,n,r){r=r||{};for(const i of t){const t=i.plugin;if(!1===Y(t[n],[e,r,i.options],t)&&r.cancelable)return!1}return!0}invalidate(){F(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const n=t&&t.config,r=U(n.options&&n.options.plugins,{}),i=function(t){const e=[],n=Object.keys(Tr.plugins.items);for(let i=0;i<n.length;i++)e.push(Tr.getPlugin(n[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const t=r[i];-1===e.indexOf(t)&&e.push(t)}return e}(n);return!1!==r||e?function(t,e,n,r){const i=[],o=t.getContext();for(let a=0;a<e.length;a++){const s=e[a],l=Ar(n[s.id],r);null!==l&&i.push({plugin:s,options:Ir(t.config,s,l,o)})}return i}(t,i,r,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],n=this._cache,r=(t,e)=>t.filter(t=>!e.some(e=>t.plugin.id===e.plugin.id));this._notify(r(e,n),t,"stop"),this._notify(r(n,e),t,"start")}}function Ar(t,e){return e||!1!==t?!0===t?{}:t:null}function Ir(t,e,n,r){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(n,i);return t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Dr(t,e){return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||(ht.datasets[t]||{}).indexAxis||"x"}function Or(t,e){return"x"===t||"y"===t?t:e.axis||("top"===(n=e.position)||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0)||t.charAt(0).toLowerCase();var n}function Pr(t){const e=t.options||(t.options={});e.plugins=U(e.plugins,{}),e.scales=function(t,e){const n=ut[t.type]||{scales:{}},r=e.scales||{},i=Dr(t.type,e),o=Object.create(null),a=Object.create(null);return Object.keys(r).forEach(t=>{const e=r[t],s=Or(t,e),l=function(t,e){return t===e?"_index_":"_value_"}(s,i),u=n.scales||{};o[s]=o[s]||t,a[t]=et(Object.create(null),[{axis:s},e,u[s],u[l]])}),t.data.datasets.forEach(n=>{const i=n.type||t.type,s=n.indexAxis||Dr(i,e),l=(ut[i]||{}).scales||{};Object.keys(l).forEach(t=>{const e=function(t,e){let n=t;return"_index_"===t?n=e:"_value_"===t&&(n="x"===e?"y":"x"),n}(t,s),i=n[e+"AxisID"]||o[e]||e;a[i]=a[i]||Object.create(null),et(a[i],[{axis:e},r[i],l[t]])})}),Object.keys(a).forEach(t=>{const e=a[t];et(e,[ht.scales[e.type],ht.scale])}),a}(t,e)}function Er(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const Rr=new Map,Lr=new Set;function Nr(t,e){let n=Rr.get(t);return n||(n=e(),Rr.set(t,n),Lr.add(n)),n}const Br=(t,e,n)=>{const r=it(e,n);void 0!==r&&t.add(r)};class zr{constructor(t){this._config=function(t){return(t=t||{}).data=Er(t.data),Pr(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Er(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Pr(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Nr(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return Nr(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return Nr(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id;return Nr(`${this.type}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const n=this._scopeCache;let r=n.get(t);return r&&!e||(r=new Map,n.set(t,r)),r}getOptionScopes(t,e,n){const{options:r,type:i}=this,o=this._cachedScopes(t,n),a=o.get(e);if(a)return a;const s=new Set;e.forEach(e=>{t&&(s.add(t),e.forEach(e=>Br(s,t,e))),e.forEach(t=>Br(s,r,t)),e.forEach(t=>Br(s,ut[i]||{},t)),e.forEach(t=>Br(s,ht,t)),e.forEach(t=>Br(s,ct,t))});const l=Array.from(s);return Lr.has(e)&&o.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,ut[e]||{},ht.datasets[e]||{},{type:e},ht,ct]}resolveNamedOptions(t,e,n,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=Vr(this._resolverCache,t,r);let s=o;(function(t,e){const{isScriptable:n,isIndexable:r}=Xn(t);for(const i of e)if(n(i)&&st(t[i])||r(i)&&H(t[i]))return!0;return!1})(o,e)&&(i.$shared=!1,s=qn(o,n=st(n)?n():n,this.createResolver(t,n,a)));for(const l of e)i[l]=s[l];return i}createResolver(t,e,n=[""],r){const{resolver:i}=Vr(this._resolverCache,t,n);return W(e)?qn(i,e,void 0,r):i}}function Vr(t,e,n){let r=t.get(e);r||(r=new Map,t.set(e,r));const i=n.join();let o=r.get(i);return o||(o={resolver:Un(e,n),subPrefixes:n.filter(t=>!t.toLowerCase().includes("hover"))},r.set(i,o)),o}const Fr=["top","bottom","left","right","chartArea"];function Hr(t,e){return"top"===t||"bottom"===t||-1===Fr.indexOf(t)&&"x"===e}function Wr(t,e){return function(n,r){return n[t]===r[t]?n[e]-r[e]:n[t]-r[t]}}function jr(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Y(n&&n.onComplete,[t],e)}function Gr(t){const e=t.chart,n=e.options.animation;Y(n&&n.onProgress,[t],e)}function Ur(){return"undefined"!=typeof window&&"undefined"!=typeof document}function qr(t){return Ur()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Xr={},Yr=t=>{const e=qr(t);return Object.values(Xr).filter(t=>t.canvas===e).pop()};class $r{constructor(t,e){const r=this;this.config=e=new zr(e);const i=qr(t),o=Yr(i);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas can be reused.");const s=e.createResolver(e.chartOptionScopes(),r.getContext());this.platform=r._initializePlatform(i,e);const l=r.platform.acquireContext(i,s.aspectRatio),u=l&&l.canvas,c=u&&u.height,d=u&&u.width;this.id=V(),this.ctx=l,this.canvas=u,this.width=d,this.height=c,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this.scale=void 0,this._plugins=new kr,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=n(()=>this.update("resize"),s.resizeDelay||0),Xr[r.id]=r,l&&u?(a.listen(r,"complete",jr),a.listen(r,"progress",Gr),r._initialize(),r.attached&&r.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:n,height:r,_aspectRatio:i}=this;return F(t)?e&&i?i:r?n/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}_initialize(){const t=this;return t.notifyPlugins("beforeInit"),t.options.responsive?t.resize():ve(t,t.options.devicePixelRatio),t.bindEvents(),t.notifyPlugins("afterInit"),t}_initializePlatform(t,e){return e.platform?new e.platform:!Ur()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas?new $e:new un}clear(){return Gt(this.canvas,this.ctx),this}stop(){return a.stop(this),this}resize(t,e){a.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const n=this,r=n.options,i=n.platform.getMaximumSize(n.canvas,t,e,r.maintainAspectRatio&&n.aspectRatio),o=r.devicePixelRatio||n.platform.getDevicePixelRatio();n.width=i.width,n.height=i.height,n._aspectRatio=n.aspectRatio,ve(n,o,!0)&&(n.notifyPlugins("resize",{size:i}),Y(r.onResize,[n,i],n),n.attached&&n._doResize()&&n.render())}ensureScalesHaveIDs(){$(this.options.scales||{},(t,e)=>{t.id=e})}buildOrUpdateScales(){const t=this,e=t.options,n=e.scales,r=t.scales,i=Object.keys(r).reduce((t,e)=>(t[e]=!1,t),{});let o=[];n&&(o=o.concat(Object.keys(n).map(t=>{const e=n[t],r=Or(t,e),i="r"===r,o="x"===r;return{options:e,dposition:i?"chartArea":o?"bottom":"left",dtype:i?"radialLinear":o?"category":"linear"}}))),$(o,n=>{const o=n.options,a=o.id,s=Or(a,o),l=U(o.type,n.dtype);void 0!==o.position&&Hr(o.position,s)===Hr(n.dposition)||(o.position=n.dposition),i[a]=!0;let u=null;a in r&&r[a].type===l?u=r[a]:(u=new(Tr.getScale(l))({id:a,type:l,ctx:t.ctx,chart:t}),r[u.id]=u),u.init(o,e)}),$(i,(t,e)=>{t||delete r[e]}),$(r,e=>{Xe.configure(t,e,e.options),Xe.addBox(t,e)})}_updateMetasets(){const t=this,e=t._metasets,n=t.data.datasets.length,r=e.length;if(e.sort((t,e)=>t.index-e.index),r>n){for(let e=n;e<r;++e)t._destroyDatasetMeta(e);e.splice(n,r-n)}t._sortedMetasets=e.slice(0).sort(Wr("order","index"))}_removeUnreferencedMetasets(){const t=this,{_metasets:e,data:{datasets:n}}=t;e.length>n.length&&delete t._stacks,e.forEach((e,r)=>{0===n.filter(t=>t===e._dataset).length&&t._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=this,e=[],n=t.data.datasets;let r,i;for(t._removeUnreferencedMetasets(),r=0,i=n.length;r<i;r++){const i=n[r];let o=t.getDatasetMeta(r);const a=i.type||t.config.type;if(o.type&&o.type!==a&&(t._destroyDatasetMeta(r),o=t.getDatasetMeta(r)),o.type=a,o.indexAxis=i.indexAxis||Dr(a,t.options),o.order=i.order||0,o.index=r,o.label=""+i.label,o.visible=t.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const n=Tr.getController(a),{datasetElementType:i,dataElementType:s}=ht.datasets[a];Object.assign(n.prototype,{dataElementType:Tr.getElement(s),datasetElementType:i&&Tr.getElement(i)}),o.controller=new n(t,r),e.push(o.controller)}}return t._updateMetasets(),e}_resetElements(){const t=this;$(t.data.datasets,(e,n)=>{t.getDatasetMeta(n).controller.reset()},t)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this,n=e.config;n.update(),e._options=n.createResolver(n.chartOptionScopes(),e.getContext()),$(e.scales,t=>{Xe.removeBox(e,t)});const r=e._animationsDisabled=!e.options.animation;e.ensureScalesHaveIDs(),e.buildOrUpdateScales();const i=new Set(Object.keys(e._listeners)),o=new Set(e.options.events);if(lt(i,o)&&!!this._responsiveListeners===e.options.responsive||(e.unbindEvents(),e.bindEvents()),e._plugins.invalidate(),!1===e.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const a=e.buildOrUpdateControllers();e.notifyPlugins("beforeElementsUpdate");let s=0;for(let l=0,u=e.data.datasets.length;l<u;l++){const{controller:t}=e.getDatasetMeta(l),n=!r&&-1===a.indexOf(t);t.buildOrUpdateElements(n),s=Math.max(+t.getMaxOverflow(),s)}e._minPadding=s,e._updateLayout(s),r||$(a,t=>{t.reset()}),e._updateDatasets(t),e.notifyPlugins("afterUpdate",{mode:t}),e._layers.sort(Wr("z","_idx")),e._lastEvent&&e._eventHandler(e._lastEvent,!0),e.render()}_updateLayout(t){const e=this;if(!1===e.notifyPlugins("beforeLayout",{cancelable:!0}))return;Xe.update(e,e.width,e.height,t);const n=e.chartArea,r=n.width<=0||n.height<=0;e._layers=[],$(e.boxes,t=>{r&&"chartArea"===t.position||(t.configure&&t.configure(),e._layers.push(...t._layers()))},e),e._layers.forEach((t,e)=>{t._idx=e}),e.notifyPlugins("afterLayout")}_updateDatasets(t){const e=this,n="function"==typeof t;if(!1!==e.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let r=0,i=e.data.datasets.length;r<i;++r)e._updateDataset(r,n?t({datasetIndex:r}):t);e.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const n=this,r=n.getDatasetMeta(t),i={meta:r,index:t,mode:e,cancelable:!0};!1!==n.notifyPlugins("beforeDatasetUpdate",i)&&(r.controller._update(e),i.cancelable=!1,n.notifyPlugins("afterDatasetUpdate",i))}render(){const t=this;!1!==t.notifyPlugins("beforeRender",{cancelable:!0})&&(a.has(t)?t.attached&&!a.running(t)&&a.start(t):(t.draw(),jr({chart:t})))}draw(){const t=this;let e;if(t._resizeBeforeDraw){const{width:e,height:n}=t._resizeBeforeDraw;t._resize(e,n),t._resizeBeforeDraw=null}if(t.clear(),t.width<=0||t.height<=0)return;if(!1===t.notifyPlugins("beforeDraw",{cancelable:!0}))return;const n=t._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(t.chartArea);for(t._drawDatasets();e<n.length;++e)n[e].draw(t.chartArea);t.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,n=[];let r,i;for(r=0,i=e.length;r<i;++r){const i=e[r];t&&!i.visible||n.push(i)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){const t=this;if(!1===t.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=t.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)t._drawDataset(e[n]);t.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this,n=e.ctx,r=t._clip,i=!r.disabled,o=e.chartArea,a={meta:t,index:t.index,cancelable:!0};!1!==e.notifyPlugins("beforeDatasetDraw",a)&&(i&&Xt(n,{left:!1===r.left?0:o.left-r.left,right:!1===r.right?e.width:o.right+r.right,top:!1===r.top?0:o.top-r.top,bottom:!1===r.bottom?e.height:o.bottom+r.bottom}),t.controller.draw(),i&&Yt(n),a.cancelable=!1,e.notifyPlugins("afterDatasetDraw",a))}getElementsAtEventForMode(t,e,n,r){const i=Te.modes[e];return"function"==typeof i?i(this,t,n,r):[]}getDatasetMeta(t){const e=this.data.datasets[t],n=this._metasets;let r=n.filter(t=>t&&t._dataset===e).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},n.push(r)),r}getContext(){return this.$context||(this.$context={chart:this,type:"chart"})}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const n=this.getDatasetMeta(t);return"boolean"==typeof n.hidden?!n.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateDatasetVisibility(t,e){const n=this,r=e?"show":"hide",i=n.getDatasetMeta(t),o=i.controller._resolveAnimations(void 0,r);n.setDatasetVisibility(t,e),o.update(i,{visible:e}),n.update(e=>e.datasetIndex===t?r:void 0)}hide(t){this._updateDatasetVisibility(t,!1)}show(t){this._updateDatasetVisibility(t,!0)}_destroyDatasetMeta(t){const e=this,n=e._metasets&&e._metasets[t];n&&n.controller&&(n.controller._destroy(),delete e._metasets[t])}destroy(){const t=this,{canvas:e,ctx:n}=t;let r,i;for(t.stop(),a.remove(t),r=0,i=t.data.datasets.length;r<i;++r)t._destroyDatasetMeta(r);t.config.clearCache(),e&&(t.unbindEvents(),Gt(e,n),t.platform.releaseContext(n),t.canvas=null,t.ctx=null),t.notifyPlugins("destroy"),delete Xr[t.id]}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this,e=t._listeners,n=t.platform,r=function(e,n,r){e.offsetX=n,e.offsetY=r,t._eventHandler(e)};$(t.options.events,i=>((r,i)=>{n.addEventListener(t,r,i),e[r]=i})(i,r))}bindResponsiveEvents(){const t=this;t._responsiveListeners||(t._responsiveListeners={});const e=t._responsiveListeners,n=t.platform,r=(r,i)=>{n.addEventListener(t,r,i),e[r]=i},i=(r,i)=>{e[r]&&(n.removeEventListener(t,r,i),delete e[r])},o=(e,n)=>{t.canvas&&t.resize(e,n)};let a;const s=()=>{i("attach",s),t.attached=!0,t.resize(),r("resize",o),r("detach",a)};a=()=>{t.attached=!1,i("resize",o),r("attach",s)},n.isAttached(t.canvas)?s():a()}unbindEvents(){const t=this;$(t._listeners,(e,n)=>{t.platform.removeEventListener(t,n,e)}),t._listeners={},$(t._responsiveListeners,(e,n)=>{t.platform.removeEventListener(t,n,e)}),t._responsiveListeners=void 0}updateHoverStyle(t,e,n){const r=n?"set":"remove";let i,o,a,s;for("dataset"===e&&(i=this.getDatasetMeta(t[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),a=0,s=t.length;a<s;++a){o=t[a];const e=o&&this.getDatasetMeta(o.datasetIndex).controller;e&&e[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this,n=e._active||[],r=t.map(({datasetIndex:t,index:n})=>{const r=e.getDatasetMeta(t);if(!r)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:r.data[n],index:n}});!Z(r,n)&&(e._active=r,e._updateHoverStyles(r,n))}notifyPlugins(t,e,n){return this._plugins.notify(this,t,e,n)}_updateHoverStyles(t,e,n){const r=this,i=r.options.hover,o=(t,e)=>t.filter(t=>!e.some(e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)),a=o(e,t),s=n?t:o(t,e);a.length&&r.updateHoverStyle(a,i.mode,!1),s.length&&i.mode&&r.updateHoverStyle(s,i.mode,!0)}_eventHandler(t,e){const n=this,r={event:t,replay:e,cancelable:!0},i=e=>(e.options.events||this.options.events).includes(t.type);if(!1===n.notifyPlugins("beforeEvent",r,i))return;const o=n._handleEvent(t,e);return r.cancelable=!1,n.notifyPlugins("afterEvent",r,i),(o||r.changed)&&n.render(),n}_handleEvent(t,e){const n=this,{_active:r=[],options:i}=n,o=i.hover;let a=[],s=!1,l=null;return"mouseout"!==t.type&&(a=n.getElementsAtEventForMode(t,o.mode,o,e),l="click"===t.type?n._lastEvent:t),n._lastEvent=null,qt(t,n.chartArea,n._minPadding)&&(Y(i.onHover,[t,a,n],n),"mouseup"!==t.type&&"click"!==t.type&&"contextmenu"!==t.type||Y(i.onClick,[t,a,n],n)),s=!Z(a,r),(s||e)&&(n._active=a,n._updateHoverStyles(a,r,e)),n._lastEvent=l,s}}const Zr=()=>$($r.instances,t=>t._plugins.invalidate()),Kr=!0;function Jr(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}Object.defineProperties($r,{defaults:{enumerable:Kr,value:ht},instances:{enumerable:Kr,value:Xr},overrides:{enumerable:Kr,value:ut},registry:{enumerable:Kr,value:Tr},version:{enumerable:Kr,value:"3.4.1"},getChart:{enumerable:Kr,value:Yr},register:{enumerable:Kr,value:(...t)=>{Tr.add(...t),Zr()}},unregister:{enumerable:Kr,value:(...t)=>{Tr.remove(...t),Zr()}}});class Qr{constructor(t){this.options=t||{}}formats(){return Jr()}parse(t,e){return Jr()}format(t,e){return Jr()}add(t,e,n){return Jr()}diff(t,e,n){return Jr()}startOf(t,e,n){return Jr()}endOf(t,e){return Jr()}}Qr.override=function(t){Object.assign(Qr.prototype,t)};var ti={_date:Qr};function ei(t){const e=function(t){if(!t._cache.$bar){const e=t.getMatchingVisibleMetas("bar");let n=[];for(let r=0,i=e.length;r<i;r++)n=n.concat(e[r].controller.getAllParsedValues(t));t._cache.$bar=se(n.sort((t,e)=>t-e))}return t._cache.$bar}(t);let n,r,i,o,a=t._length;const s=()=>{32767!==i&&-32768!==i&&(at(o)&&(a=Math.min(a,Math.abs(i-o)||a)),o=i)};for(n=0,r=e.length;n<r;++n)i=t.getPixelForValue(e[n]),s();for(o=void 0,n=0,r=t.ticks.length;n<r;++n)i=t.getPixelForTick(n),s();return a}function ni(t,e,n,r){return H(t)?function(t,e,n,r){const i=n.parse(t[0],r),o=n.parse(t[1],r),a=Math.min(i,o),s=Math.max(i,o);let l=a,u=s;Math.abs(a)>Math.abs(s)&&(l=s,u=a),e[n.axis]=u,e._custom={barStart:l,barEnd:u,start:i,end:o,min:a,max:s}}(t,e,n,r):e[n.axis]=n.parse(t,r),e}function ri(t,e,n,r){const i=t.iScale,o=t.vScale,a=i.getLabels(),s=i===o,l=[];let u,c,d,f;for(u=n,c=n+r;u<c;++u)f=e[u],d={},d[i.axis]=s||i.parse(a[u],u),l.push(ni(f,d,o,u));return l}function ii(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}class oi extends On{parsePrimitiveData(t,e,n,r){return ri(t,e,n,r)}parseArrayData(t,e,n,r){return ri(t,e,n,r)}parseObjectData(t,e,n,r){const{iScale:i,vScale:o}=t,{xAxisKey:a="x",yAxisKey:s="y"}=this._parsing,l="x"===i.axis?a:s,u="x"===o.axis?a:s,c=[];let d,f,h,p;for(d=n,f=n+r;d<f;++d)p=e[d],h={},h[i.axis]=i.parse(it(p,l),d),c.push(ni(it(p,u),h,o,d));return c}updateRangeFromParsed(t,e,n,r){super.updateRangeFromParsed(t,e,n,r);const i=n._custom;i&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,i.min),t.max=Math.max(t.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:n,vScale:r}=e,i=this.getParsed(t),o=i._custom,a=ii(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+n.getLabelForValue(i[n.axis]),value:a}}initialize(){const t=this;t.enableOptionSharing=!0,super.initialize(),t._cachedMeta.stack=t.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,n,r){const i=this,o="reset"===r,a=i._cachedMeta.vScale,s=a.getBasePixel(),l=a.isHorizontal(),u=i._getRuler(),c=i.resolveDataElementOptions(e,r),d=i.getSharedOptions(c),f=i.includeOptions(r,d);i.updateSharedOptions(d,r,c);for(let h=e;h<e+n;h++){const e=i.getParsed(h),n=o||F(e[a.axis])?{base:s,head:s}:i._calculateBarValuePixels(h),c=i._calculateBarIndexPixels(h,u),p=(e._stacks||{})[a.axis],g={horizontal:l,base:n.base,enableBorderRadius:!p||ii(e._custom)||i.index===p._top||i.index===p._bottom,x:l?n.head:c.center,y:l?c.center:n.head,height:l?c.size:Math.abs(n.size),width:l?Math.abs(n.size):c.size};f&&(g.options=d||i.resolveDataElementOptions(h,t[h].active?"active":r)),i.updateElement(t[h],h,g,r)}}_getStacks(t,e){const n=this._cachedMeta.iScale,r=n.getMatchingVisibleMetas(this._type),i=n.options.stacked,o=r.length,a=[];let s,l;for(s=0;s<o;++s)if(l=r[s],l.controller.options.grouped){if(void 0!==e){const t=l.controller.getParsed(e)[l.controller._cachedMeta.vScale.axis];if(F(t)||isNaN(t))continue}if((!1===i||-1===a.indexOf(l.stack)||void 0===i&&void 0===l.stack)&&a.push(l.stack),l.index===t)break}return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,n){const r=this._getStacks(t,n),i=void 0!==e?r.indexOf(e):-1;return-1===i?r.length-1:i}_getRuler(){const t=this,e=t.options,n=t._cachedMeta,r=n.iScale,i=[];let o,a;for(o=0,a=n.data.length;o<a;++o)i.push(r.getPixelForValue(t.getParsed(o)[r.axis],o));const s=e.barThickness;return{min:s||ei(r),pixels:i,start:r._startPixel,end:r._endPixel,stackCount:t._getStackCount(),scale:r,grouped:e.grouped,ratio:s?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(t){const e=this,{vScale:n,_stacked:r}=e._cachedMeta,{base:i,minBarLength:o}=e.options,a=e.getParsed(t),s=a._custom,l=ii(s);let u,c,d=a[n.axis],f=0,h=r?e.applyStack(n,a,r):d;h!==d&&(f=h-d,h=d),l&&(d=s.barStart,h=s.barEnd-s.barStart,0!==d&&St(d)!==St(s.barEnd)&&(f=0),f+=d);const p=F(i)||l?f:i;let g=n.getPixelForValue(p);u=this.chart.getDataVisibility(t)?n.getPixelForValue(f+h):g,c=u-g,void 0!==o&&Math.abs(c)<o&&(c=c<0?-o:o,0===d&&(g-=c/2),u=g+c);const m=i||0;if(g===n.getPixelForValue(m)){const t=n.getLineWidthForValue(m)/2;c>0?(g+=t,c-=t):c<0&&(g-=t,c+=t)}return{size:c,base:g,head:u,center:u+c/2}}_calculateBarIndexPixels(t,e){const n=this,r=e.scale,i=n.options,o=i.skipNull,a=U(i.maxBarThickness,1/0);let s,l;if(e.grouped){const r=o?n._getStackCount(t):e.stackCount,u="flex"===i.barThickness?function(t,e,n,r){const i=e.pixels,o=i[t];let a=t>0?i[t-1]:null,s=t<i.length-1?i[t+1]:null;const l=n.categoryPercentage;null===a&&(a=o-(null===s?e.end-e.start:s-o)),null===s&&(s=o+o-a);const u=o-(o-Math.min(a,s))/2*l;return{chunk:Math.abs(s-a)/2*l/r,ratio:n.barPercentage,start:u}}(t,e,i,r):function(t,e,n,r){const i=n.barThickness;let o,a;return F(i)?(o=e.min*n.categoryPercentage,a=n.barPercentage):(o=i*r,a=1),{chunk:o/r,ratio:a,start:e.pixels[t]-o/2}}(t,e,i,r),c=n._getStackIndex(n.index,n._cachedMeta.stack,o?t:void 0);s=u.start+u.chunk*c+u.chunk/2,l=Math.min(a,u.chunk*u.ratio)}else s=r.getPixelForValue(n.getParsed(t)[r.axis],t),l=Math.min(a,e.min*e.ratio);return{base:s-l/2,head:s+l/2,center:s,size:l}}draw(){const t=this,e=t._cachedMeta,n=e.vScale,r=e.data,i=r.length;let o=0;for(;o<i;++o)null!==t.getParsed(o)[n.axis]&&r[o].draw(t._ctx)}}oi.id="bar",oi.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},oi.overrides={interaction:{mode:"index"},scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class ai extends On{initialize(){this.enableOptionSharing=!0,super.initialize()}parseObjectData(t,e,n,r){const{xScale:i,yScale:o}=t,{xAxisKey:a="x",yAxisKey:s="y"}=this._parsing,l=[];let u,c,d;for(u=n,c=n+r;u<c;++u)d=e[u],l.push({x:i.parse(it(d,a),u),y:o.parse(it(d,s),u),_custom:d&&d.r&&+d.r});return l}getMaxOverflow(){const{data:t,_parsed:e}=this._cachedMeta;let n=0;for(let r=t.length-1;r>=0;--r)n=Math.max(n,t[r].size()/2,e[r]._custom);return n>0&&n}getLabelAndValue(t){const e=this._cachedMeta,{xScale:n,yScale:r}=e,i=this.getParsed(t),o=n.getLabelForValue(i.x),a=r.getLabelForValue(i.y),s=i._custom;return{label:e.label,value:"("+o+", "+a+(s?", "+s:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,n,r){const i=this,o="reset"===r,{iScale:a,vScale:s}=i._cachedMeta,l=i.resolveDataElementOptions(e,r),u=i.getSharedOptions(l),c=i.includeOptions(r,u),d=a.axis,f=s.axis;for(let h=e;h<e+n;h++){const e=t[h],n=!o&&i.getParsed(h),l={},u=l[d]=o?a.getPixelForDecimal(.5):a.getPixelForValue(n[d]),p=l[f]=o?s.getBasePixel():s.getPixelForValue(n[f]);l.skip=isNaN(u)||isNaN(p),c&&(l.options=i.resolveDataElementOptions(h,e.active?"active":r),o&&(l.options.radius=0)),i.updateElement(e,h,l,r)}i.updateSharedOptions(u,r,l)}resolveDataElementOptions(t,e){const n=this.getParsed(t);let r=super.resolveDataElementOptions(t,e);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const i=r.radius;return"active"!==e&&(r.radius=0),r.radius+=U(n&&n._custom,i),r}}ai.id="bubble",ai.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},ai.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title:()=>""}}}};class si extends On{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const n=this.getDataset().data,r=this._cachedMeta;let i,o;for(i=t,o=t+e;i<o;++i)r._parsed[i]=+n[i]}_getRotation(){return Dt(this.options.rotation-90)}_getCircumference(){return Dt(this.options.circumference)}_getRotationExtents(){let t=gt,e=-gt;const n=this;for(let r=0;r<n.chart.data.datasets.length;++r)if(n.chart.isDatasetVisible(r)){const i=n.chart.getDatasetMeta(r).controller,o=i._getRotation(),a=i._getCircumference();t=Math.min(t,o),e=Math.max(e,o+a)}return{rotation:t,circumference:e-t}}update(t){const e=this,n=e.chart,{chartArea:r}=n,i=e._cachedMeta,o=i.data,a=e.getMaxBorderWidth()+e.getMaxOffset(o)+e.options.spacing,s=Math.max((Math.min(r.width,r.height)-a)/2,0),l=Math.min(q(e.options.cutout,s),1),u=e._getRingWeight(e.index),{circumference:c,rotation:d}=e._getRotationExtents(),{ratioX:f,ratioY:h,offsetX:p,offsetY:g}=function(t,e,n){let r=1,i=1,o=0,a=0;if(e<gt){const s=t,l=s+e,u=Math.cos(s),c=Math.sin(s),d=Math.cos(l),f=Math.sin(l),h=(t,e,r)=>Bt(t,s,l,!0)?1:Math.max(e,e*n,r,r*n),p=(t,e,r)=>Bt(t,s,l,!0)?-1:Math.min(e,e*n,r,r*n),g=h(0,u,d),m=h(xt,c,f),v=p(pt,u,d),y=p(pt+xt,c,f);r=(g-v)/2,i=(m-y)/2,o=-(g+v)/2,a=-(m+y)/2}return{ratioX:r,ratioY:i,offsetX:o,offsetY:a}}(d,c,l),m=Math.max(Math.min((r.width-a)/f,(r.height-a)/h)/2,0),v=X(e.options.radius,m),y=(v-Math.max(v*l,0))/e._getVisibleDatasetWeightTotal();e.offsetX=p*v,e.offsetY=g*v,i.total=e.calculateTotal(),e.outerRadius=v-y*e._getRingWeightOffset(e.index),e.innerRadius=Math.max(e.outerRadius-y*u,0),e.updateElements(o,0,o.length,t)}_circumference(t,e){const n=this,r=n.options,i=n._cachedMeta,o=n._getCircumference();return e&&r.animation.animateRotate||!this.chart.getDataVisibility(t)||null===i._parsed[t]?0:n.calculateCircumference(i._parsed[t]*o/gt)}updateElements(t,e,n,r){const i=this,o="reset"===r,a=i.chart,s=a.chartArea,l=(s.left+s.right)/2,u=(s.top+s.bottom)/2,c=o&&a.options.animation.animateScale,d=c?0:i.innerRadius,f=c?0:i.outerRadius,h=i.resolveDataElementOptions(e,r),p=i.getSharedOptions(h),g=i.includeOptions(r,p);let m,v=i._getRotation();for(m=0;m<e;++m)v+=i._circumference(m,o);for(m=e;m<e+n;++m){const e=i._circumference(m,o),n=t[m],a={x:l+i.offsetX,y:u+i.offsetY,startAngle:v,endAngle:v+e,circumference:e,outerRadius:f,innerRadius:d};g&&(a.options=p||i.resolveDataElementOptions(m,n.active?"active":r)),v+=e,i.updateElement(n,m,a,r)}i.updateSharedOptions(p,r,h)}calculateTotal(){const t=this._cachedMeta,e=t.data;let n,r=0;for(n=0;n<e.length;n++){const e=t._parsed[n];null!==e&&!isNaN(e)&&this.chart.getDataVisibility(n)&&(r+=Math.abs(e))}return r}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?gt*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this.chart,n=e.data.labels||[],r=Rn(this._cachedMeta._parsed[t],e.options.locale);return{label:n[t]||"",value:r}}getMaxBorderWidth(t){const e=this;let n=0;const r=e.chart;let i,o,a,s,l;if(!t)for(i=0,o=r.data.datasets.length;i<o;++i)if(r.isDatasetVisible(i)){a=r.getDatasetMeta(i),t=a.data,s=a.controller,s!==e&&s.configure();break}if(!t)return 0;for(i=0,o=t.length;i<o;++i)l=s.resolveDataElementOptions(i),"inner"!==l.borderAlign&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(t){let e=0;for(let n=0,r=t.length;n<r;++n){const t=this.resolveDataElementOptions(n);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(e+=this._getRingWeight(n));return e}_getRingWeight(t){return Math.max(U(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}si.id="doughnut",si.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},si.descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t},si.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n}}=t.legend.options;return e.labels.map((e,r)=>{const i=t.getDatasetMeta(0).controller.getStyle(r);return{text:e,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,lineWidth:i.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(r),index:r}})}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}},tooltip:{callbacks:{title:()=>"",label(t){let e=t.label;const n=": "+t.formattedValue;return H(e)?(e=e.slice(),e[0]+=n):e+=n,e}}}}};class li extends On{initialize(){this.enableOptionSharing=!0,super.initialize()}update(t){const e=this,n=e._cachedMeta,{dataset:r,data:i=[],_dataset:o}=n,a=e.chart._animationsDisabled;let{start:s,count:l}=function(t,e,n){const r=e.length;let i=0,o=r;if(t._sorted){const{iScale:a,_parsed:s}=t,l=a.axis,{min:u,max:c,minDefined:d,maxDefined:f}=a.getUserBounds();d&&(i=zt(Math.min(ee(s,a.axis,u).lo,n?r:ee(e,l,a.getPixelForValue(u)).lo),0,r-1)),o=f?zt(Math.max(ee(s,a.axis,c).hi+1,n?0:ee(e,l,a.getPixelForValue(c)).hi+1),i,r)-i:r-i}return{start:i,count:o}}(n,i,a);e._drawStart=s,e._drawCount=l,function(t){const{xScale:e,yScale:n,_scaleRanges:r}=t,i={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!r)return t._scaleRanges=i,!0;const o=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,i),o}(n)&&(s=0,l=i.length),r._decimated=!!o._decimated,r.points=i;const u=e.resolveDatasetElementOptions(t);e.options.showLine||(u.borderWidth=0),u.segment=e.options.segment,e.updateElement(r,void 0,{animated:!a,options:u},t),e.updateElements(i,s,l,t)}updateElements(t,e,n,r){const i=this,o="reset"===r,{iScale:a,vScale:s,_stacked:l}=i._cachedMeta,u=i.resolveDataElementOptions(e,r),c=i.getSharedOptions(u),d=i.includeOptions(r,c),f=a.axis,h=s.axis,p=i.options.spanGaps,g=Tt(p)?p:Number.POSITIVE_INFINITY,m=i.chart._animationsDisabled||o||"none"===r;let v=e>0&&i.getParsed(e-1);for(let y=e;y<e+n;++y){const e=t[y],n=i.getParsed(y),u=m?e:{},p=F(n[h]),x=u[f]=a.getPixelForValue(n[f],y),b=u[h]=o||p?s.getBasePixel():s.getPixelForValue(l?i.applyStack(s,n,l):n[h],y);u.skip=isNaN(x)||isNaN(b)||p,u.stop=y>0&&n[f]-v[f]>g,u.parsed=n,d&&(u.options=c||i.resolveDataElementOptions(y,e.active?"active":r)),m||i.updateElement(e,y,u,r),v=n}i.updateSharedOptions(c,r,u)}getMaxOverflow(){const t=this,e=t._cachedMeta,n=e.dataset,r=n.options&&n.options.borderWidth||0,i=e.data||[];if(!i.length)return r;const o=i[0].size(t.resolveDataElementOptions(0)),a=i[i.length-1].size(t.resolveDataElementOptions(i.length-1));return Math.max(r,o,a)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}li.id="line",li.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},li.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class ui extends On{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this.chart,n=e.data.labels||[],r=Rn(this._cachedMeta._parsed[t].r,e.options.locale);return{label:n[t]||"",value:r}}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}_updateRadius(){const t=this,e=t.chart,n=e.chartArea,r=e.options,i=Math.min(n.right-n.left,n.bottom-n.top),o=Math.max(i/2,0),a=(o-Math.max(r.cutoutPercentage?o/100*r.cutoutPercentage:1,0))/e.getVisibleDatasetCount();t.outerRadius=o-a*t.index,t.innerRadius=t.outerRadius-a}updateElements(t,e,n,r){const i=this,o="reset"===r,a=i.chart,s=i.getDataset(),l=a.options.animation,u=i._cachedMeta.rScale,c=u.xCenter,d=u.yCenter,f=u.getIndexAngle(0)-.5*pt;let h,p=f;const g=360/i.countVisibleElements();for(h=0;h<e;++h)p+=i._computeAngle(h,r,g);for(h=e;h<e+n;h++){const e=t[h];let n=p,m=p+i._computeAngle(h,r,g),v=a.getDataVisibility(h)?u.getDistanceFromCenterForValue(s.data[h]):0;p=m,o&&(l.animateScale&&(v=0),l.animateRotate&&(n=m=f));const y={x:c,y:d,innerRadius:0,outerRadius:v,startAngle:n,endAngle:m,options:i.resolveDataElementOptions(h,e.active?"active":r)};i.updateElement(e,h,y,r)}}countVisibleElements(){const t=this.getDataset();let e=0;return this._cachedMeta.data.forEach((n,r)=>{!isNaN(t.data[r])&&this.chart.getDataVisibility(r)&&e++}),e}_computeAngle(t,e,n){return this.chart.getDataVisibility(t)?Dt(this.resolveDataElementOptions(t,e).angle||n):0}}ui.id="polarArea",ui.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},ui.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n}}=t.legend.options;return e.labels.map((e,r)=>{const i=t.getDatasetMeta(0).controller.getStyle(r);return{text:e,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,lineWidth:i.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(r),index:r}})}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}},tooltip:{callbacks:{title:()=>"",label:t=>t.chart.data.labels[t.dataIndex]+": "+t.formattedValue}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class ci extends si{}ci.id="pie",ci.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class di extends On{getLabelAndValue(t){const e=this._cachedMeta.vScale,n=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(n[e.axis])}}update(t){const e=this,n=e._cachedMeta,r=n.dataset,i=n.data||[],o=n.iScale.getLabels();if(r.points=i,"resize"!==t){const n=e.resolveDatasetElementOptions(t);e.options.showLine||(n.borderWidth=0),e.updateElement(r,void 0,{_loop:!0,_fullLoop:o.length===i.length,options:n},t)}e.updateElements(i,0,i.length,t)}updateElements(t,e,n,r){const i=this,o=i.getDataset(),a=i._cachedMeta.rScale,s="reset"===r;for(let l=e;l<e+n;l++){const e=t[l],n=i.resolveDataElementOptions(l,e.active?"active":r),u=a.getPointPositionForValue(l,o.data[l]),c=s?a.xCenter:u.x,d=s?a.yCenter:u.y,f={x:c,y:d,angle:u.angle,skip:isNaN(c)||isNaN(d),options:n};i.updateElement(e,l,f,r)}}}di.id="radar",di.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},di.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class fi extends li{}fi.id="scatter",fi.defaults={showLine:!1,fill:!1},fi.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title:()=>"",label:t=>"("+t.label+", "+t.formattedValue+")"}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var hi=Object.freeze({__proto__:null,BarController:oi,BubbleController:ai,DoughnutController:si,LineController:li,PolarAreaController:ui,PieController:ci,RadarController:di,ScatterController:fi});function pi(t,e,n){const{startAngle:r,pixelMargin:i,x:o,y:a,outerRadius:s,innerRadius:l}=e;let u=i/s;t.beginPath(),t.arc(o,a,s,r-u,n+u),l>i?(u=i/l,t.arc(o,a,l,n+u,r-u,!0)):t.arc(o,a,i,n+xt,r-xt),t.closePath(),t.clip()}function gi(t,e,n,r){return{x:n+t*Math.cos(e),y:r+t*Math.sin(e)}}function mi(t,e,n,r,i){const{x:o,y:a,startAngle:s,pixelMargin:l,innerRadius:u}=e,c=Math.max(e.outerRadius+r+n-l,0),d=u>0?u+r+n+l:0;let f=0;const h=i-s;if(r){const t=((u>0?u-r:0)+(c>0?c-r:0))/2;f=(h-(0!==t?h*t/(t+r):h))/2}const p=(h-Math.max(.001,h*c-n/pt)/c)/2,g=s+p+f,m=i-p-f,{outerStart:v,outerEnd:y,innerStart:x,innerEnd:b}=function(t,e,n,r){const i=De(t.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]),o=(n-e)/2,a=Math.min(o,r*e/2),s=t=>{const e=(n-Math.min(o,t))*r/2;return zt(t,0,Math.min(o,e))};return{outerStart:s(i.outerStart),outerEnd:s(i.outerEnd),innerStart:zt(i.innerStart,0,a),innerEnd:zt(i.innerEnd,0,a)}}(e,d,c,m-g),_=c-v,w=c-y,S=g+v/_,C=m-y/w,M=d+x,T=d+b,k=g+x/M,A=m-b/T;if(t.beginPath(),t.arc(o,a,c,S,C),y>0){const e=gi(w,C,o,a);t.arc(e.x,e.y,y,C,m+xt)}const I=gi(T,m,o,a);if(t.lineTo(I.x,I.y),b>0){const e=gi(T,A,o,a);t.arc(e.x,e.y,b,m+xt,A+Math.PI)}if(t.arc(o,a,d,m-b/d,g+x/d,!0),x>0){const e=gi(M,k,o,a);t.arc(e.x,e.y,x,k+Math.PI,g-xt)}const D=gi(_,g,o,a);if(t.lineTo(D.x,D.y),v>0){const e=gi(_,S,o,a);t.arc(e.x,e.y,v,g-xt,S)}t.closePath()}class vi extends Pn{constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,n){const r=this.getProps(["x","y"],n),{angle:i,distance:o}=Et(r,{x:t,y:e}),{startAngle:a,endAngle:s,innerRadius:l,outerRadius:u,circumference:c}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),d=this.options.spacing/2;return(c>=gt||Bt(i,a,s))&&o>=l+d&&o<=u+d}getCenterPoint(t){const{x:e,y:n,startAngle:r,endAngle:i,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],t),{offset:s,spacing:l}=this.options,u=(r+i)/2,c=(o+a+l+s)/2;return{x:e+Math.cos(u)*c,y:n+Math.sin(u)*c}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const e=this,{options:n,circumference:r}=e,i=(n.offset||0)/2,o=(n.spacing||0)/2;if(e.pixelMargin="inner"===n.borderAlign?.33:0,e.fullCircles=r>gt?Math.floor(r/gt):0,0===r||e.innerRadius<0||e.outerRadius<0)return;t.save();let a=0;if(i){a=i/2;const n=(e.startAngle+e.endAngle)/2;t.translate(Math.cos(n)*a,Math.sin(n)*a),e.circumference>=pt&&(a=i)}t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor;const s=function(t,e,n,r){const{fullCircles:i,startAngle:o,circumference:a}=e;let s=e.endAngle;if(i){mi(t,e,n,r,o+gt);for(let e=0;e<i;++e)t.fill();isNaN(a)||(s=o+a%gt,a%gt==0&&(s+=gt))}return mi(t,e,n,r,s),t.fill(),s}(t,e,a,o);(function(t,e,n,r,i){const{options:o}=e,a="inner"===o.borderAlign;o.borderWidth&&(a?(t.lineWidth=2*o.borderWidth,t.lineJoin="round"):(t.lineWidth=o.borderWidth,t.lineJoin="bevel"),e.fullCircles&&function(t,e,n){const{x:r,y:i,startAngle:o,pixelMargin:a,fullCircles:s}=e,l=Math.max(e.outerRadius-a,0),u=e.innerRadius+a;let c;for(n&&pi(t,e,o+gt),t.beginPath(),t.arc(r,i,u,o+gt,o,!0),c=0;c<s;++c)t.stroke();for(t.beginPath(),t.arc(r,i,l,o,o+gt),c=0;c<s;++c)t.stroke()}(t,e,a),a&&pi(t,e,i),mi(t,e,n,r,i),t.stroke())})(t,e,a,o,s),t.restore()}}function yi(t,e,n=e){t.lineCap=U(n.borderCapStyle,e.borderCapStyle),t.setLineDash(U(n.borderDash,e.borderDash)),t.lineDashOffset=U(n.borderDashOffset,e.borderDashOffset),t.lineJoin=U(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=U(n.borderWidth,e.borderWidth),t.strokeStyle=U(n.borderColor,e.borderColor)}function xi(t,e,n){t.lineTo(n.x,n.y)}function bi(t,e,n={}){const r=t.length,{start:i=0,end:o=r-1}=n,{start:a,end:s}=e,l=Math.max(i,a),u=Math.min(o,s);return{count:r,start:l,loop:e.loop,ilen:u<l&&!(i<a&&o<a||i>s&&o>s)?r+u-l:u-l}}function _i(t,e,n,r){const{points:i,options:o}=e,{count:a,start:s,loop:l,ilen:u}=bi(i,n,r),c=function(t){return t.stepped?$t:t.tension||"monotone"===t.cubicInterpolationMode?Zt:xi}(o);let d,f,h,{move:p=!0,reverse:g}=r||{};for(d=0;d<=u;++d)f=i[(s+(g?u-d:d))%a],f.skip||(p?(t.moveTo(f.x,f.y),p=!1):c(t,h,f,g,o.stepped),h=f);return l&&(f=i[(s+(g?u:0))%a],c(t,h,f,g,o.stepped)),!!l}function wi(t,e,n,r){const i=e.points,{count:o,start:a,ilen:s}=bi(i,n,r),{move:l=!0,reverse:u}=r||{};let c,d,f,h,p,g,m=0,v=0;const y=t=>(a+(u?s-t:t))%o,x=()=>{h!==p&&(t.lineTo(m,p),t.lineTo(m,h),t.lineTo(m,g))};for(l&&(d=i[y(0)],t.moveTo(d.x,d.y)),c=0;c<=s;++c){if(d=i[y(c)],d.skip)continue;const e=d.x,n=d.y,r=0|e;r===f?(n<h?h=n:n>p&&(p=n),m=(v*m+e)/++v):(x(),t.lineTo(e,n),f=r,v=0,h=p=n),g=n}x()}function Si(t){const e=t.options;return t._decimated||t._loop||e.tension||"monotone"===e.cubicInterpolationMode||e.stepped||e.borderDash&&e.borderDash.length?_i:wi}vi.id="arc",vi.defaults={borderAlign:"center",borderColor:"#fff",borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0},vi.defaultRoutes={backgroundColor:"backgroundColor"};const Ci="function"==typeof Path2D;class Mi extends Pn{constructor(t){super(),this.animated=!0,this.options=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,t&&Object.assign(this,t)}updateControlPoints(t,e){const n=this,r=n.options;!r.tension&&"monotone"!==r.cubicInterpolationMode||r.stepped||n._pointsUpdated||(cr(n._points,r,t,r.spanGaps?n._loop:n._fullLoop,e),n._pointsUpdated=!0)}set points(t){const e=this;e._points=t,delete e._segments,delete e._path,e._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=_r(this,this.options.segment))}first(){const t=this.segments;return t.length&&this.points[t[0].start]}last(){const t=this.segments,e=t.length;return e&&this.points[t[e-1].end]}interpolate(t,e){const n=this,r=n.options,i=t[e],o=n.points,a=br(n,{property:e,start:i,end:i});if(!a.length)return;const s=[],l=function(t){return t.stepped?fr:t.tension||"monotone"===t.cubicInterpolationMode?hr:dr}(r);let u,c;for(u=0,c=a.length;u<c;++u){const{start:n,end:c}=a[u],d=o[n],f=o[c];if(d===f){s.push(d);continue}const h=l(d,f,Math.abs((i-d[e])/(f[e]-d[e])),r.stepped);h[e]=t[e],s.push(h)}return 1===s.length?s[0]:s}pathSegment(t,e,n){return Si(this)(t,this,e,n)}path(t,e,n){const r=this,i=r.segments,o=Si(r);let a=r._loop;e=e||0,n=n||r.points.length-e;for(const s of i)a&=o(t,r,s,{start:e,end:e+n-1});return!!a}draw(t,e,n,r){const i=this;(i.points||[]).length&&(i.options||{}).borderWidth&&(t.save(),function(t,e,n,r){Ci&&1===e.segments.length?function(t,e,n,r){let i=e._path;i||(i=e._path=new Path2D,e.path(i,n,r)&&i.closePath()),yi(t,e.options),t.stroke(i)}(t,e,n,r):function(t,e,n,r){const{segments:i,options:o}=e,a=Si(e);for(const s of i)yi(t,o,s.style),t.beginPath(),a(t,e,s,{start:n,end:n+r-1})&&t.closePath(),t.stroke()}(t,e,n,r)}(t,i,n,r),t.restore(),i.animated&&(i._pointsUpdated=!1,i._path=void 0))}}function Ti(t,e,n,r){const i=t.options,{[n]:o}=t.getProps([n],r);return Math.abs(e-o)<i.radius+i.hitRadius}Mi.id="line",Mi.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},Mi.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},Mi.descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};class ki extends Pn{constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,n){const r=this.options,{x:i,y:o}=this.getProps(["x","y"],n);return Math.pow(t-i,2)+Math.pow(e-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(t,e){return Ti(this,t,"x",e)}inYRange(t,e){return Ti(this,t,"y",e)}getCenterPoint(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}size(t){let e=(t=t||this.options||{}).radius||0;return e=Math.max(e,e&&t.hoverRadius||0),2*(e+(e&&t.borderWidth||0))}draw(t){const e=this,n=e.options;e.skip||n.radius<.1||(t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.fillStyle=n.backgroundColor,Ut(t,n,e.x,e.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function Ai(t,e){const{x:n,y:r,base:i,width:o,height:a}=t.getProps(["x","y","base","width","height"],e);let s,l,u,c,d;return t.horizontal?(d=a/2,s=Math.min(n,i),l=Math.max(n,i),u=r-d,c=r+d):(d=o/2,s=n-d,l=n+d,u=Math.min(r,i),c=Math.max(r,i)),{left:s,top:u,right:l,bottom:c}}function Ii(t){let e=t.options.borderSkipped;const n={};return e?(e=t.horizontal?Di(e,"left","right",t.base>t.x):Di(e,"bottom","top",t.base<t.y),n[e]=!0,n):n}function Di(t,e,n,r){var i,o,a;return r?(a=n,t=Oi(t=(i=t)===(o=e)?a:i===a?o:i,n,e)):t=Oi(t,e,n),t}function Oi(t,e,n){return"start"===t?e:"end"===t?n:t}function Pi(t,e,n,r){return t?0:Math.max(Math.min(e,r),n)}function Ei(t,e,n,r){const i=null===e,o=null===n,a=t&&!(i&&o)&&Ai(t,r);return a&&(i||e>=a.left&&e<=a.right)&&(o||n>=a.top&&n<=a.bottom)}function Ri(t,e){t.rect(e.x,e.y,e.w,e.h)}ki.id="point",ki.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},ki.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};class Li extends Pn{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,t&&Object.assign(this,t)}draw(t){const e=this.options,{inner:n,outer:r}=function(t){const e=Ai(t),n=e.right-e.left,r=e.bottom-e.top,i=function(t,e,n){const r=t.options.borderWidth,i=Ii(t),o=Oe(r);return{t:Pi(i.top,o.top,0,n),r:Pi(i.right,o.right,0,e),b:Pi(i.bottom,o.bottom,0,n),l:Pi(i.left,o.left,0,e)}}(t,n/2,r/2),o=function(t,e,n){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),i=t.options.borderRadius,o=Pe(i),a=Math.min(e,n),s=Ii(t),l=r||W(i);return{topLeft:Pi(!l||s.top||s.left,o.topLeft,0,a),topRight:Pi(!l||s.top||s.right,o.topRight,0,a),bottomLeft:Pi(!l||s.bottom||s.left,o.bottomLeft,0,a),bottomRight:Pi(!l||s.bottom||s.right,o.bottomRight,0,a)}}(t,n/2,r/2);return{outer:{x:e.left,y:e.top,w:n,h:r,radius:o},inner:{x:e.left+i.l,y:e.top+i.t,w:n-i.l-i.r,h:r-i.t-i.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,o.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(i.b,i.r))}}}}(this),i=(o=r.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?Qt:Ri;var o;t.save(),r.w===n.w&&r.h===n.h||(t.beginPath(),i(t,r),t.clip(),i(t,n),t.fillStyle=e.borderColor,t.fill("evenodd")),t.beginPath(),i(t,n),t.fillStyle=e.backgroundColor,t.fill(),t.restore()}inRange(t,e,n){return Ei(this,t,e,n)}inXRange(t,e){return Ei(this,t,null,e)}inYRange(t,e){return Ei(this,null,t,e)}getCenterPoint(t){const{x:e,y:n,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],t);return{x:i?(e+r)/2:e,y:i?n:(n+r)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}Li.id="bar",Li.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,enableBorderRadius:!0,pointStyle:void 0},Li.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var Ni=Object.freeze({__proto__:null,ArcElement:vi,LineElement:Mi,PointElement:ki,BarElement:Li});function Bi(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{value:e})}}function zi(t){t.data.datasets.forEach(t=>{Bi(t)})}var Vi={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled)return void zi(t);const r=t.width;t.data.datasets.forEach((e,i)=>{const{_data:o,indexAxis:a}=e,s=t.getDatasetMeta(i),l=o||e.data;if("y"===Le([a,t.options.indexAxis]))return;if("line"!==s.type)return;const u=t.scales[s.xAxisID];if("linear"!==u.type&&"time"!==u.type)return;if(t.options.parsing)return;let c,{start:d,count:f}=function(t,e){const n=e.length;let r,i=0;const{iScale:o}=t,{min:a,max:s,minDefined:l,maxDefined:u}=o.getUserBounds();return l&&(i=zt(ee(e,o.axis,a).lo,0,n-1)),r=u?zt(ee(e,o.axis,s).hi+1,i,n)-i:n-i,{start:i,count:r}}(s,l);if(f<=4*r)Bi(e);else{switch(F(o)&&(e._data=l,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(t){this._data=t}})),n.algorithm){case"lttb":c=function(t,e,n,r,i){const o=i.samples||r;if(o>=n)return t.slice(e,e+n);const a=[],s=(n-2)/(o-2);let l=0;const u=e+n-1;let c,d,f,h,p,g=e;for(a[l++]=t[g],c=0;c<o-2;c++){let r,i=0,o=0;const u=Math.floor((c+1)*s)+1+e,m=Math.min(Math.floor((c+2)*s)+1,n)+e,v=m-u;for(r=u;r<m;r++)i+=t[r].x,o+=t[r].y;i/=v,o/=v;const y=Math.floor(c*s)+1+e,x=Math.floor((c+1)*s)+1+e,{x:b,y:_}=t[g];for(f=h=-1,r=y;r<x;r++)h=.5*Math.abs((b-i)*(t[r].y-_)-(b-t[r].x)*(o-_)),h>f&&(f=h,d=t[r],p=r);a[l++]=d,g=p}return a[l++]=t[u],a}(l,d,f,r,n);break;case"min-max":c=function(t,e,n,r){let i,o,a,s,l,u,c,d,f,h,p=0,g=0;const m=[],v=t[e].x,y=t[e+n-1].x-v;for(i=e;i<e+n;++i){o=t[i],a=(o.x-v)/y*r,s=o.y;const e=0|a;if(e===l)s<f?(f=s,u=i):s>h&&(h=s,c=i),p=(g*p+o.x)/++g;else{const n=i-1;if(!F(u)&&!F(c)){const e=Math.min(u,c),r=Math.max(u,c);e!==d&&e!==n&&m.push({...t[e],x:p}),r!==d&&r!==n&&m.push({...t[r],x:p})}i>0&&n!==d&&m.push(t[n]),m.push(o),l=e,g=0,f=h=s,u=c=d=i}}return m}(l,d,f,r);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}e._decimated=c}})},destroy(t){zi(t)}};function Fi(t,e,n){const r=function(t){const e=t.options,n=e.fill;let r=U(n&&n.target,n);return void 0===r&&(r=!!e.backgroundColor),!1!==r&&null!==r&&(!0===r?"origin":r)}(t);if(W(r))return!isNaN(r.value)&&r;let i=parseFloat(r);return j(i)&&Math.floor(i)===i?("-"!==r[0]&&"+"!==r[0]||(i=e+i),!(i===e||i<0||i>=n)&&i):["origin","start","end","stack"].indexOf(r)>=0&&r}class Hi{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,n){const{x:r,y:i,radius:o}=this;return t.arc(r,i,o,(e=e||{start:0,end:gt}).end,e.start,!0),!n.bounds}interpolate(t){const{x:e,y:n,radius:r}=this,i=t.angle;return{x:e+Math.cos(i)*r,y:n+Math.sin(i)*r,angle:i}}}function Wi(t,e,n){for(;e>t;e--){const t=n[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}const ji=t=>"line"===t.type&&!t.hidden;function Gi(t,e,n){const r=[];for(let i=0;i<n.length;i++){const o=n[i],{first:a,last:s,point:l}=Ui(o,e,"x");if(!(!l||a&&s))if(a)r.unshift(l);else if(t.push(l),!s)break}t.push(...r)}function Ui(t,e,n){const r=t.interpolate(e,n);if(!r)return{};const i=r[n],o=t.segments,a=t.points;let s=!1,l=!1;for(let u=0;u<o.length;u++){const t=o[u],e=a[t.start][n],r=a[t.end][n];if(i>=e&&i<=r){s=i===e,l=i===r;break}}return{first:s,last:l,point:r}}function qi(t,e){let n=[],r=!1;return H(t)?(r=!0,n=t):n=function(t,e){const{x:n=null,y:r=null}=t||{},i=e.points,o=[];return e.segments.forEach(({start:t,end:e})=>{e=Wi(t,e,i);const a=i[t],s=i[e];null!==r?(o.push({x:a.x,y:r}),o.push({x:s.x,y:r})):null!==n&&(o.push({x:n,y:a.y}),o.push({x:n,y:s.y}))}),o}(t,e),n.length?new Mi({points:n,options:{tension:0},_loop:r,_fullLoop:r}):null}function Xi(t,e,n){let r=t[e].fill;const i=[e];let o;if(!n)return r;for(;!1!==r&&-1===i.indexOf(r);){if(!j(r))return r;if(o=t[r],!o)return!1;if(o.visible)return r;i.push(r),r=o.fill}return!1}function Yi(t,e,n){t.beginPath(),e.path(t),t.lineTo(e.last().x,n),t.lineTo(e.first().x,n),t.closePath(),t.clip()}function $i(t,e,n,r){if(r)return;let i=e[t],o=n[t];return"angle"===t&&(i=Nt(i),o=Nt(o)),{property:t,start:i,end:o}}function Zi(t,e,n,r){return t&&e?r(t[n],e[n]):t?t[n]:e?e[n]:0}function Ki(t,e,n){const{top:r,bottom:i}=e.chart.chartArea,{property:o,start:a,end:s}=n||{};"x"===o&&(t.beginPath(),t.rect(a,r,s-a,i-r),t.clip())}function Ji(t,e,n,r){const i=e.interpolate(n,r);i&&t.lineTo(i.x,i.y)}function Qi(t,e){const{line:n,target:r,property:i,color:o,scale:a}=e,s=function(t,e,n){const r=t.segments,i=t.points,o=e.points,a=[];for(const s of r){let{start:t,end:r}=s;r=Wi(t,r,i);const l=$i(n,i[t],i[r],s.loop);if(!e.segments){a.push({source:s,target:l,start:i[t],end:i[r]});continue}const u=br(e,l);for(const e of u){const t=$i(n,o[e.start],o[e.end],e.loop),r=xr(s,i,t);for(const i of r)a.push({source:i,target:e,start:{[n]:Zi(l,t,"start",Math.max)},end:{[n]:Zi(l,t,"end",Math.min)}})}}return a}(n,r,i);for(const{source:l,target:u,start:c,end:d}of s){const{style:{backgroundColor:e=o}={}}=l;t.save(),t.fillStyle=e,Ki(t,a,$i(i,c,d)),t.beginPath();const s=!!n.pathSegment(t,l);s?t.closePath():Ji(t,r,d,i);const f=!!r.pathSegment(t,u,{move:s,reverse:!0}),h=s&&f;h||Ji(t,r,c,i),t.closePath(),t.fill(h?"evenodd":"nonzero"),t.restore()}}function to(t,e,n){const r=function(t){const{chart:e,fill:n,line:r}=t;if(j(n))return function(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}(e,n);if("stack"===n)return function(t){const{chart:e,scale:n,index:r,line:i}=t,o=[],a=i.segments,s=i.points,l=function(t,e){const n=[],r=t.getSortedVisibleDatasetMetas();for(let i=0;i<r.length;i++){const t=r[i];if(t.index===e)break;ji(t)&&n.unshift(t.dataset)}return n}(e,r);l.push(qi({x:null,y:n.bottom},i));for(let u=0;u<a.length;u++){const t=a[u];for(let e=t.start;e<=t.end;e++)Gi(o,s[e],l)}return new Mi({points:o,options:{}})}(t);const i=function(t){return(t.scale||{}).getPointPositionForValue?function(t){const{scale:e,fill:n}=t,r=e.options,i=e.getLabels().length,o=[],a=r.reverse?e.max:e.min;let s,l,u;if(u="start"===n?a:"end"===n?r.reverse?e.min:e.max:W(n)?n.value:e.getBaseValue(),r.grid.circular)return l=e.getPointPositionForValue(0,a),new Hi({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(u)});for(s=0;s<i;++s)o.push(e.getPointPositionForValue(s,u));return o}(t):function(t){const{scale:e={},fill:n}=t;let r,i=null;return"start"===n?i=e.bottom:"end"===n?i=e.top:W(n)?i=e.getPixelForValue(n.value):e.getBasePixel&&(i=e.getBasePixel()),j(i)?(r=e.isHorizontal(),{x:r?i:null,y:r?null:i}):null}(t)}(t);return i instanceof Hi?i:qi(i,r)}(e),{line:i,scale:o,axis:a}=e,s=i.options,l=s.fill,u=s.backgroundColor,{above:c=u,below:d=u}=l||{};r&&i.points.length&&(Xt(t,n),function(t,e){const{line:n,target:r,above:i,below:o,area:a,scale:s}=e,l=n._loop?"angle":e.axis;t.save(),"x"===l&&o!==i&&(Yi(t,r,a.top),Qi(t,{line:n,target:r,color:i,scale:s,property:l}),t.restore(),t.save(),Yi(t,r,a.bottom)),Qi(t,{line:n,target:r,color:o,scale:s,property:l}),t.restore()}(t,{line:i,target:r,above:c,below:d,area:n,scale:o,axis:a}),Yt(t))}var eo={id:"filler",afterDatasetsUpdate(t,e,n){const r=(t.data.datasets||[]).length,i=[];let o,a,s,l;for(a=0;a<r;++a)o=t.getDatasetMeta(a),s=o.dataset,l=null,s&&s.options&&s instanceof Mi&&(l={visible:t.isDatasetVisible(a),index:a,fill:Fi(s,a,r),chart:t,axis:o.controller.options.indexAxis,scale:o.vScale,line:s}),o.$filler=l,i.push(l);for(a=0;a<r;++a)l=i[a],l&&!1!==l.fill&&(l.fill=Xi(i,a,n.propagate))},beforeDraw(t,e,n){const r="beforeDraw"===n.drawTime,i=t.getSortedVisibleDatasetMetas(),o=t.chartArea;for(let a=i.length-1;a>=0;--a){const e=i[a].$filler;e&&(e.line.updateControlPoints(o,e.axis),r&&to(t.ctx,e,o))}},beforeDatasetsDraw(t,e,n){if("beforeDatasetsDraw"!==n.drawTime)return;const r=t.getSortedVisibleDatasetMetas();for(let i=r.length-1;i>=0;--i){const e=r[i].$filler;e&&to(t.ctx,e,t.chartArea)}},beforeDatasetDraw(t,e,n){const r=e.meta.$filler;r&&!1!==r.fill&&"beforeDatasetDraw"===n.drawTime&&to(t.ctx,r,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const no=(t,e)=>{let{boxHeight:n=e,boxWidth:r=e}=t;return t.usePointStyle&&(n=Math.min(n,e),r=Math.min(r,e)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(e,n)}};class ro extends Pn{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,n){const r=this;r.maxWidth=t,r.maxHeight=e,r._margins=n,r.setDimensions(),r.buildLabels(),r.fit()}setDimensions(){const t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=t._margins.left,t.right=t.width):(t.height=t.maxHeight,t.top=t._margins.top,t.bottom=t.height)}buildLabels(){const t=this,e=t.options.labels||{};let n=Y(e.generateLabels,[t.chart],t)||[];e.filter&&(n=n.filter(n=>e.filter(n,t.chart.data))),e.sort&&(n=n.sort((n,r)=>e.sort(n,r,t.chart.data))),t.options.reverse&&n.reverse(),t.legendItems=n}fit(){const t=this,{options:e,ctx:n}=t;if(!e.display)return void(t.width=t.height=0);const r=e.labels,i=Re(r.font),o=i.size,a=t._computeTitleHeight(),{boxWidth:s,itemHeight:l}=no(r,o);let u,c;n.font=i.string,t.isHorizontal()?(u=t.maxWidth,c=t._fitRows(a,o,s,l)+10):(c=t.maxHeight,u=t._fitCols(a,o,s,l)+10),t.width=Math.min(u,e.maxWidth||t.maxWidth),t.height=Math.min(c,e.maxHeight||t.maxHeight)}_fitRows(t,e,n,r){const i=this,{ctx:o,maxWidth:a,options:{labels:{padding:s}}}=i,l=i.legendHitBoxes=[],u=i.lineWidths=[0],c=r+s;let d=t;o.textAlign="left",o.textBaseline="middle";let f=-1,h=-c;return i.legendItems.forEach((t,i)=>{const p=n+e/2+o.measureText(t.text).width;(0===i||u[u.length-1]+p+2*s>a)&&(d+=c,u[u.length-(i>0?0:1)]=0,h+=c,f++),l[i]={left:0,top:h,row:f,width:p,height:r},u[u.length-1]+=p+s}),d}_fitCols(t,e,n,r){const i=this,{ctx:o,maxHeight:a,options:{labels:{padding:s}}}=i,l=i.legendHitBoxes=[],u=i.columnSizes=[],c=a-t;let d=s,f=0,h=0,p=0,g=0;return i.legendItems.forEach((t,i)=>{const a=n+e/2+o.measureText(t.text).width;i>0&&h+r+2*s>c&&(d+=f+s,u.push({width:f,height:h}),p+=f+s,g++,f=h=0),l[i]={left:p,top:h,col:g,width:a,height:r},f=Math.max(f,a),h+=r+s}),d+=f,u.push({width:f,height:h}),d}adjustHitBoxes(){const t=this;if(!t.options.display)return;const e=t._computeTitleHeight(),{legendHitBoxes:n,options:{align:r,labels:{padding:o},rtl:a}}=t;if(this.isHorizontal()){let s=0,l=i(r,t.left+o,t.right-t.lineWidths[s]);for(const a of n)s!==a.row&&(s=a.row,l=i(r,t.left+o,t.right-t.lineWidths[s])),a.top+=t.top+e+o,a.left=l,l+=a.width+o;if(a){const e=n.reduce((t,e)=>(t[e.row]=t[e.row]||[],t[e.row].push(e),t),{}),r=[];Object.keys(e).forEach(t=>{e[t].reverse(),r.push(...e[t])}),t.legendHitBoxes=r}}else{let a=0,s=i(r,t.top+e+o,t.bottom-t.columnSizes[a].height);for(const l of n)l.col!==a&&(a=l.col,s=i(r,t.top+e+o,t.bottom-t.columnSizes[a].height)),l.top=s,l.left+=t.left+o,s+=l.height+o}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){const t=this;if(t.options.display){const e=t.ctx;Xt(e,t),t._draw(),Yt(e)}}_draw(){const t=this,{options:e,columnSizes:n,lineWidths:r,ctx:a}=t,{align:s,labels:l}=e,u=ht.color,c=pr(e.rtl,t.left,t.width),d=Re(l.font),{color:f,padding:h}=l,p=d.size,g=p/2;let m;t.drawTitle(),a.textAlign=c.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=d.string;const{boxWidth:v,boxHeight:y,itemHeight:x}=no(l,p),b=t.isHorizontal(),_=this._computeTitleHeight();m=b?{x:i(s,t.left+h,t.right-r[0]),y:t.top+h+_,line:0}:{x:t.left+h,y:i(s,t.top+_+h,t.bottom-n[0].height),line:0},gr(t.ctx,e.textDirection);const w=x+h;t.legendItems.forEach((S,C)=>{a.strokeStyle=S.fontColor||f,a.fillStyle=S.fontColor||f;const M=a.measureText(S.text).width,T=c.textAlign(S.textAlign||(S.textAlign=l.textAlign)),k=v+g+M;let A=m.x,I=m.y;c.setWidth(t.width),b?C>0&&A+k+h>t.right&&(I=m.y+=w,m.line++,A=m.x=i(s,t.left+h,t.right-r[m.line])):C>0&&I+w>t.bottom&&(A=m.x=A+n[m.line].width+h,m.line++,I=m.y=i(s,t.top+_+h,t.bottom-n[m.line].height)),function(t,e,n){if(isNaN(v)||v<=0||isNaN(y)||y<0)return;a.save();const r=U(n.lineWidth,1);if(a.fillStyle=U(n.fillStyle,u),a.lineCap=U(n.lineCap,"butt"),a.lineDashOffset=U(n.lineDashOffset,0),a.lineJoin=U(n.lineJoin,"miter"),a.lineWidth=r,a.strokeStyle=U(n.strokeStyle,u),a.setLineDash(U(n.lineDash,[])),l.usePointStyle){const i={radius:v*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:r},o=c.xPlus(t,v/2);Ut(a,i,o,e+g)}else{const i=e+Math.max((p-y)/2,0),o=c.leftForLtr(t,v),s=Pe(n.borderRadius);a.beginPath(),Object.values(s).some(t=>0!==t)?Qt(a,{x:o,y:i,w:v,h:y,radius:s}):a.rect(o,i,v,y),a.fill(),0!==r&&a.stroke()}a.restore()}(c.x(A),I,S),A=o(T,A+v+g,b?A+k:t.right,e.rtl),function(t,e,n){Kt(a,n.text,t,e+x/2,d,{strikethrough:n.hidden,textAlign:c.textAlign(n.textAlign)})}(c.x(A),I,S),b?m.x+=k+h:m.y+=w}),mr(t.ctx,e.textDirection)}drawTitle(){const t=this,e=t.options,n=e.title,o=Re(n.font),a=Ee(n.padding);if(!n.display)return;const s=pr(e.rtl,t.left,t.width),l=t.ctx,u=n.position,c=a.top+o.size/2;let d,f=t.left,h=t.width;if(this.isHorizontal())h=Math.max(...t.lineWidths),d=t.top+c,f=i(e.align,f,t.right-h);else{const n=t.columnSizes.reduce((t,e)=>Math.max(t,e.height),0);d=c+i(e.align,t.top,t.bottom-n-e.labels.padding-t._computeTitleHeight())}const p=i(u,f,f+h);l.textAlign=s.textAlign(r(u)),l.textBaseline="middle",l.strokeStyle=n.color,l.fillStyle=n.color,l.font=o.string,Kt(l,n.text,p,d,o)}_computeTitleHeight(){const t=this.options.title,e=Re(t.font),n=Ee(t.padding);return t.display?e.lineHeight+n.height:0}_getLegendItemAt(t,e){const n=this;let r,i,o;if(t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom)for(o=n.legendHitBoxes,r=0;r<o.length;++r)if(i=o[r],t>=i.left&&t<=i.left+i.width&&e>=i.top&&e<=i.top+i.height)return n.legendItems[r];return null}handleEvent(t){const e=this,n=e.options;if(!function(t,e){return!("mousemove"!==t||!e.onHover&&!e.onLeave)||!(!e.onClick||"click"!==t&&"mouseup"!==t)}(t.type,n))return;const r=e._getLegendItemAt(t.x,t.y);if("mousemove"===t.type){const a=e._hoveredItem,s=(o=r,null!==(i=a)&&null!==o&&i.datasetIndex===o.datasetIndex&&i.index===o.index);a&&!s&&Y(n.onLeave,[t,a,e],e),e._hoveredItem=r,r&&!s&&Y(n.onHover,[t,r,e],e)}else r&&Y(n.onClick,[t,r,e],e);var i,o}}var io={id:"legend",_element:ro,start(t,e,n){const r=t.legend=new ro({ctx:t.ctx,options:n,chart:t});Xe.configure(t,r,n),Xe.addBox(t,r)},stop(t){Xe.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const r=t.legend;Xe.configure(t,r,n),r.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const r=e.datasetIndex,i=n.chart;i.isDatasetVisible(r)?(i.hide(r),e.hidden=!0):(i.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:i,color:o}}=t.legend.options;return t._getSortedDatasetMetas().map(t=>{const a=t.controller.getStyle(n?0:void 0),s=Ee(a.borderWidth);return{text:e[t.index].label,fillStyle:a.backgroundColor,fontColor:o,hidden:!t.visible,lineCap:a.borderCapStyle,lineDash:a.borderDash,lineDashOffset:a.borderDashOffset,lineJoin:a.borderJoinStyle,lineWidth:(s.width+s.height)/4,strokeStyle:a.borderColor,pointStyle:r||a.pointStyle,rotation:a.rotation,textAlign:i||a.textAlign,borderRadius:0,datasetIndex:t.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class oo extends Pn{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const n=this,r=n.options;if(n.left=0,n.top=0,!r.display)return void(n.width=n.height=n.right=n.bottom=0);n.width=n.right=t,n.height=n.bottom=e;const i=H(r.text)?r.text.length:1;n._padding=Ee(r.padding);const o=i*Re(r.font).lineHeight+n._padding.height;n.isHorizontal()?n.height=o:n.width=o}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:n,bottom:r,right:o,options:a}=this,s=a.align;let l,u,c,d=0;return this.isHorizontal()?(u=i(s,n,o),c=e+t,l=o-n):("left"===a.position?(u=n+t,c=i(s,r,e),d=-.5*pt):(u=o-t,c=i(s,e,r),d=.5*pt),l=r-e),{titleX:u,titleY:c,maxWidth:l,rotation:d}}draw(){const t=this,e=t.ctx,n=t.options;if(!n.display)return;const i=Re(n.font),o=i.lineHeight/2+t._padding.top,{titleX:a,titleY:s,maxWidth:l,rotation:u}=t._drawArgs(o);Kt(e,n.text,0,0,i,{color:n.color,maxWidth:l,rotation:u,textAlign:r(n.align),textBaseline:"middle",translation:[a,s]})}}var ao={id:"title",_element:oo,start(t,e,n){!function(t,e){const n=new oo({ctx:t.ctx,options:e,chart:t});Xe.configure(t,n,e),Xe.addBox(t,n),t.titleBlock=n}(t,n)},stop(t){Xe.removeBox(t,t.titleBlock),delete t.titleBlock},beforeUpdate(t,e,n){const r=t.titleBlock;Xe.configure(t,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const so=new WeakMap;var lo={id:"subtitle",start(t,e,n){const r=new oo({ctx:t.ctx,options:n,chart:t});Xe.configure(t,r,n),Xe.addBox(t,r),so.set(t,r)},stop(t){Xe.removeBox(t,so.get(t)),so.delete(t)},beforeUpdate(t,e,n){const r=so.get(t);Xe.configure(t,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const uo={average(t){if(!t.length)return!1;let e,n,r=0,i=0,o=0;for(e=0,n=t.length;e<n;++e){const n=t[e].element;if(n&&n.hasValue()){const t=n.tooltipPosition();r+=t.x,i+=t.y,++o}}return{x:r/o,y:i/o}},nearest(t,e){if(!t.length)return!1;let n,r,i,o=e.x,a=e.y,s=Number.POSITIVE_INFINITY;for(n=0,r=t.length;n<r;++n){const r=t[n].element;if(r&&r.hasValue()){const t=Rt(e,r.getCenterPoint());t<s&&(s=t,i=r)}}if(i){const t=i.tooltipPosition();o=t.x,a=t.y}return{x:o,y:a}}};function co(t,e){return e&&(H(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function fo(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function ho(t,e){const{element:n,datasetIndex:r,index:i}=e,o=t.getDatasetMeta(r).controller,{label:a,value:s}=o.getLabelAndValue(i);return{chart:t,label:a,parsed:o.getParsed(i),raw:t.data.datasets[r].data[i],formattedValue:s,dataset:o.getDataset(),dataIndex:i,datasetIndex:r,element:n}}function po(t,e){const n=t._chart.ctx,{body:r,footer:i,title:o}=t,{boxWidth:a,boxHeight:s}=e,l=Re(e.bodyFont),u=Re(e.titleFont),c=Re(e.footerFont),d=o.length,f=i.length,h=r.length,p=Ee(e.padding);let g=p.height,m=0,v=r.reduce((t,e)=>t+e.before.length+e.lines.length+e.after.length,0);v+=t.beforeBody.length+t.afterBody.length,d&&(g+=d*u.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),v&&(g+=h*(e.displayColors?Math.max(s,l.lineHeight):l.lineHeight)+(v-h)*l.lineHeight+(v-1)*e.bodySpacing),f&&(g+=e.footerMarginTop+f*c.lineHeight+(f-1)*e.footerSpacing);let y=0;const x=function(t){m=Math.max(m,n.measureText(t).width+y)};return n.save(),n.font=u.string,$(t.title,x),n.font=l.string,$(t.beforeBody.concat(t.afterBody),x),y=e.displayColors?a+2:0,$(r,t=>{$(t.before,x),$(t.lines,x),$(t.after,x)}),y=0,n.font=c.string,$(t.footer,x),n.restore(),m+=p.width,{width:m,height:g}}function go(t,e,n,r){const{x:i,width:o}=n,{width:a,chartArea:{left:s,right:l}}=t;let u="center";return"center"===r?u=i<=(s+l)/2?"left":"right":i<=o/2?u="left":i>=a-o/2&&(u="right"),function(t,e,n,r){const{x:i,width:o}=r,a=n.caretSize+n.caretPadding;return"left"===t&&i+o+a>e.width||"right"===t&&i-o-a<0||void 0}(u,t,e,n)&&(u="center"),u}function mo(t,e,n){const r=e.yAlign||function(t,e){const{y:n,height:r}=e;return n<r/2?"top":n>t.height-r/2?"bottom":"center"}(t,n);return{xAlign:e.xAlign||go(t,e,n,r),yAlign:r}}function vo(t,e,n,r){const{caretSize:i,caretPadding:o,cornerRadius:a}=t,{xAlign:s,yAlign:l}=n,u=i+o,c=a+o;let d=function(t,e){let{x:n,width:r}=t;return"right"===e?n-=r:"center"===e&&(n-=r/2),n}(e,s);const f=function(t,e,n){let{y:r,height:i}=t;return"top"===e?r+=n:r-="bottom"===e?i+n:i/2,r}(e,l,u);return"center"===l?"left"===s?d+=u:"right"===s&&(d-=u):"left"===s?d-=c:"right"===s&&(d+=c),{x:zt(d,0,r.width-e.width),y:zt(f,0,r.height-e.height)}}function yo(t,e,n){const r=Ee(n.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-r.right:t.x+r.left}function xo(t){return co([],fo(t))}function bo(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}class _o extends Pn{constructor(t){super(),this.opacity=0,this._active=[],this._chart=t._chart,this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this,e=t._cachedAnimations;if(e)return e;const n=t._chart,r=t.options.setContext(t.getContext()),i=r.enabled&&n.options.animation&&r.animations,o=new xn(t._chart,i);return i._cacheable&&(t._cachedAnimations=Object.freeze(o)),o}getContext(){const t=this;return t.$context||(t.$context=(e=t._chart.getContext(),n=t,r=t._tooltipItems,Object.assign(Object.create(e),{tooltip:n,tooltipItems:r,type:"tooltip"})));var e,n,r}getTitle(t,e){const n=this,{callbacks:r}=e,i=r.beforeTitle.apply(n,[t]),o=r.title.apply(n,[t]),a=r.afterTitle.apply(n,[t]);let s=[];return s=co(s,fo(i)),s=co(s,fo(o)),s=co(s,fo(a)),s}getBeforeBody(t,e){return xo(e.callbacks.beforeBody.apply(this,[t]))}getBody(t,e){const n=this,{callbacks:r}=e,i=[];return $(t,t=>{const e={before:[],lines:[],after:[]},o=bo(r,t);co(e.before,fo(o.beforeLabel.call(n,t))),co(e.lines,o.label.call(n,t)),co(e.after,fo(o.afterLabel.call(n,t))),i.push(e)}),i}getAfterBody(t,e){return xo(e.callbacks.afterBody.apply(this,[t]))}getFooter(t,e){const n=this,{callbacks:r}=e,i=r.beforeFooter.apply(n,[t]),o=r.footer.apply(n,[t]),a=r.afterFooter.apply(n,[t]);let s=[];return s=co(s,fo(i)),s=co(s,fo(o)),s=co(s,fo(a)),s}_createItems(t){const e=this,n=e._active,r=e._chart.data,i=[],o=[],a=[];let s,l,u=[];for(s=0,l=n.length;s<l;++s)u.push(ho(e._chart,n[s]));return t.filter&&(u=u.filter((e,n,i)=>t.filter(e,n,i,r))),t.itemSort&&(u=u.sort((e,n)=>t.itemSort(e,n,r))),$(u,n=>{const r=bo(t.callbacks,n);i.push(r.labelColor.call(e,n)),o.push(r.labelPointStyle.call(e,n)),a.push(r.labelTextColor.call(e,n))}),e.labelColors=i,e.labelPointStyles=o,e.labelTextColors=a,e.dataPoints=u,u}update(t,e){const n=this,r=n.options.setContext(n.getContext()),i=n._active;let o,a=[];if(i.length){const t=uo[r.position].call(n,i,n._eventPosition);a=n._createItems(r),n.title=n.getTitle(a,r),n.beforeBody=n.getBeforeBody(a,r),n.body=n.getBody(a,r),n.afterBody=n.getAfterBody(a,r),n.footer=n.getFooter(a,r);const e=n._size=po(n,r),s=Object.assign({},t,e),l=mo(n._chart,r,s),u=vo(r,s,l,n._chart);n.xAlign=l.xAlign,n.yAlign=l.yAlign,o={opacity:1,x:u.x,y:u.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==n.opacity&&(o={opacity:0});n._tooltipItems=a,n.$context=void 0,o&&n._resolveAnimations().update(n,o),t&&r.external&&r.external.call(n,{chart:n._chart,tooltip:n,replay:e})}drawCaret(t,e,n,r){const i=this.getCaretPosition(t,n,r);e.lineTo(i.x1,i.y1),e.lineTo(i.x2,i.y2),e.lineTo(i.x3,i.y3)}getCaretPosition(t,e,n){const{xAlign:r,yAlign:i}=this,{cornerRadius:o,caretSize:a}=n,{x:s,y:l}=t,{width:u,height:c}=e;let d,f,h,p,g,m;return"center"===i?(g=l+c/2,"left"===r?(d=s,f=d-a,p=g+a,m=g-a):(d=s+u,f=d+a,p=g-a,m=g+a),h=d):(f="left"===r?s+o+a:"right"===r?s+u-o-a:this.caretX,"top"===i?(p=l,g=p-a,d=f-a,h=f+a):(p=l+c,g=p+a,d=f+a,h=f-a),m=p),{x1:d,x2:f,x3:h,y1:p,y2:g,y3:m}}drawTitle(t,e,n){const r=this,i=r.title,o=i.length;let a,s,l;if(o){const u=pr(n.rtl,r.x,r.width);for(t.x=yo(r,n.titleAlign,n),e.textAlign=u.textAlign(n.titleAlign),e.textBaseline="middle",a=Re(n.titleFont),s=n.titleSpacing,e.fillStyle=n.titleColor,e.font=a.string,l=0;l<o;++l)e.fillText(i[l],u.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+s,l+1===o&&(t.y+=n.titleMarginBottom-s)}}_drawColorBox(t,e,n,r,i){const o=this,a=o.labelColors[n],s=o.labelPointStyles[n],{boxHeight:l,boxWidth:u}=i,c=Re(i.bodyFont),d=yo(o,"left",i),f=r.x(d),h=e.y+(l<c.lineHeight?(c.lineHeight-l)/2:0);if(i.usePointStyle){const e={radius:Math.min(u,l)/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:1},n=r.leftForLtr(f,u)+u/2,o=h+l/2;t.strokeStyle=i.multiKeyBackground,t.fillStyle=i.multiKeyBackground,Ut(t,e,n,o),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,Ut(t,e,n,o)}else{t.lineWidth=a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const e=r.leftForLtr(f,u),n=r.leftForLtr(r.xPlus(f,1),u-2),o=Pe(a.borderRadius);Object.values(o).some(t=>0!==t)?(t.beginPath(),t.fillStyle=i.multiKeyBackground,Qt(t,{x:e,y:h,w:u,h:l,radius:o}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),Qt(t,{x:n,y:h+1,w:u-2,h:l-2,radius:o}),t.fill()):(t.fillStyle=i.multiKeyBackground,t.fillRect(e,h,u,l),t.strokeRect(e,h,u,l),t.fillStyle=a.backgroundColor,t.fillRect(n,h+1,u-2,l-2))}t.fillStyle=o.labelTextColors[n]}drawBody(t,e,n){const r=this,{body:i}=r,{bodySpacing:o,bodyAlign:a,displayColors:s,boxHeight:l,boxWidth:u}=n,c=Re(n.bodyFont);let d=c.lineHeight,f=0;const h=pr(n.rtl,r.x,r.width),p=function(n){e.fillText(n,h.x(t.x+f),t.y+d/2),t.y+=d+o},g=h.textAlign(a);let m,v,y,x,b,_,w;for(e.textAlign=a,e.textBaseline="middle",e.font=c.string,t.x=yo(r,g,n),e.fillStyle=n.bodyColor,$(r.beforeBody,p),f=s&&"right"!==g?"center"===a?u/2+1:u+2:0,x=0,_=i.length;x<_;++x){for(m=i[x],v=r.labelTextColors[x],e.fillStyle=v,$(m.before,p),y=m.lines,s&&y.length&&(r._drawColorBox(e,t,x,h,n),d=Math.max(c.lineHeight,l)),b=0,w=y.length;b<w;++b)p(y[b]),d=c.lineHeight;$(m.after,p)}f=0,d=c.lineHeight,$(r.afterBody,p),t.y-=o}drawFooter(t,e,n){const r=this,i=r.footer,o=i.length;let a,s;if(o){const l=pr(n.rtl,r.x,r.width);for(t.x=yo(r,n.footerAlign,n),t.y+=n.footerMarginTop,e.textAlign=l.textAlign(n.footerAlign),e.textBaseline="middle",a=Re(n.footerFont),e.fillStyle=n.footerColor,e.font=a.string,s=0;s<o;++s)e.fillText(i[s],l.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+n.footerSpacing}}drawBackground(t,e,n,r){const{xAlign:i,yAlign:o}=this,{x:a,y:s}=t,{width:l,height:u}=n,c=r.cornerRadius;e.fillStyle=r.backgroundColor,e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.beginPath(),e.moveTo(a+c,s),"top"===o&&this.drawCaret(t,e,n,r),e.lineTo(a+l-c,s),e.quadraticCurveTo(a+l,s,a+l,s+c),"center"===o&&"right"===i&&this.drawCaret(t,e,n,r),e.lineTo(a+l,s+u-c),e.quadraticCurveTo(a+l,s+u,a+l-c,s+u),"bottom"===o&&this.drawCaret(t,e,n,r),e.lineTo(a+c,s+u),e.quadraticCurveTo(a,s+u,a,s+u-c),"center"===o&&"left"===i&&this.drawCaret(t,e,n,r),e.lineTo(a,s+c),e.quadraticCurveTo(a,s,a+c,s),e.closePath(),e.fill(),r.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this,n=e._chart,r=e.$animations,i=r&&r.x,o=r&&r.y;if(i||o){const r=uo[t.position].call(e,e._active,e._eventPosition);if(!r)return;const a=e._size=po(e,t),s=Object.assign({},r,e._size),l=mo(n,t,s),u=vo(t,s,l,n);i._to===u.x&&o._to===u.y||(e.xAlign=l.xAlign,e.yAlign=l.yAlign,e.width=a.width,e.height=a.height,e.caretX=r.x,e.caretY=r.y,e._resolveAnimations().update(e,u))}}draw(t){const e=this,n=e.options.setContext(e.getContext());let r=e.opacity;if(!r)return;e._updateAnimationTarget(n);const i={width:e.width,height:e.height},o={x:e.x,y:e.y};r=Math.abs(r)<.001?0:r;const a=Ee(n.padding);n.enabled&&(e.title.length||e.beforeBody.length||e.body.length||e.afterBody.length||e.footer.length)&&(t.save(),t.globalAlpha=r,e.drawBackground(o,t,i,n),gr(t,n.textDirection),o.y+=a.top,e.drawTitle(o,t,n),e.drawBody(o,t,n),e.drawFooter(o,t,n),mr(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const n=this,r=n._active,i=t.map(({datasetIndex:t,index:e})=>{const r=n._chart.getDatasetMeta(t);if(!r)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:r.data[e],index:e}}),o=!Z(r,i),a=n._positionChanged(i,e);(o||a)&&(n._active=i,n._eventPosition=e,n.update(!0))}handleEvent(t,e){const n=this,r=n.options,i=n._active||[];let o=!1,a=[];"mouseout"!==t.type&&(a=n._chart.getElementsAtEventForMode(t,r.mode,r,e),r.reverse&&a.reverse());const s=n._positionChanged(a,t);return o=e||!Z(a,i)||s,o&&(n._active=a,(r.enabled||r.external)&&(n._eventPosition={x:t.x,y:t.y},n.update(!0,e))),o}_positionChanged(t,e){const{caretX:n,caretY:r,options:i}=this,o=uo[i.position].call(this,t,e);return!1!==o&&(n!==o.x||r!==o.y)}}_o.positioners=uo;var wo=Object.freeze({__proto__:null,Decimation:Vi,Filler:eo,Legend:io,SubTitle:lo,Title:ao,Tooltip:{id:"tooltip",_element:_o,positioners:uo,afterInit(t,e,n){n&&(t.tooltip=new _o({_chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip,n={tooltip:e};!1!==t.notifyPlugins("beforeTooltipDraw",n)&&(e&&e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n))},afterEvent(t,e){t.tooltip&&t.tooltip.handleEvent(e.event,e.replay)&&(e.changed=!0)},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:z,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,r=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return n[e.dataIndex]}return""},afterTitle:z,beforeBody:z,beforeLabel:z,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return F(n)||(e+=n),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:z,afterBody:z,beforeFooter:z,footer:z,afterFooter:z}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]}});class So extends Gn{constructor(t){super(t),this._startValue=void 0,this._valueRange=0}parse(t,e){if(F(t))return null;const n=this.getLabels();return((t,e)=>null===t?null:zt(Math.round(t),0,e))(e=isFinite(e)&&n[e]===t?e:function(t,e,n){const r=t.indexOf(e);return-1===r?((t,e,n)=>"string"==typeof e?t.push(e)-1:isNaN(e)?null:n)(t,e,n):r!==t.lastIndexOf(e)?n:r}(n,t,U(e,t)),n.length-1)}determineDataLimits(){const t=this,{minDefined:e,maxDefined:n}=t.getUserBounds();let{min:r,max:i}=t.getMinMax(!0);"ticks"===t.options.bounds&&(e||(r=0),n||(i=t.getLabels().length-1)),t.min=r,t.max=i}buildTicks(){const t=this,e=t.min,n=t.max,r=t.options.offset,i=[];let o=t.getLabels();o=0===e&&n===o.length-1?o:o.slice(e,n+1),t._valueRange=Math.max(o.length-(r?0:1),1),t._startValue=t.min-(r?.5:0);for(let a=e;a<=n;a++)i.push({value:a});return i}getLabelForValue(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}configure(){const t=this;super.configure(),t.isHorizontal()||(t._reversePixels=!t._reversePixels)}getPixelForValue(t){const e=this;return"number"!=typeof t&&(t=e.parse(t)),null===t?NaN:e.getPixelForDecimal((t-e._startValue)/e._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){const e=this;return Math.round(e._startValue+e.getDecimalForPixel(t)*e._valueRange)}getBasePixel(){return this.bottom}}function Co(t,e,{horizontal:n,minRotation:r}){const i=Dt(r),o=(n?Math.sin(i):Math.cos(i))||.001;return Math.min(e/o,.75*e*(""+t).length)}So.id="category",So.defaults={ticks:{callback:So.prototype.getLabelForValue}};class Mo extends Gn{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return F(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const t=this,{beginAtZero:e}=t.options,{minDefined:n,maxDefined:r}=t.getUserBounds();let{min:i,max:o}=t;const a=t=>i=n?i:t,s=t=>o=r?o:t;if(e){const t=St(i),e=St(o);t<0&&e<0?s(0):t>0&&e>0&&a(0)}i===o&&(s(o+1),e||a(i-1)),t.min=i,t.max=o}getTickLimit(){const t=this,e=t.options.ticks;let n,{maxTicksLimit:r,stepSize:i}=e;return i?n=Math.ceil(t.max/i)-Math.floor(t.min/i)+1:(n=t.computeTickLimit(),r=r||11),r&&(n=Math.min(r,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this,e=t.options,n=e.ticks;let r=t.getTickLimit();r=Math.max(2,r);const i=function(t,e){const n=[],{bounds:r,step:i,min:o,max:a,precision:s,count:l,maxTicks:u,maxDigits:c,includeBounds:d}=t,f=i||1,h=u-1,{min:p,max:g}=e,m=!F(o),v=!F(a),y=!F(l),x=(g-p)/(c+1);let b,_,w,S,C=Ct((g-p)/h/f)*f;if(C<1e-14&&!m&&!v)return[{value:p},{value:g}];S=Math.ceil(g/C)-Math.floor(p/C),S>h&&(C=Ct(S*C/h/f)*f),F(s)||(b=Math.pow(10,s),C=Math.ceil(C*b)/b),"ticks"===r?(_=Math.floor(p/C)*C,w=Math.ceil(g/C)*C):(_=p,w=g),m&&v&&i&&At((a-o)/i,C/1e3)?(S=Math.round(Math.min((a-o)/C,u)),C=(a-o)/S,_=o,w=a):y?(_=m?o:_,w=v?a:w,S=l-1,C=(w-_)/S):(S=(w-_)/C,S=kt(S,Math.round(S),C/1e3)?Math.round(S):Math.ceil(S));const M=Math.max(Pt(C),Pt(_));b=Math.pow(10,F(s)?M:s),_=Math.round(_*b)/b,w=Math.round(w*b)/b;let T=0;for(m&&(d&&_!==o?(n.push({value:o}),_<o&&T++,kt(Math.round((_+T*C)*b)/b,o,Co(o,x,t))&&T++):_<o&&T++);T<S;++T)n.push({value:Math.round((_+T*C)*b)/b});return v&&d&&w!==a?kt(n[n.length-1].value,a,Co(a,x,t))?n[n.length-1].value=a:n.push({value:a}):v&&w!==a||n.push({value:w}),n}({maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:t._maxDigits(),horizontal:t.isHorizontal(),minRotation:n.minRotation||0,includeBounds:!1!==n.includeBounds},t._range||t);return"ticks"===e.bounds&&It(i,t,"value"),e.reverse?(i.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),i}configure(){const t=this,e=t.ticks;let n=t.min,r=t.max;if(super.configure(),t.options.offset&&e.length){const t=(r-n)/Math.max(e.length-1,1)/2;n-=t,r+=t}t._startValue=n,t._endValue=r,t._valueRange=r-n}getLabelForValue(t){return Rn(t,this.chart.options.locale)}}class To extends Mo{determineDataLimits(){const t=this,{min:e,max:n}=t.getMinMax(!0);t.min=j(e)?e:0,t.max=j(n)?n:1,t.handleTickRangeOptions()}computeTickLimit(){const t=this,e=t.isHorizontal(),n=e?t.width:t.height,r=Dt(t.options.ticks.minRotation),i=(e?Math.sin(r):Math.cos(r))||.001,o=t._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,o.lineHeight/i))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}function ko(t){return 1==t/Math.pow(10,Math.floor(wt(t)))}To.id="linear",To.defaults={ticks:{callback:Nn.formatters.numeric}};class Ao extends Gn{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const n=Mo.prototype.parse.apply(this,[t,e]);if(0!==n)return j(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const t=this,{min:e,max:n}=t.getMinMax(!0);t.min=j(e)?Math.max(0,e):null,t.max=j(n)?Math.max(0,n):null,t.options.beginAtZero&&(t._zero=!0),t.handleTickRangeOptions()}handleTickRangeOptions(){const t=this,{minDefined:e,maxDefined:n}=t.getUserBounds();let r=t.min,i=t.max;const o=t=>r=e?r:t,a=t=>i=n?i:t,s=(t,e)=>Math.pow(10,Math.floor(wt(t))+e);r===i&&(r<=0?(o(1),a(10)):(o(s(r,-1)),a(s(i,1)))),r<=0&&o(s(i,-1)),i<=0&&a(s(r,1)),t._zero&&t.min!==t._suggestedMin&&r===s(t.min,0)&&o(s(r,-1)),t.min=r,t.max=i}buildTicks(){const t=this,e=t.options,n=function(t,e){const n=Math.floor(wt(e.max)),r=Math.ceil(e.max/Math.pow(10,n)),i=[];let o=G(t.min,Math.pow(10,Math.floor(wt(e.min)))),a=Math.floor(wt(o)),s=Math.floor(o/Math.pow(10,a)),l=a<0?Math.pow(10,Math.abs(a)):1;do{i.push({value:o,major:ko(o)}),++s,10===s&&(s=1,++a,l=a>=0?1:l),o=Math.round(s*Math.pow(10,a)*l)/l}while(a<n||a===n&&s<r);const u=G(t.max,o);return i.push({value:u,major:ko(o)}),i}({min:t._userMin,max:t._userMax},t);return"ticks"===e.bounds&&It(n,t,"value"),e.reverse?(n.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),n}getLabelForValue(t){return void 0===t?"0":Rn(t,this.chart.options.locale)}configure(){const t=this,e=t.min;super.configure(),t._startValue=wt(e),t._valueRange=wt(t.max)-wt(e)}getPixelForValue(t){const e=this;return void 0!==t&&0!==t||(t=e.min),null===t||isNaN(t)?NaN:e.getPixelForDecimal(t===e.min?0:(wt(t)-e._startValue)/e._valueRange)}getValueForPixel(t){const e=this,n=e.getDecimalForPixel(t);return Math.pow(10,e._startValue+n*e._valueRange)}}function Io(t){const e=t.ticks;if(e.display&&t.display){const t=Ee(e.backdropPadding);return U(e.font&&e.font.size,ht.font.size)+t.height}return 0}function Do(t,e,n,r,i){return t===r||t===i?{start:e-n/2,end:e+n/2}:t<r||t>i?{start:e-n,end:e}:{start:e,end:e+n}}function Oo(t){return 0===t||180===t?"center":t<180?"left":"right"}function Po(t,e,n){return"right"===n?t-=e:"center"===n&&(t-=e/2),t}function Eo(t,e,n){return 90===n||270===n?t-=e/2:(n>270||n<90)&&(t-=e),t}function Ro(t,e,n,r){const{ctx:i}=t;if(n)i.arc(t.xCenter,t.yCenter,e,0,gt);else{let n=t.getPointPosition(0,e);i.moveTo(n.x,n.y);for(let o=1;o<r;o++)n=t.getPointPosition(o,e),i.lineTo(n.x,n.y)}}function Lo(t){return Tt(t)?t:0}Ao.id="logarithmic",Ao.defaults={ticks:{callback:Nn.formatters.logarithmic,major:{enabled:!0}}};class No extends Mo{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this;t.width=t.maxWidth,t.height=t.maxHeight,t.paddingTop=Io(t.options)/2,t.xCenter=Math.floor(t.width/2),t.yCenter=Math.floor((t.height-t.paddingTop)/2),t.drawingArea=Math.min(t.height-t.paddingTop,t.width)/2}determineDataLimits(){const t=this,{min:e,max:n}=t.getMinMax(!1);t.min=j(e)&&!isNaN(e)?e:0,t.max=j(n)&&!isNaN(n)?n:0,t.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Io(this.options))}generateTickLabels(t){const e=this;Mo.prototype.generateTickLabels.call(e,t),e._pointLabels=e.getLabels().map((t,n)=>{const r=Y(e.options.pointLabels.callback,[t,n],e);return r||0===r?r:""})}fit(){const t=this,e=t.options;e.display&&e.pointLabels.display?function(t){const e={l:0,r:t.width,t:0,b:t.height-t.paddingTop},n={},r=[],i=[],o=t.getLabels().length;for(let u=0;u<o;u++){const o=t.options.pointLabels.setContext(t.getContext(u));i[u]=o.padding;const c=t.getPointPosition(u,t.drawingArea+i[u]),d=Re(o.font),f=(a=t.ctx,s=d,l=H(l=t._pointLabels[u])?l:[l],{w:Wt(a,s.string,l),h:l.length*s.lineHeight});r[u]=f;const h=t.getIndexAngle(u),p=Ot(h),g=Do(p,c.x,f.w,0,180),m=Do(p,c.y,f.h,90,270);g.start<e.l&&(e.l=g.start,n.l=h),g.end>e.r&&(e.r=g.end,n.r=h),m.start<e.t&&(e.t=m.start,n.t=h),m.end>e.b&&(e.b=m.end,n.b=h)}var a,s,l;t._setReductions(t.drawingArea,e,n),t._pointLabelItems=function(t,e,n){const r=[],i=t.getLabels().length,o=t.options,a=Io(o),s=t.getDistanceFromCenterForValue(o.ticks.reverse?t.min:t.max);for(let l=0;l<i;l++){const i=t.getPointPosition(l,s+(0===l?a/2:0)+n[l]),o=Ot(t.getIndexAngle(l)),u=e[l],c=Eo(i.y,u.h,o),d=Oo(o),f=Po(i.x,u.w,d);r.push({x:i.x,y:c,textAlign:d,left:f,top:c,right:f+u.w,bottom:c+u.h})}return r}(t,r,i)}(t):t.setCenterPoint(0,0,0,0)}_setReductions(t,e,n){const r=this;let i=e.l/Math.sin(n.l),o=Math.max(e.r-r.width,0)/Math.sin(n.r),a=-e.t/Math.cos(n.t),s=-Math.max(e.b-(r.height-r.paddingTop),0)/Math.cos(n.b);i=Lo(i),o=Lo(o),a=Lo(a),s=Lo(s),r.drawingArea=Math.max(t/2,Math.min(Math.floor(t-(i+o)/2),Math.floor(t-(a+s)/2))),r.setCenterPoint(i,o,a,s)}setCenterPoint(t,e,n,r){const i=this,o=n+i.drawingArea,a=i.height-i.paddingTop-r-i.drawingArea;i.xCenter=Math.floor((t+i.drawingArea+(i.width-e-i.drawingArea))/2+i.left),i.yCenter=Math.floor((o+a)/2+i.top+i.paddingTop)}getIndexAngle(t){return Nt(t*(gt/this.getLabels().length)+Dt(this.options.startAngle||0))}getDistanceFromCenterForValue(t){const e=this;if(F(t))return NaN;const n=e.drawingArea/(e.max-e.min);return e.options.reverse?(e.max-t)*n:(t-e.min)*n}getValueForDistanceFromCenter(t){if(F(t))return NaN;const e=this,n=t/(e.drawingArea/(e.max-e.min));return e.options.reverse?e.max-n:e.min+n}getPointPosition(t,e){const n=this,r=n.getIndexAngle(t)-xt;return{x:Math.cos(r)*e+n.xCenter,y:Math.sin(r)*e+n.yCenter,angle:r}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:n,right:r,bottom:i}=this._pointLabelItems[t];return{left:e,top:n,right:r,bottom:i}}drawBackground(){const t=this,{backgroundColor:e,grid:{circular:n}}=t.options;if(e){const r=t.ctx;r.save(),r.beginPath(),Ro(t,t.getDistanceFromCenterForValue(t._endValue),n,t.getLabels().length),r.closePath(),r.fillStyle=e,r.fill(),r.restore()}}drawGrid(){const t=this,e=t.ctx,n=t.options,{angleLines:r,grid:i}=n,o=t.getLabels().length;let a,s,l;if(n.pointLabels.display&&function(t,e){const{ctx:n,options:{pointLabels:r}}=t;for(let i=e-1;i>=0;i--){const e=r.setContext(t.getContext(i)),o=Re(e.font),{x:a,y:s,textAlign:l,left:u,top:c,right:d,bottom:f}=t._pointLabelItems[i],{backdropColor:h}=e;if(!F(h)){const t=Ee(e.backdropPadding);n.fillStyle=h,n.fillRect(u-t.left,c-t.top,d-u+t.width,f-c+t.height)}Kt(n,t._pointLabels[i],a,s+o.lineHeight/2,o,{color:e.color,textAlign:l,textBaseline:"middle"})}}(t,o),i.display&&t.ticks.forEach((e,n)=>{if(0!==n){s=t.getDistanceFromCenterForValue(e.value);const r=i.setContext(t.getContext(n-1));!function(t,e,n,r){const i=t.ctx,o=e.circular,{color:a,lineWidth:s}=e;!o&&!r||!a||!s||n<0||(i.save(),i.strokeStyle=a,i.lineWidth=s,i.setLineDash(e.borderDash),i.lineDashOffset=e.borderDashOffset,i.beginPath(),Ro(t,n,o,r),i.closePath(),i.stroke(),i.restore())}(t,r,s,o)}}),r.display){for(e.save(),a=t.getLabels().length-1;a>=0;a--){const i=r.setContext(t.getContext(a)),{color:o,lineWidth:u}=i;u&&o&&(e.lineWidth=u,e.strokeStyle=o,e.setLineDash(i.borderDash),e.lineDashOffset=i.borderDashOffset,s=t.getDistanceFromCenterForValue(n.ticks.reverse?t.min:t.max),l=t.getPointPosition(a,s),e.beginPath(),e.moveTo(t.xCenter,t.yCenter),e.lineTo(l.x,l.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const t=this,e=t.ctx,n=t.options,r=n.ticks;if(!r.display)return;const i=t.getIndexAngle(0);let o,a;e.save(),e.translate(t.xCenter,t.yCenter),e.rotate(i),e.textAlign="center",e.textBaseline="middle",t.ticks.forEach((i,s)=>{if(0===s&&!n.reverse)return;const l=r.setContext(t.getContext(s)),u=Re(l.font);if(o=t.getDistanceFromCenterForValue(t.ticks[s].value),l.showLabelBackdrop){e.font=u.string,a=e.measureText(i.label).width,e.fillStyle=l.backdropColor;const t=Ee(l.backdropPadding);e.fillRect(-a/2-t.left,-o-u.size/2-t.top,a+t.width,u.size+t.height)}Kt(e,i.label,0,-o,u,{color:l.color})}),e.restore()}drawTitle(){}}No.id="radialLinear",No.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Nn.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5}},No.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},No.descriptors={angleLines:{_fallback:"grid"}};const Bo={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},zo=Object.keys(Bo);function Vo(t,e){return t-e}function Fo(t,e){if(F(e))return null;const n=t._adapter,{parser:r,round:i,isoWeekday:o}=t._parseOpts;let a=e;return"function"==typeof r&&(a=r(a)),j(a)||(a="string"==typeof r?n.parse(a,r):n.parse(a)),null===a?null:(i&&(a="week"!==i||!Tt(o)&&!0!==o?n.startOf(a,i):n.startOf(a,"isoWeek",o)),+a)}function Ho(t,e,n,r){const i=zo.length;for(let o=zo.indexOf(t);o<i-1;++o){const t=Bo[zo[o]],i=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-e)/(i*t.size))<=r)return zo[o]}return zo[i-1]}function Wo(t,e,n){if(n){if(n.length){const{lo:r,hi:i}=te(n,e);t[n[r]>=e?n[r]:n[i]]=!0}}else t[e]=!0}function jo(t,e,n){const r=[],i={},o=e.length;let a,s;for(a=0;a<o;++a)s=e[a],i[s]=a,r.push({value:s,major:!1});return 0!==o&&n?function(t,e,n,r){const i=t._adapter,o=+i.startOf(e[0].value,r),a=e[e.length-1].value;let s,l;for(s=o;s<=a;s=+i.add(s,1,r))l=n[s],l>=0&&(e[l].major=!0);return e}(t,r,i,n):r}class Go extends Gn{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e){const n=t.time||(t.time={}),r=this._adapter=new ti._date(t.adapters.date);et(n.displayFormats,r.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:Fo(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this,e=t.options,n=t._adapter,r=e.time.unit||"day";let{min:i,max:o,minDefined:a,maxDefined:s}=t.getUserBounds();function l(t){a||isNaN(t.min)||(i=Math.min(i,t.min)),s||isNaN(t.max)||(o=Math.max(o,t.max))}a&&s||(l(t._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||l(t.getMinMax(!1))),i=j(i)&&!isNaN(i)?i:+n.startOf(Date.now(),r),o=j(o)&&!isNaN(o)?o:+n.endOf(Date.now(),r)+1,t.min=Math.min(i,o-1),t.max=Math.max(i+1,o)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],n=t[t.length-1]),{min:e,max:n}}buildTicks(){const t=this,e=t.options,n=e.time,r=e.ticks,i="labels"===r.source?t.getLabelTimestamps():t._generate();"ticks"===e.bounds&&i.length&&(t.min=t._userMin||i[0],t.max=t._userMax||i[i.length-1]);const o=t.min,a=re(i,o,t.max);return t._unit=n.unit||(r.autoSkip?Ho(n.minUnit,t.min,t.max,t._getLabelCapacity(o)):function(t,e,n,r,i){for(let o=zo.length-1;o>=zo.indexOf(n);o--){const n=zo[o];if(Bo[n].common&&t._adapter.diff(i,r,n)>=e-1)return n}return zo[n?zo.indexOf(n):0]}(t,a.length,n.minUnit,t.min,t.max)),t._majorUnit=r.major.enabled&&"year"!==t._unit?function(t){for(let e=zo.indexOf(t)+1,n=zo.length;e<n;++e)if(Bo[zo[e]].common)return zo[e]}(t._unit):void 0,t.initOffsets(i),e.reverse&&a.reverse(),jo(t,a,t._majorUnit)}initOffsets(t){const e=this;let n,r,i=0,o=0;e.options.offset&&t.length&&(n=e.getDecimalForValue(t[0]),i=1===t.length?1-n:(e.getDecimalForValue(t[1])-n)/2,r=e.getDecimalForValue(t[t.length-1]),o=1===t.length?r:(r-e.getDecimalForValue(t[t.length-2]))/2);const a=t.length<3?.5:.25;i=zt(i,0,a),o=zt(o,0,a),e._offsets={start:i,end:o,factor:1/(i+1+o)}}_generate(){const t=this,e=t._adapter,n=t.min,r=t.max,i=t.options,o=i.time,a=o.unit||Ho(o.minUnit,n,r,t._getLabelCapacity(n)),s=U(o.stepSize,1),l="week"===a&&o.isoWeekday,u=Tt(l)||!0===l,c={};let d,f,h=n;if(u&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,u?"day":a),e.diff(r,n,a)>1e5*s)throw new Error(n+" and "+r+" are too far apart with stepSize of "+s+" "+a);const p="data"===i.ticks.source&&t.getDataTimestamps();for(d=h,f=0;d<r;d=+e.add(d,s,a),f++)Wo(c,d,p);return d!==r&&"ticks"!==i.bounds&&1!==f||Wo(c,d,p),Object.keys(c).sort((t,e)=>t-e).map(t=>+t)}getLabelForValue(t){const e=this.options.time;return this._adapter.format(t,e.tooltipFormat?e.tooltipFormat:e.displayFormats.datetime)}_tickFormatFunction(t,e,n,r){const i=this,o=i.options,a=o.time.displayFormats,s=i._unit,l=i._majorUnit,u=l&&a[l],c=n[e],d=i._adapter.format(t,r||(l&&u&&c&&c.major?u:s&&a[s])),f=o.ticks.callback;return f?Y(f,[d,e,n],i):d}generateTickLabels(t){let e,n,r;for(e=0,n=t.length;e<n;++e)r=t[e],r.label=this._tickFormatFunction(r.value,e,t)}getDecimalForValue(t){const e=this;return null===t?NaN:(t-e.min)/(e.max-e.min)}getPixelForValue(t){const e=this,n=e._offsets,r=e.getDecimalForValue(t);return e.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(t){const e=this,n=e._offsets,r=e.getDecimalForPixel(t)/n.factor-n.end;return e.min+r*(e.max-e.min)}_getLabelSize(t){const e=this,n=e.options.ticks,r=e.ctx.measureText(t).width,i=Dt(e.isHorizontal()?n.maxRotation:n.minRotation),o=Math.cos(i),a=Math.sin(i),s=e._resolveTickFontOptions(0).size;return{w:r*o+s*a,h:r*a+s*o}}_getLabelCapacity(t){const e=this,n=e.options.time,r=n.displayFormats,i=r[n.unit]||r.millisecond,o=e._tickFormatFunction(t,0,jo(e,[t],e._majorUnit),i),a=e._getLabelSize(o),s=Math.floor(e.isHorizontal()?e.width/a.w:e.height/a.h)-1;return s>0?s:1}getDataTimestamps(){const t=this;let e,n,r=t._cache.data||[];if(r.length)return r;const i=t.getMatchingVisibleMetas();if(t._normalized&&i.length)return t._cache.data=i[0].controller.getAllParsedValues(t);for(e=0,n=i.length;e<n;++e)r=r.concat(i[e].controller.getAllParsedValues(t));return t._cache.data=t.normalize(r)}getLabelTimestamps(){const t=this,e=t._cache.labels||[];let n,r;if(e.length)return e;const i=t.getLabels();for(n=0,r=i.length;n<r;++n)e.push(Fo(t,i[n]));return t._cache.labels=t._normalized?e:t.normalize(e)}normalize(t){return se(t.sort(Vo))}}function Uo(t,e,n){let r,i,o,a,s=0,l=t.length-1;n?(e>=t[s].pos&&e<=t[l].pos&&({lo:s,hi:l}=ee(t,"pos",e)),({pos:r,time:o}=t[s]),({pos:i,time:a}=t[l])):(e>=t[s].time&&e<=t[l].time&&({lo:s,hi:l}=ee(t,"time",e)),({time:r,pos:o}=t[s]),({time:i,pos:a}=t[l]));const u=i-r;return u?o+(a-o)*(e-r)/u:o}Go.id="time",Go.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};class qo extends Go{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this,e=t._getTimestampsForTable(),n=t._table=t.buildLookupTable(e);t._minPos=Uo(n,t.min),t._tableRange=Uo(n,t.max)-t._minPos,super.initOffsets(e)}buildLookupTable(t){const{min:e,max:n}=this,r=[],i=[];let o,a,s,l,u;for(o=0,a=t.length;o<a;++o)l=t[o],l>=e&&l<=n&&r.push(l);if(r.length<2)return[{time:e,pos:0},{time:n,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],s=r[o-1],l=r[o],Math.round((u+s)/2)!==l&&i.push({time:l,pos:o/(a-1)});return i}_getTimestampsForTable(){const t=this;let e=t._cache.all||[];if(e.length)return e;const n=t.getDataTimestamps(),r=t.getLabelTimestamps();return e=n.length&&r.length?t.normalize(n.concat(r)):n.length?n:r,e=t._cache.all=e,e}getDecimalForValue(t){return(Uo(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this,n=e._offsets,r=e.getDecimalForPixel(t)/n.factor-n.end;return Uo(e._table,r*e._tableRange+e._minPos,!0)}}qo.id="timeseries",qo.defaults=Go.defaults;var Xo=Object.freeze({__proto__:null,CategoryScale:So,LinearScale:To,LogarithmicScale:Ao,RadialLinearScale:No,TimeScale:Go,TimeSeriesScale:qo});return $r.register(hi,Xo,Ni,wo),$r.helpers={...Cr},$r._adapters=ti,$r.Animation=vn,$r.Animations=xn,$r.animator=a,$r.controllers=Tr.controllers.items,$r.DatasetController=On,$r.Element=Pn,$r.elements=Ni,$r.Interaction=Te,$r.layouts=Xe,$r.platforms=cn,$r.Scale=Gn,$r.Ticks=Nn,Object.assign($r,hi,Xo,Ni,wo,cn),$r.Chart=$r,"undefined"!=typeof window&&(window.Chart=$r),$r});