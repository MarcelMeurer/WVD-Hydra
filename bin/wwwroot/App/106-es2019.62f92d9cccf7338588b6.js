(self.webpackChunkngx_admin=self.webpackChunkngx_admin||[]).push([[106],{75106:function(e,t,n){"use strict";n.r(t),n.d(t,{ImageBuilderModule:function(){return he}});var o=n(38583),a=n(99763),i=n(37716);let l=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-image-builder"]],decls:1,vars:0,template:function(e,t){1&e&&i["\u0275\u0275element"](0,"router-outlet")},directives:[a.lC],styles:[""]}),e})();var r=n(79765),s=n(46782),d=n(11173),m=n(85902),c=n(27861),g=n(39538),p=n(91841),h=n(9857),u=n(3679),f=n(98774),S=n(99588);const b=["saveSettings"];function v(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"nb-option",13),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275property"]("value",e.Id),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"]("",e.DisplayName," ")}}const y=function(e){return{"is-invalid":e}};function C(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"div",0),i["\u0275\u0275elementStart"](2,"div",17),i["\u0275\u0275elementStart"](3,"p"),i["\u0275\u0275text"](4,"Service Account, optional: Enter a service account to use in scripts."),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](5,"div",0),i["\u0275\u0275elementStart"](6,"div",43),i["\u0275\u0275elementStart"](7,"div",5),i["\u0275\u0275elementStart"](8,"label",44),i["\u0275\u0275text"](9,"Service Account Name"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](10,"div",19),i["\u0275\u0275elementStart"](11,"input",45,46),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.ServiceDomainUser=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](13,"div",43),i["\u0275\u0275elementStart"](14,"div",5),i["\u0275\u0275elementStart"](15,"label",47),i["\u0275\u0275text"](16,"Service Account Password"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](17,"div",19),i["\u0275\u0275elementStart"](18,"input",48,49),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.ServiceDomainPwEncrypted=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275reference"](12),t=i["\u0275\u0275reference"](19),n=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](11),i["\u0275\u0275property"]("ngModel",n.model.ServiceDomainUser)("ngClass",i["\u0275\u0275pureFunction1"](4,y,n.submitted&&e.invalid)),i["\u0275\u0275advance"](7),i["\u0275\u0275property"]("ngModel",n.model.ServiceDomainPwEncrypted)("ngClass",i["\u0275\u0275pureFunction1"](6,y,n.submitted&&t.invalid))}}function x(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"nb-option",13),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275property"]("value",e.Id),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",e.Name," ")}}function I(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"nb-option",13),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275property"]("value",e.name),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",e.regionalDisplayName," ")}}function E(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",5),i["\u0275\u0275elementStart"](1,"label",62),i["\u0275\u0275text"](2,"Locations"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"div",19),i["\u0275\u0275elementStart"](4,"nb-select",63),i["\u0275\u0275listener"]("selectedChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](3).model.SharedImageGalleryDefinitionIdRegions=t}),i["\u0275\u0275template"](5,I,2,2,"nb-option",10),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"](3);i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("selected",e.model.SharedImageGalleryDefinitionIdRegions),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",e.AllRegions)}}function M(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"nb-accordion",0),i["\u0275\u0275elementStart"](1,"nb-accordion-item"),i["\u0275\u0275elementStart"](2,"nb-accordion-item-header"),i["\u0275\u0275text"](3," Azure Compute Gallery "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"nb-accordion-item-body"),i["\u0275\u0275elementStart"](5,"div",0),i["\u0275\u0275elementStart"](6,"div",17),i["\u0275\u0275elementStart"](7,"div",5),i["\u0275\u0275elementStart"](8,"label",50),i["\u0275\u0275text"](9,"Azure Compute Gallery Definition"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](10,"div",19),i["\u0275\u0275elementStart"](11,"nb-select",51),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.SharedImageGalleryDefinitionId=t}),i["\u0275\u0275elementStart"](12,"nb-option",13),i["\u0275\u0275text"](13,"Don't copy image"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](14,x,2,2,"nb-option",10),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](15,"div",17),i["\u0275\u0275template"](16,E,6,2,"div",52),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](17,"div",0),i["\u0275\u0275elementStart"](18,"div",41),i["\u0275\u0275elementStart"](19,"div",5),i["\u0275\u0275elementStart"](20,"label",53),i["\u0275\u0275text"](21,"Remove Native Image after Copying"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](22,"div",54),i["\u0275\u0275elementStart"](23,"nb-checkbox",55),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.SharedImageGalleryDefinitionRemoveImageAfterCopying=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](24,"div",41),i["\u0275\u0275elementStart"](25,"div",5),i["\u0275\u0275elementStart"](26,"label",56),i["\u0275\u0275text"](27,"Date Naming"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](28,"div",54),i["\u0275\u0275elementStart"](29,"nb-checkbox",57),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.SharedImageGalleryDateNaming=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](30,"div",41),i["\u0275\u0275elementStart"](31,"div",5),i["\u0275\u0275elementStart"](32,"label",58),i["\u0275\u0275text"](33,"Shallow replication"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](34,"div",54),i["\u0275\u0275elementStart"](35,"nb-checkbox",59),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.SharedImageGalleryDefinitionShallowReplication=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](36,"div",17),i["\u0275\u0275elementStart"](37,"div",5),i["\u0275\u0275elementStart"](38,"label",60),i["\u0275\u0275text"](39,"Keep Older Versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](40,"div",19),i["\u0275\u0275elementStart"](41,"nb-select",61),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.SharedImageKeepVersions=t}),i["\u0275\u0275elementStart"](42,"nb-option",13),i["\u0275\u0275text"](43,"All"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](44,"nb-option",13),i["\u0275\u0275text"](45,"Last version"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](46,"nb-option",13),i["\u0275\u0275text"](47,"Last 3 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](48,"nb-option",13),i["\u0275\u0275text"](49,"Last 5 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](50,"nb-option",13),i["\u0275\u0275text"](51,"Last 10 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](52,"nb-option",13),i["\u0275\u0275text"](53,"Last 20 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](11),i["\u0275\u0275property"]("ngModel",e.model.SharedImageGalleryDefinitionId),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngForOf",e.GalleryImages),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",!e.model.SharedImageGalleryDefinitionShallowReplication),i["\u0275\u0275advance"](7),i["\u0275\u0275property"]("ngModel",e.model.SharedImageGalleryDefinitionRemoveImageAfterCopying),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",e.model.SharedImageGalleryDateNaming),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",e.model.SharedImageGalleryDefinitionShallowReplication),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",e.model.SharedImageKeepVersions),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("value",0),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",1),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",3),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",5),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",10),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",20)}}function w(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"nb-option",13),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275property"]("value",e.Id),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",e.Name," ")}}function T(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"nb-accordion",0),i["\u0275\u0275elementStart"](1,"nb-accordion-item"),i["\u0275\u0275elementStart"](2,"nb-accordion-item-header"),i["\u0275\u0275text"](3," Azure Local "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"nb-accordion-item-body"),i["\u0275\u0275elementStart"](5,"div",0),i["\u0275\u0275elementStart"](6,"div",17),i["\u0275\u0275elementStart"](7,"div",5),i["\u0275\u0275elementStart"](8,"label",64),i["\u0275\u0275text"](9,"Custom Location"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](10,"div",19),i["\u0275\u0275elementStart"](11,"nb-select",65),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.HciLocationId=t}),i["\u0275\u0275elementStart"](12,"nb-option",13),i["\u0275\u0275text"](13,"Don't copy image"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](14,w,2,2,"nb-option",10),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](15,"div",0),i["\u0275\u0275elementStart"](16,"div",43),i["\u0275\u0275elementStart"](17,"div",5),i["\u0275\u0275elementStart"](18,"label",66),i["\u0275\u0275text"](19,"Remove Native Image after Copying"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](20,"div",19),i["\u0275\u0275elementStart"](21,"nb-checkbox",67),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.HciLocationRemoveImageAfterCopying=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](22,"div",43),i["\u0275\u0275elementStart"](23,"div",5),i["\u0275\u0275elementStart"](24,"label",68),i["\u0275\u0275text"](25,"Use storage account"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](26,"div",19),i["\u0275\u0275elementStart"](27,"nb-checkbox",69),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.HciUseStorageAccount=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](28,"div",17),i["\u0275\u0275elementStart"](29,"div",5),i["\u0275\u0275elementStart"](30,"label",70),i["\u0275\u0275text"](31,"Keep Older Versions "),i["\u0275\u0275element"](32,"nb-icon",71),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](33,"div",19),i["\u0275\u0275elementStart"](34,"nb-select",72),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).model.HciLocationImageKeepVersions=t}),i["\u0275\u0275elementStart"](35,"nb-option",13),i["\u0275\u0275text"](36,"All"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](37,"nb-option",13),i["\u0275\u0275text"](38,"Last version"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](39,"nb-option",13),i["\u0275\u0275text"](40,"Last 3 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](41,"nb-option",13),i["\u0275\u0275text"](42,"Last 5 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](43,"nb-option",13),i["\u0275\u0275text"](44,"Last 10 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](45,"nb-option",13),i["\u0275\u0275text"](46,"Last 20 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](11),i["\u0275\u0275property"]("ngModel",e.model.HciLocationId),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngForOf",e.CustomLocations),i["\u0275\u0275advance"](7),i["\u0275\u0275property"]("ngModel",e.model.HciLocationRemoveImageAfterCopying),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",e.model.HciUseStorageAccount),i["\u0275\u0275advance"](7),i["\u0275\u0275property"]("ngModel",e.model.HciLocationImageKeepVersions),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("value",0),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",1),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",3),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",5),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",10),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",10)}}function V(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"button",73),i["\u0275\u0275text"](1,"Store imaging configuration "),i["\u0275\u0275elementEnd"]())}function O(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"button",74),i["\u0275\u0275text"](1,"Update imaging configuration "),i["\u0275\u0275elementEnd"]())}function R(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"button",75),i["\u0275\u0275text"](1," Create image "),i["\u0275\u0275elementEnd"]())}function D(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"button",75),i["\u0275\u0275text"](1," Apply now "),i["\u0275\u0275elementEnd"]())}function k(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementContainerStart"](0),i["\u0275\u0275elementStart"](1,"div",5),i["\u0275\u0275elementStart"](2,"label",14),i["\u0275\u0275text"](3,"Virtual Machine"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"div",7),i["\u0275\u0275elementStart"](5,"nb-select-filter",15,16),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().model.VmResourceId=t})("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().onVmChange(t)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](7,"div",0),i["\u0275\u0275elementStart"](8,"div",17),i["\u0275\u0275elementStart"](9,"div",5),i["\u0275\u0275elementStart"](10,"label",18),i["\u0275\u0275text"](11,"Automatic Naming"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](12,"div",19),i["\u0275\u0275elementStart"](13,"nb-checkbox",20),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().model.ImageAutoNaming=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](14,"div",17),i["\u0275\u0275elementStart"](15,"div",5),i["\u0275\u0275elementStart"](16,"label",21),i["\u0275\u0275text"](17,"Image Name"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](18,"div",19),i["\u0275\u0275elementStart"](19,"input",22,23),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().model.ImageName=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](21,"div",0),i["\u0275\u0275elementStart"](22,"div",24),i["\u0275\u0275elementStart"](23,"div",5),i["\u0275\u0275elementStart"](24,"label",25),i["\u0275\u0275text"](25,"Image Description"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](26,"div",7),i["\u0275\u0275elementStart"](27,"input",26,27),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().model.ImageNote=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](29,"div",0),i["\u0275\u0275elementStart"](30,"div",17),i["\u0275\u0275elementStart"](31,"div",5),i["\u0275\u0275elementStart"](32,"label",28),i["\u0275\u0275text"](33,"Target Resource Group"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](34,"div",19),i["\u0275\u0275elementStart"](35,"nb-select-filter",29,30),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().model.ImageResourceGroupId=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](37,"div",17),i["\u0275\u0275elementStart"](38,"div",5),i["\u0275\u0275elementStart"](39,"label",31),i["\u0275\u0275text"](40,"Keep Older Versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](41,"div",19),i["\u0275\u0275elementStart"](42,"nb-select",32),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().model.ImageKeepVersions=t}),i["\u0275\u0275elementStart"](43,"nb-option",13),i["\u0275\u0275text"](44,"All"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](45,"nb-option",13),i["\u0275\u0275text"](46,"Last version"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](47,"nb-option",13),i["\u0275\u0275text"](48,"Last 3 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](49,"nb-option",13),i["\u0275\u0275text"](50,"Last 5 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](51,"nb-option",13),i["\u0275\u0275text"](52,"Last 10 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](53,"nb-option",13),i["\u0275\u0275text"](54,"Last 20 versions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](55,"div",0),i["\u0275\u0275elementStart"](56,"div",17),i["\u0275\u0275elementStart"](57,"div",5),i["\u0275\u0275elementStart"](58,"label",33),i["\u0275\u0275text"](59,"Optional.: Run a Script or Collection on the Master first"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](60,"div",19),i["\u0275\u0275elementStart"](61,"ngx-scriptAndCollection",34),i["\u0275\u0275listener"]("onStatusChange",function(t){i["\u0275\u0275restoreView"](e);const n=i["\u0275\u0275nextContext"]();return n.setSelectedScriptOrCollection(n.i,t)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](62,"div",17),i["\u0275\u0275elementStart"](63,"div",5),i["\u0275\u0275elementStart"](64,"label",35),i["\u0275\u0275text"](65,"Tag as 'TestImage'"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](66,"div",19),i["\u0275\u0275elementStart"](67,"nb-checkbox",36),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().model.TagAsTestImage=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](68,C,20,8,"div",11),i["\u0275\u0275template"](69,M,54,13,"nb-accordion",37),i["\u0275\u0275template"](70,T,47,11,"nb-accordion",37),i["\u0275\u0275element"](71,"br"),i["\u0275\u0275elementStart"](72,"div",5),i["\u0275\u0275elementStart"](73,"div",38),i["\u0275\u0275template"](74,V,2,0,"button",39),i["\u0275\u0275template"](75,O,2,0,"button",40),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](76,"div",41),i["\u0275\u0275template"](77,R,2,0,"button",42),i["\u0275\u0275template"](78,D,2,0,"button",42),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=i["\u0275\u0275reference"](6),t=i["\u0275\u0275reference"](20),n=i["\u0275\u0275reference"](28),o=i["\u0275\u0275reference"](36),a=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",a.model.VmResourceId)("nbSpinner",a.spinner2)("ngClass",i["\u0275\u0275pureFunction1"](30,y,a.submitted&&e.invalid))("options",a.Vms),i["\u0275\u0275advance"](8),i["\u0275\u0275property"]("ngModel",a.model.ImageAutoNaming),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("disabled",a.model.ImageAutoNaming)("ngModel",a.model.ImageName)("ngClass",i["\u0275\u0275pureFunction1"](32,y,a.submitted&&t.invalid)),i["\u0275\u0275advance"](8),i["\u0275\u0275property"]("ngModel",a.model.ImageNote)("ngClass",i["\u0275\u0275pureFunction1"](34,y,a.submitted&&n.invalid)),i["\u0275\u0275advance"](8),i["\u0275\u0275property"]("ngModel",a.model.ImageResourceGroupId)("ngClass",i["\u0275\u0275pureFunction1"](36,y,a.submitted&&o.invalid))("options",a.ResourceGroups),i["\u0275\u0275advance"](7),i["\u0275\u0275property"]("ngModel",a.model.ImageKeepVersions),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("value",0),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",1),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",3),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",5),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",10),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("value",20),i["\u0275\u0275advance"](8),i["\u0275\u0275property"]("scene",a.model.SceneId)("idSc",a.model.ScriptOrCollectionOnMaster),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",a.model.TagAsTestImage),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.model.ScriptOrCollectionOnMaster&&"00000000-0000-0000-0000-000000000000"!=a.model.ScriptOrCollectionOnMaster),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.GalleryImagesLength),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.CustomLocationsLength),i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngIf",a.storeDirect&&"00000000-0000-0000-0000-000000000000"==a.model.TemplateId),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.storeDirect&&"00000000-0000-0000-0000-000000000000"!=a.model.TemplateId),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",a.storeDirect),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",!a.storeDirect)}}function P(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"nb-card"),i["\u0275\u0275elementStart"](1,"nb-card-header"),i["\u0275\u0275text"](2,"Save imaging configuration"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"nb-card-body"),i["\u0275\u0275text"](4," Enter a name or description to store the imaging configuration in the database. "),i["\u0275\u0275elementStart"](5,"textarea",76),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().model.TemplateName=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](6,"nb-card-footer"),i["\u0275\u0275elementStart"](7,"div",0),i["\u0275\u0275element"](8,"div",77),i["\u0275\u0275elementStart"](9,"div",78),i["\u0275\u0275elementStart"](10,"button",79),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e).dialogRef.close("0")}),i["\u0275\u0275text"](11,"Cancel"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](12,"div",78),i["\u0275\u0275elementStart"](13,"button",80),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e).dialogRef.close("1")}),i["\u0275\u0275text"](14,"Ok"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",e.model.TemplateName)}}let _=(()=>{class e{constructor(e,t,n,o){this.http=e,this.actionService=t,this.dialogService=n,this.viewSceneService=o,this.destroyed$=new r.xQ,this.isInit=!1,this.lastScene="",this.onStatusChange=new i.EventEmitter,this.model=new m.dR,this.GalleryImagesLength=!1,this.CustomLocationsLength=!1,this.spinner1=!0,this.spinner2=!0,this.submitted=!1}ngOnInit(){this.viewSceneService.getViewScenes().pipe((0,s.R)(this.destroyed$)).subscribe(e=>{this.ViewScenes=e,console.log("Got data about the scenes",this.ViewScenes),this.model=JSON.parse(JSON.stringify(new m.dR)),this.configurationTemplate&&(console.log("Got configuration from parent",this.configurationTemplate),this.onSceneChange(this.configurationTemplate.SceneId)),1==this.ViewScenes.length&&null==this.model.SceneId&&(this.model.SceneId=this.ViewScenes[0].Id,this.onSceneChange(this.model.SceneId)),this.spinner1=!1})}onVmChange(e){console.log(`VM changed to ${e}`);var t=this.Vms.find(t=>t.Id.toLowerCase()===e.toLowerCase());this.isInit||(this.ResourceGroups=this.AllResourceGroups.filter(e=>e.SubscriptionId.toLowerCase()===t.SubscriptionId),this.GalleryImages=this.AllGalleryImages.filter(e=>e.HyperV.toLowerCase()===t.HyperV.toLowerCase()),this.GalleryImagesLength=0!=this.GalleryImages.length,this.CustomLocationsLength=0!=this.CustomLocations.length,this.model.ImageResourceGroupId="",this.model.SharedImageGalleryDefinitionId="",this.model.HciLocationId="",this.saveLocalConfig())}onSceneChange(e){""!=e&&(console.log(`Tenant changed to ${e}. Updating VMs`),this.model.TemplateId="00000000-0000-0000-0000-000000000000",this.spinner2=!0,""!=this.lastScene&&this.resetDependentForms(),this.http.get(`${(new d.tc).apiURL()}/data/scenes/${e}/virtualmachines/imageview`).subscribe(t=>{this.Vms=t,console.log("Got VMs for the selected tenant: "+t.length),this.Vms.length>0&&this.http.get(`${(new d.tc).apiURL()}/data/scenes/${e}/rolloutResources/subscriptions/${this.Vms[0].SubscriptionId}/locations`).subscribe(e=>{var t;if(this.AllRegions=e,console.log("Got Regions for the selected tenant: "+e.length),null===(t=this.configurationTemplate)||void 0===t?void 0:t.VmResourceId){this.model.VmResourceId=this.configurationTemplate.VmResourceId;var n=0;console.log("Waiting for the resource groups, gallery images and custom location to be initialized");var o=setInterval(()=>{this.CustomLocations&&this.AllGalleryImages&&this.AllResourceGroups&&(clearInterval(o),this.onVmChange(this.model.VmResourceId),this.model=this.configurationTemplate,this.configurationTemplate=null),++n>200&&clearInterval(o)},50)}}),this.spinner2=!1}),this.http.get(`${(new d.tc).apiURL()}/data/scenes/${e}/resourcegroups`).subscribe(e=>{this.AllResourceGroups=e,console.log("Got RGs for the selected tenant: "+e.length)}),this.http.get(`${(new d.tc).apiURL()}/data/scenes/${e}/galleryimages`).subscribe(e=>{this.AllGalleryImages=e,console.log("Got GalleryImages for the selected tenant: "+e.length)}),this.http.get(`${(new d.tc).apiURL()}/data/scenes/${e}/customlocations`).subscribe(e=>{this.CustomLocations=e,console.log("Got GalleryImages for the selected tenant: "+e.length)}),this.isInit||(this.model.VmResourceId="",this.model.ImageResourceGroupId="",this.model.SharedImageGalleryDefinitionId="",this.model.HciLocationId="",this.lastScene=e,this.model.SceneId=e,this.saveLocalConfig()))}setSelectedScriptOrCollection(e,t){this.model.ScriptOrCollectionOnMaster=t}resetDependentForms(){this.model.SceneId=null}onSubmit(e,t){this.submitted=!0,console.log(t),e.valid?(this.saveLocalConfig(),this.storeDirect?"storeImage"==t?this.dialogService.open(this.saveSettings,{}).onClose.subscribe(e=>{"1"==e&&(this.model.TemplateId=window.crypto.randomUUID(),this.actionService.sendActionAsync(`scenes/${this.model.SceneId}/storageimagedefinition`,this.model,"Store image definition","").subscribe(e=>{e?console.log("Got data from the server",e,this.model):this.model.TemplateId="00000000-0000-0000-0000-000000000000"}))}):"updateImage"==t?this.dialogService.open(this.saveSettings,{}).onClose.subscribe(e=>{"1"==e&&this.actionService.sendActionAsync(`scenes/${this.model.SceneId}/storageimagedefinition`,this.model,"Update image definition","").subscribe(e=>{e&&console.log("Got data from the server",e,this.model)})}):this.actionService.sendActionAsync(`scenes/${this.model.SceneId}/createimage`,this.model,"Create image","").subscribe():(console.log("Sending configuration back to parent"),this.onStatusChange.emit(this.model))):alert("Please check your configuration. Some properties or selections are not valid or missing. Check the red-cross-marked properties.")}onCancel(){console.log("Canceling deployment configuration"),this.onStatusChange.emit(null)}saveLocalConfig(){JSON,localStorage.setItem("Hydra.ImageCreation.Default",JSON.stringify(this.model))}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](p.eN),i["\u0275\u0275directiveInject"](c.c),i["\u0275\u0275directiveInject"](h.Gln),i["\u0275\u0275directiveInject"](g.E))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-image-creation-config"]],viewQuery:function(e,t){if(1&e&&i["\u0275\u0275viewQuery"](b,5),2&e){let e;i["\u0275\u0275queryRefresh"](e=i["\u0275\u0275loadQuery"]())&&(t.saveSettings=e.first)}},inputs:{configurationTemplate:"configurationTemplate",sceneId:"sceneId",storeDirect:"storeDirect"},outputs:{onStatusChange:"onStatusChange"},decls:23,vars:7,consts:[[1,"row"],[1,"col-md-12"],["nbSpinnerSize","small",3,"nbSpinner"],[3,"ngSubmit"],["f","ngForm"],[1,"form-group","row"],["for","dc-scene",1,"label","col-sm-2","col-form-label"],[1,"col-sm-10"],["id","dc-scene","fullWidth","","name","SceneId","required","","nbTooltip","Select the tenant to select the VM (Golden Master)",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["SceneId","ngModel"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["saveSettings",""],[3,"value"],["for","dc-VmResourceId",1,"label","col-sm-2","col-form-label"],["id","dc-VmResourceId","fullWidth","","nbSpinnerSize","small","placeholder","Select your Golden Master","nbTooltip","Select your Golden Master","name","VmResourceId","required","","labelName","DisplayName","valueName","Id","pre","1",1,"form-control",3,"ngModel","nbSpinner","ngClass","options","ngModelChange"],["VmResourceId","ngModel"],[1,"col-sm-6"],["for","dc-ImageAutoNaming",1,"label","col-sm-4","col-form-label"],[1,"col-sm-8"],["id","dc-ImageAutoNaming","name","ImageAutoNaming","nbTooltip","Creates a name automatically: <VM-Name>_<DateTime>. E.g.: T-AVD-BASIC-01_2021-10-01_14-00-00",3,"ngModel","ngModelChange"],["for","dc-ImageName",1,"label","col-sm-4","col-form-label"],["type","text","id","dc-ImageName","nbInput","","fullWidth","","maxlength","60","placeholder","Image name","required","","minlength","4","nbTooltip","Enter a name for the image. Ensure that the name is not in use by another resource.","name","ImageName",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["ImageName","ngModel"],[1,"col-sm-12"],["for","dc-ImageNote",1,"label","col-sm-2","col-form-label"],["type","text","id","dc-ImageNote","nbInput","","fullWidth","","maxlength","250","placeholder","Windows 10 EUV 20H2 with O365 and main business apps","nbTooltip","Use up to 250 characters to make a not for this image.","name","ImageNote",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["ImageNote","ngModel"],["for","dc-ImageResourceGroupId",1,"label","col-sm-4","col-form-label"],["id","dc-ImageResourceGroupId","fullWidth","","nbTooltip","Select a resource group to store the image.","name","ImageResourceGroupId","required","","labelName","Name","valueName","Id",1,"form-control",3,"ngModel","ngClass","options","ngModelChange"],["ImageResourceGroupId","ngModel"],["for","dc-ImageKeepVersions",1,"label","col-sm-4","col-form-label"],["id","dc-ImageKeepVersions","fullWidth","","nbTooltip","You can optionally delete older images of the same VM in the subscription.","name","ImageKeepVersions",3,"ngModel","ngModelChange"],["for","dc-ScriptOrCollectionStart",1,"label","col-sm-4","col-form-label"],["id","dc-ScriptOrCollectionStart","nbTooltip","Runs a script or collection on the VM / Golden Master before the imaging process starts. This can be used to (e.g.) apply Windows Updates in front of building the final image. This process changes the Master permanently. Steps related to a session host are ignored - only VM native steps are applied.",3,"scene","idSc","onStatusChange"],["for","dc-TagAsTestImage",1,"label","col-sm-4","col-form-label"],["id","dc-TagAsTestImage","name","TagAsTestImage","nbTooltip","Tags an image optionally as a 'TestImage'. Test images are ignored if the rollout configuration is set to use the newest image from a gallery definition or from a VM. Regardless, these images can be selected directly in the rollout configuration (e.g., in a test host pool). To untag, remove the tag 'AVD.TestImage' from an image or gallery version in the Azure Portal.",3,"ngModel","ngModelChange"],["class","row",4,"ngIf"],[1,"offset-sm-8","col-sm-2"],["id","storeImage","nbButton","","style","float: right;","type","submit","nbTooltip","Save the imaging configuration to the database.",4,"ngIf"],["id","updateImage","nbButton","","style","float: right;","type","submit","nbTooltip","Update the imaging configuration in the database.",4,"ngIf"],[1,"col-sm-2"],["type","submit","nbButton","","status","primary","style","float: right;","nbTooltip","Use this configuration to create a new image from the selected VM (Golden Master). The VM remains untouched and can be reused at any time.",4,"ngIf"],[1,"col-sm-3"],["for","dc-ServiceDomainUser",1,"label","col-sm-4","col-form-label"],["type","text","id","dc-ServiceDomainUser","nbInput","","fullWidth","","placeholder","service@contoso.com","nbTooltip","Name of the service account, written as name@domain.com","name","ServiceDomainUser",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["ServiceDomainUser","ngModel"],["for","dc-ServiceDomainPwEncrypted",1,"label","col-sm-4","col-form-label"],["type","password","id","dc-ServiceDomainPwEncrypted","nbInput","","fullWidth","","placeholder","**********************","nbTooltip","Password of the service account","name","ServiceDomainPwEncrypted",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["ServiceDomainPwEncrypted","ngModel"],["for","dc-SharedImageGalleryDefinitionId",1,"label","col-sm-4","col-form-label"],["id","dc-SharedImageGalleryDefinitionId","fullWidth","","nbTooltip","Select a shared image gallery definition as a target for the image. The image is copied to the definition at the end of the process.","name","SharedImageGalleryDefinitionId",3,"ngModel","ngModelChange"],["class","form-group row",4,"ngIf"],["for","dc-SharedImageGalleryDefinitionRemoveImageAfterCopying",1,"label","col-sm-8","col-form-label"],[1,"col-sm-4"],["id","dc-SharedImageGalleryDefinitionRemoveImageAfterCopying","name","SharedImageGalleryDefinitionRemoveImageAfterCopying","nbTooltip","Optionally, delete the native image after copying it to the gallery definition.",3,"ngModel","ngModelChange"],["for","dc-SharedImageGalleryDateNaming",1,"label","col-sm-8","col-form-label"],["id","dc-SharedImageGalleryDateNaming","name","SharedImageGalleryDateNaming","nbTooltip","Usually, the version x.y.z is counted up automatically. Using this option, the version will be year.month.day (UTC). This simplifies the view of the image versions but will remove an existing version from the same day in the gallery definition and is not recognized as a new image for existing hosts.",3,"ngModel","ngModelChange"],["for","dc-SharedImageGalleryDefinitionShallowReplication",1,"label","col-sm-8","col-form-label"],["id","dc-SharedImageGalleryDefinitionShallowReplication","name","SharedImageGalleryDefinitionShallowReplication","nbTooltip","For testing and development, an image version can be configured as shallow replication. This makes the image ready faster, but you can't deploy many hosts in parallel while the image is not copied and the image is only available in the home region.",3,"ngModel","ngModelChange"],["for","dc-SharedImageKeepVersions",1,"label","col-sm-4","col-form-label"],["id","dc-SharedImageKeepVersions","fullWidth","","nbTooltip","You can optionally delete older image versions in the gallery definition.","name","SharedImageKeepVersions",3,"ngModel","ngModelChange"],["for","dc-SharedImageGalleryDefinitionIdRegions",1,"label","col-sm-4","col-form-label"],["id","dc-SharedImageGalleryDefinitionIdRegions","fullWidth","","multiple","","nbTooltip","Select the regions where you want to have your image available.","name","SharedImageGalleryDefinitionIdRegions",3,"selected","selectedChange"],["for","dc-HciLocationId",1,"label","col-sm-4","col-form-label"],["id","dc-HciLocationId","fullWidth","","nbTooltip","Select a custom location as a target for the image. The image is copied to the definition at the end of the process.","name","HciLocationId",3,"ngModel","ngModelChange"],["for","dc-HciLocationRemoveImageAfterCopying",1,"label","col-sm-4","col-form-label"],["id","dc-HciLocationRemoveImageAfterCopying","name","HciLocationRemoveImageAfterCopying","nbTooltip","Optionally, delete the native image after copying it to the custom location.",3,"ngModel","ngModelChange"],["for","dc-HciUseStorageAccount",1,"label","col-sm-4","col-form-label"],["id","dc-HciUseStorageAccount","name","HciUseStorageAccount","nbTooltip","Using a storage account is a more reliable way to transfer an image to Azure Local. If used, the Hydra service principal needs Microsoft.Storage/storageAccounts/write and Storage Blob Data Contributor on the selected resource group.",3,"ngModel","ngModelChange"],["for","dc-HciLocationImageKeepVersions",1,"label","col-sm-4","col-form-label"],["icon","alert-triangle-outline","nbTooltip","Caution: Never let Hydra delete an image that is being used by a virtual machine. VMs can no longer be started or stopped if the base image is deleted. Only deletion would work."],["id","dc-HciLocationImageKeepVersions","fullWidth","","nbTooltip","You can optionally delete older image versions in the Azure portal. Caution: Never let Hydra delete an image that is being used by a virtual machine. VMs can no longer be started or stopped if the base image is deleted. Only deletion would work.","name","HciLocationImageKeepVersions",3,"ngModel","ngModelChange"],["id","storeImage","nbButton","","type","submit","nbTooltip","Save the imaging configuration to the database.",2,"float","right"],["id","updateImage","nbButton","","type","submit","nbTooltip","Update the imaging configuration in the database.",2,"float","right"],["type","submit","nbButton","","status","primary","nbTooltip","Use this configuration to create a new image from the selected VM (Golden Master). The VM remains untouched and can be reused at any time.",2,"float","right"],["rows","1","nbInput","","fullWidth","","placeholder","Name or description","nbTooltip","Enter a name or description to store the imaging configuration in the database.",3,"ngModel","ngModelChange"],[1,"col-sm-6",2,"min-width","200px"],[1,"col-sm-3","text-right"],["nbButton","",1,"cancel",3,"click"],["nbButton","",3,"click"]],template:function(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",0),i["\u0275\u0275elementStart"](1,"div",1),i["\u0275\u0275elementStart"](2,"nb-card"),i["\u0275\u0275elementStart"](3,"nb-card-header",2),i["\u0275\u0275elementStart"](4,"h1"),i["\u0275\u0275text"](5,"Capture a VM / Golden Master"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](6,"nb-card-body"),i["\u0275\u0275elementStart"](7,"p"),i["\u0275\u0275text"](8,"Create a new image from the selected VM (Golden Master). The original VM remains untouched and can be reused at any time."),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](9,"br"),i["\u0275\u0275elementStart"](10,"form",3,4),i["\u0275\u0275listener"]("ngSubmit",function(n){i["\u0275\u0275restoreView"](e);const o=i["\u0275\u0275reference"](11);return t.onSubmit(o,n.submitter.id)}),i["\u0275\u0275elementStart"](12,"div",5),i["\u0275\u0275elementStart"](13,"label",6),i["\u0275\u0275text"](14,"Tenant"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](15,"div",7),i["\u0275\u0275elementStart"](16,"nb-select",8,9),i["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.SceneId=e})("ngModelChange",function(e){return t.onSceneChange(e)}),i["\u0275\u0275template"](18,v,2,2,"nb-option",10),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](19,k,79,38,"ng-container",11),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](20,"br"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](21,P,15,1,"ng-template",null,12,i["\u0275\u0275templateRefExtractor"])}if(2&e){const e=i["\u0275\u0275reference"](17);i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("nbSpinner",t.spinner1),i["\u0275\u0275advance"](13),i["\u0275\u0275property"]("ngModel",t.model.SceneId)("ngClass",i["\u0275\u0275pureFunction1"](5,y,t.submitted&&e.invalid)),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngForOf",t.ViewScenes),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",t.model.SceneId)}},directives:[h.Asz,h.ndF,h.Q7R,h.yKW,u._Y,u.JL,u.F,h.rs,u.Q7,h.jNv,u.JJ,u.On,o.mk,o.sg,o.O5,h.q51,f.S,h.NTf,h.h8i,u.Fj,u.nD,u.wO,S.I,h.qCO,h.SaG,h.YZd,h.AvE,h.fMN,h.DPz,h.XWE],styles:["nb-checkbox[_ngcontent-%COMP%]{margin-bottom:1rem}.form-inline[_ngcontent-%COMP%]   [fullWidth][_ngcontent-%COMP%]{flex:1}.form-inline[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0 1.5rem 1.5rem 0}nb-card.inline-form-card[_ngcontent-%COMP%]   nb-card-body[_ngcontent-%COMP%]{padding-bottom:0}.form-control[_ngcontent-%COMP%]{padding:0;border:0}"]}),e})();var L=n(46679);let N=(()=>{class e{constructor(e){var t,n,o;this.router=e,null!=(null===(t=this.router.getCurrentNavigation())||void 0===t?void 0:t.extras.state)?(console.log("Getting data from ImagingDefinitions"),this.configTemplate=JSON.parse(JSON.stringify(null===(o=null===(n=this.router.getCurrentNavigation())||void 0===n?void 0:n.extras.state)||void 0===o?void 0:o.data)),console.log(this.configTemplate)):this.configTemplate=null}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](a.F0))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-image-creation"]],decls:2,vars:2,consts:[[3,"storeDirect","configurationTemplate"],["header","Imaging Log","filterActions","VmCreateImage","filterLastDays","3","top","12"]],template:function(e,t){1&e&&(i["\u0275\u0275element"](0,"ngx-image-creation-config",0),i["\u0275\u0275element"](1,"ngx-actionsLog",1)),2&e&&i["\u0275\u0275property"]("storeDirect",!0)("configurationTemplate",t.configTemplate)},directives:[_,L.d],styles:[".nb-theme-default   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-default   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-default   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-default   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-dark   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-dark   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-dark   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-dark   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-cosmic   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-cosmic   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-cosmic   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-cosmic   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-corporate   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-corporate   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-corporate   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-corporate   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}"]}),e})();var G=n(46797),A=n(25917),z=n(39761),W=n(43190),$=n(67666),F=n(68307),U=n(11627),H=n(5304),B=n(56825),K=n(69517),j=n(46016);const q=["schedules"],J=["dialog"];function Q(e,t){1&e&&i["\u0275\u0275element"](0,"span",16)}function Y(e,t){1&e&&i["\u0275\u0275element"](0,"span",17)}function X(e,t){1&e&&i["\u0275\u0275element"](0,"span",16)}function Z(e,t){1&e&&i["\u0275\u0275element"](0,"span",17)}function ee(e,t){1&e&&i["\u0275\u0275element"](0,"span",16)}function te(e,t){1&e&&i["\u0275\u0275element"](0,"span",17)}function ne(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"nb-icon",23),i["\u0275\u0275listener"]("click",function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"]().$implicit;return i["\u0275\u0275nextContext"](2).configureSchedules(t.TemplateId)}),i["\u0275\u0275elementEnd"]()}}function oe(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"nb-icon",24),i["\u0275\u0275listener"]("click",function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"]().$implicit;return i["\u0275\u0275nextContext"](2).configureSchedules(t.TemplateId)}),i["\u0275\u0275elementEnd"]()}}function ae(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementContainerStart"](0),i["\u0275\u0275elementStart"](1,"tr"),i["\u0275\u0275elementStart"](2,"td"),i["\u0275\u0275text"](3),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"td"),i["\u0275\u0275text"](5),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](6,"td"),i["\u0275\u0275text"](7),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](8,"td"),i["\u0275\u0275text"](9),i["\u0275\u0275pipe"](10,"date"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](11,"td"),i["\u0275\u0275text"](12),i["\u0275\u0275pipe"](13,"date"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](14,"td"),i["\u0275\u0275elementStart"](15,"div",0),i["\u0275\u0275element"](16,"p"),i["\u0275\u0275elementStart"](17,"nb-icon",18),i["\u0275\u0275listener"]("click",function(){const t=i["\u0275\u0275restoreView"](e).$implicit;return i["\u0275\u0275nextContext"](2).config(t)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](18,ne,1,0,"nb-icon",19),i["\u0275\u0275template"](19,oe,1,0,"nb-icon",20),i["\u0275\u0275elementStart"](20,"nb-icon",21),i["\u0275\u0275listener"]("click",function(){const t=i["\u0275\u0275restoreView"](e).$implicit;return i["\u0275\u0275nextContext"](2).delete(t.TemplateId)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](21,"nb-icon",22),i["\u0275\u0275listener"]("click",function(){const t=i["\u0275\u0275restoreView"](e).$implicit;return i["\u0275\u0275nextContext"](2).start(t.TemplateId)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=t.$implicit;i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate1"](" ",e.SceneName," "),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate1"](" ",e.TemplateName," "),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate2"](" ",e.VmResourceId.split("/")[4],"\\",e.VmResourceId.split("/")[8]," "),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate1"](" ",i["\u0275\u0275pipeBind2"](10,8,e.LastRunTime,"short")," "),i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate1"](" ",i["\u0275\u0275pipeBind2"](13,11,e.NextRunTime,"short")," "),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngIf",!(null!=e.TemplateSchedule&&e.TemplateSchedule.Enabled)),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",null==e.TemplateSchedule?null:e.TemplateSchedule.Enabled)}}function ie(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"div",9),i["\u0275\u0275elementStart"](2,"table",10),i["\u0275\u0275elementStart"](3,"thead"),i["\u0275\u0275elementStart"](4,"tr"),i["\u0275\u0275elementStart"](5,"th",11),i["\u0275\u0275listener"]("click",function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"]();return t.sortType="SceneName",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),i["\u0275\u0275text"](6," Tenant "),i["\u0275\u0275template"](7,Q,1,0,"span",12),i["\u0275\u0275template"](8,Y,1,0,"span",13),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](9,"th",11),i["\u0275\u0275listener"]("click",function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"]();return t.sortType="TemplateName",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),i["\u0275\u0275text"](10," Description / Name "),i["\u0275\u0275template"](11,X,1,0,"span",12),i["\u0275\u0275template"](12,Z,1,0,"span",13),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](13,"th",11),i["\u0275\u0275listener"]("click",function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"]();return t.sortType="VmResourceId",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),i["\u0275\u0275text"](14," Resource Group / VM "),i["\u0275\u0275template"](15,ee,1,0,"span",12),i["\u0275\u0275template"](16,te,1,0,"span",13),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](17,"th"),i["\u0275\u0275text"](18,"Last Runtime (UTC)"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](19,"th"),i["\u0275\u0275text"](20,"Next Runtime (UTC)"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](21,"th"),i["\u0275\u0275text"](22,"Actions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](23,"tbody"),i["\u0275\u0275template"](24,ae,22,14,"ng-container",14),i["\u0275\u0275pipe"](25,"slice"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](26,"ngb-pagination",15),i["\u0275\u0275listener"]("pageChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().page=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](7),i["\u0275\u0275property"]("ngIf","SceneName"==e.sortType&&!e.sortReverse),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf","SceneName"==e.sortType&&e.sortReverse),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf","TemplateName"==e.sortType&&!e.sortReverse),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf","TemplateName"==e.sortType&&e.sortReverse),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf","VmResourceId"==e.sortType&&!e.sortReverse),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf","VmResourceId"==e.sortType&&e.sortReverse),i["\u0275\u0275advance"](8),i["\u0275\u0275property"]("ngForOf",i["\u0275\u0275pipeBind3"](25,13,e.imagingDefinitions,(e.page-1)*e.pageSize,e.page*e.pageSize))("ngForTrackBy",e.identifyViewImagingDefinitions),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("collectionSize",e.collectionSize)("page",e.page)("maxSize",5)("boundaryLinks",!0)("pageSize",e.pageSize)}}function le(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"nb-card"),i["\u0275\u0275elementStart"](1,"nb-card-header"),i["\u0275\u0275text"](2,"Confirmation"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"nb-card-body"),i["\u0275\u0275text"](4),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](5,"nb-card-footer"),i["\u0275\u0275elementStart"](6,"div",0),i["\u0275\u0275element"](7,"div",25),i["\u0275\u0275elementStart"](8,"div",26),i["\u0275\u0275elementStart"](9,"button",27),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e).dialogRef.close("0")}),i["\u0275\u0275text"](10,"Cancel"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](11,"div",26),i["\u0275\u0275elementStart"](12,"button",28),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e).dialogRef.close("1")}),i["\u0275\u0275text"](13,"Ok"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate"](e)}}function re(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"nb-option",42),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275property"]("value",e.id),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"]("",e.name," ")}}const se=function(e){return{"is-invalid":e}};function de(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"nb-card"),i["\u0275\u0275elementStart"](1,"nb-card-header"),i["\u0275\u0275text"](2,"Imaging schedules"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"nb-card-body"),i["\u0275\u0275elementStart"](4,"p"),i["\u0275\u0275text"](5," You can configure a time to start the imaging process. Please note that the configured time is in UTC time. "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](6,"div",29),i["\u0275\u0275elementStart"](7,"div",9),i["\u0275\u0275elementStart"](8,"table",10),i["\u0275\u0275elementStart"](9,"thead"),i["\u0275\u0275elementStart"](10,"tr"),i["\u0275\u0275elementStart"](11,"th"),i["\u0275\u0275text"](12,"Enabled"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](13,"th"),i["\u0275\u0275text"](14,"Weekdays"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](15,"th"),i["\u0275\u0275text"](16,"Start (UTC time)"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](17,"th"),i["\u0275\u0275text"](18,"Advanced"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](19,"tbody"),i["\u0275\u0275elementContainerStart"](20,30),i["\u0275\u0275elementStart"](21,"tr"),i["\u0275\u0275elementStart"](22,"td"),i["\u0275\u0275elementStart"](23,"nb-checkbox",31),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().modelSchedules.Enabled=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](24,"td"),i["\u0275\u0275elementStart"](25,"nb-checkbox",32),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().modelSchedules.Weekdays.Mo=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](26,"nb-checkbox",33),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().modelSchedules.Weekdays.Tu=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](27,"nb-checkbox",34),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().modelSchedules.Weekdays.We=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](28,"nb-checkbox",35),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().modelSchedules.Weekdays.Th=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](29,"nb-checkbox",36),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().modelSchedules.Weekdays.Fr=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](30,"nb-checkbox",37),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().modelSchedules.Weekdays.Sa=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](31,"nb-checkbox",38),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().modelSchedules.Weekdays.Su=t}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](32,"td"),i["\u0275\u0275elementStart"](33,"nb-select",39),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().modelSchedules.TimeFrom=t}),i["\u0275\u0275template"](34,re,2,2,"nb-option",40),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](35,"td"),i["\u0275\u0275elementStart"](36,"ngx-scheduleSelector",41),i["\u0275\u0275listener"]("onStatusChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().setScheduleAdv(t)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementContainerEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](37,"nb-card-footer"),i["\u0275\u0275elementStart"](38,"div",0),i["\u0275\u0275element"](39,"div",25),i["\u0275\u0275elementStart"](40,"div",26),i["\u0275\u0275elementStart"](41,"button",27),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e).dialogRef.close("0")}),i["\u0275\u0275text"](42,"Cancel"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](43,"div",26),i["\u0275\u0275elementStart"](44,"button",28),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e).dialogRef.close("1")}),i["\u0275\u0275text"](45,"Ok"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](23),i["\u0275\u0275property"]("ngModel",e.modelSchedules.Enabled),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngModel",e.modelSchedules.Weekdays.Mo),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",e.modelSchedules.Weekdays.Tu),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",e.modelSchedules.Weekdays.We),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",e.modelSchedules.Weekdays.Th),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",e.modelSchedules.Weekdays.Fr),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",e.modelSchedules.Weekdays.Sa),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",e.modelSchedules.Weekdays.Su),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngModel",e.modelSchedules.TimeFrom)("ngClass",i["\u0275\u0275pureFunction1"](15,se,e.submitted&&"INVALID"==(null==e.f.form.controls.TimeFrom?null:e.f.form.controls.TimeFrom.status))),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",e.timeMinuteSelectorEnum),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("dateStart",e.modelSchedules.DateStart)("dateEnd",e.modelSchedules.DateEnd)("repeatWeek",e.modelSchedules.RepeatWeek)("repeatMonth",e.modelSchedules.RepeatMonth)}}const me=[{path:"",component:l,children:[{path:"create-image",component:N},{path:"imaging-definitions",component:(()=>{class e{constructor(e,t,n,o,a){this.actionService=e,this.http=t,this.toastrService=n,this.dialogService=o,this.router=a,this.interval=2*d.tc.autoRefreshDefault,this.page=1,this.pageSize=20,this.imagingDefinitions$=new r.xQ,this.imagingDefinitions=[],this.allimagingDefinitions=[],this.httpWebRoot=(new d.tc).apiURL(),this.sortType="SceneName",this.sortReverse=!0,this.searchPhrase="",this.styleBtSemiRound="semi-round",this.modelSchedules=new m.m$,this.timeMinuteSelectorEnum=B.ub}ngOnInit(){this.imagingDefinitionsSubscription$=this.imagingDefinitions$.pipe((0,z.O)(0),(0,W.w)(()=>(0,G.H)(1,this.interval)),(0,W.w)(()=>this.http.get(`${(new d.tc).apiURL()}/data/azure/imagingDefinitions`)),(0,$.a)(e=>e.pipe((0,F.b)(e=>this.showToast("danger","Failure accessing the ImagingDefinition-API",`Cannot read data from API. The message is: ${e.message} with status ${e.statusText}`)),(0,U.j)(()=>(0,G.H)(5e3)))),(0,H.K)(e=>(this.showToast("danger","Failure accessing the ImagingDefinition-API",`Cannot read data from API. Reload this site to try it again. The message is: ${e.message} with status ${e.statusText}`),(0,A.of)([])))).subscribe(e=>{console.log("imagingDefinitions: Getting data ",e.length),this.collectionSize=e.length,this.allimagingDefinitions=e,this.searchTable(),this.sort(this.sortReverse,this.sortType)})}identifyViewImagingDefinitions(e,t){return t.Id}update(){this.imagingDefinitions$.next()}configureSchedules(e){const t=this.allimagingDefinitions.find(t=>t.TemplateId==e);t&&(null==t.TemplateSchedule&&(t.TemplateSchedule=new m.m$),this.modelSchedules=t.TemplateSchedule,this.dialogService.open(this.schedules).onClose.subscribe(n=>{"1"==n&&(t.TemplateSchedule=this.modelSchedules,this.triggerImagingConfiguration(e,"storageimagedefinition","Setting schedule",!1,t),this.allimagingDefinitions.find(t=>t.TemplateId==e).TemplateSchedule=this.modelSchedules)}))}setScheduleAdv(e){this.modelSchedules.DateStart=e.DateStart,this.modelSchedules.DateEnd=e.DateEnd,this.modelSchedules.RepeatWeek=e.RepeatWeek,this.modelSchedules.RepeatMonth=e.RepeatMonth}delete(e){var t=this.allimagingDefinitions.find(t=>t.TemplateId==e);this.triggerImagingConfiguration(e,"deletestorageimagedefinition","Delete imaging definition",!0,t)}start(e){var t=this.allimagingDefinitions.find(t=>t.TemplateId==e);this.triggerImagingConfiguration(e,"runstorageimagedefinition","Start imaging",!0,t)}config(e){this.navigateTo("/pages/image-builder/create-image","",e)}triggerImagingConfiguration(e,t,n,o=!1,a=null){o?this.dialogService.open(this.dialog,{context:`Please confirm the operation '${n}'`}).onClose.subscribe(o=>{"1"==o&&this.triggerImagingConfigurationExecute(e,t,n,a)}):this.triggerImagingConfigurationExecute(e,t,n,a)}triggerImagingConfigurationExecute(e,t,n,o=null){var a=this.allimagingDefinitions.find(t=>t.TemplateId==e);console.log("Start action: "+t+" with item id: "+(null==a?void 0:a.TemplateId)),this.actionService.sendActionAsync(`scenes/${null==a?void 0:a.SceneId}/${t}`,o,n,null==a?void 0:a.VmResourceId.split("/").pop()).subscribe(e=>{})}navigateTo(e,t,n={}){this.router.navigate([e],{queryParams:{search:t},state:{data:n}})}searchTable(){this.imagingDefinitions=this.allimagingDefinitions.filter(e=>""==this.searchPhrase||e.TemplateName.toLowerCase().includes(this.searchPhrase.toLowerCase())||e.VmResourceId.toLowerCase().indexOf(this.searchPhrase.toLowerCase())>-1||e.SceneName.toLowerCase().indexOf(this.searchPhrase.toLowerCase())>-1),this.sort(this.sortReverse,this.sortType),this.collectionSize=this.imagingDefinitions.length}sort(e,t){var n=(t+".....").split(".");this.sortInternal(e,n[0],n[1],n[2],n[3])}sortInternal(e,t,n="",o="",a=""){this.imagingDefinitions=this.imagingDefinitions.sort((i,l)=>{try{if(""!=a)var r=i[t][n][o][a],s=l[t][n][o][a];else""!=o?(r=i[t][n][o],s=l[t][n][o]):""!=n?(r=i[t][n],s=l[t][n]):(r=i[t],s=l[t])}catch{r=1,s=1}return e?r>s?1:s>r?-1:0:r>s?-1:1})}ngOnDestroy(){this.imagingDefinitionsSubscription$&&this.imagingDefinitionsSubscription$.unsubscribe()}showToast(e,t,n){this.toastrService.show(n,t?`${t}`:"",{status:e,destroyByClick:!0,duration:2e4,hasIcon:!0,position:h.fe3.TOP_RIGHT,preventDuplicates:!0})}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](c.c),i["\u0275\u0275directiveInject"](p.eN),i["\u0275\u0275directiveInject"](h.quB),i["\u0275\u0275directiveInject"](h.Gln),i["\u0275\u0275directiveInject"](a.F0))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-imaging-definitions-config"]],viewQuery:function(e,t){if(1&e&&(i["\u0275\u0275viewQuery"](q,5),i["\u0275\u0275viewQuery"](J,5)),2&e){let e;i["\u0275\u0275queryRefresh"](e=i["\u0275\u0275loadQuery"]())&&(t.schedules=e.first),i["\u0275\u0275queryRefresh"](e=i["\u0275\u0275loadQuery"]())&&(t.dialog=e.first)}},decls:19,vars:3,consts:[[1,"row"],[1,"col-sm-6"],["type","text","nbInput","","fullWidth","","placeholder","Search for a specific tenant, description, VM",3,"ngModel","ngModelChange"],[4,"ngIf"],["type","button","nbButton","",3,"status","click"],["icon","refresh"],["header","Imaging Log","filterActions","VmCreateImage","filterLastDays","3","top","12"],["dialog",""],["schedules",""],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],[3,"click"],["class","fa fa-caret-down",4,"ngIf"],["class","fa fa-caret-up",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","justify-content-center",3,"collectionSize","page","maxSize","boundaryLinks","pageSize","pageChange"],[1,"fa","fa-caret-down"],[1,"fa","fa-caret-up"],["icon","settings-outline","nbTooltip","Configure","nbTooltip","Reconfigure the imaging configuration",3,"click"],["icon","clock-outline","nbTooltip","Configure schedule","nbTooltipPlacement","top",3,"click",4,"ngIf"],["icon","clock","nbTooltip","Configure schedule","nbTooltipPlacement","top",3,"click",4,"ngIf"],["icon","trash-2-outline","nbTooltip","Delete","nbTooltip","Delete the imaging configuration",3,"click"],["icon","play-circle-outline","nbTooltip","Start","nbTooltip","Start imaging",3,"click"],["icon","clock-outline","nbTooltip","Configure schedule","nbTooltipPlacement","top",3,"click"],["icon","clock","nbTooltip","Configure schedule","nbTooltipPlacement","top",3,"click"],[1,"col-sm-6",2,"min-width","200px"],[1,"col-sm-3","text-right"],["nbButton","",1,"cancel",3,"click"],["nbButton","",3,"click"],["formArrayName","Schedule"],[1,"form-group","row"],["name","Schedule_Enable_111",3,"ngModel","ngModelChange"],["name","Schedule_Weekday_Mo_111","nbTooltip","Monday",3,"ngModel","ngModelChange"],["name","Schedule_Weekday_Tu_111","nbTooltip","Tuesday",3,"ngModel","ngModelChange"],["name","Schedule_Weekday_We_111","nbTooltip","Wednesday",3,"ngModel","ngModelChange"],["name","Schedule_Weekday_Th_111","nbTooltip","Thursday",3,"ngModel","ngModelChange"],["name","Schedule_Weekday_Fr_111","nbTooltip","Friday",3,"ngModel","ngModelChange"],["name","Schedule_Weekday_Sa_111","nbTooltip","Saturday",3,"ngModel","ngModelChange"],["name","Schedule_Weekday_Su_111","nbTooltip","Sunday",3,"ngModel","ngModelChange"],["id","dc-TimeFrom_111","fullWidth","","nbTooltip","Start time (UTC time)","name","TimeFrom_111",3,"ngModel","ngClass","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"dateStart","dateEnd","repeatWeek","repeatMonth","onStatusChange"],[3,"value"]],template:function(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"nb-card"),i["\u0275\u0275elementStart"](2,"nb-card-header"),i["\u0275\u0275elementStart"](3,"h1"),i["\u0275\u0275text"](4,"Imaging Definitions"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](5,"nb-card-body"),i["\u0275\u0275elementStart"](6,"div",0),i["\u0275\u0275elementStart"](7,"div",1),i["\u0275\u0275elementStart"](8,"input",2),i["\u0275\u0275listener"]("ngModelChange",function(e){return t.searchPhrase=e})("ngModelChange",function(){return t.searchTable()}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](9,"div",1),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](10,ie,27,17,"div",3),i["\u0275\u0275elementStart"](11,"button",4),i["\u0275\u0275listener"]("click",function(){return t.update()}),i["\u0275\u0275element"](12,"nb-icon",5),i["\u0275\u0275text"](13," Update "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](14,"ngx-actionsLog",6),i["\u0275\u0275template"](15,le,14,1,"ng-template",null,7,i["\u0275\u0275templateRefExtractor"]),i["\u0275\u0275template"](17,de,46,17,"ng-template",null,8,i["\u0275\u0275templateRefExtractor"])),2&e&&(i["\u0275\u0275advance"](8),i["\u0275\u0275property"]("ngModel",t.searchPhrase),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",t.imagingDefinitions),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("status",t.styleBtSemiRound))},directives:[h.Asz,h.ndF,h.yKW,h.h8i,u.Fj,u.JJ,u.On,o.O5,h.DPz,h.fMN,L.d,o.sg,K.N9,h.jNv,h.XWE,u.JL,h.NTf,h.rs,o.mk,j.S,h.q51],pipes:[o.OU,o.uU],styles:[".nb-theme-default   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-default   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-default   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-default   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-dark   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-dark   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-dark   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-dark   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-cosmic   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-cosmic   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-cosmic   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-cosmic   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-corporate   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-corporate   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-corporate   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-corporate   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}"]}),e})()},{path:"**",redirectTo:"create-image",pathMatch:"full"}]}];let ce=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=i["\u0275\u0275defineInjector"]({imports:[[a.Bz.forChild(me)],a.Bz]}),e})();var ge=n(99506),pe=n(34978);let he=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=i["\u0275\u0275defineInjector"]({imports:[[o.ez,ce,h.zyh,h.uuI,u.u5,h.IIj,h.rgH,ge.PagesModule,h.MfT,h.nKr,h.oGl,h.KdK,K.jF,h.T2N,pe.D]]}),e})()}}]);