(self.webpackChunkngx_admin=self.webpackChunkngx_admin||[]).push([[682],{50682:function(e,t,n){"use strict";n.r(t),n.d(t,{RbacManagementModule:function(){return N}});var r=n(38583),o=n(3679),i=n(9857),s=n(47349),a=n(92340),c=n(37716),l=n(91841);let d=(()=>{class e{constructor(e){this.http=e}getRbacAccessViews(){return this.http.get(`${a.N.apiUrl}/data/rbacs`).pipe((0,s.d)({refCount:!0}))}getScopes(){return this.http.get(`${a.N.apiUrl}/data/rbacs/scopes`).pipe((0,s.d)({refCount:!0}))}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275inject"](l.eN))},e.\u0275prov=c["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var m=n(99763),p=n(79765),u=n(46782),b=n(16112),f=n(27861);function h(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"p"),c["\u0275\u0275elementStart"](1,"b"),c["\u0275\u0275text"](2),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](3,"br"),c["\u0275\u0275text"](4),c["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate"](e.name),c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate1"](" ",e.description," ")}}function g(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"nb-option",17),c["\u0275\u0275text"](1),c["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;c["\u0275\u0275property"]("value",e.SceneHpIdf),c["\u0275\u0275advance"](1),c["\u0275\u0275textInterpolate1"](" ",e.Scope," ")}}function S(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"nb-option",17),c["\u0275\u0275text"](1),c["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;c["\u0275\u0275property"]("value",e.id),c["\u0275\u0275advance"](1),c["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function w(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"tr"),c["\u0275\u0275elementStart"](1,"td"),c["\u0275\u0275element"](2,"input",10),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](3,"td"),c["\u0275\u0275elementStart"](4,"nb-select",11),c["\u0275\u0275template"](5,g,2,2,"nb-option",12),c["\u0275\u0275pipe"](6,"async"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](7,"td"),c["\u0275\u0275elementStart"](8,"nb-select",13),c["\u0275\u0275template"](9,S,2,2,"nb-option",12),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](10,"td"),c["\u0275\u0275element"](11,"input",14),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](12,"td"),c["\u0275\u0275elementStart"](13,"button",15),c["\u0275\u0275listener"]("click",function(){const t=c["\u0275\u0275restoreView"](e).index;return c["\u0275\u0275nextContext"]().remove(t)}),c["\u0275\u0275element"](14,"nb-icon",16),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){const e=t.index,n=c["\u0275\u0275nextContext"]();c["\u0275\u0275advance"](2),c["\u0275\u0275classProp"]("is-invalid","INVALID"===n.formRbacViews.controls[e].get("UpnOrGroupName").status&&n.isFormSubmitted),c["\u0275\u0275propertyInterpolate1"]("id","dc-UpnOrGroupName",e,""),c["\u0275\u0275property"]("formControl",n.formRbacViews.controls[e].get("UpnOrGroupName")),c["\u0275\u0275advance"](2),c["\u0275\u0275classProp"]("is-invalid","INVALID"===n.formRbacViews.controls[e].get("SceneHpIdf").status&&n.isFormSubmitted),c["\u0275\u0275property"]("formControl",n.formRbacViews.controls[e].get("SceneHpIdf")),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngForOf",c["\u0275\u0275pipeBind1"](6,14,n.scopes$)),c["\u0275\u0275advance"](3),c["\u0275\u0275classProp"]("is-invalid","INVALID"===n.formRbacViews.controls[e].get("Role").status&&n.isFormSubmitted),c["\u0275\u0275property"]("formControl",n.formRbacViews.controls[e].get("Role")),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngForOf",n.rolesViewList),c["\u0275\u0275advance"](2),c["\u0275\u0275propertyInterpolate1"]("id","dc-Note",e,""),c["\u0275\u0275property"]("formControl",n.formRbacViews.controls[e].get("Note"))}}const v=[{path:"",component:(()=>{class e{constructor(e,t,n){this.rbacManagementService=e,this.nbToastrService=t,this.actionService=n,this.destroyed$=new p.xQ,this.form=new o.cw({rbacViews:new o.Oe([])}),this.rolesViewList=b.ed,this.scopes$=this.rbacManagementService.getScopes(),this.isFormSubmitted=!1}get formRbacViews(){return this.form.get("rbacViews")}ngOnInit(){this.rbacManagementService.getRbacAccessViews().pipe((0,u.R)(this.destroyed$)).subscribe(e=>e.forEach(e=>this.formRbacViews.push(this.createDisplayAccessViewGroup(e))))}add(){this.formRbacViews.push(this.createAccessViewGroup(new b.DA))}remove(e){this.formRbacViews.removeAt(e)}submit(){this.isFormSubmitted=!0,this.form.invalid?this.nbToastrService.danger("Please check your configuration. Some properties or selections are not valid or missing. Check the red-cross-marked properties.","Form validation error"):this.actionService.sendAction("scenes/00000000-0000-0000-0000-000000000000/SceneStoreRoleBasedAccesses",this.formRbacViews.getRawValue(),"Storing role-based access roles","").subscribe()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}createDisplayAccessViewGroup(e){return new o.cw({Id:new o.NI(e.Id),UpnOrGroupName:new o.NI(e.UpnOrGroupName),GroupId:new o.NI(e.GroupId),SceneId:new o.NI(e.SceneId),HostPoolId:new o.NI(e.HostPoolId),Role:new o.NI(e.Role),SceneHpIdf:new o.NI(e.SceneHpIdf),Note:new o.NI(e.Note)})}createAccessViewGroup(e){return new o.cw({UpnOrGroupName:new o.NI(e.UpnOrGroupName),Role:new o.NI(e.Role),SceneHpIdf:new o.NI(e.SceneHpIdf),Note:new o.NI(e.Note)})}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](d),c["\u0275\u0275directiveInject"](i.quB),c["\u0275\u0275directiveInject"](f.c))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-rbac-management"]],decls:38,vars:3,consts:[[1,"row"],[1,"col-md-12"],[4,"ngFor","ngForOf"],[3,"formGroup","ngSubmit"],[1,"table-responsive"],["formArrayName","rbacViews",1,"table","table-bordered","table-striped"],["type","button","nbButton","",3,"click"],["icon","plus-square"],[1,"d-flex","justify-content-end"],["type","submit","nbButton","","status","primary"],["type","text","nbInput","","fullWidth","","placeholder","user@contoso.com (or a group object id)","maxlength","256","required","","minlength","1","nbTooltip","Enter the UPN for the user (user@contoso.com) or a group object id (e.g. 5669456b-5b86-4d7c-9c4b-d287bf7c19bb)",1,"form-control",3,"id","formControl"],["fullWidth","","nbTooltip","Scope",1,"form-control",3,"formControl"],[3,"value",4,"ngFor","ngForOf"],["fullWidth","","nbTooltip","Role",1,"form-control",3,"formControl"],["type","text","nbInput","","fullWidth","","placeholder","Add a note","maxlength","256","minlength","1","nbTooltip","Note",1,"form-control",3,"id","formControl"],["type","button","nbButton","","nbTooltip","Remove",3,"click"],["icon","close-square"],[3,"value"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div",0),c["\u0275\u0275elementStart"](1,"div",1),c["\u0275\u0275elementStart"](2,"nb-card"),c["\u0275\u0275elementStart"](3,"nb-card-header"),c["\u0275\u0275elementStart"](4,"h1"),c["\u0275\u0275text"](5,"Role Based Access"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](6,"nb-card-body"),c["\u0275\u0275elementStart"](7,"p"),c["\u0275\u0275text"](8,"Use role-based access to give users or groups permission to this platform. Name the user by their Azure login name (UPN=user principal name, e.g., user@contoso.com), assign the scope and a role. A scope can be a single tenant or a specific host pool in a tenant. Alternatively: Instead of entering a single UPN, the object id of an Entra ID / Azure AD group can be entered to assign a role to this group. A object id typical looks like this: 5669456b-5b86-4d7c-9c4b-d287bf7c19bb. "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](9,"h6"),c["\u0275\u0275text"](10,"Available roles:"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](11,h,5,2,"p",2),c["\u0275\u0275elementStart"](12,"form",3),c["\u0275\u0275listener"]("ngSubmit",function(){return t.submit()}),c["\u0275\u0275elementStart"](13,"div",4),c["\u0275\u0275elementStart"](14,"table",5),c["\u0275\u0275elementStart"](15,"thead"),c["\u0275\u0275elementStart"](16,"tr"),c["\u0275\u0275elementStart"](17,"th"),c["\u0275\u0275text"](18,"Upn or group object id"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](19,"th"),c["\u0275\u0275text"](20,"Scope"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](21,"th"),c["\u0275\u0275text"](22,"Role"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](23,"th"),c["\u0275\u0275text"](24,"Note"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](25,"th"),c["\u0275\u0275text"](26,"Remove"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](27,"tbody"),c["\u0275\u0275template"](28,w,15,16,"tr",2),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](29,"br"),c["\u0275\u0275elementStart"](30,"button",6),c["\u0275\u0275listener"]("click",function(){return t.add()}),c["\u0275\u0275element"](31,"nb-icon",7),c["\u0275\u0275text"](32," Add "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](33,"hr"),c["\u0275\u0275element"](34,"br"),c["\u0275\u0275elementStart"](35,"div",8),c["\u0275\u0275elementStart"](36,"button",9),c["\u0275\u0275text"](37,"Save"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](11),c["\u0275\u0275property"]("ngForOf",t.rolesViewList),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("formGroup",t.form),c["\u0275\u0275advance"](16),c["\u0275\u0275property"]("ngForOf",t.formRbacViews.controls))},directives:[i.Asz,i.ndF,i.yKW,r.sg,o._Y,o.JL,o.sg,o.CE,i.DPz,i.fMN,i.h8i,o.Fj,o.nD,o.Q7,o.wO,i.jNv,o.JJ,o.oH,i.rs,i.q51],pipes:[r.Ov],styles:["[_nghost-%COMP%]   nb-select[_ngcontent-%COMP%]{padding:0;border:0}"]}),e})()}];let I=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({imports:[[m.Bz.forChild(v)],m.Bz]}),e})(),N=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({providers:[d],imports:[[r.ez,I,i.zyh,o.u5,i.nKr,i.rgH,i.IIj,i.T2N,i.KdK,o.UX]]}),e})()}}]);