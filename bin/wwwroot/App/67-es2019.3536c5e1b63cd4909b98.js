(self.webpackChunkngx_admin=self.webpackChunkngx_admin||[]).push([[67],{28984:function(e,t,n){"use strict";n.d(t,{D:function(){return i}});var r=n(85345);function i(e){return t=>t.lift(new o(e))}class o{constructor(e){this.durationSelector=e}call(e,t){return t.subscribe(new c(e,this.durationSelector))}}class c extends r.Ds{constructor(e,t){super(e),this.durationSelector=t,this.hasValue=!1}_next(e){try{const t=this.durationSelector.call(this,e);t&&this._tryNext(e,t)}catch(t){this.destination.error(t)}}_complete(){this.emitValue(),this.destination.complete()}_tryNext(e,t){let n=this.durationSubscription;this.value=e,this.hasValue=!0,n&&(n.unsubscribe(),this.remove(n)),n=(0,r.ft)(t,new r.IY(this)),n&&!n.closed&&this.add(this.durationSubscription=n)}notifyNext(){this.emitValue()}notifyComplete(){this.emitValue()}emitValue(){if(this.hasValue){const e=this.value,t=this.durationSubscription;t&&(this.durationSubscription=void 0,t.unsubscribe(),this.remove(t)),this.value=void 0,this.hasValue=!1,super._next(e)}}}},36123:function(e,t,n){"use strict";function r(e,t,n={}){const r=i(t,e,n),o=i(e,t,n);return{aToB:r,bToA:o,hasDifference:Object.keys(r).length>0||Object.keys(o).length>0}}function i(e,t,n){const{comparators:r}=n,c=new Set(Object.keys(r||{}));return null===e||null===t?e===t?{}:e:Array.isArray(e)&&Array.isArray(t)?o(e,t)?{}:e:Object.keys(e).reduce((o,s)=>{if(!(s in t))return o[s]=e[s],o;if(c.has(s)){const n=null==r?void 0:r[s];return n&&!n(e[s],t[s])&&(o[s]=e[s]),o}if("object"==typeof e[s]&&"object"==typeof t[s]){const r=i(e[s],t[s],n);return(null===r||Object.keys(r).length||Array.isArray(r))&&(o[s]=r),o}return e[s]!==t[s]&&(o[s]=e[s]),o},{})}function o(e,t){return e.length===t.length&&e.every((e,n)=>Array.isArray(e)&&Array.isArray(t[n])?o(e,t[n]):null===e||null===t[n]?e===t[n]:"object"==typeof e&&"object"==typeof t[n]?0===Object.keys(r(e,t[n]).aToB).length:e===t[n])}n.d(t,{xF:function(){return r}})},5992:function(e,t,n){"use strict";n.d(t,{W:function(){return r}});var r=(()=>(function(e){e[e.Users=1]="Users",e[e.Groups=2]="Groups",e[e.UsersAndGroups=3]="UsersAndGroups"}(r||(r={})),r))()},17003:function(e,t,n){"use strict";n.d(t,{X:function(){return s}});var r=n(47349),i=n(92340),o=n(37716),c=n(91841);let s=(()=>{class e{constructor(e){this.httpClient=e,this.apiUrl=`${i.N.apiUrl}/data/scenes`}getDirectoryObjectBy(e,t){return this.httpClient.post(`${this.apiUrl}/${e}/directoryobjects`,{...t}).pipe((0,r.d)({refCount:!0,bufferSize:1}))}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](c.eN))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},20521:function(e,t,n){"use strict";n.d(t,{B:function(){return I}});var r=n(37716),i=n(3679),o=n(26215),c=n(46797),s=n(25917),l=n(28984),a=n(43190),d=n(87519),h=n(68307),u=n(68939),p=n(76897),f=n(17003),y=n(5992),b=n(38583),m=n(14625);function g(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"label",8),r["\u0275\u0275text"](1),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"](2);r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function C(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"nb-checkbox",16),r["\u0275\u0275text"](1),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275property"]("checked",e.checked),r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",e.DisplayName," ")}}function x(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"span",17),r["\u0275\u0275listener"]("click",function(){r["\u0275\u0275restoreView"](e);const t=r["\u0275\u0275nextContext"]().$implicit;return r["\u0275\u0275nextContext"](4).singleSelectionChange(t)}),r["\u0275\u0275text"](1),r["\u0275\u0275elementEnd"]()}if(2&e){const e=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",e.DisplayName," ")}}function v(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"nb-option",13),r["\u0275\u0275listener"]("click",function(){const t=r["\u0275\u0275restoreView"](e).$implicit;return r["\u0275\u0275nextContext"](4).multiSelectionChange(t)}),r["\u0275\u0275template"](1,C,2,2,"nb-checkbox",14),r["\u0275\u0275template"](2,x,2,1,"span",15),r["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=r["\u0275\u0275nextContext"](4);r["\u0275\u0275property"]("value",e),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",n.multi),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",!n.multi)}}function O(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"div",18),r["\u0275\u0275elementStart"](1,"button",19),r["\u0275\u0275listener"]("click",function(){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"](4).assign()}),r["\u0275\u0275text"](2),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()}if(2&e){const e=r["\u0275\u0275nextContext"](4);let t;r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("disabled",!e.selectedDirectoryObjects.length),r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",null!==(t=e.multiSelectButtonLabel)&&void 0!==t?t:"Add"," ")}}function j(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div",10),r["\u0275\u0275elementStart"](1,"nb-option-list"),r["\u0275\u0275template"](2,v,3,3,"nb-option",11),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](3,O,3,2,"div",12),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]().ngIf;r["\u0275\u0275nextContext"]();const t=r["\u0275\u0275reference"](3),n=r["\u0275\u0275nextContext"]();r["\u0275\u0275styleProp"]("width",t.elementRef.nativeElement.offsetWidth+"px"),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngForOf",e),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",n.multi)}}function S(e,t){if(1&e&&(r["\u0275\u0275elementContainerStart"](0),r["\u0275\u0275template"](1,j,4,4,"div",9),r["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngIf;r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",e.length)}}function w(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"div",2),r["\u0275\u0275template"](1,g,2,1,"label",3),r["\u0275\u0275elementStart"](2,"nb-form-field",4,5),r["\u0275\u0275pipe"](4,"async"),r["\u0275\u0275elementStart"](5,"input",6),r["\u0275\u0275listener"]("focus",function(){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"]().setDefaultSearchDebounceTime()}),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](6,S,2,1,"ng-container",7),r["\u0275\u0275pipe"](7,"async"),r["\u0275\u0275elementEnd"]()}if(2&e){const e=r["\u0275\u0275nextContext"]();let t;r["\u0275\u0275classProp"]("has-opened-dropdown",e.filteredDirectoryObjectsAmount>0),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",e.label),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("nbSpinner",r["\u0275\u0275pipeBind1"](4,7,e.isSearching$)),r["\u0275\u0275advance"](3),r["\u0275\u0275property"]("placeholder",null!==(t=e.placeholder)&&void 0!==t?t:"Search")("formControl",e.searchFormControl),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",r["\u0275\u0275pipeBind1"](7,9,e.filteredDirectoryObjects$))}}function k(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"div",20),r["\u0275\u0275listener"]("click",function(){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"]().close()}),r["\u0275\u0275elementEnd"]()}}let I=(()=>{class e{constructor(e){this.directoryObjectTypeheadService=e,this.searchDebounce$=new o.X(p.XU),this.multi=!1,this.type=y.W.UsersAndGroups,this.selectionChanged=new r.EventEmitter,this.isSearching$=new o.X(!1),this.filteredDirectoryObjectsAmount=0,this.searchFormControl=new i.NI(""),this.selectedDirectoryObjects=[]}set tenantViewSceneId(e){if(!e)throw new Error("Tenant View Scene Id must be provided");this.tenantId=e}ngOnInit(){this.initSearchQueryHandler()}setDefaultSearchDebounceTime(){this.searchDebounce$.next(p.XU)}assign(){this.selectionChanged.emit(this.selectedDirectoryObjects.map(e=>{const{checked:t,...n}=e;return n})),this.close()}close(){this.selectedDirectoryObjects=[],this.filteredDirectoryObjectsAmount=0,this.searchFormControl.setValue(""),this.searchDebounce$.next(0)}multiSelectionChange(e){e.checked=!e.checked,this.selectedDirectoryObjects=e.checked?[...this.selectedDirectoryObjects,{...e,checked:!0}]:this.selectedDirectoryObjects.filter(t=>t.Id!==e.Id)}singleSelectionChange(e){this.selectionChanged.emit(e),this.close()}initSearchQueryHandler(){this.filteredDirectoryObjects$=this.searchFormControl.valueChanges.pipe((0,l.D)(()=>this.searchDebounce$.pipe((0,a.w)(e=>(0,c.H)(e)))),(0,d.x)(),(0,h.b)(()=>this.isSearching$.next(!0)),(0,a.w)(e=>!e||e.length<p.cc||"string"!=typeof e?(this.isSearching$.next(!1),(0,s.of)([])):this.getDirectoryObjects$(e)))}getDirectoryObjects$(e){return this.directoryObjectTypeheadService.getDirectoryObjectBy(this.tenantId,{SearchPhrase:e,ObjectType:this.type}).pipe((0,h.b)(e=>{this.filteredDirectoryObjectsAmount=e.length,this.selectedDirectoryObjects=[]}),(0,u.x)(()=>this.isSearching$.next(!1)))}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](f.X))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-directory-object-typehead"]],inputs:{tenantViewSceneId:"tenantViewSceneId",multi:"multi",label:"label",placeholder:"placeholder",multiSelectButtonLabel:"multiSelectButtonLabel",type:"type"},outputs:{selectionChanged:"selectionChanged"},decls:2,vars:2,consts:[["class","directory-object-typehead-container",3,"has-opened-dropdown",4,"ngIf"],["class","directory-object-typehead-backdrop",3,"click",4,"ngIf"],[1,"directory-object-typehead-container"],["for","search_query","class","label",4,"ngIf"],["nbSpinnerMessage","Searching...",3,"nbSpinner"],["formFieldReference",""],["id","search_query","type","text","nbInput","","fullWidth","",3,"placeholder","formControl","focus"],[4,"ngIf"],["for","search_query",1,"label"],["class","dropdown mt-1",3,"width",4,"ngIf"],[1,"dropdown","mt-1"],[3,"value","click",4,"ngFor","ngForOf"],["class","dropdown-footer p-1",4,"ngIf"],[3,"value","click"],[3,"checked",4,"ngIf"],["class","c-pointer w-100 h-100",3,"click",4,"ngIf"],[3,"checked"],[1,"c-pointer","w-100","h-100",3,"click"],[1,"dropdown-footer","p-1"],["nbButton","","fullWidth","",3,"disabled","click"],[1,"directory-object-typehead-backdrop",3,"click"]],template:function(e,t){1&e&&(r["\u0275\u0275template"](0,w,8,11,"div",0),r["\u0275\u0275template"](1,k,1,0,"div",1)),2&e&&(r["\u0275\u0275property"]("ngIf",t.tenantId),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",t.filteredDirectoryObjectsAmount>0))},directives:[b.O5,m.jBG,m.Q7R,m.h8i,i.Fj,i.JJ,i.oH,m.Hcl,b.sg,m.q51,m.NTf,m.DPz],pipes:[b.Ov],styles:["[_nghost-%COMP%]{display:block;width:100%}[_nghost-%COMP%]   .directory-object-typehead-container[_ngcontent-%COMP%]{z-index:7198}[_nghost-%COMP%]   .directory-object-typehead-container.has-opened-dropdown[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   .directory-object-typehead-container[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{position:fixed;border:.0625rem solid #e4e9f2;border-radius:.25rem;overflow:hidden}[_nghost-%COMP%]   .directory-object-typehead-container[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   nb-option-list[_ngcontent-%COMP%]{display:block;border-style:none}[_nghost-%COMP%]   .directory-object-typehead-container[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .dropdown-footer[_ngcontent-%COMP%]{background-color:var(--white)}[_nghost-%COMP%]   .directory-object-typehead-container[_ngcontent-%COMP%]     nb-checkbox{height:100%;display:flex;align-items:center}[_nghost-%COMP%]   .directory-object-typehead-container[_ngcontent-%COMP%]     nb-checkbox label{cursor:pointer}[_nghost-%COMP%]   .directory-object-typehead-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;z-index:7087}"]}),e})()},77194:function(e,t,n){"use strict";n.d(t,{e7:function(){return s}});var r=n(38583),i=n(14625),o=n(3679),c=n(37716);let s=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({imports:[[r.ez,i.CG_,i.V7y,i.nKr,o.UX,i.uuI,i.MfT,i.T2N]]}),e})();n(17003),n(20521)}}]);