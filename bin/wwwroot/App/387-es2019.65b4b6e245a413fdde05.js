(self.webpackChunkngx_admin=self.webpackChunkngx_admin||[]).push([[387],{12387:function(e,t,n){"use strict";n.r(t),n.d(t,{AzureResourcesModule:function(){return ge}});var i=n(3679),r=n(38583),a=n(9857),s=n(69517),o=n(66911),l=n(99763),c=n(37716);let d=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-azure-resources"]],decls:1,vars:0,template:function(e,t){1&e&&c["\u0275\u0275element"](0,"router-outlet")},directives:[l.lC],styles:[""]}),e})();var h=n(79765),p=n(46797),m=n(25917),u=n(39761),g=n(5304),f=n(43190),S=n(67666),b=n(68307),y=n(11627),C=n(11173),x=n(91841),v=n(69167),w=n(27861),I=n(85902);const M=["dialog"];function P(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"p"),c["\u0275\u0275text"](1,"You can configure file shares to receive alerts or to automatically increase and decrease the provisioned storage (decreasing happens only once a day). The shares are validated each hour. The service principal needs contributor permission to change the quota on a share."),c["\u0275\u0275elementEnd"]())}function O(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"p"),c["\u0275\u0275text"](1,"You can configure file shares to receive alerts or to automatically increase the provisioned storage. The shares are validated each hour. The service principal needs contributor permission to change the quota on a share."),c["\u0275\u0275elementEnd"]())}function E(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"div",5),c["\u0275\u0275elementStart"](1,"div",6),c["\u0275\u0275elementStart"](2,"div",7),c["\u0275\u0275elementStart"](3,"label",24),c["\u0275\u0275text"](4,"Autoshrink once a day"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](5,"nb-checkbox",25),c["\u0275\u0275listener"]("ngModelChange",function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"](2).fileConfig.AllowShrinking=t}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](6,"div",6),c["\u0275\u0275elementEnd"]()}if(2&e){const e=c["\u0275\u0275nextContext"](2);c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("ngModel",e.fileConfig.AllowShrinking)("disabled",!e.azResourceAutomation.Enabled||!e.fileConfig.AutoAdaptFileShare)}}function R(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"button",26),c["\u0275\u0275listener"]("click",function(){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"](2).delete()}),c["\u0275\u0275text"](1," Delete "),c["\u0275\u0275elementEnd"]()}if(2&e){const e=c["\u0275\u0275nextContext"](2);c["\u0275\u0275property"]("disabled",!e.allowSave)}}const T=function(e){return{"is-invalid":e}};function z(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"form",3,4),c["\u0275\u0275listener"]("ngSubmit",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275reference"](2);return c["\u0275\u0275nextContext"]().onSubmit(t)}),c["\u0275\u0275elementStart"](3,"div",5),c["\u0275\u0275elementStart"](4,"div",6),c["\u0275\u0275elementStart"](5,"div",7),c["\u0275\u0275elementStart"](6,"label",8),c["\u0275\u0275text"](7,"Enabled"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](8,"nb-checkbox",9),c["\u0275\u0275listener"]("ngModelChange",function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().azResourceAutomation.Enabled=t}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](9,"div",6),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](10,"div",5),c["\u0275\u0275elementStart"](11,"div",6),c["\u0275\u0275elementStart"](12,"div",7),c["\u0275\u0275elementStart"](13,"label",10),c["\u0275\u0275text"](14,"If free space is lower than (GByte):"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](15,"div",6),c["\u0275\u0275elementStart"](16,"input",11,12),c["\u0275\u0275listener"]("ngModelChange",function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().fileConfig.AlertIfLessGb=t}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](18,"div",6),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](19,"div",5),c["\u0275\u0275elementStart"](20,"div",6),c["\u0275\u0275elementStart"](21,"div",7),c["\u0275\u0275elementStart"](22,"label",13),c["\u0275\u0275text"](23,"Auto-Adapt"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](24,"nb-checkbox",14),c["\u0275\u0275listener"]("ngModelChange",function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().fileConfig.AutoAdaptFileShare=t}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](25,"div",6),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](26,"div",5),c["\u0275\u0275elementStart"](27,"div",6),c["\u0275\u0275elementStart"](28,"div",7),c["\u0275\u0275elementStart"](29,"label",15),c["\u0275\u0275text"](30,"Keep the free space larger than (GByte):"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](31,"div",6),c["\u0275\u0275elementStart"](32,"input",16,17),c["\u0275\u0275listener"]("ngModelChange",function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().fileConfig.SpareSpaceInGb=t}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](34,"div",6),c["\u0275\u0275elementStart"](35,"div",7),c["\u0275\u0275elementStart"](36,"label",18),c["\u0275\u0275text"](37,"Never exceed (GByte):"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](38,"div",6),c["\u0275\u0275elementStart"](39,"input",19,20),c["\u0275\u0275listener"]("ngModelChange",function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().fileConfig.MaxSpaceInGb=t}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](41,E,7,2,"div",21),c["\u0275\u0275elementStart"](42,"button",22),c["\u0275\u0275text"](43,"Save"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](44,R,2,1,"button",23),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){const e=c["\u0275\u0275reference"](17),t=c["\u0275\u0275reference"](33),n=c["\u0275\u0275reference"](40),i=c["\u0275\u0275nextContext"]();c["\u0275\u0275advance"](8),c["\u0275\u0275property"]("ngModel",i.azResourceAutomation.Enabled),c["\u0275\u0275advance"](8),c["\u0275\u0275property"]("disabled",!i.azResourceAutomation.Enabled)("ngModel",i.fileConfig.AlertIfLessGb)("ngClass",c["\u0275\u0275pureFunction1"](15,T,i.submitted&&e.invalid)),c["\u0275\u0275advance"](8),c["\u0275\u0275property"]("ngModel",i.fileConfig.AutoAdaptFileShare)("disabled",!i.azResourceAutomation.Enabled),c["\u0275\u0275advance"](8),c["\u0275\u0275property"]("disabled",!i.azResourceAutomation.Enabled||!i.fileConfig.AutoAdaptFileShare)("ngModel",i.fileConfig.SpareSpaceInGb)("ngClass",c["\u0275\u0275pureFunction1"](17,T,i.submitted&&t.invalid)),c["\u0275\u0275advance"](7),c["\u0275\u0275property"]("disabled",!i.azResourceAutomation.Enabled||!i.fileConfig.AutoAdaptFileShare)("ngModel",i.fileConfig.MaxSpaceInGb)("ngClass",c["\u0275\u0275pureFunction1"](19,T,i.submitted&&n.invalid)),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngIf",i.showShrink),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("disabled",!i.allowSave),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngIf",i.fileConfig)}}function A(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"button",27),c["\u0275\u0275listener"]("click",function(){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().add()}),c["\u0275\u0275element"](1,"nb-icon",28),c["\u0275\u0275text"](2,"Add "),c["\u0275\u0275elementEnd"]()}if(2&e){const e=c["\u0275\u0275nextContext"]();c["\u0275\u0275property"]("status",e.styleBtSemiRound)}}let _=(()=>{class e{constructor(e,t,n,i,r){this.actionService=e,this.activatedroute=t,this.http=n,this.toastrService=i,this.dialogService=r,this.spinner1=!0,this.allowSave=!0,this.fileConfig$=new h.xQ,this.submitted=!1,this.showShrink=!1,this.httpWebRoot=(new C.tc).apiURL(),this.styleBtSemiRound="semi-round"}ngOnChanges(){this.fileConfig=null,this.azResourceAutomation=null,this.resourceId64=btoa(this.storageResourceId),this.spinner1=!0,this.fileConfig$.next()}ngOnInit(){this.showShrink=!C.tc.usVersion||(C.tc.featureExtension&C.kh.AutoadaptFileSharesShrink)===C.kh.AutoadaptFileSharesShrink,this.fileConfigSubscription$=this.fileConfig$.pipe((0,u.O)(0),(0,f.w)(()=>this.http.get(`${(new C.tc).apiURL()}/data/AzResourceAutomation/scene/${this.scene}/type/StorageAccountFileShare/resourceId64/${this.resourceId64}`)),(0,S.a)(e=>e.pipe((0,b.b)(e=>this.showToast("danger","Failure accessing the FileShare-API",`Cannot read data from API. The message is: ${e.message} with status ${e.statusText}`)),(0,y.j)(()=>(0,p.H)(5e3)))),(0,g.K)(e=>(this.showToast("danger","Failure accessing the FileShare-API",`Cannot read data from API. Reload this site to try it again. The message is: ${e.message} with status ${e.statusText}`),(0,m.of)([])))).subscribe(e=>{null==e?console.log("No configuration"):(console.log("Configuration",e),this.azResourceAutomation=e,this.fileConfig=JSON.parse(this.azResourceAutomation.ConfigurationJson)),this.captionReal=this.caption,this.spinner1=!1})}add(){this.fileConfig=new I.Ie,this.azResourceAutomation=new I.FC,this.azResourceAutomation.Enabled=!0,this.azResourceAutomation.ResourceId=this.resourceId64,this.azResourceAutomation.Scene=this.scene,this.azResourceAutomation.Type=I.wx.StorageAccountFileShare}delete(){null!=this.azResourceAutomation.Id?(this.allowSave=!1,this.actionService.sendAction(`AzResourceAutomation/scene/${this.scene}/type/StorageAccountFileShare/resourceId64/${this.resourceId64}/delete`,this.azResourceAutomation,"Deleting configuration","").subscribe(e=>{e&&(this.allowSave=!0,this.fileConfig=null,this.azResourceAutomation=null)})):(this.fileConfig=null,this.azResourceAutomation=null)}onSubmit(e){this.showShrink||(this.fileConfig.AllowShrinking=!1),this.azResourceAutomation.ConfigurationJson=JSON.stringify(this.fileConfig),this.azResourceAutomation.LastRunMessage="",this.azResourceAutomation.LastRunOk=!0,this.azResourceAutomation.LastRunTimeUtc=new Date(0),this.azResourceAutomation.NextRunUtc=new Date(0),this.azResourceAutomation.LastTimeSeenUtc=new Date,this.azResourceAutomation.ResourceId=this.resourceId64,this.azResourceAutomation.Scene=this.scene,this.azResourceAutomation.Type=I.wx.StorageAccountFileShare,this.submitted=!0,e.valid?(this.allowSave=!1,this.actionService.sendAction(`AzResourceAutomation/scene/${this.scene}/type/StorageAccountFileShare/resourceId64/${this.resourceId64}`,this.azResourceAutomation,"Storing configuration","").subscribe(e=>{e&&this.fileConfig$.next(),this.allowSave=!0})):alert("Please check your configuration. Some properties or selections are not valid or missing. Check the red-cross-marked properties.")}ngOnDestroy(){this.fileConfigSubscription$&&this.fileConfigSubscription$.unsubscribe()}showToast(e,t,n){this.toastrService.show(n,t?`${t}`:"",{status:e,destroyByClick:!0,duration:2e4,hasIcon:!0,position:a.fe3.TOP_RIGHT,preventDuplicates:!0})}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](w.c),c["\u0275\u0275directiveInject"](l.gz),c["\u0275\u0275directiveInject"](x.eN),c["\u0275\u0275directiveInject"](a.quB),c["\u0275\u0275directiveInject"](a.Gln))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-file-share-config"]],viewQuery:function(e,t){if(1&e&&c["\u0275\u0275viewQuery"](M,5),2&e){let e;c["\u0275\u0275queryRefresh"](e=c["\u0275\u0275loadQuery"]())&&(t.dialog=e.first)}},inputs:{storageResourceId:"storageResourceId",scene:"scene",share:"share",caption:"caption"},features:[c["\u0275\u0275NgOnChangesFeature"]],decls:12,vars:6,consts:[[4,"ngIf"],[3,"nbSpinner"],["type","button","nbButton","",3,"status","click",4,"ngIf"],[3,"ngSubmit"],["f","ngForm"],[1,"row"],[1,"col-sm-6"],[1,"form-group","row"],["for","dc-Enabled",1,"label","col-sm-6","col-form-label"],["id","dc-Enabled","name","Enabled","nbTooltip","Enable configuration",1,"col-sm-6",3,"ngModel","ngModelChange"],["for","dc-AlertIfLessGb",1,"label","col-sm-6","col-form-label"],["type","number","id","dc-AlertIfLessGb","min","1","max","5000","nbInput","","fullWidth","","placeholder","1","nbTooltip","Alert if the free space is less than the configured value in GByte. Permitted range: 1-5000","name","AlertIfLessGb",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["AlertIfLessGb","ngModel"],["for","dc-AutoAdaptFileShare",1,"label","col-sm-6","col-form-label"],["id","dc-AutoAdaptFileShare","name","AutoAdaptFileShare","nbTooltip","Enables auto-adapt for this share. Auto-adapt can resize the share if needed and configured. Auto-adapt starts if the free space is less than the configured alert value.",1,"col-sm-6",3,"ngModel","disabled","ngModelChange"],["for","dc-SpareSpaceInGb",1,"label","col-sm-6","col-form-label"],["type","number","id","dc-SpareSpaceInGb","min","1","max","5000","nbInput","","fullWidth","","placeholder","1","nbTooltip","If an alert is triggered, auto-adapt tries to resize the share to have the configured amount for free space.. Permitted range: 1-5000","name","SpareSpaceInGb",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["SpareSpaceInGb","ngModel"],["for","dc-MaxSpaceInGb",1,"label","col-sm-6","col-form-label"],["type","number","id","dc-MaxSpaceInGb","min","10","max","100000","nbInput","","fullWidth","","placeholder","1","nbTooltip","Never exceed the configured value for the full share. Permitted range: 10-100000","name","MaxSpaceInGb",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["MaxSpaceInGb","ngModel"],["class","row",4,"ngIf"],["type","submit","nbButton","","status","primary","nbTooltip","Save the configuration",2,"float","right",3,"disabled"],["type","button","nbButton","","style","float: right;",3,"disabled","click",4,"ngIf"],["for","dc-AllowShrinking",1,"label","col-sm-6","col-form-label"],["id","dc-AllowShrinking","name","AllowShrinking","nbTooltip","If enabled and more storage free as the configured free space, Hydra tries to shrink the share once a day (24h after the last resizing).",1,"col-sm-6",3,"ngModel","disabled","ngModelChange"],["type","button","nbButton","",2,"float","right",3,"disabled","click"],["type","button","nbButton","",3,"status","click"],["icon","plus-outline"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"nb-card"),c["\u0275\u0275elementStart"](2,"nb-card-header"),c["\u0275\u0275elementStart"](3,"h1"),c["\u0275\u0275text"](4,"Configuration"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](5,P,2,0,"p",0),c["\u0275\u0275template"](6,O,2,0,"p",0),c["\u0275\u0275elementStart"](7,"b"),c["\u0275\u0275text"](8),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](9,"nb-card-body",1),c["\u0275\u0275template"](10,z,45,21,"div",0),c["\u0275\u0275template"](11,A,3,1,"button",2),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("ngIf",t.showShrink),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",!t.showShrink),c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate"](t.captionReal),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("nbSpinner",t.spinner1),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",t.fileConfig),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",!t.fileConfig))},directives:[a.Asz,a.ndF,r.O5,a.yKW,a.Q7R,i._Y,i.JL,i.F,a.NTf,a.jNv,i.JJ,i.On,i.qQ,i.Fd,i.wV,a.h8i,i.Fj,r.mk,a.DPz,a.fMN],styles:[".nb-theme-default   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-default   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-default   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-default   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-dark   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-dark   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-dark   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-dark   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-cosmic   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-cosmic   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-cosmic   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-cosmic   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-corporate   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-corporate   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-corporate   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-corporate   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}"]}),e})();const k=["dialog"];function F(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"em"),c["\u0275\u0275text"](1),c["\u0275\u0275elementEnd"]()),2&e){const e=c["\u0275\u0275nextContext"]();c["\u0275\u0275advance"](1),c["\u0275\u0275textInterpolate1"]("(",e.itemsCount," handles)")}}function $(e,t){1&e&&c["\u0275\u0275element"](0,"span",19)}function H(e,t){1&e&&c["\u0275\u0275element"](0,"span",20)}function L(e,t){1&e&&c["\u0275\u0275element"](0,"span",19)}function B(e,t){1&e&&c["\u0275\u0275element"](0,"span",20)}function N(e,t){1&e&&c["\u0275\u0275element"](0,"span",19)}function V(e,t){1&e&&c["\u0275\u0275element"](0,"span",20)}function G(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementContainerStart"](0),c["\u0275\u0275elementStart"](1,"tr"),c["\u0275\u0275elementStart"](2,"td"),c["\u0275\u0275elementStart"](3,"nb-checkbox",21),c["\u0275\u0275listener"]("ngModelChange",function(t){return c["\u0275\u0275restoreView"](e).$implicit.IsSelected=t}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](4,"td"),c["\u0275\u0275text"](5),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](6,"td"),c["\u0275\u0275text"](7),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](8,"td"),c["\u0275\u0275text"](9),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=t.$implicit;c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngModel",e.IsSelected),c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate1"](" ",e.Path," "),c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate1"](" ",e.ClientIp," "),c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate"](e.OpenTime)}}function j(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"div",11),c["\u0275\u0275elementStart"](2,"table",12),c["\u0275\u0275elementStart"](3,"thead"),c["\u0275\u0275elementStart"](4,"tr"),c["\u0275\u0275elementStart"](5,"th",13),c["\u0275\u0275listener"]("click",function(){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().selectAllTrigger()}),c["\u0275\u0275text"](6,"Select"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](7,"th",14),c["\u0275\u0275listener"]("click",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275nextContext"]();return t.sortType="Path",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),c["\u0275\u0275text"](8," Path and File "),c["\u0275\u0275template"](9,$,1,0,"span",15),c["\u0275\u0275template"](10,H,1,0,"span",16),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](11,"th",14),c["\u0275\u0275listener"]("click",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275nextContext"]();return t.sortType="ClientIp",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),c["\u0275\u0275text"](12," Client IP "),c["\u0275\u0275template"](13,L,1,0,"span",15),c["\u0275\u0275template"](14,B,1,0,"span",16),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](15,"th",14),c["\u0275\u0275listener"]("click",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275nextContext"]();return t.sortType="OpenTime",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),c["\u0275\u0275text"](16," Time opened "),c["\u0275\u0275template"](17,N,1,0,"span",15),c["\u0275\u0275template"](18,V,1,0,"span",16),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](19,"tbody"),c["\u0275\u0275template"](20,G,10,4,"ng-container",17),c["\u0275\u0275pipe"](21,"slice"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](22,"ngb-pagination",18),c["\u0275\u0275listener"]("pageChange",function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().page=t}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){const e=c["\u0275\u0275nextContext"]();c["\u0275\u0275advance"](9),c["\u0275\u0275property"]("ngIf","Path"==e.sortType&&!e.sortReverse),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","Path"==e.sortType&&e.sortReverse),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf","ClientIp"==e.sortType&&!e.sortReverse),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","ClientIp"==e.sortType&&e.sortReverse),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf","OpenTime"==e.sortType&&!e.sortReverse),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","OpenTime"==e.sortType&&e.sortReverse),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngForOf",c["\u0275\u0275pipeBind3"](21,13,e.fileHandles,(e.page-1)*e.pageSize,e.page*e.pageSize))("ngForTrackBy",e.identifyViewFileHandles),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("collectionSize",e.collectionSize)("page",e.page)("maxSize",5)("boundaryLinks",!0)("pageSize",e.pageSize)}}function U(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"nb-card"),c["\u0275\u0275elementStart"](1,"nb-card-header"),c["\u0275\u0275text"](2,"Confirmation"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](3,"nb-card-body"),c["\u0275\u0275text"](4),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](5,"nb-card-footer"),c["\u0275\u0275elementStart"](6,"div",2),c["\u0275\u0275element"](7,"div",22),c["\u0275\u0275elementStart"](8,"div",23),c["\u0275\u0275elementStart"](9,"button",24),c["\u0275\u0275listener"]("click",function(){return c["\u0275\u0275restoreView"](e).dialogRef.close("0")}),c["\u0275\u0275text"](10,"Cancel"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](11,"div",23),c["\u0275\u0275elementStart"](12,"button",25),c["\u0275\u0275listener"]("click",function(){return c["\u0275\u0275restoreView"](e).dialogRef.close("1")}),c["\u0275\u0275text"](13,"Ok"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;c["\u0275\u0275advance"](4),c["\u0275\u0275textInterpolate"](e)}}let D=(()=>{class e{constructor(e,t,n,i,r){this.actionService=e,this.activatedroute=t,this.http=n,this.toastrService=i,this.dialogService=r,this.spinner1=!0,this.interval=2*C.tc.autoRefreshDefault,this.page=1,this.pageSize=20,this.fileHandles$=new h.xQ,this.fileHandles=[],this.allfileHandles=[],this.dict={},this.iterationId=0,this.httpWebRoot=(new C.tc).apiURL(),this.sortType="SceneName",this.sortReverse=!0,this.searchPhrase="",this.styleBtSemiRound="semi-round"}ngOnInit(){this.fileHandelsSubscription$=this.fileHandles$.pipe((0,u.O)(0),(0,f.w)(()=>(0,p.H)(1,this.interval)),(0,f.w)(()=>this.http.get(`${(new C.tc).apiURL()}/data/azure/fileshares/${this.scene}/${this.resourceId64}/${this.share}/handles`)),(0,S.a)(e=>e.pipe((0,b.b)(e=>this.showToast("danger","Failure accessing the FileShare-API",`Cannot read data from API. The message is: ${e.message} with status ${e.statusText}`)),(0,y.j)(()=>(0,p.H)(5e3)))),(0,g.K)(e=>(this.showToast("danger","Failure accessing the FileShare-API",`Cannot read data from API. Reload this site to try it again. The message is: ${e.message} with status ${e.statusText}`),(0,m.of)([])))).subscribe(e=>{this.captionReal=this.caption,this.iterationId++,this.collectionSize=e.length,this.spinner1=!1,e.forEach(e=>{if(this.dict[e.HandleId]){const t=this.dict[e.HandleId].IsSelected;this.dict[e.HandleId]=Object.assign(new I.Fr,e),this.dict[e.HandleId].IsSelected=t,this.dict[e.HandleId]._iteration=this.iterationId}else this.dict[e.HandleId]=e,this.dict[e.HandleId]._iteration=this.iterationId});const t=[];for(const n in this.dict)this.dict[n]._iteration===this.iterationId&&t.push(this.dict[n]);this.allfileHandles=t,this.itemsCount=this.allfileHandles.length,this.searchTable(),this.sort(this.sortReverse,this.sortType)})}ngOnChanges(){this.resourceId64=btoa(this.storageResourceId),this.spinner1=!0,this.allfileHandles=[],this.dict={},this.fileHandles$.next()}triggerActionSelected(e,t,n=!1,i=!1){const r=this.allfileHandles.filter(e=>e.IsSelected);0===r.length?alert("Please select one or more items to run the action"):n?this.dialogService.open(this.dialog,{context:`Please confirm the operation '${t}' for ${r.length} handles`}).onClose.subscribe(n=>{"1"===n&&this.triggerAction(e,t)}):this.triggerAction(e,t)}triggerAction(e,t){const n=this.allfileHandles.filter(e=>e.IsSelected);console.log("Start action: "+e+" on a number of handles"+n.length),this.actionService.sendActionAsync(`azure/fileshares/${this.scene}/${this.resourceId64}/${this.share}/handles/close`,n,t,n.length+" handles",!0).subscribe(e=>{this.fileHandles$.next()})}identifyViewFileHandles(e,t){return t.Id}update(){this.fileHandles$.next()}searchTable(){this.fileHandles=this.allfileHandles.filter(e=>""===this.searchPhrase||e.Path.toLowerCase().includes(this.searchPhrase.toLowerCase())||e.ClientIp.toLowerCase().indexOf(this.searchPhrase.toLowerCase())>-1||e.OpenTime.toLowerCase().indexOf(this.searchPhrase.toLowerCase())>-1),this.sort(this.sortReverse,this.sortType),this.collectionSize=this.fileHandles.length}sort(e,t){const n=(t+".....").split(".");this.sortInternal(e,n[0],n[1],n[2],n[3])}sortInternal(e,t,n="",i="",r=""){this.fileHandles=this.fileHandles.sort((a,s)=>{try{if(""!=r)var o=a[t][n][i][r],l=s[t][n][i][r];else""!=i?(o=a[t][n][i],l=s[t][n][i]):""!=n?(o=a[t][n],l=s[t][n]):(o=a[t],l=s[t])}catch{o=1,l=1}return e?o>l?1:l>o?-1:0:o>l?-1:1})}selectAllTrigger(){this.fileHandles.findIndex(e=>e.IsSelected)<0?this.fileHandles.forEach(e=>e.IsSelected=!0):this.fileHandles.filter(e=>e.IsSelected).forEach(e=>e.IsSelected=!1)}selectPage(){const e=(this.page-1)*this.pageSize;let t=e+this.pageSize;t>=this.fileHandles.length&&(t=this.fileHandles.length);for(let n=0;n<this.fileHandles.length;n++)this.fileHandles[n].IsSelected=n>=e&&n<t}navigateTo(e,t){}ngOnDestroy(){this.fileHandelsSubscription$&&this.fileHandelsSubscription$.unsubscribe()}showToast(e,t,n){this.toastrService.show(n,t?`${t}`:"",{status:e,destroyByClick:!0,duration:2e4,hasIcon:!0,position:a.fe3.TOP_RIGHT,preventDuplicates:!0})}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](w.c),c["\u0275\u0275directiveInject"](l.gz),c["\u0275\u0275directiveInject"](x.eN),c["\u0275\u0275directiveInject"](a.quB),c["\u0275\u0275directiveInject"](a.Gln))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-file-share-handles"]],viewQuery:function(e,t){if(1&e&&c["\u0275\u0275viewQuery"](k,5),2&e){let e;c["\u0275\u0275queryRefresh"](e=c["\u0275\u0275loadQuery"]())&&(t.dialog=e.first)}},inputs:{storageResourceId:"storageResourceId",scene:"scene",share:"share",caption:"caption"},features:[c["\u0275\u0275NgOnChangesFeature"]],decls:23,vars:6,consts:[[4,"ngIf"],[3,"nbSpinner"],[1,"row"],[1,"col-sm-8"],["type","text","nbInput","","fullWidth","","placeholder","Search for a specific file or IP",3,"ngModel","ngModelChange"],[1,"col-sm-4"],["size","small","fullWidth",""],["icon","stop-circle","nbTooltip","Release handle","nbTooltipPlacement","top",3,"click"],["type","button","nbButton","",3,"status","click"],["icon","refresh"],["dialog",""],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],[2,"cursor","pointer",3,"click"],[3,"click"],["class","fa fa-caret-down",4,"ngIf"],["class","fa fa-caret-up",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","justify-content-center",3,"collectionSize","page","maxSize","boundaryLinks","pageSize","pageChange"],[1,"fa","fa-caret-down"],[1,"fa","fa-caret-up"],[3,"ngModel","ngModelChange"],[1,"col-sm-6",2,"min-width","200px"],[1,"col-sm-3","text-right"],["nbButton","",1,"cancel",3,"click"],["nbButton","",3,"click"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"nb-card"),c["\u0275\u0275elementStart"](2,"nb-card-header"),c["\u0275\u0275elementStart"](3,"h1"),c["\u0275\u0275text"](4,"File Handles"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](5,"p"),c["\u0275\u0275text"](6,"This table shows open file handles and can be used to reset a locked FSLogix profile disk. If the app service has no access to the file storage (e.g., the storage account is using a private endpoint, and the app service can not access the storage account), the list is empty."),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](7,"b"),c["\u0275\u0275text"](8),c["\u0275\u0275template"](9,F,2,1,"em",0),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](10,"nb-card-body",1),c["\u0275\u0275elementStart"](11,"div",2),c["\u0275\u0275elementStart"](12,"div",3),c["\u0275\u0275elementStart"](13,"input",4),c["\u0275\u0275listener"]("ngModelChange",function(e){return t.searchPhrase=e})("ngModelChange",function(){return t.searchTable()}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](14,"div",5),c["\u0275\u0275elementStart"](15,"nb-actions",6),c["\u0275\u0275elementStart"](16,"nb-action",7),c["\u0275\u0275listener"]("click",function(){return t.triggerActionSelected("release","Release",!0,!0)}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](17,j,23,17,"div",0),c["\u0275\u0275elementStart"](18,"button",8),c["\u0275\u0275listener"]("click",function(){return t.update()}),c["\u0275\u0275element"](19,"nb-icon",9),c["\u0275\u0275text"](20,"Update "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](21,U,14,1,"ng-template",null,10,c["\u0275\u0275templateRefExtractor"])),2&e&&(c["\u0275\u0275advance"](8),c["\u0275\u0275textInterpolate1"]("",t.captionReal," "),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",t.itemsCount>0),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("nbSpinner",t.spinner1),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngModel",t.searchPhrase),c["\u0275\u0275advance"](4),c["\u0275\u0275property"]("ngIf",t.fileHandles),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("status",t.styleBtSemiRound))},directives:[a.Asz,a.ndF,r.O5,a.yKW,a.Q7R,a.h8i,i.Fj,i.JJ,i.On,a.lYD,a.Bk3,a.jNv,a.DPz,a.fMN,r.sg,s.N9,a.NTf,a.XWE],pipes:[r.OU],styles:[".nb-theme-default   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-default   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-default   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-default   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-dark   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-dark   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-dark   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-dark   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-cosmic   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-cosmic   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-cosmic   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-cosmic   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-corporate   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-corporate   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-corporate   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-corporate   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}"]}),e})();function Q(e,t){1&e&&c["\u0275\u0275element"](0,"span",14)}function J(e,t){1&e&&c["\u0275\u0275element"](0,"span",15)}function W(e,t){1&e&&c["\u0275\u0275element"](0,"span",14)}function K(e,t){1&e&&c["\u0275\u0275element"](0,"span",15)}function q(e,t){1&e&&c["\u0275\u0275element"](0,"span",14)}function X(e,t){1&e&&c["\u0275\u0275element"](0,"span",15)}function Y(e,t){1&e&&c["\u0275\u0275element"](0,"span",14)}function Z(e,t){1&e&&c["\u0275\u0275element"](0,"span",15)}function ee(e,t){1&e&&c["\u0275\u0275element"](0,"span",14)}function te(e,t){1&e&&c["\u0275\u0275element"](0,"span",15)}function ne(e,t){1&e&&c["\u0275\u0275element"](0,"span",14)}function ie(e,t){1&e&&c["\u0275\u0275element"](0,"span",15)}function re(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"nb-icon",19),c["\u0275\u0275listener"]("click",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275nextContext"]().$implicit;return c["\u0275\u0275nextContext"](2).config(t.Scene,t.ResourceId,t.Share,t.SceneName+": "+t.Name+"\\"+t.Share)}),c["\u0275\u0275elementEnd"]()}}function ae(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementContainerStart"](0),c["\u0275\u0275elementStart"](1,"tr"),c["\u0275\u0275elementStart"](2,"td"),c["\u0275\u0275text"](3),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](4,"td"),c["\u0275\u0275text"](5),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](6,"td"),c["\u0275\u0275text"](7),c["\u0275\u0275template"](8,re,1,0,"nb-icon",16),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](9,"td"),c["\u0275\u0275elementStart"](10,"nb-icon",17),c["\u0275\u0275listener"]("click",function(){const t=c["\u0275\u0275restoreView"](e).$implicit;return c["\u0275\u0275nextContext"](2).config(t.Scene,t.ResourceId,t.Share,t.SceneName+": "+t.Name+"\\"+t.Share)}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](11,"td"),c["\u0275\u0275text"](12),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](13,"td"),c["\u0275\u0275text"](14),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](15,"td"),c["\u0275\u0275elementStart"](16,"ngx-tacho",18),c["\u0275\u0275listener"]("click",function(){const t=c["\u0275\u0275restoreView"](e).$implicit;return c["\u0275\u0275nextContext"](2).handles(t.Scene,t.ResourceId,t.Share,t.SceneName+": "+t.Name+"\\"+t.Share)}),c["\u0275\u0275pipe"](17,"number"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=t.$implicit;c["\u0275\u0275advance"](3),c["\u0275\u0275textInterpolate1"](" ",e.SceneName," "),c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate1"](" ",e.Name," "),c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate1"]("",e.Share," "),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",e.Warning),c["\u0275\u0275advance"](4),c["\u0275\u0275textInterpolate"](e.QuotaGb),c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate"](e.UsageGb),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("chartValue",c["\u0275\u0275pipeBind2"](17,7,e.Load,"1.1-1"))}}function se(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"div",7),c["\u0275\u0275elementStart"](2,"table",8),c["\u0275\u0275elementStart"](3,"thead"),c["\u0275\u0275elementStart"](4,"tr"),c["\u0275\u0275elementStart"](5,"th",9),c["\u0275\u0275listener"]("click",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275nextContext"]();return t.sortType="SceneName",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),c["\u0275\u0275text"](6," Tenant "),c["\u0275\u0275template"](7,Q,1,0,"span",10),c["\u0275\u0275template"](8,J,1,0,"span",11),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](9,"th",9),c["\u0275\u0275listener"]("click",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275nextContext"]();return t.sortType="Name",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),c["\u0275\u0275text"](10," Storage Account "),c["\u0275\u0275template"](11,W,1,0,"span",10),c["\u0275\u0275template"](12,K,1,0,"span",11),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](13,"th",9),c["\u0275\u0275listener"]("click",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275nextContext"]();return t.sortType="Share",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),c["\u0275\u0275text"](14," Share "),c["\u0275\u0275template"](15,q,1,0,"span",10),c["\u0275\u0275template"](16,X,1,0,"span",11),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](17,"th"),c["\u0275\u0275text"](18,"Action"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](19,"th",9),c["\u0275\u0275listener"]("click",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275nextContext"]();return t.sortType="QuotaGb",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),c["\u0275\u0275text"](20," Quote / GByte "),c["\u0275\u0275template"](21,Y,1,0,"span",10),c["\u0275\u0275template"](22,Z,1,0,"span",11),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](23,"th",9),c["\u0275\u0275listener"]("click",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275nextContext"]();return t.sortType="UsageGb",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),c["\u0275\u0275text"](24," Usage / GByte "),c["\u0275\u0275template"](25,ee,1,0,"span",10),c["\u0275\u0275template"](26,te,1,0,"span",11),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](27,"th",9),c["\u0275\u0275listener"]("click",function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275nextContext"]();return t.sortType="Load",t.sortReverse=!t.sortReverse,t.sort(t.sortReverse,t.sortType)}),c["\u0275\u0275text"](28," Usage / % "),c["\u0275\u0275template"](29,ne,1,0,"span",10),c["\u0275\u0275template"](30,ie,1,0,"span",11),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](31,"tbody"),c["\u0275\u0275template"](32,ae,18,10,"ng-container",12),c["\u0275\u0275pipe"](33,"slice"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](34,"ngb-pagination",13),c["\u0275\u0275listener"]("pageChange",function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().page=t}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){const e=c["\u0275\u0275nextContext"]();c["\u0275\u0275advance"](7),c["\u0275\u0275property"]("ngIf","SceneName"==e.sortType&&!e.sortReverse),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","SceneName"==e.sortType&&e.sortReverse),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf","Name"==e.sortType&&!e.sortReverse),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","Name"==e.sortType&&e.sortReverse),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf","Share"==e.sortType&&!e.sortReverse),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","Share"==e.sortType&&e.sortReverse),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("ngIf","QuotaGb"==e.sortType&&!e.sortReverse),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","QuotaGb"==e.sortType&&e.sortReverse),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf","UsageGb"==e.sortType&&!e.sortReverse),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","UsageGb"==e.sortType&&e.sortReverse),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf","Load"==e.sortType&&!e.sortReverse),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","Load"==e.sortType&&e.sortReverse),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngForOf",c["\u0275\u0275pipeBind3"](33,19,e.fileShares,(e.page-1)*e.pageSize,e.page*e.pageSize))("ngForTrackBy",e.identifyViewFileShares),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("collectionSize",e.collectionSize)("page",e.page)("maxSize",5)("boundaryLinks",!0)("pageSize",e.pageSize)}}function oe(e,t){if(1&e&&c["\u0275\u0275element"](0,"ngx-file-share-config",20),2&e){const e=c["\u0275\u0275nextContext"]();c["\u0275\u0275property"]("storageResourceId",e.storageResourceId)("scene",e.scene)("share",e.share)("caption",e.caption)}}function le(e,t){if(1&e&&c["\u0275\u0275element"](0,"ngx-file-share-handles",20),2&e){const e=c["\u0275\u0275nextContext"]();c["\u0275\u0275property"]("storageResourceId",e.storageResourceId)("scene",e.scene)("share",e.share)("caption",e.caption)}}let ce=(()=>{class e{constructor(e,t){this.http=e,this.toastrService=t,this.interval=2*C.tc.autoRefreshDefault,this.page=1,this.pageSize=20,this.fileShares$=new h.xQ,this.fileShares=[],this.allFileShares=[],this.httpWebRoot=(new C.tc).apiURL(),this.sortType="SceneName",this.sortReverse=!0,this.searchPhrase="",this.showHandles=!1,this.showConfig=!1,this.styleBtSemiRound="semi-round"}ngOnInit(){this.fileSharesSubscription$=this.fileShares$.pipe((0,u.O)(0),(0,f.w)(()=>(0,p.H)(1,this.interval)),(0,f.w)(()=>this.http.get(`${(new C.tc).apiURL()}/data/azure/fileshares`)),(0,S.a)(e=>e.pipe((0,b.b)(e=>this.showToast("danger","Failure accessing the FileShare-API",`Cannot read data from API. The message is: ${e.message} with status ${e.statusText}`)),(0,y.j)(()=>(0,p.H)(5e3)))),(0,g.K)(e=>(this.showToast("danger","Failure accessing the FileShare-API",`Cannot read data from API. Reload this site to try it again. The message is: ${e.message} with status ${e.statusText}`),(0,m.of)([])))).subscribe(e=>{console.log("FileShares: Getting data ",e.length),this.collectionSize=e.length,this.allFileShares=e,this.searchTable(),this.sort(this.sortReverse,this.sortType)})}identifyViewFileShares(e,t){return t.Id}update(){this.fileShares$.next()}handles(e,t,n,i){this.scene=e,this.storageResourceId=t,this.share=n,this.caption=i,this.showHandles=!0}config(e,t,n,i){this.scene=e,this.storageResourceId=t,this.share=n,this.caption=i,this.showConfig=!0}searchTable(){this.fileShares=this.allFileShares.filter(e=>""===this.searchPhrase||e.Name.toLowerCase().includes(this.searchPhrase.toLowerCase())||e.Share.toLowerCase().indexOf(this.searchPhrase.toLowerCase())>-1),this.sort(this.sortReverse,this.sortType),this.collectionSize=this.fileShares.length}sort(e,t){const n=(t+".....").split(".");this.sortInternal(e,n[0],n[1],n[2],n[3])}sortInternal(e,t,n="",i="",r=""){this.fileShares=this.fileShares.sort((a,s)=>{try{if(""!==r)var o=a[t][n][i][r],l=s[t][n][i][r];else""!==i?(o=a[t][n][i],l=s[t][n][i]):""!==n?(o=a[t][n],l=s[t][n]):(o=a[t],l=s[t])}catch{o=1,l=1}return e?o>l?1:l>o?-1:0:o>l?-1:1})}navigateTo(e,t){}ngOnDestroy(){this.fileSharesSubscription$&&this.fileSharesSubscription$.unsubscribe()}showToast(e,t,n){this.toastrService.show(n,t?`${t}`:"",{status:e,destroyByClick:!0,duration:2e4,hasIcon:!0,position:a.fe3.TOP_RIGHT,preventDuplicates:!0})}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](x.eN),c["\u0275\u0275directiveInject"](a.quB))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-file-shares"]],decls:16,vars:5,consts:[[1,"row"],[1,"col-sm-6"],["type","text","nbInput","","fullWidth","","placeholder","Search for a specific tenant, storage account, share",3,"ngModel","ngModelChange"],[4,"ngIf"],["type","button","nbButton","",3,"status","click"],["icon","refresh"],[3,"storageResourceId","scene","share","caption",4,"ngIf"],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],[3,"click"],["class","fa fa-caret-down",4,"ngIf"],["class","fa fa-caret-up",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","justify-content-center",3,"collectionSize","page","maxSize","boundaryLinks","pageSize","pageChange"],[1,"fa","fa-caret-down"],[1,"fa","fa-caret-up"],["icon","alert-triangle-outline","nbTooltip","Alert",3,"click",4,"ngIf"],["icon","settings-outline","nbTooltip","Configure",3,"click"],[3,"chartValue","click"],["icon","alert-triangle-outline","nbTooltip","Alert",3,"click"],[3,"storageResourceId","scene","share","caption"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"nb-card"),c["\u0275\u0275elementStart"](2,"nb-card-header"),c["\u0275\u0275elementStart"](3,"h1"),c["\u0275\u0275text"](4,"File Shares"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](5,"nb-card-body"),c["\u0275\u0275elementStart"](6,"div",0),c["\u0275\u0275elementStart"](7,"div",1),c["\u0275\u0275elementStart"](8,"input",2),c["\u0275\u0275listener"]("ngModelChange",function(e){return t.searchPhrase=e})("ngModelChange",function(){return t.searchTable()}),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](9,"div",1),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](10,se,35,23,"div",3),c["\u0275\u0275elementStart"](11,"button",4),c["\u0275\u0275listener"]("click",function(){return t.update()}),c["\u0275\u0275element"](12,"nb-icon",5),c["\u0275\u0275text"](13," Update "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](14,oe,1,4,"ngx-file-share-config",6),c["\u0275\u0275template"](15,le,1,4,"ngx-file-share-handles",6)),2&e&&(c["\u0275\u0275advance"](8),c["\u0275\u0275property"]("ngModel",t.searchPhrase),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngIf",t.fileShares),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("status",t.styleBtSemiRound),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf",t.showConfig),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",t.showHandles))},directives:[a.Asz,a.ndF,a.yKW,a.h8i,i.Fj,i.JJ,i.On,r.O5,a.DPz,a.fMN,r.sg,s.N9,a.jNv,v.K,_,D],pipes:[r.OU,r.JJ],styles:[".nb-theme-default   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-default   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-default   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-default   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-dark   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-dark   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-dark   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-dark   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-cosmic   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-cosmic   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-cosmic   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-cosmic   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-corporate   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-corporate   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-corporate   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-corporate   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}"]}),e})();var de=n(18819),he=n(86115),pe=n(93104);const me=[{path:"",component:d,children:[{path:"vd",loadChildren:()=>Promise.all([n.e(592),n.e(505)]).then(n.bind(n,72505)).then(e=>e.VirtualDesktopModule)},{path:"file-shares",component:ce},{path:"file-shares/:id/statistic",component:(()=>{class e{constructor(e,t,n,i,r){this.hostPoolsService=e,this.activatedroute=t,this.theme=n,this.http=i,this.toastrService=r,this.test="",this.dataX=[],this.userSessionsConnected=[[]],this.userSessions=[[]],this.userCapacityNow=[[]],this.sessionHostsAvailable=[[]],this.lastDateInsert=new Date(0),this.options={},this.alive=!0,this.loadBalancerTypePersistent=he.rQ.Persistent,this.loadBalancerTypeBreadthFirst=he.rQ.BreadthFirst,this.loadBalancerTypeMultiplePersistent=he.rQ.MultiplePersistent,this.activatedroute.paramMap.subscribe(e=>{this.id=e.get("id"),console.log(`Host pool id: ${this.id.replace(/;/g,"/")}`)}),this.statisticsSubscription=this.http.get(`${(new C.tc).apiURL()}/data/azure/fileshares/${this.id}/usage`).pipe((0,S.a)(e=>e.pipe((0,b.b)(e=>this.showToast("danger","Failure accessing the API",`Cannot read data from API. The message is: ${e.message} with status ${e.statusText}`)))),(0,de.B)()).subscribe(e=>{this.dataX=[],this.userCapacityNow=[],this.userSessions=[],e.forEach(e=>{const t=new Date(e.TimeGenerated);this.dataX.push(t),this.userCapacityNow.push([t.toISOString(),e.QuotaGb]),this.userSessions.push([t.toISOString(),e.UsageGb])}),this.ngAfterViewInit()})}configSaved(e){this.test=JSON.stringify(e)}ngOnDestroy(){this.alive=!1,this.themeSubscription&&this.themeSubscription.unsubscribe(),this.statisticsSubscription&&this.statisticsSubscription.unsubscribe()}ngAfterViewInit(){this.themeSubscription=this.theme.getJsTheme().subscribe(e=>{const t=e.variables,n=e.variables.echarts;this.options={backgroundColor:n.bg,color:[t.danger,t.primary,t.info],tooltip:{formatter:function(e,t){return(0,r.p6)(e[0].value[0],"HH:mm:ss","en-US")+`<li style="list-style:none; color:white">${e[0].marker+e[0].seriesName}: &nbsp;&nbsp;${e[0].value[1]}</li><li style="list-style:none; color:white">${e[1].marker+e[1].seriesName}: &nbsp;&nbsp;${e[1].value[1]}</li>`},trigger:"axis",axisPointer:{type:"cross"}},legend:{left:"left",data:["Quota / GByte","Usage / GByte"],textStyle:{color:n.textColor}},xAxis:[{type:"time",data:this.dataX,axisTick:{alignWithLabel:!0},axisLine:{lineStyle:{color:n.axisLineColor}},axisLabel:{rotate:-45,textStyle:{color:n.textColor},formatter:function(e){return(0,r.p6)(e,"HH:mm:ss","en-US")}}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:n.axisLineColor}},splitLine:{lineStyle:{color:n.splitLineColor}},axisLabel:{textStyle:{color:n.textColor}}},{type:"value",axisLabel:{textStyle:{color:n.textColor}},axisLine:{lineStyle:{color:n.axisLineColor}},splitLine:{lineStyle:{color:n.splitLineColor}}}],grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},series:[{name:"Quota / GByte",type:"line",smooth:!0,showSymbol:!1,data:this.userCapacityNow},{name:"Usage / GByte",type:"line",smooth:!0,showSymbol:!1,data:this.userSessions}]}})}showToast(e,t,n){this.toastrService.show(n,t?`${t}`:"",{status:e,destroyByClick:!0,duration:2e4,hasIcon:!0,position:a.fe3.TOP_RIGHT,preventDuplicates:!0})}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](he.lJ),c["\u0275\u0275directiveInject"](l.gz),c["\u0275\u0275directiveInject"](a.WMF),c["\u0275\u0275directiveInject"](x.eN),c["\u0275\u0275directiveInject"](a.quB))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-file-share-statistic"]],decls:5,vars:1,consts:[["echarts","",1,"echart",3,"options"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"h1"),c["\u0275\u0275text"](2,"File Share Usage"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](3,"div",0),c["\u0275\u0275element"](4,"br")),2&e&&(c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("options",t.options))},directives:[pe.w],styles:[".nb-theme-default   [_nghost-%COMP%]   nb-card-body[_ngcontent-%COMP%]{overflow:hidden}.nb-theme-dark   [_nghost-%COMP%]   nb-card-body[_ngcontent-%COMP%]{overflow:hidden}.nb-theme-cosmic   [_nghost-%COMP%]   nb-card-body[_ngcontent-%COMP%]{overflow:hidden}.nb-theme-corporate   [_nghost-%COMP%]   nb-card-body[_ngcontent-%COMP%]{overflow:hidden}"]}),e})()},{path:"**",redirectTo:"file-shares",pathMatch:"full"}]}];let ue=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({imports:[[l.Bz.forChild(me)],l.Bz]}),e})(),ge=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({imports:[[r.ez,ue,o.m,i.u5,a.zyh,a.KdK,s.jF,a.T2N,a.uuI,a.MAY,a.MfT,a.nKr,a.rgH]]}),e})()}}]);