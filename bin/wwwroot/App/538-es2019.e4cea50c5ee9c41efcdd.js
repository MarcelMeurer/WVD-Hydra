(self.webpackChunkngx_admin=self.webpackChunkngx_admin||[]).push([[538],{66538:function(e,t,n){"use strict";n.r(t),n.d(t,{ProvisioningPoliciesModule:function(){return ke}});var i=n(38583),r=n(99763),o=n(79765),l=n(46797),a=n(40205),s=n(25917),c=n(39761),u=n(5304),p=n(46782),d=n(54395),g=n(87519),m=n(68307),h=n(11627),f=n(43190),y=n(67666),v=n(11173),C=n(76897),S=(()=>(function(e){e[e.Gallery=0]="Gallery",e[e.Custom=1]="Custom",e[e.UnknownFutureValue=2]="UnknownFutureValue"}(S||(S={})),S))(),P=(()=>(function(e){e[e.Dedicated=0]="Dedicated",e[e.Shared=1]="Shared",e[e.UnknownFutureValue=2]="UnknownFutureValue",e[e.SharedByUser=3]="SharedByUser",e[e.SharedByEntraGroup=4]="SharedByEntraGroup",e[e.Reserve=5]="Reserve"}(P||(P={})),P))(),x=(()=>(function(e){e[e.CloudPc=0]="CloudPc",e[e.CloudApp=1]="CloudApp",e[e.UnknownFutureValue=2]="UnknownFutureValue"}(x||(x={})),x))(),b=n(9857),T=n(3679),E=n(34681),I=(()=>(function(e){e.TenantName="SceneName",e.Name="Resource.DisplayName",e.Image="Resource.ImageDisplayName",e.Experience="UserExperienceType",e.ImageStatus="Resource.ImageType",e.CreatedBy="Resource.CreatedBy",e.LicenseType="Resource.ProvisioningType"}(I||(I={})),I))();function w(e){switch(e){case x.CloudApp:case"CloudApp":return"Cloud App";case x.CloudPc:case"CloudPc":return"Cloud PC";case x.UnknownFutureValue:case"UnknownFutureValue":return"Unknown future value";default:return"null"}}function F(e){switch(e){case S.Gallery:return"Gallery";case S.Custom:return"Custom";case S.UnknownFutureValue:return"Unknown future value";default:return"null"}}function R(e){switch(e){case P.Dedicated:return"Dedicated";case P.Shared:return"Shared";case P.SharedByUser:return"Shared By User";case P.SharedByEntraGroup:return"Shared By Entra Group";case P.Reserve:return"Reserve";case P.UnknownFutureValue:return"Unknown future value";default:return"null"}}var k=n(37716),O=n(47010);const N=["popoverRef"];function U(e,t){if(1&e){const e=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"ngx-table-filter-popover",4),k["\u0275\u0275listener"]("filtersChanges",function(t){return k["\u0275\u0275restoreView"](e),k["\u0275\u0275nextContext"]().filtersChanged(t)}),k["\u0275\u0275elementEnd"]()}if(2&e){const e=k["\u0275\u0275nextContext"]();k["\u0275\u0275property"]("filters",e.filters)("filterName",e.filterName)}}const V=function(e){return{"filters-applied":e}};let A=(()=>{class e{constructor(){this.dataSource=[],this.filtersChanges=new k.EventEmitter,this.filters=[],this.areFiltersApplied=!1,this.valueMapper=e=>{var t,n;switch(this.resourcePath){case I.Experience:return w(e.UserExperienceType);case I.ImageStatus:return F(null===(t=e.Resource)||void 0===t?void 0:t.ImageType);case I.LicenseType:return R(null===(n=e.Resource)||void 0===n?void 0:n.ProvisioningType);default:return this.getObjectValueByResourcePath(e,this.resourcePath)}},this.getObjectValueByResourcePath=(e,t)=>null==t?void 0:t.split(".").reduce((e,t)=>e&&void 0!==e[t]?e[t]:void 0,e)}ngOnInit(){this.buildFilters()}filtersChanged(e){var t;this.areFiltersApplied=e[0].some(e=>e.checked),this.filtersChanges.emit(e),null===(t=this.popoverRef)||void 0===t||t.hide()}buildFilters(){var e;if(!(null===(e=this.dataSource)||void 0===e?void 0:e.length)||!this.resourcePath)return;const t=new Set(this.dataSource.map(this.valueMapper)),n=Array.from(t);this.filters=n.map(e=>({label:e,checked:!1}))}resetAllFilters(){this.filters=this.filters.map(e=>({...e,checked:!1})),this.areFiltersApplied=!1,this.filtersChanged([this.filters,this.filterName])}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=k["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-provisioning-policies-filter-trigger"]],viewQuery:function(e,t){if(1&e&&k["\u0275\u0275viewQuery"](N,7),2&e){let e;k["\u0275\u0275queryRefresh"](e=k["\u0275\u0275loadQuery"]())&&(t.popoverRef=e.first)}},inputs:{resourcePath:"resourcePath",filterName:"filterName",dataSource:"dataSource"},outputs:{filtersChanges:"filtersChanges"},decls:5,vars:5,consts:[["nbButton","","size","tiny","nbPopoverTrigger","focus","nbPopoverPlacement","bottom",3,"ngClass","nbPopover","disabled","click"],["popoverRef","nbPopover"],["icon","funnel"],["tableFilterPopoverTpl",""],[3,"filters","filterName","filtersChanges"]],template:function(e,t){if(1&e&&(k["\u0275\u0275elementStart"](0,"button",0,1),k["\u0275\u0275listener"]("click",function(e){return e.stopPropagation()}),k["\u0275\u0275element"](2,"nb-icon",2),k["\u0275\u0275elementEnd"](),k["\u0275\u0275template"](3,U,1,2,"ng-template",null,3,k["\u0275\u0275templateRefExtractor"])),2&e){const e=k["\u0275\u0275reference"](4);k["\u0275\u0275property"]("ngClass",k["\u0275\u0275pureFunction1"](3,V,t.areFiltersApplied))("nbPopover",e)("disabled",!t.dataSource.length)}},directives:[b.DPz,i.mk,b.ydg,b.fMN,O.D],styles:['[_nghost-%COMP%]{display:block;position:relative}[_nghost-%COMP%]   button.filters-applied[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-.188em;right:-.188em;width:.7em;height:.7em;border-radius:50%;background-color:var(--primary)}']}),e})();var B=n(1816),z=n(69517);function D(e,t){1&e&&k["\u0275\u0275element"](0,"nb-spinner")}function M(e,t){if(1&e){const e=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"button",19),k["\u0275\u0275listener"]("click",function(){return k["\u0275\u0275restoreView"](e),k["\u0275\u0275nextContext"](2).clearSearch()}),k["\u0275\u0275element"](1,"nb-icon",20),k["\u0275\u0275elementEnd"]()}}function L(e,t){1&e&&k["\u0275\u0275elementContainer"](0)}function _(e,t){1&e&&k["\u0275\u0275elementContainer"](0)}function K(e,t){1&e&&k["\u0275\u0275elementContainer"](0)}function j(e,t){1&e&&k["\u0275\u0275elementContainer"](0)}function G(e,t){1&e&&k["\u0275\u0275elementContainer"](0)}function $(e,t){1&e&&k["\u0275\u0275elementContainer"](0)}function H(e,t){1&e&&k["\u0275\u0275elementContainer"](0)}function Q(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Cloud App"),k["\u0275\u0275elementContainerEnd"]())}function q(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Cloud PC"),k["\u0275\u0275elementContainerEnd"]())}function W(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Unknown future value"),k["\u0275\u0275elementContainerEnd"]())}function X(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Gallery"),k["\u0275\u0275elementContainerEnd"]())}function J(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Custom"),k["\u0275\u0275elementContainerEnd"]())}function Y(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Unknown future value"),k["\u0275\u0275elementContainerEnd"]())}function Z(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Dedicated"),k["\u0275\u0275elementContainerEnd"]())}function ee(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Shared"),k["\u0275\u0275elementContainerEnd"]())}function te(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Shared By User"),k["\u0275\u0275elementContainerEnd"]())}function ne(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Shared By Entra Group"),k["\u0275\u0275elementContainerEnd"]())}function ie(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Reserve"),k["\u0275\u0275elementContainerEnd"]())}function re(e,t){1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275text"](1,"Unknown future value"),k["\u0275\u0275elementContainerEnd"]())}function oe(e,t){if(1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275elementStart"](1,"tr"),k["\u0275\u0275elementStart"](2,"td"),k["\u0275\u0275text"](3),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](4,"td"),k["\u0275\u0275text"](5),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](6,"td"),k["\u0275\u0275text"](7),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](8,"td"),k["\u0275\u0275template"](9,Q,2,0,"ng-container",0),k["\u0275\u0275template"](10,q,2,0,"ng-container",0),k["\u0275\u0275template"](11,W,2,0,"ng-container",0),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](12,"td"),k["\u0275\u0275template"](13,X,2,0,"ng-container",0),k["\u0275\u0275template"](14,J,2,0,"ng-container",0),k["\u0275\u0275template"](15,Y,2,0,"ng-container",0),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](16,"td"),k["\u0275\u0275text"](17),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](18,"td"),k["\u0275\u0275template"](19,Z,2,0,"ng-container",0),k["\u0275\u0275template"](20,ee,2,0,"ng-container",0),k["\u0275\u0275template"](21,te,2,0,"ng-container",0),k["\u0275\u0275template"](22,ne,2,0,"ng-container",0),k["\u0275\u0275template"](23,ie,2,0,"ng-container",0),k["\u0275\u0275template"](24,re,2,0,"ng-container",0),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit,n=k["\u0275\u0275nextContext"](3);k["\u0275\u0275advance"](3),k["\u0275\u0275textInterpolate"](e.SceneName),k["\u0275\u0275advance"](2),k["\u0275\u0275textInterpolate"](null==e.Resource?null:e.Resource.DisplayName),k["\u0275\u0275advance"](2),k["\u0275\u0275textInterpolate"](null==e.Resource?null:e.Resource.ImageDisplayName),k["\u0275\u0275advance"](2),k["\u0275\u0275property"]("ngIf",e.UserExperienceType===n.CloudPcUserExperienceType.CloudApp||"CloudApp"===e.UserExperienceType),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",e.UserExperienceType===n.CloudPcUserExperienceType.CloudPc||"CloudPc"===e.UserExperienceType),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",e.UserExperienceType===n.CloudPcUserExperienceType.UnknownFutureValue||"UnknownFutureValue"===e.UserExperienceType),k["\u0275\u0275advance"](2),k["\u0275\u0275property"]("ngIf",(null==e.Resource?null:e.Resource.ImageType)===n.CloudPcProvisioningPolicyImageType.Gallery),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",(null==e.Resource?null:e.Resource.ImageType)===n.CloudPcProvisioningPolicyImageType.Custom),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",(null==e.Resource?null:e.Resource.ImageType)===n.CloudPcProvisioningPolicyImageType.UnknownFutureValue),k["\u0275\u0275advance"](2),k["\u0275\u0275textInterpolate"](null==e.Resource?null:e.Resource.CreatedBy),k["\u0275\u0275advance"](2),k["\u0275\u0275property"]("ngIf",(null==e.Resource?null:e.Resource.ProvisioningType)===n.CloudPcProvisioningType.Dedicated),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",(null==e.Resource?null:e.Resource.ProvisioningType)===n.CloudPcProvisioningType.Shared),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",(null==e.Resource?null:e.Resource.ProvisioningType)===n.CloudPcProvisioningType.SharedByUser),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",(null==e.Resource?null:e.Resource.ProvisioningType)===n.CloudPcProvisioningType.SharedByEntraGroup),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",(null==e.Resource?null:e.Resource.ProvisioningType)===n.CloudPcProvisioningType.Reserve),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",(null==e.Resource?null:e.Resource.ProvisioningType)===n.CloudPcProvisioningType.UnknownFutureValue)}}function le(e,t){if(1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275template"](1,oe,25,16,"ng-container",21),k["\u0275\u0275pipe"](2,"slice"),k["\u0275\u0275elementContainerEnd"]()),2&e){const e=k["\u0275\u0275nextContext"](2);k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngForOf",k["\u0275\u0275pipeBind3"](2,2,e.provisioningPolicies,(e.paginationCurrentPage-1)*e.paginationPageSize,e.paginationCurrentPage*e.paginationPageSize))("ngForTrackBy",e.trackByPolicyId)}}function ae(e,t){if(1&e){const e=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"tr"),k["\u0275\u0275elementStart"](1,"td",22),k["\u0275\u0275elementStart"](2,"ngx-table-empty-state",23),k["\u0275\u0275listener"]("clearSearchClick",function(){return k["\u0275\u0275restoreView"](e),k["\u0275\u0275nextContext"](2).clearSearch()})("clearFiltersClick",function(){return k["\u0275\u0275restoreView"](e),k["\u0275\u0275nextContext"](2).clearFilters()}),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"]()}if(2&e){k["\u0275\u0275nextContext"]();const e=k["\u0275\u0275reference"](12),t=k["\u0275\u0275nextContext"]();k["\u0275\u0275advance"](1),k["\u0275\u0275attribute"]("colspan",e.children.length),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("filterState",t.filterState)}}function se(e,t){if(1&e){const e=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"ngb-pagination",24),k["\u0275\u0275listener"]("pageChange",function(t){return k["\u0275\u0275restoreView"](e),k["\u0275\u0275nextContext"](2).paginationCurrentPage=t}),k["\u0275\u0275elementEnd"]()}if(2&e){const e=k["\u0275\u0275nextContext"](2);k["\u0275\u0275property"]("page",e.paginationCurrentPage)("collectionSize",e.provisioningPolicies.length)("maxSize",e.paginationMaxSize)("boundaryLinks",!0)("pageSize",e.paginationPageSize)}}function ce(e,t){if(1&e&&(k["\u0275\u0275elementStart"](0,"nb-option",27),k["\u0275\u0275text"](1),k["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;k["\u0275\u0275property"]("value",e),k["\u0275\u0275advance"](1),k["\u0275\u0275textInterpolate1"](" ",e," ")}}function ue(e,t){if(1&e){const e=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"nb-select",25),k["\u0275\u0275listener"]("ngModelChange",function(t){return k["\u0275\u0275restoreView"](e),k["\u0275\u0275nextContext"](2).paginationPageSize=t})("selectedChange",function(){return k["\u0275\u0275restoreView"](e),k["\u0275\u0275nextContext"](2).saveLocalConfig()}),k["\u0275\u0275template"](1,ce,2,2,"nb-option",26),k["\u0275\u0275elementEnd"]()}if(2&e){const e=k["\u0275\u0275nextContext"](2);k["\u0275\u0275property"]("ngModel",e.paginationPageSize),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngForOf",e.rowsPerPageOptions)}}const pe=function(e){return{sortKey:e,label:"Tenant",filterName:"SceneName"}},de=function(e){return{sortKey:e,label:"Name",filterName:"DisplayName"}},ge=function(e){return{sortKey:e,label:"Image",filterName:"ImageDisplayName"}},me=function(e){return{sortKey:e,label:"Experience",filterName:"UserExperienceType"}},he=function(e){return{sortKey:e,label:"Image status",filterName:"ImageType"}},fe=function(e){return{sortKey:e,label:"Created by",filterName:"CreatedBy"}},ye=function(e){return{sortKey:e,label:"License type",filterName:"ProvisioningType"}};function ve(e,t){if(1&e){const e=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275elementStart"](1,"div",3),k["\u0275\u0275elementStart"](2,"div",4),k["\u0275\u0275elementStart"](3,"label",5),k["\u0275\u0275elementStart"](4,"div",6),k["\u0275\u0275elementStart"](5,"nb-form-field"),k["\u0275\u0275element"](6,"input",7),k["\u0275\u0275template"](7,M,2,0,"button",8),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](8,"div",9),k["\u0275\u0275elementStart"](9,"table",10),k["\u0275\u0275elementStart"](10,"thead"),k["\u0275\u0275elementStart"](11,"tr",11,12),k["\u0275\u0275template"](13,L,1,0,"ng-container",13),k["\u0275\u0275template"](14,_,1,0,"ng-container",13),k["\u0275\u0275template"](15,K,1,0,"ng-container",13),k["\u0275\u0275template"](16,j,1,0,"ng-container",13),k["\u0275\u0275template"](17,G,1,0,"ng-container",13),k["\u0275\u0275template"](18,$,1,0,"ng-container",13),k["\u0275\u0275template"](19,H,1,0,"ng-container",13),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](20,"tbody"),k["\u0275\u0275template"](21,le,3,6,"ng-container",0),k["\u0275\u0275template"](22,ae,3,2,"tr",0),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275template"](23,se,1,5,"ngb-pagination",14),k["\u0275\u0275elementStart"](24,"div",15),k["\u0275\u0275template"](25,ue,2,2,"nb-select",16),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](26,"button",17),k["\u0275\u0275listener"]("click",function(){return k["\u0275\u0275restoreView"](e),k["\u0275\u0275nextContext"]().update()}),k["\u0275\u0275element"](27,"nb-icon",18),k["\u0275\u0275text"](28," Update "),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=k["\u0275\u0275nextContext"](),t=k["\u0275\u0275reference"](8);k["\u0275\u0275advance"](6),k["\u0275\u0275property"]("formControl",e.searchFormControl),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",e.searchFormControl.value),k["\u0275\u0275advance"](6),k["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",k["\u0275\u0275pureFunction1"](20,pe,e.sortKeys.TenantName)),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",k["\u0275\u0275pureFunction1"](22,de,e.sortKeys.Name)),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",k["\u0275\u0275pureFunction1"](24,ge,e.sortKeys.Image)),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",k["\u0275\u0275pureFunction1"](26,me,e.sortKeys.Experience)),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",k["\u0275\u0275pureFunction1"](28,he,e.sortKeys.ImageStatus)),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",k["\u0275\u0275pureFunction1"](30,fe,e.sortKeys.CreatedBy)),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",k["\u0275\u0275pureFunction1"](32,ye,e.sortKeys.LicenseType)),k["\u0275\u0275advance"](2),k["\u0275\u0275property"]("ngIf",e.provisioningPolicies.length),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",e.isEmptyStateVisible),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",e.provisioningPolicies.length>3),k["\u0275\u0275advance"](2),k["\u0275\u0275property"]("ngIf",e.provisioningPolicies.length>e.MAX_LENGTH_TO_SHOW_ELEMENT)}}function Ce(e,t){1&e&&k["\u0275\u0275elementContainer"](0)}function Se(e,t){if(1&e){const e=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"ngx-provisioning-policies-filter-trigger",32),k["\u0275\u0275listener"]("filtersChanges",function(t){return k["\u0275\u0275restoreView"](e),k["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),k["\u0275\u0275elementEnd"]()}if(2&e){const e=k["\u0275\u0275nextContext"](),t=e.sortKey,n=e.filterName,i=k["\u0275\u0275nextContext"]();k["\u0275\u0275property"]("resourcePath",t)("filterName",n)("dataSource",i.provisioningPolicies)}}const Pe=function(e){return{$implicit:e}};function xe(e,t){if(1&e){const e=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"th",28),k["\u0275\u0275listener"]("click",function(){const t=k["\u0275\u0275restoreView"](e).sortKey,n=k["\u0275\u0275nextContext"]();return t&&n.toggleSort(t)}),k["\u0275\u0275elementStart"](1,"div",29),k["\u0275\u0275elementStart"](2,"span"),k["\u0275\u0275text"](3),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](4,"div",30),k["\u0275\u0275template"](5,Ce,1,0,"ng-container",13),k["\u0275\u0275template"](6,Se,1,3,"ngx-provisioning-policies-filter-trigger",31),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"]()}if(2&e){const e=t.sortKey,n=t.label,i=t.hideFilter;k["\u0275\u0275nextContext"]();const r=k["\u0275\u0275reference"](10);k["\u0275\u0275advance"](3),k["\u0275\u0275textInterpolate"](n),k["\u0275\u0275advance"](2),k["\u0275\u0275property"]("ngTemplateOutlet",r)("ngTemplateOutletContext",k["\u0275\u0275pureFunction1"](4,Pe,e)),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",!i)}}function be(e,t){if(1&e&&(k["\u0275\u0275elementContainerStart"](0),k["\u0275\u0275element"](1,"nb-icon",33),k["\u0275\u0275elementContainerEnd"]()),2&e){const e=k["\u0275\u0275nextContext"](2);k["\u0275\u0275advance"](1),k["\u0275\u0275propertyInterpolate"]("nbTooltip","asc"===e.sortDirection?"Sorted ascending":"Sorted descending"),k["\u0275\u0275propertyInterpolate1"]("icon","arrow-","asc"===e.sortDirection?"down":"up","")}}function Te(e,t){if(1&e&&k["\u0275\u0275template"](0,be,2,2,"ng-container",0),2&e){const e=t.$implicit,n=k["\u0275\u0275nextContext"]();k["\u0275\u0275property"]("ngIf",n.sortColumn===e)}}const Ee=[{path:"",component:(()=>{class e{constructor(e,t){this.wd365Service=e,this.toastrService=t,this.destroyed$=new o.xQ,this.filterState={searchQuery:"",columnFilters:{}},this.selectedPolicyIds=new Set,this.selectedPolicies=[],this.rowsPerPageOptions=[20,50,80,100,150,200],this.MAX_LENGTH_TO_SHOW_ELEMENT=20,this.CloudPcUserExperienceType=x,this.CloudPcProvisioningPolicyImageType=S,this.CloudPcProvisioningType=P,this.isEmptyStateVisible=!1,this.provisioningPolicies$=new o.xQ,this.provisioningPolicies=[],this.provisioningPoliciesCache=[],this.isLoading=!1,this.searchFormControl=new T.NI(""),this.paginationCurrentPage=1,this.paginationPageSize=this.rowsPerPageOptions[0],this.paginationMaxSize=10,this.sortKeys=I,this.sortColumn="",this.sortDirection="asc",this.trackByPolicyId=(e,t)=>t.Id,this.retryApiCallWithToastCallback=e=>e.pipe((0,m.b)(e=>this.showDangerToast("Failure accessing the API",`Cannot read data from API. The message is: ${e.message} with status ${e.statusText}`)),(0,h.j)(()=>(0,l.H)(C.e5))),this.handleApiErrorCallback=e=>(0,a._)(()=>(this.showDangerToast("Failure accessing the API",`Cannot read data from API. Reload this site to try it again. The message is: ${e.message} with status ${e.statusText}`),(0,s.of)([])))}get hasSelectedPolicies(){return this.selectedPolicies.length>0}get areAllChecked(){return this.provisioningPolicies.length>0&&this.provisioningPolicies.every(e=>e.IsSelected)}get isIntermediateState(){const e=this.provisioningPolicies.filter(e=>e.IsSelected).length;return e>0&&e<this.provisioningPolicies.length}ngOnInit(){this.loadPageSizeFromLocalStorage(),this.initProvisioningPolicies(),this.initTableSearch()}loadPageSizeFromLocalStorage(){const e=localStorage.getItem("Hydra.ProvisioningPolicies.PageSize");e&&Number(e)&&(this.paginationPageSize=Number(e))}toggleSort(e){this.sortColumn===e?this.sortDirection="asc"===this.sortDirection?"desc":"asc":(this.sortColumn=e,this.sortDirection="asc"),this.applySorting()}selectionChanged(e,t){e.IsSelected=t,t?this.selectedPolicyIds.add(e.Id):this.selectedPolicyIds.delete(e.Id),this.countSelected()}selectAll(e){e?this.selectAllOnPage(this.provisioningPolicies):this.deselectAllOnPage(this.provisioningPolicies),this.countSelected()}selectPage(){const e=this.getPoliciesPageSlice();e.every(e=>e.IsSelected)?this.deselectAllOnPage(e):this.selectAllOnPage(e),this.countSelected()}clearSearch(){this.searchFormControl.setValue("")}clearFilters(){var e;this.filterState={...this.filterState,columnFilters:{}},this.paginationCurrentPage=1,null===(e=this.filterTriggers)||void 0===e||e.forEach(e=>e.resetAllFilters()),this.applyAllFilters()}saveLocalConfig(){localStorage.setItem("Hydra.ProvisioningPolicies.PageSize",this.paginationPageSize.toString())}update(){this.provisioningPolicies$.next()}populateFiltersSet([e,t]){this.filterState.columnFilters[t]=e.filter(e=>e.checked).map(e=>e.label.toLowerCase()),this.applyAllFilters()}countSelected(){this.selectedPolicies=this.provisioningPolicies.filter(e=>e.IsSelected)}getPoliciesPageSlice(){return this.provisioningPolicies.slice((this.paginationCurrentPage-1)*this.paginationPageSize,this.paginationCurrentPage*this.paginationPageSize)}selectAllOnPage(e){e.forEach(e=>{e.IsSelected=!0,this.selectedPolicyIds.add(e.Id)})}deselectAllOnPage(e){e.forEach(e=>{e.IsSelected=!1,this.selectedPolicyIds.delete(e.Id)})}preserveSelection(e){return e.map(e=>({...e,IsSelected:this.selectedPolicyIds.has(e.Id)}))}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}initProvisioningPolicies(){this.isLoading=!0,this.provisioningPolicies$.pipe((0,c.O)(0),(0,f.w)(()=>(0,l.H)(0,v.tc.autoRefreshDefault)),(0,f.w)(()=>this.wd365Service.getProvisioningPolicies()),(0,y.a)(this.retryApiCallWithToastCallback),(0,u.K)(this.handleApiErrorCallback),(0,p.R)(this.destroyed$)).subscribe(e=>{const t=this.preserveSelection(e);this.provisioningPoliciesCache=[...t],this.applyAllFilters(),this.isLoading=!1,this.updateEmptyStateVisibility()})}updateEmptyStateVisibility(){this.isEmptyStateVisible=!this.isLoading&&0===this.provisioningPolicies.length}initTableSearch(){this.searchFormControl.valueChanges.pipe((0,d.b)(C.XU),(0,g.x)(),(0,p.R)(this.destroyed$)).subscribe((e="")=>{this.filterState.searchQuery=e.trim(),this.applyAllFilters()})}applyAllFilters(){this.paginationCurrentPage=1;let e=[...this.provisioningPoliciesCache];Object.keys(this.filterState.columnFilters).some(e=>{var t;return(null===(t=this.filterState.columnFilters[e])||void 0===t?void 0:t.length)>0})&&(e=this.applyColumnFilters(e)),this.filterState.searchQuery&&(e=this.applySearchFilter(e)),this.provisioningPolicies=e,this.updateEmptyStateVisibility(),this.applySorting()}applySorting(){this.sortColumn&&this.sortByPropertyPath(this.sortColumn)}applyColumnFilters(e){const t=Object.keys(this.filterState.columnFilters).filter(e=>{var t;return(null===(t=this.filterState.columnFilters[e])||void 0===t?void 0:t.length)>0});return t.length?e.filter(e=>t.every(t=>{var n;const i=this.filterState.columnFilters[t],r=null===(n=function(e,t){var n,i,r,o,l;switch(t){case"SceneName":return e.Scene;case"DisplayName":return null===(n=e.Resource)||void 0===n?void 0:n.DisplayName;case"ImageDisplayName":return null===(i=e.Resource)||void 0===i?void 0:i.ImageDisplayName;case"UserExperienceType":return w(e.UserExperienceType);case"ImageType":return F(null===(r=e.Resource)||void 0===r?void 0:r.ImageType);case"CreatedBy":return null===(o=e.Resource)||void 0===o?void 0:o.CreatedBy;case"ProvisioningType":return R(null===(l=e.Resource)||void 0===l?void 0:l.ProvisioningType);default:return""}}(e,t))||void 0===n?void 0:n.toLowerCase();return i.includes(r)})):e}applySearchFilter(e){var t;const n=null===(t=this.filterState)||void 0===t?void 0:t.searchQuery.toLowerCase();return e.filter(e=>{var t,i,r,o,l,a,s,c,u,p,d;const g=null!==(i=null===(t=e.Scene)||void 0===t?void 0:t.toLowerCase())&&void 0!==i?i:"",m=null!==(l=null===(o=null===(r=e.Resource)||void 0===r?void 0:r.DisplayName)||void 0===o?void 0:o.toLowerCase())&&void 0!==l?l:"",h=null!==(c=null===(s=null===(a=e.Resource)||void 0===a?void 0:a.ImageDisplayName)||void 0===s?void 0:s.toLowerCase())&&void 0!==c?c:"",f=null!==(d=null===(p=null===(u=e.Resource)||void 0===u?void 0:u.CreatedBy)||void 0===p?void 0:p.toLowerCase())&&void 0!==d?d:"";return(null==g?void 0:g.includes(n))||(null==m?void 0:m.includes(n))||(null==h?void 0:h.includes(n))||(null==f?void 0:f.includes(n))})}sortByPropertyPath(e){const t=e.split(".");this.provisioningPolicies.sort((e,n)=>{let i=this.getNestedProperty(e,t),r=this.getNestedProperty(n,t);return i=null==i?"":i,r=null==r?"":r,"asc"===this.sortDirection?i>r?1:i<r?-1:0:i<r?1:i>r?-1:0})}getNestedProperty(e,t){return t.reduce((e,t)=>e&&void 0!==e[t]?e[t]:void 0,e)}showDangerToast(e,t){this.toastrService.danger(t,e,{destroyByClick:!0,duration:2e4,hasIcon:!0,position:b.fe3.TOP_RIGHT,preventDuplicates:!0})}}return e.\u0275fac=function(t){return new(t||e)(k["\u0275\u0275directiveInject"](E.G),k["\u0275\u0275directiveInject"](b.quB))},e.\u0275cmp=k["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-provisioning-policies"]],viewQuery:function(e,t){if(1&e&&k["\u0275\u0275viewQuery"](A,5),2&e){let e;k["\u0275\u0275queryRefresh"](e=k["\u0275\u0275loadQuery"]())&&(t.filterTriggers=e)}},decls:11,vars:2,consts:[[4,"ngIf"],["tableHeaderCellTpl",""],["sortTableIconTpl",""],[1,"row"],[1,"col-md-5"],["for","search_query",1,"w-100"],[1,"search-input-wrapper"],["id","search_query","type","text","placeholder","Search for tenant, name, image, or creator","nbInput","","fullWidth","",1,"search-input",3,"formControl"],["nbTooltip","Clear search","nbSuffix","","nbButton","","ghost","",3,"click",4,"ngIf"],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],[1,"align-top"],["headerRow",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","d-flex justify-content-center",3,"page","collectionSize","maxSize","boundaryLinks","pageSize","pageChange",4,"ngIf"],[1,"d-flex","justify-content-center","p-2"],["nbTooltip","How many rows to list on one page",3,"ngModel","ngModelChange","selectedChange",4,"ngIf"],["type","button","nbButton","","status","semi-round",3,"click"],["icon","refresh"],["nbTooltip","Clear search","nbSuffix","","nbButton","","ghost","",3,"click"],["icon","close-outline"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-center","p-5"],[3,"filterState","clearSearchClick","clearFiltersClick"],[1,"d-flex","justify-content-center",3,"page","collectionSize","maxSize","boundaryLinks","pageSize","pageChange"],["nbTooltip","How many rows to list on one page",3,"ngModel","ngModelChange","selectedChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"align-top",3,"click"],[1,"d-flex","justify-content-between"],[1,"d-flex","align-items-center"],[3,"resourcePath","filterName","dataSource","filtersChanges",4,"ngIf"],[3,"resourcePath","filterName","dataSource","filtersChanges"],[1,"sort-direction-icon","mr-1",3,"nbTooltip","icon"]],template:function(e,t){1&e&&(k["\u0275\u0275elementStart"](0,"nb-card"),k["\u0275\u0275elementStart"](1,"nb-card-header"),k["\u0275\u0275elementStart"](2,"h1"),k["\u0275\u0275text"](3,"Provisioning Policies"),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](4,"nb-card-body"),k["\u0275\u0275template"](5,D,1,0,"nb-spinner",0),k["\u0275\u0275template"](6,ve,29,34,"ng-container",0),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275template"](7,xe,7,6,"ng-template",null,1,k["\u0275\u0275templateRefExtractor"]),k["\u0275\u0275template"](9,Te,1,1,"ng-template",null,2,k["\u0275\u0275templateRefExtractor"])),2&e&&(k["\u0275\u0275advance"](5),k["\u0275\u0275property"]("ngIf",t.isLoading),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",!t.isLoading))},directives:[b.Asz,b.ndF,b.yKW,i.O5,b.Tzq,b.jBG,b.h8i,T.Fj,T.JJ,T.oH,i.tP,b.DPz,b.fMN,b.jNv,b.yyc,i.sg,B.$,z.N9,b.rs,T.On,b.q51,A],pipes:[i.OU],styles:["[_nghost-%COMP%]{height:100%}[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   .table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:not(.skip-sorting){-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer}[_nghost-%COMP%]   .sort-direction-icon[_ngcontent-%COMP%]{font-size:1em;cursor:default}"]}),e})()}];let Ie=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=k["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=k["\u0275\u0275defineInjector"]({imports:[[r.Bz.forChild(Ee)],r.Bz]}),e})();var we=n(66911),Fe=n(61367),Re=n(88100);let ke=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=k["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=k["\u0275\u0275defineInjector"]({imports:[[i.ez,Ie,we.m,T.u5,b.zyh,b.KdK,z.jF,b.T2N,b.uuI,b.MAY,b.MfT,b.nKr,b.rgH,T.UX,Fe.H,Re.Z,b.spT,b.x4g,b.IIj,b.V7y]]}),e})()}}]);