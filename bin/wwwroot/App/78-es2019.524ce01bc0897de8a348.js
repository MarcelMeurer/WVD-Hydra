(self.webpackChunkngx_admin=self.webpackChunkngx_admin||[]).push([[78],{50078:function(e,t,n){"use strict";n.r(t),n.d(t,{UserSettingsModule:function(){return Ie}});var r=n(38583),o=n(10264),i=n(79765),l=n(46797),s=n(40205),a=n(25917),c=n(94402),d=n(68307),u=n(11627),m=n(15257),p=n(45435),g=n(43190),v=n(39761),f=n(67666),h=n(5304),b=n(46782),S=n(94612),y=n(27716),C=n(14625),E=n(45880),x=n(76897),w=n(11173),R=(()=>(function(e){e.Tenant="SceneName",e.Name="CloudPcUserSetting.DisplayName",e.Assigned="AssignmentsData",e.LastUpdated="CloudPcUserSetting.LastModifiedDateTime"}(R||(R={})),R))(),k=n(3679),I=n(88002),P=n(36123),N=n(30110),T=n(34681),O=(()=>(function(e){e[e.NotConfigured=0]="NotConfigured",e[e.CrossRegion=1]="CrossRegion",e[e.Premium=2]="Premium",e[e.UnknownFutureValue=3]="UnknownFutureValue"}(O||(O={})),O))(),F=(()=>(function(e){e[e.MicrosoftHostedNetwork=0]="MicrosoftHostedNetwork",e[e.AzureNetworkConnection=1]="AzureNetworkConnection"}(F||(F={})),F))(),D=(()=>(function(e){e[e.Image=0]="Image",e[e.Snapshot=1]="Snapshot",e[e.UnknownFutureValue=2]="UnknownFutureValue"}(D||(D={})),D))(),A=(()=>(function(e){e[e.Hours4=4]="Hours4",e[e.Hours6=6]="Hours6",e[e.Hours12=12]="Hours12",e[e.Hours16=16]="Hours16",e[e.Hours24=24]="Hours24"}(A||(A={})),A))(),M=n(47349),U=n(92340),_=n(37716),G=n(91841);let V=(()=>{class e{constructor(e){this.httpClient=e,this.apiUrl=`${U.N.apiUrl}/data/scenes`,this.ALL_TENANTS_ID="00000000-0000-0000-0000-000000000000"}getUserSettings(){return this.httpClient.get(`${this.apiUrl}/${this.ALL_TENANTS_ID}/win365/settings`).pipe((0,M.d)({refCount:!0,bufferSize:1}))}saveUserSettings(e,t){return this.httpClient.post(`${this.apiUrl}/${e}/win365/settings`,t).pipe((0,M.d)({refCount:!0,bufferSize:1}))}removeUserSettings(e,t){return this.httpClient.delete(`${this.apiUrl}/${e}/win365/settings`,{body:t}).pipe((0,M.d)({refCount:!0,bufferSize:1}))}}return e.\u0275fac=function(t){return new(t||e)(_["\u0275\u0275inject"](G.eN))},e.\u0275prov=_["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),$=(()=>{class e{constructor(e,t,n,r,o,l){this.dialogRef=e,this.dialogService=t,this.wd365Service=n,this.userSettingsService=r,this.toastrService=o,this.cdr=l,this.destroyed$=new i.xQ,this.tenants$=this.wd365Service.getViewScenes(),this.isSaving=!1,this.form=new k.cw({settings:new k.cw({tenant:new k.NI(null,k.kI.required),displayName:new k.NI("",k.kI.required),localAdminEnabled:new k.NI(!1),resetEnabled:new k.NI(!1),userRestoreEnabled:new k.NI(!1),frequencyInHours:new k.NI(A.Hours12),disasterRecoveryType:new k.NI(O.NotConfigured),networkType:new k.NI(F.MicrosoftHostedNetwork),regionGroup:new k.NI(""),regionName:new k.NI(""),userInitiatedDisasterRecoveryAllowed:new k.NI(!1),provisioningSourceType:new k.NI("")}),assignments:new k.cw({groups:new k.Oe([])})})}get assignmentGroupsFormArray(){var e;return null===(e=this.form.get("assignments"))||void 0===e?void 0:e.get("groups")}set userSettings(e){var t;e&&(this.cloudPcUserSettings={...e},this.populateSettingsForm(e),this.populateAssignmentsFormArray(null===(t=this.cloudPcUserSettings)||void 0===t?void 0:t.AssignmentsData))}ngOnInit(){this.initialFormValues=this.form.getRawValue(),this.hasFormChanges$=this.form.valueChanges.pipe((0,I.U)(e=>(0,P.xF)(this.initialFormValues,e).hasDifference),(0,v.O)(!1))}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}close(){(0,P.xF)(this.initialFormValues,this.form.getRawValue()).hasDifference?this.showConfirmationDialog():this.dialogRef.close()}showConfirmationDialog(){const{onClose:e}=this.dialogService.open(N.z,{context:{headerTitle:"Warning",bodyText:"You are about to exit without saving your changes. Are you sure you want to leave?",cancelButtonText:"Close without saving",confirmButtonText:"Stay"},hasScroll:!1,closeOnEsc:!1,closeOnBackdropClick:!1});e.subscribe(e=>{!0!==e&&this.dialogRef.close()})}save(){var e,t;const{settings:n}=this.form.getRawValue(),r=n.tenant,o=n.networkType===F.MicrosoftHostedNetwork&&n.regionGroup,i=this.assignmentGroupsFormArray.value.map(({checked:e,...t})=>t),l=null===(t=null===(e=this.cloudPcUserSettings)||void 0===e?void 0:e.CloudPcUserSetting)||void 0===t?void 0:t.Id,s={...l&&{id:l},displayName:n.displayName,localAdminEnabled:n.localAdminEnabled,resetEnabled:n.resetEnabled,restorePointSetting:{userRestoreEnabled:n.userRestoreEnabled,frequencyInHours:n.frequencyInHours},crossRegionDisasterRecoverySetting:{crossRegionDisasterRecoveryEnabled:n.disasterRecoveryType===O.CrossRegion,maintainCrossRegionRestorePointEnabled:!0,disasterRecoveryType:n.disasterRecoveryType,userInitiatedDisasterRecoveryAllowed:n.disasterRecoveryType===O.Premium&&n.userInitiatedDisasterRecoveryAllowed,disasterRecoveryNetworkSetting:o?{RegionGroup:n.regionGroup,RegionName:n.regionName}:null},notificationSetting:{restartPromptsDisabled:!1},...""!==n.provisioningSourceType&&{provisioningSourceType:n.provisioningSourceType},Assignments:i};this.isSaving=!0,this.cdr.markForCheck(),this.userSettingsService.saveUserSettings(r,s).pipe((0,b.R)(this.destroyed$)).subscribe({next:()=>{this.toastrService.success(this.cloudPcUserSettings?"User setting updated":"User setting created","Success"),this.dialogRef.close({created:!0})},error:e=>{this.isSaving=!1,this.toastrService.danger(e.message||(this.cloudPcUserSettings?"Failed to update user setting":"Failed to create user setting"),"Error"),this.cdr.markForCheck()}})}populateSettingsForm(e){var t,n,r,o,i,l,s,a,c,d;const u=e.CloudPcUserSetting,m=null==u?void 0:u.RestorePointSetting,p=null==u?void 0:u.CrossRegionDisasterRecoverySetting,g=null==p?void 0:p.DisasterRecoveryNetworkSetting;this.form.patchValue({settings:{tenant:e.SceneId,displayName:null!==(t=null==u?void 0:u.DisplayName)&&void 0!==t?t:"",localAdminEnabled:null!==(n=null==u?void 0:u.LocalAdminEnabled)&&void 0!==n&&n,resetEnabled:null!==(r=null==u?void 0:u.ResetEnabled)&&void 0!==r&&r,userRestoreEnabled:null!==(o=null==m?void 0:m.UserRestoreEnabled)&&void 0!==o&&o,frequencyInHours:null!==(i=null==m?void 0:m.FrequencyInHours)&&void 0!==i?i:A.Hours12,disasterRecoveryType:null!==(l=null==p?void 0:p.DisasterRecoveryType)&&void 0!==l?l:O.NotConfigured,networkType:F.MicrosoftHostedNetwork,regionGroup:null!==(s=null==g?void 0:g.RegionGroup)&&void 0!==s?s:"",regionName:null!==(a=null==g?void 0:g.RegionName)&&void 0!==a?a:"",userInitiatedDisasterRecoveryAllowed:null!==(c=null==p?void 0:p.UserInitiatedDisasterRecoveryAllowed)&&void 0!==c&&c,provisioningSourceType:null!==(d=null==u?void 0:u.ProvisioningSourceType)&&void 0!==d?d:""}})}populateAssignmentsFormArray(e){var t;this.assignmentGroupsFormArray.clear(),null===(t=null==e?void 0:e.map(e=>({...e,checked:!1})))||void 0===t||t.forEach(e=>this.assignmentGroupsFormArray.push(new k.NI(e),{emitEvent:!1})),this.initialFormValues=this.form.getRawValue()}}return e.\u0275fac=function(t){return new(t||e)(_["\u0275\u0275directiveInject"](C.X4l),_["\u0275\u0275directiveInject"](C.Gln),_["\u0275\u0275directiveInject"](T.G),_["\u0275\u0275directiveInject"](V),_["\u0275\u0275directiveInject"](C.quB),_["\u0275\u0275directiveInject"](_.ChangeDetectorRef))},e.\u0275cmp=_["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-manage-user-settings-dialog"]],inputs:{userSettings:"userSettings"},decls:17,vars:16,consts:[["nbSpinnerMessage","Saving...",3,"nbSpinner"],[3,"formGroup"],["tabTitle","Settings","badgePosition","center start","badgeStatus","danger",3,"badgeDot"],["settingsTab",""],[3,"form","tenants","cloudPcUserSettings"],["tabTitle","Assignments"],[3,"form","tenantId"],[1,"d-flex","justify-content-between"],["type","button","nbButton","",3,"disabled","click"]],template:function(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"nb-card",0),_["\u0275\u0275elementStart"](1,"nb-card-header"),_["\u0275\u0275text"](2),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](3,"nb-card-body"),_["\u0275\u0275elementStart"](4,"nb-tabset",1),_["\u0275\u0275elementStart"](5,"nb-tab",2,3),_["\u0275\u0275element"](7,"ngx-settings-tab",4),_["\u0275\u0275pipe"](8,"async"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](9,"nb-tab",5),_["\u0275\u0275element"](10,"ngx-assignments-tab",6),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](11,"nb-card-footer",7),_["\u0275\u0275elementStart"](12,"button",8),_["\u0275\u0275listener"]("click",function(){return t.close()}),_["\u0275\u0275text"](13,"Close"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](14,"button",8),_["\u0275\u0275listener"]("click",function(){return t.save()}),_["\u0275\u0275pipe"](15,"async"),_["\u0275\u0275text"](16),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]()),2&e){const e=_["\u0275\u0275reference"](6);let n;_["\u0275\u0275property"]("nbSpinner",t.isSaving),_["\u0275\u0275advance"](2),_["\u0275\u0275textInterpolate1"](" ",t.cloudPcUserSettings?"Update user settings":"Create user settings"," "),_["\u0275\u0275advance"](2),_["\u0275\u0275property"]("formGroup",t.form),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("badgeDot",!e.active&&(null==t.form.controls||null==t.form.controls.settings?null:t.form.controls.settings.invalid)),_["\u0275\u0275advance"](2),_["\u0275\u0275property"]("form",null==t.form.controls?null:t.form.controls.settings)("tenants",_["\u0275\u0275pipeBind1"](8,12,t.tenants$))("cloudPcUserSettings",t.cloudPcUserSettings),_["\u0275\u0275advance"](3),_["\u0275\u0275property"]("form",null==t.form.controls?null:t.form.controls.assignments)("tenantId",null==(n=t.form.get("settings.tenant"))?null:n.value),_["\u0275\u0275advance"](2),_["\u0275\u0275property"]("disabled",t.isSaving),_["\u0275\u0275advance"](2),_["\u0275\u0275property"]("disabled",t.form.invalid||t.isSaving||t.cloudPcUserSettings&&!_["\u0275\u0275pipeBind1"](15,14,t.hasFormChanges$)),_["\u0275\u0275advance"](2),_["\u0275\u0275textInterpolate1"](" ",t.cloudPcUserSettings?"Update":"Save"," ")}},styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]{width:80em;height:80vh}[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]   nb-card-body[_ngcontent-%COMP%]{overflow:hidden}[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]   nb-card-body[_ngcontent-%COMP%]   nb-tabset[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]   nb-card-body[_ngcontent-%COMP%]   nb-tabset[_ngcontent-%COMP%]   nb-tab[_ngcontent-%COMP%]{height:calc(100% - 2rem);overflow-y:auto}"],changeDetection:0}),e})();var H=n(60290),j=n(73544),q=n(84266);function z(e,t){1&e&&_["\u0275\u0275element"](0,"nb-spinner")}function B(e,t){if(1&e){const e=_["\u0275\u0275getCurrentView"]();_["\u0275\u0275elementStart"](0,"ngx-table-filter-trigger",18),_["\u0275\u0275listener"]("filtersChanges",function(t){return _["\u0275\u0275restoreView"](e),_["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),_["\u0275\u0275elementEnd"]()}if(2&e){const e=_["\u0275\u0275nextContext"](2);_["\u0275\u0275property"]("fieldPath",e.sortKeys.Tenant)("dataSource",e.allUserSettingsCache)}}function L(e,t){if(1&e){const e=_["\u0275\u0275getCurrentView"]();_["\u0275\u0275elementStart"](0,"ngx-table-filter-trigger",19),_["\u0275\u0275listener"]("filtersChanges",function(t){return _["\u0275\u0275restoreView"](e),_["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),_["\u0275\u0275elementEnd"]()}if(2&e){const e=_["\u0275\u0275nextContext"](2);_["\u0275\u0275property"]("dataSource",e.allUserSettingsCache)("extractSpecificValue",e.assignedValue)}}function W(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"td"),_["\u0275\u0275text"](1),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate"]((null==e.AssignmentsData?null:e.AssignmentsData.length)>0?"Yes":"No")}}function Q(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"td"),_["\u0275\u0275text"](1),_["\u0275\u0275pipe"](2,"date"),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate"](_["\u0275\u0275pipeBind2"](2,1,e.CloudPcUserSetting.LastModifiedDateTime,"short"))}}function K(e,t){if(1&e){const e=_["\u0275\u0275getCurrentView"]();_["\u0275\u0275elementStart"](0,"td",20),_["\u0275\u0275elementStart"](1,"nb-action",21),_["\u0275\u0275listener"]("click",function(){const t=_["\u0275\u0275restoreView"](e).$implicit;return _["\u0275\u0275nextContext"](2).openManageUserSettingsDialog(t)}),_["\u0275\u0275element"](2,"nb-icon",22),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]()}}function Y(e,t){if(1&e){const e=_["\u0275\u0275getCurrentView"]();_["\u0275\u0275elementContainerStart"](0),_["\u0275\u0275elementStart"](1,"ngx-data-table",1,2),_["\u0275\u0275listener"]("clearFiltersClick",function(){return _["\u0275\u0275restoreView"](e),_["\u0275\u0275nextContext"]().clearFilters()})("selectionChange",function(t){return _["\u0275\u0275restoreView"](e),_["\u0275\u0275nextContext"]().selectionChange(t)}),_["\u0275\u0275elementStart"](3,"div",3),_["\u0275\u0275elementStart"](4,"nb-actions",4),_["\u0275\u0275elementStart"](5,"nb-action",5),_["\u0275\u0275listener"]("click",function(){return _["\u0275\u0275restoreView"](e),_["\u0275\u0275nextContext"]().removeSelectedUserSettings()}),_["\u0275\u0275element"](6,"nb-icon",6),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](7,"nb-action",7),_["\u0275\u0275listener"]("click",function(){return _["\u0275\u0275restoreView"](e),_["\u0275\u0275nextContext"]().openManageUserSettingsDialog()}),_["\u0275\u0275element"](8,"nb-icon",8),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](9,"ngx-table-column",9),_["\u0275\u0275template"](10,B,1,2,"ng-template",null,10,_["\u0275\u0275templateRefExtractor"]),_["\u0275\u0275elementEnd"](),_["\u0275\u0275element"](12,"ngx-table-column",11),_["\u0275\u0275elementStart"](13,"ngx-table-column",12),_["\u0275\u0275template"](14,L,1,2,"ng-template",null,10,_["\u0275\u0275templateRefExtractor"]),_["\u0275\u0275template"](16,W,2,1,"ng-template",null,13,_["\u0275\u0275templateRefExtractor"]),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](18,"ngx-table-column",14),_["\u0275\u0275template"](19,Q,3,4,"ng-template",null,13,_["\u0275\u0275templateRefExtractor"]),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](21,"ngx-table-column",15),_["\u0275\u0275template"](22,K,3,0,"ng-template",null,13,_["\u0275\u0275templateRefExtractor"]),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](24,"button",16),_["\u0275\u0275listener"]("click",function(){return _["\u0275\u0275restoreView"](e),_["\u0275\u0275nextContext"]().update()}),_["\u0275\u0275element"](25,"nb-icon",17),_["\u0275\u0275text"](26," Update "),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=_["\u0275\u0275reference"](2),t=_["\u0275\u0275nextContext"]();_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("data",t.userSettings)("config",t.tableConfig)("columnFilters",t.filterState.columnFilters),_["\u0275\u0275advance"](4),_["\u0275\u0275propertyInterpolate"]("nbTooltip",e.hasSelection?"Delete":"Select at least one item to delete"),_["\u0275\u0275property"]("disabled",!e.hasSelection),_["\u0275\u0275advance"](4),_["\u0275\u0275property"]("sortable",!0)("searchable",!0),_["\u0275\u0275advance"](3),_["\u0275\u0275property"]("sortable",!0)("searchable",!0),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("sortable",!0),_["\u0275\u0275advance"](5),_["\u0275\u0275property"]("sortable",!0)}}const J={autoFocus:!0,closeOnEsc:!1,closeOnBackdropClick:!1,hasScroll:!1},X=[{path:"",component:(()=>{class e{constructor(e,t,n,r){this.userSettingsService=e,this.toastrService=t,this.cdr=n,this.dialogService=r,this.destroyed$=new i.xQ,this.selectedUserSettingsGroups={},this.userSettings$=new i.xQ,this.assignedValue=e=>{var t;return(null===(t=e.AssignmentsData)||void 0===t?void 0:t.length)>0?"Yes":"No"},this.filterState={searchQuery:"",columnFilters:{}},this.tableConfig={id:"UserSettings",search:{placeholder:"Search for user settings"},selectionKey:"IsSelected",sorting:{enabled:!0,defaultColumn:R.Tenant,defaultDirection:"asc"}},this.sortKeys=R,this.userSettings=[],this.allUserSettingsCache=[],this.isLoading=!1,this.retryApiCallWithToastCallback=e=>e.pipe((0,d.b)(e=>this.showDangerToast("Failure accessing the User Settings API",`Cannot read data from API. The message is: ${e.message} with status ${e.statusText}`)),(0,u.j)(()=>(0,l.H)(x.e5))),this.handleApiErrorCallback=e=>(0,s._)(()=>(this.showDangerToast("Failure accessing the API",`Cannot read data from API. Reload this site to try it again. The message is: ${e.message} with status ${e.statusText}`),(0,a.of)([])))}ngOnInit(){this.loadUserSettings()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}openManageUserSettingsDialog(e){const{onClose:t}=this.dialogService.open($,{context:{userSettings:e},...J});t.subscribe(e=>{(null==e?void 0:e.created)&&this.update()})}update(){this.userSettings$.next()}populateFiltersSet([e,t]){const n=e.filter(e=>e.checked).map(e=>e.label.toLowerCase());this.filterState={...this.filterState,columnFilters:{...this.filterState.columnFilters,[t]:n}},this.applyAllFilters()}clearFilters(){var e;this.filterState={...this.filterState,columnFilters:{}},null===(e=this.filterTriggers)||void 0===e||e.forEach(e=>e.resetAllFilters()),this.applyAllFilters()}selectionChange(e){const t=this.userSettings.filter(t=>e.includes(t.CloudPcUserSetting.Id));this.selectedUserSettingsGroups=t.reduce((e,t)=>{var n;return t.SceneId?{...e,[t.SceneId]:[...null!==(n=e[t.SceneId])&&void 0!==n?n:[],t.CloudPcUserSetting.Id]}:e},{})}removeSelectedUserSettings(){const e=Object.values(this.selectedUserSettingsGroups).flat().length;if(0===e)return;const{onClose:t}=this.dialogService.open(N.z,{context:{headerTitle:"Delete user settings?",bodyText:`Please confirm deletion of ${e} user setting(s)`,cancelButtonText:"Cancel",confirmButtonText:"Delete"},...J});t.pipe((0,m.q)(1),(0,p.h)(e=>!0===e),(0,g.w)(()=>this.processUserSettingsRemoval())).subscribe({next:()=>{this.update(),this.toastrService.success(`${e} user settings deleted`,"User setting deleted")},error:e=>this.toastrService.danger(e.message,"Error")})}loadUserSettings(){this.isLoading=!0,this.userSettings$.pipe((0,v.O)(0),(0,g.w)(()=>(0,l.H)(0,w.tc.autoRefreshDefault)),(0,g.w)(()=>this.userSettingsService.getUserSettings()),(0,f.a)(this.retryApiCallWithToastCallback),(0,h.K)(this.handleApiErrorCallback),(0,d.b)(e=>{const t=e.map(e=>{var t,n;return{...e,Id:null!==(n=null===(t=e.CloudPcUserSetting)||void 0===t?void 0:t.Id)&&void 0!==n?n:e.Id}});this.allUserSettingsCache=[...t],this.applyAllFilters()}),(0,b.R)(this.destroyed$)).subscribe(()=>{this.isLoading=!1,this.cdr.markForCheck()})}showDangerToast(e,t){this.toastrService.danger(t,e,{destroyByClick:!0,duration:2e4,hasIcon:!0,position:C.fe3.TOP_RIGHT,preventDuplicates:!0})}applyAllFilters(){let e=[...this.allUserSettingsCache];Object.keys(this.filterState.columnFilters).some(e=>{var t;return(null===(t=this.filterState.columnFilters[e])||void 0===t?void 0:t.length)>0})&&(e=this.applyColumnFilters(e)),this.userSettings=e,this.cdr.markForCheck()}applyColumnFilters(e){const t=Object.keys(this.filterState.columnFilters).filter(e=>{var t;return(null===(t=this.filterState.columnFilters[e])||void 0===t?void 0:t.length)>0});return t.length?e.filter(e=>t.every(t=>{var n;const r=this.filterState.columnFilters[t],o=null===(n=this.getTableCellValue(e,t))||void 0===n?void 0:n.toLowerCase();return r.includes(o)})):e}getTableCellValue(e,t){var n;switch(t){case"SceneName":return e.SceneName;case"IsAssigned":return(null===(n=e.AssignmentsData)||void 0===n?void 0:n.length)>0?"Yes":"No";default:return""}}processUserSettingsRemoval(){return(0,c.D)(Object.entries(this.selectedUserSettingsGroups)).pipe((0,S.b)(([e,t])=>this.userSettingsService.removeUserSettings(e,t)),(0,y.q)())}}return e.\u0275fac=function(t){return new(t||e)(_["\u0275\u0275directiveInject"](V),_["\u0275\u0275directiveInject"](C.quB),_["\u0275\u0275directiveInject"](_.ChangeDetectorRef),_["\u0275\u0275directiveInject"](C.Gln))},e.\u0275cmp=_["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-user-settings"]],viewQuery:function(e,t){if(1&e&&_["\u0275\u0275viewQuery"](E.m4,5),2&e){let e;_["\u0275\u0275queryRefresh"](e=_["\u0275\u0275loadQuery"]())&&(t.filterTriggers=e)}},decls:7,vars:2,consts:[[4,"ngIf"],[3,"data","config","columnFilters","clearFiltersClick","selectionChange"],["dataTable",""],["data-table-actions","",1,"d-flex","align-items-center"],["size","small"],["nbTooltipPlacement","top",3,"disabled","nbTooltip","click"],["icon","trash-2-outline"],[3,"click"],["icon","plus-outline"],["key","SceneName","label","Tenant",3,"sortable","searchable"],["headerFilter",""],["key","CloudPcUserSetting.DisplayName","label","Name",3,"sortable","searchable"],["key","AssignmentsData","label","Assigned",3,"sortable"],["cell",""],["key","CloudPcUserSetting.LastModifiedDateTime","label","Last updated",3,"sortable"],["key","actions","label","Edit"],["type","button","nbButton","","status","semi-round",3,"click"],["icon","refresh"],["filterName","SceneName",3,"fieldPath","dataSource","filtersChanges"],["filterName","IsAssigned",3,"dataSource","extractSpecificValue","filtersChanges"],[1,"text-center","align-middle"],["nbTooltip","Edit user setting",1,"d-inline","c-pointer",3,"click"],["icon","settings-2-outline"]],template:function(e,t){1&e&&(_["\u0275\u0275elementStart"](0,"nb-card"),_["\u0275\u0275elementStart"](1,"nb-card-header"),_["\u0275\u0275elementStart"](2,"h1"),_["\u0275\u0275text"](3,"User Settings"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](4,"nb-card-body"),_["\u0275\u0275template"](5,z,1,0,"nb-spinner",0),_["\u0275\u0275template"](6,Y,27,11,"ng-container",0),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]()),2&e&&(_["\u0275\u0275advance"](5),_["\u0275\u0275property"]("ngIf",t.isLoading),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",!t.isLoading))},directives:[C.Asz,C.ndF,C.yKW,r.O5,C.Tzq,H.Q,C.lYD,C.Bk3,C.jNv,C.fMN,j.U,C.DPz,q.m],pipes:[r.uU],styles:["[_nghost-%COMP%]{height:100%}[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   nb-actions[_ngcontent-%COMP%]   nb-action[_ngcontent-%COMP%]:not(.disabled){cursor:pointer}"],changeDetection:0}),e})()}];let Z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=_["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=_["\u0275\u0275defineInjector"]({imports:[[o.Bz.forChild(X)],o.Bz]}),e})();var ee=n(14171),te=n(88100);function ne(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"nb-option",31),_["\u0275\u0275text"](1),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;_["\u0275\u0275property"]("value",e.Id),_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate1"](" ",e.DisplayName," ")}}function re(e,t){1&e&&(_["\u0275\u0275elementContainerStart"](0),_["\u0275\u0275elementStart"](1,"span",32),_["\u0275\u0275text"](2,"This field is required"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementContainerEnd"]())}function oe(e,t){1&e&&(_["\u0275\u0275elementContainerStart"](0),_["\u0275\u0275elementStart"](1,"span",32),_["\u0275\u0275text"](2,"This field is required"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementContainerEnd"]())}function ie(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"nb-option",31),_["\u0275\u0275text"](1),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;_["\u0275\u0275property"]("value",e.value),_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function le(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"nb-option",31),_["\u0275\u0275text"](1),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;_["\u0275\u0275property"]("value",e.value),_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function se(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"nb-option",42),_["\u0275\u0275text"](1),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=_["\u0275\u0275nextContext"](4);_["\u0275\u0275property"]("value",e.value)("disabled",e.value===n.CloudPcDisasterRecoveryNetworkType.AzureNetworkConnection),_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function ae(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"div",3),_["\u0275\u0275elementStart"](1,"div",4),_["\u0275\u0275elementStart"](2,"label",38),_["\u0275\u0275text"](3,"Network Type"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275element"](4,"nb-icon",39),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](5,"div",7),_["\u0275\u0275elementStart"](6,"nb-select",40),_["\u0275\u0275template"](7,se,2,3,"nb-option",41),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]()),2&e){const e=_["\u0275\u0275nextContext"](3);_["\u0275\u0275advance"](7),_["\u0275\u0275property"]("ngForOf",e.networkTypeOptions)}}function ce(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"nb-option",31),_["\u0275\u0275text"](1),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;_["\u0275\u0275property"]("value",e.value),_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function de(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"nb-option",31),_["\u0275\u0275text"](1),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;_["\u0275\u0275property"]("value",e.value),_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function ue(e,t){if(1&e&&(_["\u0275\u0275elementContainerStart"](0),_["\u0275\u0275elementStart"](1,"div",3),_["\u0275\u0275elementStart"](2,"div",4),_["\u0275\u0275elementStart"](3,"label",43),_["\u0275\u0275elementStart"](4,"span",6),_["\u0275\u0275text"](5,"*"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](6,"span"),_["\u0275\u0275text"](7,"Geography"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](8,"div",7),_["\u0275\u0275elementStart"](9,"nb-select",44),_["\u0275\u0275template"](10,ce,2,2,"nb-option",9),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](11,"div",3),_["\u0275\u0275elementStart"](12,"div",4),_["\u0275\u0275elementStart"](13,"label",45),_["\u0275\u0275elementStart"](14,"span",6),_["\u0275\u0275text"](15,"*"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](16,"span"),_["\u0275\u0275text"](17,"Region"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](18,"div",7),_["\u0275\u0275elementStart"](19,"nb-select",46),_["\u0275\u0275template"](20,de,2,2,"nb-option",9),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementContainerEnd"]()),2&e){const e=_["\u0275\u0275nextContext"](3);_["\u0275\u0275advance"](9),_["\u0275\u0275property"]("nbSpinner",(null==e.form||null==e.form.controls||null==e.form.controls.tenant?null:e.form.controls.tenant.value)&&(null==e.form||null==e.form.controls||null==e.form.controls.disasterRecoveryType?null:e.form.controls.disasterRecoveryType.value)!==e.CloudPcDisasterRecoveryType.NotConfigured&&!e.regionGroupOptions.length)("placeholder",null!=e.form&&null!=e.form.controls&&null!=e.form.controls.tenant&&e.form.controls.tenant.value?"Select one":"Select tenant first"),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngForOf",e.regionGroupOptions),_["\u0275\u0275advance"](9),_["\u0275\u0275property"]("nbSpinner",(null==e.form||null==e.form.controls||null==e.form.controls.regionGroup?null:e.form.controls.regionGroup.value)&&!e.regionNameOptions.length)("placeholder",null!=e.form&&null!=e.form.controls&&null!=e.form.controls.regionGroup&&e.form.controls.regionGroup.value?"Select one":"Select geography first"),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngForOf",e.regionNameOptions)}}function me(e,t){1&e&&(_["\u0275\u0275elementStart"](0,"div",3),_["\u0275\u0275elementStart"](1,"div",4),_["\u0275\u0275elementStart"](2,"label",13),_["\u0275\u0275text"](3,"Allow user to initiate Disaster Recovery Plus service"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](4,"div",15),_["\u0275\u0275element"](5,"nb-checkbox",47),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]())}function pe(e,t){if(1&e&&(_["\u0275\u0275elementContainerStart"](0),_["\u0275\u0275elementStart"](1,"p",19),_["\u0275\u0275text"](2," Protect Cloud PCs during regional outages. Purchase and assign optional disaster recovery licenses before configuring. Disaster Recovery Plus cannot be configured for Frontline Cloud PCs. Optional disaster recovery cannot be configured for Government Cloud PCs. "),_["\u0275\u0275elementStart"](3,"a",33),_["\u0275\u0275text"](4,"Learn more about optional Business Continuity and Disaster Recovery"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275text"](5,". "),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](6,"div",3),_["\u0275\u0275elementStart"](7,"div",4),_["\u0275\u0275elementStart"](8,"label",34),_["\u0275\u0275text"](9,"Enable additional DR for this user setting"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275element"](10,"nb-icon",35),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](11,"div",7),_["\u0275\u0275elementStart"](12,"nb-select",36),_["\u0275\u0275template"](13,le,2,2,"nb-option",9),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275template"](14,ae,8,1,"div",37),_["\u0275\u0275template"](15,ue,21,6,"ng-container",10),_["\u0275\u0275template"](16,me,6,0,"div",37),_["\u0275\u0275elementContainerEnd"]()),2&e){const e=_["\u0275\u0275nextContext"](2);_["\u0275\u0275advance"](13),_["\u0275\u0275property"]("ngForOf",e.disasterRecoveryOptions),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",(null==e.form||null==e.form.controls||null==e.form.controls.disasterRecoveryType?null:e.form.controls.disasterRecoveryType.value)!==e.CloudPcDisasterRecoveryType.NotConfigured),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",(null==e.form||null==e.form.controls||null==e.form.controls.disasterRecoveryType?null:e.form.controls.disasterRecoveryType.value)!==e.CloudPcDisasterRecoveryType.NotConfigured&&(null==e.form||null==e.form.controls||null==e.form.controls.networkType?null:e.form.controls.networkType.value)===e.CloudPcDisasterRecoveryNetworkType.MicrosoftHostedNetwork),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",(null==e.form||null==e.form.controls||null==e.form.controls.disasterRecoveryType?null:e.form.controls.disasterRecoveryType.value)===e.CloudPcDisasterRecoveryType.Premium)}}function ge(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"nb-option",31),_["\u0275\u0275text"](1),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;_["\u0275\u0275property"]("value",e.value),_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function ve(e,t){if(1&e){const e=_["\u0275\u0275getCurrentView"]();_["\u0275\u0275elementContainerStart"](0,1),_["\u0275\u0275elementStart"](1,"h6",2),_["\u0275\u0275text"](2,"General"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](3,"div",3),_["\u0275\u0275elementStart"](4,"div",4),_["\u0275\u0275elementStart"](5,"label",5),_["\u0275\u0275elementStart"](6,"span",6),_["\u0275\u0275text"](7,"*"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](8,"span"),_["\u0275\u0275text"](9,"Tenant"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](10,"div",7),_["\u0275\u0275elementStart"](11,"nb-select",8),_["\u0275\u0275template"](12,ne,2,2,"nb-option",9),_["\u0275\u0275elementEnd"](),_["\u0275\u0275template"](13,re,3,0,"ng-container",10),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](14,"div",3),_["\u0275\u0275elementStart"](15,"div",4),_["\u0275\u0275elementStart"](16,"label",11),_["\u0275\u0275elementStart"](17,"span",6),_["\u0275\u0275text"](18,"*"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](19,"span"),_["\u0275\u0275text"](20,"Name"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](21,"div",7),_["\u0275\u0275element"](22,"input",12),_["\u0275\u0275template"](23,oe,3,0,"ng-container",10),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](24,"div",3),_["\u0275\u0275elementStart"](25,"div",4),_["\u0275\u0275elementStart"](26,"label",13),_["\u0275\u0275text"](27,"Enable Local admin"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275element"](28,"nb-icon",14),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](29,"div",15),_["\u0275\u0275element"](30,"nb-checkbox",16),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](31,"div",3),_["\u0275\u0275elementStart"](32,"div",4),_["\u0275\u0275elementStart"](33,"label",13),_["\u0275\u0275text"](34,"Enable users to reset their Cloud PCs"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275element"](35,"nb-icon",17),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](36,"div",15),_["\u0275\u0275element"](37,"nb-checkbox",18),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](38,"h6",2),_["\u0275\u0275text"](39,"Point-in-time restore service"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](40,"p",19),_["\u0275\u0275text"](41," Restore a user\u2019s Cloud PC to a backup taken at a specific point in time. Users will lose any data stored on the Cloud PC disk between the current time and the recovery point. "),_["\u0275\u0275elementStart"](42,"a",20),_["\u0275\u0275text"](43,"Learn more"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275text"](44,". "),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](45,"div",3),_["\u0275\u0275elementStart"](46,"div",4),_["\u0275\u0275elementStart"](47,"label",13),_["\u0275\u0275text"](48,"Allow user to initiate restore service"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275element"](49,"nb-icon",21),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](50,"div",15),_["\u0275\u0275element"](51,"nb-checkbox",22),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](52,"div",3),_["\u0275\u0275elementStart"](53,"div",4),_["\u0275\u0275elementStart"](54,"label",23),_["\u0275\u0275text"](55,"Frequency of restore-point service"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275element"](56,"nb-icon",24),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](57,"div",7),_["\u0275\u0275elementStart"](58,"nb-select",25),_["\u0275\u0275template"](59,ie,2,2,"nb-option",9),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275element"](60,"hr",26),_["\u0275\u0275elementStart"](61,"h6",27),_["\u0275\u0275listener"]("click",function(){_["\u0275\u0275restoreView"](e);const t=_["\u0275\u0275nextContext"]();return t.isDisasterRecoveryExpanded=!t.isDisasterRecoveryExpanded}),_["\u0275\u0275element"](62,"nb-icon",28),_["\u0275\u0275text"](63," Optional Business Continuity and Disaster Recovery "),_["\u0275\u0275elementEnd"](),_["\u0275\u0275template"](64,pe,17,4,"ng-container",10),_["\u0275\u0275elementStart"](65,"h6",2),_["\u0275\u0275text"](66,"Provisioning source type"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](67,"div",19),_["\u0275\u0275elementStart"](68,"ul"),_["\u0275\u0275elementStart"](69,"li"),_["\u0275\u0275elementStart"](70,"b"),_["\u0275\u0275text"](71,"Default"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275text"](72,": use the image from the provisioning policy."),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](73,"li"),_["\u0275\u0275elementStart"](74,"b"),_["\u0275\u0275text"](75,"From Snapshot"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275text"](76,": use an uploaded personal image if available. Provisioning fails if no snapshot exists for the user. "),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](77,"div",3),_["\u0275\u0275elementStart"](78,"div",4),_["\u0275\u0275elementStart"](79,"label",29),_["\u0275\u0275text"](80,"Type"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](81,"div",7),_["\u0275\u0275elementStart"](82,"nb-select",30),_["\u0275\u0275template"](83,ge,2,2,"nb-option",9),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=_["\u0275\u0275nextContext"]();_["\u0275\u0275property"]("formGroup",e.form),_["\u0275\u0275advance"](11),_["\u0275\u0275property"]("nbSpinner",!(null!=e.tenants&&e.tenants.length)),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngForOf",e.tenants),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",(null==e.form||null==e.form.controls||null==e.form.controls.tenant||null==e.form.controls.tenant.errors?null:e.form.controls.tenant.errors.required)&&(null==e.form||null==e.form.controls||null==e.form.controls.tenant?null:e.form.controls.tenant.touched)),_["\u0275\u0275advance"](10),_["\u0275\u0275property"]("ngIf",(null==e.form||null==e.form.controls||null==e.form.controls.displayName||null==e.form.controls.displayName.errors?null:e.form.controls.displayName.errors.required)&&(null==e.form||null==e.form.controls||null==e.form.controls.displayName?null:e.form.controls.displayName.touched)),_["\u0275\u0275advance"](36),_["\u0275\u0275property"]("ngForOf",e.frequencyOptions),_["\u0275\u0275advance"](3),_["\u0275\u0275property"]("icon",e.isDisasterRecoveryExpanded?"chevron-down-outline":"chevron-right-outline"),_["\u0275\u0275advance"](2),_["\u0275\u0275property"]("ngIf",e.isDisasterRecoveryExpanded),_["\u0275\u0275advance"](19),_["\u0275\u0275property"]("ngForOf",e.provisioningSourceTypeOptions)}}let fe=(()=>{class e{constructor(e,t){this.wd365Service=e,this.cdr=t,this.destroyed$=new i.xQ,this.supportedRegions=[],this.prevFormValue=null,this.tenants=[],this.isDisasterRecoveryExpanded=!1,this.regionGroupOptions=[],this.regionNameOptions=[],this.CloudPcDisasterRecoveryNetworkType=F,this.CloudPcDisasterRecoveryType=O,this.frequencyOptions=[{value:A.Hours4,label:"4 hours"},{value:A.Hours6,label:"6 hours"},{value:A.Hours12,label:"12 hours"},{value:A.Hours16,label:"16 hours"},{value:A.Hours24,label:"24 hours"}],this.disasterRecoveryOptions=[{value:O.NotConfigured,label:"None"},{value:O.CrossRegion,label:"Cross Region Disaster Recovery"},{value:O.Premium,label:"Disaster Recovery Plus"}],this.networkTypeOptions=[{value:F.MicrosoftHostedNetwork,label:"Microsoft Hosted Network"},{value:F.AzureNetworkConnection,label:"Azure Network Connection (An upcoming feature - stay tuned)"}],this.provisioningSourceTypeOptions=[{value:"",label:"Default"},{value:D.Image,label:"Image"},{value:D.Snapshot,label:"Snapshot"}]}setupFormSubscriptions(){var e,t;this.prevFormValue=null===(e=this.form)||void 0===e?void 0:e.getRawValue(),null===(t=this.form)||void 0===t||t.valueChanges.pipe((0,b.R)(this.destroyed$)).subscribe(e=>{var t,n,r,o;(null===(t=this.prevFormValue)||void 0===t?void 0:t.tenant)!==e.tenant&&this.onTenantChange(),(null===(n=this.prevFormValue)||void 0===n?void 0:n.regionGroup)!==e.regionGroup&&this.onRegionGroupChange(e.regionGroup),(null===(r=this.prevFormValue)||void 0===r?void 0:r.disasterRecoveryType)!==e.disasterRecoveryType&&this.onDisasterRecoveryTypeChange(),(null===(o=this.prevFormValue)||void 0===o?void 0:o.networkType)!==e.networkType&&this.onNetworkTypeChange(),this.prevFormValue=e}),this.initializeFormState()}onTenantChange(){this.loadRegionsIfNeeded(),this.updateRegionDisabledState()}onRegionGroupChange(e){var t,n;this.updateRegionNameOptions(e),null===(n=null===(t=this.form)||void 0===t?void 0:t.get("regionName"))||void 0===n||n.reset("",{emitEvent:!1}),this.updateRegionDisabledState()}onDisasterRecoveryTypeChange(){var e,t,n,r,o,i;null===(t=null===(e=this.form)||void 0===e?void 0:e.get("networkType"))||void 0===t||t.reset(F.MicrosoftHostedNetwork,{emitEvent:!1}),null===(r=null===(n=this.form)||void 0===n?void 0:n.get("regionGroup"))||void 0===r||r.reset("",{emitEvent:!1}),null===(i=null===(o=this.form)||void 0===o?void 0:o.get("regionName"))||void 0===i||i.reset("",{emitEvent:!1}),this.updateRegionValidators(),this.updateRegionDisabledState(),this.loadRegionsIfNeeded()}onNetworkTypeChange(){this.updateRegionValidators()}initializeFormState(){var e,t;this.cloudPcUserSettings&&(null===(t=null===(e=this.form)||void 0===e?void 0:e.get("tenant"))||void 0===t||t.disable({emitEvent:!1})),this.updateRegionValidators(),this.updateRegionDisabledState(),this.loadRegionsIfNeeded()}updateRegionDisabledState(){var e,t,n,r,o,i;const l=null===(e=this.form)||void 0===e?void 0:e.get("regionGroup"),s=null===(t=this.form)||void 0===t?void 0:t.get("regionName"),a=!!(null===(r=null===(n=this.form)||void 0===n?void 0:n.get("tenant"))||void 0===r?void 0:r.value),c=!!(null===(i=null===(o=this.form)||void 0===o?void 0:o.get("regionGroup"))||void 0===i?void 0:i.value);a?null==l||l.enable({emitEvent:!1}):null==l||l.disable({emitEvent:!1}),c?null==s||s.enable({emitEvent:!1}):null==s||s.disable({emitEvent:!1})}loadRegionsIfNeeded(){var e,t,n,r;const o=null===(t=null===(e=this.form)||void 0===e?void 0:e.get("tenant"))||void 0===t?void 0:t.value,i=null===(r=null===(n=this.form)||void 0===n?void 0:n.get("disasterRecoveryType"))||void 0===r?void 0:r.value;o&&i!==O.NotConfigured&&0===this.regionGroupOptions.length&&this.loadSupportedRegions(o)}ngOnInit(){this.setupFormSubscriptions(),this.expandDRSectionIfConfigured()}expandDRSectionIfConfigured(){var e,t;(null===(t=null===(e=this.form)||void 0===e?void 0:e.get("disasterRecoveryType"))||void 0===t?void 0:t.value)!==O.NotConfigured&&(this.isDisasterRecoveryExpanded=!0)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}loadSupportedRegions(e){this.wd365Service.getSupportedRegions(e).pipe((0,b.R)(this.destroyed$)).subscribe(e=>{var t,n;this.supportedRegions=e,this.regionGroupOptions=e.map(e=>({value:e.GeographyName,label:e.GeographyName})),this.cdr.markForCheck();const r=null===(n=null===(t=this.form)||void 0===t?void 0:t.get("regionGroup"))||void 0===n?void 0:n.value;r&&this.updateRegionNameOptions(r)})}updateRegionNameOptions(e){var t;const n=this.supportedRegions.find(t=>t.GeographyName===e);this.regionNameOptions=null!==(t=null==n?void 0:n.Regions.map(e=>({value:e.Name,label:e.Name})))&&void 0!==t?t:[],this.cdr.markForCheck()}updateRegionValidators(){var e,t,n,r,o,i;const l=null===(t=null===(e=this.form)||void 0===e?void 0:e.get("disasterRecoveryType"))||void 0===t?void 0:t.value,s=null===(r=null===(n=this.form)||void 0===n?void 0:n.get("networkType"))||void 0===r?void 0:r.value,a=null===(o=this.form)||void 0===o?void 0:o.get("regionGroup"),c=null===(i=this.form)||void 0===i?void 0:i.get("regionName");l!==O.NotConfigured&&s===F.MicrosoftHostedNetwork?(null==a||a.setValidators(k.kI.required),null==c||c.setValidators(k.kI.required)):(null==a||a.clearValidators(),null==c||c.clearValidators()),null==a||a.updateValueAndValidity({emitEvent:!1}),null==c||c.updateValueAndValidity({emitEvent:!1})}}return e.\u0275fac=function(t){return new(t||e)(_["\u0275\u0275directiveInject"](T.G),_["\u0275\u0275directiveInject"](_.ChangeDetectorRef))},e.\u0275cmp=_["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-settings-tab"]],inputs:{form:"form",tenants:"tenants",cloudPcUserSettings:"cloudPcUserSettings"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"section-title"],[1,"form-group","row"],[1,"col-md-3","d-flex","align-items-center"],["for","tenant",1,"label"],[1,"asterisk"],[1,"col-md-9"],["id","tenant","fullWidth","","placeholder","Select Tenant","formControlName","tenant",3,"nbSpinner"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["for","displayName",1,"label"],["id","displayName","type","text","nbInput","","fullWidth","","formControlName","displayName","placeholder","Enter a name"],[1,"label"],["icon","info-outline","nbTooltip","Makes the end user a local administrator on all of their Cloud PCs."],[1,"col-md-9","d-flex","align-items-center"],["formControlName","localAdminEnabled"],["icon","info-outline","nbTooltip","Allows targeted users to reprovision their Cloud PC from the Windows 365 app or web app."],["formControlName","resetEnabled"],[1,"label","section-description"],["href","https://learn.microsoft.com/en-us/windows-365/enterprise/restore-overview","target","_blank","rel","noopener"],["icon","info-outline","nbTooltip","Allow users to start their own point-in-time restore for supported Cloud PCs."],["formControlName","userRestoreEnabled"],["for","frequencyInHours",1,"label"],["icon","info-outline","nbTooltip","Choose how often Windows 365 creates restore points for eligible Cloud PCs."],["id","frequencyInHours","fullWidth","","formControlName","frequencyInHours"],[1,"section-divider"],[1,"section-title","collapsible-title",3,"click"],[3,"icon"],["for","provisioningSourceType",1,"label"],["id","provisioningSourceType","fullWidth","","formControlName","provisioningSourceType"],[3,"value"],[1,"form-control-error"],["href","https://learn.microsoft.com/en-us/windows-365/enterprise/cross-region-disaster-recovery","target","_blank","rel","noopener"],["for","disasterRecoveryType",1,"label"],["icon","info-outline","nbTooltip","Adds extra resilience for Cloud PCs. Additional licenses may be required."],["id","disasterRecoveryType","fullWidth","","formControlName","disasterRecoveryType"],["class","form-group row",4,"ngIf"],["for","networkType",1,"label"],["icon","info-outline","nbTooltip","Select the network type for disaster recovery."],["id","networkType","fullWidth","","formControlName","networkType"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"],["for","regionGroup",1,"label"],["id","regionGroup","fullWidth","","formControlName","regionGroup",3,"nbSpinner","placeholder"],["for","regionName",1,"label"],["id","regionName","fullWidth","","formControlName","regionName",3,"nbSpinner","placeholder"],["formControlName","userInitiatedDisasterRecoveryAllowed"]],template:function(e,t){1&e&&_["\u0275\u0275template"](0,ve,84,9,"ng-container",0),2&e&&_["\u0275\u0275property"]("ngIf",t.form)},directives:[r.O5,k.JL,k.sg,C.rs,k.JJ,k.u,C.Q7R,r.sg,C.h8i,k.Fj,C.fMN,C.jNv,C.NTf,C.q51],styles:["[_nghost-%COMP%]   .form-group[_ngcontent-%COMP%]   .col-md-3[_ngcontent-%COMP%]{grid-gap:.5rem;gap:.5rem}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{margin-bottom:0}[_nghost-%COMP%]   .asterisk[_ngcontent-%COMP%]{color:var(--danger);margin-right:.5em}[_nghost-%COMP%]   .form-control-error[_ngcontent-%COMP%]{font-size:.8em;color:var(--danger)}[_nghost-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:.8125rem;font-weight:600;color:#101426}[_nghost-%COMP%]   .collapsible-title[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;grid-gap:.5rem;gap:.5rem}[_nghost-%COMP%]   .collapsible-title[_ngcontent-%COMP%]:hover{opacity:.8}[_nghost-%COMP%]   .collapsible-title[_ngcontent-%COMP%]   nb-icon[_ngcontent-%COMP%]{font-size:1rem}[_nghost-%COMP%]   .section-description[_ngcontent-%COMP%]{margin-bottom:1rem;line-height:1.5rem}[_nghost-%COMP%]   .section-description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary)}[_nghost-%COMP%]   .section-divider[_ngcontent-%COMP%]{border:none;border-top:1px solid #edf1f7;margin:1rem 0}"],changeDetection:0}),e})();var he=n(5992),be=n(20521);function Se(e,t){1&e&&(_["\u0275\u0275elementStart"](0,"nb-alert",2),_["\u0275\u0275text"](1," Select a tenant before assigning groups.\n"),_["\u0275\u0275elementEnd"]())}function ye(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"span",16),_["\u0275\u0275text"](1),_["\u0275\u0275elementEnd"]()),2&e){const e=_["\u0275\u0275nextContext"]().$implicit;_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate"](e.value.Upn)}}function Ce(e,t){if(1&e){const e=_["\u0275\u0275getCurrentView"]();_["\u0275\u0275elementStart"](0,"nb-list-item",14),_["\u0275\u0275elementStart"](1,"nb-checkbox",15),_["\u0275\u0275listener"]("checkedChange",function(t){const n=_["\u0275\u0275restoreView"](e).$implicit;return _["\u0275\u0275nextContext"](3).selectOne(n,t)}),_["\u0275\u0275elementStart"](2,"span",16),_["\u0275\u0275text"](3),_["\u0275\u0275elementEnd"](),_["\u0275\u0275template"](4,ye,2,1,"span",17),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](5,"button",18),_["\u0275\u0275listener"]("click",function(){const t=_["\u0275\u0275restoreView"](e).index;return _["\u0275\u0275nextContext"](3).remove(t)}),_["\u0275\u0275element"](6,"nb-icon",6),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("checked",e.value.checked),_["\u0275\u0275advance"](2),_["\u0275\u0275textInterpolate"](e.value.DisplayName),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",e.value.Upn)}}function Ee(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"nb-list",12),_["\u0275\u0275template"](1,Ce,7,3,"nb-list-item",13),_["\u0275\u0275elementEnd"]()),2&e){const e=_["\u0275\u0275nextContext"](2);_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngForOf",e.assignmentGroupsFormArray.controls)("ngForTrackBy",e.trackByIndex)}}function xe(e,t){1&e&&(_["\u0275\u0275elementStart"](0,"div",19),_["\u0275\u0275elementStart"](1,"span",20),_["\u0275\u0275text"](2,"No groups selected"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]())}function we(e,t){if(1&e){const e=_["\u0275\u0275getCurrentView"]();_["\u0275\u0275elementStart"](0,"div",3),_["\u0275\u0275elementStart"](1,"ngx-directory-object-typehead",4),_["\u0275\u0275listener"]("selectionChanged",function(t){return _["\u0275\u0275restoreView"](e),_["\u0275\u0275nextContext"]().selectionChanged(t)}),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](2,"button",5),_["\u0275\u0275listener"]("click",function(){return _["\u0275\u0275restoreView"](e),_["\u0275\u0275nextContext"]().removeSelected()}),_["\u0275\u0275element"](3,"nb-icon",6),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](4,"div",7),_["\u0275\u0275elementStart"](5,"nb-checkbox",8),_["\u0275\u0275listener"]("checkedChange",function(t){return _["\u0275\u0275restoreView"](e),_["\u0275\u0275nextContext"]().selectAll(t)}),_["\u0275\u0275text"](6),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](7,"div",9),_["\u0275\u0275template"](8,Ee,2,2,"nb-list",10),_["\u0275\u0275elementEnd"](),_["\u0275\u0275template"](9,xe,3,0,"ng-template",null,11,_["\u0275\u0275templateRefExtractor"]),_["\u0275\u0275elementEnd"]()}if(2&e){const e=_["\u0275\u0275reference"](10),t=_["\u0275\u0275nextContext"]();_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("tenantViewSceneId",t.tenantId)("multi",!0)("type",t.DirectoryObjectTypeEnum.Groups),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("disabled",!t.isIndeterminate&&!t.areAllSelected),_["\u0275\u0275advance"](3),_["\u0275\u0275property"]("disabled",!t.assignmentGroupsFormArray.length)("checked",t.areAllSelected)("indeterminate",t.isIndeterminate),_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate1"](" ",t.areAllSelected?"Deselect all":"Select all"," "),_["\u0275\u0275advance"](2),_["\u0275\u0275property"]("ngIf",t.assignmentGroupsFormArray.length)("ngIfElse",e)}}let Re=(()=>{class e{constructor(){this.DirectoryObjectTypeEnum=he.W,this.trackByIndex=e=>e}get assignmentGroupsFormArray(){var e;return null===(e=this.form)||void 0===e?void 0:e.get("groups")}get areAllSelected(){var e;const t=this.assignmentGroupsFormArray.controls.every(e=>e.value.checked);return!(!(null===(e=this.assignmentGroupsFormArray)||void 0===e?void 0:e.length)||!t)}get isIndeterminate(){var e;if(!(null===(e=this.assignmentGroupsFormArray)||void 0===e?void 0:e.length))return!1;const t=this.assignmentGroupsFormArray.controls.filter(e=>e.value.checked).length;return t>0&&t<this.assignmentGroupsFormArray.length}selectionChanged(e){const t=new Set(this.assignmentGroupsFormArray.value.map(e=>e.Id));e.filter(e=>!t.has(e.Id)).forEach(e=>this.assignmentGroupsFormArray.push(new k.NI({...e,checked:!1})))}removeSelected(){for(let e=this.assignmentGroupsFormArray.length-1;e>=0;e--)this.assignmentGroupsFormArray.at(e).value.checked&&this.remove(e)}selectAll(e){this.assignmentGroupsFormArray.controls.forEach(t=>t.setValue({...t.value,checked:e},{emitEvent:!1}))}selectOne(e,t){e.setValue({...e.value,checked:t},{emitEvent:!1})}remove(e){this.assignmentGroupsFormArray.removeAt(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=_["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-assignments-tab"]],inputs:{tenantId:"tenantId",form:"form"},decls:3,vars:2,consts:[["status","danger",4,"ngIf","ngIfElse"],["viewTpl",""],["status","danger"],[1,"assignments-tab-header"],["label","Search for groups by name (min. 3 characters)","placeholder","Start typing to assign groups to the selected tenant.","multiSelectButtonLabel","Add groups",3,"tenantViewSceneId","multi","type","selectionChanged"],["nbButton","",3,"disabled","click"],["icon","trash-2-outline"],[1,"assignments-tab-body","mt-4"],[1,"select-all-checkbox",3,"disabled","checked","indeterminate","checkedChange"],[1,"scrollable-container"],["class","mt-2",4,"ngIf","ngIfElse"],["noDataTpl",""],[1,"mt-2"],["class","d-flex justify-content-between",4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","justify-content-between"],[1,"d-flex","flex-column",3,"checked","checkedChange"],[1,"d-flex"],["class","d-flex",4,"ngIf"],["nbButton","","size","tiny","status","danger",3,"click"],[1,"no-data-container","d-flex","align-items-center","justify-content-center","mt-5"],[1,"text-muted"]],template:function(e,t){if(1&e&&(_["\u0275\u0275template"](0,Se,2,0,"nb-alert",0),_["\u0275\u0275template"](1,we,11,10,"ng-template",null,1,_["\u0275\u0275templateRefExtractor"])),2&e){const e=_["\u0275\u0275reference"](2);_["\u0275\u0275property"]("ngIf",!t.tenantId)("ngIfElse",e)}},directives:[r.O5,C.$9b,be.B,C.DPz,C.fMN,C.NTf,C.zP_,r.sg,C.qBV],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:hidden}[_nghost-%COMP%]   .assignments-tab-header[_ngcontent-%COMP%]{display:flex;align-items:flex-end;justify-content:space-between;grid-gap:1em;gap:1em}[_nghost-%COMP%]   .assignments-tab-body[_ngcontent-%COMP%]{height:calc(100% - 5rem)}[_nghost-%COMP%]   .assignments-tab-body[_ngcontent-%COMP%]   .select-all-checkbox[_ngcontent-%COMP%]{padding:.5em}[_nghost-%COMP%]   .assignments-tab-body[_ngcontent-%COMP%]   .scrollable-container[_ngcontent-%COMP%]{height:calc(100% - 3rem);overflow:auto}[_nghost-%COMP%]   .assignments-tab-body[_ngcontent-%COMP%]   nb-list[_ngcontent-%COMP%]   nb-list-item[_ngcontent-%COMP%]{padding:.5em;min-height:4.063em}"],changeDetection:0}),e})();var ke=n(77194);let Ie=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=_["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=_["\u0275\u0275defineInjector"]({imports:[[r.ez,Z,C.MAY,C.zyh,C.uuI,C.T2N,C.KdK,C.rgH,C.spT,ee.tA,E.H8,te.Z,C.EoG,k.UX,ke.e7,C.MfT,C.PYG,C.COg,C.IIj,C.nKr]]}),e})();_["\u0275\u0275setComponentScope"]($,[C.Asz,C.Q7R,C.ndF,C.yKW,C.kyn,k.JL,k.sg,C.TR4,fe,Re,C.XWE,C.DPz],[r.Ov])}}]);