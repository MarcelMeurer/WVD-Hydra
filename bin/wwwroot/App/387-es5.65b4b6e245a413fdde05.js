!function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function t(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkngx_admin=self.webpackChunkngx_admin||[]).push([[387],{12387:function(e,a,r){"use strict";r.r(a),r.d(a,{AzureResourcesModule:function(){return be}});var i=r(3679),o=r(38583),s=r(9857),l=r(69517),c=r(66911),d=r(99763),h=r(37716),u=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-azure-resources"]],decls:1,vars:0,template:function(e,t){1&e&&h["\u0275\u0275element"](0,"router-outlet")},directives:[d.lC],styles:[""]}),e}(),p=r(79765),m=r(46797),f=r(25917),g=r(39761),v=r(5304),S=r(43190),b=r(67666),y=r(68307),C=r(11627),x=r(11173),w=r(91841),I=r(69167),M=r(27861),P=r(85902),O=["dialog"];function E(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"p"),h["\u0275\u0275text"](1,"You can configure file shares to receive alerts or to automatically increase and decrease the provisioned storage (decreasing happens only once a day). The shares are validated each hour. The service principal needs contributor permission to change the quota on a share."),h["\u0275\u0275elementEnd"]())}function R(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"p"),h["\u0275\u0275text"](1,"You can configure file shares to receive alerts or to automatically increase the provisioned storage. The shares are validated each hour. The service principal needs contributor permission to change the quota on a share."),h["\u0275\u0275elementEnd"]())}function k(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"div",5),h["\u0275\u0275elementStart"](1,"div",6),h["\u0275\u0275elementStart"](2,"div",7),h["\u0275\u0275elementStart"](3,"label",24),h["\u0275\u0275text"](4,"Autoshrink once a day"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](5,"nb-checkbox",25),h["\u0275\u0275listener"]("ngModelChange",function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"](2).fileConfig.AllowShrinking=e}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275element"](6,"div",6),h["\u0275\u0275elementEnd"]()}if(2&e){var a=h["\u0275\u0275nextContext"](2);h["\u0275\u0275advance"](5),h["\u0275\u0275property"]("ngModel",a.fileConfig.AllowShrinking)("disabled",!a.azResourceAutomation.Enabled||!a.fileConfig.AutoAdaptFileShare)}}function T(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"button",26),h["\u0275\u0275listener"]("click",function(){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"](2).delete()}),h["\u0275\u0275text"](1," Delete "),h["\u0275\u0275elementEnd"]()}if(2&e){var a=h["\u0275\u0275nextContext"](2);h["\u0275\u0275property"]("disabled",!a.allowSave)}}var z=function(e){return{"is-invalid":e}};function A(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"div"),h["\u0275\u0275elementStart"](1,"form",3,4),h["\u0275\u0275listener"]("ngSubmit",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275reference"](2);return h["\u0275\u0275nextContext"]().onSubmit(e)}),h["\u0275\u0275elementStart"](3,"div",5),h["\u0275\u0275elementStart"](4,"div",6),h["\u0275\u0275elementStart"](5,"div",7),h["\u0275\u0275elementStart"](6,"label",8),h["\u0275\u0275text"](7,"Enabled"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](8,"nb-checkbox",9),h["\u0275\u0275listener"]("ngModelChange",function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().azResourceAutomation.Enabled=e}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275element"](9,"div",6),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](10,"div",5),h["\u0275\u0275elementStart"](11,"div",6),h["\u0275\u0275elementStart"](12,"div",7),h["\u0275\u0275elementStart"](13,"label",10),h["\u0275\u0275text"](14,"If free space is lower than (GByte):"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](15,"div",6),h["\u0275\u0275elementStart"](16,"input",11,12),h["\u0275\u0275listener"]("ngModelChange",function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().fileConfig.AlertIfLessGb=e}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275element"](18,"div",6),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](19,"div",5),h["\u0275\u0275elementStart"](20,"div",6),h["\u0275\u0275elementStart"](21,"div",7),h["\u0275\u0275elementStart"](22,"label",13),h["\u0275\u0275text"](23,"Auto-Adapt"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](24,"nb-checkbox",14),h["\u0275\u0275listener"]("ngModelChange",function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().fileConfig.AutoAdaptFileShare=e}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275element"](25,"div",6),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](26,"div",5),h["\u0275\u0275elementStart"](27,"div",6),h["\u0275\u0275elementStart"](28,"div",7),h["\u0275\u0275elementStart"](29,"label",15),h["\u0275\u0275text"](30,"Keep the free space larger than (GByte):"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](31,"div",6),h["\u0275\u0275elementStart"](32,"input",16,17),h["\u0275\u0275listener"]("ngModelChange",function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().fileConfig.SpareSpaceInGb=e}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](34,"div",6),h["\u0275\u0275elementStart"](35,"div",7),h["\u0275\u0275elementStart"](36,"label",18),h["\u0275\u0275text"](37,"Never exceed (GByte):"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](38,"div",6),h["\u0275\u0275elementStart"](39,"input",19,20),h["\u0275\u0275listener"]("ngModelChange",function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().fileConfig.MaxSpaceInGb=e}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](41,k,7,2,"div",21),h["\u0275\u0275elementStart"](42,"button",22),h["\u0275\u0275text"](43,"Save"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](44,T,2,1,"button",23),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()}if(2&e){var a=h["\u0275\u0275reference"](17),r=h["\u0275\u0275reference"](33),i=h["\u0275\u0275reference"](40),o=h["\u0275\u0275nextContext"]();h["\u0275\u0275advance"](8),h["\u0275\u0275property"]("ngModel",o.azResourceAutomation.Enabled),h["\u0275\u0275advance"](8),h["\u0275\u0275property"]("disabled",!o.azResourceAutomation.Enabled)("ngModel",o.fileConfig.AlertIfLessGb)("ngClass",h["\u0275\u0275pureFunction1"](15,z,o.submitted&&a.invalid)),h["\u0275\u0275advance"](8),h["\u0275\u0275property"]("ngModel",o.fileConfig.AutoAdaptFileShare)("disabled",!o.azResourceAutomation.Enabled),h["\u0275\u0275advance"](8),h["\u0275\u0275property"]("disabled",!o.azResourceAutomation.Enabled||!o.fileConfig.AutoAdaptFileShare)("ngModel",o.fileConfig.SpareSpaceInGb)("ngClass",h["\u0275\u0275pureFunction1"](17,z,o.submitted&&r.invalid)),h["\u0275\u0275advance"](7),h["\u0275\u0275property"]("disabled",!o.azResourceAutomation.Enabled||!o.fileConfig.AutoAdaptFileShare)("ngModel",o.fileConfig.MaxSpaceInGb)("ngClass",h["\u0275\u0275pureFunction1"](19,z,o.submitted&&i.invalid)),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngIf",o.showShrink),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("disabled",!o.allowSave),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngIf",o.fileConfig)}}function _(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"button",27),h["\u0275\u0275listener"]("click",function(){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().add()}),h["\u0275\u0275element"](1,"nb-icon",28),h["\u0275\u0275text"](2,"Add "),h["\u0275\u0275elementEnd"]()}if(2&e){var a=h["\u0275\u0275nextContext"]();h["\u0275\u0275property"]("status",a.styleBtSemiRound)}}var F=function(){var e=function(){function e(t,a,r,i,o){n(this,e),this.actionService=t,this.activatedroute=a,this.http=r,this.toastrService=i,this.dialogService=o,this.spinner1=!0,this.allowSave=!0,this.fileConfig$=new p.xQ,this.submitted=!1,this.showShrink=!1,this.httpWebRoot=(new x.tc).apiURL(),this.styleBtSemiRound="semi-round"}return t(e,[{key:"ngOnChanges",value:function(){this.fileConfig=null,this.azResourceAutomation=null,this.resourceId64=btoa(this.storageResourceId),this.spinner1=!0,this.fileConfig$.next()}},{key:"ngOnInit",value:function(){var e=this;this.showShrink=!x.tc.usVersion||(x.tc.featureExtension&x.kh.AutoadaptFileSharesShrink)===x.kh.AutoadaptFileSharesShrink,this.fileConfigSubscription$=this.fileConfig$.pipe((0,g.O)(0),(0,S.w)(function(){return e.http.get("".concat((new x.tc).apiURL(),"/data/AzResourceAutomation/scene/").concat(e.scene,"/type/StorageAccountFileShare/resourceId64/").concat(e.resourceId64))}),(0,b.a)(function(t){return t.pipe((0,y.b)(function(t){return e.showToast("danger","Failure accessing the FileShare-API","Cannot read data from API. The message is: ".concat(t.message," with status ").concat(t.statusText))}),(0,C.j)(function(){return(0,m.H)(5e3)}))}),(0,v.K)(function(t){return e.showToast("danger","Failure accessing the FileShare-API","Cannot read data from API. Reload this site to try it again. The message is: ".concat(t.message," with status ").concat(t.statusText)),(0,f.of)([])})).subscribe(function(t){null==t?console.log("No configuration"):(console.log("Configuration",t),e.azResourceAutomation=t,e.fileConfig=JSON.parse(e.azResourceAutomation.ConfigurationJson)),e.captionReal=e.caption,e.spinner1=!1})}},{key:"add",value:function(){this.fileConfig=new P.Ie,this.azResourceAutomation=new P.FC,this.azResourceAutomation.Enabled=!0,this.azResourceAutomation.ResourceId=this.resourceId64,this.azResourceAutomation.Scene=this.scene,this.azResourceAutomation.Type=P.wx.StorageAccountFileShare}},{key:"delete",value:function(){var e=this;null!=this.azResourceAutomation.Id?(this.allowSave=!1,this.actionService.sendAction("AzResourceAutomation/scene/".concat(this.scene,"/type/StorageAccountFileShare/resourceId64/").concat(this.resourceId64,"/delete"),this.azResourceAutomation,"Deleting configuration","").subscribe(function(t){t&&(e.allowSave=!0,e.fileConfig=null,e.azResourceAutomation=null)})):(this.fileConfig=null,this.azResourceAutomation=null)}},{key:"onSubmit",value:function(e){var t=this;this.showShrink||(this.fileConfig.AllowShrinking=!1),this.azResourceAutomation.ConfigurationJson=JSON.stringify(this.fileConfig),this.azResourceAutomation.LastRunMessage="",this.azResourceAutomation.LastRunOk=!0,this.azResourceAutomation.LastRunTimeUtc=new Date(0),this.azResourceAutomation.NextRunUtc=new Date(0),this.azResourceAutomation.LastTimeSeenUtc=new Date,this.azResourceAutomation.ResourceId=this.resourceId64,this.azResourceAutomation.Scene=this.scene,this.azResourceAutomation.Type=P.wx.StorageAccountFileShare,this.submitted=!0,e.valid?(this.allowSave=!1,this.actionService.sendAction("AzResourceAutomation/scene/".concat(this.scene,"/type/StorageAccountFileShare/resourceId64/").concat(this.resourceId64),this.azResourceAutomation,"Storing configuration","").subscribe(function(e){e&&t.fileConfig$.next(),t.allowSave=!0})):alert("Please check your configuration. Some properties or selections are not valid or missing. Check the red-cross-marked properties.")}},{key:"ngOnDestroy",value:function(){this.fileConfigSubscription$&&this.fileConfigSubscription$.unsubscribe()}},{key:"showToast",value:function(e,t,n){this.toastrService.show(n,t?"".concat(t):"",{status:e,destroyByClick:!0,duration:2e4,hasIcon:!0,position:s.fe3.TOP_RIGHT,preventDuplicates:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h["\u0275\u0275directiveInject"](M.c),h["\u0275\u0275directiveInject"](d.gz),h["\u0275\u0275directiveInject"](w.eN),h["\u0275\u0275directiveInject"](s.quB),h["\u0275\u0275directiveInject"](s.Gln))},e.\u0275cmp=h["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-file-share-config"]],viewQuery:function(e,t){var n;(1&e&&h["\u0275\u0275viewQuery"](O,5),2&e)&&(h["\u0275\u0275queryRefresh"](n=h["\u0275\u0275loadQuery"]())&&(t.dialog=n.first))},inputs:{storageResourceId:"storageResourceId",scene:"scene",share:"share",caption:"caption"},features:[h["\u0275\u0275NgOnChangesFeature"]],decls:12,vars:6,consts:[[4,"ngIf"],[3,"nbSpinner"],["type","button","nbButton","",3,"status","click",4,"ngIf"],[3,"ngSubmit"],["f","ngForm"],[1,"row"],[1,"col-sm-6"],[1,"form-group","row"],["for","dc-Enabled",1,"label","col-sm-6","col-form-label"],["id","dc-Enabled","name","Enabled","nbTooltip","Enable configuration",1,"col-sm-6",3,"ngModel","ngModelChange"],["for","dc-AlertIfLessGb",1,"label","col-sm-6","col-form-label"],["type","number","id","dc-AlertIfLessGb","min","1","max","5000","nbInput","","fullWidth","","placeholder","1","nbTooltip","Alert if the free space is less than the configured value in GByte. Permitted range: 1-5000","name","AlertIfLessGb",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["AlertIfLessGb","ngModel"],["for","dc-AutoAdaptFileShare",1,"label","col-sm-6","col-form-label"],["id","dc-AutoAdaptFileShare","name","AutoAdaptFileShare","nbTooltip","Enables auto-adapt for this share. Auto-adapt can resize the share if needed and configured. Auto-adapt starts if the free space is less than the configured alert value.",1,"col-sm-6",3,"ngModel","disabled","ngModelChange"],["for","dc-SpareSpaceInGb",1,"label","col-sm-6","col-form-label"],["type","number","id","dc-SpareSpaceInGb","min","1","max","5000","nbInput","","fullWidth","","placeholder","1","nbTooltip","If an alert is triggered, auto-adapt tries to resize the share to have the configured amount for free space.. Permitted range: 1-5000","name","SpareSpaceInGb",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["SpareSpaceInGb","ngModel"],["for","dc-MaxSpaceInGb",1,"label","col-sm-6","col-form-label"],["type","number","id","dc-MaxSpaceInGb","min","10","max","100000","nbInput","","fullWidth","","placeholder","1","nbTooltip","Never exceed the configured value for the full share. Permitted range: 10-100000","name","MaxSpaceInGb",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["MaxSpaceInGb","ngModel"],["class","row",4,"ngIf"],["type","submit","nbButton","","status","primary","nbTooltip","Save the configuration",2,"float","right",3,"disabled"],["type","button","nbButton","","style","float: right;",3,"disabled","click",4,"ngIf"],["for","dc-AllowShrinking",1,"label","col-sm-6","col-form-label"],["id","dc-AllowShrinking","name","AllowShrinking","nbTooltip","If enabled and more storage free as the configured free space, Hydra tries to shrink the share once a day (24h after the last resizing).",1,"col-sm-6",3,"ngModel","disabled","ngModelChange"],["type","button","nbButton","",2,"float","right",3,"disabled","click"],["type","button","nbButton","",3,"status","click"],["icon","plus-outline"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"div"),h["\u0275\u0275elementStart"](1,"nb-card"),h["\u0275\u0275elementStart"](2,"nb-card-header"),h["\u0275\u0275elementStart"](3,"h1"),h["\u0275\u0275text"](4,"Configuration"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](5,E,2,0,"p",0),h["\u0275\u0275template"](6,R,2,0,"p",0),h["\u0275\u0275elementStart"](7,"b"),h["\u0275\u0275text"](8),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](9,"nb-card-body",1),h["\u0275\u0275template"](10,A,45,21,"div",0),h["\u0275\u0275template"](11,_,3,1,"button",2),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()),2&e&&(h["\u0275\u0275advance"](5),h["\u0275\u0275property"]("ngIf",t.showShrink),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf",!t.showShrink),h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate"](t.captionReal),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("nbSpinner",t.spinner1),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf",t.fileConfig),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf",!t.fileConfig))},directives:[s.Asz,s.ndF,o.O5,s.yKW,s.Q7R,i._Y,i.JL,i.F,s.NTf,s.jNv,i.JJ,i.On,i.qQ,i.Fd,i.wV,s.h8i,i.Fj,o.mk,s.DPz,s.fMN],styles:[".nb-theme-default   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-default   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-default   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-default   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-dark   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-dark   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-dark   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-dark   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-cosmic   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-cosmic   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-cosmic   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-cosmic   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-corporate   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-corporate   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-corporate   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-corporate   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}"]}),e}(),H=["dialog"];function L(e,t){if(1&e&&(h["\u0275\u0275elementStart"](0,"em"),h["\u0275\u0275text"](1),h["\u0275\u0275elementEnd"]()),2&e){var n=h["\u0275\u0275nextContext"]();h["\u0275\u0275advance"](1),h["\u0275\u0275textInterpolate1"]("(",n.itemsCount," handles)")}}function B(e,t){1&e&&h["\u0275\u0275element"](0,"span",19)}function N(e,t){1&e&&h["\u0275\u0275element"](0,"span",20)}function V(e,t){1&e&&h["\u0275\u0275element"](0,"span",19)}function G(e,t){1&e&&h["\u0275\u0275element"](0,"span",20)}function j(e,t){1&e&&h["\u0275\u0275element"](0,"span",19)}function $(e,t){1&e&&h["\u0275\u0275element"](0,"span",20)}function U(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementContainerStart"](0),h["\u0275\u0275elementStart"](1,"tr"),h["\u0275\u0275elementStart"](2,"td"),h["\u0275\u0275elementStart"](3,"nb-checkbox",21),h["\u0275\u0275listener"]("ngModelChange",function(e){return h["\u0275\u0275restoreView"](n).$implicit.IsSelected=e}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](4,"td"),h["\u0275\u0275text"](5),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](6,"td"),h["\u0275\u0275text"](7),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](8,"td"),h["\u0275\u0275text"](9),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementContainerEnd"]()}if(2&e){var a=t.$implicit;h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngModel",a.IsSelected),h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate1"](" ",a.Path," "),h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate1"](" ",a.ClientIp," "),h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate"](a.OpenTime)}}function D(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"div"),h["\u0275\u0275elementStart"](1,"div",11),h["\u0275\u0275elementStart"](2,"table",12),h["\u0275\u0275elementStart"](3,"thead"),h["\u0275\u0275elementStart"](4,"tr"),h["\u0275\u0275elementStart"](5,"th",13),h["\u0275\u0275listener"]("click",function(){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().selectAllTrigger()}),h["\u0275\u0275text"](6,"Select"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](7,"th",14),h["\u0275\u0275listener"]("click",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275nextContext"]();return e.sortType="Path",e.sortReverse=!e.sortReverse,e.sort(e.sortReverse,e.sortType)}),h["\u0275\u0275text"](8," Path and File "),h["\u0275\u0275template"](9,B,1,0,"span",15),h["\u0275\u0275template"](10,N,1,0,"span",16),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](11,"th",14),h["\u0275\u0275listener"]("click",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275nextContext"]();return e.sortType="ClientIp",e.sortReverse=!e.sortReverse,e.sort(e.sortReverse,e.sortType)}),h["\u0275\u0275text"](12," Client IP "),h["\u0275\u0275template"](13,V,1,0,"span",15),h["\u0275\u0275template"](14,G,1,0,"span",16),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](15,"th",14),h["\u0275\u0275listener"]("click",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275nextContext"]();return e.sortType="OpenTime",e.sortReverse=!e.sortReverse,e.sort(e.sortReverse,e.sortType)}),h["\u0275\u0275text"](16," Time opened "),h["\u0275\u0275template"](17,j,1,0,"span",15),h["\u0275\u0275template"](18,$,1,0,"span",16),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](19,"tbody"),h["\u0275\u0275template"](20,U,10,4,"ng-container",17),h["\u0275\u0275pipe"](21,"slice"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](22,"ngb-pagination",18),h["\u0275\u0275listener"]("pageChange",function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().page=e}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()}if(2&e){var a=h["\u0275\u0275nextContext"]();h["\u0275\u0275advance"](9),h["\u0275\u0275property"]("ngIf","Path"==a.sortType&&!a.sortReverse),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf","Path"==a.sortType&&a.sortReverse),h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngIf","ClientIp"==a.sortType&&!a.sortReverse),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf","ClientIp"==a.sortType&&a.sortReverse),h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngIf","OpenTime"==a.sortType&&!a.sortReverse),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf","OpenTime"==a.sortType&&a.sortReverse),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngForOf",h["\u0275\u0275pipeBind3"](21,13,a.fileHandles,(a.page-1)*a.pageSize,a.page*a.pageSize))("ngForTrackBy",a.identifyViewFileHandles),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("collectionSize",a.collectionSize)("page",a.page)("maxSize",5)("boundaryLinks",!0)("pageSize",a.pageSize)}}function Q(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"nb-card"),h["\u0275\u0275elementStart"](1,"nb-card-header"),h["\u0275\u0275text"](2,"Confirmation"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](3,"nb-card-body"),h["\u0275\u0275text"](4),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](5,"nb-card-footer"),h["\u0275\u0275elementStart"](6,"div",2),h["\u0275\u0275element"](7,"div",22),h["\u0275\u0275elementStart"](8,"div",23),h["\u0275\u0275elementStart"](9,"button",24),h["\u0275\u0275listener"]("click",function(){return h["\u0275\u0275restoreView"](n).dialogRef.close("0")}),h["\u0275\u0275text"](10,"Cancel"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](11,"div",23),h["\u0275\u0275elementStart"](12,"button",25),h["\u0275\u0275listener"]("click",function(){return h["\u0275\u0275restoreView"](n).dialogRef.close("1")}),h["\u0275\u0275text"](13,"Ok"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()}if(2&e){var a=t.$implicit;h["\u0275\u0275advance"](4),h["\u0275\u0275textInterpolate"](a)}}var J=function(){var e=function(){function e(t,a,r,i,o){n(this,e),this.actionService=t,this.activatedroute=a,this.http=r,this.toastrService=i,this.dialogService=o,this.spinner1=!0,this.interval=2*x.tc.autoRefreshDefault,this.page=1,this.pageSize=20,this.fileHandles$=new p.xQ,this.fileHandles=[],this.allfileHandles=[],this.dict={},this.iterationId=0,this.httpWebRoot=(new x.tc).apiURL(),this.sortType="SceneName",this.sortReverse=!0,this.searchPhrase="",this.styleBtSemiRound="semi-round"}return t(e,[{key:"ngOnInit",value:function(){var e=this;this.fileHandelsSubscription$=this.fileHandles$.pipe((0,g.O)(0),(0,S.w)(function(){return(0,m.H)(1,e.interval)}),(0,S.w)(function(){return e.http.get("".concat((new x.tc).apiURL(),"/data/azure/fileshares/").concat(e.scene,"/").concat(e.resourceId64,"/").concat(e.share,"/handles"))}),(0,b.a)(function(t){return t.pipe((0,y.b)(function(t){return e.showToast("danger","Failure accessing the FileShare-API","Cannot read data from API. The message is: ".concat(t.message," with status ").concat(t.statusText))}),(0,C.j)(function(){return(0,m.H)(5e3)}))}),(0,v.K)(function(t){return e.showToast("danger","Failure accessing the FileShare-API","Cannot read data from API. Reload this site to try it again. The message is: ".concat(t.message," with status ").concat(t.statusText)),(0,f.of)([])})).subscribe(function(t){e.captionReal=e.caption,e.iterationId++,e.collectionSize=t.length,e.spinner1=!1,t.forEach(function(t){if(e.dict[t.HandleId]){var n=e.dict[t.HandleId].IsSelected;e.dict[t.HandleId]=Object.assign(new P.Fr,t),e.dict[t.HandleId].IsSelected=n,e.dict[t.HandleId]._iteration=e.iterationId}else e.dict[t.HandleId]=t,e.dict[t.HandleId]._iteration=e.iterationId});var n=[];for(var a in e.dict)e.dict[a]._iteration===e.iterationId&&n.push(e.dict[a]);e.allfileHandles=n,e.itemsCount=e.allfileHandles.length,e.searchTable(),e.sort(e.sortReverse,e.sortType)})}},{key:"ngOnChanges",value:function(){this.resourceId64=btoa(this.storageResourceId),this.spinner1=!0,this.allfileHandles=[],this.dict={},this.fileHandles$.next()}},{key:"triggerActionSelected",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.allfileHandles.filter(function(e){return e.IsSelected});0===r.length?alert("Please select one or more items to run the action"):a?this.dialogService.open(this.dialog,{context:"Please confirm the operation '".concat(t,"' for ").concat(r.length," handles")}).onClose.subscribe(function(a){"1"===a&&n.triggerAction(e,t)}):this.triggerAction(e,t)}},{key:"triggerAction",value:function(e,t){var n=this,a=this.allfileHandles.filter(function(e){return e.IsSelected});console.log("Start action: "+e+" on a number of handles"+a.length),this.actionService.sendActionAsync("azure/fileshares/".concat(this.scene,"/").concat(this.resourceId64,"/").concat(this.share,"/handles/close"),a,t,a.length+" handles",!0).subscribe(function(e){n.fileHandles$.next()})}},{key:"identifyViewFileHandles",value:function(e,t){return t.Id}},{key:"update",value:function(){this.fileHandles$.next()}},{key:"searchTable",value:function(){var e=this;this.fileHandles=this.allfileHandles.filter(function(t){return""===e.searchPhrase||t.Path.toLowerCase().includes(e.searchPhrase.toLowerCase())||t.ClientIp.toLowerCase().indexOf(e.searchPhrase.toLowerCase())>-1||t.OpenTime.toLowerCase().indexOf(e.searchPhrase.toLowerCase())>-1}),this.sort(this.sortReverse,this.sortType),this.collectionSize=this.fileHandles.length}},{key:"sort",value:function(e,t){var n=(t+".....").split(".");this.sortInternal(e,n[0],n[1],n[2],n[3])}},{key:"sortInternal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this.fileHandles=this.fileHandles.sort(function(i,o){try{if(""!=r)var s=i[t][n][a][r],l=o[t][n][a][r];else""!=a?(s=i[t][n][a],l=o[t][n][a]):""!=n?(s=i[t][n],l=o[t][n]):(s=i[t],l=o[t])}catch(c){s=1,l=1}return e?s>l?1:l>s?-1:0:s>l?-1:1})}},{key:"selectAllTrigger",value:function(){this.fileHandles.findIndex(function(e){return e.IsSelected})<0?this.fileHandles.forEach(function(e){return e.IsSelected=!0}):this.fileHandles.filter(function(e){return e.IsSelected}).forEach(function(e){return e.IsSelected=!1})}},{key:"selectPage",value:function(){var e=(this.page-1)*this.pageSize,t=e+this.pageSize;t>=this.fileHandles.length&&(t=this.fileHandles.length);for(var n=0;n<this.fileHandles.length;n++)this.fileHandles[n].IsSelected=n>=e&&n<t}},{key:"navigateTo",value:function(e,t){}},{key:"ngOnDestroy",value:function(){this.fileHandelsSubscription$&&this.fileHandelsSubscription$.unsubscribe()}},{key:"showToast",value:function(e,t,n){this.toastrService.show(n,t?"".concat(t):"",{status:e,destroyByClick:!0,duration:2e4,hasIcon:!0,position:s.fe3.TOP_RIGHT,preventDuplicates:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h["\u0275\u0275directiveInject"](M.c),h["\u0275\u0275directiveInject"](d.gz),h["\u0275\u0275directiveInject"](w.eN),h["\u0275\u0275directiveInject"](s.quB),h["\u0275\u0275directiveInject"](s.Gln))},e.\u0275cmp=h["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-file-share-handles"]],viewQuery:function(e,t){var n;(1&e&&h["\u0275\u0275viewQuery"](H,5),2&e)&&(h["\u0275\u0275queryRefresh"](n=h["\u0275\u0275loadQuery"]())&&(t.dialog=n.first))},inputs:{storageResourceId:"storageResourceId",scene:"scene",share:"share",caption:"caption"},features:[h["\u0275\u0275NgOnChangesFeature"]],decls:23,vars:6,consts:[[4,"ngIf"],[3,"nbSpinner"],[1,"row"],[1,"col-sm-8"],["type","text","nbInput","","fullWidth","","placeholder","Search for a specific file or IP",3,"ngModel","ngModelChange"],[1,"col-sm-4"],["size","small","fullWidth",""],["icon","stop-circle","nbTooltip","Release handle","nbTooltipPlacement","top",3,"click"],["type","button","nbButton","",3,"status","click"],["icon","refresh"],["dialog",""],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],[2,"cursor","pointer",3,"click"],[3,"click"],["class","fa fa-caret-down",4,"ngIf"],["class","fa fa-caret-up",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","justify-content-center",3,"collectionSize","page","maxSize","boundaryLinks","pageSize","pageChange"],[1,"fa","fa-caret-down"],[1,"fa","fa-caret-up"],[3,"ngModel","ngModelChange"],[1,"col-sm-6",2,"min-width","200px"],[1,"col-sm-3","text-right"],["nbButton","",1,"cancel",3,"click"],["nbButton","",3,"click"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"div"),h["\u0275\u0275elementStart"](1,"nb-card"),h["\u0275\u0275elementStart"](2,"nb-card-header"),h["\u0275\u0275elementStart"](3,"h1"),h["\u0275\u0275text"](4,"File Handles"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](5,"p"),h["\u0275\u0275text"](6,"This table shows open file handles and can be used to reset a locked FSLogix profile disk. If the app service has no access to the file storage (e.g., the storage account is using a private endpoint, and the app service can not access the storage account), the list is empty."),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](7,"b"),h["\u0275\u0275text"](8),h["\u0275\u0275template"](9,L,2,1,"em",0),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](10,"nb-card-body",1),h["\u0275\u0275elementStart"](11,"div",2),h["\u0275\u0275elementStart"](12,"div",3),h["\u0275\u0275elementStart"](13,"input",4),h["\u0275\u0275listener"]("ngModelChange",function(e){return t.searchPhrase=e})("ngModelChange",function(){return t.searchTable()}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](14,"div",5),h["\u0275\u0275elementStart"](15,"nb-actions",6),h["\u0275\u0275elementStart"](16,"nb-action",7),h["\u0275\u0275listener"]("click",function(){return t.triggerActionSelected("release","Release",!0,!0)}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](17,D,23,17,"div",0),h["\u0275\u0275elementStart"](18,"button",8),h["\u0275\u0275listener"]("click",function(){return t.update()}),h["\u0275\u0275element"](19,"nb-icon",9),h["\u0275\u0275text"](20,"Update "),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](21,Q,14,1,"ng-template",null,10,h["\u0275\u0275templateRefExtractor"])),2&e&&(h["\u0275\u0275advance"](8),h["\u0275\u0275textInterpolate1"]("",t.captionReal," "),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf",t.itemsCount>0),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("nbSpinner",t.spinner1),h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngModel",t.searchPhrase),h["\u0275\u0275advance"](4),h["\u0275\u0275property"]("ngIf",t.fileHandles),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("status",t.styleBtSemiRound))},directives:[s.Asz,s.ndF,o.O5,s.yKW,s.Q7R,s.h8i,i.Fj,i.JJ,i.On,s.lYD,s.Bk3,s.jNv,s.DPz,s.fMN,o.sg,l.N9,s.NTf,s.XWE],pipes:[o.OU],styles:[".nb-theme-default   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-default   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-default   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-default   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-dark   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-dark   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-dark   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-dark   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-cosmic   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-cosmic   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-cosmic   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-cosmic   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-corporate   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-corporate   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-corporate   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-corporate   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}"]}),e}();function W(e,t){1&e&&h["\u0275\u0275element"](0,"span",14)}function K(e,t){1&e&&h["\u0275\u0275element"](0,"span",15)}function q(e,t){1&e&&h["\u0275\u0275element"](0,"span",14)}function X(e,t){1&e&&h["\u0275\u0275element"](0,"span",15)}function Y(e,t){1&e&&h["\u0275\u0275element"](0,"span",14)}function Z(e,t){1&e&&h["\u0275\u0275element"](0,"span",15)}function ee(e,t){1&e&&h["\u0275\u0275element"](0,"span",14)}function te(e,t){1&e&&h["\u0275\u0275element"](0,"span",15)}function ne(e,t){1&e&&h["\u0275\u0275element"](0,"span",14)}function ae(e,t){1&e&&h["\u0275\u0275element"](0,"span",15)}function re(e,t){1&e&&h["\u0275\u0275element"](0,"span",14)}function ie(e,t){1&e&&h["\u0275\u0275element"](0,"span",15)}function oe(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"nb-icon",19),h["\u0275\u0275listener"]("click",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275nextContext"]().$implicit;return h["\u0275\u0275nextContext"](2).config(e.Scene,e.ResourceId,e.Share,e.SceneName+": "+e.Name+"\\"+e.Share)}),h["\u0275\u0275elementEnd"]()}}function se(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementContainerStart"](0),h["\u0275\u0275elementStart"](1,"tr"),h["\u0275\u0275elementStart"](2,"td"),h["\u0275\u0275text"](3),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](4,"td"),h["\u0275\u0275text"](5),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](6,"td"),h["\u0275\u0275text"](7),h["\u0275\u0275template"](8,oe,1,0,"nb-icon",16),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](9,"td"),h["\u0275\u0275elementStart"](10,"nb-icon",17),h["\u0275\u0275listener"]("click",function(){var e=h["\u0275\u0275restoreView"](n).$implicit;return h["\u0275\u0275nextContext"](2).config(e.Scene,e.ResourceId,e.Share,e.SceneName+": "+e.Name+"\\"+e.Share)}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](11,"td"),h["\u0275\u0275text"](12),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](13,"td"),h["\u0275\u0275text"](14),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](15,"td"),h["\u0275\u0275elementStart"](16,"ngx-tacho",18),h["\u0275\u0275listener"]("click",function(){var e=h["\u0275\u0275restoreView"](n).$implicit;return h["\u0275\u0275nextContext"](2).handles(e.Scene,e.ResourceId,e.Share,e.SceneName+": "+e.Name+"\\"+e.Share)}),h["\u0275\u0275pipe"](17,"number"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementContainerEnd"]()}if(2&e){var a=t.$implicit;h["\u0275\u0275advance"](3),h["\u0275\u0275textInterpolate1"](" ",a.SceneName," "),h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate1"](" ",a.Name," "),h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate1"]("",a.Share," "),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf",a.Warning),h["\u0275\u0275advance"](4),h["\u0275\u0275textInterpolate"](a.QuotaGb),h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate"](a.UsageGb),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("chartValue",h["\u0275\u0275pipeBind2"](17,7,a.Load,"1.1-1"))}}function le(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"div"),h["\u0275\u0275elementStart"](1,"div",7),h["\u0275\u0275elementStart"](2,"table",8),h["\u0275\u0275elementStart"](3,"thead"),h["\u0275\u0275elementStart"](4,"tr"),h["\u0275\u0275elementStart"](5,"th",9),h["\u0275\u0275listener"]("click",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275nextContext"]();return e.sortType="SceneName",e.sortReverse=!e.sortReverse,e.sort(e.sortReverse,e.sortType)}),h["\u0275\u0275text"](6," Tenant "),h["\u0275\u0275template"](7,W,1,0,"span",10),h["\u0275\u0275template"](8,K,1,0,"span",11),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](9,"th",9),h["\u0275\u0275listener"]("click",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275nextContext"]();return e.sortType="Name",e.sortReverse=!e.sortReverse,e.sort(e.sortReverse,e.sortType)}),h["\u0275\u0275text"](10," Storage Account "),h["\u0275\u0275template"](11,q,1,0,"span",10),h["\u0275\u0275template"](12,X,1,0,"span",11),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](13,"th",9),h["\u0275\u0275listener"]("click",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275nextContext"]();return e.sortType="Share",e.sortReverse=!e.sortReverse,e.sort(e.sortReverse,e.sortType)}),h["\u0275\u0275text"](14," Share "),h["\u0275\u0275template"](15,Y,1,0,"span",10),h["\u0275\u0275template"](16,Z,1,0,"span",11),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](17,"th"),h["\u0275\u0275text"](18,"Action"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](19,"th",9),h["\u0275\u0275listener"]("click",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275nextContext"]();return e.sortType="QuotaGb",e.sortReverse=!e.sortReverse,e.sort(e.sortReverse,e.sortType)}),h["\u0275\u0275text"](20," Quote / GByte "),h["\u0275\u0275template"](21,ee,1,0,"span",10),h["\u0275\u0275template"](22,te,1,0,"span",11),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](23,"th",9),h["\u0275\u0275listener"]("click",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275nextContext"]();return e.sortType="UsageGb",e.sortReverse=!e.sortReverse,e.sort(e.sortReverse,e.sortType)}),h["\u0275\u0275text"](24," Usage / GByte "),h["\u0275\u0275template"](25,ne,1,0,"span",10),h["\u0275\u0275template"](26,ae,1,0,"span",11),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](27,"th",9),h["\u0275\u0275listener"]("click",function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275nextContext"]();return e.sortType="Load",e.sortReverse=!e.sortReverse,e.sort(e.sortReverse,e.sortType)}),h["\u0275\u0275text"](28," Usage / % "),h["\u0275\u0275template"](29,re,1,0,"span",10),h["\u0275\u0275template"](30,ie,1,0,"span",11),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](31,"tbody"),h["\u0275\u0275template"](32,se,18,10,"ng-container",12),h["\u0275\u0275pipe"](33,"slice"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](34,"ngb-pagination",13),h["\u0275\u0275listener"]("pageChange",function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().page=e}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()}if(2&e){var a=h["\u0275\u0275nextContext"]();h["\u0275\u0275advance"](7),h["\u0275\u0275property"]("ngIf","SceneName"==a.sortType&&!a.sortReverse),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf","SceneName"==a.sortType&&a.sortReverse),h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngIf","Name"==a.sortType&&!a.sortReverse),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf","Name"==a.sortType&&a.sortReverse),h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngIf","Share"==a.sortType&&!a.sortReverse),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf","Share"==a.sortType&&a.sortReverse),h["\u0275\u0275advance"](5),h["\u0275\u0275property"]("ngIf","QuotaGb"==a.sortType&&!a.sortReverse),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf","QuotaGb"==a.sortType&&a.sortReverse),h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngIf","UsageGb"==a.sortType&&!a.sortReverse),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf","UsageGb"==a.sortType&&a.sortReverse),h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngIf","Load"==a.sortType&&!a.sortReverse),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf","Load"==a.sortType&&a.sortReverse),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngForOf",h["\u0275\u0275pipeBind3"](33,19,a.fileShares,(a.page-1)*a.pageSize,a.page*a.pageSize))("ngForTrackBy",a.identifyViewFileShares),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("collectionSize",a.collectionSize)("page",a.page)("maxSize",5)("boundaryLinks",!0)("pageSize",a.pageSize)}}function ce(e,t){if(1&e&&h["\u0275\u0275element"](0,"ngx-file-share-config",20),2&e){var n=h["\u0275\u0275nextContext"]();h["\u0275\u0275property"]("storageResourceId",n.storageResourceId)("scene",n.scene)("share",n.share)("caption",n.caption)}}function de(e,t){if(1&e&&h["\u0275\u0275element"](0,"ngx-file-share-handles",20),2&e){var n=h["\u0275\u0275nextContext"]();h["\u0275\u0275property"]("storageResourceId",n.storageResourceId)("scene",n.scene)("share",n.share)("caption",n.caption)}}var he,ue,pe=function(){var e=function(){function e(t,a){n(this,e),this.http=t,this.toastrService=a,this.interval=2*x.tc.autoRefreshDefault,this.page=1,this.pageSize=20,this.fileShares$=new p.xQ,this.fileShares=[],this.allFileShares=[],this.httpWebRoot=(new x.tc).apiURL(),this.sortType="SceneName",this.sortReverse=!0,this.searchPhrase="",this.showHandles=!1,this.showConfig=!1,this.styleBtSemiRound="semi-round"}return t(e,[{key:"ngOnInit",value:function(){var e=this;this.fileSharesSubscription$=this.fileShares$.pipe((0,g.O)(0),(0,S.w)(function(){return(0,m.H)(1,e.interval)}),(0,S.w)(function(){return e.http.get("".concat((new x.tc).apiURL(),"/data/azure/fileshares"))}),(0,b.a)(function(t){return t.pipe((0,y.b)(function(t){return e.showToast("danger","Failure accessing the FileShare-API","Cannot read data from API. The message is: ".concat(t.message," with status ").concat(t.statusText))}),(0,C.j)(function(){return(0,m.H)(5e3)}))}),(0,v.K)(function(t){return e.showToast("danger","Failure accessing the FileShare-API","Cannot read data from API. Reload this site to try it again. The message is: ".concat(t.message," with status ").concat(t.statusText)),(0,f.of)([])})).subscribe(function(t){console.log("FileShares: Getting data ",t.length),e.collectionSize=t.length,e.allFileShares=t,e.searchTable(),e.sort(e.sortReverse,e.sortType)})}},{key:"identifyViewFileShares",value:function(e,t){return t.Id}},{key:"update",value:function(){this.fileShares$.next()}},{key:"handles",value:function(e,t,n,a){this.scene=e,this.storageResourceId=t,this.share=n,this.caption=a,this.showHandles=!0}},{key:"config",value:function(e,t,n,a){this.scene=e,this.storageResourceId=t,this.share=n,this.caption=a,this.showConfig=!0}},{key:"searchTable",value:function(){var e=this;this.fileShares=this.allFileShares.filter(function(t){return""===e.searchPhrase||t.Name.toLowerCase().includes(e.searchPhrase.toLowerCase())||t.Share.toLowerCase().indexOf(e.searchPhrase.toLowerCase())>-1}),this.sort(this.sortReverse,this.sortType),this.collectionSize=this.fileShares.length}},{key:"sort",value:function(e,t){var n=(t+".....").split(".");this.sortInternal(e,n[0],n[1],n[2],n[3])}},{key:"sortInternal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this.fileShares=this.fileShares.sort(function(i,o){try{if(""!==r)var s=i[t][n][a][r],l=o[t][n][a][r];else""!==a?(s=i[t][n][a],l=o[t][n][a]):""!==n?(s=i[t][n],l=o[t][n]):(s=i[t],l=o[t])}catch(c){s=1,l=1}return e?s>l?1:l>s?-1:0:s>l?-1:1})}},{key:"navigateTo",value:function(e,t){}},{key:"ngOnDestroy",value:function(){this.fileSharesSubscription$&&this.fileSharesSubscription$.unsubscribe()}},{key:"showToast",value:function(e,t,n){this.toastrService.show(n,t?"".concat(t):"",{status:e,destroyByClick:!0,duration:2e4,hasIcon:!0,position:s.fe3.TOP_RIGHT,preventDuplicates:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h["\u0275\u0275directiveInject"](w.eN),h["\u0275\u0275directiveInject"](s.quB))},e.\u0275cmp=h["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-file-shares"]],decls:16,vars:5,consts:[[1,"row"],[1,"col-sm-6"],["type","text","nbInput","","fullWidth","","placeholder","Search for a specific tenant, storage account, share",3,"ngModel","ngModelChange"],[4,"ngIf"],["type","button","nbButton","",3,"status","click"],["icon","refresh"],[3,"storageResourceId","scene","share","caption",4,"ngIf"],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],[3,"click"],["class","fa fa-caret-down",4,"ngIf"],["class","fa fa-caret-up",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","justify-content-center",3,"collectionSize","page","maxSize","boundaryLinks","pageSize","pageChange"],[1,"fa","fa-caret-down"],[1,"fa","fa-caret-up"],["icon","alert-triangle-outline","nbTooltip","Alert",3,"click",4,"ngIf"],["icon","settings-outline","nbTooltip","Configure",3,"click"],[3,"chartValue","click"],["icon","alert-triangle-outline","nbTooltip","Alert",3,"click"],[3,"storageResourceId","scene","share","caption"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"div"),h["\u0275\u0275elementStart"](1,"nb-card"),h["\u0275\u0275elementStart"](2,"nb-card-header"),h["\u0275\u0275elementStart"](3,"h1"),h["\u0275\u0275text"](4,"File Shares"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](5,"nb-card-body"),h["\u0275\u0275elementStart"](6,"div",0),h["\u0275\u0275elementStart"](7,"div",1),h["\u0275\u0275elementStart"](8,"input",2),h["\u0275\u0275listener"]("ngModelChange",function(e){return t.searchPhrase=e})("ngModelChange",function(){return t.searchTable()}),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275element"](9,"div",1),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](10,le,35,23,"div",3),h["\u0275\u0275elementStart"](11,"button",4),h["\u0275\u0275listener"]("click",function(){return t.update()}),h["\u0275\u0275element"](12,"nb-icon",5),h["\u0275\u0275text"](13," Update "),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](14,ce,1,4,"ngx-file-share-config",6),h["\u0275\u0275template"](15,de,1,4,"ngx-file-share-handles",6)),2&e&&(h["\u0275\u0275advance"](8),h["\u0275\u0275property"]("ngModel",t.searchPhrase),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngIf",t.fileShares),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("status",t.styleBtSemiRound),h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngIf",t.showConfig),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("ngIf",t.showHandles))},directives:[s.Asz,s.ndF,s.yKW,s.h8i,i.Fj,i.JJ,i.On,o.O5,s.DPz,s.fMN,o.sg,l.N9,s.jNv,I.K,F,J],pipes:[o.OU,o.JJ],styles:[".nb-theme-default   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-default   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-default   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-default   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-dark   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-dark   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-dark   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-dark   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-cosmic   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-cosmic   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-cosmic   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-cosmic   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.nb-theme-corporate   [_nghost-%COMP%]   .size-tiny[_ngcontent-%COMP%]{width:26rem;height:17rem}.nb-theme-corporate   [_nghost-%COMP%]   .flex-container[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none;-ms-box-orient:horizontal;display:-moz-flex;display:flex}.nb-theme-corporate   [_nghost-%COMP%]   .nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap}.nb-theme-corporate   [_nghost-%COMP%]   .wrap[_ngcontent-%COMP%]{flex-wrap:wrap}"]}),e}(),me=r(18819),fe=r(86115),ge=r(93104),ve=[{path:"",component:u,children:[{path:"vd",loadChildren:function(){return Promise.all([r.e(592),r.e(505)]).then(r.bind(r,72505)).then(function(e){return e.VirtualDesktopModule})}},{path:"file-shares",component:pe},{path:"file-shares/:id/statistic",component:(he=function(){function e(t,a,r,i,o){var s=this;n(this,e),this.hostPoolsService=t,this.activatedroute=a,this.theme=r,this.http=i,this.toastrService=o,this.test="",this.dataX=[],this.userSessionsConnected=[[]],this.userSessions=[[]],this.userCapacityNow=[[]],this.sessionHostsAvailable=[[]],this.lastDateInsert=new Date(0),this.options={},this.alive=!0,this.loadBalancerTypePersistent=fe.rQ.Persistent,this.loadBalancerTypeBreadthFirst=fe.rQ.BreadthFirst,this.loadBalancerTypeMultiplePersistent=fe.rQ.MultiplePersistent,this.activatedroute.paramMap.subscribe(function(e){s.id=e.get("id"),console.log("Host pool id: ".concat(s.id.replace(/;/g,"/")))}),this.statisticsSubscription=this.http.get("".concat((new x.tc).apiURL(),"/data/azure/fileshares/").concat(this.id,"/usage")).pipe((0,b.a)(function(e){return e.pipe((0,y.b)(function(e){return s.showToast("danger","Failure accessing the API","Cannot read data from API. The message is: ".concat(e.message," with status ").concat(e.statusText))}))}),(0,me.B)()).subscribe(function(e){s.dataX=[],s.userCapacityNow=[],s.userSessions=[],e.forEach(function(e){var t=new Date(e.TimeGenerated);s.dataX.push(t),s.userCapacityNow.push([t.toISOString(),e.QuotaGb]),s.userSessions.push([t.toISOString(),e.UsageGb])}),s.ngAfterViewInit()})}return t(e,[{key:"configSaved",value:function(e){this.test=JSON.stringify(e)}},{key:"ngOnDestroy",value:function(){this.alive=!1,this.themeSubscription&&this.themeSubscription.unsubscribe(),this.statisticsSubscription&&this.statisticsSubscription.unsubscribe()}},{key:"ngAfterViewInit",value:function(){var e=this;this.themeSubscription=this.theme.getJsTheme().subscribe(function(t){var n=t.variables,a=t.variables.echarts;e.options={backgroundColor:a.bg,color:[n.danger,n.primary,n.info],tooltip:{formatter:function(e,t){return(0,o.p6)(e[0].value[0],"HH:mm:ss","en-US")+'<li style="list-style:none; color:white">'.concat(e[0].marker+e[0].seriesName,": &nbsp;&nbsp;").concat(e[0].value[1],'</li><li style="list-style:none; color:white">').concat(e[1].marker+e[1].seriesName,": &nbsp;&nbsp;").concat(e[1].value[1],"</li>")},trigger:"axis",axisPointer:{type:"cross"}},legend:{left:"left",data:["Quota / GByte","Usage / GByte"],textStyle:{color:a.textColor}},xAxis:[{type:"time",data:e.dataX,axisTick:{alignWithLabel:!0},axisLine:{lineStyle:{color:a.axisLineColor}},axisLabel:{rotate:-45,textStyle:{color:a.textColor},formatter:function(e){return(0,o.p6)(e,"HH:mm:ss","en-US")}}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:a.axisLineColor}},splitLine:{lineStyle:{color:a.splitLineColor}},axisLabel:{textStyle:{color:a.textColor}}},{type:"value",axisLabel:{textStyle:{color:a.textColor}},axisLine:{lineStyle:{color:a.axisLineColor}},splitLine:{lineStyle:{color:a.splitLineColor}}}],grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},series:[{name:"Quota / GByte",type:"line",smooth:!0,showSymbol:!1,data:e.userCapacityNow},{name:"Usage / GByte",type:"line",smooth:!0,showSymbol:!1,data:e.userSessions}]}})}},{key:"showToast",value:function(e,t,n){this.toastrService.show(n,t?"".concat(t):"",{status:e,destroyByClick:!0,duration:2e4,hasIcon:!0,position:s.fe3.TOP_RIGHT,preventDuplicates:!0})}}]),e}(),he.\u0275fac=function(e){return new(e||he)(h["\u0275\u0275directiveInject"](fe.lJ),h["\u0275\u0275directiveInject"](d.gz),h["\u0275\u0275directiveInject"](s.WMF),h["\u0275\u0275directiveInject"](w.eN),h["\u0275\u0275directiveInject"](s.quB))},he.\u0275cmp=h["\u0275\u0275defineComponent"]({type:he,selectors:[["ngx-file-share-statistic"]],decls:5,vars:1,consts:[["echarts","",1,"echart",3,"options"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"div"),h["\u0275\u0275elementStart"](1,"h1"),h["\u0275\u0275text"](2,"File Share Usage"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275element"](3,"div",0),h["\u0275\u0275element"](4,"br")),2&e&&(h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("options",t.options))},directives:[ge.w],styles:[".nb-theme-default   [_nghost-%COMP%]   nb-card-body[_ngcontent-%COMP%]{overflow:hidden}.nb-theme-dark   [_nghost-%COMP%]   nb-card-body[_ngcontent-%COMP%]{overflow:hidden}.nb-theme-cosmic   [_nghost-%COMP%]   nb-card-body[_ngcontent-%COMP%]{overflow:hidden}.nb-theme-corporate   [_nghost-%COMP%]   nb-card-body[_ngcontent-%COMP%]{overflow:hidden}"]}),he)},{path:"**",redirectTo:"file-shares",pathMatch:"full"}]}],Se=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=h["\u0275\u0275defineInjector"]({imports:[[d.Bz.forChild(ve)],d.Bz]}),e}(),be=((ue=function e(){n(this,e)}).\u0275fac=function(e){return new(e||ue)},ue.\u0275mod=h["\u0275\u0275defineNgModule"]({type:ue}),ue.\u0275inj=h["\u0275\u0275defineInjector"]({imports:[[o.ez,Se,c.m,i.u5,s.zyh,s.KdK,l.jF,s.T2N,s.uuI,s.MAY,s.MfT,s.nKr,s.rgH]]}),ue)}}])}();