(self.webpackChunkngx_admin=self.webpackChunkngx_admin||[]).push([[306],{49306:function(e,t,n){"use strict";n.r(t),n.d(t,{NetworkConnectionsModule:function(){return Q}});var r=n(38583),a=n(10264),o=n(79765),i=n(46797),s=n(40205),l=n(25917),c=n(92340),u=n(47349),d=n(37716),h=n(91841);let m=(()=>{class e{constructor(e){this.httpClient=e,this.apiUrl=`${c.N.apiUrl}/data/scenes`,this.ALL_TENANTS_ID="00000000-0000-0000-0000-000000000000"}getNetworkConnections(){return this.httpClient.get(`${this.apiUrl}/${this.ALL_TENANTS_ID}/win365/networkConnections`).pipe((0,u.d)({refCount:!0,bufferSize:1}))}}return e.\u0275fac=function(t){return new(t||e)(d["\u0275\u0275inject"](h.eN))},e.\u0275prov=d["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var f=n(68307),g=n(11627),p=n(39761),C=n(43190),b=n(67666),w=n(5304),k=n(46782),S=n(11173),y=n(76897),x=n(14625),N=n(45880),P=(()=>(function(e){e.SceneName="SceneName",e.Name="DisplayName",e.VirtualNetwork="VirtualNetworkName",e.Status="HealthCheckStatus",e.CreatedBy="ManagedBy",e.ConnectionType="ConnectionType",e.Subscription="SubscriptionName",e.Domain="AdDomainName",e.Region="VirtualNetworkLocation"}(P||(P={})),P))(),v=(()=>(function(e){e.Pending="pending",e.Running="running",e.Passed="passed",e.Failed="failed",e.Warning="warning",e.Informational="informational",e.UnknownFutureValue="unknownFutureValue"}(v||(v={})),v))();function F(e){switch(e){case v.Pending:return"Pending";case v.Running:return"Running";case v.Passed:return"Success";case v.Failed:return"Failed";case v.Warning:return"Warning";case v.Informational:return"Informational";case v.UnknownFutureValue:return"UnknownFutureValue";default:return""}}var M=n(60290),V=n(73544),O=n(84266);const _=["ngx-table-network-connections-status",""];let E=(()=>{class e{constructor(){this.hostClass="",this.label=""}ngOnChanges(){var e;switch(null===(e=this.item)||void 0===e?void 0:e.HealthCheckStatus){case v.Pending:this.hostClass="network-connection-status pending",this.label="Pending";break;case v.Running:this.hostClass="network-connection-status running",this.label="Running";break;case v.Passed:this.hostClass="network-connection-status success",this.label="Success";break;case v.Failed:this.hostClass="network-connection-status failed",this.label="Failed";break;case v.Warning:this.hostClass="network-connection-status warning",this.label="Warning";break;case v.Informational:this.hostClass="network-connection-status informational",this.label="Informational";break;default:this.hostClass="network-connection-status unknown-future-value",this.label="UnknownFutureValue"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=d["\u0275\u0275defineComponent"]({type:e,selectors:[["","ngx-table-network-connections-status",""]],hostVars:2,hostBindings:function(e,t){2&e&&d["\u0275\u0275classMap"](t.hostClass)},inputs:{item:"item"},features:[d["\u0275\u0275NgOnChangesFeature"]],attrs:_,decls:2,vars:1,consts:[[1,"d-block","h-100"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate"](t.label))},styles:["[_nghost-%COMP%]   .network-connection-status.pending[_ngcontent-%COMP%]{border-left:.4em solid color-mix(in srgb,var(--primary) 30%,transparent)}[_nghost-%COMP%]   .network-connection-status.running[_ngcontent-%COMP%]{border-left:.4em solid var(--primary)}[_nghost-%COMP%]   .network-connection-status.success[_ngcontent-%COMP%]{border-left:.4em solid var(--success)}[_nghost-%COMP%]   .network-connection-status.failed[_ngcontent-%COMP%], [_nghost-%COMP%]   .network-connection-status.unknown-future-value[_ngcontent-%COMP%]{border-left:.4em solid var(--danger)}[_nghost-%COMP%]   .network-connection-status.warning[_ngcontent-%COMP%]{border-left:.4em solid var(--warning)}[_nghost-%COMP%]   .network-connection-status.informational[_ngcontent-%COMP%]{border-left:.4em solid var(--info)}"],changeDetection:0}),e})();function T(e,t){1&e&&d["\u0275\u0275element"](0,"nb-spinner")}function I(e,t){if(1&e){const e=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"ngx-table-filter-trigger",15),d["\u0275\u0275listener"]("filtersChanges",function(t){return d["\u0275\u0275restoreView"](e),d["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),d["\u0275\u0275elementEnd"]()}if(2&e){const e=d["\u0275\u0275nextContext"](2);d["\u0275\u0275property"]("fieldPath",e.sortKeys.SceneName)("dataSource",e.networkConnectionsCache)}}function A(e,t){if(1&e){const e=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"ngx-table-filter-trigger",16),d["\u0275\u0275listener"]("filtersChanges",function(t){return d["\u0275\u0275restoreView"](e),d["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),d["\u0275\u0275elementEnd"]()}if(2&e){const e=d["\u0275\u0275nextContext"](2);d["\u0275\u0275property"]("fieldPath",e.sortKeys.VirtualNetwork)("dataSource",e.networkConnectionsCache)}}function D(e,t){if(1&e){const e=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"ngx-table-filter-trigger",17),d["\u0275\u0275listener"]("filtersChanges",function(t){return d["\u0275\u0275restoreView"](e),d["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),d["\u0275\u0275elementEnd"]()}if(2&e){const e=d["\u0275\u0275nextContext"](2);d["\u0275\u0275property"]("fieldPath",e.sortKeys.Status)("dataSource",e.networkConnectionsCache)("extractSpecificValue",e.statusValue)}}function R(e,t){1&e&&d["\u0275\u0275element"](0,"td",18),2&e&&d["\u0275\u0275property"]("item",t.$implicit)}function L(e,t){if(1&e){const e=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"ngx-table-filter-trigger",19),d["\u0275\u0275listener"]("filtersChanges",function(t){return d["\u0275\u0275restoreView"](e),d["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),d["\u0275\u0275elementEnd"]()}if(2&e){const e=d["\u0275\u0275nextContext"](2);d["\u0275\u0275property"]("fieldPath",e.sortKeys.CreatedBy)("dataSource",e.networkConnectionsCache)}}function $(e,t){if(1&e){const e=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"ngx-table-filter-trigger",20),d["\u0275\u0275listener"]("filtersChanges",function(t){return d["\u0275\u0275restoreView"](e),d["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),d["\u0275\u0275elementEnd"]()}if(2&e){const e=d["\u0275\u0275nextContext"](2);d["\u0275\u0275property"]("fieldPath",e.sortKeys.ConnectionType)("dataSource",e.networkConnectionsCache)}}function K(e,t){if(1&e){const e=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"ngx-table-filter-trigger",21),d["\u0275\u0275listener"]("filtersChanges",function(t){return d["\u0275\u0275restoreView"](e),d["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),d["\u0275\u0275elementEnd"]()}if(2&e){const e=d["\u0275\u0275nextContext"](2);d["\u0275\u0275property"]("fieldPath",e.sortKeys.Subscription)("dataSource",e.networkConnectionsCache)}}function B(e,t){if(1&e){const e=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"ngx-table-filter-trigger",22),d["\u0275\u0275listener"]("filtersChanges",function(t){return d["\u0275\u0275restoreView"](e),d["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),d["\u0275\u0275elementEnd"]()}if(2&e){const e=d["\u0275\u0275nextContext"](2);d["\u0275\u0275property"]("fieldPath",e.sortKeys.Domain)("dataSource",e.networkConnectionsCache)}}function j(e,t){if(1&e){const e=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"ngx-table-filter-trigger",23),d["\u0275\u0275listener"]("filtersChanges",function(t){return d["\u0275\u0275restoreView"](e),d["\u0275\u0275nextContext"](2).populateFiltersSet(t)}),d["\u0275\u0275elementEnd"]()}if(2&e){const e=d["\u0275\u0275nextContext"](2);d["\u0275\u0275property"]("fieldPath",e.sortKeys.Region)("dataSource",e.networkConnectionsCache)}}function U(e,t){if(1&e){const e=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275elementStart"](1,"ngx-data-table",1),d["\u0275\u0275listener"]("clearFiltersClick",function(){return d["\u0275\u0275restoreView"](e),d["\u0275\u0275nextContext"]().clearFilters()}),d["\u0275\u0275elementStart"](2,"ngx-table-column",2),d["\u0275\u0275template"](3,I,1,2,"ng-template",null,3,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](5,"ngx-table-column",4),d["\u0275\u0275elementStart"](6,"ngx-table-column",5),d["\u0275\u0275template"](7,A,1,2,"ng-template",null,3,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](9,"ngx-table-column",6),d["\u0275\u0275template"](10,D,1,3,"ng-template",null,3,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275template"](12,R,1,1,"ng-template",null,7,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](14,"ngx-table-column",8),d["\u0275\u0275template"](15,L,1,2,"ng-template",null,3,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](17,"ngx-table-column",9),d["\u0275\u0275template"](18,$,1,2,"ng-template",null,3,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](20,"ngx-table-column",10),d["\u0275\u0275template"](21,K,1,2,"ng-template",null,3,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](23,"ngx-table-column",11),d["\u0275\u0275template"](24,B,1,2,"ng-template",null,3,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](26,"ngx-table-column",12),d["\u0275\u0275template"](27,j,1,2,"ng-template",null,3,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](29,"button",13),d["\u0275\u0275listener"]("click",function(){return d["\u0275\u0275restoreView"](e),d["\u0275\u0275nextContext"]().update()}),d["\u0275\u0275element"](30,"nb-icon",14),d["\u0275\u0275text"](31," Update "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("data",e.networkConnections)("config",e.tableConfig)("columnFilters",e.filterState.columnFilters),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("sortable",!0)("searchable",!0),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("sortable",!0)("searchable",!0),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("sortable",!0),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("sortable",!0),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("sortable",!0),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("sortable",!0),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("sortable",!0),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("sortable",!0),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("sortable",!0)}}const H=[{path:"",component:(()=>{class e{constructor(e,t,n){this.networkConnectionsService=e,this.toastrService=t,this.cdr=n,this.destroyed$=new o.xQ,this.statusValue=e=>F(e.HealthCheckStatus),this.networkConnectionsUpdate$=new o.xQ,this.tableConfig={id:"NetworkConnections",search:{placeholder:"Search for network connections"},selectionKey:"IsSelected",sorting:{enabled:!0,defaultColumn:P.SceneName,defaultDirection:"asc"}},this.sortKeys=P,this.filterState={searchQuery:"",columnFilters:{}},this.networkConnections=[],this.networkConnectionsCache=[],this.isLoading=!1,this.retryApiCallWithToastCallback=e=>e.pipe((0,f.b)(e=>this.showDangerToast("Failure accessing the API",`Cannot read data from API. The message is: ${e.message} with status ${e.statusText}`)),(0,g.j)(()=>(0,i.H)(y.e5))),this.handleApiErrorCallback=e=>(0,s._)(()=>(this.showDangerToast("Failure accessing the API",`Cannot read data from API. Reload this site to try it again. The message is: ${e.message} with status ${e.statusText}`),(0,l.of)([])))}ngOnInit(){this.initNetworkConnections()}update(){this.networkConnectionsUpdate$.next()}populateFiltersSet([e,t]){const n=e.filter(e=>e.checked).map(e=>e.label.toLowerCase());this.filterState={...this.filterState,columnFilters:{...this.filterState.columnFilters,[t]:n}},this.applyAllFilters()}clearFilters(){var e;this.filterState={...this.filterState,columnFilters:{}},null===(e=this.filterTriggers)||void 0===e||e.forEach(e=>e.resetAllFilters()),this.applyAllFilters()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}initNetworkConnections(){this.isLoading=!0,this.networkConnectionsUpdate$.pipe((0,p.O)(0),(0,C.w)(()=>(0,i.H)(0,S.tc.autoRefreshDefault)),(0,C.w)(()=>this.networkConnectionsService.getNetworkConnections()),(0,b.a)(this.retryApiCallWithToastCallback),(0,w.K)(this.handleApiErrorCallback),(0,k.R)(this.destroyed$)).subscribe(e=>{this.networkConnectionsCache=[...e],this.applyAllFilters(),this.isLoading=!1,this.cdr.markForCheck()})}showDangerToast(e,t){this.toastrService.danger(t,e,{destroyByClick:!0,duration:2e4,hasIcon:!0,position:x.fe3.TOP_RIGHT,preventDuplicates:!0})}applyAllFilters(){let e=[...this.networkConnectionsCache];Object.keys(this.filterState.columnFilters).some(e=>{var t;return(null===(t=this.filterState.columnFilters[e])||void 0===t?void 0:t.length)>0})&&(e=this.applyColumnFilters(e)),this.networkConnections=e,this.cdr.markForCheck()}applyColumnFilters(e){const t=Object.keys(this.filterState.columnFilters).filter(e=>{var t;return(null===(t=this.filterState.columnFilters[e])||void 0===t?void 0:t.length)>0});return t.length?e.filter(e=>t.every(t=>{var n;const r=this.filterState.columnFilters[t],a=null===(n=this.getTableCellValue(e,t))||void 0===n?void 0:n.toLowerCase();return r.includes(a)})):e}getTableCellValue(e,t){switch(t){case"SceneName":return e.SceneName;case"VirtualNetworkName":return e.VirtualNetworkName;case"HealthCheckStatus":return F(e.HealthCheckStatus);case"ManagedBy":return e.ManagedBy;case"ConnectionType":return e.ConnectionType;case"SubscriptionName":return e.SubscriptionName;case"AdDomainName":return e.AdDomainName;case"VirtualNetworkLocation":return e.VirtualNetworkLocation;default:return""}}}return e.\u0275fac=function(t){return new(t||e)(d["\u0275\u0275directiveInject"](m),d["\u0275\u0275directiveInject"](x.quB),d["\u0275\u0275directiveInject"](d.ChangeDetectorRef))},e.\u0275cmp=d["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-network-connections"]],viewQuery:function(e,t){if(1&e&&d["\u0275\u0275viewQuery"](N.m4,5),2&e){let e;d["\u0275\u0275queryRefresh"](e=d["\u0275\u0275loadQuery"]())&&(t.filterTriggers=e)}},decls:7,vars:2,consts:[[4,"ngIf"],[3,"data","config","columnFilters","clearFiltersClick"],["key","SceneName","label","Tenant",3,"sortable","searchable"],["headerFilter",""],["key","DisplayName","label","Name",3,"sortable","searchable"],["key","VirtualNetworkName","label","Virtual network",3,"sortable"],["key","HealthCheckStatus","label","Status",3,"sortable"],["cell",""],["key","ManagedBy","label","Created by",3,"sortable"],["key","ConnectionType","label","Join type",3,"sortable"],["key","SubscriptionName","label","Subscription",3,"sortable"],["key","AdDomainName","label","Domain",3,"sortable"],["key","VirtualNetworkLocation","label","Region",3,"sortable"],["type","button","nbButton","","status","semi-round",3,"click"],["icon","refresh"],["filterName","SceneName",3,"fieldPath","dataSource","filtersChanges"],["filterName","VirtualNetworkName",3,"fieldPath","dataSource","filtersChanges"],["filterName","HealthCheckStatus",3,"fieldPath","dataSource","extractSpecificValue","filtersChanges"],["ngx-table-network-connections-status","",3,"item"],["filterName","ManagedBy",3,"fieldPath","dataSource","filtersChanges"],["filterName","ConnectionType",3,"fieldPath","dataSource","filtersChanges"],["filterName","SubscriptionName",3,"fieldPath","dataSource","filtersChanges"],["filterName","AdDomainName",3,"fieldPath","dataSource","filtersChanges"],["filterName","VirtualNetworkLocation",3,"fieldPath","dataSource","filtersChanges"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"nb-card"),d["\u0275\u0275elementStart"](1,"nb-card-header"),d["\u0275\u0275elementStart"](2,"h1"),d["\u0275\u0275text"](3,"Network Connections"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](4,"nb-card-body"),d["\u0275\u0275template"](5,T,1,0,"nb-spinner",0),d["\u0275\u0275template"](6,U,32,14,"ng-container",0),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("ngIf",t.isLoading),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngIf",!t.isLoading))},directives:[x.Asz,x.ndF,x.yKW,r.O5,x.Tzq,M.Q,V.U,x.DPz,x.fMN,O.m,E],styles:["[_nghost-%COMP%]{height:100%}[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   nb-actions[_ngcontent-%COMP%]   nb-action[_ngcontent-%COMP%]:not(.disabled){cursor:pointer}[_nghost-%COMP%]   .network-connection-status.pending[_ngcontent-%COMP%]{border-left:.4em solid color-mix(in srgb,var(--primary) 30%,transparent)}[_nghost-%COMP%]   .network-connection-status.running[_ngcontent-%COMP%]{border-left:.4em solid var(--primary)}[_nghost-%COMP%]   .network-connection-status.success[_ngcontent-%COMP%]{border-left:.4em solid var(--success)}[_nghost-%COMP%]   .network-connection-status.failed[_ngcontent-%COMP%], [_nghost-%COMP%]   .network-connection-status.unknown-future-value[_ngcontent-%COMP%]{border-left:.4em solid var(--danger)}[_nghost-%COMP%]   .network-connection-status.warning[_ngcontent-%COMP%]{border-left:.4em solid var(--warning)}[_nghost-%COMP%]   .network-connection-status.informational[_ngcontent-%COMP%]{border-left:.4em solid var(--info)}"],changeDetection:0}),e})()}];let z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=d["\u0275\u0275defineInjector"]({imports:[[a.Bz.forChild(H)],a.Bz]}),e})();var W=n(14171);let Q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=d["\u0275\u0275defineInjector"]({imports:[[r.ez,z,x.zyh,x.T2N,x.KdK,x.uuI,W.tA,N.H8]]}),e})()}}]);